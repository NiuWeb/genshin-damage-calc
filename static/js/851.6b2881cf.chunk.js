"use strict";(self.webpackChunkgenshin_gui=self.webpackChunkgenshin_gui||[]).push([[851],{65476:function(n,e,t){t.d(e,{Tw:function(){return l}});var r=t(93324);function a(n,e,t){return n+(e-n)*t}function i(n){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[0,0,0]}function s(n){var e=function(n){return Math.floor(Math.min(Math.max(0,n),255)).toString(16)},t=e(n[0]),r=e(n[1]),a=e(n[2]);return"#"+(1===t.length?"0"+t:t)+(1===r.length?"0"+r:r)+(1===a.length?"0"+a:a)}function c(n){if(n.map.length<=1)throw new Error("Colormap must have at least two colors");return n.map[0].factor>0&&n.map.unshift({factor:0,color:n.map[0].color}),function(e){var t=n.min,c=n.max,l=n.map;if(e<=t)return s(i(l[0].color));if(e>=c)return s(i(l[l.length-1].color));var o,u,d=(e-t)/(c-t),f=l.findIndex((function(n){return n.factor>=d}));if(0===f)return l[0].color;d<=l[0].factor&&console.log(d),-1===f?(o=l[l.length-2],u=l[l.length-1]):(o=l[f-1],u=l[f]);var h=o.factor,x=u.factor,m=(d-h)/(x-h);return function(n,e,t){var c=i(n),l=(0,r.Z)(c,3),o=l[0],u=l[1],d=l[2],f=i(e),h=(0,r.Z)(f,3),x=h[0],m=h[1],j=h[2];return s([a(o,x,t),a(u,m,t),a(d,j,t)])}(o.color,u.color,m)}}function l(n,e){return c({min:n,max:e,map:[{factor:0,color:"ff6400"},{factor:.5,color:"fff000"},{factor:1,color:"1aff00"}]})}},87882:function(n,e,t){t.d(e,{c7:function(){return T},gw:function(){return Z},Rp:function(){return C}});var r=t(93433),a=t(74165),i=t(15861),s=t(96103),c=t(75936),l=t(17829),o=t(45043),u=t(79188),d=t(47313),f=t(465),h=t(89582),x=t(71587),m=t(65476),j=t(46417),g=(0,m.Tw)(0,3);function v(n){var e=n.stars,t=n.roll,a=(0,d.useMemo)((function(){return o.G.DatabaseValues.getSubstatRolls(e,t.name)}),[e,t.name]);return(0,j.jsx)("div",{children:t.rolls.map((function(n,e){return(0,r.Z)(Array(n).keys()).map((function(n,r){return(0,j.jsx)("div",{className:"d-inline-block text-black pt-1 pb-1 ps-4 pe-4",style:{backgroundColor:g(e)},children:(0,o.q)(t.name,a[e])},r)}))}))})}function p(n){var e=n.artifact,t=(0,d.useMemo)((function(){return e.substats.map((function(n){var t=o.G.DatabaseValues.getSubstatRolls(e.stars,n.name),r=o.G.calculateRolls(n,e.stars,!1),a=r.reduce((function(n,e){return n+e}),0),i=r.reduce((function(n,e,r){return n+e*t[r]}),0)/(t[t.length-1]*a)||0;return{name:n.name,rolls:r,total:a,efficiency:i}}))}),[e]),r=(0,d.useMemo)((function(){return t.reduce((function(n,e){return n+e.total}),0)}),[t]),a=(0,d.useMemo)((function(){return o.G.DatabaseValues.getMaxRolls(e.stars)}),[e]);return(0,j.jsxs)(f.Z,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:(0,u.KF)("STAT_LONG")}),(0,j.jsxs)("th",{children:[(0,u.KF)("ARTIFACT_ROLLS"),(0,j.jsx)("h5",{className:"d-inline-block m-0 ms-2",children:(0,j.jsxs)(h.Z,{bg:r<=a?"info":"danger",children:[r,"/",a]})})]}),(0,j.jsx)("th",{children:(0,u.KF)("STAT_TOTAL")}),(0,j.jsx)("th",{children:(0,u.KF)("STAT_EFFICIENCY")})]})}),(0,j.jsx)("tbody",{children:t.map((function(n,t){return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"align-middle",children:o.G.Describe.getTitle(n.name)}),(0,j.jsx)("td",{className:"align-middle",children:(0,j.jsx)(v,{stars:e.stars,roll:n})}),(0,j.jsx)("td",{className:"align-middle",children:(0,o.q)(n.name,e.substats[t].value)}),(0,j.jsx)("td",{className:"align-middle",children:(0,j.jsx)(x.Z,{className:"text-black",variant:"warning",now:100*n.efficiency,label:o.G.percent(n.efficiency,!0,2)})})]},t)}))})]})}var Z=function(){return[{title:(0,u.KF)("ARTIFACT_VIEW_SUBSTAT_ROLLS"),action:function(n){return(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,(0,c.a)({title:(0,u.KF)("ARTIFACT_SUBSTAT_ROLLS"),message:(0,j.jsx)(p,{artifact:n})});case 3:case"end":return e.stop()}}),e)})))()}},{title:(0,u.KF)("ARTIFACT_CLEAR"),action:function(n){return(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.Q)({message:(0,u.KF)("ARTIFACT_CONFIRMCLEAR"),size:"sm"});case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:n.bonus=void 0,n.mainstat.value=0,n.substats.forEach((function(n){return n.value=0}));case 8:case"end":return e.stop()}}),e)})))()}}]},C=function(){return[].concat((0,r.Z)(Z()),[{title:(0,u.KF)("ACTION_EQUIP"),action:function(n){return(0,i.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.Q)({message:(0,u.KF)("ACTION_CONFIRMEQUIP")});case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:t=(0,s.tl)(),o.G.CharacterLoader.importArtifacts([n],t),(0,c.a)({message:(0,u.KF)("ACTION_DONE")});case 8:case"end":return e.stop()}}),e)})))()}},{title:(0,u.KF)("ACTION_DELETE"),action:function(){return(0,i.Z)((0,a.Z)().mark((function n(){var e;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,l.Q)({message:(0,u.KF)("ARTIFACT_CONFIRMDELETE")});case 2:return e=n.sent,n.abrupt("return",e);case 4:case"end":return n.stop()}}),n)})))()}}])},T=C().findIndex((function(n){return n.title===(0,u.KF)("ACTION_DELETE")}))},4276:function(n,e,t){t.d(e,{J:function(){return w}});var r=t(97273),a=t(45043),i=t(93298),s=t(65832),c=t(48648),l=t(31136),o=t(63849),u=t(31616),d=t(89452),f=t(87882),h=t(79188),x=t(68582),m=t(47313),j=t(80035),g=t(2532),v=t(46417);function p(n){var e,t=n.artifact,r=n.onChange,s=n.readonly,c=(0,x.Z)().language,o=(0,m.useMemo)((function(){var n=function(n){return a.G.Database.getArtifactBonusFactories().filter((function(e){return e.maxstars===n})).map((function(n){return[a.G.Describe.getTitle(n),n.name]})).sort((function(n,e){return n[0].localeCompare(e[0])}))};return{4:n(4),5:n(5)}}),[c]);function u(n){s||(t.bonus=n&&""!==n?n:void 0,r())}var d=(0,v.jsxs)(j.Z,{children:[(0,v.jsx)(j.Z.Header,{children:(0,h.KF)("ARTIFACT_SET_EFFECT")}),(0,v.jsx)(j.Z.Body,{children:(0,v.jsxs)(g.Z.Select,{autoFocus:!0,disabled:s,onChange:function(n){return u(n.target.value)},value:null!==(e=t.bonus)&&void 0!==e?e:"",children:[(0,v.jsx)("option",{value:"",children:(0,h.KF)("ARTIFACT_NO_SET_EFFECT")}),(0,v.jsx)("optgroup",{label:"4x",children:o[4].map((function(n,e){return(0,v.jsx)("option",{value:n[1],children:n[0]},e)}))}),(0,v.jsx)("optgroup",{label:"5x",children:o[5].map((function(n,e){return(0,v.jsx)("option",{value:n[1],children:n[0]},e)}))})]})})]}),f=t.bonus?a.G.Describe.getTitle(t.bonus):(0,h.KF)("ARTIFACT_NO_SET_EFFECT");return(0,v.jsx)(l.Z,{rootClose:!0,trigger:"click",overlay:d,children:(0,v.jsx)(i.Z,{disabled:s,className:"w-100",variant:"success",children:f})})}var Z=t(95668),C=t(71518),T=t(43832);function b(n){var e=n.artifact,t=n.onChange;return(0,v.jsx)(l.Z,{overlay:(0,v.jsx)(Z.Z,{children:(0,h.KF)(e.locked?"ACTION_LOCKED":"ACTION_UNLOCKED")}),trigger:["hover","focus"],children:(0,v.jsx)(i.Z,{onClick:function(){e.locked=!e.locked,t&&t()},children:e.locked?(0,v.jsx)(C.Z,{}):(0,v.jsx)(T.Z,{})})})}var A=t(41251),F=t(45624),N=t(87994),k=function(n){return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(N.Z,{className:"me-1",style:{verticalAlign:"-0.125em"}}),n]})};function y(n){var e=n.artifact,t=n.onChange,r=n.readonly;return(0,v.jsx)(A.Z,{disabled:r,onSelect:function(n){if(n){var r=parseInt(n);4!==r&&5!==r||(e.stars=r,t())}},title:k(e.stars),children:[4,5].map((function(n){return(0,v.jsx)(F.Z.Item,{eventKey:n,children:k(n)},n)}))})}var I=t(64919),_=t(36687);function E(n){var e=n.artifact,t=n.stat,r=n.onChange,i=n.readonly,s=t===e.mainstat,l=a.G.Values.isFlatStat(t.name),o=(0,m.useMemo)((function(){return s?a.G.getMainstatsFor(e.piece):a.G.getSubstatsFor(e.mainstat.name)}),[e,t,e.mainstat.name]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u.Z,{xs:8,children:(0,v.jsx)(c.Z,{direction:"horizontal",children:(0,v.jsx)(A.Z,{disabled:i,className:"w-100",onSelect:function(n){if(!i&&n){var a=n;if(o.includes(a)){if(s)t.name=a;else{var c=e.substats.find((function(n){return n.name===a})),l=t.name;t.name=a,c&&(c.name=l)}r()}}},size:s?void 0:"sm",variant:s?"warning":void 0,as:_.Z,title:a.G.Describe.getTitle(t.name),children:o.map((function(n,e){return(0,v.jsx)(F.Z.Item,{eventKey:n,onClick:function(){},children:a.G.Describe.getTitle(n)},e)}))})})}),(0,v.jsx)(u.Z,{xs:4,children:(0,v.jsx)(I.K,{disabled:i,size:s?void 0:"sm",value:t.value,percent:!a.G.Values.isFlatStat(t.name),places:l?0:1,onChange:function(n,e){i||(t.value=n,(t.value<n||n<0)&&e(),r())}})})]})}var R=t(26934),S=t(12014);function w(n){var e=n.showLock,t=n.actions,h=n.artifact,x=n.onChange,m=n.readonly,j=n.onChangeMainstat,g=n.onChangeSubstat,Z=n.onChangeBonus,C=n.onChangeStars,T=n.onActionFinish,A=n.onAccept,F=n.onCancel,N=n.isDraft;function k(n){null===g||void 0===g||g(n),null===x||void 0===x||x()}function I(n,e){null===T||void 0===T||T(n,e),null===x||void 0===x||x()}t||(t=(0,f.gw)()),N&&(t=[],e=!1);var _=(0,v.jsx)(r.C,{item:h,actions:t,placement:"right",onActionFinish:function(n,e){return I(n,e)}}),w=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(i.Z,{variant:"success",onClick:A,children:(0,v.jsx)(R.Z,{})}),(0,v.jsx)(i.Z,{variant:"danger",onClick:F,children:(0,v.jsx)(S.Z,{})})]});return(0,v.jsx)("div",{className:N?"animated-border":void 0,children:(0,v.jsxs)(s.Z,{children:[(0,v.jsx)(s.Z.Header,{className:"bg-info",children:(0,v.jsxs)(c.Z,{direction:"horizontal",gap:1,children:[e?(0,v.jsx)(b,{artifact:h,onChange:x}):null,(0,v.jsx)(y,{artifact:h,onChange:function(){null===C||void 0===C||C(),null===x||void 0===x||x()},readonly:m}),(0,v.jsx)("h5",{className:"m-0 me-auto",children:a.G.Describe.getTitle(h.piece)}),N?w:(0,v.jsx)(l.Z,{rootClose:!0,trigger:"click",placement:"bottom",overlay:_,children:(0,v.jsx)(i.Z,{disabled:m,children:(0,v.jsx)(d.Z,{style:{verticalAlign:"-0.125em"}})})})]})}),(0,v.jsx)(s.Z.Body,{children:(0,v.jsxs)(o.Z,{className:"gx-1 gy-1",children:[(0,v.jsx)(u.Z,{xs:12,children:(0,v.jsx)(p,{artifact:h,onChange:function(){null===Z||void 0===Z||Z(),null===x||void 0===x||x()},readonly:m})}),(0,v.jsx)(E,{readonly:m,artifact:h,stat:h.mainstat,onChange:function(){null===j||void 0===j||j(),null===x||void 0===x||x()}}),h.substats.map((function(n,e){return(0,v.jsx)(E,{readonly:m,artifact:h,stat:n,onChange:function(){return k(e)}},e)}))]})})]})})}},97273:function(n,e,t){t.d(e,{C:function(){return x}});var r=t(74165),a=t(15861),i=t(1413),s=t(15671),c=t(43144),l=t(60136),o=t(27277),u=t(47313),d=t(2304),f=t(80035),h=t(46417),x=function(n){(0,l.Z)(t,n);var e=(0,o.Z)(t);function t(){return(0,s.Z)(this,t),e.apply(this,arguments)}return(0,c.Z)(t,[{key:"render",value:function(){var n=this,e=(0,i.Z)({},this.props);delete e.item,delete e.actions,delete e.onActionFinish,delete e.popover;var t=!1!==this.props.popover,s=(0,h.jsx)(d.Z,{children:this.props.actions.map((function(e,t){return(0,h.jsx)(d.Z.Item,{action:!0,onClick:(0,a.Z)((0,r.Z)().mark((function a(){var i,s,c;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.action(n.props.item);case 2:c=r.sent,null===(i=(s=n.props).onActionFinish)||void 0===i||i.call(s,t,c);case 4:case"end":return r.stop()}}),a)}))),children:e.title},t)}))});return t?(0,h.jsx)(f.Z,(0,i.Z)((0,i.Z)({},e),{},{children:(0,h.jsx)(f.Z.Body,{children:s})})):s}}]),t}(u.Component)},50851:function(n,e,t){t.r(e),t.d(e,{default:function(){return S},position:function(){return R},title:function(){return E}});var r=t(96103),a=t(4276),i=t(95878),s=t(75936),c=t(79188),l=t(65832),o=t(93298),u=t(93324),d=t(65476),f=t(45043),h=t(47313),x=t(465),m=t(93433),j=t(71587),g=t(26934),v=t(64919),p=t(46417);function Z(n){var e,t=n.editor,a=n.stat,i=n.onClick,s=(0,h.useState)([0,0,0,0]),c=(0,u.Z)(s,2),l=c[0],d=c[1],x=null!==(e=t.getTotalRolls()[a])&&void 0!==e?e:[0,0,0,0],Z=l.reduce((function(n,e){return n+e}),0),C=t.getAvailableTotalRollsCount(a),T=Z>C;(0,h.useEffect)((function(){return d((0,m.Z)(x))}),(0,m.Z)(x));var A=0===C?"":Z+"/"+C,F=(0,r.tl)().artifacts,N=f.G.reduceArray(F.map((function(n){return n.substats.filter((function(n){return n.name===a})).map((function(n){return n.value}))}))).reduce((function(n,e){return n+e}),0);return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"align-middle",children:f.G.Describe.getTitle(a)}),l.map((function(n,e){return(0,p.jsx)("td",{className:"align-middle text-black text-center",style:{backgroundColor:b(e),width:64},children:(0,p.jsx)(v.K,{size:"sm",style:{width:16},value:n,onChange:function(n){var t=(0,m.Z)(l);t[e]=n,d(t)}})},e)})),(0,p.jsx)("td",{className:"align-middle",children:(0,p.jsx)(j.Z,{variant:T?"danger":"info",now:Z,max:C,label:A})}),(0,p.jsx)("td",{className:"align-middle",children:(0,f.q)(a,N)}),(0,p.jsx)("td",{children:0===C?null:(0,p.jsx)("div",{className:"d-flex justify-content-center",children:(0,p.jsx)(o.Z,{disabled:T,variant:T?"danger":"success",onClick:function(){T||i(l)},children:(0,p.jsx)(g.Z,{style:{verticalAlign:"-0.125em"}})})})})]})}var C=t(2377);function T(n){var e,t=n.editor,a=n.stat,i=n.onClick,s=null!==(e=t.getTotalRolls()[a])&&void 0!==e?e:[0,0,0,0],c=s.reduce((function(n,e){return n+e}),0),l=t.getAvailableTotalRollsCount(a),u=(0,r.tl)().artifacts,d=f.G.reduceArray(u.map((function(n){return n.substats.filter((function(n){return n.name===a})).map((function(n){return n.value}))}))).reduce((function(n,e){return n+e}),0),h=0===l?"":c+"/"+l;return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"align-middle",children:f.G.Describe.getTitle(a)}),s.map((function(n,e){return(0,p.jsx)("td",{className:"align-middle text-black text-center",style:{backgroundColor:b(e),width:64},children:n},e)})),(0,p.jsx)("td",{className:"align-middle",children:(0,p.jsx)(j.Z,{variant:"info",now:c,max:l,label:h})}),(0,p.jsx)("td",{className:"align-middle",children:(0,f.q)(a,d)}),(0,p.jsx)("td",{children:0===l?null:(0,p.jsx)("div",{className:"d-flex justify-content-center",children:(0,p.jsx)(o.Z,{onClick:i,children:(0,p.jsx)(C.Z,{style:{verticalAlign:"-0.125em"}})})})})]})}var b=(0,d.Tw)(0,3);function A(n){var e=n.character,t=n.onChange,r=(0,h.useState)(void 0),a=(0,u.Z)(r,2),i=a[0],s=a[1],l=e.getEditor(),o=l.getTotalCount(),d=l.getTotal(),m=e.artifacts.map((function(n){return f.G.DatabaseValues.getMaxRolls(n.stars)})).reduce((function(n,e){return n+e}),0);return(0,p.jsxs)(x.Z,{responsive:!0,children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"text-center",children:(0,c.KF)("STAT_LONG")}),(0,p.jsx)("th",{colSpan:4,className:"text-center",children:(0,c.KF)("ARTIFACT_ROLLS")}),(0,p.jsx)("th",{className:"text-center",children:(0,c.KF)("STAT_TOTAL")}),(0,p.jsx)("th",{className:"text-center",children:(0,c.KF)("STAT_VALUE")}),(0,p.jsx)("th",{className:"text-center",children:(0,c.KF)("ACTION")})]})}),(0,p.jsx)("tbody",{children:f.G.ArtifactType.ListSubstats.map((function(n){return n===i?(0,p.jsx)(Z,{editor:l,stat:n,onClick:function(e){return function(n,e){l.assignRolls(n,e,!0),s(void 0),t()}(n,e)}},n):(0,p.jsx)(T,{editor:l,stat:n,onClick:function(){return s(n)}},n)}))}),(0,p.jsx)("tfoot",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"align-middle",children:(0,c.KF)("STAT_TOTAL")}),o.map((function(n,e){return(0,p.jsx)("td",{className:"align-middle text-black text-center",style:{backgroundColor:b(e)},children:(0,p.jsx)("strong",{children:n})},e)})),(0,p.jsx)("td",{colSpan:3,className:"align-middle text-center",children:(0,p.jsxs)("strong",{children:[d,"/",m]})})]})})]})}function F(n){var e=n.character,t=n.onChange;return(0,p.jsx)(l.Z,{className:"border-info",children:(0,p.jsx)(l.Z.Body,{children:(0,p.jsx)(o.Z,{size:"lg",onClick:function(){(0,s.a)({closeButton:!1,title:(0,c.KF)("ARTIFACT_ROLLS_EDITOR"),message:(0,p.jsx)(i.L,{children:function(n){return(0,p.jsx)(A,{character:e,onChange:n})}})}).then((function(){e.removeEditor(),t()}))},children:(0,c.KF)("ARTIFACT_ROLLS_EDITOR")})})})}var N=t(86828),k=t(42072),y=t(22102),I=t(63849),_=t(31616),E="artifacts",R=1;function S(){var n=(0,r.tl)(),e=(0,k.P)().update;return(0,p.jsx)(y.Z,{children:(0,p.jsxs)(I.Z,{className:"gx-2 gy-2",children:[n.artifacts.map((function(n,t){return(0,p.jsx)(_.Z,{sm:12,md:6,lg:4,children:(0,p.jsx)(i.L,{children:function(t){return(0,p.jsx)(a.J,{artifact:n,onActionFinish:e,onChangeBonus:e,onChange:t})}})},t)})),(0,p.jsx)(_.Z,{sm:12,md:6,lg:4,children:(0,p.jsx)("div",{className:"position-relative w-100 h-100 d-flex justify-content-center align-items-center",children:(0,p.jsx)(F,{character:n,onChange:e})})}),(0,p.jsx)(_.Z,{xs:12,children:(0,p.jsx)(N.X,{hideToggle:function(){return!0},effects:n.bonus.effects,onChange:e})})]})})}}}]);