"use strict";(self.webpackChunkgenshin_gui=self.webpackChunkgenshin_gui||[]).push([[3818],{97679:function(e,t,n){function r(e,t){for(var n=e.toFixed(t),r=n.length-1;r>=0&&"0"===n[r];r--)n=n.slice(0,r);return n.endsWith(".")&&(n=n.slice(0,n.length-1)),n}n.d(t,{F:function(){return r}})},23291:function(e,t,n){n.d(t,{Z:function(){return E}});var r=n(1413),a=n(45987);n(47313);var c=n.p+"static/media/pyro.babb0a5d6f255ce987686e321062adf8.svg";var i=n.p+"static/media/hydro.dbcf75ab6927f7b73d17f4fb71f621ac.svg";var l=n.p+"static/media/cryo.3bdb562015df89a20e96599718419039.svg";var s=n.p+"static/media/electro.178efeba7aa67dca8d20a69fdcaebfaa.svg";var o=n.p+"static/media/geo.61c55e600f72d666196bdb5307a35bf2.svg";var d=n.p+"static/media/anemo.8fbd12d60899bee429fa3c3fbd9e131b.svg",A=n(46417),u=["element","width","height"];function E(e){var t=e.element,n=e.width,E=void 0===n?24:n,m=(e.height,(0,a.Z)(e,u));switch(t){case"AnemoDMG":return(0,A.jsx)("img",(0,r.Z)((0,r.Z)({width:E},m),{},{src:d,alt:"anemo"}));case"GeoDMG":return(0,A.jsx)("img",(0,r.Z)((0,r.Z)({width:E},m),{},{src:o,alt:"geo"}));case"ElectroDMG":return(0,A.jsx)("img",(0,r.Z)((0,r.Z)({width:E},m),{},{src:s,alt:"electro"}));case"CryoDMG":case"Frozen":return(0,A.jsx)("img",(0,r.Z)((0,r.Z)({width:E},m),{},{src:l,alt:"cryo"}));case"HydroDMG":return(0,A.jsx)("img",(0,r.Z)((0,r.Z)({width:E},m),{},{src:i,alt:"hydro"}));case"PyroDMG":return(0,A.jsx)("img",(0,r.Z)((0,r.Z)({width:E},m),{},{src:c,alt:"pyro"}));default:return null}}},23818:function(e,t,n){n.r(t),n.d(t,{default:function(){return se},position:function(){return le},title:function(){return ie}});var r=n(96103),a=n(45043),c=n(79188),i=n(47313),l=n(65832),s=n(53768),o=n(465),d=n(31136),A=n(95668),u=n(23291),E=n(75936),m=n(93298),M=n(93324),x=n(48648),h=n(63849),g=n(31616),T=["#696969","#2E8B57","#8B0000","#808000","#8B008B","#FFA500","#0000CD","#7CFC00","#00FA9A","#4169E1","#00FFFF","#00BFFF","#ff4b00","#FFFF54","#DDA0DD","#FF1493","#FFDAB9","#FF0000"],G=["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#000000","#FFFFFF","#000000","#000000","#FFFFFF","#000000","#000000","#FFFFFF","#000000","#000000","#FFFFFF","#000000","#FFFFFF"],N={PyroDMG:"rgb(235, 118, 22)",HydroDMG:"rgb(0, 125, 197)",CryoDMG:"rgb(153, 238, 238)",ElectroDMG:"rgb(216, 89, 255)",GeoDMG:"rgb(226, 167, 56)",AnemoDMG:"rgb(0, 255, 149)",PhysicalDMG:"rgb(177, 177, 177)"};var D=function(e,t){var n,r;return[null!==(n=G[e])&&void 0!==n?n:"#FFFFFF",null!==(r=T[e])&&void 0!==r?r:"#000000"][t]},v={variable:/([a-z_][a-z_0-9]*)/i,operator:/(\+|\-|\*|\/|\(|\)|=|\^)/,number:/([0-9]+)(\.[0-9]+)?%?/},f=new RegExp("(".concat(v.variable.source,"|").concat(v.operator.source,"|").concat(v.number.source,")"),"ig");function _(e,t){return(e=e.replace(/(^\s*|\s*$)/g,"").replace(/\s*\n+\s*/g,"\n")).split("\n").map((function(e){return'<div class="formula">'+function(e,t){var n=(e=e.replace(/\s+/g,"")).match(f);if(!n)return"";for(var r,a=[],c=[],i=0;i<n.length;i++){var l=n[i];if("("===l)c.push(i);else if(")"===l){var s=c.pop();if(void 0===s)throw new Error("Mismatched parentheses");var o=i;a[s]='<div class="group">',a[o]="</div>"}else if(l.match(v.variable)){var d="";if(t){var A=t[l];A&&(d='style="color: '.concat((r=A).text,"; background-color: ").concat(r.background,';"'),A.replace&&(l=A.replace+""))}a[i]='<div class="token variable" '.concat(d,">").concat(l,"</div>")}else if(l.match(v.operator)){var u="addition";"-"===l?u="subtraction":"*"===l?(u="multiplication",l="&times;"):"/"===l?u="division":"^"===l&&(u="exponent"),a[i]='<div class="token operator '.concat(u,'">').concat(l,"</div>")}else l.match(v.number)&&(a[i]='<div class="token number">'.concat(l,"</div>"))}return a.join("")}(e,t)+"</div>"})).join("")}var j=n(46417);function p(e){var t=e.instance,n=t.character,r=t.getCalculatedMVs(),i=t.getFlatValues(),l=t.getReactionDMG(),s=l.reaction?n.get(l.reaction):0,o=function(e){var t=e.motionValues,n=e.flatValues,r=e.reactionMultiplier,c=e.res,i=t.map((function(e){var t=e.name.replace(/.*ATK$/g,"ATK");return"".concat(a.G.percent(e.MV),"*").concat(t)})).join("+"),l=n.map((function(e){return"".concat(e.value)})).join("+"),s=c<0?"*(1-(DAMAGE_ENEMYRES/2))":c<.75?"*(1-DAMAGE_ENEMYRES)":"*(1/(4*DAMAGE_ENEMYRES+1))",o=1===r?"":"*(1+((278%*ElementalMastery)/(ElementalMastery+1400))+DAMAGE_REACTIONDMG)*DAMAGE_REACTION";return"\n    DAMAGE_NOCRIT=DAMAGE_MULTIPLIER*(".concat(i+(""!==l?"+":"")+l,")\n    *(1 + DAMAGE_ELEMENTAL + DAMAGE_TALENT + DAMAGE_ALL + DAMAGE_SPECIFIC)\n    ").concat(o,"\n    *( (DAMAGE_CHARLVL+100) / ( (1-DAMAGE_ENEMYDEFIGNORED)*(1-DAMAGE_ENEMYDEF)*(DAMAGE_ENEMYLVL + 100) + DAMAGE_CHARLVL+100 )  )\n    ").concat(s,"\n    DAMAGE_CRIT=(DAMAGE_NOCRIT)*(1+CRITDMG)\n    DAMAGE_AVG=(DAMAGE_NOCRIT)*(1+CRITRate*CRITDMG)\n    ")}({motionValues:r,flatValues:i,reactionMultiplier:l.multiplier,res:n.enemy.getRES(t.ElementalDMG)}),d=t.TalentDMG?n.get(t.TalentDMG):0,A={DAMAGE_NOCRIT:{replace:(0,c.KF)("DAMAGE_NOCRIT"),text:"inherit",background:"transparent"},ATK:{replace:(0,a.q)("ATK",n.get("ATK")),text:D(0,0),background:D(0,1)},HP:{replace:(0,a.q)("HP",n.get("HP")),text:D(1,0),background:D(1,1)},DEF:{replace:(0,a.q)("DEF",n.get("DEF")),text:D(2,0),background:D(2,1)},DAMAGE_MULTIPLIER:{replace:a.G.percent(t.getMultiplier()),text:D(3,0),background:D(3,1)},DAMAGE_ELEMENTAL:{replace:(0,a.q)("PyroDMG",n.get(t.ElementalDMG)),text:D(4,0),background:D(4,1)},DAMAGE_TALENT:{replace:(0,a.q)("PyroDMG",d),text:D(5,0),background:D(5,1)},DAMAGE_ALL:{replace:(0,a.q)("PyroDMG",n.get("AllDMG")),text:D(6,0),background:D(6,1)},DAMAGE_SPECIFIC:{replace:(0,a.q)("PyroDMG",t.get("AllDMG")),text:D(7,0),background:D(7,1)},DAMAGE_CHARLVL:{replace:n.Level,text:D(8,0),background:D(8,1)},DAMAGE_ENEMYDEF:{replace:(0,a.q)("PyroDMG",n.enemy.get("DEFreduction")),text:D(9,0),background:D(9,1)},DAMAGE_ENEMYDEFIGNORED:{replace:(0,a.q)("PyroDMG",t.get("DEFignored")+n.get("DEFignored")),text:D(10,0),background:D(10,1)},DAMAGE_ENEMYLVL:{replace:n.enemy.Level,text:D(11,0),background:D(11,1)},DAMAGE_ENEMYRES:{replace:(0,a.q)("PyroDMG",n.enemy.getRES(t.ElementalDMG)),text:D(12,0),background:D(12,1)},ElementalMastery:{replace:(0,a.q)("ElementalMastery",n.get("ElementalMastery")+t.get("ElementalMastery")),text:D(13,0),background:D(13,1)},DAMAGE_REACTION:{replace:(0,a.q)("PyroDMG",l.multiplier),text:D(14,0),background:D(14,1)},DAMAGE_REACTIONDMG:{replace:(0,a.q)("PyroDMG",s),text:D(15,0),background:D(15,1)},DAMAGE_CRIT:{replace:(0,c.KF)("DAMAGE_CRIT"),text:"inherit",background:"transparent"},DAMAGE_AVG:{replace:(0,c.KF)("DAMAGE_AVG"),text:"inherit",background:"transparent"},CRITDMG:{replace:(0,a.q)("CRITDMG",t.calculateCRITDMG()),text:D(16,0),background:D(16,1)},CRITRate:{replace:(0,a.q)("CRITRate",t.calculateCRITRate()),text:D(17,0),background:D(17,1)}},u=_(o,A);return(0,j.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[(0,j.jsx)("div",{className:"d-flex justify-content-center formula",children:(0,j.jsxs)(x.Z,{direction:"horizontal",gap:1,children:[(0,j.jsx)("div",{className:"token variable",style:{backgroundColor:D(4,1),color:D(4,0)},children:a.G.Describe.getTitle(t.ElementalDMG)}),t.TalentDMG?(0,j.jsx)("div",{className:"token variable",style:{backgroundColor:D(5,1),color:D(5,0)},children:a.G.Describe.getTitle(t.TalentDMG)}):null]})}),(0,j.jsx)("div",{dangerouslySetInnerHTML:{__html:u}}),(0,j.jsx)("div",{className:"formula-legend",children:(0,j.jsx)(h.Z,{children:Object.entries(A).map((function(e,t){var n=(0,M.Z)(e,2),r=n[0],i=n[1];if("transparent"===i.background)return null;var l=(0,c.KF)(r);return l.includes("{")&&(l=a.G.Describe.getTitle(r)),(0,j.jsx)(g.Z,{xs:12,md:6,lg:4,children:(0,j.jsxs)("div",{className:"d-flex align-items-center item",children:[(0,j.jsx)("div",{className:"marker",style:{backgroundColor:i.background}}),(0,j.jsx)("div",{className:"label",children:l})]})},t)}))})})]})}function F(e){var t=e.instance,n=t.character,r=a.G.TransformativeFormula.reactionMultiplier(t.ReactionDMG),i=function(e){var t=e.res;return"\n    DAMAGE_NOCRIT=(0.00194*DAMAGE_CHARLVL^3-0.319*DAMAGE_CHARLVL^2+30.7*DAMAGE_CHARLVL-868)\n    *(1+((1600%*ElementalMastery)/(ElementalMastery+2000))+DAMAGE_REACTIONDMG)*DAMAGE_REACTION\n    ".concat(t<0?"*(1-(DAMAGE_ENEMYRES/2))":t<.75?"*(1-DAMAGE_ENEMYRES)":"*(1/(4*DAMAGE_ENEMYRES+1))","\n    ")}({res:n.enemy.getRES(t.ElementalDMG)}),l={DAMAGE_NOCRIT:{replace:(0,c.KF)("DAMAGE_NOCRIT"),text:"inherit",background:"transparent"},DAMAGE_CHARLVL:{replace:n.Level,text:D(8,0),background:D(8,1)},DAMAGE_ENEMYRES:{replace:(0,a.q)("PyroDMG",n.enemy.getRES(t.ElementalDMG)),text:D(12,0),background:D(12,1)},ElementalMastery:{replace:(0,a.q)("ElementalMastery",n.get("ElementalMastery")),text:D(13,0),background:D(13,1)},DAMAGE_REACTION:{replace:(0,a.q)("PyroDMG",r),text:D(14,0),background:D(14,1)},DAMAGE_REACTIONDMG:{replace:(0,a.q)("PyroDMG",n.get(t.ReactionDMG)+t.get("AllDMG")),text:D(15,0),background:D(15,1)}},s=_(i,l);return(0,j.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[(0,j.jsx)("div",{dangerouslySetInnerHTML:{__html:s}}),(0,j.jsx)("div",{className:"formula-legend",children:(0,j.jsx)(h.Z,{children:Object.entries(l).map((function(e,t){var n=(0,M.Z)(e,2),r=n[0],i=n[1];if("transparent"===i.background)return null;var l=(0,c.KF)(r);return l.includes("{")&&(l=a.G.Describe.getTitle(r)),(0,j.jsx)(g.Z,{xs:12,md:6,lg:4,children:(0,j.jsxs)("div",{className:"d-flex align-items-center item",children:[(0,j.jsx)("div",{className:"marker",style:{backgroundColor:i.background}}),(0,j.jsx)("div",{className:"label",children:l})]})},t)}))})})]})}var b=n(87284);function R(e){var t=e.instance;return(0,j.jsx)(m.Z,{onClick:function(){t instanceof a.G.DamageInstance?(0,E.a)({title:(0,c.KF)("DAMAGE_FORMULA")+" | "+a.G.Describe.getTitle(t.name),message:(0,j.jsx)(p,{instance:t})}):t instanceof a.G.TransformativeDamageInstance&&(0,E.a)({title:(0,c.KF)("DAMAGE_FORMULA"),message:(0,j.jsx)(F,{instance:t})})},children:(0,j.jsx)(b.Z,{})})}function O(e){var t=e.list;return(0,j.jsxs)(o.Z,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:(0,c.KF)("DAMAGE_INST")}),(0,j.jsx)("th",{children:(0,c.KF)("DAMAGE_NOCRIT")}),(0,j.jsx)("th",{children:(0,c.KF)("DAMAGE_CRIT")}),(0,j.jsx)("th",{children:(0,c.KF)("DAMAGE_AVG")}),(0,j.jsx)("th",{children:(0,c.KF)("DAMAGE_FORMULA_SHORT")})]})}),(0,j.jsxs)("tbody",{children:[t.map((function(e,t){return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"w-50 align-middle",children:(0,j.jsx)(d.Z,{trigger:["hover","focus"],placement:"left",overlay:(0,j.jsx)(A.Z,{children:a.G.Describe.getTitle("Element."+e.ElementalDMG)}),children:(0,j.jsxs)("div",{className:"d-flex align-items-center",children:[(0,j.jsx)(u.Z,{element:e.ElementalDMG,style:{verticalAlign:"-0.125em"}}),a.G.Describe.getTitle(e.name)]})})}),(0,j.jsx)("td",{className:"align-middle",children:(0,j.jsx)("div",{className:"element-"+e.ElementalDMG,children:a.G.round(e.calculateNoCRIT())})}),(0,j.jsx)("td",{className:"align-middle",children:(0,j.jsx)("div",{className:"element-"+e.ElementalDMG,children:a.G.round(e.calculateCRIT())})}),(0,j.jsx)("td",{className:"align-middle",children:(0,j.jsx)("div",{className:"element-"+e.ElementalDMG,children:a.G.round(e.calculateAverage())})}),(0,j.jsx)("td",{className:"text-center align-middle",children:(0,j.jsx)(R,{instance:e})})]},t)})),0===t.length&&(0,j.jsx)("tr",{children:(0,j.jsx)("td",{className:"text-center",colSpan:5,children:(0,c.KF)("DAMAGE_INST_EMPTY")})})]})]})}function I(e){var t=e.character,n=(0,i.useMemo)((function(){var e=t.damage.getTransformative();return{DAMAGE_NORMALS:t.damage.getNormalAttacks(),DAMAGE_ES:t.damage.getElementalSkills(),DAMAGE_EB:t.damage.getElementalBursts(),DAMAGE_TRANSFORMATIVE:e,DAMAGE_EXTRA:t.damage.getExtraDamage().filter((function(t){return!e.includes(t)}))}}),[t]);return(0,j.jsxs)(l.Z,{children:[(0,j.jsx)(l.Z.Header,{as:"h5",className:"bg-info m-0",children:(0,c.KF)("DAMAGE_INSTANCES")}),(0,j.jsx)(l.Z.Body,{children:(0,j.jsx)(s.Z,{children:a.G.getObjectKeys(n).map((function(e){return(0,j.jsxs)(s.Z.Item,{eventKey:e,children:[(0,j.jsx)(s.Z.Header,{children:(0,c.KF)(e)}),(0,j.jsx)(s.Z.Body,{children:(0,j.jsx)(O,{list:n[e]})})]},e)}))})})]})}var C=n(1413),y=n(6203);var k=n(68582),Z=n(29447),L=n(15671),K=n(43144),U=n(60136),S=n(27277),P=n(95397),V="calculate-rotation";P.z;var H=n(47017),w=n(89582),q=n(44030),B=n(93739),Y=n(58446);function z(e){var t;return(0,j.jsxs)("div",{className:"h-100 chart-container",children:[(0,j.jsx)("h5",{className:"m-0 p-1 text-center",children:null!==(t=e.header)&&void 0!==t?t:""}),(0,j.jsx)("div",{children:(0,j.jsx)(Y.Z,(0,C.Z)((0,C.Z)({},e),{},{options:(0,C.Z)({chart:{toolbar:{show:!1}},theme:{mode:"dark"},legend:{position:"bottom"}},e.options),width:"100%"}))})]})}function X(e){var t=e.rotation,n=(0,i.useMemo)((function(){if(t){var e=t.benefits;return[{data:Object.entries(e).map((function(e){var t,n=(0,M.Z)(e,2),r=n[0],c=n[1];return{x:a.G.Describe.getTitle(r)+" (+".concat((t=r,(0,a.q)(t,a.G.DatabaseValues.getMinValue(t))),")"),y:c}})).filter((function(e){return e.y>0})).sort((function(e,t){return t.y-e.y}))}]}}),[t]);if(!t||!n)return null;var r=n[0].data;return(0,j.jsx)(z,{options:{colors:T.slice(1),tooltip:{custom:function(e){var t=e.dataPointIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(r[t].x,"</div>")+'<div class="value">'.concat((0,c.KF)("DAMAGE_BENEFIT"),": ").concat(a.G.percent(r[t].y,!0,4),"</div>")+"</div>"}},xaxis:{labels:{formatter:function(e){return a.G.percent(parseFloat(e))}}},dataLabels:{formatter:function(e){return a.G.percent(e,!0,4)}},plotOptions:{bar:{horizontal:!0}}},series:n,type:"bar",header:(0,c.KF)("DAMAGE_ROLL_BENEFIT")})}var $=n(97679);function W(e){var t=e.rotation,n=(0,i.useMemo)((function(){if(t){var e=t.fractions.ElementalDMG;return{series:Object.values(e).map((function(e){return e*t.damage})),labels:Object.keys(e).map((function(e){return"other"===e?(0,c.KF)("DAMAGE_EXTRA"):a.G.Describe.getTitle("Element."+e)})),colors:Object.keys(e).map((function(e){return N[e]}))}}}),[t]);return t&&n?(0,j.jsx)(z,{options:{colors:n.colors,labels:n.labels,tooltip:{custom:function(e){var t=e.series,r=e.seriesIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(n.labels[r],"</div>")+'<div class="value">'.concat((0,c.KF)("DAMAGE"),": ").concat((0,$.F)(t[r],2),"</div>")+"</div>"}}},series:n.series,type:"pie",header:(0,c.KF)("ROTATION_ELEMENTAL_DAMAGE")}):null}function J(e){var t=e.rotation,n=(0,i.useMemo)((function(){if(t){var e=new Map;t.instances.forEach((function(t){var n,r=t.damage,a=null!==(n=t.instanceName)&&void 0!==n?n:"",c=e.get(a)||0;e.set(a,c+r)}));var n=Array.from(e.entries());return{series:n.map((function(e){return e[1]})),labels:n.map((function(e){return a.G.Describe.getTitle(e[0])}))}}}),[t]);return t&&n?(0,j.jsx)(z,{options:{colors:T.slice(1),theme:{mode:"dark"},labels:n.labels,tooltip:{custom:function(e){var t=e.series,r=e.seriesIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(n.labels[r],"</div>")+'<div class="value">'.concat((0,c.KF)("DAMAGE"),": ").concat((0,$.F)(t[r],2),"</div>")+"</div>"}}},series:n.series,type:"pie",header:(0,c.KF)("ROTATION_INSTANCE_DAMAGE")}):null}function Q(e){var t=e.rotation,n=(0,i.useMemo)((function(){if(t){var e=t.fractions.TalentDMG;return{series:Object.values(e).map((function(e){return e*t.damage})),labels:Object.keys(e).map((function(e){return"other"===e?(0,c.KF)("DAMAGE_EXTRA"):a.G.Describe.getTitle(e)}))}}}),[t]);return t&&n?(0,j.jsx)(z,{options:{colors:T.slice(1),theme:{mode:"dark"},labels:n.labels,tooltip:{custom:function(e){var t=e.series,r=e.seriesIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(n.labels[r],"</div>")+'<div class="value">'.concat((0,c.KF)("DAMAGE"),": ").concat((0,$.F)(t[r],2),"</div>")+"</div>"}}},series:n.series,type:"pie",header:(0,c.KF)("ROTATION_TALENT_DAMAGE")}):null}function ee(e){var t=e.instance;return(0,j.jsx)(m.Z,{onClick:function(){var e=t.instanceName?a.G.Describe.getTitle(t.instanceName):"";(0,E.a)({title:(0,c.KF)("ROTATION_DAMAGE_FORMULA")+" | "+e,message:(0,j.jsx)(te,{instance:t})})},children:(0,j.jsx)(b.Z,{})})}function te(e){var t=e.instance,n={ROTATION_INSTANCE_DAMAGE:{replace:(0,c.KF)("ROTATION_INSTANCE_DAMAGE"),text:"",background:""},DAMAGE:{replace:(0,c.KF)("DAMAGE"),text:"",background:""},DAMAGE_NOAURA_NOREACTION:{replace:a.G.round(t.noaura.noreaction),text:G[1],background:T[1]},DAMAGE_NOAURA_REACTION:{replace:a.G.round(t.noaura.yesreaction),text:G[2],background:T[2]},DAMAGE_AURA_NOREACTION:{replace:a.G.round(t.yesaura.noreaction),text:G[16],background:T[16]},DAMAGE_AURA_REACTION:{replace:a.G.round(t.yesaura.yesreaction),text:G[4],background:T[4]},ROTATION_AURA_UPTIME:{replace:a.G.percent(t.paura),text:G[13],background:T[13]},ROTATION_REACTION_UPTIME:{replace:a.G.percent(t.preaction),text:G[9],background:T[9]},ROTATION_INSTANCE_AOE:{replace:a.G.percent(t.multiplier),text:G[7],background:T[7]},ROTATION_INSTANCE_COUNT:{replace:a.G.round(t.count)||"0",text:G[8],background:T[8]}},r=_(t.paura>0?"\n    ROTATION_INSTANCE_DAMAGE= DAMAGE_NOAURA_NOREACTION * (1-ROTATION_AURA_UPTIME)*(1-(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME))\n    +DAMAGE_NOAURA_REACTION * (1-ROTATION_AURA_UPTIME)*(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME)\n    +DAMAGE_AURA_NOREACTION * (ROTATION_AURA_UPTIME)*(1-(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME))\n    +DAMAGE_AURA_REACTION * (ROTATION_AURA_UPTIME)*(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME)\n    DAMAGE=(ROTATION_INSTANCE_AOE)*(ROTATION_INSTANCE_COUNT)*(ROTATION_INSTANCE_DAMAGE)\n":"\nROTATION_INSTANCE_DAMAGE= DAMAGE_NOAURA_NOREACTION\nDAMAGE=(ROTATION_INSTANCE_AOE)*(ROTATION_INSTANCE_COUNT)*(ROTATION_INSTANCE_DAMAGE)\n",n);return(0,j.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[(0,j.jsx)("div",{dangerouslySetInnerHTML:{__html:r}}),(0,j.jsx)("div",{className:"formula-legend",children:(0,j.jsx)(h.Z,{children:Object.entries(n).map((function(e,t){var n=(0,M.Z)(e,2),r=n[0],i=n[1];if(""===i.background)return null;var l=(0,c.KF)(r);return l.includes("{")&&(l=a.G.Describe.getTitle(r)),(0,j.jsx)(g.Z,{xs:12,md:6,children:(0,j.jsxs)("div",{className:"d-flex align-items-center item",children:[(0,j.jsx)("div",{className:"marker",style:{backgroundColor:i.background}}),(0,j.jsx)("div",{className:"label",children:l})]})},t)}))})})]})}function ne(e){var t=e.rotation,n=function(e,t){return e?a.G.Describe.getTitle((null!==t&&void 0!==t?t:"")+e):(0,c.KF)("STAT_NONE")};return(0,j.jsxs)(o.Z,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:(0,c.KF)("ROTATION_AOE")}),(0,j.jsx)("th",{children:(0,c.KF)("ROTATION_COUNT")}),(0,j.jsx)("th",{children:(0,c.KF)("DAMAGE_INST")}),(0,j.jsx)("th",{children:(0,c.KF)("EFFECT_AURA")}),(0,j.jsx)("th",{children:(0,c.KF)("ROTATION_AURA_VALUE")}),(0,j.jsx)("th",{children:(0,c.KF)("ROTATION_REACTION_VALUE")}),(0,j.jsx)("th",{children:(0,c.KF)("DAMAGE")}),(0,j.jsx)("th",{children:(0,c.KF)("DAMAGE_FORMULA_SHORT")})]})}),(0,j.jsx)("tbody",{children:t.instances.map((function(e,t){return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"align-middle",children:a.G.percent(e.multiplier)}),(0,j.jsx)("td",{className:"align-middle",children:e.count}),(0,j.jsx)("td",{className:"align-middle",children:n(e.instanceName)}),(0,j.jsxs)("td",{className:"align-middle",children:[e.affectedBy?(0,j.jsx)(u.Z,{element:e.affectedBy}):null,n(e.affectedBy,"Aura.")]}),(0,j.jsx)("td",{className:"align-middle",children:a.G.percent(e.paura)}),(0,j.jsx)("td",{className:"align-middle",children:a.G.percent(e.preaction)}),(0,j.jsx)("td",{className:"align-middle",children:(0,j.jsx)("div",{className:"element-"+e.ElementalDMG,children:a.G.round(e.damage)})}),(0,j.jsx)("td",{className:"align-middle text-center",children:(0,j.jsx)(ee,{instance:e})})]},t)}))})]})}function re(e){var t=e.project,n=e.onChange,r=t.character,o=t.rotationId,d=(0,i.useState)(void 0),A=(0,M.Z)(d,2),u=A[0],E=A[1],m=function(e){var t=(0,i.useMemo)((function(){return[]}),[]),n=(0,i.useReducer)((function(e){return(e+1)%7}),0),r=(0,M.Z)(n,2)[1];return{addAlert:function(n){var a=n.content,c=n.variant,i=void 0===c?"info":c,l=n.timeout,s=void 0===l?3e3:l,o={content:a,variant:i,timeout:s};e&&t.length>=e&&t.shift(),t.push(o),r(),s>0&&Number.isFinite(s)&&setTimeout((function(){var e=t.indexOf(o);e>-1&&(t.splice(e,1),r())}),s)},Alerts:function(){return(0,j.jsx)(j.Fragment,{children:t.map((function(e,t){return(0,j.jsx)(y.Z,{variant:e.variant,children:e.content},t)}))})},clearAlerts:function(){t.splice(0,t.length),r()}}}(1),T=m.Alerts,G=m.addAlert,N=(0,k.Z)().language;return(0,i.useEffect)((function(){E(void 0);var e=t.character,n=t.rotationId;console.log("Running rotation #"+n),(0,H.q$)({id:n}).then((function(t){var r=(0,M.Z)(t,1)[0];console.log("Rotation: ",n,r),function(e){return e.character instanceof a.G.Character&&(e.character=a.G.CharacterLoader.exportCharacter(e.character)),new Promise((function(t,n){var r=performance.now(),a=(0,Z.HB)().addMessageListener((function(e){e.type===V&&e.id===r&&(e.error?n(e.error):((0,Z.HB)().removeMessageListener(a),t(e.result)))}));(0,Z.HB)().postMessage({id:r,type:V,data:e})}))}({character:e,rotation:r}).then((function(e){E(e)})).catch((function(e){G(e)}))}))}),[t,r,o]),(0,i.useEffect)((function(){u&&E((0,C.Z)({},u))}),[N]),(0,j.jsxs)(l.Z,{children:[(0,j.jsx)(l.Z.Header,{as:"h5",className:"m-0 bg-info",children:(0,c.KF)("ROTATION_DAMAGE")}),(0,j.jsxs)(l.Z.Body,{children:[(0,j.jsx)(T,{}),(0,j.jsxs)(h.Z,{className:"gx-1 gy-1",children:[(0,j.jsx)(g.Z,{xs:12,children:(0,j.jsx)(B.x,{project:t,onChange:n})}),(0,j.jsx)(g.Z,{xs:12,children:u?(0,j.jsx)("div",{className:"d-flex justify-content-center bg-primary",children:(0,j.jsx)("table",{children:(0,j.jsxs)("tbody",{children:[(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"align-middle",children:(0,c.KF)("ROTATION_DAMAGE")}),(0,j.jsx)("td",{className:"align-middle",children:(0,j.jsx)(w.Z,{bg:"warning",className:"d-block ms-1 text-black",children:a.G.round(u.damage)})})]}),(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"align-middle",children:(0,j.jsxs)(x.Z,{direction:"horizontal",gap:1,children:[(0,j.jsx)("div",{children:(0,c.KF)("ROTATION_DPS")}),(0,j.jsxs)(w.Z,{bg:"info",children:[u.duration," s"]})]})}),(0,j.jsx)("td",{className:"align-middle",children:(0,j.jsx)(w.Z,{bg:"warning",className:"d-block ms-1 text-black",children:a.G.round(u.DPS)})})]})]})})}):(0,j.jsx)("div",{className:"d-flex justify-content-center",children:(0,j.jsx)(q.Z,{animation:"border",variant:"primary"})})}),(0,j.jsx)(g.Z,{md:12,lg:6,children:(0,j.jsx)(J,{rotation:u})}),(0,j.jsx)(g.Z,{md:12,lg:6,children:(0,j.jsx)(Q,{rotation:u})}),(0,j.jsx)(g.Z,{md:12,lg:6,children:(0,j.jsx)(W,{rotation:u})}),(0,j.jsx)(g.Z,{md:12,lg:6,children:(0,j.jsx)(X,{rotation:u})}),(0,j.jsx)(g.Z,{xs:12,children:u?(0,j.jsx)(s.Z,{children:(0,j.jsxs)(s.Z.Item,{eventKey:"0",children:[(0,j.jsx)(s.Z.Header,{children:(0,c.KF)("CALCULATION_DETAILS")}),(0,j.jsx)(s.Z.Body,{children:(0,j.jsx)(ne,{rotation:u})})]})}):null})]})]})]})}var ae=n(42072),ce=n(22102),ie="damage",le=3;function se(){var e=(0,r.vo)(),t=e.character,n=(0,ae.P)().update;return(0,j.jsx)(ce.Z,{children:(0,j.jsxs)(x.Z,{gap:1,children:[(0,j.jsx)(I,{character:t}),(0,j.jsx)(re,{project:e,onChange:n})]})})}}}]);