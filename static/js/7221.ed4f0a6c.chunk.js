"use strict";(self.webpackChunkgenshin_gui=self.webpackChunkgenshin_gui||[]).push([[7221],{7155:function(e,t,r){r.d(t,{J:function(){return p}});var n=r(1413),a=r(10340),i=r(37671),o=function(){var e=(0,a.T)(),t=(0,a.C)((function(e){return e.config}));return(0,n.Z)((0,n.Z)({},t),{},{setWorkers:function(t){e(i.Nw.setWorkers(t))}})},s=r(36687),c=r(93298),u=r(41251),f=r(45624),d=r(46417),l=window.navigator.hardwareConcurrency||4,h=Array.from(Array(l).keys()).map((function(e){return e+1}));function p(){var e=o();return(0,d.jsxs)(s.Z,{children:[(0,d.jsx)(c.Z,{disabled:!0,children:"Workers"}),(0,d.jsx)(u.Z,{title:e.workers,onSelect:function(t){if(t){var r=parseInt(t)||4;e.setWorkers(r)}},as:s.Z,children:h.map((function(e){return(0,d.jsx)(f.Z.Item,{eventKey:e,children:e},e)}))})]})}},47221:function(e,t,r){r.r(t),r.d(t,{default:function(){return B},position:function(){return N},title:function(){return T}});var n=r(74165),a=r(15861),i=r(93324),o=r(96103),s=r(85278),c=r(64236),u=r(7155),f=r(45043),d=r(26671),l=r(1836),h=r(10340),p=r(22384),g=r(92882),m=r(46323),v=r(79188),w=r(29447);function Z(e,t){var r=performance.now();return e.character instanceof f.G.Character&&(e.character=f.G.CharacterLoader.exportCharacter(e.character)),e.rotation instanceof f.G.Rotation&&(e.rotation=f.G.RotationLoader.exportRotation(e.rotation)),(0,w.HB)().postMessage({id:r,type:"optimizer-artifacts",data:e}),new Promise((function(e){var n=(0,w.HB)().addMessageListener((function(a){a.id===r&&(!1===a.complete?t(a.result[0],a.result[1]):(e(a.result),(0,w.HB)().removeMessageListener(n)))}))}))}var x=r(47017),y=r(47313),C=r(48648),k=r(93298),j=r(63849),E=r(31616),I=r(97890),M=r(46417),T="OPTIMIZER_ARTIFACT",N=6;function B(){var e=function(){var e=(0,h.T)(),t=(0,h.C)((function(e){return e.bonus}));return{getCopy:function(){return JSON.parse(JSON.stringify(t))},setEffect:function(t,r){e(p.Nw.setEffect([t,r]))}}}(),t=e.getCopy(),r=(0,y.useMemo)((function(){var e=[];return t.forEach((function(t){var r=t.name.split(".")[0],n=f.G.Database.getArtifactBonusFactories().find((function(e){return e.name===r}));if(!n)throw new Error("Effect not found: "+r);var a=n.effects.find((function(e){return e.name===t.name}));if(!a)throw new Error("Effect not found: "+t.name);e.push([t,a])})),e}),[t]),T=(0,l.r)(),N=(0,m.a)(),B=(0,I.s0)(),L=(0,d.Z)(),b=(0,g.L)(),A=(0,y.useState)(0),F=(0,i.Z)(A,2),H=F[0],R=F[1];function G(){return(G=(0,a.Z)((0,n.Z)().mark((function e(){var r,a,i,s,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,o.vo)(),a=r.character,i=r.rotationId,T.show(),e.next=4,(0,x.q$)({id:i});case 4:return s=e.sent[0],e.next=7,Z({character:a,rotation:s,query:L.getFilter(),filters:b.getFilters(),effects:t},(function(e,t){T.setCurrent(e),T.setTotal(t)}));case 7:c=e.sent,N.setArtifacts(c),T.hide(),B("/editor/optimizer/results");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,y.useEffect)((function(){(function(e){var t=performance.now();return(0,w.HB)().postMessage({id:t,type:"optimizer-artifacts-count",data:null!==e&&void 0!==e?e:{}}),new Promise((function(e){var r=(0,w.HB)().addMessageListener((function(n){n.id===t&&(e(n.result),(0,w.HB)().removeMessageListener(r))}))}))})(L.getFilter()).then(R)}),[L]),(0,M.jsxs)(C.Z,{gap:1,children:[(0,M.jsxs)(C.Z,{gap:1,direction:"horizontal",children:[(0,M.jsx)(k.Z,{variant:"warning",className:"text-black w-100",onClick:function(){return G.apply(this,arguments)},children:(0,v.KF)("OPTIMIZER_OPTIMIZE_N",{n:H})}),(0,M.jsx)(u.J,{})]}),(0,M.jsx)(c.X,{}),(0,M.jsx)(j.Z,{className:"gx-1 gy-1",children:r.map((function(t,r){var n=(0,i.Z)(t,2),a=n[0],o=n[1];return(0,M.jsx)(E.Z,{xl:6,md:12,children:(0,M.jsx)(s.h,{className:"h-100",hideToggle:!0,hideDescription:!0,effect:a,factory:o,onChange:function(){return e.setEffect(r,a)}})},r)}))})]})}}}]);