"use strict";(self.webpackChunkgenshin_gui=self.webpackChunkgenshin_gui||[]).push([[1749],{7155:function(n,e,r){r.d(e,{J:function(){return f}});var t=r(1413),i=r(10340),a=r(37671),o=function(){var n=(0,i.T)(),e=(0,i.C)((function(n){return n.config}));return(0,t.Z)((0,t.Z)({},e),{},{setWorkers:function(e){n(a.Nw.setWorkers(e))}})},s=r(36687),c=r(93298),l=r(41251),u=r(45624),d=r(46417),x=window.navigator.hardwareConcurrency||4,h=Array.from(Array(x).keys()).map((function(n){return n+1}));function f(){var n=o();return(0,d.jsxs)(s.Z,{children:[(0,d.jsx)(c.Z,{disabled:!0,children:"Workers"}),(0,d.jsx)(l.Z,{title:n.workers,onSelect:function(e){if(e){var r=parseInt(e)||4;n.setWorkers(r)}},as:s.Z,children:h.map((function(n){return(0,d.jsx)(u.Z.Item,{eventKey:n,children:n},n)}))})]})}},91527:function(n,e,r){r.d(e,{e:function(){return h}});var t=r(1413),i=r(45987),a=r(45043),o=r(68582),s=r(79188),c=r(47313),l=r(2532),u=r(46417),d=["type","value","onChange","allowAny"];function x(n){return a.G.Describe.getTitle(n.name).toLowerCase()}function h(n){var e=n.type,r=n.value,h=n.onChange,f=n.allowAny,Z=(0,i.Z)(n,d),v=(0,o.Z)().language,p=(0,c.useMemo)((function(){var n=a.G.Database.getWeaponFactoriesFor(e).sort((function(n,e){return x(n).localeCompare(x(e))}));return{3:n.filter((function(n){return 3===n.stars})),4:n.filter((function(n){return 4===n.stars})),5:n.filter((function(n){return 5===n.stars}))}}),[e,v]);function j(n){var r=a.G.Database.getWeaponFactoriesFor(e).find((function(e){return e.name===n}));r?h(r.name):f&&h(void 0)}return(0,u.jsxs)(l.Z.Select,(0,t.Z)((0,t.Z)({},Z),{},{onChange:function(n){return j(n.target.value)},value:r||-1,children:[f&&(0,u.jsx)("option",{value:-1,children:(0,s.KF)("ANY")}),(0,u.jsx)("optgroup",{label:"3x",children:p[3].map((function(n){return(0,u.jsx)("option",{value:n.name,children:a.G.Describe.getTitle(n.name)},n.name)}))}),(0,u.jsx)("optgroup",{label:"4x",children:p[4].map((function(n){return(0,u.jsx)("option",{value:n.name,children:a.G.Describe.getTitle(n.name)},n.name)}))}),(0,u.jsx)("optgroup",{label:"5x",children:p[5].map((function(n){return(0,u.jsx)("option",{value:n.name,children:a.G.Describe.getTitle(n.name)},n.name)}))})]}))}},1749:function(n,e,r){r.r(e),r.d(e,{default:function(){return pn},position:function(){return vn},title:function(){return Zn}});var t=r(74165),i=r(1413),a=r(15861),o=r(96103),s=r(7155),c=r(84825),l=r(98791),u=r(45987),d=r(48648),x=r(93298),h=r(46417),f=["value","icon"];function Z(n){var e=n.value,r=n.icon,t=(0,u.Z)(n,f),a=r;return(0,h.jsx)(d.Z,{children:(0,h.jsxs)(x.Z,(0,i.Z)((0,i.Z)({},t),{},{children:[a&&(0,h.jsx)(a,{className:"me-1",style:{verticalAlign:"-0.125em"}}),e]}))})}var v=r(30699),p=r(79188),j=r(66972),g=r(65832),m=r(63849),C=r(31616),A=r(74308),w=r(93324),N=r(17829),F=r(47313),T=r(98410),b=r(2304),k=r(81018),I=r(59461),y=r(70441);function K(){var n=(0,v.K)(),e=n.getSavedRules(),r=(0,F.useState)(n.getActiveName()),t=(0,w.Z)(r,2),i=t[0],a=t[1],o=(0,F.useState)(!1),s=(0,w.Z)(o,2),c=s[0],l=s[1];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(T.Z,{size:"lg",show:c,onHide:function(){return l(!1)},children:[(0,h.jsx)(T.Z.Header,{closeButton:!0,children:(0,h.jsx)(T.Z.Title,{id:"contained-modal-title-vcenter",children:(0,p.KF)("ACTION_LOAD")})}),(0,h.jsx)(T.Z.Body,{children:(0,h.jsx)(R,{options:e,value:i,onChange:function(n){a(n)},onDelete:function(r){a(e[0]),n.removeSavedRules(r)}})}),(0,h.jsx)(T.Z.Footer,{children:(0,h.jsx)(x.Z,{onClick:function(){n.loadRules(i),l(!1)},children:(0,p.KF)("DIALOG_ACCEPT")})})]}),(0,h.jsx)(Z,{onClick:function(){return l(!0)},value:(0,p.KF)("ACTION_LOAD"),icon:k.Z})]})}function R(n){var e=n.value,r=n.options,i=n.onChange,o=n.onDelete;function s(){return(s=(0,a.Z)((0,t.Z)().mark((function n(e){return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,N.Q)({message:(0,h.jsx)(y.D,{children:(0,p.KF)("ACTION_CONFIRMDELETE",{name:e})})});case 2:if(n.sent){n.next=5;break}return n.abrupt("return");case 5:o(e);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return r.length?(0,h.jsx)(b.Z,{children:r.map((function(n){return(0,h.jsx)(b.Z.Item,{action:!0,as:"div",active:n===e,onClick:function(){i(n)},children:(0,h.jsxs)(d.Z,{direction:"horizontal",gap:1,children:[(0,h.jsx)("div",{className:"me-auto",children:n}),(0,h.jsx)(x.Z,{onClick:function(){return function(n){return s.apply(this,arguments)}(n)},variant:"danger",children:(0,h.jsx)(I.Z,{})})]})},n)}))}):(0,h.jsx)("div",{className:"text-center",children:(0,p.KF)("OPTIMIZER_EMPTY")})}var E=r(12014),D=r(60850),O=r(93433),_=r(42771),M=r(91527),G=r(98698),S=["condition","onChange"];function P(n){var e,r=n.condition,t=n.onChange,a=(0,u.Z)(n,S),s=null!==(e=null===r||void 0===r?void 0:r.weapon)&&void 0!==e?e:{};return(0,h.jsxs)(G.Z,(0,i.Z)((0,i.Z)({},a),{},{children:[(0,h.jsx)(x.Z,{disabled:!0,style:{width:"33%"},children:(0,p.KF)("WEAPON")}),(0,h.jsx)(M.e,{allowAny:!0,type:(0,o.tl)().weaponType,value:s.name,onChange:function(n){t((0,i.Z)((0,i.Z)({},r),{},{weapon:(0,i.Z)((0,i.Z)({},s),{},{name:n})}))}})]}))}var L=r(10072),z=r(45043),H=["condition","onChange"];function W(n){var e,r=n.condition,t=n.onChange,a=(0,u.Z)(n,H),o=null!==(e=null===r||void 0===r?void 0:r.weapon)&&void 0!==e?e:{};return(0,h.jsxs)(G.Z,(0,i.Z)((0,i.Z)({},a),{},{children:[(0,h.jsx)(x.Z,{disabled:!0,style:{width:"33%"},children:(0,p.KF)("ARTIFACT_SUBSTAT_SHORT")}),(0,h.jsx)(L.w,{allowAny:!0,value:o.substat,options:z.G.Values.ListCharacterStat,onChange:function(n){t((0,i.Z)((0,i.Z)({},r),{},{weapon:(0,i.Z)((0,i.Z)({},o),{},{substat:n})}))}})]}))}function B(n){var e,r,t,a=n.rule,o=n.onChange,s=null!==(e=null===(r=a.condition)||void 0===r||null===(t=r.weapon)||void 0===t?void 0:t.rank)&&void 0!==e?e:[];return(0,h.jsxs)(d.Z,{direction:"horizontal",gap:1,className:"align-items-stretch",children:[(0,h.jsx)(x.Z,{disabled:!0,variant:"warning",className:"text-black",children:(0,p.KF)("CONDITION")}),(0,h.jsxs)(m.Z,{className:"w-100 gx-1 gy-1",children:[(0,h.jsx)(C.Z,{xs:12,xl:6,children:(0,h.jsx)(P,{className:"w-100",condition:a.condition,onChange:o})}),(0,h.jsx)(C.Z,{xs:12,xl:6,children:(0,h.jsx)(_.U,{className:"w-100",ranks:s,onAdd:function(n){var e;o((0,i.Z)((0,i.Z)({},a.condition),{},{weapon:(0,i.Z)((0,i.Z)({},null===(e=a.condition)||void 0===e?void 0:e.weapon),{},{rank:[].concat((0,O.Z)(s.filter((function(e){return e!==n}))),[n])})}))},onDelete:function(n){var e,r=s.filter((function(e){return e!==n}));o((0,i.Z)((0,i.Z)({},a.condition),{},{weapon:(0,i.Z)((0,i.Z)({},null===(e=a.condition)||void 0===e?void 0:e.weapon),{},{rank:r.length>0?r:void 0})}))}})}),(0,h.jsx)(C.Z,{xs:12,xl:6,children:(0,h.jsx)(W,{className:"w-100",condition:a.condition,onChange:o})})]})]})}var V=r(2532);function U(n){var e=n.stats,r=n.onChange;function t(n,t){if(e&&t){var i=(0,O.Z)(e);i[n]=t,r(i)}}return(0,h.jsxs)(d.Z,{gap:1,children:[(0,h.jsx)(x.Z,{as:"div",variant:"warning",className:"text-black",onClick:function(){r(!e?["ATKpercent","ATKpercent","ATKpercent"]:void 0)},children:(0,h.jsx)(V.Z.Check,{type:"checkbox",label:(0,p.KF)("ARTIFACT_MAINSTAT_CHANGE"),onChange:function(){},checked:!!e})}),e?e.map((function(n,e){return(0,h.jsx)(L.w,{size:"sm",value:n,options:J[e],onChange:function(n){return t(e,n)}},e)})):null]})}var J=[z.G.getMainstatsFor("Sands"),z.G.getMainstatsFor("Goblet"),z.G.getMainstatsFor("Circlet")],Q=["provided"],X=["innerKey"];function Y(n){return(0,h.jsxs)(m.Z,{className:"gx-1 gy-1",children:[(0,h.jsxs)(C.Z,{xs:12,children:[(0,h.jsx)(B,{rule:n.rule,onChange:n.onChangeCondition}),(0,h.jsx)("hr",{})]}),(0,h.jsx)(C.Z,{xl:8,xs:12,children:(0,h.jsx)(D.Z,{filters:n.rule.filter,onAdd:n.onAddFilter,onDelete:n.onDeleteFilter,onChange:n.onChangeFilter})}),(0,h.jsx)(C.Z,{xl:4,xs:12,children:(0,h.jsx)(U,{stats:n.rule.mainstats,onChange:n.onChangeMainstats})})]})}function q(n){var e=n.provided,r=(0,u.Z)(n,Q);return(0,h.jsxs)(g.Z,(0,i.Z)((0,i.Z)((0,i.Z)({ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{children:[(0,h.jsx)(g.Z.Header,{children:(0,h.jsxs)(d.Z,{direction:"horizontal",gap:1,children:[(0,h.jsx)("h5",{className:"m-0 me-auto",children:(0,p.KF)("RULE")}),(0,h.jsx)(x.Z,{size:"sm",onClick:r.onDelete,variant:"danger",children:(0,h.jsx)(E.Z,{style:{verticalAlign:"-0.125em"}})})]})}),(0,h.jsx)(g.Z.Body,{children:(0,h.jsx)(Y,(0,i.Z)({},r))})]}))}function $(n){var e=n.innerKey,r=(0,u.Z)(n,X);return(0,h.jsx)(j._l,{draggableId:"drag-"+e,index:e,children:function(n){return(0,h.jsx)(q,(0,i.Z)((0,i.Z)({},r),{},{provided:n}))}})}var nn=r(94860),en=r(56122),rn=r(26934);function tn(){var n=(0,v.K)(),e=n.getSavedRules(),r=(0,F.useMemo)((function(){return new nn.z0(e)}),[e]);function i(){return(i=(0,a.Z)((0,t.Z)().mark((function e(){var i;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,en.m)({title:(0,p.KF)("ACTION_SAVE"),defaultValue:n.getActiveName(),validate:function(n){var e=r.validateName(n);return"NAME_OK"===e||"NAME_EXISTING"===e||(0,p.KF)(e)}});case 2:if(i=e.sent){e.next=5;break}return e.abrupt("return");case 5:if("NAME_EXISTING"!==r.validateName(i)){e.next=11;break}return e.next=8,(0,N.Q)({message:(0,h.jsx)(y.D,{children:(0,p.KF)("ACTION_CONFIRMREPLACE",{name:i})})});case 8:if(e.sent){e.next=11;break}return e.abrupt("return");case 11:n.saveRules(i);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,h.jsx)(Z,{onClick:function(){return i.apply(this,arguments)},value:(0,p.KF)("ACTION_SAVE"),icon:rn.Z})}function an(n){var e=n.rule,r=n.index,t=(0,v.K)();return(0,h.jsx)($,{innerKey:r,rule:e,onAddFilter:function(){return t.addRuleFilter(r)},onDeleteFilter:function(n){return t.removeRuleFilter(r,n)},onChangeFilter:function(n,e){return t.setRuleFilter(r,n,e)},onChangeMainstats:function(n){return t.setRuleMainstats(r,n)},onChangeCondition:function(n){return t.setRuleCondition(r,n)},onDelete:function(){return t.removeRule(r)}})}function on(){var n=(0,v.K)();return(0,h.jsx)(Z,{onClick:function(){return n.addRule({})},value:(0,p.KF)("ACTION_ADD"),icon:A.Z})}function sn(){var n=(0,v.K)(),e=n.getRules();return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(g.Z,{children:[(0,h.jsx)(g.Z.Header,{as:"h5",className:"bg-info",children:(0,p.KF)("OPTIMIZER_WEAPON_RULES")}),(0,h.jsx)(g.Z.Body,{children:(0,h.jsxs)(m.Z,{className:"gx-1 gy-1",children:[(0,h.jsx)(C.Z,{xs:12,xl:6,children:(0,h.jsx)(on,{})}),(0,h.jsx)(C.Z,{xs:12,xl:3,children:(0,h.jsx)(tn,{})}),(0,h.jsx)(C.Z,{xs:12,xl:3,children:(0,h.jsx)(K,{})})]})})]}),(0,h.jsx)(j.Z5,{onDragEnd:function(e){var r=e.source,t=e.destination;if(t){var i=r.index,a=t.index;i!==a&&n.reorderRules(i,a)}},children:(0,h.jsx)(j.bK,{droppableId:"weapon-rules",children:function(n){return(0,h.jsxs)(d.Z,(0,i.Z)((0,i.Z)({gap:1},n.droppableProps),{},{ref:n.innerRef,children:[e.map((function(n,e){return(0,h.jsx)(an,{rule:n,index:e},e)})),n.placeholder]}))}})})]})}var cn=r(1836),ln=r(34805),un=r(46323),dn=r(29447);function xn(n,e){var r=performance.now();return n.character instanceof z.G.Character&&(n.character=z.G.CharacterLoader.exportCharacter(n.character)),n.rotation instanceof z.G.Rotation&&(n.rotation=z.G.RotationLoader.exportRotation(n.rotation)),(0,dn.HB)().postMessage({id:r,type:"optimizer-weapon-advanced",data:n}),new Promise((function(n){var t=(0,dn.HB)().addMessageListener((function(i){i.id===r&&(!1===i.complete?e(i.result):(n(i.result),(0,dn.HB)().removeMessageListener(t)))}))}))}var hn=r(47017),fn=r(97890),Zn="OPTIMIZER_WEAPON_ADVANCED",vn=2;function pn(){var n=(0,ln.t)(),e=(0,cn.r)(),r=(0,un.a)(),u=(0,fn.s0)();function f(){return(f=(0,a.Z)((0,t.Z)().mark((function a(){var s,c,l,d;return(0,t.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=(0,o.vo)(),c=s.character,l=s.rotationId,e.show(),t.next=4,(0,hn.q$)({id:l});case 4:d=t.sent[0],xn((0,i.Z)({character:c,rotation:d},n.getConfig()),(function(n){e.setCurrent(n[0]),e.setTotal(n[1])})).then((function(n){var t=n.map((function(n){return n[0]})),i=n.map((function(n){return n[1]}));r.setRows(i),r.setStates(t),e.hide(),u("/editor/optimizer/results")}));case 6:case"end":return t.stop()}}),a)})))).apply(this,arguments)}return(0,h.jsxs)(d.Z,{gap:1,children:[(0,h.jsxs)(d.Z,{gap:1,direction:"horizontal",children:[(0,h.jsx)(x.Z,{variant:"warning",className:"text-black w-100",onClick:function(){return f.apply(this,arguments)},children:(0,p.KF)("OPTIMIZER_OPTIMIZE")}),(0,h.jsx)(s.J,{})]}),(0,h.jsx)(l.P,{}),(0,h.jsx)(c.N,{}),(0,h.jsx)(sn,{})]})}}}]);