"use strict";(self.webpackChunkgenshin_gui=self.webpackChunkgenshin_gui||[]).push([[630,7017,3736,720,6474,7829],{99719:function(e,n,t){var r;function a(){return r}function i(e){r=e}t.d(n,{$:function(){return i},o:function(){return a}})},30448:function(e,n,t){t.d(n,{c:function(){return u},j:function(){return s}});var r=t(74165),a=t(15861),i=t(93433),c=t(15671),o=t(43144),s=function(){function e(n,t){(0,c.Z)(this,e),this.delay=n,this.callback=t,this.counter=0,this.completed=!0,this.lastParam=void 0,this.onReturn=function(){}}return(0,o.Z)(e,[{key:"internalCall",value:function(e){for(var n=this,t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];this.completed&&(this.completed=!1,setTimeout((function(){n.onReturn(n.callback.apply(n,r)),n.completed=!0,n.counter!==e&&n.lastParam&&n.internalCall.apply(n,[n.counter].concat((0,i.Z)(n.lastParam)))}),this.delay))}},{key:"call",value:function(){this.counter++;for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];this.lastParam=n,this.internalCall.apply(this,[this.counter].concat(n))}}]),e}();function u(e){return l.apply(this,arguments)}function l(){return(l=(0,a.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,n)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},60720:function(e,n,t){function r(e,n,t){"string"===typeof e&&(e=[e]);var r=t?function(e,n){return e===n}:function(e,n){return e.toLowerCase().includes(n.toLowerCase())},a=e;return n.map((function(e,n){return a.some((function(n){return"string"===typeof e?r(e,n):e.some((function(e){return r(e,n)}))}))?n:-1})).filter((function(e){return-1!==e}))}t.d(n,{D:function(){return r}})},66305:function(e,n,t){t.d(n,{y:function(){return d}});var r=t(45043),a=t(79188),i=t(36687),c=t(93298),o=t(41251),s=t(45624),u=t(23291),l=t(46417);function d(e){var n=e.aura,t=e.onChange,d=(0,l.jsxs)("div",{className:"d-inline-flex align-items-center",children:[n?(0,l.jsx)(u.Z,{width:16,height:16,element:n}):(0,l.jsx)("div",{className:"d-inline-block",style:{height:16}}),n?r.G.Describe.getTitle("Aura."+n):r.G.Describe.getTitle("NONE")]});return(0,l.jsxs)(i.Z,{children:[(0,l.jsx)(c.Z,{disabled:!0,className:"text-nowrap",children:(0,a.KF)("EFFECT_AURA")}),(0,l.jsxs)(o.Z,{onSelect:function(e){t(e||void 0)},as:i.Z,title:d,children:[(0,l.jsx)(s.Z.Item,{eventKey:void 0,children:r.G.Describe.getTitle("NONE")}),r.G.Values.ListElementalAura.map((function(e){return(0,l.jsx)(s.Z.Item,{active:n===e,eventKey:e,children:(0,l.jsxs)("div",{className:"d-flex align-items-center",children:[(0,l.jsx)(u.Z,{element:e}),r.G.Describe.getTitle("Aura."+e)]})},e)}))]})]})}},97273:function(e,n,t){t.d(n,{C:function(){return p}});var r=t(74165),a=t(15861),i=t(1413),c=t(15671),o=t(43144),s=t(60136),u=t(27277),l=t(47313),d=t(2304),f=t(80035),h=t(46417),p=function(e){(0,s.Z)(t,e);var n=(0,u.Z)(t);function t(){return(0,c.Z)(this,t),n.apply(this,arguments)}return(0,o.Z)(t,[{key:"render",value:function(){var e=this,n=(0,i.Z)({},this.props);delete n.item,delete n.actions,delete n.onActionFinish,delete n.popover;var t=!1!==this.props.popover,c=(0,h.jsx)(d.Z,{children:this.props.actions.map((function(n,t){return(0,h.jsx)(d.Z.Item,{action:!0,onClick:(0,a.Z)((0,r.Z)().mark((function a(){var i,c,o;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.action(e.props.item);case 2:o=r.sent,null===(i=(c=e.props).onActionFinish)||void 0===i||i.call(c,t,o);case 4:case"end":return r.stop()}}),a)}))),children:n.title},t)}))});return t?(0,h.jsx)(f.Z,(0,i.Z)((0,i.Z)({},n),{},{children:(0,h.jsx)(f.Z.Body,{children:c})})):c}}]),t}(l.Component)},88893:function(e,n,t){t.d(n,{X:function(){return s}});var r=t(1413),a=t(45987),i=t(29162),c=t(46417),o=["options"];function s(e){var n=e.options,t=(0,a.Z)(e,o);return(0,c.jsx)(i.pY,(0,r.Z)((0,r.Z)({},t),{},{options:n||[],multiple:!0}))}},95878:function(e,n,t){t.d(n,{L:function(){return c}});var r=t(93324),a=t(47313),i=t(46417);function c(e){var n,t=e.children,c=(0,a.useReducer)((function(e){return(e+1)%7}),0),o=(0,r.Z)(c,2)[1];return(0,i.jsx)(i.Fragment,{children:null!==(n=t(o))&&void 0!==n?n:null})}},17829:function(e,n,t){t.d(n,{Q:function(){return d}});var r=t(93324),a=t(79188),i=t(47313),c=t(98410),o=t(93298),s=t(76487),u=t(46417);function l(e){var n,t,s,l,d=(0,i.useState)(!0),f=(0,r.Z)(d,2),h=f[0],p=f[1],v=e.props;function x(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];p(!1),e.proceed(n)}var m=null===(n=null===v||void 0===v?void 0:v.closeButton)||void 0===n||n,g=null===(t=e.props)||void 0===t?void 0:t.message,Z=g?"function"===typeof g?g(x):g:"";return(0,u.jsxs)(c.Z,{size:null!==(s=null===v||void 0===v?void 0:v.size)&&void 0!==s?s:"lg",show:h,onHide:x,children:[(0,u.jsx)(c.Z.Header,{closeButton:m,children:(0,u.jsx)(c.Z.Title,{id:"contained-modal-title-vcenter",children:null!==(l=null===v||void 0===v?void 0:v.title)&&void 0!==l?l:(0,a.KF)("DIALOG_CONFIRM")})}),(0,u.jsx)(c.Z.Body,{children:Z}),(0,u.jsxs)(c.Z.Footer,{children:[(0,u.jsx)(o.Z,{variant:"success",onClick:function(){return x(!0)},children:(null===v||void 0===v?void 0:v.accept)||(0,a.KF)("DIALOG_ACCEPT")}),(0,u.jsx)(o.Z,{variant:"danger",onClick:function(){return x(!1)},children:(null===v||void 0===v?void 0:v.cancel)||(0,a.KF)("DIALOG_CANCEL")})]})]})}var d=function(e){return(0,s.LA)((0,s.mP)(l))({props:e})}},56122:function(e,n,t){t.d(n,{m:function(){return h}});var r=t(93324),a=t(79188),i=t(47313),c=t(95491),o=t(2532),s=t(98410),u=t(93298),l=t(76487),d=t(46417);function f(e){var n,t,l,f,h,p,v,x=(0,i.useState)(!0),m=(0,r.Z)(x,2),g=m[0],Z=m[1],j=(0,i.useState)(null!==(n=null===(t=e.props)||void 0===t?void 0:t.defaultValue)&&void 0!==n?n:""),y=(0,r.Z)(j,2),N=y[0],T=y[1],E=(0,i.useState)(void 0),C=(0,r.Z)(E,2),O=C[0],A=C[1];function b(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;Z(!1),e.proceed(n)}(0,i.useEffect)((function(){var n,t=null===(n=e.props)||void 0===n?void 0:n.validate;if(t){var r=t(N);A(!0===r?void 0:r)}}),[N,null===(l=e.props)||void 0===l?void 0:l.validate]);var w=null===(f=e.props)||void 0===f?void 0:f.label,I=null===(h=e.props)||void 0===h?void 0:h.message,_=I?"function"===typeof I?I(b):I:"",D=w?(0,d.jsx)(c.Z,{label:w,className:"mb-3",children:(0,d.jsx)(o.Z.Control,{type:"text",placeholder:w,value:N,onChange:function(e){return T(e.target.value)},className:O?"is-invalid":""})}):(0,d.jsx)(o.Z.Control,{type:"text",value:N,onChange:function(e){return T(e.target.value)},className:O?"is-invalid":""});return(0,d.jsxs)(s.Z,{size:"lg",show:g,onHide:b,children:[(0,d.jsx)(s.Z.Header,{closeButton:!0,children:(0,d.jsx)(s.Z.Title,{id:"contained-modal-title-vcenter",children:null!==(p=null===(v=e.props)||void 0===v?void 0:v.title)&&void 0!==p?p:(0,a.KF)("DIALOG_PROMPT")})}),(0,d.jsxs)(s.Z.Body,{children:[_,D,(0,d.jsx)("div",{className:"text-center",children:(0,d.jsx)(o.Z.Text,{className:"text-danger",children:null!==O&&void 0!==O?O:""})})]}),(0,d.jsx)(s.Z.Footer,{children:(0,d.jsx)(u.Z,{disabled:!!O,onClick:function(){return b(N)},children:(0,a.KF)("DIALOG_ACCEPT")})})]})}var h=function(e){return(0,l.LA)((0,l.mP)(f))({props:e})}},13736:function(e,n,t){t.d(n,{h:function(){return o}});var r=t(93324),a=t(47313),i=t(38804),c=t(46417);function o(e,n){var t=(0,a.useState)(1),o=(0,r.Z)(t,2),s=o[0],u=o[1],l=(0,a.useMemo)((function(){return Math.ceil(e.length/n)}),[e,n]),d=(0,a.useMemo)((function(){var e=Array.from(Array(l).keys()).map((function(e){return e+1}));if(e.length>5){var n=e.length-s,t=Math.min(n,5),r=Math.max(5-t,Math.floor(2.5)),a=Math.max(0,s-r);return e.slice(a,a+5)}return e}),[l,s]);(0,a.useEffect)((function(){s>l&&u(1)}),[l,s]);var f=function(){var e=s-1;e<=0&&(e=l),u(e)},h=function(){var e=s+1;e>l&&(e=1),u(e)},p=(0,a.useMemo)((function(){return e.slice((s-1)*n,s*n)}),[s,e,n]);return{page:s,items:p,Pagination:function(){return(0,c.jsxs)(i.Z,{className:"m-0",children:[(0,c.jsx)(i.Z.Prev,{onClick:f}),d.map((function(e,n){return-1!==e?(0,c.jsx)(i.Z.Item,{active:e===s,onClick:function(){return u(e)},children:e},n):(0,c.jsx)(i.Z.Ellipsis,{},n)})),(0,c.jsx)(i.Z.Next,{onClick:h})]})},gotoNext:h,gotoPrev:f,findItem:function(t){var r=e.indexOf(t)+1;return r<0?-1:Math.ceil(r/n)},setPage:function(e){e<1&&(e=1),e>l&&(e=l),u(e)}}}},46474:function(e,n,t){t.d(n,{R:function(){return c}});var r=t(93324),a=t(60720),i=t(47313);function c(e,n,t){var c=(0,i.useState)(t||""),o=(0,r.Z)(c,2),s=o[0],u=o[1],l=(0,i.useMemo)((function(){return s?(0,a.D)(s,e.map((function(e){return n(e)}))).map((function(n){return e[n]})):e}),[s,e,n]);return(0,i.useEffect)((function(){return u(t||"")}),[t]),{search:s,setSearch:u,items:l}}},90630:function(e,n,t){t.r(n),t.d(n,{default:function(){return He}});var r=t(99719),a=t(93324),i=t(47313),c=(0,i.createContext)({x:0,y:0,rotation:{}}),o=function(){return(0,i.useContext)(c)},s=(0,i.createContext)({rotation:{},update:function(){},save:function(){},readonly:!1,mode:"move",setMode:function(){}}),u=function(){return(0,i.useContext)(s)},l=t(1413),d=t(45987),f=t(46417),h=["rows","columns","map"];function p(e){var n=e.rows,t=e.columns,r=e.map,a=(0,d.Z)(e,h),c=(0,i.useMemo)((function(){return Array.from(Array(n)).map((function(e,n){return n}))}),[n]),o=(0,i.useMemo)((function(){return Array.from(Array(t)).map((function(e,n){return n}))}),[t]);return(0,f.jsx)("table",(0,l.Z)((0,l.Z)({},a),{},{children:(0,f.jsx)("tbody",{children:c.map((function(e){return(0,f.jsx)("tr",{children:o.map((function(n){return(0,f.jsx)("td",{children:r(n,e)},n)}))},e)}))})}))}var v=t(74165),x=t(15861),m=t(95878),g=t(75936),Z=t(45043),j=t(79188),y=t(17829),N=t(48648),T=t(31136),E=t(95668),C=t(93298),O=t(42911),A=t(12014);function b(e){var n=e.characters,t=e.title,r=e.onClick,a=u(),i=a.rotation,c=a.update,s=a.readonly,l=o(),d=l.x,h=l.y;function p(){return(p=(0,x.Z)((0,v.Z)().mark((function e(){var n,t;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,y.Q)({message:(0,j.KF)("ROTATION_ACTION_CONFIRM_DELETE")});case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:if(n=i.actions){e.next=10;break}return e.abrupt("return");case 10:if(t=n[h]){e.next=13;break}return e.abrupt("return");case 13:t[d]=void 0,c();case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,f.jsxs)("div",{className:"cell-header p-1 d-flex justify-content-between align-items-center",children:[(0,f.jsx)(N.Z,{direction:"horizontal",gap:1,children:n.map((function(e,n){var t=Z.G.Describe.getTitle(e);return(0,f.jsx)(T.Z,{trigger:["hover","focus"],overlay:(0,f.jsx)(E.Z,{children:t}),children:(0,f.jsx)("div",{className:"badge bg-warning text-black",children:t[0]})},n)}))}),(0,f.jsx)("div",{className:"text-white",children:t||""}),(0,f.jsxs)(N.Z,{direction:"horizontal",gap:1,children:[(0,f.jsx)(T.Z,{trigger:["hover","focus"],overlay:(0,f.jsx)(E.Z,{children:(0,j.KF)("ACTION_EDIT")}),children:(0,f.jsx)(C.Z,{size:"sm",onClick:r,disabled:s,children:(0,f.jsx)(O.Z,{style:{verticalAlign:"-0.125em"}})})}),(0,f.jsx)(T.Z,{trigger:["hover","focus"],overlay:(0,f.jsx)(E.Z,{children:(0,j.KF)("ACTION_DELETE")}),children:(0,f.jsx)(C.Z,{variant:"danger",size:"sm",onClick:function(){return p.apply(this,arguments)},disabled:s,children:(0,f.jsx)(A.Z,{style:{verticalAlign:"-0.125em"}})})})]})]})}var w=t(85278),I=t(88893),_=t(65832);function D(e,n){return(n.characterName?"string"===typeof n.characterName?[n.characterName]:n.characterName:"string"===typeof e.characterName?[e.characterName]:e.characterName).filter((function(e,n,t){return t.indexOf(e)===n}))}function F(e){var n=e.rotation,t=e.control,r=(0,i.useReducer)((function(e){return(e+1)%7}),0),c=(0,a.Z)(r,2)[1],o=D(n,n).map((function(e){return{id:e,label:Z.G.Describe.getTitle(e)}})),s=D(n,t).map((function(e){return{id:e,label:Z.G.Describe.getTitle(e)}}));return(0,f.jsxs)(_.Z,{children:[(0,f.jsx)(_.Z.Header,{className:"bg-primary",children:(0,j.KF)("ROTATION_ACTION_APPLIES_TO")}),(0,f.jsx)(_.Z.Body,{children:(0,f.jsx)(I.X,{placeholder:(0,j.KF)("ROTATION_ACTION_APPLIES_TO"),id:"control-characters-select",options:o,selected:s,onChange:function(e){var n=e.map((function(e){return e.id+""}));n.length>0&&n.length<=4&&(t.characterName=n),c()}})})]})}var M=t(2532),k=["aura","condition","enabled","inputs","stacks"];function R(e){var n=e.control,t=e.type,r=n.constantProperties,c=(0,i.useReducer)((function(e){return(e+1)%7}),0),o=(0,a.Z)(c,2)[1];function s(e){return!(null!==r&&void 0!==r&&r.includes(e))}var u="weapon"===t?k.filter((function(e){return"enabled"!==e})):k;return(0,f.jsxs)(_.Z,{children:[(0,f.jsx)(_.Z.Header,{className:"bg-primary",children:(0,j.KF)("ROTATION_CONTROLLED_CONFIG")}),(0,f.jsx)(_.Z.Body,{children:(0,f.jsx)(M.Z,{children:u.map((function(e){return(0,f.jsx)(M.Z.Group,{controlId:"prop-controll-"+e,children:(0,f.jsx)(M.Z.Check,{type:"checkbox",checked:s(e),onChange:function(){return function(e){var t=s(e),a=r;a?t?a.push(e):a=a.filter((function(n){return n!==e})):t&&(a=[e]),n.constantProperties=a,o()}(e)},label:(0,j.KF)(e.toUpperCase())})},e)}))})})]})}function G(e){var n=e.rotation,t=e.control,r=e.factory,a=e.type,i=e.onChange,c=t.effect;return(0,f.jsxs)(N.Z,{gap:1,children:[(0,f.jsx)(F,{control:t,rotation:n}),(0,f.jsx)(w.h,{hideRank:!0,hideToggle:"weapon"===a,onChange:function(e){!0===e?c.enabled=!0:!1===e&&(c.enabled=!1),i()},effect:c,factory:r}),(0,f.jsx)(R,{control:t,type:a})]})}var K=t(96103);function L(e){var n=e.control,t=u(),r=t.save,a=t.rotation,c=t.update,s=function(e){var n=o().rotation,t=e.artifact?"artifact":e.weapon?"weapon":"character",r=(0,i.useMemo)((function(){switch(t){case"artifact":if(e.artifact)return Z.G.Database.getArtifactBonusFactory(e.artifact).effects.find((function(n){return n.name===e.effect.name}));break;case"weapon":if(e.weapon)return Z.G.Database.getWeaponFactory(e.weapon).effects.find((function(n){return n.name===e.effect.name}));break;case"character":var n=[];(0,K.tl)().effects.get().forEach((function(e){return n.push(e)})),(0,K.tl)().effects.getExternal().forEach((function(e){return n.push(e)}));var r=n.find((function(n){return n.name===e.effect.name}));return r?r.factory:void 0}}),[e]),a=D(n,e);return{type:t,factory:r,character:a}}(n),l=s.type,d=s.factory,h=s.character;if(!d)return null;function p(){return p=(0,x.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,g.a)({title:(0,j.KF)("ACTION_EDIT"),message:(0,f.jsx)(m.L,{children:function(e){return(0,f.jsx)(G,{rotation:a,control:n,factory:d,type:l,onChange:function(){e(),r()}})}})});case 4:c();case 5:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}return(0,f.jsxs)("div",{children:[(0,f.jsx)(b,{title:(0,j.KF)(n.weapon?"WEAPON":"EFFECT"),characters:h,onClick:function(){return p.apply(this,arguments)}}),n.weapon?(0,f.jsx)("div",{className:"text-center",children:(0,f.jsx)("strong",{children:Z.G.Describe.getTitle(n.weapon)})}):null,(0,f.jsx)("div",{className:"text-center",children:Z.G.Describe.getTitle(d)})]})}var S=t(23291),P=t(93433);function B(e){var n=Z.G.Database.getCharacterFactories().find((function(n){return n.name===e}));if(!n)throw new Error("Character not found: "+e);return[].concat((0,P.Z)(n.NormalAttacks.map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{group:"DAMAGE_NORMALS"})}))),(0,P.Z)(n.ElementalSkills.map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{group:"DAMAGE_ES"})}))),(0,P.Z)(n.ElementalBursts.map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{group:"DAMAGE_EB"})}))),(0,P.Z)(n.ExtraDamage.map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{group:"DAMAGE_EXTRA"})}))),(0,P.Z)(H.map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{group:"DAMAGE_EXTRA"})}))))}var H=[{name:"Reaction.OverloadDMG",ElementalDMG:"PyroDMG"},{name:"Reaction.ElectrochargeDMG",ElementalDMG:"ElectroDMG"},{name:"Reaction.ShatterDMG",ElementalDMG:"PhysicalDMG"},{name:"Reaction.SuperconductDMG",ElementalDMG:"CryoDMG"},{name:"Reaction.SwirlDMG.CryoDMG",ElementalDMG:"CryoDMG"},{name:"Reaction.SwirlDMG.ElectroDMG",ElementalDMG:"ElectroDMG"},{name:"Reaction.SwirlDMG.HydroDMG",ElementalDMG:"HydroDMG"},{name:"Reaction.SwirlDMG.PyroDMG",ElementalDMG:"PyroDMG"}];function U(e){var n=e.character,t=e.characters,r=e.onChange;return(0,f.jsxs)(_.Z,{children:[(0,f.jsx)(_.Z.Header,{className:"bg-primary",children:(0,j.KF)("ROTATION_ACTION_APPLIES_TO")}),(0,f.jsx)(_.Z.Body,{children:(0,f.jsx)(M.Z,{children:(0,f.jsx)(M.Z.Select,{value:n,onChange:function(e){return r(e.target.value)},children:t.map((function(e){return(0,f.jsx)("option",{value:e,children:Z.G.Describe.getTitle(e)},e)}))})})})]})}var W=t(66305),z=t(64919),V=t(98698),X=t(63849),Y=t(31616);function Q(e){var n,t=e.instance,r=e.character,a=e.onChange,c=e.hideChangeInstance,o=(0,i.useMemo)((function(){var e=B(r),n={};e.forEach((function(e){var t=n[e.group];t||(t=n[e.group]=[]),t.push(e.name)}));var t=[];return Object.keys(n).forEach((function(e){t.push([e,n[e]])})),t}),[r]),s=t.instanceName||(null===(n=t.instance)||void 0===n?void 0:n.name);if(!s)return null;function u(e){t.instanceName=e,a()}var l=c?null:(0,f.jsx)(M.Z.Select,{value:s,onChange:function(e){return u(e.target.value)},children:o.map((function(e){return(0,f.jsx)("optgroup",{label:(0,j.KF)(e[0]),children:e[1].map((function(e){return(0,f.jsx)("option",{value:e,children:Z.G.Describe.getTitle(e)},e)}))},e[0])}))});var d=(0,f.jsx)(W.y,{aura:t.affectedBy,onChange:function(e){t.affectedBy=e,a()}});var h=(0,f.jsx)(z.K,{places:0,value:t.count,onChange:function(e,n){t.count=Math.floor(Math.max(0,Math.min(999,e))),e!==t.count&&n(),a()},children:(0,f.jsx)(V.Z.Text,{style:{width:96},children:(0,j.KF)("ROTATION_COUNT_SHORT")})});var p=(0,f.jsx)(z.K,{places:1,value:t.multiplier,percent:!0,onChange:function(e,n){t.multiplier=Math.max(0,Math.min(9.99,e)),e!==t.multiplier&&n(),a()},children:(0,f.jsx)(V.Z.Text,{style:{width:96},children:(0,j.KF)("ROTATION_AOE")})});var v=(0,f.jsx)(z.K,{places:1,percent:!0,value:t.paura,onChange:function(e,n){t.paura=Math.max(0,Math.min(1,e)),e!==t.paura&&n(),a()},children:(0,f.jsx)(V.Z.Text,{style:{width:96},children:(0,j.KF)("ROTATION_AURA_VALUE")})});var x=(0,f.jsx)(z.K,{places:1,percent:!0,value:t.preaction,onChange:function(e,n){t.preaction=Math.max(0,Math.min(t.paura,e)),e!==t.preaction&&n(),a()},children:(0,f.jsx)(V.Z.Text,{style:{width:96},children:(0,j.KF)("ROTATION_REACTION_VALUE")})});return(0,f.jsxs)(_.Z,{children:[(0,f.jsx)(_.Z.Header,{className:"bg-primary",children:(0,j.KF)("INSTANCE_EDIT")}),(0,f.jsx)(_.Z.Body,{children:(0,f.jsxs)(X.Z,{className:"gx-1 gy-1",children:[(0,f.jsx)(Y.Z,{xs:12,children:(0,f.jsxs)(N.Z,{direction:"horizontal",gap:1,children:[l,d]})}),(0,f.jsx)(Y.Z,{md:6,xs:12,children:h}),(0,f.jsx)(Y.Z,{md:6,xs:12,children:p}),(0,f.jsx)(Y.Z,{md:6,xs:12,children:v}),(0,f.jsx)(Y.Z,{md:6,xs:12,children:x})]})})]})}function $(e){var n=e.rotation,t=e.instance,r=e.onChange,a=e.hideChangeInstance,i=D(n,n),c=D(n,t)[0];return(0,f.jsxs)(N.Z,{gap:1,children:[(0,f.jsx)(U,{onChange:function(e){t.characterName=e,t.instanceName=B(e)[0].name,r()},character:c,characters:i}),(0,f.jsx)(Q,{onChange:r,instance:t,hideChangeInstance:a,character:c})]})}function q(e){var n,t=e.instance,r=e.hideChangeInstance,c=e.onChange,o=u(),s=o.rotation,l=o.save,d=(0,i.useReducer)((function(e){return(e+1)%7}),0),h=(0,a.Z)(d,2)[1],p=D(s,s),v=[D(s,t)[0]],x=p.indexOf(v[0])+1,y=t.instanceName||(null===(n=t.instance)||void 0===n?void 0:n.name);if(!y)return null;return(0,f.jsxs)("div",{className:"h-100 character-"+x,children:[(0,f.jsx)(b,{title:(0,j.KF)("DAMAGE_INSTANCES"),characters:v,onClick:function(){(0,g.a)({title:(0,j.KF)("ACTION_EDIT"),size:"lg",message:(0,f.jsx)(m.L,{children:function(e){return(0,f.jsx)($,{hideChangeInstance:r,onChange:function(){null===c||void 0===c||c(),l(),e(),h()},rotation:s,instance:t})}})})}}),(0,f.jsx)("div",{className:"p-1",children:(0,f.jsxs)(N.Z,{gap:1,children:[(0,f.jsx)("div",{className:"d-flex align-items-center justify-content-center text-center",children:(0,f.jsx)("div",{children:Z.G.Describe.getTitle(y)})}),(0,f.jsx)("div",{className:"d-flex justify-content-center",children:(0,f.jsxs)(N.Z,{direction:"horizontal",gap:1,className:"align-items-stretch",children:[(0,f.jsx)(T.Z,{trigger:["hover","focus"],overlay:(0,f.jsx)(E.Z,{children:(0,j.KF)("ROTATION_INSTANCE_COUNT")}),children:(0,f.jsxs)("div",{className:"badge bg-secondary bg-opacity-50 d-flex align-items-center",children:[t.count,"x"]})}),(0,f.jsx)(T.Z,{trigger:["hover","focus"],overlay:(0,f.jsx)(E.Z,{children:(0,j.KF)("ROTATION_INSTANCE_AOE")}),children:(0,f.jsx)("div",{className:"badge bg-secondary bg-opacity-50 d-flex align-items-center",children:Z.G.percent(t.multiplier)})}),t.affectedBy?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(T.Z,{trigger:["hover","focus"],overlay:(0,f.jsx)(E.Z,{children:(0,j.KF)("AURA_N",{aura:Z.G.Describe.getTitle("Aura."+t.affectedBy)})}),children:(0,f.jsxs)("div",{className:"d-flex align-items-center badge bg-secondary bg-opacity-50",children:[(0,f.jsx)(S.Z,{element:t.affectedBy,width:16,height:16}),Z.G.percent(t.paura)]})}),(0,f.jsx)(T.Z,{trigger:["hover","focus"],overlay:(0,f.jsx)(E.Z,{children:(0,j.KF)("ROTATION_REACTION_UPTIME")}),children:(0,f.jsxs)("div",{className:"d-flex align-items-center badge bg-secondary bg-opacity-50",children:["P=",Z.G.percent(t.preaction)]})})]}):null]})})]})})]})}var J=t(79117),ee=t(73989);function ne(e,n,t){var r,a=e.actions;if(a){var i=null===(r=a[t])||void 0===r?void 0:r[n];if(i)return i}}function te(e,n,t,r){var a=e.actions;a||(a=e.actions=[]);var i=a[t];i||(i=a[t]=[]),i[n]=r}function re(e,n){var t=e.actions;t||(t=e.actions=[]),t.splice(n,0,[])}function ae(e,n){var t=e.actions;t||(t=e.actions=[]),t.forEach((function(e){e&&e.splice(n,0,void 0)}))}function ie(e,n){var t=e.actions;t||(t=e.actions=[]),t.splice(n,1)}function ce(e,n){var t=e.actions;t||(t=e.actions=[]),t.forEach((function(e){e&&e.splice(n,1)}))}var oe=t(97273),se=t(68582),ue=t(46474),le=t(2304),de=t(25566),fe=t.n(de);function he(e){var n=e.characterName,t=e.onSelect,r=(0,i.useMemo)((function(){var e=Z.G.Database.getCharacterFactories().find((function(e){return e.name===n}));if(!e)throw new Error('Character not found: "'+n+'"');return Z.G.Database.getWeaponFactoriesFor(e.weaponType).filter((function(e){for(var n=0;n<e.effects.length;n++)if(e.effects[n].includeRules)return!0;return!1}))}),[n]),c=(0,i.useMemo)((function(){return Z.G.Database.getArtifactBonusFactories().filter((function(e){for(var n=0;n<e.effects.length;n++)if(e.effects[n].includeRules)return!0;return!1}))}),[]),o=(0,i.useState)(""),s=(0,a.Z)(o,2),u=s[0],l=s[1],d=(0,ue.R)(r,(function(e){return Z.G.Describe.getTitle(e)})),h=(0,ue.R)(c,(function(e){return Z.G.Describe.getTitle(e)}));return(0,i.useEffect)((function(){d.setSearch(u||""),h.setSearch(u||"")}),[u,d,h]),(0,f.jsxs)(N.Z,{gap:1,children:[(0,f.jsx)(M.Z.Control,{type:"text",placeholder:(0,j.KF)("EFFECT_SEARCH_NAME"),value:u,onChange:function(e){return l(e.target.value)}}),(0,f.jsxs)(_.Z,{children:[(0,f.jsx)(_.Z.Header,{className:"bg-info",children:(0,j.KF)("ITEM_WEAPONS")}),(0,f.jsx)(_.Z.Body,{children:(0,f.jsx)(le.Z,{children:d.items.map((function(e,n){return(0,f.jsx)(le.Z.Item,{action:!0,onClick:function(){return t(e.name)},children:(0,f.jsx)(fe(),{searchWords:[d.search],textToHighlight:Z.G.Describe.getTitle(e)})},n)}))})})]}),(0,f.jsxs)(_.Z,{children:[(0,f.jsx)(_.Z.Header,{className:"bg-info",children:(0,j.KF)("ITEM_ARTIFACTS")}),(0,f.jsx)(_.Z.Body,{children:(0,f.jsx)(le.Z,{children:h.items.map((function(e,n){return(0,f.jsx)(le.Z.Item,{action:!0,onClick:function(){return t(e.name)},children:(0,f.jsx)(fe(),{searchWords:[h.search],textToHighlight:Z.G.Describe.getTitle(e)})},n)}))})})]})]})}var pe=t(13736);function ve(e){var n=e.onSelect,t=(0,K.tl)(),r=(0,i.useMemo)((function(){var e=[];return t.effects.ElementalSkills.forEach((function(n){return e.push([void 0,n.factory,"EFFECT_ES"])})),t.effects.ElementalBursts.forEach((function(n){return e.push([void 0,n.factory,"EFFECT_EB"])})),t.effects.Passives.forEach((function(n){return e.push([void 0,n.factory,"EFFECT_PASSIVE"])})),t.effects.Constellations.forEach((function(n){return e.push([void 0,n.factory,"EFFECT_CONST"])})),t.effects.Party.forEach((function(n){return e.push([void 0,n.factory,"EFFECT_EXTERNAL"])})),t.effects.Enemy.forEach((function(n){return e.push([void 0,n.factory,"EFFECT_EXTERNAL"])})),Z.G.Database.getArtifactBonusFactories().forEach((function(n){n.effects.forEach((function(n){return e.push([void 0,n,"ITEM_ARTIFACTS"])}))})),Z.G.Database.getWeaponFactoriesFor(t.weaponType).forEach((function(n){n.effects.forEach((function(t){return e.push([n.name,t,"EFFECT_CONTROL_WEAPON"])}))})),e}),[t]),c=(0,ue.R)(r,(function(e){return(e[0]?xe(e[0])+" ":"")+Z.G.Describe.getTitle(e[1])})),o=c.items,s=c.search,u=c.setSearch,l=(0,pe.h)(o,10);return(0,f.jsxs)(N.Z,{gap:1,children:[(0,f.jsx)(M.Z.Control,{type:"text",placeholder:(0,j.KF)("EFFECT_SEARCH_NAME"),value:s,onChange:function(e){return u(e.target.value)}}),(0,f.jsx)("div",{className:"d-flex justify-content-center",children:(0,f.jsx)(l.Pagination,{})}),(0,f.jsx)(le.Z,{children:l.items.map((function(e,t){var r=(0,a.Z)(e,3),i=r[0],c=r[1],o=r[2];return(0,f.jsxs)(le.Z.Item,{action:!0,onClick:function(){return function(e,t){var r=e.name.split(".")[0],a=t.includes("WEAPON")?"weapon":t.includes("ARTIFACT")?"artifact":void 0;n(e.name,r,a)}(c,o)},children:[i?(0,f.jsx)("div",{children:(0,f.jsx)("strong",{children:(0,f.jsx)(fe(),{textToHighlight:xe(i),searchWords:[s]})})}):null,(0,f.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,f.jsx)("div",{children:(0,f.jsx)(fe(),{textToHighlight:Z.G.Describe.getTitle(c),searchWords:[s]})}),(0,f.jsx)("div",{className:"badge bg-info text-black",children:(0,j.KF)(o)})]})]},t)}))})]})}function xe(e){return Z.G.Describe.has(e)?Z.G.Describe.getTitle(e):(0,j.KF)(e)}var me=t(76487),ge=["item"],Ze=0,je=0;function ye(e){var n=e.item,t=(0,d.Z)(e,ge),r=(0,i.useRef)(null),c=(0,i.useState)(Ze),o=(0,a.Z)(c,2),s=o[0],u=o[1],l=(0,i.useState)(je),h=(0,a.Z)(l,2),p=h[0],v=h[1];(0,i.useEffect)((function(){var e=Ze,n=je,t=window.innerWidth,a=window.innerHeight;if(r.current){var i=r.current.getBoundingClientRect(),c=i.width,o=i.height;e=Math.min(e,t-c),n=Math.min(n,a-o)}u(e),v(n)}),[]);var x=(0,i.useState)(!0),m=(0,a.Z)(x,2),g=m[0],Z=m[1];function j(){Z(!1),t.proceed()}return(0,f.jsxs)("div",{style:{display:g?void 0:"none"},children:[(0,f.jsx)("div",{className:"modal-backdrop opacity-0",onClick:j}),(0,f.jsx)("div",{className:"popover popover-body",style:{left:s,top:p},ref:r,children:n(j)})]})}window.addEventListener("mousemove",(function(e){Ze=e.clientX,je=e.clientY}));function Ne(){var e=u(),n=e.rotation,t=e.update,r=e.readonly,c=e.mode,s=o(),l=s.x,d=s.y,h=(0,se.Z)().language,p=(0,i.useMemo)((function(){return[{title:(0,j.KF)("ROTATION_ADD_INSTANCE"),action:function(e){return(0,x.Z)((0,v.Z)().mark((function n(){var t,r,a,i,c;return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.rotation,r=e.x,a=e.y,i=D(t,t)[0],c=B(i)[0].name,te(t,r,a,{type:"instance",instance:{count:1,multiplier:1,instanceName:c,paura:0,preaction:0}}),n.abrupt("return",!0);case 5:case"end":return n.stop()}}),n)})))()}},{title:(0,j.KF)("ROTATION_ADD_CONTROL"),action:function(e){return(0,x.Z)((0,v.Z)().mark((function n(){var t,r,i,c,o,s,u,l,d,h,p;return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.rotation,r=e.x,i=e.y,c=new Promise(function(){var e=(0,x.Z)((0,v.Z)().mark((function e(n){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.a)({title:(0,j.KF)("ROTATION_ADD_CONTROL"),message:function(e){return(0,f.jsx)(ve,{onSelect:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];n(r),e()}})},footerButton:!1});case 2:n(void 0);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),n.next=4,c;case 4:if(o=n.sent){n.next=7;break}return n.abrupt("return",!1);case 7:return s=(0,a.Z)(o,3),u=s[0],l=s[1],d=s[2],(p=(h={type:"control",control:{effect:{name:u,enabled:!0,rank:1,stacks:0,aura:[],inputs:[]}}}).control)&&("artifact"===d?p.artifact=l:"weapon"===d&&(p.weapon=l)),te(t,r,i,h),n.abrupt("return",!0);case 13:case"end":return n.stop()}}),n)})))()}},{title:(0,j.KF)("ROTATION_ADD_INCLUDE"),action:function(e){return(0,x.Z)((0,v.Z)().mark((function n(){var t,r,a,i,c,o;return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.rotation,r=e.x,a=e.y,i=D(t,t)[0],c=new Promise(function(){var e=(0,x.Z)((0,v.Z)().mark((function e(n){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.a)({title:(0,j.KF)("ROTATION_ADD_INCLUDE"),message:function(e){return(0,f.jsx)(he,{onSelect:function(t){n(t),e()},characterName:i})},footerButton:!1});case 2:n(void 0);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),n.next=5,c;case 5:if(o=n.sent){n.next=8;break}return n.abrupt("return",!1);case 8:return te(t,r,a,{type:"includeInstance",includeInstance:{factoryName:o,instance:{instanceName:o,count:1,multiplier:1,paura:0,preaction:0}}}),n.abrupt("return",!0);case 10:case"end":return n.stop()}}),n)})))()}},{title:(0,j.KF)("ROTATION_ADD_COLUMN"),action:function(e){return(0,x.Z)((0,v.Z)().mark((function n(){var t,r;return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.rotation,r=e.x,ae(t,r),n.abrupt("return",!0);case 3:case"end":return n.stop()}}),n)})))()}},{title:(0,j.KF)("ROTATION_ADD_ROW"),action:function(e){return(0,x.Z)((0,v.Z)().mark((function n(){var t,r;return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.rotation,r=e.y,re(t,r),n.abrupt("return",!0);case 3:case"end":return n.stop()}}),n)})))()}},{title:(0,j.KF)("ROTATION_DELETE_ROW"),action:function(e){return(0,x.Z)((0,v.Z)().mark((function n(){var t,r;return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.rotation,r=e.y,n.next=3,(0,y.Q)({message:(0,j.KF)("ROTATION_DELETE_ROW_CONFIRM")});case 3:if(n.sent){n.next=6;break}return n.abrupt("return",!1);case 6:return ie(t,r),n.abrupt("return",!0);case 8:case"end":return n.stop()}}),n)})))()}},{title:(0,j.KF)("ROTATION_DELETE_COLUMN"),action:function(e){return(0,x.Z)((0,v.Z)().mark((function n(){var t,r;return(0,v.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.rotation,r=e.x,n.next=3,(0,y.Q)({message:(0,j.KF)("ROTATION_DELETE_COLUMN_CONFIRM")});case 3:if(n.sent){n.next=6;break}return n.abrupt("return",!1);case 6:return ce(t,r),n.abrupt("return",!0);case 8:case"end":return n.stop()}}),n)})))()}}]}),[h]);var m=(0,ee.L)({accept:Ee,collect:function(e){return{isOver:!!e.isOver()}},drop:function(e){if(!r){var a=ne(n,e.x,e.y);a&&("move"===c?(te(n,e.x,e.y,void 0),te(n,l,d,a)):te(n,l,d,JSON.parse(JSON.stringify(a))),t())}}}),Z=(0,a.Z)(m,2),N=Z[0].isOver,T=Z[1];return(0,f.jsx)("div",{ref:T,className:"grid-cell empty"+(N?" dropping":""),children:(0,f.jsx)("div",{onClick:function(){var e;r||(e=function(e){return(0,f.jsx)(oe.C,{popover:!1,onActionFinish:function(n,r){!function(e){e&&t()}(r),e()},actions:p,item:{x:l,y:d,rotation:n}})},(0,me.LA)((0,me.mP)(ye))({item:e}))},className:"h-100 d-flex align-items-center justify-content-center",children:"+"})})}function Te(e){var n=e.include;return(0,f.jsx)(q,{onChange:function(){n.characterName=n.instance.characterName},hideChangeInstance:!0,instance:n.instance})}var Ee="rotation-grid-cell";function Ce(e){var n=e.x,t=e.y,r=u().rotation,i=(0,J.c)({type:Ee,item:{x:n,y:t},collect:function(e){return{isDragging:!!e.isDragging()}}}),o=(0,a.Z)(i,2),s=o[0].isDragging,l=o[1],d=ne(r,n,t);if(!d)return(0,f.jsx)(c.Provider,{value:{x:n,y:t,rotation:r},children:(0,f.jsx)(Ne,{})});var h=function(){switch(d.type){case"control":return d.control?(0,f.jsx)(L,{control:d.control}):void 0;case"includeInstance":return d.includeInstance?(0,f.jsx)(Te,{include:d.includeInstance}):void 0;case"instance":return d.instance?(0,f.jsx)(q,{instance:d.instance}):void 0}}();return(0,f.jsx)(c.Provider,{value:{x:n,y:t,rotation:r},children:h?(0,f.jsx)("div",{ref:l,className:"grid-cell action "+d.type+(s?" dragging":""),children:h}):(0,f.jsx)(Ne,{})})}function Oe(){var e=function(e){var n=0,t=0;if(e.actions){for(var r=-1,a=e.actions.length-1;a>=0;a--){var i=e.actions[a];if(i&&0!==i.length){if(0!==i.reduce((function(e,n){return e+(n?1:0)}),0))break;r=a}else r=a}r>=0&&e.actions.splice(r),e.actions.forEach((function(e){if(e){for(var n=-1,t=e.length-1;t>=0&&!e[t];t--)n=t;n>=0&&e.splice(n)}})),e.actions.forEach((function(e,r){e&&(e.length>0&&r+1>t&&(t=r+1),e.forEach((function(e,t){e&&t+1>n&&(n=t+1)})))}))}return n=Math.max(5,n),t=Math.max(10,t),n++,t++,{width:n,height:t}}(u().rotation),n=e.width,t=e.height;return(0,f.jsx)(p,{className:"rotation-editor-grid",columns:n,rows:t,map:function(e,n){return(0,f.jsx)(Ce,{x:e,y:n})}})}var Ae=t(70441);function be(){var e=(0,i.useReducer)((function(e){return(e+1)%7}),0),n=(0,a.Z)(e,2)[1],t=u(),r=t.rotation,c=t.save,o=t.readonly;return(0,f.jsx)("div",{children:(0,f.jsx)("table",{children:(0,f.jsxs)("tbody",{children:[(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:(0,j.KF)("ROTATION_DURATION")}),(0,f.jsx)("td",{children:(0,f.jsx)(z.K,{disabled:o,size:"sm",value:r.duration,onChange:function(e){o||(r.duration=e,c(),n())}})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:(0,f.jsx)("label",{htmlFor:"ROTATION_AUTO_INCLUDE_RULES",children:(0,j.KF)("ROTATION_AUTO_INCLUDE_RULES")})}),(0,f.jsx)("td",{children:(0,f.jsx)("div",{className:"d-flex justify-content-end",children:(0,f.jsx)(M.Z.Check,{type:"checkbox",id:"ROTATION_AUTO_INCLUDE_RULES",disabled:o,onChange:function(e){var t=e.target;o||(r.autoIncludeRules=t.checked,c(),n())},checked:r.autoIncludeRules||!1})})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:(0,f.jsx)("label",{htmlFor:"ROTATION_IS_DYNAMIC",children:(0,j.KF)("ROTATION_IS_DYNAMIC")})}),(0,f.jsx)("td",{children:(0,f.jsx)("div",{className:"d-flex justify-content-end",children:(0,f.jsx)(M.Z.Check,{type:"checkbox",id:"ROTATION_IS_DYNAMIC",disabled:o,onChange:function(e){var t=e.target;o||(r.dynamic=t.checked,c(),n())},checked:r.dynamic||!1})})})]})]})})})}var we=t(36687),Ie=t(29400);function _e(){var e=u(),n=e.mode,t=e.setMode;return(0,f.jsxs)(we.Z,{children:[(0,f.jsx)(C.Z,{disabled:!0,children:(0,j.KF)("ROTATION_DRAG_MODE")}),(0,f.jsx)(T.Z,{trigger:["hover","focus"],overlay:(0,f.jsx)(E.Z,{children:(0,j.KF)("ROTATION_ACTION_MOVE_DESCRIPTION")}),children:(0,f.jsx)(Ie.Z,{checked:"move"===n,variant:"move"===n?"success":"primary",onClick:function(){return t("move")},value:"move",children:(0,j.KF)("ACTION_MOVE")})}),(0,f.jsx)(T.Z,{trigger:["hover","focus"],overlay:(0,f.jsx)(E.Z,{children:(0,j.KF)("ROTATION_ACTION_CLONE_DESCRIPTION")}),children:(0,f.jsx)(Ie.Z,{checked:"clone"===n,variant:"clone"===n?"success":"primary",onClick:function(){return t("clone")},value:"clone",children:(0,j.KF)("ACTION_CLONE")})})]})}var De=t(94860),Fe=t(56122),Me=t(47017),ke=t(70654),Re=t(97890);function Ge(){var e=(0,i.useReducer)((function(e){return(e+1)%7}),0),n=(0,a.Z)(e,2)[1],t=u(),r=t.rotation,c=t.save,o=t.readonly,s=(0,Re.s0)();function l(){return(l=(0,x.Z)((0,v.Z)().mark((function e(){var t,a,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,Me.q$)();case 4:return t=e.sent.map((function(e){return e.name})),a=new De.z0(t),e.next=8,(0,Fe.m)({title:(0,j.KF)("ACTION_RENAME"),defaultValue:r.name,validate:function(e){var n=a.validateName(e);return"NAME_OK"===n||(0,j.KF)(n)}});case 8:if(i=e.sent){e.next=11;break}return e.abrupt("return");case 11:r.name=i,c(),n();case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return(d=(0,x.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Me.dO)(r);case 2:e.sent&&s("/editor/rotations");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=(0,x.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,y.Q)({message:(0,f.jsx)(Ae.D,{children:(0,j.KF)("ROTATION_CONFIRM_DELETE",{rotation:r.name})})});case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,(0,Me.om)(r);case 9:e.sent&&s("/editor/rotations");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,f.jsxs)(N.Z,{direction:"horizontal",gap:1,children:[(0,f.jsx)("div",{className:"text-nowrap overflow-auto border border-primary me-auto ps-4 pe-4 pt-2 pb-2",children:r.name}),(0,f.jsxs)(C.Z,{onClick:function(){return l.apply(this,arguments)},disabled:o,children:[(0,f.jsx)(O.Z,{}),(0,j.KF)("ACTION_RENAME")]}),(0,f.jsxs)(C.Z,{onClick:function(){return d.apply(this,arguments)},children:[(0,f.jsx)(ke.Z,{}),(0,j.KF)("ACTION_DUPLICATE")]}),(0,f.jsxs)(C.Z,{variant:"danger",onClick:function(){return h.apply(this,arguments)},disabled:o,children:[(0,f.jsx)(A.Z,{}),(0,j.KF)("ACTION_DELETE")]})]})}function Ke(){var e=u().readonly;return(0,f.jsxs)("div",{className:"bg-dark",children:[(0,f.jsx)("div",{className:"p-2 d-flex justify-content-center overflow-auto",children:(0,f.jsxs)(N.Z,{gap:1,children:[(0,f.jsx)(Ge,{}),(0,f.jsxs)(N.Z,{direction:"horizontal",gap:1,className:"align-items-start",children:[(0,f.jsx)(be,{}),(0,f.jsx)(_e,{})]})]})}),e?(0,f.jsx)("div",{className:"m-1 alert border border-danger",children:(0,f.jsx)(Ae.D,{components:{p:function(e){return(0,f.jsx)("p",(0,l.Z)((0,l.Z)({},e),{},{className:"p-0 m-0"}))}},children:(0,j.KF)("ROTATION_MESSAGE_READONLY")})}):null]})}var Le=t(26246),Se=t(77406),Pe=t(30448);function Be(e){var n=e.rotation,t=!n.custom&&!window.location.href.match(/localhost/i),r=(0,i.useReducer)((function(e){return(e+1)%7}),0),c=(0,a.Z)(r,2)[1],o=(0,i.useMemo)((function(){return new Pe.j(250,(function(){t||(0,Me.L$)(n)}))}),[n,t]);function u(){o.call()}var l=(0,i.useState)("move"),d=(0,a.Z)(l,2),h=d[0],p=d[1];return(0,f.jsx)(s.Provider,{value:{rotation:n,update:function(){c(),u()},save:u,readonly:t,mode:h,setMode:p},children:(0,f.jsxs)("div",{className:"d-flex flex-column",style:{height:"calc(100vh - 158px)"},children:[(0,f.jsx)("div",{className:"position-sticky",children:(0,f.jsx)(Ke,{})}),(0,f.jsx)("div",{className:"overflow-auto",children:(0,f.jsx)(Le.W,{backend:Se.zr,options:{enableMouseEvents:!0,enableHoverOutsideTarget:!1},children:(0,f.jsx)(Oe,{})})})]})})}function He(){var e=(0,r.o)();return e?(0,f.jsx)(Be,{rotation:e}):(0,f.jsx)("div",{className:"m-4 text-center",children:(0,j.KF)("ROTATION_NO_SELECTED")})}},47017:function(e,n,t){t.d(n,{L$:function(){return s},SP:function(){return p},dO:function(){return l},om:function(){return f},q$:function(){return c}});var r=t(74165),a=t(15861),i=t(29447);function c(e){return o.apply(this,arguments)}function o(){return o=(0,a.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=performance.now(),e.abrupt("return",new Promise(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(a,c){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=(0,i.HB)().addMessageListener((function(e){"storage-rotations"===e.type&&e.id===t&&(e.error?c(e.error):((0,i.HB)().removeMessageListener(o),a(e.result)))})),(0,i.HB)().postMessage({type:"storage-rotations",id:t,data:{get:n||{}}});case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}function s(e){return u.apply(this,arguments)}function u(){return u=(0,a.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.id){e.next=2;break}return e.abrupt("return",!1);case 2:return t=performance.now(),e.abrupt("return",new Promise(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(a,c){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=(0,i.HB)().addMessageListener((function(e){"storage-rotations"===e.type&&e.id===t&&(e.error?c(e.error):((0,i.HB)().removeMessageListener(o),a(e.result)))})),(0,i.HB)().postMessage({type:"storage-rotations",id:t,data:{set:{id:n.id,rotation:n}}});case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return d=(0,a.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n.id&&null!==n.id){e.next=2;break}return e.abrupt("return");case 2:return t=performance.now(),e.abrupt("return",new Promise(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(a,c){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=(0,i.HB)().addMessageListener((function(e){"storage-rotations"===e.type&&e.id===t&&(e.error?c(e.error):((0,i.HB)().removeMessageListener(o),a(e.result)))})),(0,i.HB)().postMessage({type:"storage-rotations",id:t,data:{duplicate:{id:n.id}}});case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return h=(0,a.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n.id&&null!==n.id){e.next=2;break}return e.abrupt("return",!1);case 2:return t=performance.now(),e.abrupt("return",new Promise(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(a,c){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=(0,i.HB)().addMessageListener((function(e){"storage-rotations"===e.type&&e.id===t&&(e.error?c(e.error):((0,i.HB)().removeMessageListener(o),a(e.result)))})),(0,i.HB)().postMessage({type:"storage-rotations",id:t,data:{delete:{id:n.id}}});case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function p(e){return v.apply(this,arguments)}function v(){return v=(0,a.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=performance.now(),e.abrupt("return",new Promise(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(a,c){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=(0,i.HB)().addMessageListener((function(e){"storage-rotations"===e.type&&e.id===t&&(e.error?c(e.error):((0,i.HB)().removeMessageListener(o),a(e.result)))})),(0,i.HB)().postMessage({type:"storage-rotations",id:t,data:{add:{characterName:n}}});case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}}}]);