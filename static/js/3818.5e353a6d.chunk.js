"use strict";(self.webpackChunkgenshin_gui=self.webpackChunkgenshin_gui||[]).push([[3818],{97679:function(e,n,t){function r(e,n){for(var t=e.toFixed(n),r=t.length-1;r>=0&&"0"===t[r];r--)t=t.slice(0,r);return t.endsWith(".")&&(t=t.slice(0,t.length-1)),t}t.d(n,{F:function(){return r}})},23818:function(e,n,t){t.r(n),t.d(n,{default:function(){return Ae},position:function(){return de},title:function(){return oe}});var r=t(96103),a=t(93433),c=t(74165),i=t(15861),l=t(93324),s=t(45043),o=t(79188),d=t(47017),A=t(47313),u=t(65832),E=t(53768),m=t(465),M=t(31136),x=t(95668),g=t(18734),h=t(75936),T=t(93298),G=t(48648),D=t(63849),N=t(31616),_=["#696969","#2E8B57","#8B0000","#808000","#8B008B","#FFA500","#0000CD","#7CFC00","#00FA9A","#4169E1","#00FFFF","#00BFFF","#ff4b00","#FFFF54","#DDA0DD","#FF1493","#FFDAB9","#FF0000"],f=["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#000000","#FFFFFF","#000000","#000000","#FFFFFF","#000000","#000000","#FFFFFF","#000000","#000000","#FFFFFF","#000000","#FFFFFF"],v={PyroDMG:"rgb(235, 118, 22)",HydroDMG:"rgb(0, 125, 197)",CryoDMG:"rgb(153, 238, 238)",ElectroDMG:"rgb(216, 89, 255)",GeoDMG:"rgb(226, 167, 56)",AnemoDMG:"rgb(0, 255, 149)",DendroDMG:"rgb(46, 163, 42)",PhysicalDMG:"rgb(177, 177, 177)"};var p=function(e,n){var t,r;return[null!==(t=f[e])&&void 0!==t?t:"#FFFFFF",null!==(r=_[e])&&void 0!==r?r:"#000000"][n]},j={variable:/([a-z_][a-z_0-9]*)/i,operator:/(\+|\-|\*|\/|\(|\)|=|\^)/,number:/([0-9]+)(\.[0-9]+)?%?/},F=new RegExp("(".concat(j.variable.source,"|").concat(j.operator.source,"|").concat(j.number.source,")"),"ig");function R(e,n){return(e=e.replace(/(^\s*|\s*$)/g,"").replace(/\s*\n+\s*/g,"\n")).split("\n").map((function(e){return'<div class="formula">'+function(e,n){var t=(e=e.replace(/\s+/g,"")).match(F);if(!t)return"";for(var r,a=[],c=[],i=0;i<t.length;i++){var l=t[i];if("("===l)c.push(i);else if(")"===l){var s=c.pop();if(void 0===s)throw new Error("Mismatched parentheses");var o=i;a[s]='<div class="group">',a[o]="</div>"}else if(l.match(j.variable)){var d="";if(n){var A=n[l];A&&(d='style="color: '.concat((r=A).text,"; background-color: ").concat(r.background,';"'),A.replace&&(l=A.replace+""))}a[i]='<div class="token variable" '.concat(d,">").concat(l,"</div>")}else if(l.match(j.operator)){var u="addition";"-"===l?u="subtraction":"*"===l?(u="multiplication",l="&times;"):"/"===l?u="division":"^"===l&&(u="exponent"),a[i]='<div class="token operator '.concat(u,'">').concat(l,"</div>")}else l.match(j.number)&&(a[i]='<div class="token number">'.concat(l,"</div>"))}return a.join("")}(e,n)+"</div>"})).join("")}var I=t(46417);function O(e){var n=e.instance,t=n.character,r=n.getCalculatedMVs(),a=n.getFlatValues(),c=n.getReactionDMG(),i=c.reaction?t.get(c.reaction):0,d=n.calculateQuicken(),A=d.reaction?t.get(d.reaction):0,u=d.reaction?s.G.TransformativeFormula.reactionMultiplier(d.reaction):0,E=function(e){var n=e.motionValues,t=e.flatValues,r=e.reactionMultiplier,a=e.res,c=n.map((function(e){var n=e.name.replace(/.*ATK$/g,"ATK");return"".concat(s.G.percent(e.MV),"*").concat(n)})).join("+"),i=t.map((function(e){return"".concat(Math.round(e.value))})).join("+"),l=c+(""!==i&&n.length>0?"+":"")+i,o=e.ignoreRES?"":a<0?"*(1-(DAMAGE_ENEMYRES/2))":a<.75?"*(1-DAMAGE_ENEMYRES)":"*(1/(4*DAMAGE_ENEMYRES+1))",d=1===r?"":"*(1+((278%*ElementalMastery)/(ElementalMastery+1400))+DAMAGE_REACTIONDMG)*DAMAGE_REACTION",A=e.ignoreDEF?"":"*( (DAMAGE_CHARLVL+100) / ( (1-DAMAGE_ENEMYDEFIGNORED)*(1-DAMAGE_ENEMYDEF)*(DAMAGE_ENEMYLVL + 100) + DAMAGE_CHARLVL+100 )  )",u=e.quicken?"DAMAGE_QUICKEN=(0.00194*DAMAGE_CHARLVL^3-0.319*DAMAGE_CHARLVL^2+30.7*DAMAGE_CHARLVL-868)\n        *(1+((500%*ElementalMastery)/(ElementalMastery+1200))+DAMAGE_REACTIONDMG)*DAMAGE_REACTION="+Math.round(e.quicken):"";return"".concat(u,"\n    DAMAGE_NOCRIT=DAMAGE_MULTIPLIER*(").concat(l).concat(e.quicken?"+DAMAGE_QUICKEN":"",")\n    ").concat(e.onlyMV?"":"*(1 + DAMAGE_ELEMENTAL + DAMAGE_TALENT + DAMAGE_ALL + DAMAGE_SPECIFIC)","\n    ").concat(d,"\n    ").concat(A,"\n    ").concat(o,"\n    DAMAGE_CRIT=(DAMAGE_NOCRIT)").concat(e.ignoreCRIT?"":"*(1+CRITDMG)","\n    DAMAGE_AVG=(DAMAGE_NOCRIT)").concat(e.ignoreCRIT?"":"*(1+CRITRate*CRITDMG)","\n    ")}({motionValues:r,flatValues:a,reactionMultiplier:c.multiplier,res:t.enemy.getRES(n.ElementalDMG),ignoreRES:n.ignoreRES,ignoreDEF:n.ignoreDEF,ignoreCRIT:n.ignoreCRIT,onlyMV:n.onlyMV,quicken:d.bonus}),m=n.TalentDMG?t.get(n.TalentDMG):0,M={DAMAGE_QUICKEN:{replace:d.reaction?s.G.Describe.getTitle("Reaction."+d.reaction):s.G.Describe.getTitle("Reaction.QuickenDMG"),text:"inherit",background:"transparent"},DAMAGE_NOCRIT:{replace:(0,o.KF)("DAMAGE_NOCRIT"),text:"inherit",background:"transparent"},ATK:{replace:(0,s.q)("ATK",t.get("ATK")),text:p(0,0),background:p(0,1)},HP:{replace:(0,s.q)("HP",t.get("HP")),text:p(1,0),background:p(1,1)},DEF:{replace:(0,s.q)("DEF",t.get("DEF")),text:p(2,0),background:p(2,1)},DAMAGE_MULTIPLIER:{replace:s.G.percent(n.getMultiplier()),text:p(3,0),background:p(3,1)},DAMAGE_ELEMENTAL:{replace:(0,s.q)("PyroDMG",t.get(n.ElementalDMG)),text:p(4,0),background:p(4,1)},DAMAGE_TALENT:{replace:(0,s.q)("PyroDMG",m),text:p(5,0),background:p(5,1)},DAMAGE_ALL:{replace:(0,s.q)("PyroDMG",t.get("AllDMG")),text:p(6,0),background:p(6,1)},DAMAGE_SPECIFIC:{replace:(0,s.q)("PyroDMG",n.get("AllDMG")),text:p(7,0),background:p(7,1)},DAMAGE_CHARLVL:{replace:t.Level,text:p(8,0),background:p(8,1)},DAMAGE_ENEMYDEF:{replace:(0,s.q)("PyroDMG",t.enemy.get("DEFreduction")),text:p(9,0),background:p(9,1)},DAMAGE_ENEMYDEFIGNORED:{replace:(0,s.q)("PyroDMG",n.get("DEFignored")+t.get("DEFignored")),text:p(10,0),background:p(10,1)},DAMAGE_ENEMYLVL:{replace:t.enemy.Level,text:p(11,0),background:p(11,1)},DAMAGE_ENEMYRES:{replace:(0,s.q)("PyroDMG",t.enemy.getRES(n.ElementalDMG)),text:p(12,0),background:p(12,1)},ElementalMastery:{replace:(0,s.q)("ElementalMastery",t.get("ElementalMastery")+n.get("ElementalMastery")),text:p(13,0),background:p(13,1)},DAMAGE_REACTION:{replace:(0,s.q)("PyroDMG",1===c.multiplier?u:c.multiplier),text:p(14,0),background:p(14,1)},DAMAGE_REACTIONDMG:{replace:(0,s.q)("PyroDMG",i||A),text:p(15,0),background:p(15,1)},DAMAGE_CRIT:{replace:(0,o.KF)("DAMAGE_CRIT"),text:"inherit",background:"transparent"},DAMAGE_AVG:{replace:(0,o.KF)("DAMAGE_AVG"),text:"inherit",background:"transparent"},CRITDMG:{replace:(0,s.q)("CRITDMG",n.calculateCRITDMG()),text:p(16,0),background:p(16,1)},CRITRate:{replace:(0,s.q)("CRITRate",n.calculateCRITRate()),text:p(17,0),background:p(17,1)}},x=R(E,M);return(0,I.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[(0,I.jsx)("div",{className:"d-flex justify-content-center formula",children:(0,I.jsxs)(G.Z,{direction:"horizontal",gap:1,children:[(0,I.jsx)("div",{className:"token variable",style:{backgroundColor:p(4,1),color:p(4,0)},children:s.G.Describe.getTitle(n.ElementalDMG)}),n.TalentDMG?(0,I.jsx)("div",{className:"token variable",style:{backgroundColor:p(5,1),color:p(5,0)},children:s.G.Describe.getTitle(n.TalentDMG)}):null]})}),(0,I.jsx)("div",{dangerouslySetInnerHTML:{__html:x}}),(0,I.jsx)("div",{className:"formula-legend",children:(0,I.jsx)(D.Z,{children:Object.entries(M).map((function(e,n){var t=(0,l.Z)(e,2),r=t[0],a=t[1];if("transparent"===a.background)return null;var c=(0,o.KF)(r);return c.includes("{")&&(c=s.G.Describe.getTitle(r)),(0,I.jsx)(N.Z,{xs:12,md:6,lg:4,children:(0,I.jsxs)("div",{className:"d-flex align-items-center item",children:[(0,I.jsx)("div",{className:"marker",style:{backgroundColor:a.background}}),(0,I.jsx)("div",{className:"label",children:c})]})},n)}))})})]})}function b(e){var n=e.instance,t=n.character,r=s.G.TransformativeFormula.reactionMultiplier(n.ReactionDMG),a=function(e){var n=e.res;return"\n    DAMAGE_NOCRIT=(0.00194*DAMAGE_CHARLVL^3-0.319*DAMAGE_CHARLVL^2+30.7*DAMAGE_CHARLVL-868)\n    *(1+((1600%*ElementalMastery)/(ElementalMastery+2000))+DAMAGE_REACTIONDMG)*DAMAGE_REACTION\n    ".concat(n<0?"*(1-(DAMAGE_ENEMYRES/2))":n<.75?"*(1-DAMAGE_ENEMYRES)":"*(1/(4*DAMAGE_ENEMYRES+1))","\n    ")}({res:t.enemy.getRES(n.ElementalDMG)}),c={DAMAGE_NOCRIT:{replace:(0,o.KF)("DAMAGE_NOCRIT"),text:"inherit",background:"transparent"},DAMAGE_CHARLVL:{replace:t.Level,text:p(8,0),background:p(8,1)},DAMAGE_ENEMYRES:{replace:(0,s.q)("PyroDMG",t.enemy.getRES(n.ElementalDMG)),text:p(12,0),background:p(12,1)},ElementalMastery:{replace:(0,s.q)("ElementalMastery",t.get("ElementalMastery")),text:p(13,0),background:p(13,1)},DAMAGE_REACTION:{replace:(0,s.q)("PyroDMG",r),text:p(14,0),background:p(14,1)},DAMAGE_REACTIONDMG:{replace:(0,s.q)("PyroDMG",t.get(n.ReactionDMG)+n.get("AllDMG")),text:p(15,0),background:p(15,1)}},i=R(a,c);return(0,I.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[(0,I.jsx)("div",{dangerouslySetInnerHTML:{__html:i}}),(0,I.jsx)("div",{className:"formula-legend",children:(0,I.jsx)(D.Z,{children:Object.entries(c).map((function(e,n){var t=(0,l.Z)(e,2),r=t[0],a=t[1];if("transparent"===a.background)return null;var c=(0,o.KF)(r);return c.includes("{")&&(c=s.G.Describe.getTitle(r)),(0,I.jsx)(N.Z,{xs:12,md:6,lg:4,children:(0,I.jsxs)("div",{className:"d-flex align-items-center item",children:[(0,I.jsx)("div",{className:"marker",style:{backgroundColor:a.background}}),(0,I.jsx)("div",{className:"label",children:c})]})},n)}))})})]})}var C=t(87284);function y(e){var n=e.instance;return(0,I.jsx)(T.Z,{onClick:function(){n instanceof s.G.DamageInstance?(0,h.a)({title:(0,o.KF)("DAMAGE_FORMULA")+" | "+s.G.Describe.getTitle(n.name),message:(0,I.jsx)(O,{instance:n})}):n instanceof s.G.TransformativeDamageInstance&&(0,h.a)({title:(0,o.KF)("DAMAGE_FORMULA"),message:(0,I.jsx)(b,{instance:n})})},children:(0,I.jsx)(C.Z,{})})}function k(e){var n=e.list;return(0,I.jsxs)(m.Z,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,I.jsx)("thead",{children:(0,I.jsxs)("tr",{children:[(0,I.jsx)("th",{children:(0,o.KF)("DAMAGE_INST")}),(0,I.jsx)("th",{children:(0,o.KF)("DAMAGE_NOCRIT")}),(0,I.jsx)("th",{children:(0,o.KF)("DAMAGE_CRIT")}),(0,I.jsx)("th",{children:(0,o.KF)("DAMAGE_AVG")}),(0,I.jsx)("th",{children:(0,o.KF)("DAMAGE_FORMULA_SHORT")})]})}),(0,I.jsxs)("tbody",{children:[n.map((function(e,n){return(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{className:"w-50 align-middle",children:(0,I.jsx)(M.Z,{trigger:["hover","focus"],placement:"left",overlay:(0,I.jsx)(x.Z,{children:s.G.Describe.getTitle("Element."+e.ElementalDMG)}),children:(0,I.jsxs)("div",{className:"d-flex align-items-center",children:[(0,I.jsx)(g.Z,{element:e.ElementalDMG,style:{verticalAlign:"-0.125em"}}),s.G.Describe.getTitle(e.name)]})})}),(0,I.jsx)("td",{className:"align-middle",children:(0,I.jsx)("div",{className:"element-"+e.ElementalDMG,children:s.G.round(e.calculateNoCRIT())})}),(0,I.jsx)("td",{className:"align-middle",children:(0,I.jsx)("div",{className:"element-"+e.ElementalDMG,children:s.G.round(e.calculateCRIT())})}),(0,I.jsx)("td",{className:"align-middle",children:(0,I.jsx)("div",{className:"element-"+e.ElementalDMG,children:s.G.round(e.calculateAverage())})}),(0,I.jsx)("td",{className:"text-center align-middle",children:(0,I.jsx)(y,{instance:e})})]},n)})),0===n.length&&(0,I.jsx)("tr",{children:(0,I.jsx)("td",{className:"text-center",colSpan:5,children:(0,o.KF)("DAMAGE_INST_EMPTY")})})]})]})}function Z(e){var n=e.project,t=n.character,r=n.rotationId,m=(0,A.useState)([]),M=(0,l.Z)(m,2),x=M[0],g=M[1];(0,A.useEffect)((function(){function e(){return e=(0,i.Z)((0,c.Z)().mark((function e(){var n,a,i,l;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.q$)({id:r});case 2:if(n=e.sent.find((function(e){return e.id===r}))){e.next=7;break}return e.abrupt("return");case 7:(a=new s.G.Rotation(n)).setCharacter(t),i=t.rotationRules.generate(a),l=s.G.reduceArray(i.map((function(e){return e.include?e.include.map((function(e){return e.instance})):[]}))).filter((function(e){return!!e})),g(l);case 12:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,r]);var h=(0,A.useMemo)((function(){var e=t.damage.getTransformative();return{DAMAGE_NORMALS:t.damage.getNormalAttacks(),DAMAGE_ES:t.damage.getElementalSkills(),DAMAGE_EB:t.damage.getElementalBursts(),DAMAGE_TRANSFORMATIVE:e,DAMAGE_EXTRA:[].concat((0,a.Z)(t.damage.getExtraDamage().filter((function(n){return!e.includes(n)}))),(0,a.Z)(x))}}),[t,x]);return(0,I.jsxs)(u.Z,{children:[(0,I.jsx)(u.Z.Header,{as:"h5",className:"bg-info m-0",children:(0,o.KF)("DAMAGE_INSTANCES")}),(0,I.jsx)(u.Z.Body,{children:(0,I.jsx)(E.Z,{children:s.G.getObjectKeys(h).map((function(e){return(0,I.jsxs)(E.Z.Item,{eventKey:e,children:[(0,I.jsx)(E.Z.Header,{children:(0,o.KF)(e)}),(0,I.jsx)(E.Z.Body,{children:(0,I.jsx)(k,{list:h[e]})})]},e)}))})})]})}var L=t(1413),K=t(6203);var S=t(68582),U=t(29447),P=t(15671),V=t(43144),q=t(60136),H=t(27277),B=t(95397),w="calculate-rotation";B.z;var Y=t(89582),z=t(44030),Q=t(93739),$=t(91638);function X(e){var n;return(0,I.jsxs)("div",{className:"h-100 chart-container",children:[(0,I.jsx)("h5",{className:"m-0 p-1 text-center",children:null!==(n=e.header)&&void 0!==n?n:""}),(0,I.jsx)("div",{children:(0,I.jsx)($.Z,(0,L.Z)((0,L.Z)({},e),{},{options:(0,L.Z)({chart:{toolbar:{show:!1}},theme:{mode:"dark"},legend:{position:"bottom"}},e.options),width:"100%"}))})]})}function W(e){var n=e.rotation,t=(0,A.useMemo)((function(){if(n){var e=n.benefits;return[{data:Object.entries(e).map((function(e){var n,t=(0,l.Z)(e,2),r=t[0],a=t[1];return{x:s.G.Describe.getTitle(r)+" (+".concat((n=r,(0,s.q)(n,s.G.DatabaseValues.getMinValue(n))),")"),y:a}})).filter((function(e){return e.y>0})).sort((function(e,n){return n.y-e.y}))}]}}),[n]);if(!n||!t)return null;var r=t[0].data;return(0,I.jsx)(X,{options:{colors:_.slice(1),tooltip:{custom:function(e){var n=e.dataPointIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(r[n].x,"</div>")+'<div class="value">'.concat((0,o.KF)("DAMAGE_BENEFIT"),": ").concat(s.G.percent(r[n].y,!0,4),"</div>")+"</div>"}},xaxis:{labels:{formatter:function(e){return s.G.percent(parseFloat(e))}}},dataLabels:{formatter:function(e){return s.G.percent(e,!0,4)}},plotOptions:{bar:{horizontal:!0}}},series:t,type:"bar",header:(0,o.KF)("DAMAGE_ROLL_BENEFIT")})}var J=t(97679);function ee(e){var n=e.rotation,t=(0,A.useMemo)((function(){if(n){var e=n.fractions.ElementalDMG;return{series:Object.values(e).map((function(e){return e*n.damage})),labels:Object.keys(e).map((function(e){return"other"===e?(0,o.KF)("DAMAGE_EXTRA"):s.G.Describe.getTitle("Element."+e)})),colors:Object.keys(e).map((function(e){return v[e]}))}}}),[n]);return n&&t?(0,I.jsx)(X,{options:{colors:t.colors,labels:t.labels,tooltip:{custom:function(e){var n=e.series,r=e.seriesIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(t.labels[r],"</div>")+'<div class="value">'.concat((0,o.KF)("DAMAGE"),": ").concat((0,J.F)(n[r],2),"</div>")+"</div>"}}},series:t.series,type:"pie",header:(0,o.KF)("ROTATION_ELEMENTAL_DAMAGE")}):null}function ne(e){var n=e.rotation,t=(0,A.useMemo)((function(){if(n){var e=new Map;n.instances.forEach((function(n){var t,r=n.damage,a=null!==(t=n.instanceName)&&void 0!==t?t:"",c=e.get(a)||0;e.set(a,c+r)}));var t=Array.from(e.entries());return{series:t.map((function(e){return e[1]})),labels:t.map((function(e){return s.G.Describe.getTitle(e[0])}))}}}),[n]);return n&&t?(0,I.jsx)(X,{options:{colors:_.slice(1),theme:{mode:"dark"},labels:t.labels,tooltip:{custom:function(e){var n=e.series,r=e.seriesIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(t.labels[r],"</div>")+'<div class="value">'.concat((0,o.KF)("DAMAGE"),": ").concat((0,J.F)(n[r],2),"</div>")+"</div>"}}},series:t.series,type:"pie",header:(0,o.KF)("ROTATION_INSTANCE_DAMAGE")}):null}function te(e){var n=e.rotation,t=(0,A.useMemo)((function(){if(n){var e=n.fractions.TalentDMG;return{series:Object.values(e).map((function(e){return e*n.damage})),labels:Object.keys(e).map((function(e){return"other"===e?(0,o.KF)("DAMAGE_EXTRA"):s.G.Describe.getTitle(e)}))}}}),[n]);return n&&t?(0,I.jsx)(X,{options:{colors:_.slice(1),theme:{mode:"dark"},labels:t.labels,tooltip:{custom:function(e){var n=e.series,r=e.seriesIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(t.labels[r],"</div>")+'<div class="value">'.concat((0,o.KF)("DAMAGE"),": ").concat((0,J.F)(n[r],2),"</div>")+"</div>"}}},series:t.series,type:"pie",header:(0,o.KF)("ROTATION_TALENT_DAMAGE")}):null}function re(e){var n=e.instance;return(0,I.jsx)(T.Z,{onClick:function(){var e=n.instanceName?s.G.Describe.getTitle(n.instanceName):"";(0,h.a)({title:(0,o.KF)("ROTATION_DAMAGE_FORMULA")+" | "+e,message:(0,I.jsx)(ae,{instance:n})})},children:(0,I.jsx)(C.Z,{})})}function ae(e){var n=e.instance,t={ROTATION_INSTANCE_DAMAGE:{replace:(0,o.KF)("ROTATION_INSTANCE_DAMAGE"),text:"",background:""},DAMAGE:{replace:(0,o.KF)("DAMAGE"),text:"",background:""},DAMAGE_NOAURA_NOREACTION:{replace:s.G.round(n.noaura.noreaction),text:f[1],background:_[1]},DAMAGE_NOAURA_REACTION:{replace:s.G.round(n.noaura.yesreaction),text:f[2],background:_[2]},DAMAGE_AURA_NOREACTION:{replace:s.G.round(n.yesaura.noreaction),text:f[16],background:_[16]},DAMAGE_AURA_REACTION:{replace:s.G.round(n.yesaura.yesreaction),text:f[4],background:_[4]},ROTATION_AURA_UPTIME:{replace:s.G.percent(n.paura),text:f[13],background:_[13]},ROTATION_REACTION_UPTIME:{replace:s.G.percent(n.preaction),text:f[9],background:_[9]},ROTATION_INSTANCE_AOE:{replace:s.G.percent(n.multiplier),text:f[7],background:_[7]},ROTATION_INSTANCE_COUNT:{replace:s.G.round(n.count)||"0",text:f[8],background:_[8]}},r=R(n.paura>0?"\n    ROTATION_INSTANCE_DAMAGE= DAMAGE_NOAURA_NOREACTION * (1-ROTATION_AURA_UPTIME)*(1-(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME))\n    +DAMAGE_NOAURA_REACTION * (1-ROTATION_AURA_UPTIME)*(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME)\n    +DAMAGE_AURA_NOREACTION * (ROTATION_AURA_UPTIME)*(1-(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME))\n    +DAMAGE_AURA_REACTION * (ROTATION_AURA_UPTIME)*(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME)\n    DAMAGE=(ROTATION_INSTANCE_AOE)*(ROTATION_INSTANCE_COUNT)*(ROTATION_INSTANCE_DAMAGE)\n":"\nROTATION_INSTANCE_DAMAGE= DAMAGE_NOAURA_NOREACTION\nDAMAGE=(ROTATION_INSTANCE_AOE)*(ROTATION_INSTANCE_COUNT)*(ROTATION_INSTANCE_DAMAGE)\n",t);return(0,I.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[(0,I.jsx)("div",{dangerouslySetInnerHTML:{__html:r}}),(0,I.jsx)("div",{className:"formula-legend",children:(0,I.jsx)(D.Z,{children:Object.entries(t).map((function(e,n){var t=(0,l.Z)(e,2),r=t[0],a=t[1];if(""===a.background)return null;var c=(0,o.KF)(r);return c.includes("{")&&(c=s.G.Describe.getTitle(r)),(0,I.jsx)(N.Z,{xs:12,md:6,children:(0,I.jsxs)("div",{className:"d-flex align-items-center item",children:[(0,I.jsx)("div",{className:"marker",style:{backgroundColor:a.background}}),(0,I.jsx)("div",{className:"label",children:c})]})},n)}))})})]})}function ce(e){var n=e.rotation,t=function(e,n){return e?s.G.Describe.getTitle((null!==n&&void 0!==n?n:"")+e):(0,o.KF)("STAT_NONE")};return(0,I.jsxs)(m.Z,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,I.jsx)("thead",{children:(0,I.jsxs)("tr",{children:[(0,I.jsx)("th",{children:(0,o.KF)("ROTATION_AOE")}),(0,I.jsx)("th",{children:(0,o.KF)("ROTATION_COUNT")}),(0,I.jsx)("th",{children:(0,o.KF)("DAMAGE_INST")}),(0,I.jsx)("th",{children:(0,o.KF)("EFFECT_AURA")}),(0,I.jsx)("th",{children:(0,o.KF)("ROTATION_AURA_VALUE")}),(0,I.jsx)("th",{children:(0,o.KF)("ROTATION_REACTION_VALUE")}),(0,I.jsx)("th",{children:(0,o.KF)("DAMAGE")}),(0,I.jsx)("th",{children:(0,o.KF)("DAMAGE_FORMULA_SHORT")})]})}),(0,I.jsx)("tbody",{children:n.instances.map((function(e,n){var r=e.affectedBy?"string"===typeof e.affectedBy?[e.affectedBy]:e.affectedBy:[];return(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{className:"align-middle",children:s.G.percent(e.multiplier)}),(0,I.jsx)("td",{className:"align-middle",children:e.count}),(0,I.jsx)("td",{className:"align-middle",children:t(e.instanceName)}),(0,I.jsx)("td",{className:"align-middle",children:(0,I.jsx)(G.Z,{direction:"horizontal",gap:1,children:r.map((function(e){return(0,I.jsx)(M.Z,{trigger:["hover","focus"],overlay:(0,I.jsx)(x.Z,{children:t(e,"Aura.")}),children:(0,I.jsx)("div",{children:(0,I.jsx)(g.Z,{element:e})})},e)}))})}),(0,I.jsx)("td",{className:"align-middle",children:s.G.percent(e.paura)}),(0,I.jsx)("td",{className:"align-middle",children:s.G.percent(e.preaction)}),(0,I.jsx)("td",{className:"align-middle",children:(0,I.jsx)("div",{className:"element-"+e.ElementalDMG,children:s.G.round(e.damage)})}),(0,I.jsx)("td",{className:"align-middle text-center",children:(0,I.jsx)(re,{instance:e})})]},n)}))})]})}function ie(e){var n=e.project,t=e.onChange,r=n.character,a=n.rotationId,c=(0,A.useState)(void 0),i=(0,l.Z)(c,2),m=i[0],M=i[1],x=function(e){var n=(0,A.useMemo)((function(){return[]}),[]),t=(0,A.useReducer)((function(e){return(e+1)%7}),0),r=(0,l.Z)(t,2)[1];return{addAlert:function(t){var a=t.content,c=t.variant,i=void 0===c?"info":c,l=t.timeout,s=void 0===l?3e3:l,o={content:a,variant:i,timeout:s};e&&n.length>=e&&n.shift(),n.push(o),r(),s>0&&Number.isFinite(s)&&setTimeout((function(){var e=n.indexOf(o);e>-1&&(n.splice(e,1),r())}),s)},Alerts:function(){return(0,I.jsx)(I.Fragment,{children:n.map((function(e,n){return(0,I.jsx)(K.Z,{variant:e.variant,children:e.content},n)}))})},clearAlerts:function(){n.splice(0,n.length),r()}}}(1),g=x.Alerts,h=x.addAlert,T=(0,S.Z)().language;return(0,A.useEffect)((function(){M(void 0);var e=n.character,t=n.rotationId;(0,d.q$)({id:t}).then((function(n){var r=n.find((function(e){return e.id===t}));r&&function(e){return e.character instanceof s.G.Character&&(e.character=s.G.CharacterLoader.exportCharacter(e.character)),new Promise((function(n,t){var r=performance.now(),a=(0,U.HB)().addMessageListener((function(e){e.type===w&&e.id===r&&(e.error?t(e.error):((0,U.HB)().removeMessageListener(a),n(e.result)))}));(0,U.HB)().postMessage({id:r,type:w,data:e})}))}({character:e,rotation:r}).then((function(e){M(e)})).catch((function(e){h(e)}))}))}),[n,r,a]),(0,A.useEffect)((function(){m&&M((0,L.Z)({},m))}),[T]),(0,I.jsxs)(u.Z,{children:[(0,I.jsx)(u.Z.Header,{as:"h5",className:"m-0 bg-info",children:(0,o.KF)("ROTATION_DAMAGE")}),(0,I.jsxs)(u.Z.Body,{children:[(0,I.jsx)(g,{}),(0,I.jsxs)(D.Z,{className:"gx-1 gy-1",children:[(0,I.jsx)(N.Z,{xs:12,children:(0,I.jsx)(Q.x,{project:n,onChange:t})}),(0,I.jsx)(N.Z,{xs:12,children:m?(0,I.jsx)("div",{className:"d-flex justify-content-center bg-primary",children:(0,I.jsx)("table",{children:(0,I.jsxs)("tbody",{children:[(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{className:"align-middle",children:(0,o.KF)("ROTATION_DAMAGE")}),(0,I.jsx)("td",{className:"align-middle",children:(0,I.jsx)(Y.Z,{bg:"warning",className:"d-block ms-1 text-black",children:s.G.round(m.damage)})})]}),(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{className:"align-middle",children:(0,I.jsxs)(G.Z,{direction:"horizontal",gap:1,children:[(0,I.jsx)("div",{children:(0,o.KF)("ROTATION_DPS")}),(0,I.jsxs)(Y.Z,{bg:"info",children:[m.duration," s"]})]})}),(0,I.jsx)("td",{className:"align-middle",children:(0,I.jsx)(Y.Z,{bg:"warning",className:"d-block ms-1 text-black",children:s.G.round(m.DPS)})})]})]})})}):(0,I.jsx)("div",{className:"d-flex justify-content-center",children:(0,I.jsx)(z.Z,{animation:"border",variant:"primary"})})}),(0,I.jsx)(N.Z,{md:12,lg:6,children:(0,I.jsx)(ne,{rotation:m})}),(0,I.jsx)(N.Z,{md:12,lg:6,children:(0,I.jsx)(te,{rotation:m})}),(0,I.jsx)(N.Z,{md:12,lg:6,children:(0,I.jsx)(ee,{rotation:m})}),(0,I.jsx)(N.Z,{md:12,lg:6,children:(0,I.jsx)(W,{rotation:m})}),(0,I.jsx)(N.Z,{xs:12,children:m?(0,I.jsx)(E.Z,{children:(0,I.jsxs)(E.Z.Item,{eventKey:"0",children:[(0,I.jsx)(E.Z.Header,{children:(0,o.KF)("CALCULATION_DETAILS")}),(0,I.jsx)(E.Z.Body,{children:(0,I.jsx)(ce,{rotation:m})})]})}):null})]})]})]})}var le=t(42072),se=t(22102),oe="damage",de=3;function Ae(){var e=(0,r.vo)(),n=(0,le.P)().update;return(0,I.jsx)(se.Z,{children:(0,I.jsxs)(G.Z,{gap:1,children:[(0,I.jsx)(Z,{project:e}),(0,I.jsx)(ie,{project:e,onChange:n})]})})}}}]);