"use strict";(self.webpackChunkgenshin_gui=self.webpackChunkgenshin_gui||[]).push([[3818],{97679:function(e,t,n){function r(e,t){for(var n=e.toFixed(t),r=n.length-1;r>=0&&"0"===n[r];r--)n=n.slice(0,r);return n.endsWith(".")&&(n=n.slice(0,n.length-1)),n}n.d(t,{F:function(){return r}})},18734:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(1413),a=n(45987);n(47313);var c=n.p+"static/media/pyro.babb0a5d6f255ce987686e321062adf8.svg";var i=n.p+"static/media/hydro.dbcf75ab6927f7b73d17f4fb71f621ac.svg";var s=n.p+"static/media/cryo.3bdb562015df89a20e96599718419039.svg";var l=n.p+"static/media/electro.178efeba7aa67dca8d20a69fdcaebfaa.svg";var o=n.p+"static/media/geo.61c55e600f72d666196bdb5307a35bf2.svg";var d=n.p+"static/media/anemo.8fbd12d60899bee429fa3c3fbd9e131b.svg";var A=n.p+"static/media/dendro.97c848cc4e28377348d86edf1d79fb2d.svg",u=n(46417),E=["element","width","height"];function m(e){var t=e.element,n=e.width,m=void 0===n?24:n,M=(e.height,(0,a.Z)(e,E));switch(t){case"AnemoDMG":return(0,u.jsx)("img",(0,r.Z)((0,r.Z)({width:m},M),{},{src:d,alt:"anemo"}));case"GeoDMG":return(0,u.jsx)("img",(0,r.Z)((0,r.Z)({width:m},M),{},{src:o,alt:"geo"}));case"ElectroDMG":return(0,u.jsx)("img",(0,r.Z)((0,r.Z)({width:m},M),{},{src:l,alt:"electro"}));case"CryoDMG":case"Frozen":return(0,u.jsx)("img",(0,r.Z)((0,r.Z)({width:m},M),{},{src:s,alt:"cryo"}));case"HydroDMG":return(0,u.jsx)("img",(0,r.Z)((0,r.Z)({width:m},M),{},{src:i,alt:"hydro"}));case"PyroDMG":return(0,u.jsx)("img",(0,r.Z)((0,r.Z)({width:m},M),{},{src:c,alt:"pyro"}));case"DendroDMG":return(0,u.jsx)("img",(0,r.Z)((0,r.Z)({width:m},M),{},{src:A,alt:"pyro"}));default:return null}}},23818:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ae},position:function(){return de},title:function(){return oe}});var r=n(96103),a=n(93433),c=n(74165),i=n(15861),s=n(93324),l=n(45043),o=n(79188),d=n(47017),A=n(47313),u=n(65832),E=n(53768),m=n(465),M=n(31136),g=n(95668),x=n(18734),h=n(75936),T=n(93298),G=n(48648),D=n(63849),N=n(31616),f=["#696969","#2E8B57","#8B0000","#808000","#8B008B","#FFA500","#0000CD","#7CFC00","#00FA9A","#4169E1","#00FFFF","#00BFFF","#ff4b00","#FFFF54","#DDA0DD","#FF1493","#FFDAB9","#FF0000"],v=["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#000000","#FFFFFF","#000000","#000000","#FFFFFF","#000000","#000000","#FFFFFF","#000000","#000000","#FFFFFF","#000000","#FFFFFF"],p={PyroDMG:"rgb(235, 118, 22)",HydroDMG:"rgb(0, 125, 197)",CryoDMG:"rgb(153, 238, 238)",ElectroDMG:"rgb(216, 89, 255)",GeoDMG:"rgb(226, 167, 56)",AnemoDMG:"rgb(0, 255, 149)",DendroDMG:"rgb(46, 163, 42)",PhysicalDMG:"rgb(177, 177, 177)"};var _=function(e,t){var n,r;return[null!==(n=v[e])&&void 0!==n?n:"#FFFFFF",null!==(r=f[e])&&void 0!==r?r:"#000000"][t]},j={variable:/([a-z_][a-z_0-9]*)/i,operator:/(\+|\-|\*|\/|\(|\)|=|\^)/,number:/([0-9]+)(\.[0-9]+)?%?/},F=new RegExp("(".concat(j.variable.source,"|").concat(j.operator.source,"|").concat(j.number.source,")"),"ig");function R(e,t){return(e=e.replace(/(^\s*|\s*$)/g,"").replace(/\s*\n+\s*/g,"\n")).split("\n").map((function(e){return'<div class="formula">'+function(e,t){var n=(e=e.replace(/\s+/g,"")).match(F);if(!n)return"";for(var r,a=[],c=[],i=0;i<n.length;i++){var s=n[i];if("("===s)c.push(i);else if(")"===s){var l=c.pop();if(void 0===l)throw new Error("Mismatched parentheses");var o=i;a[l]='<div class="group">',a[o]="</div>"}else if(s.match(j.variable)){var d="";if(t){var A=t[s];A&&(d='style="color: '.concat((r=A).text,"; background-color: ").concat(r.background,';"'),A.replace&&(s=A.replace+""))}a[i]='<div class="token variable" '.concat(d,">").concat(s,"</div>")}else if(s.match(j.operator)){var u="addition";"-"===s?u="subtraction":"*"===s?(u="multiplication",s="&times;"):"/"===s?u="division":"^"===s&&(u="exponent"),a[i]='<div class="token operator '.concat(u,'">').concat(s,"</div>")}else s.match(j.number)&&(a[i]='<div class="token number">'.concat(s,"</div>"))}return a.join("")}(e,t)+"</div>"})).join("")}var b=n(46417);function O(e){var t=e.instance,n=t.character,r=t.getCalculatedMVs(),a=t.getFlatValues(),c=t.getReactionDMG(),i=c.reaction?n.get(c.reaction):0,d=function(e){var t=e.motionValues,n=e.flatValues,r=e.reactionMultiplier,a=e.res,c=t.map((function(e){var t=e.name.replace(/.*ATK$/g,"ATK");return"".concat(l.G.percent(e.MV),"*").concat(t)})).join("+"),i=n.map((function(e){return"".concat(e.value)})).join("+"),s=c+(""!==i&&t.length>0?"+":"")+i,o=e.ignoreRES?"":a<0?"*(1-(DAMAGE_ENEMYRES/2))":a<.75?"*(1-DAMAGE_ENEMYRES)":"*(1/(4*DAMAGE_ENEMYRES+1))",d=1===r?"":"*(1+((278%*ElementalMastery)/(ElementalMastery+1400))+DAMAGE_REACTIONDMG)*DAMAGE_REACTION",A=e.ignoreDEF?"":"*( (DAMAGE_CHARLVL+100) / ( (1-DAMAGE_ENEMYDEFIGNORED)*(1-DAMAGE_ENEMYDEF)*(DAMAGE_ENEMYLVL + 100) + DAMAGE_CHARLVL+100 )  )";return"\n    DAMAGE_NOCRIT=DAMAGE_MULTIPLIER*(".concat(s,")\n    ").concat(e.onlyMV?"":"*(1 + DAMAGE_ELEMENTAL + DAMAGE_TALENT + DAMAGE_ALL + DAMAGE_SPECIFIC)","\n    ").concat(d,"\n    ").concat(A,"\n    ").concat(o,"\n    DAMAGE_CRIT=(DAMAGE_NOCRIT)").concat(e.ignoreCRIT?"":"*(1+CRITDMG)","\n    DAMAGE_AVG=(DAMAGE_NOCRIT)").concat(e.ignoreCRIT?"":"*(1+CRITRate*CRITDMG)","\n    ")}({motionValues:r,flatValues:a,reactionMultiplier:c.multiplier,res:n.enemy.getRES(t.ElementalDMG),ignoreRES:t.ignoreRES,ignoreDEF:t.ignoreDEF,ignoreCRIT:t.ignoreCRIT,onlyMV:t.onlyMV}),A=t.TalentDMG?n.get(t.TalentDMG):0,u={DAMAGE_NOCRIT:{replace:(0,o.KF)("DAMAGE_NOCRIT"),text:"inherit",background:"transparent"},ATK:{replace:(0,l.q)("ATK",n.get("ATK")),text:_(0,0),background:_(0,1)},HP:{replace:(0,l.q)("HP",n.get("HP")),text:_(1,0),background:_(1,1)},DEF:{replace:(0,l.q)("DEF",n.get("DEF")),text:_(2,0),background:_(2,1)},DAMAGE_MULTIPLIER:{replace:l.G.percent(t.getMultiplier()),text:_(3,0),background:_(3,1)},DAMAGE_ELEMENTAL:{replace:(0,l.q)("PyroDMG",n.get(t.ElementalDMG)),text:_(4,0),background:_(4,1)},DAMAGE_TALENT:{replace:(0,l.q)("PyroDMG",A),text:_(5,0),background:_(5,1)},DAMAGE_ALL:{replace:(0,l.q)("PyroDMG",n.get("AllDMG")),text:_(6,0),background:_(6,1)},DAMAGE_SPECIFIC:{replace:(0,l.q)("PyroDMG",t.get("AllDMG")),text:_(7,0),background:_(7,1)},DAMAGE_CHARLVL:{replace:n.Level,text:_(8,0),background:_(8,1)},DAMAGE_ENEMYDEF:{replace:(0,l.q)("PyroDMG",n.enemy.get("DEFreduction")),text:_(9,0),background:_(9,1)},DAMAGE_ENEMYDEFIGNORED:{replace:(0,l.q)("PyroDMG",t.get("DEFignored")+n.get("DEFignored")),text:_(10,0),background:_(10,1)},DAMAGE_ENEMYLVL:{replace:n.enemy.Level,text:_(11,0),background:_(11,1)},DAMAGE_ENEMYRES:{replace:(0,l.q)("PyroDMG",n.enemy.getRES(t.ElementalDMG)),text:_(12,0),background:_(12,1)},ElementalMastery:{replace:(0,l.q)("ElementalMastery",n.get("ElementalMastery")+t.get("ElementalMastery")),text:_(13,0),background:_(13,1)},DAMAGE_REACTION:{replace:(0,l.q)("PyroDMG",c.multiplier),text:_(14,0),background:_(14,1)},DAMAGE_REACTIONDMG:{replace:(0,l.q)("PyroDMG",i),text:_(15,0),background:_(15,1)},DAMAGE_CRIT:{replace:(0,o.KF)("DAMAGE_CRIT"),text:"inherit",background:"transparent"},DAMAGE_AVG:{replace:(0,o.KF)("DAMAGE_AVG"),text:"inherit",background:"transparent"},CRITDMG:{replace:(0,l.q)("CRITDMG",t.calculateCRITDMG()),text:_(16,0),background:_(16,1)},CRITRate:{replace:(0,l.q)("CRITRate",t.calculateCRITRate()),text:_(17,0),background:_(17,1)}},E=R(d,u);return(0,b.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[(0,b.jsx)("div",{className:"d-flex justify-content-center formula",children:(0,b.jsxs)(G.Z,{direction:"horizontal",gap:1,children:[(0,b.jsx)("div",{className:"token variable",style:{backgroundColor:_(4,1),color:_(4,0)},children:l.G.Describe.getTitle(t.ElementalDMG)}),t.TalentDMG?(0,b.jsx)("div",{className:"token variable",style:{backgroundColor:_(5,1),color:_(5,0)},children:l.G.Describe.getTitle(t.TalentDMG)}):null]})}),(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:E}}),(0,b.jsx)("div",{className:"formula-legend",children:(0,b.jsx)(D.Z,{children:Object.entries(u).map((function(e,t){var n=(0,s.Z)(e,2),r=n[0],a=n[1];if("transparent"===a.background)return null;var c=(0,o.KF)(r);return c.includes("{")&&(c=l.G.Describe.getTitle(r)),(0,b.jsx)(N.Z,{xs:12,md:6,lg:4,children:(0,b.jsxs)("div",{className:"d-flex align-items-center item",children:[(0,b.jsx)("div",{className:"marker",style:{backgroundColor:a.background}}),(0,b.jsx)("div",{className:"label",children:c})]})},t)}))})})]})}function I(e){var t=e.instance,n=t.character,r=l.G.TransformativeFormula.reactionMultiplier(t.ReactionDMG),a=function(e){var t=e.res;return"\n    DAMAGE_NOCRIT=(0.00194*DAMAGE_CHARLVL^3-0.319*DAMAGE_CHARLVL^2+30.7*DAMAGE_CHARLVL-868)\n    *(1+((1600%*ElementalMastery)/(ElementalMastery+2000))+DAMAGE_REACTIONDMG)*DAMAGE_REACTION\n    ".concat(t<0?"*(1-(DAMAGE_ENEMYRES/2))":t<.75?"*(1-DAMAGE_ENEMYRES)":"*(1/(4*DAMAGE_ENEMYRES+1))","\n    ")}({res:n.enemy.getRES(t.ElementalDMG)}),c={DAMAGE_NOCRIT:{replace:(0,o.KF)("DAMAGE_NOCRIT"),text:"inherit",background:"transparent"},DAMAGE_CHARLVL:{replace:n.Level,text:_(8,0),background:_(8,1)},DAMAGE_ENEMYRES:{replace:(0,l.q)("PyroDMG",n.enemy.getRES(t.ElementalDMG)),text:_(12,0),background:_(12,1)},ElementalMastery:{replace:(0,l.q)("ElementalMastery",n.get("ElementalMastery")),text:_(13,0),background:_(13,1)},DAMAGE_REACTION:{replace:(0,l.q)("PyroDMG",r),text:_(14,0),background:_(14,1)},DAMAGE_REACTIONDMG:{replace:(0,l.q)("PyroDMG",n.get(t.ReactionDMG)+t.get("AllDMG")),text:_(15,0),background:_(15,1)}},i=R(a,c);return(0,b.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:i}}),(0,b.jsx)("div",{className:"formula-legend",children:(0,b.jsx)(D.Z,{children:Object.entries(c).map((function(e,t){var n=(0,s.Z)(e,2),r=n[0],a=n[1];if("transparent"===a.background)return null;var c=(0,o.KF)(r);return c.includes("{")&&(c=l.G.Describe.getTitle(r)),(0,b.jsx)(N.Z,{xs:12,md:6,lg:4,children:(0,b.jsxs)("div",{className:"d-flex align-items-center item",children:[(0,b.jsx)("div",{className:"marker",style:{backgroundColor:a.background}}),(0,b.jsx)("div",{className:"label",children:c})]})},t)}))})})]})}var C=n(87284);function y(e){var t=e.instance;return(0,b.jsx)(T.Z,{onClick:function(){t instanceof l.G.DamageInstance?(0,h.a)({title:(0,o.KF)("DAMAGE_FORMULA")+" | "+l.G.Describe.getTitle(t.name),message:(0,b.jsx)(O,{instance:t})}):t instanceof l.G.TransformativeDamageInstance&&(0,h.a)({title:(0,o.KF)("DAMAGE_FORMULA"),message:(0,b.jsx)(I,{instance:t})})},children:(0,b.jsx)(C.Z,{})})}function Z(e){var t=e.list;return(0,b.jsxs)(m.Z,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:(0,o.KF)("DAMAGE_INST")}),(0,b.jsx)("th",{children:(0,o.KF)("DAMAGE_NOCRIT")}),(0,b.jsx)("th",{children:(0,o.KF)("DAMAGE_CRIT")}),(0,b.jsx)("th",{children:(0,o.KF)("DAMAGE_AVG")}),(0,b.jsx)("th",{children:(0,o.KF)("DAMAGE_FORMULA_SHORT")})]})}),(0,b.jsxs)("tbody",{children:[t.map((function(e,t){return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"w-50 align-middle",children:(0,b.jsx)(M.Z,{trigger:["hover","focus"],placement:"left",overlay:(0,b.jsx)(g.Z,{children:l.G.Describe.getTitle("Element."+e.ElementalDMG)}),children:(0,b.jsxs)("div",{className:"d-flex align-items-center",children:[(0,b.jsx)(x.Z,{element:e.ElementalDMG,style:{verticalAlign:"-0.125em"}}),l.G.Describe.getTitle(e.name)]})})}),(0,b.jsx)("td",{className:"align-middle",children:(0,b.jsx)("div",{className:"element-"+e.ElementalDMG,children:l.G.round(e.calculateNoCRIT())})}),(0,b.jsx)("td",{className:"align-middle",children:(0,b.jsx)("div",{className:"element-"+e.ElementalDMG,children:l.G.round(e.calculateCRIT())})}),(0,b.jsx)("td",{className:"align-middle",children:(0,b.jsx)("div",{className:"element-"+e.ElementalDMG,children:l.G.round(e.calculateAverage())})}),(0,b.jsx)("td",{className:"text-center align-middle",children:(0,b.jsx)(y,{instance:e})})]},t)})),0===t.length&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:"text-center",colSpan:5,children:(0,o.KF)("DAMAGE_INST_EMPTY")})})]})]})}function k(e){var t=e.project,n=t.character,r=t.rotationId,m=(0,A.useState)([]),M=(0,s.Z)(m,2),g=M[0],x=M[1];(0,A.useEffect)((function(){function e(){return e=(0,i.Z)((0,c.Z)().mark((function e(){var t,a,i,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.q$)({id:r});case 2:if(t=e.sent.find((function(e){return e.id===r}))){e.next=7;break}return e.abrupt("return");case 7:(a=new l.G.Rotation(t)).setCharacter(n),i=n.rotationRules.generate(a),s=l.G.reduceArray(i.map((function(e){return e.include?e.include.map((function(e){return e.instance})):[]}))).filter((function(e){return!!e})),x(s);case 12:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[n,r]);var h=(0,A.useMemo)((function(){var e=n.damage.getTransformative();return{DAMAGE_NORMALS:n.damage.getNormalAttacks(),DAMAGE_ES:n.damage.getElementalSkills(),DAMAGE_EB:n.damage.getElementalBursts(),DAMAGE_TRANSFORMATIVE:e,DAMAGE_EXTRA:[].concat((0,a.Z)(n.damage.getExtraDamage().filter((function(t){return!e.includes(t)}))),(0,a.Z)(g))}}),[n,g]);return(0,b.jsxs)(u.Z,{children:[(0,b.jsx)(u.Z.Header,{as:"h5",className:"bg-info m-0",children:(0,o.KF)("DAMAGE_INSTANCES")}),(0,b.jsx)(u.Z.Body,{children:(0,b.jsx)(E.Z,{children:l.G.getObjectKeys(h).map((function(e){return(0,b.jsxs)(E.Z.Item,{eventKey:e,children:[(0,b.jsx)(E.Z.Header,{children:(0,o.KF)(e)}),(0,b.jsx)(E.Z.Body,{children:(0,b.jsx)(Z,{list:h[e]})})]},e)}))})})]})}var L=n(1413),K=n(6203);var S=n(68582),U=n(29447),P=n(15671),V=n(43144),w=n(60136),H=n(27277),q=n(95397),B="calculate-rotation";q.z;var Y=n(89582),z=n(44030),$=n(93739),X=n(91638);function W(e){var t;return(0,b.jsxs)("div",{className:"h-100 chart-container",children:[(0,b.jsx)("h5",{className:"m-0 p-1 text-center",children:null!==(t=e.header)&&void 0!==t?t:""}),(0,b.jsx)("div",{children:(0,b.jsx)(X.Z,(0,L.Z)((0,L.Z)({},e),{},{options:(0,L.Z)({chart:{toolbar:{show:!1}},theme:{mode:"dark"},legend:{position:"bottom"}},e.options),width:"100%"}))})]})}function J(e){var t=e.rotation,n=(0,A.useMemo)((function(){if(t){var e=t.benefits;return[{data:Object.entries(e).map((function(e){var t,n=(0,s.Z)(e,2),r=n[0],a=n[1];return{x:l.G.Describe.getTitle(r)+" (+".concat((t=r,(0,l.q)(t,l.G.DatabaseValues.getMinValue(t))),")"),y:a}})).filter((function(e){return e.y>0})).sort((function(e,t){return t.y-e.y}))}]}}),[t]);if(!t||!n)return null;var r=n[0].data;return(0,b.jsx)(W,{options:{colors:f.slice(1),tooltip:{custom:function(e){var t=e.dataPointIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(r[t].x,"</div>")+'<div class="value">'.concat((0,o.KF)("DAMAGE_BENEFIT"),": ").concat(l.G.percent(r[t].y,!0,4),"</div>")+"</div>"}},xaxis:{labels:{formatter:function(e){return l.G.percent(parseFloat(e))}}},dataLabels:{formatter:function(e){return l.G.percent(e,!0,4)}},plotOptions:{bar:{horizontal:!0}}},series:n,type:"bar",header:(0,o.KF)("DAMAGE_ROLL_BENEFIT")})}var Q=n(97679);function ee(e){var t=e.rotation,n=(0,A.useMemo)((function(){if(t){var e=t.fractions.ElementalDMG;return{series:Object.values(e).map((function(e){return e*t.damage})),labels:Object.keys(e).map((function(e){return"other"===e?(0,o.KF)("DAMAGE_EXTRA"):l.G.Describe.getTitle("Element."+e)})),colors:Object.keys(e).map((function(e){return p[e]}))}}}),[t]);return t&&n?(0,b.jsx)(W,{options:{colors:n.colors,labels:n.labels,tooltip:{custom:function(e){var t=e.series,r=e.seriesIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(n.labels[r],"</div>")+'<div class="value">'.concat((0,o.KF)("DAMAGE"),": ").concat((0,Q.F)(t[r],2),"</div>")+"</div>"}}},series:n.series,type:"pie",header:(0,o.KF)("ROTATION_ELEMENTAL_DAMAGE")}):null}function te(e){var t=e.rotation,n=(0,A.useMemo)((function(){if(t){var e=new Map;t.instances.forEach((function(t){var n,r=t.damage,a=null!==(n=t.instanceName)&&void 0!==n?n:"",c=e.get(a)||0;e.set(a,c+r)}));var n=Array.from(e.entries());return{series:n.map((function(e){return e[1]})),labels:n.map((function(e){return l.G.Describe.getTitle(e[0])}))}}}),[t]);return t&&n?(0,b.jsx)(W,{options:{colors:f.slice(1),theme:{mode:"dark"},labels:n.labels,tooltip:{custom:function(e){var t=e.series,r=e.seriesIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(n.labels[r],"</div>")+'<div class="value">'.concat((0,o.KF)("DAMAGE"),": ").concat((0,Q.F)(t[r],2),"</div>")+"</div>"}}},series:n.series,type:"pie",header:(0,o.KF)("ROTATION_INSTANCE_DAMAGE")}):null}function ne(e){var t=e.rotation,n=(0,A.useMemo)((function(){if(t){var e=t.fractions.TalentDMG;return{series:Object.values(e).map((function(e){return e*t.damage})),labels:Object.keys(e).map((function(e){return"other"===e?(0,o.KF)("DAMAGE_EXTRA"):l.G.Describe.getTitle(e)}))}}}),[t]);return t&&n?(0,b.jsx)(W,{options:{colors:f.slice(1),theme:{mode:"dark"},labels:n.labels,tooltip:{custom:function(e){var t=e.series,r=e.seriesIndex;return'<div class="chart-tooltip">'+'<div class="header">'.concat(n.labels[r],"</div>")+'<div class="value">'.concat((0,o.KF)("DAMAGE"),": ").concat((0,Q.F)(t[r],2),"</div>")+"</div>"}}},series:n.series,type:"pie",header:(0,o.KF)("ROTATION_TALENT_DAMAGE")}):null}function re(e){var t=e.instance;return(0,b.jsx)(T.Z,{onClick:function(){var e=t.instanceName?l.G.Describe.getTitle(t.instanceName):"";(0,h.a)({title:(0,o.KF)("ROTATION_DAMAGE_FORMULA")+" | "+e,message:(0,b.jsx)(ae,{instance:t})})},children:(0,b.jsx)(C.Z,{})})}function ae(e){var t=e.instance,n={ROTATION_INSTANCE_DAMAGE:{replace:(0,o.KF)("ROTATION_INSTANCE_DAMAGE"),text:"",background:""},DAMAGE:{replace:(0,o.KF)("DAMAGE"),text:"",background:""},DAMAGE_NOAURA_NOREACTION:{replace:l.G.round(t.noaura.noreaction),text:v[1],background:f[1]},DAMAGE_NOAURA_REACTION:{replace:l.G.round(t.noaura.yesreaction),text:v[2],background:f[2]},DAMAGE_AURA_NOREACTION:{replace:l.G.round(t.yesaura.noreaction),text:v[16],background:f[16]},DAMAGE_AURA_REACTION:{replace:l.G.round(t.yesaura.yesreaction),text:v[4],background:f[4]},ROTATION_AURA_UPTIME:{replace:l.G.percent(t.paura),text:v[13],background:f[13]},ROTATION_REACTION_UPTIME:{replace:l.G.percent(t.preaction),text:v[9],background:f[9]},ROTATION_INSTANCE_AOE:{replace:l.G.percent(t.multiplier),text:v[7],background:f[7]},ROTATION_INSTANCE_COUNT:{replace:l.G.round(t.count)||"0",text:v[8],background:f[8]}},r=R(t.paura>0?"\n    ROTATION_INSTANCE_DAMAGE= DAMAGE_NOAURA_NOREACTION * (1-ROTATION_AURA_UPTIME)*(1-(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME))\n    +DAMAGE_NOAURA_REACTION * (1-ROTATION_AURA_UPTIME)*(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME)\n    +DAMAGE_AURA_NOREACTION * (ROTATION_AURA_UPTIME)*(1-(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME))\n    +DAMAGE_AURA_REACTION * (ROTATION_AURA_UPTIME)*(ROTATION_REACTION_UPTIME/ROTATION_AURA_UPTIME)\n    DAMAGE=(ROTATION_INSTANCE_AOE)*(ROTATION_INSTANCE_COUNT)*(ROTATION_INSTANCE_DAMAGE)\n":"\nROTATION_INSTANCE_DAMAGE= DAMAGE_NOAURA_NOREACTION\nDAMAGE=(ROTATION_INSTANCE_AOE)*(ROTATION_INSTANCE_COUNT)*(ROTATION_INSTANCE_DAMAGE)\n",n);return(0,b.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:r}}),(0,b.jsx)("div",{className:"formula-legend",children:(0,b.jsx)(D.Z,{children:Object.entries(n).map((function(e,t){var n=(0,s.Z)(e,2),r=n[0],a=n[1];if(""===a.background)return null;var c=(0,o.KF)(r);return c.includes("{")&&(c=l.G.Describe.getTitle(r)),(0,b.jsx)(N.Z,{xs:12,md:6,children:(0,b.jsxs)("div",{className:"d-flex align-items-center item",children:[(0,b.jsx)("div",{className:"marker",style:{backgroundColor:a.background}}),(0,b.jsx)("div",{className:"label",children:c})]})},t)}))})})]})}function ce(e){var t=e.rotation,n=function(e,t){return e?l.G.Describe.getTitle((null!==t&&void 0!==t?t:"")+e):(0,o.KF)("STAT_NONE")};return(0,b.jsxs)(m.Z,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:(0,o.KF)("ROTATION_AOE")}),(0,b.jsx)("th",{children:(0,o.KF)("ROTATION_COUNT")}),(0,b.jsx)("th",{children:(0,o.KF)("DAMAGE_INST")}),(0,b.jsx)("th",{children:(0,o.KF)("EFFECT_AURA")}),(0,b.jsx)("th",{children:(0,o.KF)("ROTATION_AURA_VALUE")}),(0,b.jsx)("th",{children:(0,o.KF)("ROTATION_REACTION_VALUE")}),(0,b.jsx)("th",{children:(0,o.KF)("DAMAGE")}),(0,b.jsx)("th",{children:(0,o.KF)("DAMAGE_FORMULA_SHORT")})]})}),(0,b.jsx)("tbody",{children:t.instances.map((function(e,t){return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"align-middle",children:l.G.percent(e.multiplier)}),(0,b.jsx)("td",{className:"align-middle",children:e.count}),(0,b.jsx)("td",{className:"align-middle",children:n(e.instanceName)}),(0,b.jsxs)("td",{className:"align-middle",children:[e.affectedBy?(0,b.jsx)(x.Z,{element:e.affectedBy}):null,n(e.affectedBy,"Aura.")]}),(0,b.jsx)("td",{className:"align-middle",children:l.G.percent(e.paura)}),(0,b.jsx)("td",{className:"align-middle",children:l.G.percent(e.preaction)}),(0,b.jsx)("td",{className:"align-middle",children:(0,b.jsx)("div",{className:"element-"+e.ElementalDMG,children:l.G.round(e.damage)})}),(0,b.jsx)("td",{className:"align-middle text-center",children:(0,b.jsx)(re,{instance:e})})]},t)}))})]})}function ie(e){var t=e.project,n=e.onChange,r=t.character,a=t.rotationId,c=(0,A.useState)(void 0),i=(0,s.Z)(c,2),m=i[0],M=i[1],g=function(e){var t=(0,A.useMemo)((function(){return[]}),[]),n=(0,A.useReducer)((function(e){return(e+1)%7}),0),r=(0,s.Z)(n,2)[1];return{addAlert:function(n){var a=n.content,c=n.variant,i=void 0===c?"info":c,s=n.timeout,l=void 0===s?3e3:s,o={content:a,variant:i,timeout:l};e&&t.length>=e&&t.shift(),t.push(o),r(),l>0&&Number.isFinite(l)&&setTimeout((function(){var e=t.indexOf(o);e>-1&&(t.splice(e,1),r())}),l)},Alerts:function(){return(0,b.jsx)(b.Fragment,{children:t.map((function(e,t){return(0,b.jsx)(K.Z,{variant:e.variant,children:e.content},t)}))})},clearAlerts:function(){t.splice(0,t.length),r()}}}(1),x=g.Alerts,h=g.addAlert,T=(0,S.Z)().language;return(0,A.useEffect)((function(){M(void 0);var e=t.character,n=t.rotationId;(0,d.q$)({id:n}).then((function(t){var r=t.find((function(e){return e.id===n}));r&&function(e){return e.character instanceof l.G.Character&&(e.character=l.G.CharacterLoader.exportCharacter(e.character)),new Promise((function(t,n){var r=performance.now(),a=(0,U.HB)().addMessageListener((function(e){e.type===B&&e.id===r&&(e.error?n(e.error):((0,U.HB)().removeMessageListener(a),t(e.result)))}));(0,U.HB)().postMessage({id:r,type:B,data:e})}))}({character:e,rotation:r}).then((function(e){M(e)})).catch((function(e){h(e)}))}))}),[t,r,a]),(0,A.useEffect)((function(){m&&M((0,L.Z)({},m))}),[T]),(0,b.jsxs)(u.Z,{children:[(0,b.jsx)(u.Z.Header,{as:"h5",className:"m-0 bg-info",children:(0,o.KF)("ROTATION_DAMAGE")}),(0,b.jsxs)(u.Z.Body,{children:[(0,b.jsx)(x,{}),(0,b.jsxs)(D.Z,{className:"gx-1 gy-1",children:[(0,b.jsx)(N.Z,{xs:12,children:(0,b.jsx)($.x,{project:t,onChange:n})}),(0,b.jsx)(N.Z,{xs:12,children:m?(0,b.jsx)("div",{className:"d-flex justify-content-center bg-primary",children:(0,b.jsx)("table",{children:(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"align-middle",children:(0,o.KF)("ROTATION_DAMAGE")}),(0,b.jsx)("td",{className:"align-middle",children:(0,b.jsx)(Y.Z,{bg:"warning",className:"d-block ms-1 text-black",children:l.G.round(m.damage)})})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"align-middle",children:(0,b.jsxs)(G.Z,{direction:"horizontal",gap:1,children:[(0,b.jsx)("div",{children:(0,o.KF)("ROTATION_DPS")}),(0,b.jsxs)(Y.Z,{bg:"info",children:[m.duration," s"]})]})}),(0,b.jsx)("td",{className:"align-middle",children:(0,b.jsx)(Y.Z,{bg:"warning",className:"d-block ms-1 text-black",children:l.G.round(m.DPS)})})]})]})})}):(0,b.jsx)("div",{className:"d-flex justify-content-center",children:(0,b.jsx)(z.Z,{animation:"border",variant:"primary"})})}),(0,b.jsx)(N.Z,{md:12,lg:6,children:(0,b.jsx)(te,{rotation:m})}),(0,b.jsx)(N.Z,{md:12,lg:6,children:(0,b.jsx)(ne,{rotation:m})}),(0,b.jsx)(N.Z,{md:12,lg:6,children:(0,b.jsx)(ee,{rotation:m})}),(0,b.jsx)(N.Z,{md:12,lg:6,children:(0,b.jsx)(J,{rotation:m})}),(0,b.jsx)(N.Z,{xs:12,children:m?(0,b.jsx)(E.Z,{children:(0,b.jsxs)(E.Z.Item,{eventKey:"0",children:[(0,b.jsx)(E.Z.Header,{children:(0,o.KF)("CALCULATION_DETAILS")}),(0,b.jsx)(E.Z.Body,{children:(0,b.jsx)(ce,{rotation:m})})]})}):null})]})]})]})}var se=n(42072),le=n(22102),oe="damage",de=3;function Ae(){var e=(0,r.vo)(),t=(0,se.P)().update;return(0,b.jsx)(le.Z,{children:(0,b.jsxs)(G.Z,{gap:1,children:[(0,b.jsx)(k,{project:e}),(0,b.jsx)(ie,{project:e,onChange:t})]})})}}}]);