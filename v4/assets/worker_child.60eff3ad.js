(function(){"use strict";var Wt={};(function(e){(function(){var a={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function n(_){return r(c(_),arguments)}function s(_,u){return n.apply(null,[_].concat(u||[]))}function r(_,u){var A=1,S=_.length,h,m="",f,N,L,C,d,M,R,O;for(f=0;f<S;f++)if(typeof _[f]=="string")m+=_[f];else if(typeof _[f]=="object"){if(L=_[f],L.keys)for(h=u[A],N=0;N<L.keys.length;N++){if(h==null)throw new Error(n('[sprintf] Cannot access property "%s" of undefined value "%s"',L.keys[N],L.keys[N-1]));h=h[L.keys[N]]}else L.param_no?h=u[L.param_no]:h=u[A++];if(a.not_type.test(L.type)&&a.not_primitive.test(L.type)&&h instanceof Function&&(h=h()),a.numeric_arg.test(L.type)&&typeof h!="number"&&isNaN(h))throw new TypeError(n("[sprintf] expecting number but found %T",h));switch(a.number.test(L.type)&&(R=h>=0),L.type){case"b":h=parseInt(h,10).toString(2);break;case"c":h=String.fromCharCode(parseInt(h,10));break;case"d":case"i":h=parseInt(h,10);break;case"j":h=JSON.stringify(h,null,L.width?parseInt(L.width):0);break;case"e":h=L.precision?parseFloat(h).toExponential(L.precision):parseFloat(h).toExponential();break;case"f":h=L.precision?parseFloat(h).toFixed(L.precision):parseFloat(h);break;case"g":h=L.precision?String(Number(h.toPrecision(L.precision))):parseFloat(h);break;case"o":h=(parseInt(h,10)>>>0).toString(8);break;case"s":h=String(h),h=L.precision?h.substring(0,L.precision):h;break;case"t":h=String(!!h),h=L.precision?h.substring(0,L.precision):h;break;case"T":h=Object.prototype.toString.call(h).slice(8,-1).toLowerCase(),h=L.precision?h.substring(0,L.precision):h;break;case"u":h=parseInt(h,10)>>>0;break;case"v":h=h.valueOf(),h=L.precision?h.substring(0,L.precision):h;break;case"x":h=(parseInt(h,10)>>>0).toString(16);break;case"X":h=(parseInt(h,10)>>>0).toString(16).toUpperCase();break}a.json.test(L.type)?m+=h:(a.number.test(L.type)&&(!R||L.sign)?(O=R?"+":"-",h=h.toString().replace(a.sign,"")):O="",d=L.pad_char?L.pad_char==="0"?"0":L.pad_char.charAt(1):" ",M=L.width-(O+h).length,C=L.width&&M>0?d.repeat(M):"",m+=L.align?O+h+C:d==="0"?O+C+h:C+O+h)}return m}var i=Object.create(null);function c(_){if(i[_])return i[_];for(var u=_,A,S=[],h=0;u;){if((A=a.text.exec(u))!==null)S.push(A[0]);else if((A=a.modulo.exec(u))!==null)S.push("%");else if((A=a.placeholder.exec(u))!==null){if(A[2]){h|=1;var m=[],f=A[2],N=[];if((N=a.key.exec(f))!==null)for(m.push(N[1]);(f=f.substring(N[0].length))!=="";)if((N=a.key_access.exec(f))!==null)m.push(N[1]);else if((N=a.index_access.exec(f))!==null)m.push(N[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");A[2]=m}else h|=2;if(h===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");S.push({placeholder:A[0],param_no:A[1],keys:A[2],sign:A[3],pad_char:A[4],align:A[5],width:A[6],precision:A[7],type:A[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");u=u.substring(A[0].length)}return i[_]=S}e.sprintf=n,e.vsprintf=s,typeof window<"u"&&(window.sprintf=n,window.vsprintf=s)})()})(Wt);var Ga=Object.defineProperty,Ra=Object.getOwnPropertySymbols,XE=Object.prototype.hasOwnProperty,JE=Object.prototype.propertyIsEnumerable,Ia=(e,a,n)=>a in e?Ga(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,jt=(e,a)=>{for(var n in a||(a={}))XE.call(a,n)&&Ia(e,n,a[n]);if(Ra)for(var n of Ra(a))JE.call(a,n)&&Ia(e,n,a[n]);return e},ZE=(e,a)=>{for(var n in a)Ga(e,n,{get:a[n],enumerable:!0})},P={};ZE(P,{ERR_DIVISION_BY_ZERO:()=>ST,ERR_EXPR_NODE_NOT_FOUND:()=>uT,ERR_EXPR_NODE_NO_VALUE:()=>AT,ERR_FUNCTION_ARGUMENT:()=>ET,ERR_FUNCTION_ARGUMENT_COUNT:()=>Oa,ERR_FUNCTION_CONTEXT:()=>iT,ERR_FUNCTION_INVALID_OPTIONAL:()=>Da,ERR_FUNCTION_UNKNOWN:()=>sT,ERR_LIST_EXPECTED_COMMA:()=>cT,ERR_LIST_UNEXPECTED_COMMA:()=>oT,ERR_MATH:()=>hT,ERR_OPERATOR_UNEXPECTED_LEFT:()=>aT,ERR_OPERATOR_UNEXPECTED_RIGHT:()=>nT,ERR_PARENTHESES_CLOSE:()=>TT,ERR_PARENTHESES_OPEN:()=>_T,ERR_TOKEN_NUMBER_PARSE:()=>eT,ERR_VARIABLE_CONTEXT:()=>lT,ERR_VARIABLE_UNKNOWN:()=>rT,LocationError:()=>tT});function tT(e,a){return new Error(`${e} at position ${a[0]}:${a[1]}`)}var eT=e=>"invalid number: "+e,aT=e=>"unexpected value at the left of operator: "+e,nT=e=>"unexpected value at the right of operator: "+e,sT=e=>"unknown function: "+e,Oa=(e,a,n)=>`function ${e} expected ${a} arguments, got ${n}`,rT=e=>"unknown variable: "+e,Da=e=>"invalid optional argument definition for function "+e,iT="cannot parse a function without context",lT="cannot parse a variable without context",oT="unexpected comma",cT="expected comma",ET="invalid function argument",TT="unexpected closing parenthesis",_T="unclosed opening parenthesis",uT="expression node not found",AT="expression node did not return a value",ST="division by zero",hT="math error",Le=[[{name:"!",left:!1,right:!0,evaluate:({values:[e]})=>e?0:1}],[{name:"^",left:!0,right:!0,evaluate:({values:[e,a],location:n})=>{const s=Math.pow(e,a);if(!Number.isFinite(s))throw P.LocationError(P.ERR_MATH,n);return s}}],[{name:"*",left:!0,right:!0,evaluate:({values:[e,a]})=>e*a},{name:"/",left:!0,right:!0,evaluate:({values:[e,a],location:n})=>{if(a===0)throw P.LocationError(P.ERR_DIVISION_BY_ZERO,n);return e/a}},{name:"%",left:!0,right:!0,evaluate:({values:[e,a],location:n})=>{if(a===0)throw P.LocationError(P.ERR_DIVISION_BY_ZERO,n);return e%a}}],[{name:"+",left:!0,addLeft:!0,right:!0,addRight:!0,evaluate:({values:[e,a]})=>e+a},{name:"-",left:!0,addLeft:!0,right:!0,addRight:!0,evaluate:({values:[e,a]})=>e-a}],[{name:"<=",left:!0,right:!0,evaluate:({values:[e,a]})=>e<=a?1:0},{name:">=",left:!0,right:!0,evaluate:({values:[e,a]})=>e>=a?1:0},{name:"<",left:!0,right:!0,evaluate:({values:[e,a]})=>e<a?1:0},{name:">",left:!0,right:!0,evaluate:({values:[e,a]})=>e>a?1:0},{name:"=",left:!0,right:!0,evaluate:({values:[e,a]})=>e===a?1:0}],[{name:"&&",left:!0,right:!0,evaluate:({values:[e,a]})=>e&&a?1:0},{name:"||",left:!0,right:!0,evaluate:({values:[e,a]})=>e||a?1:0}]],mT=(()=>{const e=new Map;for(const a of Le)for(const n of a)e.set(n.name,n);return e})();function fT(e){const a=e.map(n=>n.name.replace(/(.)/g,"\\$1")).join("|");return new RegExp(`(?:${a})`,"ig")}var LT=fT(Le.flat()),pT=[[2,/[0-9]+(?:\.[0-9]+)?e(?:\+|-)?[0-9]+(?:\.[0-9]+)?/ig],[0,/[a-z$_](?:[a-z0-9$_]*(?:\.[a-z0-9$_]+)?)*/ig],[1,/[0-9]+(?:\.[0-9]+)?/ig],[5,/\(/ig],[6,/\)/ig],[4,/,/ig],[3,LT]],St=class{constructor(e){this.ranges=[],this.input=e,this.parse()}getLocation(e){let a=1;for(;a<this.ranges.length&&e>this.ranges[a-1][1];)a++;const n=e-this.ranges[a-1][0]+1;return[a,n]}getIndex([e,a]){if(e<1)throw new RangeError(`Line number must be greater than 0, got ${e}`);if(a<1)throw new RangeError(`Column number must be greater than 0, got ${a}`);if(e>this.ranges.length)throw new RangeError(`Line number must be equal or less than ${this.ranges.length}, got ${e}`);e--,a--;const n=this.ranges[e][0]+a;if(n>this.ranges[e][1])throw new RangeError(`Column number must be less than ${this.ranges[e][1]}, got ${a}`);return n}getLineRange(e){if(e<1)throw new RangeError(`Line number must be greater than 0, got ${e}`);if(e>this.ranges.length)throw new RangeError(`Line number must be less than ${this.ranges.length}, got ${e}`);return this.ranges[e-1]}getLineLength(e){const a=this.getLineRange(e);return a[1]-a[0]}get lines(){return this.ranges.length}update(e){this.input=e,this.parse()}parse(){this.ranges=[];const e=this.input.split(/(\r?\n)/);let a=0;for(let n=0;n<e.length;n++){if(n%2===1||a>=this.input.length)continue;let s=a+e[n].length-1;n<e.length-1&&(s+=e[n+1].length),this.ranges.push([a,s]),a=s+1}}static matchAll(e,a){const n=[],s=new St(e);for(const r of e.matchAll(a)){const i=r.index;if(typeof i!="number")continue;const c=i+r[0].length-1,_=s.getLocation(i),u=s.getLocation(c);n.push({match:r,location:{start:_,end:u}})}return n}static sortByLocation(e,a){return e.sort((n,s)=>{const r=a(n),i=a(s);return r[0]<i[0]?-1:r[0]>i[0]?1:r[1]<i[1]?-1:r[1]>i[1]?1:0})}};function NT([e,a],n){return[St.matchAll(n,a).map(({match:i,location:c})=>{const _={type:e,location:c,value:i[0]};return typeof i.index=="number"&&(n=n.slice(0,i.index)+" ".repeat(i[0].length)+n.slice(i.index+i[0].length)),_}),n]}function dT(e){const a=[];for(const n of pT){const[s,r]=NT(n,e);e=r;for(const i of s)a.push(i)}return St.sortByLocation(a,n=>n.location.start),a}var CT=class{constructor(e){if(this.functions=e.functions||{},this.variables=e.variables||{},this.ignoreCase=e.ignoreCase||!1,this.ignoreCase){const a={};for(const s in this.functions)a[s.toLowerCase()]=this.functions[s];this.functions=a;const n={};for(const s in this.variables)n[s.toLowerCase()]=this.variables[s];this.variables=n}}getFn(e){return this.ignoreCase&&(e=e.toLowerCase()),this.functions[e]}getVar(e){return this.ignoreCase&&(e=e.toLowerCase()),this.variables[e]}setVar(e,a){this.ignoreCase&&(e=e.toLowerCase()),this.variables[e]=a}},va=(e=>(e[e.SINGLE=0]="SINGLE",e[e.NUMBER=1]="NUMBER",e[e.FUNCTION=2]="FUNCTION",e[e.GROUP=3]="GROUP",e))(va||{});function MT(e){ya(e.children),Ha(e.children),Pa(e.children)}function ya(e){for(const a of e)if(a.type===3&&a.children.length===1){const n=a.children[0];a.type=n.type,a.token=n.token,a.children=n.children}}function Pa(e){if(e.length===0)return;if(pe(e[0]))throw P.LocationError(P.ERR_LIST_UNEXPECTED_COMMA,e[0].token.location.start);let a=!1;for(let n=1;n<e.length;n++){const s=pe(e[n]);if(a===s)throw P.LocationError(P.ERR_LIST_EXPECTED_COMMA,e[n].token.location.start);a=s}for(let n=0;n<e.length;n++)pe(e[n])&&(e.splice(n,1),n--)}function pe(e){return e.type===0&&e.token.type===4}function Ha(e){for(const a of Le)gT(a,e)}function gT(e,a){for(let n=0;n<a.length;n++){const s=a[n];if(s.type===0&&s.token.type===3)for(const r of e){if(r.name!==s.token.value)continue;let i=n-1,c=n+1,_=a[i],u=a[c];if(r.left&&!wa(_))if(r.addLeft)_=Ba(s.token.location),i=n;else throw P.LocationError(P.ERR_OPERATOR_UNEXPECTED_LEFT(r.name),s.token.location.start);if(r.right&&!wa(u))if(r.addRight)u=Ba(s.token.location),c=n;else throw P.LocationError(P.ERR_OPERATOR_UNEXPECTED_RIGHT(r.name),s.token.location.start);const A={type:2,token:s.token,children:[_,u].filter(S=>!!S)};a.splice(i,c-i+1,A),n=i}}}function wa(e){return!!e&&(e.type===2||e.type===1||e.type===0&&e.token.type===0)}function Ba(e){return{type:1,children:[],evaluate(){return 0},token:{type:1,value:"0",location:e}}}function GT(e){const a=[];for(let n=0;n<e.length;n++){const s=e[n];if(s.token.value==="(")a.push(n);else if(s.token.value===")"){if(a.length===0)throw P.LocationError(P.ERR_PARENTHESES_CLOSE,s.token.location.start);const r=a.pop();let i=r;const c=e[r],_=e.slice(r+1,n),u={type:3,token:c.token,children:_};r>0&&e[r-1].type===0&&e[r-1].token.type===0&&(u.type=2,u.token=e[r-1].token,i=r-1),MT(u),e.splice(i,n-i+1,u),n=i}}if(a.length>0)throw P.LocationError(P.ERR_PARENTHESES_OPEN,e[a[0]].token.location.start);return e}function RT(e){const a=[];for(const n of e){const s=n.type===1||n.type===2,r={type:s?1:0,token:n,children:[]};if(s){const i=parseFloat(n.value);if(!Number.isFinite(i))throw P.LocationError(P.ERR_TOKEN_NUMBER_PARSE(n.value),n.location.start);r.evaluate=()=>i}a.push(r)}return a}function IT(e,a){if(!e.arguments)return;let n=0,s=0;for(let r=0;r<e.arguments.length;r++)if(e.arguments[r]==="..."){if(r!==e.arguments.length-1)throw new Error(Da(e.name));s=1/0}else n++,s++;if(a<n||a>s)throw new Error(Oa(e.name,`${n}:${s}`,a))}function ba(e,a){for(const n of e.children)ba(n,a);if(e.type===2){if(e.evaluate)return;let n;if(e.token.type===3)n=mT.get(e.token.value);else{if(!a)throw P.LocationError(P.ERR_FUNCTION_CONTEXT,e.token.location.start);n=a.getFn(e.token.value)}if(!n)throw P.LocationError(P.ERR_FUNCTION_UNKNOWN(e.token.value),e.token.location.start);const s=e.children.map(_=>_.evaluate),r=n.arguments;if(typeof r=="number"&&s.length!==r)throw P.LocationError(P.ERR_FUNCTION_ARGUMENT_COUNT(e.token.value,r,s.length),e.token.location.start);try{IT(n,s.length)}catch(_){throw _ instanceof Error?P.LocationError(_.message,e.token.location.start):_}const i=e.token.location.start,c=e.children;e.evaluate=()=>{const _=e.children.map((u,A)=>{var S;const h=(S=n.arguments)==null?void 0:S[A];if(h&&typeof h!="string"&&h.expression)return 0;if(!u.evaluate)throw P.LocationError(P.ERR_FUNCTION_ARGUMENT,u.token.location.start);return u.evaluate()});return n.evaluate({values:_,expressions:c,location:i})}}else e.type===0&&e.token.type===0&&(e.evaluate=()=>{if(!a)throw P.LocationError(P.ERR_VARIABLE_CONTEXT,e.token.location.start);const n=a.getVar(e.token.value);if(n===void 0)throw P.LocationError(P.ERR_VARIABLE_UNKNOWN(e.token.value),e.token.location.start);return n})}function Ka(e){let a="";return e.forEach((n,s)=>a+=Ya(n,0,s)+`
`),a}function Ya(e,a,n){const s=e.token.location,r=`[${n}]`,i=" ".repeat(r.length);let c=`${r} Node ${va[e.type]} `;c+=`(${Fa(s.start)} - ${Fa(s.end)}):
`,c+=`${i} Token: ${e.token.value}
`,e.evaluate?c+=`${i} Evaluated value: ${e.evaluate()}
`:c+=`${i} No evaluated value
`,c+=`${i} Children: ${e.children.length}
`,e.children.forEach((u,A)=>c+=Ya(u,a+1,A)+`
`);let _=c.split(`
`);return _=_.map(u=>"  ".repeat(a)+u),c=_.join(`
`),c}function Fa(e){return`${e[0]}:${e[1]}`}var ka=class{constructor(e,a){this.nodes=e,this.context=a}get length(){return this.nodes.length}node(e){return this.nodes[e]}location(e){return this.nodes[e].token.location.start}evaluateAll(){const e=[];for(let a=0;a<this.length;a++)e.push(this.evaluate(a));return e}evaluate(e){var a;const n=this.nodes[e];if(!n)throw new Error(P.ERR_EXPR_NODE_NOT_FOUND);const s=(a=n.evaluate)==null?void 0:a.call(n);if(s===void 0)throw new Error(P.ERR_EXPR_NODE_NO_VALUE);return s}toString(e){if(typeof e=="number"){const a=this.nodes[e];if(a===void 0)throw new Error(P.ERR_EXPR_NODE_NOT_FOUND);return Ka([a])}return Ka(this.nodes)}},OT={variables:{PI:Math.PI,E:Math.E},functions:{abs:{name:"abs",description:"Calculate the absolute value of a number.",arguments:[{name:"value",description:"The value to get the absolute value of"}],evaluate({values:[e]}){return Math.abs(e)}},sqrt:{name:"sqrt",description:"Calculate the square root of a number.",arguments:[{name:"value",description:"The value to calculate the square root of"}],evaluate({values:[e]}){return Math.sqrt(e)}},pow:{name:"pow",description:"Calculate the power of a number raised to an exponent.",arguments:[{name:"base",description:"The base value"},{name:"exponent",description:"The exponent value"}],evaluate({values:[e,a]}){return Math.pow(e,a)}},floor:{name:"floor",description:"Round a number down to the nearest integer.",arguments:[{name:"value",description:"The value to round down"}],evaluate({values:[e]}){return Math.floor(e)}},ceil:{name:"ceil",description:"Round a number up to the nearest integer.",arguments:[{name:"value",description:"The value to round up"}],evaluate({values:[e]}){return Math.ceil(e)}},sin:{name:"sin",description:"Calculate the sine of an angle in radians.",arguments:[{name:"angle",description:"The angle in radians"}],evaluate({values:[e]}){return Math.sin(e)}},cos:{name:"cos",description:"Calculate the cosine of an angle in radians.",arguments:[{name:"angle",description:"The angle in radians"}],evaluate({values:[e]}){return Math.cos(e)}},tan:{name:"tan",description:"Calculate the tangent of an angle in radians.",arguments:[{name:"angle",description:"The angle in radians"}],evaluate({values:[e]}){return Math.tan(e)}},log:{name:"log",description:"Calculate the logarithm of a number with a specified base.",arguments:[{name:"value",description:"The value to take the logarithm of"},{name:"base",description:"The base of the logarithm (optional, default: e)"}],evaluate({values:[e,a=Math.E]}){return Math.log(e)/Math.log(a)}},min:{name:"min",description:"Find the minimum value from a list of numbers.",arguments:["..."],evaluate({values:e}){return Math.min(...e)}},max:{name:"max",description:"Find the maximum value from a list of numbers.",arguments:["..."],evaluate({values:e}){return Math.max(...e)}},clamp:{name:"clamp",description:"Clamp a number within a specified range.",arguments:[{name:"value",description:"The value to clamp"},{name:"minValue",description:"The minimum value"},{name:"maxValue",description:"The maximum value"}],evaluate({values:[e,a,n]}){return Math.min(Math.max(e,a),n)}},exp:{name:"exp",description:"Calculate the exponential value of a number.",arguments:[{name:"value",description:"The exponent value"}],evaluate({values:[e]}){return Math.exp(e)}}}},DT={functions:{now:{name:"now",description:"Get the current timestamp.",arguments:[],evaluate(){return Date.now()}},year:{name:"year",description:"Get the year from a given timestamp.",arguments:[{name:"timestamp",description:"The timestamp"}],evaluate({values:[e]}){return new Date(e).getFullYear()}},month:{name:"month",description:"Get the month (0-11) from a given timestamp.",arguments:[{name:"timestamp",description:"The timestamp"}],evaluate({values:[e]}){return new Date(e).getMonth()}},day:{name:"day",description:"Get the day of the week (0-6) from a given timestamp.",arguments:[{name:"timestamp",description:"The timestamp"}],evaluate({values:[e]}){return new Date(e).getDay()}},years:{name:"years",description:"Add a specified number of years to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numYears",description:"The number of years to add"}],evaluate({values:[e,a]}){const n=new Date(e);return n.setFullYear(n.getFullYear()+a),n.getTime()}},months:{name:"months",description:"Add a specified number of months to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numMonths",description:"The number of months to add"}],evaluate({values:[e,a]}){const n=new Date(e);return n.setMonth(n.getMonth()+a),n.getTime()}},days:{name:"days",description:"Add a specified number of days to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numDays",description:"The number of days to add"}],evaluate({values:[e,a]}){const n=new Date(e);return n.setDate(n.getDate()+a),n.getTime()}},hours:{name:"hours",description:"Add hours to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numHours",description:"The number of hours to add"}],evaluate({values:[e,a]}){const n=new Date(e);return n.setTime(n.getTime()+a*60*60*1e3),n.getTime()}},minutes:{name:"minutes",description:"Add minutes to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numMinutes",description:"The number of minutes to add"}],evaluate({values:[e,a]}){const n=new Date(e);return n.setTime(n.getTime()+a*60*1e3),n.getTime()}},seconds:{name:"seconds",description:"Add seconds to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numSeconds",description:"The number of seconds to add"}],evaluate({values:[e,a]}){const n=new Date(e);return n.setTime(n.getTime()+a*1e3),n.getTime()}},milliseconds:{name:"milliseconds",description:"Add milliseconds to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numMilliseconds",description:"The number of milliseconds to add"}],evaluate({values:[e,a]}){const n=new Date(e);return n.setTime(n.getTime()+a),n.getTime()}},date:{name:"date",description:"Create a timestamp from date values",arguments:[{name:"year",description:"The year"},{name:"month",description:"The month (0-11)"},{name:"day",description:"The day of the month"}],evaluate({values:[e,a,n]}){return new Date(e,a,n).getTime()}},datetime:{name:"datetime",description:"Create a timestamp from date and time values",arguments:[{name:"year",description:"The year"},{name:"month",description:"The month (0-11)"},{name:"day",description:"The day of the month"},{name:"hour",description:"The hour"},{name:"minute",description:"The minute"},{name:"second",description:"The second"}],evaluate({values:[e,a,n,s,r,i]}){return new Date(e,a,n,s,r,i).getTime()}}}},vT={variables:{true:1,false:0},functions:{if:{name:"if",description:"Conditional statement. Returns 'valueIfTrue' if 'condition' is true, otherwise returns 'valueIfFalse'.",arguments:[{name:"condition",description:"The condition to evaluate"},{name:"valueIfTrue",description:"The value to return if 'condition' is true",expression:!0},{name:"valueIfFalse",description:"The value to return if 'condition' is false",expression:!0}],evaluate({values:[e],expressions:[,a,n]}){var s,r;return e>0?((s=a.evaluate)==null?void 0:s.call(a))||0:((r=n==null?void 0:n.evaluate)==null?void 0:r.call(n))||0}},and:{name:"and",description:"Logical AND operation between multiple values",arguments:["..."],evaluate({values:e}){return e.every(a=>a>0)?1:0}},or:{name:"or",description:"Logical OR operation between multiple values",arguments:["..."],evaluate({values:e}){return e.some(a=>a>0)?1:0}},xor:{name:"xor",description:"Logical XOR operation between multiple values",arguments:["..."],evaluate({values:e}){return e.filter(a=>a>0).length%2?1:0}},not:{name:"not",description:"Logical NOT operation. Returns 1 if 'value' is false, otherwise returns 0.",arguments:[{name:"value",description:"The value to negate"}],evaluate({values:[e]}){return e>0?0:1}},switch:{name:"switch",description:"Switch statement. Returns the value of the first 'case' whose 'condition' is true, otherwise returns 'default'. The syntax is `switch(value, case1, result1, case2, result2, ..., [default])`. Note that if there are an even number of arguments, the last argument is used as the default value. If no default provided, defaults to 0.",arguments:[{name:"value",description:"The value to compare against the 'case' values"},"..."],evaluate({values:[e,...a]}){const n=a.length%2===1?a.pop():0;for(let s=0;s<a.length;s+=2)if(e===a[s])return a[s+1];return n}}}},yT={math:OT,date:DT,logic:vT};function PT(...e){return HT(e.map(a=>typeof a=="string"?yT[a]:a))}function Gd(e){return e}function HT(e){const a={functions:{},variables:{}};return e.reduce((n,s)=>({functions:jt(jt({},n.functions),s.functions),variables:jt(jt({},n.variables),s.variables)}),a)}var Mt=class{constructor(e){this.context=new CT(e||{})}setVar(e,a){this.context.setVar(e,a)}getVar(e){return this.context.getVar(e)}parse(e){const a=dT(e),n=GT(RT(a));ya(n),Ha(n),Pa(n);for(const s of n)ba(s,this.context);return new ka(n,this.context)}};Mt.Contexts=PT;var wT=Object.defineProperty,BT=Object.defineProperties,bT=Object.getOwnPropertyDescriptors,Va=Object.getOwnPropertySymbols,KT=Object.prototype.hasOwnProperty,YT=Object.prototype.propertyIsEnumerable,xa=(e,a,n)=>a in e?wT(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,FT=(e,a)=>{for(var n in a||(a={}))KT.call(a,n)&&xa(e,n,a[n]);if(Va)for(var n of Va(a))YT.call(a,n)&&xa(e,n,a[n]);return e},kT=(e,a)=>BT(e,bT(a));function zt(e){const a=/"[^"]+"|[^\s]+/g,n=e.matchAll(a);return Array.from(n).map(s=>{const r=s[0];return r.startsWith('"')&&r.endsWith('"')?r.slice(1,-1):r})}var VT=class{constructor(e,a){this.template=e,this.docs=a,this.positional=[],this.named=[],this.anyNamed=!1,this.min=0,this.max=0,this.parseTemplate()}reset(){this.positional=[],this.named=[],this.min=0,this.max=0}parseTemplate(){var e;const a=zt(this.template.trim()),n=/^\[([^\]]*)\]$/;let s;for(let r of a){const i=r.match(n),c=!!i;c&&(r=i[1]);const _=r.split("="),u=_.length===1,A=_.shift(),S=_.join("=");if(!A)throw new Error(`Invalid argument name: ${r}`);if(A.endsWith("...")){if(!u)throw new Error(`Named arguments cannot have suffix '...': ${A}`);this.max=1/0}!u&&c&&A.endsWith("*")&&(this.anyNamed=!0);let h=A;u||(h+="="+S),c&&(h="["+h+"]");const m={label:h,name:A,positional:u,optional:c,description:(e=this.docs)==null?void 0:e[A]};if(m.positional){if(s){if(s.optional&&!m.optional)throw new Error(`Optional arguments must be at the end of the positional list: ${s.name}`);if(s.name.endsWith("..."))throw new Error(`'...' argument must be at the end of the list: ${s.name}`)}s=m,this.positional.push(m),!m.optional&&!m.name.endsWith("...")&&this.min++,this.max++}else this.named.push(m)}}toString(){let e="";for(const a of this.positional)e+=a.label+" ";for(const a of this.named)e+=a.label+" ";return e.trim()}setTemplate(e){this.reset(),this.template=e,this.parseTemplate()}setDocs(e){this.docs=e;for(const a of this.positional)a.description=e[a.name];for(const a of this.named)a.description=e[a.name]}parse(e){const a=this._parse(zt(e.trim()));return this._validate(a),a}parseList(e){const a=this._parse(e);return this._validate(a),a}_parse(e){const a=[],n={},s={};for(let r=0;r<e.length;r++){const i=e[r];if(i.includes("=")){const[c,_]=i.split("=");n[c]=_,s[c]=r}else a.push(i),s[r]=r}return{values:a,named:n,index:s,parts:e}}_validate(e){if(e.values.length<this.min)throw new Error(`Expected at least ${this.min} positional arguments, got ${e.values.length}`);if(e.values.length>this.max)throw new Error(`Expected at most ${this.max} positional arguments, got ${e.values.length}`);if(this.anyNamed)return;const a=this.named.map(s=>s.name),n=Object.keys(e.named);for(const s of n)if(!a.includes(s))throw new Error(`Unexpected named argument: ${s}`);for(const s of a)if(!this.named.find(i=>i.name===s).optional&&!n.includes(s))throw new Error(`Expected named argument: ${s}`)}get argMin(){return this.min}get argMax(){return this.max}get namedArgs(){return this.named}},Ua=class{constructor(){this._log=[],this._line=1,this.save=!0,this.out=console.log}addLog(e){this.save&&this._log.push(e),this.out(`[${e.type} at line ${e.line}] ${e.message}`)}setLine(e){typeof e=="number"?this._line=e:this._line=e[0]}get line(){return this._line}log(e){this.addLog({type:"log",message:e,line:this._line})}logf(e,...a){this.log(Wt.sprintf(e,...a))}warn(e){this.addLog({type:"warn",message:e,line:this._line})}warnf(e,...a){this.warn(Wt.sprintf(e,...a))}error(e){this.addLog({type:"error",message:e,line:this._line})}errorf(e,...a){this.error(Wt.sprintf(e,...a))}clear(){this._log=[]}toString(){return this._log.map(e=>`[${e.type} at line ${e.line}] ${e.message}`).join(`
`)}},k=Ua;k.Global=new Ua;function Wa(e){if(typeof e=="number")return e;const a=e.endsWith("%");a&&(e=e.slice(0,e.length-1));let n=parseFloat(e);if(!Number.isFinite(n))throw new Error(`Invalid number format: "${e}"`);return a&&(n/=100),n}var xT=class{constructor(e,a){this.list=e,this.expressions=a}number(e){const a=this.list.index[e],n=this.expressions[a];return n?n.evaluate(n.length-1):Wa(typeof e=="number"?this.list.parts[a]:this.list.named[e])}expression(e){const a=this.list.index[e];return this.expressions[a]}},qt=class{constructor(e,a){this.context=e,this.commands=a,this.logger=k.Global}findCommand(e){var a;if(!this.commands[e[0]])return[void 0,e,[]];let n=this.commands[e[0]],s=1;for(;n&&s<e.length&&((a=n.children)!=null&&a[e[s]]);)n=n.children[e[s]],s++;return[n,e.slice(s),e.slice(0,s)]}compile(e,a=[]){const n=e.join(" "),[s,r,i]=this.findCommand(e),c=[...a];if(c.splice(0,i.length),!s)throw new Error(`command not found: ${e.join(" ")}`);const _=s.compile;if(!_)throw new Error(`command not implemented: ${e.join(" ")}`);const A=new VT(s.arguments||"",s.docs).parseList(r),S=new xT(A,c),h=kT(FT({},A),{expressions:c,get:S});return Object.assign(_(h,this),{String:()=>n})}},UT=class{constructor(e){this.program=e}markdown(e){return typeof e=="string"&&(e=zt(e),(e.length===0||e.length===1&&e[0]==="")&&(e=void 0)),this.doc(e,!0)}text(e){return typeof e=="string"&&(e=zt(e),e.length===1&&e[0]===""&&(e=void 0)),this.doc(e,!1)}allCommands(){const e=[];function a(n,s=[]){if(n.children)for(const r in n.children)a(n.children[r],[...s,r]);else e.push(s.join(" "))}for(const n in this.program.commands)a(this.program.commands[n],[n]);return e}doc(e,a=!1){if(!e){let n="";for(const s in this.program.commands)n+=this.command([s],a)+`

`;return n}return this.command(e,a)}command(e,a=!0){const[n,,s]=this.program.findCommand(e),r=s.join(" ");if(!n)return`Command not found: \`${e.join(" ")}\``;let i="";a&&(i+="## "),i+="command `"+r+`\`

`,i+=n.description||"",i+=`

`,a&&(i+="### "),i+=`Syntax:

`,a&&(i+="```\n"),i+=r+" "+(n.arguments||"").trim()+`
`,a&&(i+="```\n"),i+=`
`,a&&(i+="### "),i+=`Arguments:

`;let c=0;for(const _ in n.docs)i+="- `"+_+"`: "+n.docs[_]+`
`,c++;if(c===0&&(i+=`No arguments
`),n.example){a&&(i+="### "),i+=`Examples:

`;const _=typeof n.example=="string"?[n.example]:n.example;for(const u of _)a&&(i+="```\n"),i+=u+`
`,a&&(i+="```\n")}if(n.children){a&&(i+="### "),i+=`Subcommands:

`;for(const _ in n.children)i+="- `"+r+" "+_+"`\n";i+=`
`}return i}},ja=/\$([a-z_][a-z0-9_]*)/ig,WT=/(?:\/\/|#).*$/gm,jT=/\/\*[\s\S]*?\*\//gm,zT=/\{([^}]*)\}/ig,qT=/"([^"]*)"/ig,$T=/(([a-z_][a-z0-9_]*)="[^"]*")/ig,QT=/([^\s]+)/ig;function Ne(e){return e=e.replace(WT,""),e=e.replace(jT,a=>a.replace(/[^\n]/g," ")),e}function XT(e,a,n){if(!a)throw new Error(`expected constant name after "const" at ${e.start}`);if(!a.value.match(ja))throw new Error(`constant name must be a valid identifier at ${a.start}`);if(a.value==="const")throw new Error(`constant name cannot be "const" at ${a.start}`);if(a.type!=="part")throw new Error(`constant name cannot be an expression at ${a.start}`);if(!n)throw new Error(`expected constant value after constant name at ${a.end}`);if(a.start[0]!==e.start[0])throw new Error(`constant name must be on the same line as "const" at ${a.start}`);if(n.start[0]!==a.start[0])throw new Error(`constant value must be on the same line as constant name at ${n.start}`)}var za=class{constructor(){this.input="",this.table=new St(""),this._tokens=[]}parse(e){return this.input=Ne(e.toLowerCase()),this.table=new St(this.input),this._tokens=[],this.validateBrackets(),this.scan(zT,"expression"),this.scan($T,"part"),this.scan(qT,"part"),this.scan(QT,"part"),St.sortByLocation(this._tokens,a=>a.start),this._parse()}get tokens(){return this._tokens}validateBrackets(){let e=!1;for(let a=0;a<this.input.length;a++){const n=this.input[a],s=this.table.getLocation(a);if(n==="{"){if(e)throw new Error(`cannot open block at ${s} because another block is already open`);e=!0}else if(n==="}"){if(!e)throw new Error(`cannot close block at ${s} because no block is open`);e=!1}}}scan(e,a){const n=this.input.matchAll(e);for(const s of n){const r=s.index;if(r===void 0)continue;const i=r+s[0].length,c=this.table.getLocation(r),_=this.table.getLocation(i),u=s[1];this.input=this.input.slice(0,r)+" ".repeat(s[0].length)+this.input.slice(i),this._tokens.push({type:a,value:u,start:c,end:_})}}_parse(){const e=[];let a=0,n=0,s=[];function r(i){var c,_,u;if(((c=s[s.length-1])==null?void 0:c.value)==="\\")s.pop();else if(s.length>0){const A=[...s],S=((_=A[0])==null?void 0:_.start)||i.start,h=((u=A[A.length-1])==null?void 0:u.end)||i.end;e.push({type:"instruction",values:A,start:S,end:h}),s=[]}}for(let i=0;i<this._tokens.length;i++){const c=this._tokens[i];if(c.type==="part"&&c.value==="const"){if(c.start[0]===a)throw new Error(`constants must be declared on their own line at ${c.start}`);const _=this._tokens[i+1],u=this._tokens[i+2];XT(c,_,u),e.push({type:"constant",values:[_,u],start:c.start,end:u.end}),i+=2}else c.start[0]!==n&&r(c),s.push(c);a=c.start[0],n=c.end[0]}return this.tokens.length>0&&r(this._tokens[this._tokens.length-1]),St.sortByLocation(e,i=>i.start),e}},qa=class{constructor(e){this.program=e,this.exprParser=new Mt(Mt.Contexts("math","logic")),this.langParser=new za,this.constants=new Map,this.catch=!0}setProgram(e){this.program=e}compileString(e,a={}){try{const n=this.preprocess(e);return this.compile(n,a)}catch(n){if(n instanceof Error?this.program.logger.error(n.message):this.program.logger.error(String(n).valueOf()),!this.catch)throw n;return Object.assign(()=>[],{String:()=>"/* error */"})}}compileParts(e,a=1,n=[]){const s=this.program.logger;try{s.setLine(a);const r=this.program.compile(e,n);return()=>{try{return s.setLine(a),r()}catch(c){if(c instanceof Error?(s.error(c.message),c.message=`Error at ${a}: ${c.message}`):s.error(String(c).valueOf()),!this.catch)throw c;return}}}catch(r){if(r instanceof Error?(s.error(r.message),r.message=`Error at ${a}: ${r.message}`):s.error(String(r).valueOf()),!this.catch)throw r}}compile(e,a={}){const n=[],s=Math.max(1,Math.floor(a.line||1));for(const r of e){const i=r.start[0]+s-1,c=this.compileParts(r.values,i,r.expressions);c&&n.push(c)}return Object.assign(()=>n.map(r=>r()),{String:()=>e.map(r=>r.values.join(" ")).join(`
`)})}preprocess(e){const a=this.langParser.parse(e),n=[];for(const s of a)if(s.type==="constant"){const r=s.values[0],i=s.values[1],c=r.value;if(this.constants.has(c))throw new Error(`cannot redefine constant "${c}" at ${r.start}`);if(i.type==="expression"){const _=this.evaluateExpression(i);this.constants.set(c,_.toString())}else this.constants.set(c,i.value)}else{for(const c of s.values)c.type==="expression"&&(c.value.startsWith("@")?(c.value=c.value.slice(1),c.expression=this.parseExpression(c)):c.value=this.evaluateExpression(c).toString());for(let c=1;c<s.values.length;c++){const _=s.values[c-1],u=s.values[c];_.end[0]===u.start[0]&&_.end[1]===u.start[1]&&(_.value+=u.value,_.end=u.end,_.expression=u.expression,s.values.splice(c,1),c--)}const r=s.values.map(c=>this.replaceConstants(c.value)),i=s.values.map(c=>c.expression);n.push({start:s.start,end:s.end,values:r,expressions:i})}return n}replaceConstants(e,a=!1){return e.replace(ja,(n,s)=>{const r=this.constants.get(n)||this.constants.get(s);if(r===void 0)throw new Error(`constant "${n}" not found`);if(a){let i=parseFloat(r);return r.endsWith("%")&&(i/=100),Number.isFinite(i)?i.toString():n}return r})}evaluateExpression(e){const n=this.parseExpression(e).evaluateAll();return n.length===0?0:n[n.length-1]}parseExpression(e){let a=e.value;return a=this.replaceConstants(a,!0),a=`
`.repeat(e.start[0]-1)+" ".repeat(e.start[1]-1)+a,this.exprParser.parse(a)}},JT=Object.freeze({__proto__:null,Compiler:qa,ExprParser:Mt,Expression:ka,LangParser:za,Logger:k,Program:qt,ProgramDocs:UT,RemoveComments:Ne}),de=function(e,a){return de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(n[r]=s[r])},de(e,a)};function $a(e,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");de(e,a);function n(){this.constructor=e}e.prototype=a===null?Object.create(a):(n.prototype=a.prototype,new n)}function Qa(e,a){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var s=n.call(e),r,i=[],c;try{for(;(a===void 0||a-- >0)&&!(r=s.next()).done;)i.push(r.value)}catch(_){c={error:_}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(c)throw c.error}}return i}function Xa(e,a,n){if(n||arguments.length===2)for(var s=0,r=a.length,i;s<r;s++)(i||!(s in a))&&(i||(i=Array.prototype.slice.call(a,0,s)),i[s]=a[s]);return e.concat(i||Array.prototype.slice.call(a))}var Ja=function(){function e(){this.t=0}return Object.defineProperty(e.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),e.prototype.size=function(){return this.t},e.prototype.empty=function(){return this.t===0},e}();(function(e){$a(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a})(Ja);var Za=function(e){$a(a,e);function a(n,s,r){n===void 0&&(n=[]),s===void 0&&(s=function(A,S){return A>S?-1:A<S?1:0}),r===void 0&&(r=!0);var i=e.call(this)||this;if(i.i=s,Array.isArray(n))i.u=r?Xa([],Qa(n),!1):n;else{i.u=[];var c=i;n.forEach(function(A){c.u.push(A)})}i.t=i.u.length;for(var _=i.t>>1,u=i.t-1>>1;u>=0;--u)i.o(u,_);return i}return a.prototype.h=function(n){for(var s=this.u[n];n>0;){var r=n-1>>1,i=this.u[r];if(this.i(i,s)<=0)break;this.u[n]=i,n=r}this.u[n]=s},a.prototype.o=function(n,s){for(var r=this.u[n];n<s;){var i=n<<1|1,c=i+1,_=this.u[i];if(c<this.t&&this.i(_,this.u[c])>0&&(i=c,_=this.u[c]),this.i(_,r)>=0)break;this.u[n]=_,n=i}this.u[n]=r},a.prototype.clear=function(){this.t=0,this.u.length=0},a.prototype.push=function(n){this.u.push(n),this.h(this.t),this.t+=1},a.prototype.pop=function(){if(this.t!==0){var n=this.u[0],s=this.u.pop();return this.t-=1,this.t&&(this.u[0]=s,this.o(0,this.t>>1)),n}},a.prototype.top=function(){return this.u[0]},a.prototype.find=function(n){return this.u.indexOf(n)>=0},a.prototype.remove=function(n){var s=this.u.indexOf(n);return s<0?!1:(s===0?this.pop():s===this.t-1?(this.u.pop(),this.t-=1):(this.u.splice(s,1,this.u.pop()),this.t-=1,this.h(s),this.o(s,this.t>>1)),!0)},a.prototype.updateItem=function(n){var s=this.u.indexOf(n);return s<0?!1:(this.h(s),this.o(s,this.t>>1),!0)},a.prototype.toArray=function(){return Xa([],Qa(this.u),!1)},a}(Ja),ZT=Object.defineProperty,t_=(e,a)=>{for(var n in a)ZT(e,n,{get:a[n],enumerable:!0})},tn={};t_(tn,{Filter:()=>a_,ReduceSearchItem:()=>$t,Search:()=>e_});function $t(e){const a=[];if(e===void 0)return a;if(Array.isArray(e))for(const n of e){const s=$t(n);for(const r of s)a.push(r)}else a.push(e);return a}function e_(e){const a=$t(e.search),n={values:[],indexes:[],results:[]},s=e.mode||"some";for(let r=0;r<e.values.length;r++){const i=$t(e.map(e.values[r]));a[s](_=>i.some(u=>typeof _!=typeof u?!1:(e.ignoreCase&&(typeof _=="string"&&(_=_.toLowerCase()),typeof u=="string"&&(u=u.toLowerCase())),e.exact||typeof _=="number"?_===u:typeof u=="string"?u.includes(_):!1)))&&(n.values.push(e.values[r]),n.indexes.push(r),n.results.push({value:e.values[r],index:r}))}return n}function a_(e){const a={values:[],indexes:[],results:[]};return e.values.forEach((n,s)=>{e.filters[e.mode||"some"](i=>i.for?i.for(n)?i.filter(n):!0:i.filter(n))&&(a.values.push(n),a.indexes.push(s),a.results.push({value:n,index:s}))}),a}var en={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.stringSimilarity=void 0;var a=function(n,s,r,i){if(r===void 0&&(r=2),i===void 0&&(i=!1),i||(n=n.toLowerCase(),s=s.toLowerCase()),n.length<r||s.length<r)return 0;for(var c=new Map,_=0;_<n.length-(r-1);_++){var u=n.substr(_,r);c.set(u,c.has(u)?c.get(u)+1:1)}for(var A=0,S=0;S<s.length-(r-1);S++){var h=s.substr(S,r),m=c.has(h)?c.get(h):0;m>0&&(c.set(h,m-1),A++)}return A*2/(n.length+s.length-(r-1)*2)};e.stringSimilarity=a,e.default=e.stringSimilarity})(en);var n_=Object.create,Qt=Object.defineProperty,s_=Object.defineProperties,r_=Object.getOwnPropertyDescriptor,i_=Object.getOwnPropertyDescriptors,an=Object.getOwnPropertyNames,nn=Object.getOwnPropertySymbols,l_=Object.getPrototypeOf,sn=Object.prototype.hasOwnProperty,o_=Object.prototype.propertyIsEnumerable,g=Math.pow,rn=(e,a,n)=>a in e?Qt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,b=(e,a)=>{for(var n in a||(a={}))sn.call(a,n)&&rn(e,n,a[n]);if(nn)for(var n of nn(a))o_.call(a,n)&&rn(e,n,a[n]);return e},nt=(e,a)=>s_(e,i_(a)),x=(e,a)=>function(){return a||(0,e[an(e)[0]])((a={exports:{}}).exports,a),a.exports},D=(e,a)=>{for(var n in a)Qt(e,n,{get:a[n],enumerable:!0})},c_=(e,a,n,s)=>{if(a&&typeof a=="object"||typeof a=="function")for(let r of an(a))!sn.call(e,r)&&r!==n&&Qt(e,r,{get:()=>a[r],enumerable:!(s=r_(a,r))||s.enumerable});return e},E_=(e,a,n)=>(n=e!=null?n_(l_(e)):{},c_(a||!e||!e.__esModule?Qt(n,"default",{value:e,enumerable:!0}):n,e)),gt=(e,a,n)=>new Promise((s,r)=>{var i=u=>{try{_(n.next(u))}catch(A){r(A)}},c=u=>{try{_(n.throw(u))}catch(A){r(A)}},_=u=>u.done?s(u.value):Promise.resolve(u.value).then(i,c);_((n=n.apply(e,a)).next())}),ln=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/Solution.js"(e,a){function n(s,r,i,c){this.feasible=i,this.evaluation=r,this.bounded=c,this._tableau=s}a.exports=n,n.prototype.generateSolutionSet=function(){for(var s={},r=this._tableau,i=r.varIndexByRow,c=r.variablesPerIndex,_=r.matrix,u=r.rhsColumn,A=r.height-1,S=Math.round(1/r.precision),h=1;h<=A;h+=1){var m=i[h],f=c[m];if(!(f===void 0||f.isSlack===!0)){var N=_[h][u];s[f.id]=Math.round((Number.EPSILON+N)*S)/S}}return s}}}),T_=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/MilpSolution.js"(e,a){var n=ln();function s(r,i,c,_,u){n.call(this,r,i,c,_),this.iter=u}a.exports=s,s.prototype=Object.create(n.prototype),s.constructor=s}}),ot=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/Tableau.js"(e,a){var n=ln(),s=T_();function r(c){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=c||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}a.exports=r,r.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()};function i(c,_){this.priority=c,this.reducedCosts=new Array(_);for(var u=0;u<_;u+=1)this.reducedCosts[u]=0}i.prototype.copy=function(){var c=new i(this.priority,this.reducedCosts.length);return c.reducedCosts=this.reducedCosts.slice(),c},r.prototype.setOptionalObjective=function(c,_,u){var A=this.objectivesByPriority[c];if(A===void 0){var S=Math.max(this.width,_+1);A=new i(c,S),this.objectivesByPriority[c]=A,this.optionalObjectives.push(A),this.optionalObjectives.sort(function(h,m){return h.priority-m.priority})}A.reducedCosts[_]=u},r.prototype.initialize=function(c,_,u,A){this.variables=u,this.unrestrictedVars=A,this.width=c,this.height=_;for(var S=new Array(c),h=0;h<c;h++)S[h]=0;this.matrix=new Array(_);for(var m=0;m<_;m++)this.matrix[m]=S.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=c+_-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},r.prototype._resetMatrix=function(){var c=this.model.variables,_=this.model.constraints,u=c.length,A=_.length,S,h,m=this.matrix[0],f=this.model.isMinimization===!0?-1:1;for(S=0;S<u;S+=1){var N=c[S],L=N.priority,C=f*N.cost;L===0?m[S+1]=C:this.setOptionalObjective(L,S+1,C),h=c[S].index,this.rowByVarIndex[h]=-1,this.colByVarIndex[h]=S+1,this.varIndexByCol[S+1]=h}for(var d=1,M=0;M<A;M+=1){var R=_[M],O=R.index;this.rowByVarIndex[O]=d,this.colByVarIndex[O]=-1,this.varIndexByRow[d]=O;var y,H,w,z=R.terms,X=z.length,at=this.matrix[d++];if(R.isUpperBound){for(y=0;y<X;y+=1)H=z[y],w=this.colByVarIndex[H.variable.index],at[w]=H.coefficient;at[0]=R.rhs}else{for(y=0;y<X;y+=1)H=z[y],w=this.colByVarIndex[H.variable.index],at[w]=-H.coefficient;at[0]=-R.rhs}}},r.prototype.setModel=function(c){this.model=c;var _=c.nVariables+1,u=c.nConstraints+1;return this.initialize(_,u,c.variables,c.unrestrictedVariables),this._resetMatrix(),this},r.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var c=this.lastElementIndex;return this.lastElementIndex+=1,c},r.prototype.density=function(){for(var c=0,_=this.matrix,u=0;u<this.height;u++)for(var A=_[u],S=0;S<this.width;S++)A[S]!==0&&(c+=1);return c/(this.height*this.width)},r.prototype.setEvaluation=function(){var c=Math.round(1/this.precision),_=this.matrix[this.costRowIndex][this.rhsColumn],u=Math.round((Number.EPSILON+_)*c)/c;this.evaluation=u,this.simplexIters===0&&(this.bestPossibleEval=u)},r.prototype.getSolution=function(){var c=this.model.isMinimization===!0?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new s(this,c,this.feasible,this.bounded,this.branchAndCutIterations):new n(this,c,this.feasible,this.bounded)}}}),__=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/simplex.js"(){var e=ot();e.prototype.simplex=function(){return this.bounded=!0,this.phase1(),this.feasible===!0&&this.phase2(),this},e.prototype.phase1=function(){for(var n=this.model.checkForCycles,s=[],r=this.matrix,i=this.rhsColumn,c=this.width-1,_=this.height-1,u,A=0;;){for(var S=0,h=-this.precision,m=1;m<=_;m++){u=this.unrestrictedVars[this.varIndexByRow[m]]===!0;var f=r[m][i];f<h&&(h=f,S=m)}if(S===0)return this.feasible=!0,A;for(var N=0,L=-1/0,C=r[0],d=r[S],M=1;M<=c;M++){var R=d[M];if(u=this.unrestrictedVars[this.varIndexByCol[M]]===!0,u||R<-this.precision){var O=-C[M]/R;L<O&&(L=O,N=M)}}if(N===0)return this.feasible=!1,A;if(n){s.push([this.varIndexByRow[S],this.varIndexByCol[N]]);var y=this.checkForCycles(s);if(y.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+y[0]),this.model.messages.push("Length :"+y[1]),this.feasible=!1,A}this.pivot(S,N),A+=1}},e.prototype.phase2=function(){for(var n=this.model.checkForCycles,s=[],r=this.matrix,i=this.rhsColumn,c=this.width-1,_=this.height-1,u=this.precision,A=this.optionalObjectives.length,S=null,h=0,m,f;;){var N=r[this.costRowIndex];A>0&&(S=[]);for(var L=0,C=u,d=!1,M=1;M<=c;M++){if(m=N[M],f=this.unrestrictedVars[this.varIndexByCol[M]]===!0,A>0&&-u<m&&m<u){S.push(M);continue}if(f&&m<0){-m>C&&(C=-m,L=M,d=!0);continue}m>C&&(C=m,L=M,d=!1)}if(A>0)for(var R=0;L===0&&S.length>0&&R<A;){var O=[],y=this.optionalObjectives[R].reducedCosts;C=u;for(var H=0;H<S.length;H++){if(M=S[H],m=y[M],f=this.unrestrictedVars[this.varIndexByCol[M]]===!0,-u<m&&m<u){O.push(M);continue}if(f&&m<0){-m>C&&(C=-m,L=M,d=!0);continue}m>C&&(C=m,L=M,d=!1)}S=O,R+=1}if(L===0)return this.setEvaluation(),this.simplexIters+=1,h;var w=0,z=1/0;this.varIndexByRow;for(var X=1;X<=_;X++){var at=r[X],Et=at[i],Z=at[L];if(!(-u<Z&&Z<u)){if(Z>0&&u>Et&&Et>-u){z=0,w=X;break}var dt=d?-Et/Z:Et/Z;dt>u&&z>dt&&(z=dt,w=X)}}if(z===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[L],h;if(n){s.push([this.varIndexByRow[w],this.varIndexByCol[L]]);var Ct=this.checkForCycles(s);if(Ct.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+Ct[0]),this.model.messages.push("Length :"+Ct[1]),this.feasible=!1,h}this.pivot(w,L,!0),h+=1}};var a=[];e.prototype.pivot=function(n,s){var r=this.matrix,i=r[n][s],c=this.height-1,_=this.width-1,u=this.varIndexByRow[n],A=this.varIndexByCol[s];this.varIndexByRow[n]=A,this.varIndexByCol[s]=u,this.rowByVarIndex[A]=n,this.rowByVarIndex[u]=-1,this.colByVarIndex[A]=-1,this.colByVarIndex[u]=s;for(var S=r[n],h=0,m=0;m<=_;m++)S[m]>=-1e-16&&S[m]<=1e-16?S[m]=0:(S[m]/=i,a[h]=m,h+=1);S[s]=1/i;var f,N,L;this.precision;for(var C=0;C<=c;C++)if(C!==n&&!(r[C][s]>=-1e-16&&r[C][s]<=1e-16)){var d=r[C];if(f=d[s],f>=-1e-16&&f<=1e-16)f!==0&&(d[s]=0);else{for(N=0;N<h;N++)m=a[N],L=S[m],L>=-1e-16&&L<=1e-16?L!==0&&(S[m]=0):d[m]=d[m]-f*L;d[s]=-f/i}}var M=this.optionalObjectives.length;if(M>0)for(var R=0;R<M;R+=1){var O=this.optionalObjectives[R].reducedCosts;if(f=O[s],f!==0){for(N=0;N<h;N++)m=a[N],L=S[m],L!==0&&(O[m]=O[m]-f*L);O[s]=-f/i}}},e.prototype.checkForCycles=function(n){for(var s=0;s<n.length-1;s++)for(var r=s+1;r<n.length;r++){var i=n[s],c=n[r];if(i[0]===c[0]&&i[1]===c[1]){if(r-s>n.length-r)break;for(var _=!0,u=1;u<r-s;u++){var A=n[s+u],S=n[r+u];if(A[0]!==S[0]||A[1]!==S[1]){_=!1;break}}if(_)return[s,r-s]}}return[]}}}),Ce=x({"node_modules/@bygdle/javascript-lp-solver/src/expressions.js"(e,a){function n(A,S,h,m){this.id=A,this.cost=S,this.index=h,this.value=0,this.priority=m}function s(A,S,h,m){n.call(this,A,S,h,m)}s.prototype.isInteger=!0;function r(A,S){n.call(this,A,0,S,0)}r.prototype.isSlack=!0;function i(A,S){this.variable=A,this.coefficient=S}function c(A,S,h){return h===0||h==="required"?null:(S=S||1,h=h||1,A.isMinimization===!1&&(S=-S),A.addVariable(S,"r"+A.relaxationIndex++,!1,!1,h))}function _(A,S,h,m){this.slack=new r("s"+h,h),this.index=h,this.model=m,this.rhs=A,this.isUpperBound=S,this.terms=[],this.termsByVarIndex={},this.relaxation=null}_.prototype.addTerm=function(A,S){var h=S.index,m=this.termsByVarIndex[h];if(m===void 0)m=new i(S,A),this.termsByVarIndex[h]=m,this.terms.push(m),this.isUpperBound===!0&&(A=-A),this.model.updateConstraintCoefficient(this,S,A);else{var f=m.coefficient+A;this.setVariableCoefficient(f,S)}return this},_.prototype.removeTerm=function(A){return this},_.prototype.setRightHandSide=function(A){if(A!==this.rhs){var S=A-this.rhs;this.isUpperBound===!0&&(S=-S),this.rhs=A,this.model.updateRightHandSide(this,S)}return this},_.prototype.setVariableCoefficient=function(A,S){var h=S.index;if(h===-1){console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.");return}var m=this.termsByVarIndex[h];if(m===void 0)this.addTerm(A,S);else if(A!==m.coefficient){var f=A-m.coefficient;this.isUpperBound===!0&&(f=-f),m.coefficient=A,this.model.updateConstraintCoefficient(this,S,f)}return this},_.prototype.relax=function(A,S){this.relaxation=c(this.model,A,S),this._relax(this.relaxation)},_.prototype._relax=function(A){A!==null&&(this.isUpperBound?this.setVariableCoefficient(-1,A):this.setVariableCoefficient(1,A))};function u(A,S){this.upperBound=A,this.lowerBound=S,this.model=A.model,this.rhs=A.rhs,this.relaxation=null}u.prototype.isEquality=!0,u.prototype.addTerm=function(A,S){return this.upperBound.addTerm(A,S),this.lowerBound.addTerm(A,S),this},u.prototype.removeTerm=function(A){return this.upperBound.removeTerm(A),this.lowerBound.removeTerm(A),this},u.prototype.setRightHandSide=function(A){this.upperBound.setRightHandSide(A),this.lowerBound.setRightHandSide(A),this.rhs=A},u.prototype.relax=function(A,S){this.relaxation=c(this.model,A,S),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)},a.exports={Constraint:_,Variable:n,IntegerVariable:s,SlackVariable:r,Equality:u,Term:i}}}),u_=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/cuttingStrategies.js"(){var e=ot(),a=Ce().SlackVariable;e.prototype.addCutConstraints=function(n){for(var s=n.length,r=this.height,i=r+s,c=r;c<i;c+=1)this.matrix[c]===void 0&&(this.matrix[c]=this.matrix[c-1].slice());this.height=i,this.nVars=this.width+this.height-2;for(var _,u=this.width-1,A=0;A<s;A+=1){var S=n[A],h=r+A,m=S.type==="min"?-1:1,f=S.varIndex,N=this.rowByVarIndex[f],L=this.matrix[h];if(N===-1){for(L[this.rhsColumn]=m*S.value,_=1;_<=u;_+=1)L[_]=0;L[this.colByVarIndex[f]]=m}else{var C=this.matrix[N],d=C[this.rhsColumn];for(L[this.rhsColumn]=m*(S.value-d),_=1;_<=u;_+=1)L[_]=-m*C[_]}var M=this.getNewElementIndex();this.varIndexByRow[h]=M,this.rowByVarIndex[M]=h,this.colByVarIndex[M]=-1,this.variablesPerIndex[M]=new a("s"+M,M),this.nVars+=1}},e.prototype._addLowerBoundMIRCut=function(n){if(n===this.costRowIndex)return!1;this.model;var s=this.matrix,r=this.variablesPerIndex[this.varIndexByRow[n]];if(!r.isInteger)return!1;var i=s[n][this.rhsColumn],c=i-Math.floor(i);if(c<this.precision||1-this.precision<c)return!1;var _=this.height;s[_]=s[_-1].slice(),this.height+=1,this.nVars+=1;var u=this.getNewElementIndex();this.varIndexByRow[_]=u,this.rowByVarIndex[u]=_,this.colByVarIndex[u]=-1,this.variablesPerIndex[u]=new a("s"+u,u),s[_][this.rhsColumn]=Math.floor(i);for(var A=1;A<this.varIndexByCol.length;A+=1){var S=this.variablesPerIndex[this.varIndexByCol[A]];if(!S.isInteger)s[_][A]=Math.min(0,s[n][A]/(1-c));else{var h=s[n][A],m=Math.floor(h)+Math.max(0,h-Math.floor(h)-c)/(1-c);s[_][A]=m}}for(var f=0;f<this.width;f+=1)s[_][f]-=s[n][f];return!0},e.prototype._addUpperBoundMIRCut=function(n){if(n===this.costRowIndex)return!1;this.model;var s=this.matrix,r=this.variablesPerIndex[this.varIndexByRow[n]];if(!r.isInteger)return!1;var i=s[n][this.rhsColumn],c=i-Math.floor(i);if(c<this.precision||1-this.precision<c)return!1;var _=this.height;s[_]=s[_-1].slice(),this.height+=1,this.nVars+=1;var u=this.getNewElementIndex();this.varIndexByRow[_]=u,this.rowByVarIndex[u]=_,this.colByVarIndex[u]=-1,this.variablesPerIndex[u]=new a("s"+u,u),s[_][this.rhsColumn]=-c;for(var A=1;A<this.varIndexByCol.length;A+=1){var S=this.variablesPerIndex[this.varIndexByCol[A]],h=s[n][A],m=h-Math.floor(h);S.isInteger?m<=c?s[_][A]=-m:s[_][A]=-(1-m)*c/m:h>=0?s[_][A]=-h:s[_][A]=h*c/(1-c)}return!0},e.prototype.applyMIRCuts=function(){}}}),A_=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/dynamicModification.js"(){var e=ot();e.prototype._putInBase=function(a){var n=this.rowByVarIndex[a];if(n===-1){for(var s=this.colByVarIndex[a],r=1;r<this.height;r+=1){var i=this.matrix[r][s];if(i<-this.precision||this.precision<i){n=r;break}}this.pivot(n,s)}return n},e.prototype._takeOutOfBase=function(a){var n=this.colByVarIndex[a];if(n===-1){for(var s=this.rowByVarIndex[a],r=this.matrix[s],i=1;i<this.height;i+=1){var c=r[i];if(c<-this.precision||this.precision<c){n=i;break}}this.pivot(s,n)}return n},e.prototype.updateVariableValues=function(){for(var a=this.variables.length,n=Math.round(1/this.precision),s=0;s<a;s+=1){var r=this.variables[s],i=r.index,c=this.rowByVarIndex[i];if(c===-1)r.value=0;else{var _=this.matrix[c][this.rhsColumn];r.value=Math.round((_+Number.EPSILON)*n)/n}}},e.prototype.updateRightHandSide=function(a,n){var s=this.height-1,r=this.rowByVarIndex[a.index];if(r===-1){for(var i=this.colByVarIndex[a.index],c=0;c<=s;c+=1){var _=this.matrix[c];_[this.rhsColumn]-=n*_[i]}var u=this.optionalObjectives.length;if(u>0)for(var A=0;A<u;A+=1){var S=this.optionalObjectives[A].reducedCosts;S[this.rhsColumn]-=n*S[i]}}else this.matrix[r][this.rhsColumn]-=n},e.prototype.updateConstraintCoefficient=function(a,n,s){if(a.index===n.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var r=this._putInBase(a.index),i=this.colByVarIndex[n.index];if(i===-1)for(var c=this.rowByVarIndex[n.index],_=0;_<this.width;_+=1)this.matrix[r][_]+=s*this.matrix[c][_];else this.matrix[r][i]-=s},e.prototype.updateCost=function(a,n){var s=a.index,r=this.width-1,i=this.colByVarIndex[s];if(i===-1){var c=this.matrix[this.rowByVarIndex[s]],_;if(a.priority===0){var u=this.matrix[0];for(_=0;_<=r;_+=1)u[_]+=n*c[_]}else{var A=this.objectivesByPriority[a.priority].reducedCosts;for(_=0;_<=r;_+=1)A[_]+=n*c[_]}}else this.matrix[0][i]-=n},e.prototype.addConstraint=function(a){var n=a.isUpperBound?1:-1,s=this.height,r=this.matrix[s];r===void 0&&(r=this.matrix[0].slice(),this.matrix[s]=r);for(var i=this.width-1,c=0;c<=i;c+=1)r[c]=0;r[this.rhsColumn]=n*a.rhs;for(var _=a.terms,u=_.length,A=0;A<u;A+=1){var S=_[A],h=S.coefficient,m=S.variable.index,f=this.rowByVarIndex[m];if(f===-1)r[this.colByVarIndex[m]]+=n*h;else{var N=this.matrix[f];for(N[this.rhsColumn],c=0;c<=i;c+=1)r[c]-=n*h*N[c]}}var L=a.index;this.varIndexByRow[s]=L,this.rowByVarIndex[L]=s,this.colByVarIndex[L]=-1,this.height+=1},e.prototype.removeConstraint=function(a){var n=a.index,s=this.height-1,r=this._putInBase(n),i=this.matrix[s];this.matrix[s]=this.matrix[r],this.matrix[r]=i,this.varIndexByRow[r]=this.varIndexByRow[s],this.varIndexByRow[s]=-1,this.rowByVarIndex[n]=-1,this.availableIndexes[this.availableIndexes.length]=n,a.slack.index=-1,this.height-=1},e.prototype.addVariable=function(a){var n=this.height-1,s=this.width,r=this.model.isMinimization===!0?-a.cost:a.cost,i=a.priority,c=this.optionalObjectives.length;if(c>0)for(var _=0;_<c;_+=1)this.optionalObjectives[_].reducedCosts[s]=0;i===0?this.matrix[0][s]=r:(this.setOptionalObjective(i,s,r),this.matrix[0][s]=0);for(var u=1;u<=n;u+=1)this.matrix[u][s]=0;var A=a.index;this.varIndexByCol[s]=A,this.rowByVarIndex[A]=-1,this.colByVarIndex[A]=s,this.width+=1},e.prototype.removeVariable=function(a){var n=a.index,s=this._takeOutOfBase(n),r=this.width-1;if(s!==r){for(var i=this.height-1,c=0;c<=i;c+=1){var _=this.matrix[c];_[s]=_[r]}var u=this.optionalObjectives.length;if(u>0)for(var A=0;A<u;A+=1){var S=this.optionalObjectives[A].reducedCosts;S[s]=S[r]}var h=this.varIndexByCol[r];this.varIndexByCol[s]=h,this.colByVarIndex[h]=s}this.varIndexByCol[r]=-1,this.colByVarIndex[n]=-1,this.availableIndexes[this.availableIndexes.length]=n,a.index=-1,this.width-=1}}}),S_=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/log.js"(){var e=ot();e.prototype.log=function(a,n){console.log("****",a,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var s=5,r="",i=[" "],c,_,u,A,S,h,m,f,N,L,C;for(_=1;_<this.width;_+=1)S=this.varIndexByCol[_],A=this.variablesPerIndex[S],A===void 0?h="c"+S:h=A.id,m=h.length,f=" ",N="	",m>5?f+=" ":N+="	",i[_]=f,r+=N+h;console.log(r);var d,M=this.matrix[this.costRowIndex],R="	";for(c=1;c<this.width;c+=1)d="	",R+=d,R+=i[c],R+=M[c].toFixed(s);for(d="	",R+=d+i[0]+M[0].toFixed(s),console.log(R+"	Z"),u=1;u<this.height;u+=1){for(L=this.matrix[u],C="	",_=1;_<this.width;_+=1)d="	",C+=d+i[_]+L[_].toFixed(s);d="	",C+=d+i[0]+L[0].toFixed(s),S=this.varIndexByRow[u],A=this.variablesPerIndex[S],A===void 0?h="c"+S:h=A.id,console.log(C+"	"+h)}console.log("");var O=this.optionalObjectives.length;if(O>0){console.log("    Optional objectives:");for(var y=0;y<O;y+=1){var H=this.optionalObjectives[y].reducedCosts,w="";for(c=1;c<this.width;c+=1)d=H[c]<0?"":" ",w+=d,w+=i[c],w+=H[c].toFixed(s);d=H[0]<0?"":" ",w+=d+i[0]+H[0].toFixed(s),console.log(w+" z"+y)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this}}}),h_=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/backup.js"(){var e=ot();e.prototype.copy=function(){var a=new e(this.precision);a.width=this.width,a.height=this.height,a.nVars=this.nVars,a.model=this.model,a.variables=this.variables,a.variablesPerIndex=this.variablesPerIndex,a.unrestrictedVars=this.unrestrictedVars,a.lastElementIndex=this.lastElementIndex,a.varIndexByRow=this.varIndexByRow.slice(),a.varIndexByCol=this.varIndexByCol.slice(),a.rowByVarIndex=this.rowByVarIndex.slice(),a.colByVarIndex=this.colByVarIndex.slice(),a.availableIndexes=this.availableIndexes.slice();for(var n=[],s=0;s<this.optionalObjectives.length;s++)n[s]=this.optionalObjectives[s].copy();a.optionalObjectives=n;for(var r=this.matrix,i=new Array(this.height),c=0;c<this.height;c++)i[c]=r[c].slice();return a.matrix=i,a},e.prototype.save=function(){this.savedState=this.copy()},e.prototype.restore=function(){if(this.savedState!==null){var a=this.savedState,n=a.matrix;this.nVars=a.nVars,this.model=a.model,this.variables=a.variables,this.variablesPerIndex=a.variablesPerIndex,this.unrestrictedVars=a.unrestrictedVars,this.lastElementIndex=a.lastElementIndex,this.width=a.width,this.height=a.height;var s,r;for(s=0;s<this.height;s+=1){var i=n[s],c=this.matrix[s];for(r=0;r<this.width;r+=1)c[r]=i[r]}var _=a.varIndexByRow;for(r=0;r<this.height;r+=1)this.varIndexByRow[r]=_[r];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var u=a.varIndexByCol;for(s=0;s<this.width;s+=1)this.varIndexByCol[s]=u[s];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var A=a.rowByVarIndex,S=a.colByVarIndex,h=0;h<this.nVars;h+=1)this.rowByVarIndex[h]=A[h],this.colByVarIndex[h]=S[h];if(a.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var m=0;m<a.optionalObjectives.length;m++){var f=a.optionalObjectives[m].copy();this.optionalObjectives[m]=f,this.optionalObjectivePerPriority[f.priority]=f}}}}}}),m_=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/branchingStrategies.js"(){var e=ot();function a(n,s){this.index=n,this.value=s}e.prototype.getMostFractionalVar=function(){for(var n=0,s=null,r=null,i=this.model.integerVariables,c=i.length,_=0;_<c;_++){var u=i[_].index,A=this.rowByVarIndex[u];if(A!==-1){var S=this.matrix[A][this.rhsColumn],h=Math.abs(S-Math.round(S));n<h&&(n=h,s=u,r=S)}}return new a(s,r)},e.prototype.getFractionalVarWithLowestCost=function(){for(var n=1/0,s=null,r=null,i=this.model.integerVariables,c=i.length,_=0;_<c;_++){var u=i[_],A=u.index,S=this.rowByVarIndex[A];if(S!==-1){var h=this.matrix[S][this.rhsColumn];if(Math.abs(h-Math.round(h))>this.precision){var m=u.cost;n>m&&(n=m,s=A,r=h)}}}return new a(s,r)}}}),f_=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/integerProperties.js"(){var e=ot();e.prototype.countIntegerValues=function(){for(var a=0,n=1;n<this.height;n+=1)if(this.variablesPerIndex[this.varIndexByRow[n]].isInteger){var s=this.matrix[n][this.rhsColumn];s=s-Math.floor(s),s<this.precision&&-s<this.precision&&(a+=1)}return a},e.prototype.isIntegral=function(){for(var a=this.model.integerVariables,n=a.length,s=0;s<n;s++){var r=this.rowByVarIndex[a[s].index];if(r!==-1){var i=this.matrix[r][this.rhsColumn];if(Math.abs(i-Math.round(i))>this.precision)return!1}}return!0},e.prototype.computeFractionalVolume=function(a){for(var n=-1,s=1;s<this.height;s+=1)if(this.variablesPerIndex[this.varIndexByRow[s]].isInteger){var r=this.matrix[s][this.rhsColumn];r=Math.abs(r);var i=Math.min(r-Math.floor(r),Math.floor(r+1));if(i<this.precision){if(!a)return 0}else n===-1?n=r:n*=r}return n===-1?0:n}}}),L_=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/index.js"(e,a){__(),u_(),A_(),S_(),h_(),m_(),f_(),a.exports=ot()}}),on=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/branchAndCut.js"(){var e=ot();function a(r,i,c){this.type=r,this.varIndex=i,this.value=c}function n(r,i){this.relaxedEvaluation=r,this.cuts=i}function s(r,i){return i.relaxedEvaluation-r.relaxedEvaluation}e.prototype.applyCuts=function(r){if(this.restore(),this.addCutConstraints(r),this.simplex(),this.model.useMIRCuts)for(var i=!0;i;){var c=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex();var _=this.computeFractionalVolume(!0);_>=.9*c&&(i=!1)}},e.prototype.branchAndCut=function(){var r=[],i=0,c=this.model.tolerance,_=!0,u=1e99;this.model.timeout&&(u=Date.now()+this.model.timeout);for(var A=1/0,S=null,h=[],m=0;m<this.optionalObjectives.length;m+=1)h.push(1/0);var f=new n(-1/0,[]),N;for(r.push(f);r.length>0&&_===!0&&Date.now()<u;)if(this.model.isMinimization?N=this.bestPossibleEval*(1+c):N=this.bestPossibleEval*(1-c),c>0&&A<N&&(_=!1),f=r.pop(),!(f.relaxedEvaluation>A)){var L=f.cuts;if(this.applyCuts(L),i++,this.feasible!==!1){var C=this.evaluation;if(!(C>A)){if(C===A){for(var d=!0,M=0;M<this.optionalObjectives.length&&!(this.optionalObjectives[M].reducedCosts[0]>h[M]);M+=1)if(this.optionalObjectives[M].reducedCosts[0]<h[M]){d=!1;break}if(d)continue}if(this.isIntegral()===!0){if(this.__isIntegral=!0,i===1){this.branchAndCutIterations=i;return}S=f,A=C;for(var R=0;R<this.optionalObjectives.length;R+=1)h[R]=this.optionalObjectives[R].reducedCosts[0];if(this.model.keep_solutions){var O=this.model.tableau.getSolution(),y=O.generateSolutionSet();y.result=O.evaluation,this.model.solutions||(this.model.solutions=[]),this.model.solutions.push(y)}}else{i===1&&this.save();for(var H=this.getMostFractionalVar(),w=H.index,z=[],X=[],at=L.length,Et=0;Et<at;Et+=1){var Z=L[Et];Z.varIndex===w?Z.type==="min"?X.push(Z):z.push(Z):(z.push(Z),X.push(Z))}var dt=Math.ceil(H.value),Ct=Math.floor(H.value),Na=new a("min",w,dt);z.push(Na);var da=new a("max",w,Ct);X.push(da),r.push(new n(C,z)),r.push(new n(C,X)),r.sort(s)}}}}S!==null&&this.applyCuts(S.cuts),this.branchAndCutIterations=i}}}),p_=x({"node_modules/@bygdle/javascript-lp-solver/src/Model.js"(e,a){var n=ot();on();var s=Ce(),r=s.Constraint,i=s.Equality,c=s.Variable,_=s.IntegerVariable;s.Term;function u(A,S){this.tableau=new n(A),this.name=S,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}a.exports=u,u.prototype.minimize=function(){return this.isMinimization=!0,this},u.prototype.maximize=function(){return this.isMinimization=!1,this},u.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var A=this.lastElementIndex;return this.lastElementIndex+=1,A},u.prototype._addConstraint=function(A){var S=A.slack;this.tableau.variablesPerIndex[S.index]=S,this.constraints.push(A),this.nConstraints+=1,this.tableauInitialized===!0&&this.tableau.addConstraint(A)},u.prototype.smallerThan=function(A){var S=new r(A,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(S),S},u.prototype.greaterThan=function(A){var S=new r(A,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(S),S},u.prototype.equal=function(A){var S=new r(A,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(S);var h=new r(A,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(h),new i(S,h)},u.prototype.addVariable=function(A,S,h,m,f){if(typeof f=="string")switch(f){case"required":f=0;break;case"strong":f=1;break;case"medium":f=2;break;case"weak":f=3;break;default:f=0;break}var N=this.tableau.getNewElementIndex();S==null&&(S="v"+N),A==null&&(A=0),f==null&&(f=0);var L;return h?(L=new _(S,A,N,f),this.integerVariables.push(L)):L=new c(S,A,N,f),this.variables.push(L),this.tableau.variablesPerIndex[N]=L,m&&(this.unrestrictedVariables[N]=!0),this.nVariables+=1,this.tableauInitialized===!0&&this.tableau.addVariable(L),L},u.prototype._removeConstraint=function(A){var S=this.constraints.indexOf(A);if(S===-1){console.warn("[Model.removeConstraint] Constraint not present in model");return}this.constraints.splice(S,1),this.nConstraints-=1,this.tableauInitialized===!0&&this.tableau.removeConstraint(A),A.relaxation&&this.removeVariable(A.relaxation)},u.prototype.removeConstraint=function(A){return A.isEquality?(this._removeConstraint(A.upperBound),this._removeConstraint(A.lowerBound)):this._removeConstraint(A),this},u.prototype.removeVariable=function(A){var S=this.variables.indexOf(A);if(S===-1){console.warn("[Model.removeVariable] Variable not present in model");return}return this.variables.splice(S,1),this.tableauInitialized===!0&&this.tableau.removeVariable(A),this},u.prototype.updateRightHandSide=function(A,S){return this.tableauInitialized===!0&&this.tableau.updateRightHandSide(A,S),this},u.prototype.updateConstraintCoefficient=function(A,S,h){return this.tableauInitialized===!0&&this.tableau.updateConstraintCoefficient(A,S,h),this},u.prototype.setCost=function(A,S){var h=A-S.cost;return this.isMinimization===!1&&(h=-h),S.cost=A,this.tableau.updateCost(S,h),this},u.prototype.loadJson=function(A){this.isMinimization=A.opType!=="max";for(var S=A.variables,h=A.constraints,m={},f={},N=Object.keys(h),L=N.length,C=0;C<L;C+=1){var d=N[C],M=h[d],R=M.equal,O=M.weight,y=M.priority,H=O!==void 0||y!==void 0,w,z;if(R===void 0){var X=M.min;X!==void 0&&(w=this.greaterThan(X),m[d]=w,H&&w.relax(O,y));var at=M.max;at!==void 0&&(z=this.smallerThan(at),f[d]=z,H&&z.relax(O,y))}else{w=this.greaterThan(R),m[d]=w,z=this.smallerThan(R),f[d]=z;var Et=new i(w,z);H&&Et.relax(O,y)}}var Z=Object.keys(S),dt=Z.length;this.tolerance=A.tolerance||0,A.timeout&&(this.timeout=A.timeout),A.options&&(A.options.timeout&&(this.timeout=A.options.timeout),this.tolerance===0&&(this.tolerance=A.options.tolerance||0),A.options.useMIRCuts&&(this.useMIRCuts=A.options.useMIRCuts),typeof A.options.exitOnCycles>"u"?this.checkForCycles=!0:this.checkForCycles=A.options.exitOnCycles,A.options.keep_solutions?this.keep_solutions=A.options.keep_solutions:this.keep_solutions=!1);for(var Ct=A.ints||{},Na=A.binaries||{},da=A.unrestricted||{},WE=A.optimize,Ca=0;Ca<dt;Ca+=1){var Ut=Z[Ca],Ma=S[Ut],Cd=Ma[WE]||0,jE=!!Na[Ut],Md=!!Ct[Ut]||jE,gd=!!da[Ut],ga=this.addVariable(Cd,Ut,Md,gd);jE&&this.smallerThan(1).addTerm(1,ga);var zE=Object.keys(Ma);for(C=0;C<zE.length;C+=1){var fe=zE[C];if(fe!==WE){var qE=Ma[fe],$E=m[fe];$E!==void 0&&$E.addTerm(qE,ga);var QE=f[fe];QE!==void 0&&QE.addTerm(qE,ga)}}}return this},u.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},u.prototype.solve=function(){return this.tableauInitialized===!1&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},u.prototype.isFeasible=function(){return this.tableau.feasible},u.prototype.save=function(){return this.tableau.save()},u.prototype.restore=function(){return this.tableau.restore()},u.prototype.activateMIRCuts=function(A){this.useMIRCuts=A},u.prototype.debug=function(A){this.checkForCycles=A},u.prototype.log=function(A){return this.tableau.log(A)}}}),N_=x({"node_modules/@bygdle/javascript-lp-solver/src/Validation.js"(e){e.CleanObjectiveAttributes=function(a){var n,s,r;if(typeof a.optimize=="string")if(a.constraints[a.optimize]){n=Math.random();for(s in a.variables)a.variables[s][a.optimize]&&(a.variables[s][n]=a.variables[s][a.optimize]);return a.constraints[n]=a.constraints[a.optimize],delete a.constraints[a.optimize],a}else return a;else{for(r in a.optimize)if(a.constraints[r])if(a.constraints[r]==="equal")delete a.optimize[r];else{n=Math.random();for(s in a.variables)a.variables[s][r]&&(a.variables[s][n]=a.variables[s][r]);a.constraints[n]=a.constraints[r],delete a.constraints[r]}return a}}}}),Me=x({"node_modules/@bygdle/javascript-lp-solver/src/External/lpsolve/Reformat.js"(e,a){function n(r){var i={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},c={opType:"",optimize:"_obj",constraints:{},variables:{}},_={">=":"min","<=":"max","=":"equal"},u="",A=null,S="",h="",m="",f=0;typeof r=="string"&&(r=r.split(`
`));for(var N=0;N<r.length;N++)if(m="__"+N,u=r[N],A=null,i.is_objective.test(u))c.opType=u.match(/(max|min)/gi)[0],A=u.match(i.parse_lhs).map(function(d){return d.replace(/\s+/,"")}).slice(1),A.forEach(function(d){S=d.match(i.get_num),S===null?d.substr(0,1)==="-"?S=-1:S=1:S=S[0],S=parseFloat(S),h=d.match(i.get_word)[0].replace(/\;$/,""),c.variables[h]=c.variables[h]||{},c.variables[h]._obj=S});else if(i.is_int.test(u))A=u.match(i.parse_int).slice(1),c.ints=c.ints||{},A.forEach(function(d){d=d.replace(";",""),c.ints[d]=1});else if(i.is_bin.test(u))A=u.match(i.parse_bin).slice(1),c.binaries=c.binaries||{},A.forEach(function(d){d=d.replace(";",""),c.binaries[d]=1});else if(i.is_constraint.test(u)){var L=u.indexOf(":"),C=L===-1?u:u.slice(L+1);A=C.match(i.parse_lhs).map(function(d){return d.replace(/\s+/,"")}),A.forEach(function(d){S=d.match(i.get_num),S===null?d.substr(0,1)==="-"?S=-1:S=1:S=S[0],S=parseFloat(S),h=d.match(i.get_word)[0],c.variables[h]=c.variables[h]||{},c.variables[h][m]=S}),f=parseFloat(u.match(i.parse_rhs)[0]),u=_[u.match(i.parse_dir)[0]],c.constraints[m]=c.constraints[m]||{},c.constraints[m][u]=f}else i.is_unrestricted.test(u)&&(A=u.match(i.parse_int).slice(1),c.unrestricted=c.unrestricted||{},A.forEach(function(d){d=d.replace(";",""),c.unrestricted[d]=1}));return c}function s(r){if(!r)throw new Error("Solver requires a model to operate on");var i="",c={max:"<=",min:">=",equal:"="},_=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(r.opType){i+=r.opType+":";for(var u in r.variables)r.variables[u][u]=r.variables[u][u]?r.variables[u][u]:1,r.variables[u][r.optimize]&&(i+=" "+r.variables[u][r.optimize]+" "+u.replace(_,"_"))}else i+="max:";i+=`;

`;for(var A in r.constraints)for(var S in r.constraints[A])if(typeof c[S]<"u"){for(var h in r.variables)typeof r.variables[h][A]<"u"&&(i+=" "+r.variables[h][A]+" "+h.replace(_,"_"));i+=" "+c[S]+" "+r.constraints[A][S],i+=`;
`}if(r.ints){i+=`

`;for(var m in r.ints)i+="int "+m.replace(_,"_")+`;
`}if(r.unrestricted){i+=`

`;for(var f in r.unrestricted)i+="unrestricted "+f.replace(_,"_")+`;
`}return i}a.exports=function(r){return r.length?n(r):s(r)}}}),d_=x({"node_modules/@bygdle/javascript-lp-solver/src/External/lpsolve/main.js"(e){e.reformat=Me(),e.solve=function(a){return new Promise(function(n,s){typeof window<"u"&&s("Function Not Available in Browser"),Me()(a),a.external||s("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),a.external.binPath||s("No Executable | Binary path provided in arguments as 'binPath'"),a.external.args||s("No arguments array for cli | bash provided on 'args' attribute"),a.external.tempName||s("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on")})}}}),C_=x({"node_modules/@bygdle/javascript-lp-solver/src/External/main.js"(e,a){a.exports={lpsolve:d_()}}}),cn=x({"node_modules/@bygdle/javascript-lp-solver/src/Polyopt.js"(e,a){a.exports=function(n,s){var r=s.optimize,i=JSON.parse(JSON.stringify(s.optimize)),c=Object.keys(s.optimize),_,u=0,A={},S="",h={},m=[],f,N,L,C;for(delete s.optimize,f=0;f<c.length;f++)i[c[f]]=0;for(f=0;f<c.length;f++){s.optimize=c[f],s.opType=r[c[f]],_=n.Solve(s,void 0,void 0,!0);for(C in c)if(!s.variables[c[C]]){_[c[C]]=_[c[C]]?_[c[C]]:0;for(L in s.variables)s.variables[L][c[C]]&&_[L]&&(_[c[C]]+=_[L]*s.variables[L][c[C]])}for(S="base",N=0;N<c.length;N++)_[c[N]]?S+="-"+(_[c[N]]*1e3|0)/1e3:S+="-0";if(!A[S]){for(A[S]=1,u++,N=0;N<c.length;N++)_[c[N]]&&(i[c[N]]+=_[c[N]]);delete _.feasible,delete _.result,m.push(_)}}for(f=0;f<c.length;f++)s.constraints[c[f]]={equal:i[c[f]]/u};s.optimize="cheater-"+Math.random(),s.opType="max";for(f in s.variables)s.variables[f].cheater=1;for(f in m)for(L in m[f])h[L]=h[L]||{min:1e99,max:-1e99};for(f in h)for(L in m)m[L][f]?(m[L][f]>h[f].max&&(h[f].max=m[L][f]),m[L][f]<h[f].min&&(h[f].min=m[L][f])):(m[L][f]=0,h[f].min=0);return _=n.Solve(s,void 0,void 0,!0),{midpoint:_,vertices:m,ranges:h}}}}),M_=x({"node_modules/@bygdle/javascript-lp-solver/src/main.js"(e,a){var n=L_(),s=p_(),r=on(),i=Ce(),c=N_(),_=i.Constraint,u=i.Variable,A=i.Numeral,S=i.Term,h=C_(),m=function(){this.Model=s,this.branchAndCut=r,this.Constraint=_,this.Variable=u,this.Numeral=A,this.Term=S,this.Tableau=n,this.lastSolvedModel=null,this.External=h,this.ReformatLP=Me(),this.MultiObjective=function(f){return cn()(this,f)}};m.prototype.Solve=function(f,N,L,C){if(C)for(var d in c)f=c[d](f);if(!f)throw new Error("Solver requires a model to operate on");if(typeof f.optimize=="object"&&Object.keys(f.optimize>1))return cn()(this,f);if(f.external){var M=Object.keys(h);if(M=JSON.stringify(M),!f.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+M);if(!h[f.external.solver])throw new Error("No support (yet) for "+f.external.solver+". Please use one of these instead:"+M);return h[f.external.solver].solve(f)}else{f instanceof s||(f=new s(N).loadJson(f));var R=f.solve();if(R.solutionSet=R.generateSolutionSet(),L)return R;var O={};return O.feasible=R.feasible,O.result=R.evaluation,O.bounded=R.bounded,R._tableau.__isIntegral&&(O.isIntegral=!0),Object.keys(R.solutionSet).forEach(function(y){R.solutionSet[y]!==0&&(O[y]=R.solutionSet[y])}),O}},typeof define=="function"?define([],function(){return new m}):typeof window=="object"?window.solver=new m:typeof self=="object"&&(self.solver=new m),a.exports=new m}}),En={};D(En,{Runner:()=>ca,api:()=>FE,artbox:()=>Lt,artifact:()=>I,character:()=>Tn,characters:()=>pt,charbox:()=>G,cmd:()=>JT,effect:()=>l,effects:()=>Ee,enemy:()=>_n,food:()=>Ot,foods:()=>bt,formula:()=>dn,instance:()=>ss,optimizer:()=>yE,resonances:()=>ls,rotation:()=>ie,scaling:()=>o,sets:()=>tt,stats:()=>t,store:()=>Ft,strings:()=>T,subject:()=>mn,utils:()=>Qc,weapon:()=>p,weapons:()=>et,worker:()=>rE});var Tn={};D(Tn,{Character:()=>Ke,Export:()=>as,Import:()=>ns});var _n={};D(_n,{Enemy:()=>fn,EnemyConnector:()=>Ln,EnemyEvent:()=>ht,Export:()=>ye,Import:()=>Jt});var t={};D(t,{AuraToDmg:()=>De,DmgToAtkFlat:()=>Re,DmgToAtkPercent:()=>ge,DmgToAura:()=>R_,DmgToCritDmg:()=>Oe,DmgToCritRate:()=>Ie,DmgToFlatDmg:()=>Ge,DmgToRes:()=>Xt,Elements:()=>Gt,FlatStats:()=>Sn,Mainstats:()=>g_,PieceToMainstats:()=>ve,Substats:()=>yt,Swirlable:()=>G_,TrToDmg:()=>hn,aura:()=>q,piece:()=>st,region:()=>An,stat:()=>E,weapon:()=>un});function ct(...e){const a={},n={};let s=0;for(const r of e)a[r]=s,n[s]=r,s++;return nt(b({},a),{Get(r){const i=a[r];if(i===void 0)throw new Error(`Stat not found: ${r}`);return i},Name(r){const i=n[r];if(i===void 0)throw new Error(`Stat not found: ${r}`);return i},Has(r){return Object.keys(a).includes(r)},Values(){return Object.values(a)},Length(){return e.length}})}var E=ct("NONE","SHIELDED","ATK","ATK_BASE","ATK_PERCENT","ATK_FLAT","HP_CURRENT","HP","HP_BASE","HP_PERCENT","HP_FLAT","DEF","DEF_BASE","DEF_PERCENT","DEF_FLAT","ENERGY_CURRENT","ELEMENTAL_MASTERY","ENERGY_RECHARGE","HEALING_BONUS","CRIT_RATE","EXTRA_CRIT_RATE","CRIT_DMG","ALL_DMG","DEFIGNORED","DEFREDUCTION","DMG_FLAT","PYRO_DMG","CRYO_DMG","HYDRO_DMG","ELECTRO_DMG","ANEMO_DMG","GEO_DMG","DENDRO_DMG","PHYSICAL_DMG","PYRO_DMG_FLAT","CRYO_DMG_FLAT","HYDRO_DMG_FLAT","ELECTRO_DMG_FLAT","ANEMO_DMG_FLAT","GEO_DMG_FLAT","DENDRO_DMG_FLAT","PHYSICAL_DMG_FLAT","MELT_DMG","VAPORIZE_DMG","SWIRL_DMG","OVERLOAD_DMG","ELECTROCHARGE_DMG","SUPERCONDUCT_DMG","SHATTER_DMG","AGGRAVATE_DMG","SPREAD_DMG","BLOOM_DMG","HYPERBLOOM_DMG","BURGEON_DMG","BURNING_DMG","NORMAL_ATTACK_DMG","CHARGED_ATTACK_DMG","AIMED_SHOT_DMG","CHARGED_AIMED_SHOT_DMG","PLUNGE_ATTACK_DMG","ELEMENTAL_SKILL_DMG","ELEMENTAL_BURST_DMG","NORMAL_ATTACK_DMG_FLAT","CHARGED_ATTACK_DMG_FLAT","AIMED_SHOT_DMG_FLAT","CHARGED_AIMED_SHOT_DMG_FLAT","PLUNGE_ATTACK_DMG_FLAT","ELEMENTAL_SKILL_DMG_FLAT","ELEMENTAL_BURST_DMG_FLAT","NORMAL_ATTACK_LEVEL","ELEMENTAL_SKILL_LEVEL","ELEMENTAL_BURST_LEVEL","NORMAL_ATTACK_LEVEL_UP","ELEMENTAL_SKILL_LEVEL_UP","ELEMENTAL_BURST_LEVEL_UP","NORMAL_ATTACK_ATK_PERCENT","CHARGED_ATTACK_ATK_PERCENT","PLUNGE_ATTACK_ATK_PERCENT","AIMED_SHOT_ATK_PERCENT","CHARGED_AIMED_SHOT_ATK_PERCENT","ELEMENTAL_SKILL_ATK_PERCENT","ELEMENTAL_BURST_ATK_PERCENT","PYRO_ATK_PERCENT","CRYO_ATK_PERCENT","ELECTRO_ATK_PERCENT","HYDRO_ATK_PERCENT","GEO_ATK_PERCENT","ANEMO_ATK_PERCENT","DENDRO_ATK_PERCENT","PHYSICAL_ATK_PERCENT","NORMAL_ATTACK_ATK_FLAT","CHARGED_ATTACK_ATK_FLAT","PLUNGE_ATTACK_ATK_FLAT","AIMED_SHOT_ATK_FLAT","CHARGED_AIMED_SHOT_ATK_FLAT","ELEMENTAL_SKILL_ATK_FLAT","ELEMENTAL_BURST_ATK_FLAT","PYRO_ATK_FLAT","CRYO_ATK_FLAT","ELECTRO_ATK_FLAT","HYDRO_ATK_FLAT","GEO_ATK_FLAT","ANEMO_ATK_FLAT","DENDRO_ATK_FLAT","PHYSICAL_ATK_FLAT","NORMAL_ATTACK_CRIT_RATE","CHARGED_ATTACK_CRIT_RATE","PLUNGE_ATTACK_CRIT_RATE","AIMED_SHOT_CRIT_RATE","CHARGED_AIMED_SHOT_CRIT_RATE","ELEMENTAL_SKILL_CRIT_RATE","ELEMENTAL_BURST_CRIT_RATE","PYRO_CRIT_RATE","CRYO_CRIT_RATE","ELECTRO_CRIT_RATE","HYDRO_CRIT_RATE","GEO_CRIT_RATE","ANEMO_CRIT_RATE","DENDRO_CRIT_RATE","PHYSICAL_CRIT_RATE","NORMAL_ATTACK_CRIT_DMG","CHARGED_ATTACK_CRIT_DMG","PLUNGE_ATTACK_CRIT_DMG","AIMED_SHOT_CRIT_DMG","CHARGED_AIMED_SHOT_CRIT_DMG","ELEMENTAL_SKILL_CRIT_DMG","ELEMENTAL_BURST_CRIT_DMG","PYRO_CRIT_DMG","CRYO_CRIT_DMG","ELECTRO_CRIT_DMG","HYDRO_CRIT_DMG","GEO_CRIT_DMG","ANEMO_CRIT_DMG","DENDRO_CRIT_DMG","PHYSICAL_CRIT_DMG","LEVEL","ASCENSION","PYRO_RES","CRYO_RES","ELECTRO_RES","HYDRO_RES","GEO_RES","ANEMO_RES","DENDRO_RES","PHYSICAL_RES"),q=ct("NONE","PYRO","CRYO","HYDRO","ELECTRO","DENDRO","FROZEN","QUICKEN"),un=ct("SWORD","CLAYMORE","POLEARM","CATALYST","BOW"),st=ct("FLOWER","PLUME","SANDS","GOBLET","CIRCLET"),An=ct("NONE","MONDSTADT","LIYUE","INAZUMA","SUMERU","FONTAINE","NATLAN","SNEZHNAYA","KHAENRIAH"),Gt=[E.PYRO_DMG,E.CRYO_DMG,E.HYDRO_DMG,E.ELECTRO_DMG,E.ANEMO_DMG,E.GEO_DMG,E.DENDRO_DMG,E.PHYSICAL_DMG],g_=[E.HP_FLAT,E.ATK_FLAT,E.ATK_PERCENT,E.HP_PERCENT,E.DEF_PERCENT,E.ENERGY_RECHARGE,E.ELEMENTAL_MASTERY,E.PYRO_DMG,E.CRYO_DMG,E.HYDRO_DMG,E.ELECTRO_DMG,E.ANEMO_DMG,E.GEO_DMG,E.DENDRO_DMG,E.PHYSICAL_DMG,E.CRIT_RATE,E.CRIT_DMG,E.HEALING_BONUS],yt=[E.DEF_FLAT,E.HP_FLAT,E.ATK_FLAT,E.ATK_PERCENT,E.HP_PERCENT,E.DEF_PERCENT,E.ENERGY_RECHARGE,E.ELEMENTAL_MASTERY,E.CRIT_RATE,E.CRIT_DMG],Sn=[E.SHIELDED,E.DEF,E.DEF_BASE,E.DEF_FLAT,E.HP,E.HP_BASE,E.HP_FLAT,E.ATK,E.ATK_BASE,E.ATK_FLAT,E.ELEMENTAL_MASTERY,E.DMG_FLAT,E.LEVEL,E.ASCENSION,E.NORMAL_ATTACK_LEVEL,E.ELEMENTAL_SKILL_LEVEL,E.ELEMENTAL_BURST_LEVEL,E.NORMAL_ATTACK_LEVEL_UP,E.ELEMENTAL_SKILL_LEVEL_UP,E.ELEMENTAL_BURST_LEVEL_UP,E.NORMAL_ATTACK_ATK_FLAT,E.CHARGED_ATTACK_ATK_FLAT,E.PLUNGE_ATTACK_ATK_FLAT,E.AIMED_SHOT_ATK_FLAT,E.CHARGED_AIMED_SHOT_ATK_FLAT,E.ELEMENTAL_SKILL_ATK_FLAT,E.ELEMENTAL_BURST_ATK_FLAT,E.PYRO_ATK_FLAT,E.CRYO_ATK_FLAT,E.ELECTRO_ATK_FLAT,E.HYDRO_ATK_FLAT,E.GEO_ATK_FLAT,E.ANEMO_ATK_FLAT,E.DENDRO_ATK_FLAT,E.PHYSICAL_DMG_FLAT,E.NORMAL_ATTACK_DMG_FLAT,E.CHARGED_ATTACK_DMG_FLAT,E.PLUNGE_ATTACK_DMG_FLAT,E.AIMED_SHOT_DMG_FLAT,E.CHARGED_AIMED_SHOT_DMG_FLAT,E.ELEMENTAL_SKILL_DMG_FLAT,E.ELEMENTAL_BURST_DMG_FLAT,E.PYRO_DMG_FLAT,E.CRYO_DMG_FLAT,E.ELECTRO_DMG_FLAT,E.HYDRO_DMG_FLAT,E.GEO_DMG_FLAT,E.ANEMO_DMG_FLAT,E.DENDRO_DMG_FLAT,E.PHYSICAL_DMG_FLAT],G_=[q.CRYO,q.PYRO,q.HYDRO,q.ELECTRO,q.FROZEN];function ge(e){switch(e){case E.PYRO_DMG:return E.PYRO_ATK_PERCENT;case E.HYDRO_DMG:return E.HYDRO_ATK_PERCENT;case E.CRYO_DMG:return E.CRYO_ATK_PERCENT;case E.ELECTRO_DMG:return E.ELECTRO_ATK_PERCENT;case E.ANEMO_DMG:return E.ANEMO_ATK_PERCENT;case E.GEO_DMG:return E.GEO_ATK_PERCENT;case E.DENDRO_DMG:return E.DENDRO_ATK_PERCENT;case E.PHYSICAL_DMG:return E.PHYSICAL_ATK_PERCENT;case E.NORMAL_ATTACK_DMG:return E.NORMAL_ATTACK_ATK_PERCENT;case E.CHARGED_ATTACK_DMG:return E.CHARGED_ATTACK_ATK_PERCENT;case E.AIMED_SHOT_DMG:return E.AIMED_SHOT_ATK_PERCENT;case E.CHARGED_AIMED_SHOT_DMG:return E.CHARGED_AIMED_SHOT_ATK_PERCENT;case E.PLUNGE_ATTACK_DMG:return E.PLUNGE_ATTACK_ATK_PERCENT;case E.ELEMENTAL_SKILL_DMG:return E.ELEMENTAL_SKILL_ATK_PERCENT;case E.ELEMENTAL_BURST_DMG:return E.ELEMENTAL_BURST_ATK_PERCENT}return E.NONE}function Ge(e){switch(e){case E.PYRO_DMG:return E.PYRO_DMG_FLAT;case E.HYDRO_DMG:return E.HYDRO_DMG_FLAT;case E.CRYO_DMG:return E.CRYO_DMG_FLAT;case E.ELECTRO_DMG:return E.ELECTRO_DMG_FLAT;case E.ANEMO_DMG:return E.ANEMO_DMG_FLAT;case E.GEO_DMG:return E.GEO_DMG_FLAT;case E.DENDRO_DMG:return E.DENDRO_DMG_FLAT;case E.PHYSICAL_DMG:return E.PHYSICAL_DMG_FLAT;case E.NORMAL_ATTACK_DMG:return E.NORMAL_ATTACK_DMG_FLAT;case E.CHARGED_ATTACK_DMG:return E.CHARGED_ATTACK_DMG_FLAT;case E.AIMED_SHOT_DMG:return E.AIMED_SHOT_DMG_FLAT;case E.CHARGED_AIMED_SHOT_DMG:return E.CHARGED_AIMED_SHOT_DMG_FLAT;case E.PLUNGE_ATTACK_DMG:return E.PLUNGE_ATTACK_DMG_FLAT;case E.ELEMENTAL_SKILL_DMG:return E.ELEMENTAL_SKILL_DMG_FLAT;case E.ELEMENTAL_BURST_DMG:return E.ELEMENTAL_BURST_DMG_FLAT}return E.NONE}function Re(e){switch(e){case E.PYRO_DMG:return E.PYRO_ATK_FLAT;case E.HYDRO_DMG:return E.HYDRO_ATK_FLAT;case E.CRYO_DMG:return E.CRYO_ATK_FLAT;case E.ELECTRO_DMG:return E.ELECTRO_ATK_FLAT;case E.ANEMO_DMG:return E.ANEMO_ATK_FLAT;case E.GEO_DMG:return E.GEO_ATK_FLAT;case E.DENDRO_DMG:return E.DENDRO_ATK_FLAT;case E.PHYSICAL_DMG:return E.PHYSICAL_ATK_FLAT;case E.NORMAL_ATTACK_DMG:return E.NORMAL_ATTACK_ATK_FLAT;case E.CHARGED_ATTACK_DMG:return E.CHARGED_ATTACK_ATK_FLAT;case E.AIMED_SHOT_DMG:return E.AIMED_SHOT_ATK_FLAT;case E.CHARGED_AIMED_SHOT_DMG:return E.CHARGED_AIMED_SHOT_ATK_FLAT;case E.PLUNGE_ATTACK_DMG:return E.PLUNGE_ATTACK_ATK_FLAT;case E.ELEMENTAL_SKILL_DMG:return E.ELEMENTAL_SKILL_ATK_FLAT;case E.ELEMENTAL_BURST_DMG:return E.ELEMENTAL_BURST_ATK_FLAT}return E.NONE}function Ie(e){switch(e){case E.PYRO_DMG:return E.PYRO_CRIT_RATE;case E.HYDRO_DMG:return E.HYDRO_CRIT_RATE;case E.CRYO_DMG:return E.CRYO_CRIT_RATE;case E.ELECTRO_DMG:return E.ELECTRO_CRIT_RATE;case E.ANEMO_DMG:return E.ANEMO_CRIT_RATE;case E.GEO_DMG:return E.GEO_CRIT_RATE;case E.DENDRO_DMG:return E.DENDRO_CRIT_RATE;case E.PHYSICAL_DMG:return E.PHYSICAL_CRIT_RATE;case E.NORMAL_ATTACK_DMG:return E.NORMAL_ATTACK_CRIT_RATE;case E.CHARGED_ATTACK_DMG:return E.CHARGED_ATTACK_CRIT_RATE;case E.AIMED_SHOT_DMG:return E.AIMED_SHOT_CRIT_RATE;case E.CHARGED_AIMED_SHOT_DMG:return E.CHARGED_AIMED_SHOT_CRIT_RATE;case E.PLUNGE_ATTACK_DMG:return E.PLUNGE_ATTACK_CRIT_RATE;case E.ELEMENTAL_SKILL_DMG:return E.ELEMENTAL_SKILL_CRIT_RATE;case E.ELEMENTAL_BURST_DMG:return E.ELEMENTAL_BURST_CRIT_RATE}return E.NONE}function Oe(e){switch(e){case E.PYRO_DMG:return E.PYRO_CRIT_DMG;case E.HYDRO_DMG:return E.HYDRO_CRIT_DMG;case E.CRYO_DMG:return E.CRYO_CRIT_DMG;case E.ELECTRO_DMG:return E.ELECTRO_CRIT_DMG;case E.ANEMO_DMG:return E.ANEMO_CRIT_DMG;case E.GEO_DMG:return E.GEO_CRIT_DMG;case E.DENDRO_DMG:return E.DENDRO_CRIT_DMG;case E.PHYSICAL_DMG:return E.PHYSICAL_CRIT_DMG;case E.NORMAL_ATTACK_DMG:return E.NORMAL_ATTACK_CRIT_DMG;case E.CHARGED_ATTACK_DMG:return E.CHARGED_ATTACK_CRIT_DMG;case E.AIMED_SHOT_DMG:return E.AIMED_SHOT_CRIT_DMG;case E.CHARGED_AIMED_SHOT_DMG:return E.CHARGED_AIMED_SHOT_CRIT_DMG;case E.PLUNGE_ATTACK_DMG:return E.PLUNGE_ATTACK_CRIT_DMG;case E.ELEMENTAL_SKILL_DMG:return E.ELEMENTAL_SKILL_CRIT_DMG;case E.ELEMENTAL_BURST_DMG:return E.ELEMENTAL_BURST_CRIT_DMG}return E.NONE}function Xt(e){switch(e){case E.PYRO_DMG:return E.PYRO_RES;case E.HYDRO_DMG:return E.HYDRO_RES;case E.CRYO_DMG:return E.CRYO_RES;case E.ELECTRO_DMG:return E.ELECTRO_RES;case E.ANEMO_DMG:return E.ANEMO_RES;case E.GEO_DMG:return E.GEO_RES;case E.DENDRO_DMG:return E.DENDRO_RES;case E.PHYSICAL_DMG:return E.PHYSICAL_RES}return E.NONE}function De(e){switch(e){case q.PYRO:return E.PYRO_DMG;case q.HYDRO:return E.HYDRO_DMG;case q.CRYO:return E.CRYO_DMG;case q.FROZEN:return E.CRYO_DMG;case q.ELECTRO:return E.ELECTRO_DMG;case q.DENDRO:return E.DENDRO_DMG;case q.QUICKEN:return E.DENDRO_DMG}return E.NONE}function R_(e){switch(e){case E.PYRO_DMG:return q.PYRO;case E.HYDRO_DMG:return q.HYDRO;case E.CRYO_DMG:return q.CRYO;case E.ELECTRO_DMG:return q.ELECTRO;case E.DENDRO_DMG:return q.DENDRO}return E.NONE}function hn(e){switch(e){case E.OVERLOAD_DMG:return E.PYRO_DMG;case E.ELECTROCHARGE_DMG:return E.ELECTRO_DMG;case E.SUPERCONDUCT_DMG:return E.CRYO_DMG;case E.SHATTER_DMG:return E.PHYSICAL_DMG;case E.BURNING_DMG:return E.PYRO_DMG;case E.BURGEON_DMG:return E.DENDRO_DMG;case E.BLOOM_DMG:return E.DENDRO_DMG;case E.HYPERBLOOM_DMG:return E.DENDRO_DMG}return E.NONE}function ve(e){switch(e){case st.FLOWER:return[E.HP_FLAT];case st.PLUME:return[E.ATK_FLAT];case st.SANDS:return[E.ATK_PERCENT,E.HP_PERCENT,E.DEF_PERCENT,E.ENERGY_RECHARGE,E.ELEMENTAL_MASTERY];case st.GOBLET:return[E.ATK_PERCENT,E.HP_PERCENT,E.DEF_PERCENT,E.ELEMENTAL_MASTERY,...Gt];case st.CIRCLET:return[E.ATK_PERCENT,E.HP_PERCENT,E.DEF_PERCENT,E.ELEMENTAL_MASTERY,E.CRIT_RATE,E.CRIT_DMG,E.HEALING_BONUS]}return[]}var mn={};D(mn,{Subject:()=>_t});var _t=class{constructor(e,a){this.Title=a,this.props=new Float64Array(e),this.observers=Array.from(Array(e)).fill(0).map(()=>[])}Length(){return this.props.length}Get(e){const a=this.props[e];if(a===void 0)throw new Error(`Subject property out of bounds: ${e}`);return a}Set(e,a,n){return this.props[e]=a,this.Notify(e,n)}Notify(e,a){for(const n of this.observers[e])n.Enabled()&&n.Notify(a);return this}CreateObserver(e,a){let n=!0;const s={prop:e,Enabled(){return n},Enable(){return n=!0,s},Disable(){return n=!1,s},Remove:()=>this.RemoveObserver(s),Notify(r){return a(r),s}};return this.observers[e].push(s),s}RemoveObserver(e){const a=this.observers[e.prop].indexOf(e);return a===-1?!1:(this.observers[e.prop].splice(a,1),!0)}CreateModifier(e,a){let n=!1;const s={Title:this.Title,Enabled(){return n},Enable:()=>(n||(this.Set(e,this.Get(e)+a,s),n=!0),s),Disable:()=>(n&&(this.Set(e,this.Get(e)-a,s),n=!1),s),GetProp(){return e},GetValue(){return a},SetProp(r){const i=n;return s.Disable(),e=r,i&&s.Enable(),s},SetValue(r){const i=n;return s.Disable(),a=r,i&&s.Enable(),s}};return s.Enable(),s}},ht=ct("CHANGE_AURA","CHANGE_BASE_RES"),fn=class{constructor(e){this.name=e,this.Event=new _t(ht.Length(),"ENEMY_EVENT"),this.Subject=new _t(E.Length(),"ENEMY_STATS"),this.auras=[],this.baseMods=Gt.map(a=>this.Subject.CreateModifier(Xt(a),.1)),this.SetLevel(90)}GetLevel(){return this.Subject.Get(E.LEVEL)}SetLevel(e){return this.Subject.Set(E.LEVEL,e),this}Affected(e){for(const a of this.auras)if(De(a)===e)return!0;return!1}HasAura(e){return this.auras.includes(e)}SetAuras(...e){return this.auras=e,this.Event.Notify(ht.CHANGE_AURA),this}GetAuras(){return this.auras}GetBaseRes(e){const a=this.baseMods.find(n=>n.GetProp()===e);if(!a)throw new Error(`Cannot find the given RES: ${e}`);return a.GetValue()}SetBaseRes(e,a){const n=this.baseMods.find(s=>s.GetProp()===e);if(!n)throw new Error(`Cannot find the given RES: ${e}`);return n.SetValue(a),this.Event.Notify(ht.CHANGE_BASE_RES),this}};function ye(e){const a={level:e.GetLevel(),auras:e.GetAuras(),modifiers:[]};for(const n of Gt){const s=Xt(n),r=e.GetBaseRes(s);a.modifiers.push({stat:s,value:r})}return a}function Jt(e,a){a.SetLevel(e.level),a.SetAuras(...e.auras);for(const{stat:n,value:s}of e.modifiers)a.SetBaseRes(n,s)}var Ln=class{constructor(...e){this.members=new Set,this.observers=new Map,this.updating=!1,e.forEach(a=>this.Add(a))}onChange(e){if(this.updating)return;const a=this.state=ye(e);this.updating=!0;for(const n of this.members)n!==e&&Jt(a,n);this.updating=!1}Add(e){if(this.members.has(e))return!1;const a=this.members.size===0;this.members.add(e),!a&&this.state&&Jt(this.state,e);const n=()=>this.onChange(e);return this.observers.set(e,[e.Subject.CreateObserver(E.LEVEL,n),e.Event.CreateObserver(ht.CHANGE_AURA,n),e.Event.CreateObserver(ht.CHANGE_BASE_RES,n)]),!0}Remove(e){this.members.delete(e);const a=this.observers.get(e);!a||(a.forEach(n=>n.Remove()),this.observers.delete(e))}},Pt=[20,40,50,60,70,80,90];function Zt(e){e<0?e=0:e>90&&(e=90);for(let a=0;a<Pt.length;a++){const n=Pt[a];if(e<=n)return a}return 0}function Rt(e){e<0?e=0:e>90&&(e=90);for(let a=0;a<Pt.length;a++){const n=Pt[a];if(e===n){let s=a+1;return s>6&&(s=6),s}else if(e<=n)return a}return 0}function pn(e){return e<0?e=0:e>6&&(e=6),Pt[e]}var Nn={[E.PYRO_DMG]:3,[E.CRYO_DMG]:2,[E.ELECTRO_DMG]:1};function I_(e){return[...e].sort((n,s)=>{const r=n.Max?1/0:Nn[n.Element]||0;return(s.Max?1/0:Nn[s.Element]||0)-r}).filter(n=>n.Enabled)[0]}var dn={};D(dn,{AmpBonus:()=>jn,AmpType:()=>Qn,CritAvg:()=>xn,CritType:()=>$n,Damage:()=>ts,DamageOptions:()=>Zn,DamageStats:()=>Jn,Def:()=>Wn,QuickenBonus:()=>be,QuickenType:()=>Xn,Res:()=>Un,Rotation:()=>es,TotalStat:()=>Bt,TrBase:()=>te,TrBonus:()=>zn,TrMultiplier:()=>qn});var o={};D(o,{ASCENSION_MULTIPLIER:()=>Gn,AddCharacterScaling:()=>On,AddTalentScaling:()=>vn,BONUS_ASCENSION_MULTIPLIER:()=>Pe,BONUS_STAT_4:()=>Rn,BONUS_STAT_5:()=>In,CHARACTER_ATTRIBUTE_4:()=>Mn,CHARACTER_ATTRIBUTE_5:()=>gn,GetMainstatValue:()=>kn,GetMaxRolls:()=>w_,GetSubstatMax:()=>Be,GetSubstatMaxRolls:()=>we,GetSubstatValue:()=>rt,GetWeaponAtkBase:()=>Yn,GetWeaponSubstat:()=>Fn,SubstatTier:()=>Vn,TRANSFORMATIVE:()=>Cn,TalentScaling:()=>Dn,WEAPON_ATK_BASE:()=>Pn,WEAPON_ATK_BASE_ASCENSION_3:()=>Hn,WEAPON_ATK_BASE_ASCENSION_4:()=>wn,WEAPON_ATK_BASE_ASCENSION_5:()=>Bn,WEAPON_SUBSTAT_INITIAL:()=>Kn,WEAPON_SUBSTAT_SCALING:()=>bn,WeaponScaling:()=>yn});function O_(e){return e}var Cn=[8.5828025,9.267524,9.952427,10.6374515,11.3227,12.3248065,13.3203215,14.4342935,15.6838395,17.0716715,18.6005,20.33,22.223334,24.2817595,26.87424,29.5409485,32.2100235,34.8622275,37.5615685,40.2923875,43.056014,45.851871,48.622314,51.406322,54.2047815,56.600847,59.051453,61.489659,64.863665,68.146455,71.335425,74.5145145,77.7084935,80.9127475,84.5531565,88.2590385,92.0363705,95.854759,99.778454,103.691021,107.69945,112.0828335,116.75108,121.6752865,128.0315335,134.2717465,140.7630375,147.506824,154.533594,161.8007985,168.378771,175.265156,182.2413525,189.3095905,199.3002085,208.199127,217.193498,226.4755255,236.3031085,246.442445,256.7842715,269.551599,282.7552815,296.2693765,312.2217135,325.735074,339.748415,353.89703,368.335711,382.8201155,397.3867015,412.3386985,425.5788905,438.871045,457.1145615,473.373376,489.705693,505.611511,522.395873,538.721834,554.99877,571.4883075,588.1847415,605.0921965,626.9178295,644.4764005,662.742046,681.728464,702.5486885,723.426729,744.1077735,764.2222835,790.1839555,815.423764,855.5988925,890.2269705,923.6614045,955.7371545,986.432171,1015.035904],Mn=[1,1.083,1.165,1.248,1.33,1.413,1.495,1.578,1.661,1.743,1.826,1.908,1.991,2.073,2.156,2.239,2.321,2.404,2.486,2.569,2.651,2.734,2.817,2.899,2.982,3.064,3.147,3.229,3.312,3.394,3.477,3.56,3.642,3.725,3.807,3.89,3.972,4.055,4.138,4.22,4.303,4.385,4.468,4.55,4.633,4.716,4.798,4.881,4.963,5.046,5.128,5.211,5.294,5.376,5.459,5.541,5.624,5.706,5.789,5.872,5.954,6.037,6.119,6.202,6.284,6.367,6.45,6.532,6.615,6.697,6.78,6.862,6.945,7.028,7.11,7.193,7.275,7.358,7.44,7.523,7.606,7.688,7.771,7.853,7.936,8.018,8.101,8.183,8.266,8.349],gn=[1,1.083,1.166,1.25,1.333,1.417,1.5,1.584,1.668,1.751,1.835,1.919,2.003,2.088,2.172,2.256,2.341,2.425,2.51,2.594,2.679,2.764,2.849,2.934,3.019,3.105,3.19,3.275,3.361,3.446,3.532,3.618,3.704,3.789,3.875,3.962,4.048,4.134,4.22,4.307,4.393,4.48,4.567,4.653,4.74,4.827,4.914,5.001,5.089,5.176,5.263,5.351,5.438,5.526,5.614,5.702,5.79,5.878,5.966,6.054,6.142,6.23,6.319,6.407,6.496,6.585,6.673,6.762,6.851,6.94,7.029,7.119,7.208,7.297,7.387,7.476,7.566,7.656,7.746,7.836,7.926,8.016,8.106,8.196,8.286,8.377,8.467,8.558,8.649,8.739],Gn=[38/182,65/182,101/182,128/182,155/182,1],Pe=[0,1,2,2,3,4],Rn={[E.ATK_PERCENT]:.06,[E.HP_PERCENT]:.06,[E.DEF_PERCENT]:.075,[E.PHYSICAL_DMG]:.075,[E.ENERGY_RECHARGE]:.067,[E.ELEMENTAL_MASTERY]:24,[E.PYRO_DMG]:.06,[E.CRYO_DMG]:.06,[E.HYDRO_DMG]:.06,[E.ELECTRO_DMG]:.06,[E.ANEMO_DMG]:.06,[E.GEO_DMG]:.06,[E.DENDRO_DMG]:.06,[E.PHYSICAL_DMG]:.06},In={[E.ATK_PERCENT]:.072,[E.HP_PERCENT]:.072,[E.PHYSICAL_DMG]:0,[E.ENERGY_RECHARGE]:.08,[E.ELEMENTAL_MASTERY]:28.8,[E.HEALING_BONUS]:.055,[E.CRIT_RATE]:.048,[E.CRIT_DMG]:.096,[E.PYRO_DMG]:.072,[E.CRYO_DMG]:.072,[E.HYDRO_DMG]:.072,[E.ELECTRO_DMG]:.072,[E.ANEMO_DMG]:.072,[E.GEO_DMG]:.072,[E.DENDRO_DMG]:.072,[E.PHYSICAL_DMG]:.072};function On(e,a){const n=e.CreateModifier(E.ATK_BASE,0),s=e.CreateModifier(E.DEF_BASE,0),r=e.CreateModifier(E.HP_BASE,0),i=e.CreateModifier(a.StatBonus,0);a.Scaling||(e.Options.Stars===4?a.Scaling=Mn:a.Scaling=gn);const c=a.Scaling,_=()=>{n.SetValue(He(c,a.AtkBase[0],a.AtkBase[1],e.GetLevel(),e.GetAscension())),s.SetValue(He(c,a.DefBase[0],a.DefBase[1],e.GetLevel(),e.GetAscension())),r.SetValue(He(c,a.HpBase[0],a.HpBase[1],e.GetLevel(),e.GetAscension())),i.SetValue(y_(e.Options.Stars,a.StatBonus,e.GetAscension()))};return _(),e.CreateObserver(E.LEVEL,_),e.CreateObserver(E.ASCENSION,_),e}function D_(e,a){return e[a-1]}function v_(e){const a=e-1;return a<0?0:Gn[a]}function He(e,a,n,s,r){return a*D_(e,s)+n*v_(r)}function y_(e,a,n){const s=n-1;return s<0?0:e===4?Rn[a]*Pe[s]:In[a]*Pe[s]}var Dn={NONE:Array.from(Array(15)).fill(1),PHYSICAL_1:[1,1.081,1.163,1.279,1.36,1.453,1.581,1.709,1.837,1.977,2.116,2.256,2.395,2.535,2.674],PHYSICAL_1A:[1,1.081,1.163,1.279,1.36,1.453,1.581,1.709,1.837,1.977,2.137,2.325,2.513,2.701,2.906],PHYSICAL_2:[1,1.068,1.136,1.227,1.295,1.375,1.477,1.58,1.682,1.784,1.886,1.989,2.091,2.193,2.295],ELEMENTAL_1:[1,1.075,1.15,1.25,1.325,1.4,1.5,1.6,1.7,1.8,1.9,2,2.125,2.25,2.375],ELEMENTAL_1A:[1,1.075,1.15,1.25,1.325,1.4,1.5,1.6,1.7,1.8,1.904,2.04,2.176,2.312,2.448],ELEMENTAL_2:[1,1.06,1.12,1.198,1.257,1.317,1.395,1.473,1.551,1.629,1.707,1.784,1.862,1.94,2.018],FLAT_1:[1,1.1,1.208,1.325,1.45,1.583,1.725,1.875,2.033,2.2,2.375,2.559,2.75,2.95,3.159]};function vn(e,a){const n=[],s=e.Base.CreateMv(a.Stat,0),r=()=>{let c=e.Get(a.Talent);c<1?c=1:c>15&&(c=15),s.Value=a.Initial*a.Scaling[c-1]};r();const i=e.Character;switch(n.push(i.CreateObserver(a.Talent,r)),a.Talent){case E.NORMAL_ATTACK_LEVEL:n.push(i.CreateObserver(E.NORMAL_ATTACK_LEVEL_UP,r));break;case E.ELEMENTAL_SKILL_LEVEL:n.push(i.CreateObserver(E.ELEMENTAL_SKILL_LEVEL_UP,r));break;case E.ELEMENTAL_BURST_LEVEL:n.push(i.CreateObserver(E.ELEMENTAL_BURST_LEVEL_UP,r));break}return n}var yn=(e=>(e[e.TYPE_38=0]="TYPE_38",e[e.TYPE_39=1]="TYPE_39",e[e.TYPE_40=2]="TYPE_40",e[e.TYPE_39b=3]="TYPE_39b",e[e.TYPE_41=4]="TYPE_41",e[e.TYPE_42=5]="TYPE_42",e[e.TYPE_44=6]="TYPE_44",e[e.TYPE_45=7]="TYPE_45",e[e.TYPE_44b=8]="TYPE_44b",e[e.TYPE_46=9]="TYPE_46",e[e.TYPE_48=10]="TYPE_48",e[e.TYPE_49=11]="TYPE_49",e))(yn||{}),Pn={[0]:[37.6075,40.13116315789474,42.65482631578948,45.17848947368421,47.70215263157895,50.225815789473685,52.749478947368424,55.27314210526316,57.79680526315789,60.32046842105264,62.84413157894737,65.36779473684211,67.89145789473685,70.41512105263158,72.93878421052631,75.46244736842105,77.9861105263158,80.50977368421053,83.03343684210526,85.5571,87.86808,90.17906,92.49004000000001,94.80102000000001,97.11200000000001,99.42298000000001,101.73396,104.04494,106.35592,108.6669,110.97788,113.28886,115.59984,117.91082,120.2218,122.53278,124.84376,127.15474,129.46572,131.7767,133.97050000000002,136.1643,138.3581,140.5519,142.7457,144.9395,147.1333,149.3271,151.52089999999998,153.7147,155.86208,158.00946,160.15684,162.30422,164.45159999999998,166.59898,168.74636,170.89374,173.04112,175.1885,177.28829000000002,179.38808,181.48787,183.58766,185.68745,187.78724,189.88702999999998,191.98682,194.08661,196.1864,198.26233,200.33826,202.41419,204.49012,206.56605,208.64198,210.71791,212.79384,214.86977,216.9457,218.98907,221.03243999999998,223.07581,225.11918,227.16255,229.20592,231.24929,233.29266,235.33603,237.3794],[1]:[38.7413,41.636700000000005,44.5321,47.4275,50.322900000000004,53.2183,56.1137,59.009100000000004,61.9045,64.79990000000001,67.6953,70.5907,73.4861,76.3815,79.27690000000001,82.1723,85.0677,87.9631,90.85849999999999,93.7539,96.5549,99.3559,102.15690000000001,104.9579,107.7589,110.5599,113.3609,116.1619,118.96289999999999,121.7639,124.5649,127.3659,130.1669,132.9679,135.7689,138.5699,141.3709,144.1719,146.97289999999998,149.7739,152.50678,155.23966,157.97254,160.70542,163.4383,166.17118,168.90406,171.63694,174.36982,177.1027,179.81459,182.52648,185.23837,187.95026,190.66215,193.37403999999998,196.08593,198.79782,201.50970999999998,204.2216,206.90025,209.5789,212.25755,214.9362,217.61485,220.2935,222.97215,225.6508,228.32945,231.0081,233.68512,236.36214,239.03916,241.71618,244.3932,247.07022,249.74724,252.42426,255.10128,257.7783,260.42983,263.08136,265.73289,268.38442000000003,271.03595,273.68748,276.33901000000003,278.99054,281.64207000000005,284.2936],[2]:[39.8751,43.142757894736846,46.41041578947369,49.67807368421053,52.945731578947374,56.21338947368422,59.48104736842105,62.748705263157895,66.01636315789474,69.28402105263157,72.55167894736843,75.81933684210526,79.0869947368421,82.35465263157894,85.62231052631579,88.88996842105263,92.15762631578947,95.42528421052631,98.69294210526316,101.9606,105.248305,108.53601,111.82371499999999,115.11142,118.399125,121.68683,124.974535,128.26224,131.549945,134.83765,138.125355,141.41306,144.700765,147.98847,151.276175,154.56387999999998,157.851585,161.13929,164.426995,167.7147,170.99041,174.26612,177.54183,180.81754,184.09325,187.36896000000002,190.64467,193.92038,197.19609,200.4718,203.74953,207.02726,210.30499,213.58272,216.86045000000001,220.13818,223.41591,226.69364,229.97137,233.2491,236.51284,239.77658,243.04032,246.30406,249.5678,252.83154000000002,256.09528,259.35902,262.62276,265.8865,269.15626000000003,272.42602,275.69578,278.96554,282.2353,285.50506,288.77482,292.04458,295.31433999999996,298.5841,301.84785,305.1116,308.37534999999997,311.6391,314.90285,318.1666,321.43035000000003,324.6941,327.95785,331.2216],[3]:[38.7413,41.636700000000005,44.5321,47.4275,50.322900000000004,53.2183,56.1137,59.009100000000004,61.9045,64.79990000000001,67.6953,70.5907,73.4861,76.3815,79.27690000000001,82.1723,85.0677,87.9631,90.85849999999999,93.7539,96.5549,99.3559,102.15690000000001,104.9579,107.7589,110.5599,113.3609,116.1619,118.96289999999999,121.7639,124.5649,127.3659,130.1669,132.9679,135.7689,138.5699,141.3709,144.1719,146.97289999999998,149.7739,152.52678,155.27966,158.03253999999998,160.78542,163.5383,166.29118,169.04406,171.79693999999998,174.54981999999998,177.3027,180.01459,182.72647999999998,185.43837,188.15026,190.86214999999999,193.57404,196.28593,198.99782000000002,201.70971,204.4216,207.11025,209.7989,212.48755,215.1762,217.86485,220.55349999999999,223.24215,225.9308,228.61945,231.3081,233.99512,236.68214,239.36916,242.05617999999998,244.7432,247.43022,250.11723999999998,252.80425999999997,255.49128,258.1783,260.83983,263.50136,266.16289,268.82442,271.48595,274.14748000000003,276.80901,279.47054,282.13207,284.7936],[4]:[41.0671,44.129842105263165,47.19258421052632,50.255326315789475,53.31806842105264,56.3808105263158,59.44355263157895,62.50629473684211,65.56903684210528,68.63177894736843,71.69452105263159,74.75726315789476,77.8200052631579,80.88274736842106,83.94548947368422,87.00823157894737,90.07097368421054,93.13371578947368,96.19645789473685,99.2592,102.18523,105.11126,108.03729000000001,110.96332000000001,113.88935000000001,116.81538,119.74141,122.66744,125.59347,128.5195,131.44553,134.37156,137.29759,140.22361999999998,143.14965,146.07568,149.00171,151.92774,154.85377,157.7798,160.65627999999998,163.53276,166.40924,169.28572,172.16219999999998,175.03868,177.91516000000001,180.79164,183.66812,186.5446,189.38234,192.22008,195.05782,197.89556,200.73329999999999,203.57103999999998,206.40878,209.24652,212.08426,214.922,217.7351,220.5482,223.3613,226.1744,228.9875,231.8006,234.6137,237.4268,240.2399,243.053,245.86377,248.67454,251.48531,254.29608000000002,257.10685,259.91762,262.72839,265.53916000000004,268.34993000000003,271.1607,273.94095000000004,276.7212,279.50145,282.2817,285.06195,287.8422,290.62244999999996,293.4027,296.18295,298.9632],[5]:[42.401,45.90243157894737,49.40386315789474,52.90529473684211,56.40672631578948,59.908157894736846,63.40958947368421,66.91102105263158,70.41245263157894,73.91388421052632,77.41531578947368,80.91674736842106,84.41817894736842,87.91961052631578,91.42104210526315,94.92247368421053,98.42390526315789,101.92533684210525,105.42676842105263,108.9282,112.42840000000001,115.9286,119.4288,122.929,126.42920000000001,129.9294,133.4296,136.9298,140.43,143.9302,147.4304,150.9306,154.4308,157.93099999999998,161.4312,164.9314,168.4316,171.9318,175.432,178.9322,182.44453,185.95686,189.46919,192.98152,196.49385,200.00618,203.51851,207.03083999999998,210.54317,214.0555,217.55782,221.06014,224.56246,228.06477999999998,231.56709999999998,235.06941999999998,238.57174,242.07406,245.57638,249.0787,252.57677999999999,256.07486,259.57294,263.07102,266.5691,270.06718,273.56526,277.06334000000004,280.56142,284.0595,287.57182,291.08414,294.59646000000004,298.10878,301.6211,305.13342,308.64574,312.15806000000003,315.67038,319.1827,322.68503,326.18736,329.68969000000004,333.19202,336.69435,340.19668,343.69901000000004,347.20134,350.70367,354.206],[6]:[43.7349,47.67334210526316,51.61178421052632,55.55022631578947,59.48866842105264,63.42711052631579,67.36555263157895,71.30399473684211,75.24243684210526,79.18087894736843,83.11932105263159,87.05776315789474,90.99620526315789,94.93464736842105,98.87308947368422,102.81153157894738,106.74997368421053,110.68841578947368,114.62685789473684,118.5653,122.64139499999999,126.71749,130.793585,134.86968,138.945775,143.02187,147.097965,151.17406,155.250155,159.32625000000002,163.402345,167.47844,171.554535,175.63063,179.706725,183.78282000000002,187.858915,191.93501,196.011105,200.0872,204.23452,208.38183999999998,212.52916,216.67648,220.8238,224.97111999999998,229.11844,233.26576,237.41307999999998,241.5604,245.72395999999998,249.88752,254.05108,258.21464000000003,262.3782,266.54176,270.70532000000003,274.86888,279.03244,283.196,287.38581000000005,291.57562,295.76543000000004,299.95524,304.14505,308.33486000000005,312.52467,316.71448000000004,320.90429,325.0941,329.30702,333.51994,337.73286,341.94578,346.1587,350.37162,354.58454,358.79746,363.01038,367.2233,371.43934,375.65538,379.87142,384.08745999999996,388.3035,392.51954,396.73557999999997,400.95162,405.16765999999996,409.3837],[7]:[45.0687,49.44510526315789,53.82151052631579,58.19791578947368,62.574321052631575,66.95072631578947,71.32713157894736,75.70353684210527,80.07994210526316,84.45634736842105,88.83275263157896,93.20915789473685,97.58556315789474,101.96196842105263,106.33837368421052,110.71477894736842,115.09118421052631,119.4675894736842,123.84399473684209,128.2204,132.87149000000002,137.52258,142.17367000000002,146.82476,151.47585,156.12694,160.77803,165.42912,170.08021,174.7313,179.38239,184.03348,188.68457,193.33566000000002,197.98675,202.63783999999998,207.28893,211.94002,216.59111000000001,221.2422,226.02498,230.80776,235.59054,240.37332,245.15609999999998,249.93887999999998,254.72165999999999,259.50444,264.28722,269.07,273.89686,278.72372,283.55057999999997,288.37744,293.2043,298.03116,302.85802,307.68487999999996,312.51174,317.3386,322.21052,327.08243999999996,331.95436,336.82628,341.6982,346.57012,351.44203999999996,356.31396,361.18588,366.0578,370.97578,375.89376,380.81174,385.72972,390.6477,395.56568,400.48366,405.40164,410.31962,415.2376,420.17714,425.11668,430.05622,434.99575999999996,439.9353,444.87484,449.81437999999997,454.75392,459.69345999999996,464.633],[8]:[44.3358,47.80099473684211,51.26618947368421,54.731384210526315,58.196578947368415,61.66177368421052,65.12696842105262,68.59216315789473,72.05735789473684,75.52255263157895,78.98774736842105,82.45294210526315,85.91813684210526,89.38333157894735,92.84852631578946,96.31372105263156,99.77891578947367,103.24411052631578,106.70930526315789,110.1745,113.601655,117.02881,120.45596499999999,123.88311999999999,127.31027499999999,130.73743,134.164585,137.59174,141.018895,144.44605,147.87320499999998,151.30036,154.72751499999998,158.15467,161.581825,165.00898,168.436135,171.86329,175.290445,178.7176,182.17136,185.62512,189.07888,192.53264000000001,195.9864,199.44016,202.89392,206.34768,209.80144,213.2552,216.74556,220.23592,223.72628,227.21664,230.707,234.19736,237.68772,241.17808000000002,244.66844,248.1588,251.6835,255.2082,258.73290000000003,262.2576,265.7823,269.307,272.8317,276.3564,279.8811,283.4058,286.97039,290.53498,294.09956999999997,297.66416,301.22875,304.79334,308.35793,311.92251999999996,315.48711,319.0517,322.66951,326.28731999999997,329.90513,333.52294,337.14075,340.75856,344.37637,347.99418000000003,351.61199,355.2298],[9]:[45.9364,49.92561578947368,53.914831578947364,57.90404736842105,61.89326315789474,65.88247894736841,69.8716947368421,73.86091052631579,77.85012631578947,81.83934210526316,85.82855789473683,89.81777368421052,93.80698947368421,97.79620526315789,101.78542105263158,105.77463684210525,109.76385263157894,113.75306842105263,117.74228421052632,121.7315,125.849695,129.96789,134.086085,138.20428,142.322475,146.44067,150.558865,154.67706,158.795255,162.91345,167.031645,171.14984,175.268035,179.38623,183.50442500000003,187.62262,191.740815,195.85901,199.97720500000003,204.0954,208.30777,212.52014,216.73251000000002,220.94488,225.15725,229.36962,233.58199,237.79435999999998,242.00673,246.2191,250.51037,254.80164,259.09291,263.38418,267.67545,271.96672,276.25799,280.54926,284.84053,289.1318,293.47739,297.82298,302.16857,306.51416,310.85974999999996,315.20534,319.55093,323.89652,328.24210999999997,332.5877,337.00219,341.41668,345.83117,350.24566,354.66015,359.07464,363.48913,367.90362,372.31811,376.7326,381.2068,385.681,390.1552,394.6294,399.10360000000003,403.5778,408.052,412.5262,417.0004,421.4746],[10]:[47.537,52.05051052631579,56.564021052631574,61.077531578947365,65.59104210526316,70.10455263157894,74.61806315789474,79.13157368421052,83.6450842105263,88.1585947368421,92.6721052631579,97.18561578947367,101.69912631578947,106.21263684210527,110.72614736842104,115.23965789473684,119.75316842105264,124.2666789473684,128.7801894736842,133.2937,138.10207,142.91044,147.71881,152.52718,157.33555,162.14391999999998,166.95229,171.76066,176.56903,181.3774,186.18577,190.99414,195.80250999999998,200.61088,205.41924999999998,210.22762,215.03598999999997,219.84436,224.65273,229.4611,234.43822,239.41534,244.39246,249.36957999999998,254.3467,259.32382,264.30094,269.27806,274.25518,279.2323,284.31925,289.4062,294.49315,299.5801,304.66705,309.754,314.84095,319.9279,325.01485,330.1018,335.27383000000003,340.44586000000004,345.61789,350.78992,355.96195,361.13398,366.30601,371.47803999999996,376.65006999999997,381.8221,387.07493999999997,392.32777999999996,397.58062,402.83346,408.0863,413.33914,418.59198,423.84482,429.09766,434.3505,439.6889,445.0273,450.3657,455.70410000000004,461.0425,466.3809,471.71930000000003,477.0577,482.39610000000005,487.7345],[11]:[49.1377,54.17819473684211,59.218689473684215,64.25918421052631,69.29967894736842,74.34017368421053,79.38066842105263,84.42116315789474,89.46165789473685,94.50215263157895,99.54264736842106,104.58314210526316,109.62363684210527,114.66413157894738,119.70462631578948,124.74512105263159,129.7856157894737,134.8261105263158,139.8666052631579,144.9071,150.40315,155.8992,161.39525,166.8913,172.38735000000003,177.8834,183.37945000000002,188.87550000000002,194.37155,199.8676,205.36365,210.8597,216.35575,221.85180000000003,227.34785,232.84390000000002,238.33995,243.836,249.33205,254.8281,260.56738,266.30666,272.04594,277.78522,283.5245,289.26378,295.00306,300.74233999999996,306.48161999999996,312.2209,318.10776999999996,323.99464,329.88151,335.76838,341.65525,347.54212,353.42899,359.31586,365.20273000000003,371.0896,377.07949,383.06938,389.05927,395.04916000000003,401.03905,407.02894000000003,413.01883,419.00872,424.99861,430.9885,437.09139999999996,443.1943,449.2972,455.4001,461.503,467.6059,473.7088,479.8117,485.9146,492.0175,498.21376999999995,504.41004,510.60631,516.80258,522.99885,529.19512,535.39139,541.5876599999999,547.7839299999999,553.9802]},Hn=19.5,wn=25.9,Bn=31.1,bn=[1,1.040341234845879,1.0806824696917579,1.1210237045376368,1.1613649393835157,1.2017061742293946,1.2420474090752736,1.2823886439211527,1.3227298787670316,1.3630711136129106,1.4034123484587895,1.4437535833046684,1.4840948181505473,1.5244360529964263,1.5647772878423054,1.6051185226881843,1.6454597575340633,1.6858009923799422,1.7261422272258211,1.7664834620717,1.806904148964199,1.847324835856698,1.887745522749197,1.928166209641696,1.968586896534195,2.009007583426694,2.049428270319193,2.089848957211692,2.130269644104191,2.17069033099669,2.211111017889189,2.251531704781688,2.291952391674187,2.332373078566686,2.372793765459185,2.413214452351684,2.453635139244183,2.494055826136682,2.534476513029181,2.57489719992168,2.615292358123214,2.655687516324748,2.696082674526282,2.7364778327278163,2.77687299092935,2.817268149130884,2.8576633073324182,2.898058465533952,2.9384536237354864,2.97884878193702,3.0192357768865152,3.0596227718360103,3.1000097667855053,3.1403967617350004,3.1807837566844954,3.22117075163399,3.261557746583485,3.30194474153298,3.342331736482475,3.38271873143197,3.423020746682514,3.463322761933058,3.503624777183602,3.543926792434146,3.58422880768469,3.624530822935234,3.664832838185778,3.705134853436322,3.745436868686866,3.78573888393741,3.82613895285716,3.86653902177691,3.90693909069666,3.94733915961641,3.98773922853616,4.02813929745591,4.06853936637566,4.10893943529541,4.14933950421516,4.18973957313491,4.230135108674366,4.270530644213822,4.310926179753277,4.351321715292734,4.3917172508321904,4.432112786371646,4.472508321911102,4.512903857450558,4.553299392990015,4.59369492852947],Kn={[0]:{[E.ATK_PERCENT]:.10213,[E.HP_PERCENT]:.10213,[E.DEF_PERCENT]:.12747,[E.ELEMENTAL_MASTERY]:40.8,[E.ENERGY_RECHARGE]:.11333,[E.CRIT_RATE]:.068,[E.CRIT_DMG]:.136,[E.PHYSICAL_DMG]:.12747},[1]:{[E.ATK_PERCENT]:.0766,[E.HP_PERCENT]:.0766,[E.DEF_PERCENT]:.0956,[E.ELEMENTAL_MASTERY]:30.6,[E.ENERGY_RECHARGE]:.085,[E.CRIT_RATE]:.051,[E.CRIT_DMG]:.102,[E.PHYSICAL_DMG]:.0956},[3]:{[E.ATK_PERCENT]:.0766,[E.HP_PERCENT]:.0766,[E.DEF_PERCENT]:.0956,[E.ELEMENTAL_MASTERY]:30.6,[E.ENERGY_RECHARGE]:.085,[E.CRIT_RATE]:.051,[E.CRIT_DMG]:.102,[E.PHYSICAL_DMG]:.0956},[2]:{[E.ATK_PERCENT]:.05107,[E.HP_PERCENT]:.05107,[E.DEF_PERCENT]:.06373,[E.ELEMENTAL_MASTERY]:20.4,[E.ENERGY_RECHARGE]:.05667,[E.CRIT_RATE]:.034,[E.CRIT_DMG]:.068,[E.PHYSICAL_DMG]:.06373},[4]:{[E.ATK_PERCENT]:.12,[E.HP_PERCENT]:.12,[E.DEF_PERCENT]:.15013,[E.ELEMENTAL_MASTERY]:48,[E.ENERGY_RECHARGE]:.13333,[E.CRIT_RATE]:.08,[E.CRIT_DMG]:.16,[E.PHYSICAL_DMG]:.15013},[5]:{[E.ATK_PERCENT]:.09,[E.HP_PERCENT]:.09,[E.DEF_PERCENT]:.1126,[E.ELEMENTAL_MASTERY]:36,[E.ENERGY_RECHARGE]:.1,[E.CRIT_RATE]:.06,[E.CRIT_DMG]:.12,[E.PHYSICAL_DMG]:.1126},[6]:{[E.ATK_PERCENT]:.06,[E.HP_PERCENT]:.06,[E.DEF_PERCENT]:.0751,[E.ELEMENTAL_MASTERY]:24,[E.ENERGY_RECHARGE]:.0667,[E.CRIT_RATE]:.04,[E.CRIT_DMG]:.08,[E.PHYSICAL_DMG]:.0751},[8]:{[E.ATK_PERCENT]:.144,[E.HP_PERCENT]:.144,[E.DEF_PERCENT]:.18,[E.ELEMENTAL_MASTERY]:57.6,[E.ENERGY_RECHARGE]:.16,[E.CRIT_RATE]:.096,[E.CRIT_DMG]:.192,[E.PHYSICAL_DMG]:.18},[7]:{[E.ATK_PERCENT]:.03,[E.HP_PERCENT]:.03,[E.DEF_PERCENT]:.03753,[E.ELEMENTAL_MASTERY]:12,[E.ENERGY_RECHARGE]:.03333,[E.CRIT_RATE]:.02,[E.CRIT_DMG]:.04,[E.PHYSICAL_DMG]:.03753},[9]:{[E.ATK_PERCENT]:.108,[E.HP_PERCENT]:.108,[E.DEF_PERCENT]:.135,[E.ELEMENTAL_MASTERY]:43.2,[E.ENERGY_RECHARGE]:.12,[E.CRIT_RATE]:.072,[E.CRIT_DMG]:.144,[E.PHYSICAL_DMG]:.135},[10]:{[E.ATK_PERCENT]:.072,[E.HP_PERCENT]:.072,[E.DEF_PERCENT]:.09,[E.ELEMENTAL_MASTERY]:28.8,[E.ENERGY_RECHARGE]:.08,[E.CRIT_RATE]:.048,[E.CRIT_DMG]:.096,[E.PHYSICAL_DMG]:.09},[11]:{[E.ATK_PERCENT]:.036,[E.HP_PERCENT]:.036,[E.DEF_PERCENT]:.045,[E.ELEMENTAL_MASTERY]:14.4,[E.ENERGY_RECHARGE]:.04,[E.CRIT_RATE]:.024,[E.CRIT_DMG]:.048,[E.PHYSICAL_DMG]:.045}};function Yn(e,a,n,s){if(n<1||n>90)throw new Error("Weapon level must be between 1 and 90");if(s<0||s>6)throw new Error("Weapon ascension must be between 0 and 6");let r;if(e===5)r=Bn;else if(e===4)r=wn;else if(e===3)r=Hn;else throw new Error("Weapon stars must be 3, 4 or 5.");return Pn[a][n-1]+r*s}function Fn(e,a,n){const s=bn[a-1];return(Kn[e][n]||0)*s}function kn(e,a,n){return e===5?P_[a][n]:H_[a][n]}var P_={[E.HP_FLAT]:[717,920,1123,1326,1530,1733,1936,2139,2342,2545,2749,2952,3155,3358,3561,3764,3967,4171,4374,4577,4780],[E.HP_PERCENT]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.ATK_FLAT]:[47,60,73,86,100,113,126,139,152,166,179,192,205,219,232,245,258,272,285,298,311],[E.ATK_PERCENT]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.DEF_PERCENT]:[.087,.112,.137,.162,.186,.211,.236,.261,.286,.31,.335,.36,.385,.409,.434,.459,.484,.508,.533,.558,.583],[E.CRIT_RATE]:[.047,.06,.073,.086,.099,.113,.126,.139,.152,.166,.179,.192,.205,.218,.232,.245,.258,.271,.284,.298,.311],[E.CRIT_DMG]:[.093,.12,.146,.173,.199,.225,.252,.278,.305,.331,.357,.384,.41,.437,.463,.49,.516,.542,.569,.595,.622],[E.ENERGY_RECHARGE]:[.078,.1,.122,.144,.166,.188,.21,.232,.254,.276,.298,.32,.342,.364,.386,.408,.43,.452,.474,.496,.518],[E.HEALING_BONUS]:[.054,.069,.084,.1,.115,.13,.145,.161,.176,.191,.206,.221,.237,.252,.267,.282,.298,.313,.328,.343,.359],[E.ELEMENTAL_MASTERY]:[28,35.9,43.8,51.8,59.7,67.6,75.5,83.5,91.4,99.3,107.2,115.2,123.1,131,138.9,146.9,154.8,162.7,170.6,178.6,186.5],[E.ANEMO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.GEO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.CRYO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.PYRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.HYDRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.ELECTRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.DENDRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.PHYSICAL_DMG]:[.087,.112,.137,.162,.186,.211,.236,.261,.286,.31,.335,.36,.385,.409,.434,.459,.484,.508,.533,.558,.583]},H_={[E.HP_FLAT]:[645,828,1011,1194,1377,1559,1742,1925,2108,2291,2474,2657,2839,3022,3205,3388,3571],[E.HP_PERCENT]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.ATK_FLAT]:[42,54,66,78,90,102,113,125,137,149,161,173,185,197,209,221,232],[E.ATK_PERCENT]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.DEF_PERCENT]:[.079,.101,.123,.146,.168,.19,.212,.235,.257,.279,.302,.324,.346,.368,.391,.413,.435],[E.CRIT_RATE]:[.042,.054,.066,.078,.09,.101,.113,.125,.137,.149,.161,.173,.185,.197,.208,.22,.232],[E.CRIT_DMG]:[.084,.108,.131,.155,.179,.203,.227,.25,.274,.298,.322,.345,.369,.393,.417,.441,.464],[E.ENERGY_RECHARGE]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387],[E.HEALING_BONUS]:[.048,.062,.076,.09,.103,.117,.131,.144,.158,.172,.186,.199,.213,.227,.24,.254,.268],[E.ELEMENTAL_MASTERY]:[25.2,32.3,39.4,46.6,53.7,60.8,68,75.1,82.2,89.4,96.5,103.6,110.8,117.9,125,132.2,139.3],[E.ANEMO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.CRYO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.ELECTRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.GEO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.HYDRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.PYRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.DENDRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.PHYSICAL_DMG]:[.079,.101,.123,.146,.168,.19,.212,.235,.257,.279,.302,.324,.346,.368,.391,.413,.435]},Vn=(e=>(e[e.ROLL_1=0]="ROLL_1",e[e.ROLL_2=1]="ROLL_2",e[e.ROLL_3=2]="ROLL_3",e[e.ROLL_4=3]="ROLL_4",e[e.ROLL_AVG=4]="ROLL_AVG",e[e.ROLL_MIN=0]="ROLL_MIN",e[e.ROLL_MAX=3]="ROLL_MAX",e))(Vn||{});function rt(e,a,n){return e===4?n===4?(wt[a][0]+wt[a][1]+wt[a][2]+wt[a][3])/4:wt[a][n]:e===5?n===4?(Ht[a][0]+Ht[a][1]+Ht[a][2]+Ht[a][3])/4:Ht[a][n]:0}function we(e){return e===4?4:e===5?6:0}function w_(e){return e===4?7:e===5?9:0}function Be(e,a){return we(e)*rt(e,a,3)}var Ht={[E.HP_FLAT]:[209.13,239,268.88,298.75],[E.HP_PERCENT]:[.0408,.0466,.0525,.0583],[E.ATK_FLAT]:[13.62,15.56,17.51,19.45],[E.ATK_PERCENT]:[.0408,.0466,.0525,.0583],[E.PYRO_DMG]:[.0408,.0466,.0525,.0583],[E.CRYO_DMG]:[.0408,.0466,.0525,.0583],[E.HYDRO_DMG]:[.0408,.0466,.0525,.0583],[E.ELECTRO_DMG]:[.0408,.0466,.0525,.0583],[E.ANEMO_DMG]:[.0408,.0466,.0525,.0583],[E.GEO_DMG]:[.0408,.0466,.0525,.0583],[E.DENDRO_DMG]:[.0408,.0466,.0525,.0583],[E.PHYSICAL_DMG]:[.051,.0583,.0656,.0729],[E.HEALING_BONUS]:[.03143,.03589799019607843,.040443014705882345,.044911004901960774],[E.DEF_FLAT]:[16.2,18.52,20.83,23.15],[E.DEF_PERCENT]:[.051,.0583,.0656,.0729],[E.CRIT_RATE]:[.0272,.0311,.035,.0389],[E.CRIT_DMG]:[.0544,.0622,.0699,.0777],[E.ENERGY_RECHARGE]:[.0453,.0518,.0583,.0648],[E.ELEMENTAL_MASTERY]:[16.32,18.65,20.98,23.31]},wt={[E.HP_FLAT]:[167.3,191.2,215.1,239],[E.HP_PERCENT]:[.0326,.0373,.042,.0466],[E.ATK_FLAT]:[10.89,12.45,14,15.56],[E.ATK_PERCENT]:[.0326,.0373,.042,.0466],[E.PYRO_DMG]:[.0326,.0373,.042,.0466],[E.CRYO_DMG]:[.0326,.0373,.042,.0466],[E.HYDRO_DMG]:[.0326,.0373,.042,.0466],[E.ELECTRO_DMG]:[.0326,.0373,.042,.0466],[E.ANEMO_DMG]:[.0326,.0373,.042,.0466],[E.GEO_DMG]:[.0326,.0373,.042,.0466],[E.DENDRO_DMG]:[.0326,.0373,.042,.0466],[E.PHYSICAL_DMG]:[.0408,.0466,.0525,.0583],[E.HEALING_BONUS]:[.0251,.02866813725490196,.032297794117647056,.035865931372549016],[E.DEF_FLAT]:[12.96,14.82,16.67,18.52],[E.DEF_PERCENT]:[.0408,.0466,.0525,.0583],[E.CRIT_RATE]:[.0218,.0249,.028,.0311],[E.CRIT_DMG]:[.0435,.0497,.056,.0622],[E.ENERGY_RECHARGE]:[.0363,.0414,.0466,.0518],[E.ELEMENTAL_MASTERY]:[13.06,14.92,16.79,18.65]};function Bt(e,a,n){return e*(1+a)+n}function xn(e,a){return e>1?e=1:e<0&&(e=0),1+e*a}function Un(e){return e<0?1-e/2:e<.75?1-e:1/(4*e+1)}function Wn(e,a,n,s){return(e+100)/((1-n)*(1-s)*(a+100)+e+100)}function jn(e){return 2.78*e/(e+1400)}function zn(e){return 16*e/(e+2e3)}function be(e){return 5*e/(e+1200)}function te(e){return Cn[e-1]}function qn(e){switch(e){case E.BURGEON_DMG:return 6;case E.HYPERBLOOM_DMG:return 6;case E.OVERLOAD_DMG:return 4;case E.BLOOM_DMG:return 4;case E.SHATTER_DMG:return 3;case E.ELECTROCHARGE_DMG:return 2.4;case E.SWIRL_DMG:return 1.2;case E.SUPERCONDUCT_DMG:return 1;case E.BURNING_DMG:return .5;case E.AGGRAVATE_DMG:return 2.3;case E.SPREAD_DMG:return 2.5}return 0}var $n=(e=>(e[e.NO_CRIT=0]="NO_CRIT",e[e.CRIT=1]="CRIT",e[e.CRIT_AVG=2]="CRIT_AVG",e))($n||{}),Qn=(e=>(e[e.AMP_STRONG=2]="AMP_STRONG",e[e.AMP_WEAK=1.5]="AMP_WEAK",e[e.AMP_NONE=0]="AMP_NONE",e))(Qn||{}),Xn=(e=>(e[e.QUICKEN_STRONG=2.5]="QUICKEN_STRONG",e[e.QUICKEN_WEAK=2.3]="QUICKEN_WEAK",e[e.QUICKEN_NONE=0]="QUICKEN_NONE",e))(Xn||{});function Jn(e){return b({Char:0,Enemy:0,Base:0,Dmg:0,Critrate:0,Critdmg:0,Em:0,Res:0,Ignored:0,Reduced:0,Quicken:0,Amp:0,Tr:0},e)}function Zn(e){return b({Base:!1,Def:!1,Res:!1,Dmg:!1,Crit:0,Quicken:0,Tr:0,Amp:0},e)}function ts(e,a){let n=0;a.Base&&(n=e.Base);const s=qn(a.Tr);return n+=s*te(e.Char),s===0&&a.Quicken>0&&(n+=a.Quicken*te(e.Char)*(1+be(e.Em)+e.Quicken)),a.Dmg&&(n*=1+e.Dmg),s>0&&(n*=1+zn(e.Em)+e.Tr,a.Quicken>0&&(n+=a.Quicken*te(e.Char)*(1+be(e.Em)+e.Quicken))),a.Crit===1?n*=1+e.Critdmg:a.Crit===2&&(n*=xn(e.Critrate,e.Critdmg)),a.Def&&(n*=Wn(e.Char,e.Enemy,e.Ignored,e.Reduced)),a.Res&&(n*=Un(e.Res)),a.Amp>0&&(n*=a.Amp*(1+jn(e.Em)+e.Amp)),n}function es(e,a,n,s,r,i){const c=r;let _=0;r>0&&(_=i/r);let u=e*(1-c)*(1-_);return u+=a*(1-c)*_,u+=n*c*(1-_),u+=s*c*_,u}function B_(e,a){switch(a){case E.ATK:return Bt(e.Get(E.ATK_BASE),e.Get(E.ATK_PERCENT),e.Get(E.ATK_FLAT));case E.HP:return Bt(e.Get(E.HP_BASE),e.Get(E.HP_PERCENT),e.Get(E.HP_FLAT));case E.DEF:return Bt(e.Get(E.DEF_BASE),e.Get(E.DEF_PERCENT),e.Get(E.DEF_FLAT));case E.NORMAL_ATTACK_LEVEL:return e.Get(E.NORMAL_ATTACK_LEVEL)+e.Get(E.NORMAL_ATTACK_LEVEL_UP);case E.ELEMENTAL_SKILL_LEVEL:return e.Get(E.ELEMENTAL_SKILL_LEVEL)+e.Get(E.ELEMENTAL_SKILL_LEVEL_UP);case E.ELEMENTAL_BURST_LEVEL:return e.Get(E.ELEMENTAL_BURST_LEVEL)+e.Get(E.ELEMENTAL_BURST_LEVEL_UP);case E.CHARGED_AIMED_SHOT_DMG:return e.Get(E.CHARGED_AIMED_SHOT_DMG)+e.Get(E.CHARGED_ATTACK_DMG)+e.Get(E.AIMED_SHOT_DMG);case E.CHARGED_AIMED_SHOT_ATK_FLAT:return e.Get(E.CHARGED_AIMED_SHOT_ATK_FLAT)+e.Get(E.CHARGED_ATTACK_ATK_FLAT)+e.Get(E.AIMED_SHOT_ATK_FLAT);case E.CHARGED_AIMED_SHOT_ATK_PERCENT:return e.Get(E.CHARGED_AIMED_SHOT_ATK_PERCENT)+e.Get(E.CHARGED_ATTACK_ATK_PERCENT)+e.Get(E.AIMED_SHOT_ATK_PERCENT);case E.CHARGED_AIMED_SHOT_CRIT_DMG:return e.Get(E.CHARGED_AIMED_SHOT_CRIT_DMG)+e.Get(E.CHARGED_ATTACK_CRIT_DMG)+e.Get(E.AIMED_SHOT_CRIT_DMG);case E.CHARGED_AIMED_SHOT_CRIT_RATE:return e.Get(E.CHARGED_AIMED_SHOT_CRIT_RATE)+e.Get(E.CHARGED_ATTACK_CRIT_RATE)+e.Get(E.AIMED_SHOT_CRIT_RATE);case E.CHARGED_AIMED_SHOT_DMG_FLAT:return e.Get(E.CHARGED_AIMED_SHOT_DMG_FLAT)+e.Get(E.CHARGED_ATTACK_DMG_FLAT)+e.Get(E.AIMED_SHOT_DMG_FLAT);default:return e.Get(a)}}function b_(e,a,n){let s,r,i,c;switch(a){case E.ATK:throw new Error("Cannot set Total ATK directly.");case E.HP:throw new Error("Cannot set Total HP directly.");case E.DEF:throw new Error("Cannot set Total DEF directly");case E.NORMAL_ATTACK_LEVEL:{const _=e.Get(E.NORMAL_ATTACK_LEVEL_UP);n=Math.max(1+_,Math.floor(n)),e.Set(E.NORMAL_ATTACK_LEVEL,n-_);break}case E.ELEMENTAL_SKILL_LEVEL:{const _=e.Get(E.ELEMENTAL_SKILL_LEVEL_UP);n=Math.max(1+_,Math.floor(n)),e.Set(E.ELEMENTAL_SKILL_LEVEL,n-_);break}case E.ELEMENTAL_BURST_LEVEL:{const _=e.Get(E.ELEMENTAL_BURST_LEVEL_UP);n=Math.max(1+_,Math.floor(n)),e.Set(E.ELEMENTAL_BURST_LEVEL,n-_);break}case E.LEVEL:n>90?n=90:n<1&&(n=1),n=Math.floor(n),r=Zt(n),i=Rt(n),c=e.Get(E.ASCENSION),c<r?c=r:c>i&&(c=i),e.Set(E.ASCENSION,c),e.Set(E.LEVEL,n);break;case E.ASCENSION:s=e.Get(E.LEVEL),r=Zt(s),i=Rt(s),c=Math.floor(n),c<r?c=r:c>i&&(c=i),e.Set(E.ASCENSION,c);break;case E.HP_CURRENT:case E.ENERGY_CURRENT:n=Math.max(0,Math.min(1,n)),e.Set(a,n);break;default:e.Set(a,n);break}}var Ke=class{constructor(e){if(this.Subject=new _t(E.Length(),"CHARACTER_STATS"),this.infusions=[],this.MapCritRate=a=>a,e.Stars!==4&&e.Stars!==5)throw new Error("Character stars must be 4 or 5.");this.Options=e,this.Subject.Set(E.LEVEL,1),this.Subject.Set(E.ASCENSION,0),this.Subject.Set(E.ENERGY_RECHARGE,1),this.Subject.Set(E.CRIT_RATE,.05),this.Subject.Set(E.CRIT_DMG,.5),this.Subject.Set(E.NORMAL_ATTACK_LEVEL,1),this.Subject.Set(E.ELEMENTAL_SKILL_LEVEL,1),this.Subject.Set(E.ELEMENTAL_BURST_LEVEL,1),this.Subject.Set(E.HP_CURRENT,1),this.Subject.Set(E.ENERGY_CURRENT,1),this.enemy=new fn(e.Name)}GetEnemy(){return this.enemy}IsShielded(){return this.Subject.Get(E.SHIELDED)===1}SetShield(e){return this.Subject.Set(E.SHIELDED,e===!0?1:0),this}GetLevel(){return this.Subject.Get(E.LEVEL)}SetLevel(e){return this.Set(E.LEVEL,e)}GetAscension(){return this.Subject.Get(E.ASCENSION)}SetAscension(e){return this.Set(E.ASCENSION,e)}IsAscended(){return this.GetAscension()===Rt(this.GetLevel())}Set(e,a){return b_(this.Subject,e,a),this}CreateModifier(e,a){return this.Subject.CreateModifier(e,a)}CreateObserver(e,a){return this.Subject.CreateObserver(e,a)}Get(e){return B_(this.Subject,e)}AddInfusion(e,a){const n={Enabled:!0,Element:e,Max:a,Remove:()=>this.RemoveInfusion(n)};return this.infusions.push(n),n}RemoveInfusion(e){const a=this.infusions.indexOf(e);return a===-1?!1:(this.infusions.splice(a,1),!0)}GetInfusion(){return I_(this.infusions)}};function as(e){return{level:e.GetLevel(),ascension:e.GetAscension(),hp:e.Get(E.HP_CURRENT),energy:e.Get(E.ENERGY_CURRENT),shielded:e.Get(E.SHIELDED)===1,talents:[e.Get(E.NORMAL_ATTACK_LEVEL),e.Get(E.ELEMENTAL_SKILL_LEVEL),e.Get(E.ELEMENTAL_BURST_LEVEL)],enemy:ye(e.GetEnemy())}}function ns(e,a){a.SetLevel(e.level),a.SetAscension(e.ascension),a.Set(E.NORMAL_ATTACK_LEVEL,e.talents[0]),a.Set(E.ELEMENTAL_SKILL_LEVEL,e.talents[1]),a.Set(E.ELEMENTAL_BURST_LEVEL,e.talents[2]),a.Set(E.HP_CURRENT,e.hp),a.Set(E.ENERGY_CURRENT,e.energy),a.Set(E.SHIELDED,e.shielded?1:0),Jt(e.enemy,a.GetEnemy())}var G={};D(G,{Charbox:()=>ee,CharboxEvent:()=>ut,Export:()=>zs,ExportParty:()=>$s,Factory:()=>F_,Import:()=>qs,ImportParty:()=>qe,Party:()=>au});var ut=ct("CHANGE_PARTY"),Q=class{constructor(e){this.getName=e,this.list=[],this.map=new Map}AddList(e){for(const a of e)this.Add(a)}Add(e){const a=this.getName(e).toLowerCase();return this.map.has(a)?!1:(this.list.push(e),this.map.set(a,e),!0)}Has(e){return this.map.has(this.getName(e).toLowerCase())}Remove(e){const a=this.getName(e).toLowerCase(),n=this.list.indexOf(e);return n>=0&&this.list.splice(n,1),this.map.delete(a)}Clear(){this.list.splice(0,this.list.length),this.map.clear()}Find(e){return this.map.get(e.toLowerCase())}Get(){return this.list}},ee=class{constructor(e){this.character=e,this.normals=new Q(a=>a.Options.Name),this.skills=new Q(a=>a.Options.Name),this.bursts=new Q(a=>a.Options.Name),this.tr=new Q(a=>a.Options.Name),this.extra=new Q(a=>a.Options.Name),this.effects=new Q(a=>a.Options.Name),this.modifiers=[],this.uniqueModifiers=new Map,this.allModifiers=[],this.Event=new _t(ut.Length(),"CHARBOX_EVENT")}static create(e){const a=new ee(e.character);return a.normals.AddList(e.normals),a.skills.AddList(e.skills),a.bursts.AddList(e.bursts),a.tr.AddList(e.tr),a.extra.AddList(e.extra),a.effects.AddList(e.effects),a}GetParty(){return this.party}SetParty(e){this.party=e}GetWeapon(){return this.weapon}SetWeapon(e){return this.weapon&&this.weapon.Unequip(),e?this.weapon=e(this):this.weapon=void 0,this}GetCharacter(){return this.character}GetNormals(){return this.normals.Get()}FindNormal(e){return this.normals.Find(e)}AddNormal(e){return this.normals.Add(e)}RemoveNormal(e){return this.normals.Remove(e)}GetSkills(){return this.skills.Get()}FindSkill(e){return this.skills.Find(e)}AddSkill(e){return this.skills.Add(e)}RemoveSkill(e){return this.skills.Remove(e)}GetBursts(){return this.bursts.Get()}FindBurst(e){return this.bursts.Find(e)}AddBurst(e){return this.bursts.Add(e)}RemoveBurst(e){return this.bursts.Remove(e)}GetTr(){return this.tr.Get()}FindTr(e){return this.tr.Find(e)}GetExtra(){return this.extra.Get()}FindExtra(e){return this.extra.Find(e)}AddExtra(e){return this.extra.Add(e)}RemoveExtra(e){return this.extra.Remove(e)}AddInstance(e,a){switch(e){case"Extra":return this.AddExtra(a);case"Normal":return this.AddNormal(a);case"Skill":return this.AddSkill(a);case"Burst":return this.AddBurst(a)}}RemoveInstance(e,a){switch(e){case"Extra":return this.RemoveExtra(a);case"Normal":return this.RemoveNormal(a);case"Skill":return this.RemoveSkill(a);case"Burst":return this.RemoveBurst(a)}}GetInstances(){return[...this.normals.Get(),...this.skills.Get(),...this.bursts.Get(),...this.tr.Get(),...this.extra.Get()]}FindInstance(e){for(const a of[this.normals,this.skills,this.bursts,this.tr,this.extra]){const n=a.Find(e);if(n)return n}}GetEffects(){var e,a;return[...((e=this.weapon)==null?void 0:e.GetEffects())||[],...((a=this.artifacts)==null?void 0:a.GetEffects())||[],...this.effects.Get()]}GetGroupedEffects(){const e=[],{weapon:a,artifacts:n,party:s}=this;a&&e.push(["WEAPON",a.GetEffects()]),n&&e.push(["ARTIFACTS",n.GetEffects()]);const r=[],i=[],c=new Set(this.effects.Get());for(const _ of c){const u=_.Options.Name;if(u.match(/C\d+$/))r.push(_);else if(u.match(/A\d+$/))i.push(_);else continue;c.delete(_)}return e.push(["TALENTS",Array.from(c)]),e.push(["PASSIVES",i]),e.push(["CONSTELLATIONS",r]),s&&e.push(["RESONANCES",s.GetResonances()]),e}FindEffect(e){let a=this.effects.Find(e);if(a||this.weapon&&(a=this.weapon.FindEffect(e),a)||this.artifacts&&(a=this.artifacts.FindEffect(e),a))return a}AddEffect(e){return this.effects.Add(e)}GetArtifacts(){return this.artifacts}SetArtifacts(e){return this.artifacts&&this.artifacts.Remove(),this.artifacts=e,this}AddModifier(e){return this.modifiers.unshift(e),this}SetStat(e,a){const n=this.GetCharacter();switch(e){case t.stat.ATK:throw new Error("Cannot set Total ATK directly.");case t.stat.HP:throw new Error("Cannot set Total HP directly.");case t.stat.DEF:throw new Error("Cannot set Total DEF directly");case t.stat.NORMAL_ATTACK_LEVEL:case t.stat.ELEMENTAL_SKILL_LEVEL:case t.stat.ELEMENTAL_BURST_LEVEL:case t.stat.LEVEL:case t.stat.ASCENSION:case t.stat.HP_CURRENT:case t.stat.ENERGY_CURRENT:n.Set(e,a);break;default:const s=n.Get(e);let r=this.uniqueModifiers.get(e);if(!r)r=n.CreateModifier(e,a-s),this.uniqueModifiers.set(e,r);else{const i=r.GetValue();r.SetValue(a-s+i)}}return n.Get(e)}AddStat(e,a){const s=this.GetCharacter().Get(e);return this.SetStat(e,s+a)}RemoveModifier(e){const a=this.modifiers.indexOf(e);if(a>=0)e.Disable(),this.modifiers.splice(a,1);else for(const[n,s]of this.uniqueModifiers)if(s===e){this.uniqueModifiers.delete(n);break}return this}GetModifiers(){return this.allModifiers.splice(0,this.allModifiers.length),this.allModifiers.push(...this.modifiers),this.allModifiers.push(...this.uniqueModifiers.values()),this.allModifiers}ClearModifiers(){return this.modifiers.forEach(e=>e.Disable()),this.uniqueModifiers.forEach(e=>e.Disable()),this.modifiers.splice(0,this.modifiers.length),this}},ss={};D(ss,{BaseDamage:()=>rs,Instance:()=>Fe,Normal:()=>ke,NormalTalent:()=>It,Transformative:()=>F});var rs=class{constructor(e){this.instance=e,this.motions=[],this.multipliers=[]}CreateMv(e,a){const n={Enabled:!0,Stat:e,Value:a};return this.motions.push(n),n}AddMv(e){return this.motions.includes(e)?!1:(this.motions.push(e),!0)}RemoveMv(e){const a=this.motions.indexOf(e);return a===-1?!1:(this.motions.splice(a,1),!0)}GetMvs(){return this.motions}CreateMultiplier(e){const a={Enabled:!0,Value:e};return this.multipliers.push(a),a}AddMultiplier(e){return this.multipliers.includes(e)?!1:(this.multipliers.push(e),!0)}RemoveMultiplier(e){const a=this.multipliers.indexOf(e);return a===-1?!1:(this.multipliers.splice(a,1),!0)}GetMultipliers(){return this.multipliers}Compute(){let e=0;for(const a of this.motions)a.Enabled&&(e+=this.instance.Get(a.Stat)*a.Value);for(const a of this.multipliers)a.Enabled&&Math.abs(a.Value)>1e-6&&(e*=a.Value);return e}};function K_(e,a){return e===E.HYDRO_DMG&&a.Affected(E.PYRO_DMG)?[E.VAPORIZE_DMG,2]:e===E.PYRO_DMG&&a.Affected(E.CRYO_DMG)?[E.MELT_DMG,2]:e===E.PYRO_DMG&&a.Affected(E.HYDRO_DMG)?[E.VAPORIZE_DMG,1.5]:e===E.CRYO_DMG&&a.Affected(E.PYRO_DMG)?[E.MELT_DMG,1.5]:[E.NONE,0]}function Y_(e,a){return a.HasAura(q.QUICKEN)?e===E.ELECTRO_DMG?[E.AGGRAVATE_DMG,2.3]:e===E.DENDRO_DMG?[E.SPREAD_DMG,2.5]:[E.NONE,0]:[E.NONE,0]}function is(e,a,n){const s=e.GetElement(),r=e.Options.Talent,i=e.Character.GetEnemy(),[c,_]=Y_(s,i),[u,A]=K_(s,i),S=Jn({Char:e.Character.Get(E.LEVEL),Enemy:i.Subject.Get(E.LEVEL),Base:e.Base.Compute()+e.Get(E.DMG_FLAT),Dmg:e.Get(s)+e.Get(r)+e.Get(E.ALL_DMG),Critrate:Math.max(0,Math.min(1,e.Get(E.CRIT_RATE))),Critdmg:e.Get(E.CRIT_DMG),Em:e.Get(E.ELEMENTAL_MASTERY),Res:i.Subject.Get(Xt(s)),Ignored:e.Get(E.DEFIGNORED)+i.Subject.Get(E.DEFIGNORED),Reduced:e.Get(E.DEFREDUCTION)+i.Subject.Get(E.DEFREDUCTION),Quicken:e.Get(c),Amp:e.Get(u),Tr:e.Get(e.Options.Tr)}),h=Zn({Base:e.Options.Base,Def:e.Options.Def,Res:e.Options.Res,Dmg:e.Options.Dmg,Crit:n,Quicken:_,Tr:e.Options.Tr,Amp:A});return a||(S.Quicken=0,S.Amp=0,h.Quicken=0,h.Amp=0),e.Options.Amp||(h.Amp=0),e.Options.Quicken||(h.Quicken=0),e.Options.Crit||(h.Crit=0),{stats:S,options:h}}function Ye(e,a,n){const{stats:s,options:r}=is(e,a,n);return ts(s,r)}var V=E,Fe=class{constructor(e,a){this.Character=e,this.Options=a,this.Base=new rs(this),this.fixed=new Uint8Array(E.Length()),this.Subject=new _t(E.Length(),"INSTANCE_"+this.Options.Name)}GetElement(){if(this.Options.Override){if(this.Options.OverrideElement!==E.NONE)return this.Options.OverrideElement;if(this.Options.Infusion){const e=this.Character.GetInfusion();if(e)return e.Element}}return this.Options.Element}Fix(e){return this.fixed[e]=1,this}Unfix(e){return this.fixed[e]=0,this}Get(e){if(e===V.ATK){const a=this.GetElement(),n=ge(a),s=Re(a),r=this.Options.Talent,i=ge(r),c=Re(r),_=this.Get(V.ATK_BASE);let u=this.Get(V.ATK_PERCENT),A=this.Get(V.ATK_FLAT);return n!==V.NONE&&(u+=this.Get(n)),i!==V.NONE&&(u+=this.Get(i)),s!==V.NONE&&(A+=this.Get(s)),c!==V.NONE&&(A+=this.Get(c)),Bt(_,u,A)}else if(e===V.CRIT_RATE){const a=this.GetElement(),n=this.Options.Talent,s=Ie(a),r=Ie(n);let i=0;return i+=this.Subject.Get(V.CRIT_RATE),i+=this.Subject.Get(V.EXTRA_CRIT_RATE),this.fixed[V.CRIT_RATE]||(i+=this.Character.Get(V.CRIT_RATE)),this.fixed[V.EXTRA_CRIT_RATE]||(i+=this.Character.Get(V.EXTRA_CRIT_RATE)),i+=this.Get(s)+this.Get(r),this.Character.MapCritRate(i)}else if(e===V.CRIT_DMG){const a=this.GetElement(),n=this.Options.Talent,s=Oe(a),r=Oe(n);let i=this.Subject.Get(V.CRIT_DMG);return this.fixed[V.CRIT_DMG]||(i+=this.Character.Get(V.CRIT_DMG)),i+=this.Get(s)+this.Get(r),i}else if(e===V.DMG_FLAT){const a=this.GetElement(),n=this.Options.Talent,s=Ge(a),r=Ge(n);let i=this.Subject.Get(V.DMG_FLAT);return this.fixed[V.DMG_FLAT]||(i+=this.Character.Get(V.DMG_FLAT)),i+=this.Get(s)+this.Get(r),i}else return this.fixed[e]?this.Subject.Get(e):this.Character.Get(e)+this.Subject.Get(e)}DmgNoCrit(e){return Ye(this,e,0)}DmgCrit(e){return Ye(this,e,1)}DmgAvg(e){return Ye(this,e,2)}Params(e,a){return is(this,e,a)}};function ke(e,a){return new Fe(a,{Name:e,Element:E.PHYSICAL_DMG,Talent:E.NONE,Override:!0,OverrideElement:E.NONE,Infusion:!1,Base:!0,Def:!0,Res:!0,Dmg:!0,Crit:!0,Quicken:!0,Amp:!0,Tr:E.NONE})}function F(e,a,n){const s=new Fe(n,{Name:"HIT_"+E.Name(e).replace(/_DMG/g,""),Element:E.PHYSICAL_DMG,Talent:E.NONE,Override:!1,OverrideElement:E.NONE,Infusion:!1,Base:!1,Def:!1,Res:!0,Dmg:!1,Crit:!0,Quicken:!1,Amp:!1,Tr:e});if(s.Fix(E.CRIT_RATE),s.Fix(E.CRIT_DMG),e===E.SWIRL_DMG){if(!a)throw new Error("Swirl transformative damage must have an element");s.Options.Quicken=!0,s.Options.Amp=!0,s.Options.Name="HIT_"+(E.Name(e)+"_"+E.Name(a)).replace(/_DMG/g,""),s.Options.Element=a}else s.Options.Element=hn(e);return s}function It(e,a){const n=ke(a.Name,e),s=[];if(n.Options.Talent=a.Talent,n.Options.Element=a.Element,a.Scaling)for(const r of a.Scaling)s.push(...vn(n,r));return[n,s]}function F_(e){return Object.assign(function(){const n=new Ke(e);On(n,e);const s=ee.create({character:n,normals:e.Normals.map(r=>It(n,Ve(r,E.NORMAL_ATTACK_LEVEL))[0]),skills:e.Skills.map(r=>It(n,Ve(r,E.ELEMENTAL_SKILL_LEVEL))[0]),bursts:e.Bursts.map(r=>It(n,Ve(r,E.ELEMENTAL_BURST_LEVEL))[0]),tr:k_(n),extra:e.Extra.map(r=>It(n,nt(b({},r),{Scaling:void 0}))[0]),effects:[]});return s.GetNormals().forEach(r=>r.Options.Infusion=!0),e.Effects.forEach(r=>{const i=r(s);i.Apply(s),s.AddEffect(i)}),s},e)}function Ve(e,a){var n;return nt(b({},e),{Scaling:(n=e.Scaling)==null?void 0:n.map(s=>nt(b({},s),{Talent:a}))})}function k_(e){const a=e.Options.Element,n=[];switch(a){case E.PYRO_DMG:n.push(F(E.OVERLOAD_DMG,void 0,e)),n.push(F(E.BURGEON_DMG,void 0,e)),n.push(F(E.BURNING_DMG,void 0,e));break;case E.HYDRO_DMG:n.push(F(E.ELECTROCHARGE_DMG,void 0,e)),n.push(F(E.BLOOM_DMG,void 0,e));break;case E.CRYO_DMG:n.push(F(E.SUPERCONDUCT_DMG,void 0,e));break;case E.ELECTRO_DMG:n.push(F(E.SUPERCONDUCT_DMG,void 0,e)),n.push(F(E.ELECTROCHARGE_DMG,void 0,e)),n.push(F(E.OVERLOAD_DMG,void 0,e)),n.push(F(E.HYPERBLOOM_DMG,void 0,e));break;case E.DENDRO_DMG:n.push(F(E.BLOOM_DMG,void 0,e));break;case E.GEO_DMG:n.push(F(E.SHATTER_DMG,void 0,e));break;case E.ANEMO_DMG:n.push(F(E.SWIRL_DMG,E.PYRO_DMG,e)),n.push(F(E.SWIRL_DMG,E.HYDRO_DMG,e)),n.push(F(E.SWIRL_DMG,E.CRYO_DMG,e)),n.push(F(E.SWIRL_DMG,E.ELECTRO_DMG,e)),n.push(F(E.SUPERCONDUCT_DMG,void 0,e)),n.push(F(E.ELECTROCHARGE_DMG,void 0,e)),n.push(F(E.OVERLOAD_DMG,void 0,e)),n.push(F(E.HYPERBLOOM_DMG,void 0,e)),n.push(F(E.BLOOM_DMG,void 0,e)),n.push(F(E.BURGEON_DMG,void 0,e));break}return a!==E.GEO_DMG&&e.Options.Weapon===un.CLAYMORE&&n.push(F(E.SHATTER_DMG,void 0,e)),n}var ls={};D(ls,{Cryo:()=>Ss,Dendro:()=>ms,FindByElement:()=>Ns,Geo:()=>hs,GetList:()=>ps,Hydro:()=>As,Pyro:()=>us});var l={};D(l,{Builder:()=>ft,Effect:()=>cs,EffectEvent:()=>U,Export:()=>Ue,Factory:()=>mt,Import:()=>We});function K(e,a){let n=e.toFixed(a);return n=n.replace(/\.([0-9]*)([1-9])0+$/,".$1$2"),n=n.replace(/\.0+$/,""),n}function os(e){switch(e.type){case 0:return U_(e.object);case 1:return W_(e.object);case 2:return j_(e.object);case 3:return x_(e.object);case 4:return V_(e.object)}}function V_(e){return"Damage instance: "+e.Options.Name}function x_(e){return`Infusion (${e.Enabled?"Enabled":"Disabled"}): `+xe(e.Element)}function U_(e){const a=e.Enabled()?"Enabled":"Disabled";return`Modifier (${e.Title}) (${a}): `+xe(e.GetProp())+" += "+K(e.GetValue(),4)}function W_(e){let n=`Multiplier (${e.object.Enabled?"Enabled":"Disabled"}): `+K(e.object.Value,4)+`
`;n+=`	For instances:
`;for(const s of e.instances)n+="		"+s.Options.Name+`
`;return n}function j_(e){let n=`MV (${e.object.Enabled?"Enabled":"Disabled"}): `+K(e.object.Value,4)+"*"+xe(e.object.Stat)+`
`;n+=`	For instances:
`;for(const s of e.instances)n+="		"+s.Options.Name+`
`;return n}function xe(e){try{return E.Name(e)}catch{return"unknown stat"}}var z_=class{constructor(){this.modifiers=new Set,this.observers=new Set,this.infusions=new Set,this.multipliers=new Set,this.mtins=new Set,this.mvs=new Set,this.mvins=new Set,this.instances=new Set,this.queryPool=[],this.queryGroups=new Map,this.nextQuery={}}GetModifiers(){return Array.from(this.modifiers)}Modifier(e){return this.modifiers.add(e),this.queryPool.push({type:0,object:e}),e}Observer(e){return this.observers.add(e),e}Infusion(e){return this.infusions.add(e),this.queryPool.push({type:3,object:e}),e}Multiplier(e,...a){return this.multipliers.add(e),a.forEach(n=>{n.Base.AddMultiplier(e),this.mtins.add(n)}),this.queryPool.push({type:1,object:{instances:a,object:e}}),e}Mv(e,...a){return this.mvs.add(e),a.forEach(n=>{n.Base.AddMv(e),this.mvins.add(n)}),this.queryPool.push({type:2,object:{instances:a,object:e}}),e}Instance(e,a,n){const s=[e,a,n];return this.instances.add(s),this.queryPool.push({type:4,object:n}),s}Enable(){return this.observers.forEach(e=>e.Enable().Notify()),this.modifiers.forEach(e=>e.Enable()),this.infusions.forEach(e=>e.Enabled=!0),this.mvs.forEach(e=>e.Enabled=!0),this.multipliers.forEach(e=>e.Enabled=!0),this.instances.forEach(([e,a,n])=>e.AddInstance(a,n)),this}DisableObs(){return this.observers.forEach(e=>e.Notify().Disable()),this}Disable(){return this.modifiers.forEach(e=>e.Disable()),this.DisableObs(),this.infusions.forEach(e=>e.Enabled=!1),this.mvs.forEach(e=>e.Enabled=!1),this.multipliers.forEach(e=>e.Enabled=!1),this.instances.forEach(([e,a,n])=>e.RemoveInstance(a,n)),this}Remove(){return this.Disable(),this.observers.forEach(e=>e.Remove()),this.infusions.forEach(e=>e.Remove()),this.mvins.forEach(e=>this.mvs.forEach(a=>e.Base.RemoveMv(a))),this.mtins.forEach(e=>this.multipliers.forEach(a=>e.Base.RemoveMultiplier(a))),this.instances.forEach(([e,a,n])=>e.RemoveInstance(a,n)),this}RemoveObserver(e){return e.Remove(),this.observers.delete(e),this}StartQuery(e){this.nextQuery=e}EndQuery(){this.queryGroups.set(this.nextQuery,[...this.queryPool]),this.queryPool=[]}String(){let e="";for(const[a,n]of this.queryGroups){e+="QUERY: "+JSON.stringify(a)+`
`;for(const s of n)e+=os(s)+`
`;e+="=".repeat(32)+`
`}this.queryGroups.size===0&&(e+="=".repeat(32)+`
`);for(const a of this.queryPool)e+=os(a)+`
`;return e}},U=ct("ENABLE","DISABLE","CHANGE_RANK","CHANGE_TARGET","CHANGE_STACKS","CHANGE_AURAS","CHANGE_CONDITIONS");function At(...e){const a=[],n=[];let s=0;e.forEach((i,c)=>{a[c]=i.split(`
`),a[c].forEach(_=>{_.length>(n[c]||0)&&(n[c]=_.length)}),a[c].length>s&&(s=a[c].length)});const r=[];return a.forEach((i,c)=>{for(let _=0;_<s;_++){let u;for(_<i.length?u=i[_]:u="";u.length<n[c];)u+=" ";r[_]===void 0&&(r[_]=""),r[_]+=u}}),r.join(`
`)}var cs=class{constructor(e,a){this.Options=e,this.Owner=a,this.targets=new Set,this.register=new Map,this.onUnapply=new Map,this.enabled=!1,this.rank=1,this.stacks=0,this.conditions=new Set,this.auras=new Set,this.Event=new _t(U.Length(),"EFFECT_EVENT")}CreateObserver(e,a){return this.Event.CreateObserver(e,a)}Enabled(){return this.enabled}Enable(){this.enabled=!0;for(const[,e]of this.register)e.Enable();return this.Event.Notify(U.ENABLE),this}Disable(){this.enabled=!1;for(const[,e]of this.register)e.Disable();return this.Event.Notify(U.DISABLE),this}GetTargets(){return Array.from(this.targets.values())}Lock(e){const a=this.register.get(e);return a?(a.DisableObs(),this):(k.Global.warnf("Cannot lock effect %s for target %s because its not applied.",this.Options.Name,e.GetCharacter().Options.Name),this)}ApplyMultiple(e){const a=new Set(e);if(!this.Options.ApplyOther){const s=a.has(this.Owner),r=a.size;a.clear(),s&&(a.add(this.Owner),r>1&&k.Global.warnf('Effect "%s" can only be applied to its owner: "%s"',this.Options.Name,this.Owner.GetCharacter().Options.Name))}if(this.Options.ApplySelf||(a.delete(this.Owner),k.Global.warnf('Effect "%s" CANNOT be applied to its owner: "%s"',this.Options.Name,this.Owner.GetCharacter().Options.Name)),this.Options.MaxTargets>0){let s=0;for(let r=0;r<e.length&&a.size>this.Options.MaxTargets;r++)a.delete(e[r]),s++;s>0&&k.Global.warnf('Effect "%s" maximum targets is %d.',this.Options.Name,this.Options.MaxTargets)}this.UnapplyAll();let n=0;for(const s of a)this.Apply(s)&&n++;return n}Apply(e){if(!this.Options.StackSelf){const s=e.GetParty();if(s&&s.GetAppliedEffects(e).find(i=>i.Options.Name===this.Options.Name))return k.Global.warnf('Cannot apply effect "%s" to target "%s". Another instance of this effect is already applied to the target',this.Options.Name,e.GetCharacter().Options.Name),!1}if(!this.Options.ApplySelf&&e===this.Owner)return k.Global.warnf('Cannot apply effect "%s" to target "%s". Effect CANNOT be applied to its owner: "%s"',this.Options.Name,e.GetCharacter().Options.Name,this.Owner.GetCharacter().Options.Name),!1;if(!this.Options.ApplyOther&&e!==this.Owner)return k.Global.warnf('Cannot apply effect "%s" to target "%s". Effect can only be applied to its owner: "%s"',this.Options.Name,e.GetCharacter().Options.Name,this.Owner.GetCharacter().Options.Name),!1;if(this.Options.MaxTargets>0&&this.targets.size>=this.Options.MaxTargets)return k.Global.warnf('Cannot apply effect "%s" to target "%s". Effect is applied to its maximum number of targets: %d',this.Options.Name,e.GetCharacter().Options.Name,this.Options.MaxTargets),!1;if(this.targets.has(e))return k.Global.warnf('Cannot apply effect "%s" to target "%s". Effect is applied to this target',this.Options.Name,e.GetCharacter().Options.Name),!1;this.targets.add(e);const a=new z_;this.register.set(e,a);const n=this.Options.OnApply(e,this,a);return this.onUnapply.set(e,n),this.Enabled()?a.Enable():a.Disable(),this.Event.Notify(U.CHANGE_TARGET),!0}Unapply(e){var a,n;return this.targets.has(e)?(this.targets.delete(e),(a=this.register.get(e))==null||a.Remove(),this.register.delete(e),(n=this.onUnapply.get(e))==null||n(),this.onUnapply.delete(e),this.Event.Notify(U.CHANGE_TARGET),!0):!1}UnapplyAll(){return this.targets.forEach(e=>this.Unapply(e)),this}GetRank(){return this.rank}GetStacks(){return this.stacks}SetRank(e){return e=Math.floor(e),e>this.Options.MaxRank&&(e=this.Options.MaxRank),e<1&&(e=1),this.rank=e,this.Event.Notify(U.CHANGE_RANK),this}SetStacks(e){return e>this.Options.MaxStacks&&(e=this.Options.MaxStacks),e<0&&(e=0),this.stacks=e,this.Event.Notify(U.CHANGE_STACKS),this}HasCondition(e){return this.conditions.has(e.toUpperCase())}SetConditions(...e){this.conditions.clear();for(let a of e)a=a.toUpperCase(),this.Options.Conditions.includes(a)&&this.conditions.size<this.Options.MaxConditions&&this.conditions.add(a);return this.Event.Notify(U.CHANGE_CONDITIONS),this}GetConditions(){return Array.from(this.conditions)}HasAura(e){return this.auras.has(e)}SetAuras(...e){const a=this.Options.ValidAuras;this.auras.clear();for(const n of e)this.auras.size<this.Options.MaxAuras&&(a.length===0||a.length>0&&a.includes(n))&&this.auras.add(n);return this.Event.Notify(U.CHANGE_AURAS),this}GetAuras(){return Array.from(this.auras)}Affected(e){for(const a of this.auras)if(De(a)===e)return!0;return!1}TargetRegister(e){const a=this.register.get(e);if(!!a)return a.String()}Register(){const e=this.GetTargets().map(n=>n.GetCharacter().Options.Name+`
`+this.TargetRegister(n)||""),a=[];for(let n=0;n<e.length;n++)a[2*n]=e[n],a[2*n+1]=" ".repeat(4);return At(...a)}};function mt(e){const a=b({ApplySelf:!0,ApplyOther:!1,StackSelf:!1,MaxTargets:0,Conditions:[],MaxConditions:0,MaxAuras:0,ValidAuras:[],MaxRank:1,MaxStacks:0},e);return a.Conditions=a.Conditions.map(n=>n.toUpperCase()),Object.assign(function(s){return new cs(a,s)},nt(b({},e),{Options:e}))}function Es(e,a){return!(Number.isFinite(a.g)&&!(e>(a.g||0))||Number.isFinite(a.geq)&&!(e>=(a.geq||0))||Number.isFinite(a.l)&&!(e<(a.l||0))||Number.isFinite(a.leq)&&!(e<=(a.leq||0)))}function Ts(e,a,n){if(n.name){if(typeof n.name=="string"){if(e.Options.Name.toLowerCase()!==n.name.toLowerCase())return!1}else if(!e.Options.Name.match(n.name))return!1}if(n.element&&n.element.length>0&&!n.element.some(c=>e.Options.Element===c)||e.GetAscension()<(n.ascension||0)||n.weapon&&n.weapon.length>0&&!n.weapon.some(c=>e.Options.Weapon===c))return!1;const s=e.Get(E.HP_CURRENT),r=e.Get(E.ENERGY_CURRENT);return!(n.hp&&!Es(s,n.hp)||n.energy&&!Es(r,n.energy)||n.shielded!==void 0&&e.IsShielded()!==n.shielded||n.isOwner!==void 0&&e===a!==n.isOwner)}function _s(e,a){return!(a.affected&&a.affected.length>0&&e.Affected&&!a.affected.some(s=>{var r;return(r=e.Affected)==null?void 0:r.call(e,s)})||a.aura&&a.aura.length>0&&!a.aura.some(s=>e.HasAura(s)))}function q_(e,a,n,s){if(e.target&&!Ts(n,a,e.target)||e.owner&&!Ts(a,a,e.owner)||e.enemy&&!_s(n.GetEnemy(),e.enemy))return!1;if(e.effect){if(!_s(s,e.effect))return!1;if(e.effect.conditions&&e.effect.conditions.length>0){const r=e.effect.conditionQuery||"some";if(!e.effect.conditions[r](c=>s.HasCondition(c)))return!1}}return!0}function $_(e,a,n,s){if(typeof e=="function")return e(n,a,s);{let r=q_(e,a.GetCharacter(),n.GetCharacter(),s);return e.not&&(r=!r),r}}var Q_=class{constructor(e){this.builder=e,this.target=[],this.owner=[],this.party=!1}Target(...e){return this.target=e,this.builder}Owner(...e){return this.owner=e,this.builder}Party(e){return this.party=e,this.builder}getTarget(){return this.target}getOwner(){return this.owner}getParty(){return this.party}},ae=class{constructor(e){this.builder=e}Next(){return this.builder.Next()}Build(){return this.builder.Build()}Where(e){return this.builder.Where(e),this}};function ne(e,a){const n=[];for(const s of a)typeof s=="string"?e.filter(i=>i.Options.Name.toLowerCase()===s.toLowerCase()).forEach(i=>n.push(i)):typeof s=="function"?e.filter(i=>s(i)).forEach(i=>n.push(i)):e.filter(i=>i.Options.Name.match(s)).forEach(i=>n.push(i));return n}var X_=class extends ae{constructor(){super(...arguments),this.instances=[],this.mods=new Map,this.stat=[],this.target=0,this.usestacks=!1,this.values=[]}MapStat(e){return this.mapStatFn=e,this}Char(...e){return this.stat=e,this.target=0,this}Enemy(...e){return this.stat=e,this.target=1,this}Instance(...e){return this.instances=e,this.target=2,this}Values(...e){return this.usestacks=!1,this.values=e.map(a=>[a]),this}Stacks(...e){return this.usestacks=!0,e.length>0&&(this.values=e),this}Rank(e){return this.rankFn=e,this}Map(e){return this.mapFn=e,this}onBuild(e,a,n){const s=[];this.mapStatFn&&(this.stat=this.mapStatFn(e,a,n));const r=this.target===2?ne(e.GetInstances(),this.instances):[];switch(this.target){case 0:for(const i of this.stat)s.push(n.Modifier(e.GetCharacter().CreateModifier(i,0)));break;case 1:for(const i of this.stat)s.push(n.Modifier(e.GetCharacter().GetEnemy().Subject.CreateModifier(i,0)));break;case 2:for(const i of this.stat)for(const c of r)s.push(n.Modifier(c.Subject.CreateModifier(i,0)));break;default:throw new Error("Cannot create the modifier. Unknown target "+String(this.target).valueOf())}this.mods.set(e,s)}onEnable(e,a,n){const s=this.mods.get(e);if(!s)return;if(this.values.length===0){s.forEach(_=>_.SetValue(0));return}let r;this.rankFn?(r=this.rankFn(e,a,n),r<1&&(r=1)):r=a.GetRank(),r>this.values.length&&(r=this.values.length);const i=this.values[r-1];let c=J_(this.usestacks,i,a.GetStacks());this.mapFn&&(c=this.mapFn(c,e,a,n));for(const _ of s)_.GetValue()!==c&&_.SetValue(c)}onDisable(e){const a=this.mods.get(e);!a||a.forEach(n=>n.SetValue(0))}};function J_(e,a,n){if(e){const s=a.length;return s===1?a[0]*n:s>1?(n>s-1&&(n=s-1),a[n]):0}else return a[0]}var Z_=class extends ae{constructor(){super(...arguments),this.infusions=new Map,this.element=E.NONE,this.max=!1}Set(e,a){return this.element=e,this.max=a,this}onBuild(e,a,n){if(this.element!==E.NONE){const s=n.Infusion(e.GetCharacter().AddInfusion(this.element,this.max));this.infusions.set(e,s)}}onEnable(e,a){const n=this.infusions.get(e);n&&(n.Enabled=a.Enabled())}onDisable(e){const a=this.infusions.get(e);a&&(a.Enabled=!1)}},tu=class extends ae{constructor(){super(...arguments),this.mvs=new Map,this.mults=new Map,this.type="mv",this.stat=E.NONE,this.value=0,this.instances=[]}Mv(e,a,...n){return this.stat=e,this.value=a,this.instances=n,this.type="mv",this}Multiplier(e,...a){return this.value=e,this.type="mult",this.instances=a,this}Map(e){return this.mapFn=e,this}onBuild(e,a,n){const s=ne(e.GetInstances(),this.instances);if(this.type==="mv"&&this.stat!==E.NONE&&this.value>0){const r=n.Mv({Enabled:!1,Stat:this.stat,Value:this.value},...s);this.mvs.set(e,r)}else if(this.type==="mult"&&this.value>0){const r=n.Multiplier({Enabled:!1,Value:this.value},...s);this.mults.set(e,r)}}onEnable(e,a,n){let s=this.mvs.get(e),r=this.mults.get(e);!s&&!r&&(this.onBuild(e,a,n),s=this.mvs.get(e),r=this.mults.get(e)),s&&(this.mapFn?s.Value=this.mapFn(this.value,e,a,n):s.Value=this.value),r&&(this.mapFn?r.Value=this.mapFn(this.value,e,a,n):r.Value=this.value)}onDisable(e){const a=this.mvs.get(e),n=this.mults.get(e);a&&(a.Value=0),n&&(n.Value=1)}},eu=class extends ae{constructor(){super(...arguments),this.store=new Map,this.location="Extra"}Location(e){return this.location=e,this}Options(e){return this.options=e,this}Basic(e){return this.builder.instance.Options({Name:e.Name,Element:e.Element,Talent:e.Talent||E.NONE,Scaling:[{Initial:0,Stat:E.NONE,Talent:E.NONE,Scaling:Dn.NONE}]}).Next().mv.Mv(e.Stat,e.Values[0],e.Name).Map((a,n,s)=>{const r=Math.max(1,Math.min(e.Values.length,s.GetRank()))-1;return e.Values[r]}),this}onBuild(e,a,n){if(!this.options)return;const s=It(e.GetCharacter(),this.options);s[1].forEach(r=>n.Observer(r)),n.Instance(e,this.location,s[0]),this.store.set(e,s)}onEnable(e){const a=this.store.get(e);!a||(a[1].forEach(n=>n.Notify()),e.AddInstance(this.location,a[0]))}onDisable(e){const a=this.store.get(e);!a||e.RemoveInstance(this.location,a[0])}},ft=class{constructor(){this.query={},this.container=[this],this.observe=new Q_(this),this.stat=new X_(this),this.infusion=new Z_(this),this.mv=new tu(this),this.instance=new eu(this),this.parts=[this.stat,this.infusion,this.mv,this.instance]}innerBuild(...[e,a,n]){n.StartQuery(this.query);const s=this.parts;s.forEach(_=>_.onBuild(e,a,n));const r=()=>s.forEach(_=>_.onEnable(e,a,n)),i=()=>s.forEach(_=>_.onDisable(e,a,n)),c=()=>{a.Enabled()&&$_(this.query,a.Owner,e,a)?r():i()};c();for(const _ of this.observe.getTarget())n.Observer(e.GetCharacter().CreateObserver(_,c));for(const _ of this.observe.getOwner())n.Observer(a.Owner.GetCharacter().CreateObserver(_,c));return this.observe.getParty()&&n.Observer(e.Event.CreateObserver(ut.CHANGE_PARTY,c)),n.EndQuery(),c}Build(){return(...[e,a,n])=>{const s=this.container.map(u=>u.innerBuild(e,a,n)),r=()=>s.forEach(u=>u());r();const i=e.GetCharacter(),c=a.Owner.GetCharacter(),_=i.GetEnemy();for(const u of[U.CHANGE_RANK,U.CHANGE_STACKS,U.CHANGE_CONDITIONS,U.CHANGE_AURAS,U.ENABLE,U.DISABLE])n.Observer(a.CreateObserver(u,r));for(const u of[E.LEVEL,E.ASCENSION,E.HP_CURRENT,E.ENERGY_CURRENT,E.SHIELDED])n.Observer(i.CreateObserver(u,r)),n.Observer(c.CreateObserver(u,r));return n.Observer(_.Event.CreateObserver(ht.CHANGE_AURA,r)),r}}Next(){const e=new ft;return e.container=this.container,this.container.push(e),e}Where(e){return this.query=e,this}};function Ue(e){return{enabled:e.Enabled(),rank:e.GetRank(),stacks:e.GetStacks(),auras:e.GetAuras(),conditions:e.GetConditions()}}function We(e,a){e.enabled?a.Enable():a.Disable(),a.SetRank(e.rank),a.SetStacks(e.stacks),a.SetAuras(...e.auras),a.SetConditions(...e.conditions)}var us=[mt({Name:"ResonancePyro",ApplyOther:!0,OnApply:new ft().stat.Char(E.ATK_PERCENT).Values(.25).Build()})],As=[mt({Name:"ResonanceHydro",ApplyOther:!0,OnApply:new ft().stat.Char(E.HP_PERCENT).Values(.25).Build()})],Ss=[mt({Name:"ResonanceCryo",ApplyOther:!0,OnApply:new ft().stat.Char(E.EXTRA_CRIT_RATE).Where({enemy:{affected:[E.CRYO_DMG]}}).Values(.15).Build()})],hs=[mt({Name:"ResonanceGeo",ApplyOther:!0,OnApply:new ft().stat.Enemy(E.GEO_RES).Values(-.15).Next().Where({target:{shielded:!0}}).stat.Char(E.ALL_DMG).Values(.15).Build()})],ms=[mt({Name:"ResonanceDendro",ApplyOther:!0,Conditions:["BURNING","QUICKEN","BLOOM","AGGRAVATE","SPREAD","HYPERBLOOM","BURGEON"],MaxConditions:7,OnApply:new ft().stat.Char(E.ELEMENTAL_MASTERY).Values(50).Next().stat.Char(E.ELEMENTAL_MASTERY).Values(30).Where({effect:{conditions:["BURNING","QUICKEN","BLOOM"]}}).Next().stat.Char(E.ELEMENTAL_MASTERY).Values(20).Where({effect:{conditions:["AGGRAVATE","SPREAD","HYPERBLOOM","BURGEON"]}}).Build()})],fs={[E.PYRO_DMG]:us,[E.HYDRO_DMG]:As,[E.CRYO_DMG]:Ss,[E.GEO_DMG]:hs,[E.DENDRO_DMG]:ms},Ls=[];for(const e of Object.values(fs))e.forEach(a=>Ls.push(a));function ps(){return Ls}function Ns(e){return fs[e]}var Ot={};D(Ot,{Factory:()=>Ms,Food:()=>Cs,FoodType:()=>ds,Foodbox:()=>gs});var ds=(e=>(e[e.OFFENSIVE=0]="OFFENSIVE",e[e.DEFENSIVE=1]="DEFENSIVE",e[e.STAMINA=2]="STAMINA",e[e.ELEMENTAL=3]="ELEMENTAL",e))(ds||{}),Cs=class{constructor(e,a){this.Options=e,this.Effect=a,this.Name=e.Name,this.Type=e.Type,this.Stars=e.Stars}GetRank(){return this.Effect.GetRank()}SetRank(e){e=Math.max(1,Math.min(3,e)),this.Effect.SetRank(e)}Unapply(){this.Effect.Disable(),this.Effect.UnapplyAll()}};function Ms(e){const a=e.Effects,n=mt({Name:e.Name,ApplyOther:!0,MaxRank:3,OnApply(s,r,i){const c=a.map(([u])=>i.Modifier(s.GetCharacter().CreateModifier(u,0))),_=()=>{const u=r.GetRank();for(let A=0;A<a.length;A++){const[,S,h]=a[A],m=S+(h-S)*(u-1)/2;c[A].SetValue(m)}};return _(),i.Observer(r.Event.CreateObserver(U.CHANGE_RANK,_)),i.Observer(s.Event.CreateObserver(ut.CHANGE_PARTY,()=>{const u=s.GetParty();if(!u)return;const A=r.GetTargets(),S=u.GetMembers();for(const h of S)A.includes(h)||r.Apply(h)})),()=>0}});return Object.assign(function(r){const i=n(r);i.Enable(),i.Apply(r);const c=r.GetParty();if(c)for(const _ of c.GetMembers())_!==r&&i.Apply(_);return new Cs(e,i)},nt(b({},e),{Options:e}))}var gs=class{constructor(e){this.target=e,this.byName=new Q(a=>a.Name),this.byType=new Map}Add(e){const a=this.byType.get(e.Type);a&&(a.Unapply(),this.Remove(a.Name));const n=e(this.target);return this.byName.Add(n),this.byType.set(e.Type,n),n}Remove(e){const a=this.byName.Find(e);!a||(this.byName.Remove(a),this.byType.delete(a.Type),a.Unapply())}Clear(){for(const e of this.byName.Get())e.Unapply();this.byName.Clear(),this.byType.clear()}Get(e){return this.byName.Find(e)}GetByType(e){return this.byType.get(e)}GetAll(){return this.byName.Get()}},au=class{constructor(...e){this.members=new Q(a=>a.GetCharacter().Options.Name),this.resonances=[],this.enemies=new Ln,this.handler=new ee(new Ke({Name:"__party__",Region:An.NONE,Stars:4,Element:0,Weapon:0,BurstCost:0})),this.handler.SetParty(this),this.foods=new gs(this.handler),e.forEach(a=>this.Add(a))}GetAppliedEffects(e){return this.GetAllEffects().filter(a=>a.GetTargets().includes(e))}GetResonances(){return this.resonances}GetAllEffects(){const e=[];return this.members.Get().forEach(a=>a.GetEffects().forEach(n=>e.push(n))),this.resonances.forEach(a=>e.push(a)),e}FindEffects(e){return e=e.toLowerCase(),this.GetAllEffects().filter(a=>a.Options.Name.toLowerCase()===e)}Add(e){if(this.members.Get().length>=4||this.members.Has(e))return!1;const a=e.GetParty();return a&&a.Remove(e),e.SetParty(this),this.members.Add(e),this.updateResonances(),this.members.Get().forEach(n=>n.Event.Notify(ut.CHANGE_PARTY)),this.enemies.Add(e.GetCharacter().GetEnemy()),!0}Remove(e){return this.members.Remove(e),e.SetParty(void 0),this.updateResonances(),this.members.Get().forEach(a=>a.Event.Notify(ut.CHANGE_PARTY)),e.Event.Notify(ut.CHANGE_PARTY),this.enemies.Remove(e.GetCharacter().GetEnemy()),!0}GetMembers(){return this.members.Get()}FindMember(e){return this.members.Find(e)}GetFoods(){return this.foods}updateResonances(){if(this.resonances.forEach(s=>s.Disable().UnapplyAll()),this.resonances=[],this.members.Get().length<4)return;const e={};Gt.forEach(s=>e[s]=0),this.members.Get().forEach(s=>e[s.GetCharacter().Options.Element]++);const a=[];Gt.forEach(s=>{e[s]>=2&&a.push(s)}),a.map(s=>Ns(s)).filter(s=>!!s).forEach(s=>s==null?void 0:s.forEach(r=>{const i=r(this.handler);i.Enable(),this.members.Get().forEach(c=>i.Apply(c)),this.resonances.push(i)}))}},p={};D(p,{Export:()=>Rs,Factory:()=>nu,Import:()=>Is,Weapon:()=>Gs});var Gs=class{constructor(e,a){this.Options=e,this.effects=new Q(n=>n.Options.Name),this.level=1,this.ascension=0,this.rank=1,this.effects.AddList(a)}Equip(e){return this.target&&this.Unequip(),this.target=e,this.effects.Get().forEach(a=>a.Enable().Apply(e)),this.atkMod=e.GetCharacter().CreateModifier(E.ATK_BASE,0),this.subMod=e.GetCharacter().CreateModifier(this.Options.Substat,0),this.setMods(),this}Unequip(){var e,a;return this.effects.Get().forEach(n=>n.Disable().UnapplyAll()),(e=this.atkMod)==null||e.Disable(),(a=this.subMod)==null||a.Disable(),this.atkMod=void 0,this.subMod=void 0,this.target=void 0,this}GetLevel(){return this.level}GetAscension(){return this.ascension}IsAscended(){return this.GetAscension()===Rt(this.level)}GetRank(){return this.rank}GetSubstat(){return this.Options.Substat}GetAtkBase(){return Yn(this.Options.Stars,this.Options.Scaling,this.level,this.ascension)}GetSubstatValue(){return Fn(this.Options.Scaling,this.level,this.Options.Substat)}GetEffects(){return this.effects.Get()}FindEffect(e){return this.effects.Find(e)}SetLevel(e){e=Math.max(1,Math.min(90,Math.floor(e)));const a=Zt(e),n=Rt(e);let s=this.ascension;return s<a?s=a:s>n&&(s=n),this.ascension=s,this.level=e,this.setMods(),this}SetAscension(e){const a=Zt(this.level),n=Rt(this.level);let s=e;return s<a?s=a:s>n&&(s=n),this.ascension=Math.floor(s),this.setMods(),this}SetRank(e){return e=Math.max(1,Math.min(5,Math.floor(e))),this.rank=e,this.effects.Get().forEach(a=>a.SetRank(e)),this}setMods(){var e,a;const n=this.GetAtkBase(),s=this.GetSubstatValue();(e=this.atkMod)==null||e.SetValue(n),(a=this.subMod)==null||a.SetValue(s)}};function nu(e){return Object.assign(function(n){const s=e.Effects.map(r=>r(n).Enable());return new Gs(e,s).Equip(n)},e)}function Rs(e){return{level:e.GetLevel(),ascension:e.GetAscension(),rank:e.GetRank()}}function Is(e,a){a.SetLevel(e.level),a.SetAscension(e.ascension),a.SetRank(e.rank)}var I={};D(I,{Artifact:()=>Bs,Export:()=>bs,Import:()=>Ks,Set:()=>su,rolls:()=>ks,transform:()=>Ys});function su(e){return e}var $=ct("CHANGE_LEVEL","CHANGE_PIECE","CHANGE_STARS","CHANGE_SET","CHANGE_MAINSTAT","CHANGE_SUBSTAT"),Os={};D(Os,{CountRolls:()=>Hs,FormatRolls:()=>ws});function Ds(e,a,n,s){const r=a;function*i(c,_,u,A){let S=0;if(u===e-1)S=r-A;else if(u===e){A===r&&(yield c);return}n[u]>S&&(S=n[u]);let h=_;s[u]<h&&(h=s[u]);const m=_-S;for(let f=S;f<=h;f++){const N=[...c,f];yield*i(N,m,u+1,A+f)}}return i([],r,0,0)}var it=class{constructor(e){this.queue=new Za([],(a,n)=>n.priority-a.priority,!1),e?(this.mirror=new Za([],(a,n)=>a.priority-n.priority,!1),this.maxSize=e):this.maxSize=1/0}Length(){return this.queue.length}Top(){const e=this.queue.top();if(!e)throw new Error("Priority queue is empty");return[e.item,e.priority]}Push(e,a){const n={item:e,priority:a};if(this.queue.push(n),this.mirror&&(this.mirror.push(n),this.queue.length>this.maxSize)){const s=this.mirror.pop();s&&this.queue.remove(s)}}Pop(){const e=this.queue.pop();if(!e)throw new Error("Priority queue is empty");return[e.item,e.priority]}Extract(){const e=[];for(;this.queue.length>0;)e.push(this.Pop()[0]);return e}};function vs(e){const a=[];for(const[n,s]of e.substats){if(n===0)continue;const r=ru(e.stars,n,s);a.push([n,r])}return a}function ru(e,a,n){if(n===0)return[];const s=[];for(let c=0;c<4;c++)s.push(rt(e,a,c));const r=new it;ys.forEach(c=>{const _=c.map((A,S)=>A*s[S]).reduce((A,S)=>A+S,0),u=Math.floor(100*(Math.abs(_-n)/n));r.Push(c,-u)});const[i]=r.Pop();return i||[]}var iu=6,ys=[];for(let e=0;e<=iu;e++)for(const a of Ds(4,e,[0,0,0,0],[6,6,6,6]))ys.push(a);var lu=E_(M_()),Dt=class{constructor(e){this.variables=e,this.ConstraintPrefix="_c_",this.ObjectivePrefix="_obj_",this._ints=[],this.objective={},this.constraints=[]}Ints(e){this._ints=e}Objective(e){return this.objective=e,e}Constraint(e,a){return this.constraints.push({left:e,right:a}),e}Format(){const e={},a={},n={};this.variables.forEach(s=>{const r=this.objective[s]||0;e[s]={[this.ObjectivePrefix]:r}}),this.constraints.forEach((s,r)=>{const i=this.ConstraintPrefix+r;a[i]={max:s.right},this.variables.forEach(c=>{const _=s.left[c];Number.isFinite(_)&&(e[c][i]=_)})});for(const s of this._ints)n[s]=!0;return{variables:e,constraints:a,ints:n}}Solve(e){const a=(0,lu.Solve)(b({optimize:this.ObjectivePrefix,opType:e},this.Format()));for(const n of this.variables)a[n]||(a[n]=0);return a}toString(){return this.String()}String(){let e=this.variables.map(n=>"var "+n+(this._ints.includes(n)?" integer":"")+";").join(`
`);const a=this.Matrix();e+=`

maximize z: `+this.strExpr(a.c)+`;

`;for(let n=0;n<a.A.length;n++)e+="subject to c"+n+": "+this.strExpr(a.A[n])+" <= "+a.b[n]+`;
`;return e}Matrix(){const e={c:[],A:[],b:[]};this.putIndex(e.c,this.objective);for(const{left:a,right:n}of this.constraints){e.b.push(n);const s=Array.from(Array(this.variables.length)).fill(0);this.putIndex(s,a),e.A.push(s)}return e}putIndex(e,a){for(const n in a){const s=a[n],r=this.variables.indexOf(n);r!==-1&&(e[r]=s)}}strExpr(e){return this.variables.map((a,n)=>e[n]===0?"":e[n]+"*"+a).filter(a=>a!=="").join(" + ").replace(/\+\s*-/g,"-")}static Vars(e,a){const n={};return e.forEach((s,r)=>{const i=a(s,r);if(!i)return;const[c,_]=i;!Number.isFinite(_)||(n[c]=_)}),n}};function je(e,a,n){return e+"_"+a+"_"+n}function Ps(e){const{level:a,stars:n}=e;if(a<0||a>20)throw new Error("Level must be between 0 and 20");if(n!==4&&n!==5)throw new Error("Stars must be 4 or 5");if(e.substats.length>4)throw new Error("Stats must be less or equal than 4");for(;e.substats.length<4;)e.substats.push([0,0]);const s=Math.floor(e.level/4),r=e.stars-2+s,i=r+1,c=e.substats.map(([d])=>d),_=e.substats.map(([,d])=>d),u=e.substats.map(([d])=>Sn.includes(d)?.5:.001),A=we(e.stars),S=[];for(let d=0;d<4;d++)for(let M=0;M<4;M++)S.push(je("R",d,M));const h=new Dt(S);h.Ints(S);const m=h.Objective({});for(const d of S)m[d]=1;const f=h.Constraint({},i),N=h.Constraint({},-r);for(let d=0;d<4;d++){const M=h.Constraint({},A),R=h.Constraint({},_[d]+u[d]),O=h.Constraint({},-_[d]+u[d]);for(let y=0;y<4;y++){const H=je("R",d,y);M[H]=1,f[H]=1,N[H]=-1,R[H]=rt(n,c[d],y),O[H]=-R[H]}}const L=h.Solve("min");if(!L.feasible)throw new Error("[LP] Cannot find a feasible solution");const C=[];for(let d=0;d<4;d++){if(c[d]===0)continue;const M=[c[d],[]];for(let R=0;R<4;R++){const O=je("R",d,R),y=L[O]||0;M[1].push(y)}C.push(M)}return C}function Hs(e,a="auto"){switch(a){case"auto":try{return Ps(e)}catch{return vs(e)}case"lp":return Ps(e);case"brute":return vs(e)}}function ws(e,a){const n=[];for(const[s,r]of a){const i=[];for(let c=0;c<4;c++){const _=rt(e,s,c);for(let u=0;u<r[c];u++)i.push(_)}n.push([s,i])}return n}var ou=0,Bs=class{constructor(e){this.piece=e,this.Locked=!1,this.Id=ou++,this.Event=new _t($.Length(),"ARTIFACT_EVENT"),this.enabled=!0,this.stars=4,this.level=0,this.substats=[],this.modifiers=[],this.observers=[],this.mainstat=ve(e)[0]}GetPiece(){return this.piece}GetLevel(){return this.level}SetLevel(e){return this.stars===4?e=Math.min(16,e):this.stars===5&&(e=Math.min(20,e)),e<0&&(e=0),this.level=Math.floor(e),this.Event.Notify($.CHANGE_LEVEL),this.Event.Notify($.CHANGE_MAINSTAT),this}GetStars(){return this.stars}SetStars(e){if(e===4)this.GetLevel()>16&&this.SetLevel(16);else if(e===5)this.GetLevel()>20&&this.SetLevel(20);else throw new Error("Artifact stars must be 4 or 5");return this.stars=e,this.Event.Notify($.CHANGE_STARS),this.Event.Notify($.CHANGE_MAINSTAT),this}GetMainstat(){return this.mainstat}SetMainstat(e){if(ve(this.piece).includes(e)){const n=this.substats.findIndex(i=>i.Stat===e),s=yt.filter(i=>!this.substats.find((c,_)=>_!==n&&c.Stat===i)),r=s.includes(this.mainstat)?this.mainstat:s[0];this.mainstat=e,n!==-1&&r&&this.SetSubstat(n,r),this.Event.Notify($.CHANGE_MAINSTAT)}return this}GetMainstatValue(){return this.enabled?kn(this.stars,this.mainstat,this.level):0}GetSet(){return this.set}SetSet(e){return this.set=e,this.Event.Notify($.CHANGE_SET),this}SubstatsLength(){return this.substats.length}AddSubstat(e,a){if(this.substats.length===4||!yt.includes(e)||[this.mainstat,...this.substats.map(r=>r.Stat)].includes(e))return!1;const s=Be(this.stars,e);return a=Math.max(0,Math.min(s,a)),this.substats.push({Stat:e,Value:a}),this.Event.Notify($.CHANGE_SUBSTAT),!0}GetSubstat(e){return this.substats[e].Stat}SetSubstat(e,a){if(this.mainstat===a||!yt.includes(a))return!1;const n=this.substats.findIndex((i,c)=>c!==e&&i.Stat===a),s=rt(this.stars,this.substats[e].Stat,1),r=rt(this.stars,a,1);return n>-1&&(this.substats[n].Stat=this.substats[e].Stat,this.substats[n].Value*=s/r),this.substats[e].Stat=a,this.substats[e].Value*=r/s,this.Event.Notify($.CHANGE_SUBSTAT),!0}GetSubstatValue(e){return this.enabled?this.substats[e].Value:0}SetSubstatValue(e,a){const n=Be(this.stars,this.substats[e].Stat);return a=Math.max(0,Math.min(n,a)),this.substats[e].Value=a,this.Event.Notify($.CHANGE_SUBSTAT),this}ClearSubstats(){return this.substats.forEach(e=>e.Value=0),this.Event.Notify($.CHANGE_SUBSTAT),this}FillSubstats(){const e=yt.filter(a=>a!==this.GetMainstat());for(let a=0;a<e.length;a++)this.AddSubstat(e[a],0);return this}FindSubstat(e){return this.substats.findIndex(a=>a.Stat===e)}Enable(){return this.enabled=!0,this.Event.Notify($.CHANGE_MAINSTAT),this.Event.Notify($.CHANGE_SUBSTAT),this}Disable(){return this.enabled=!1,this.Event.Notify($.CHANGE_MAINSTAT),this.Event.Notify($.CHANGE_SUBSTAT),this}Enabled(){return this.enabled}Unequip(){return this.character=void 0,this.modifiers.forEach(e=>e.Disable()),this.observers.forEach(e=>e.Remove()),this.modifiers=[],this.observers=[],this}Equip(e){this.character&&this.Unequip(),this.character=e;const a=e.CreateModifier(this.mainstat,this.GetMainstatValue()),n=this.Event.CreateObserver($.CHANGE_MAINSTAT,()=>{a.SetProp(this.mainstat),a.SetValue(this.GetMainstatValue())}),s=[];for(let i=0;i<4;i++)s.push(e.CreateModifier(E.ATK_FLAT,0));const r=this.Event.CreateObserver($.CHANGE_SUBSTAT,()=>{for(let i=0;i<4;i++)i<this.SubstatsLength()?(s[i].SetProp(this.GetSubstat(i)),s[i].SetValue(this.GetSubstatValue(i))):s[i].SetValue(0)});return r.Notify(),this.modifiers=[a,...s],this.observers=[n,r],this}Rolls(e="auto"){const a=this.substats.map(s=>[s.Stat,s.Value]);return Hs({level:this.GetLevel(),stars:this.GetStars(),substats:a},e)}FormatRolls(){return ws(this.GetStars(),this.Rolls())}};function bs(e){const a={locked:e.Locked,piece:e.GetPiece(),stars:e.GetStars(),level:e.GetLevel(),set:e.GetSet(),mainstat:e.GetMainstat(),substats:[]};for(let n=0;n<e.SubstatsLength();n++)a.substats.push({stat:e.GetSubstat(n),value:e.GetSubstatValue(n)});return a}function Ks(e,a){if(e.piece!==a.GetPiece())throw new Error(`Cannot import artifacts with incompatible pieces ${st.Name(e.piece)} -> ${st.Name(a.GetPiece())}`);a.Locked=!!e.locked,a.SetStars(e.stars),a.SetLevel(e.level),a.SetSet(e.set),a.SetMainstat(e.mainstat),e.substats.forEach(({stat:n,value:s},r)=>{if(!Number.isFinite(s)||s<0)throw new Error(`Invalid substat ${r} value: ${s}`);r<a.SubstatsLength()?(a.SetSubstat(r,n),a.SetSubstatValue(r,s)):a.AddSubstat(n,s)})}var Ys={};D(Ys,{Downgrade:()=>cu,Scale:()=>Fs});function cu(e){e.GetStars()!==4&&(Fs(e,4),e.SetStars(4))}function Fs(e,a){const n=e.GetStars();for(let s=0;s<e.SubstatsLength();s++){const r=e.GetSubstat(s),i=e.GetSubstatValue(s),c=rt(n,r,0),_=rt(a,r,0),u=i*_/c;e.SetSubstatValue(s,u)}}var ks={};D(ks,{count:()=>Os,equip:()=>Vs});var Vs={};D(Vs,{EquipRolls:()=>xs});function lt(e,a,n,s){return e+"_"+a+"_"+n+"_"+s}function Eu(e){const a=e.substats.length;for(let m=0;m<5-a;m++)e.substats.push([E.NONE,0]);const n=[E.HP_FLAT,E.ATK_FLAT,...e.mainstats],s=e.substats.map(([m])=>m),r=e.substats.map(([,m])=>m),i=s.length;function c(m,f){return s[m]!==n[f]}const _=[],u=new Dt(_),A=u.Objective({});for(let m=0;m<5;m++)for(let f=0;f<i;f++)for(let N=0;N<6;N++)_.push(lt("S",f,m,N)),A[lt("S",f,m,N)]=N+1,u.Constraint({[lt("S",f,m,N)]:1},1);u.Ints(_);for(let m=0;m<5;m++){const f=u.Constraint({},9);for(let N=0;N<i;N++){const L=u.Constraint({},6),C=u.Constraint({[lt("S",N,m,0)]:-5},0);for(let d=0;d<6;d++)L[lt("S",N,m,d)]=1,f[lt("S",N,m,d)]=1,c(N,m)||u.Constraint({[lt("S",N,m,d)]:1},0);for(let d=1;d<6;d++)C[lt("S",N,m,d)]=1}for(let N=0;N<6;N++){const L=u.Constraint({},4);for(let C=0;C<i;C++)L[lt("S",C,m,N)]=1}}for(let m=0;m<i;m++){const f=u.Constraint({},-r[m]);for(let N=0;N<5;N++)for(let L=0;L<6;L++)f[lt("S",m,N,L)]=-1}const S=u.Solve("min");if(!S.feasible)throw new Error("[LP] Cannot find a feasible solution");const h=[];for(let m=0;m<5;m++){const f=[];for(let N=0;N<i;N++){let L=0;for(let C=0;C<6;C++)L+=S[lt("S",N,m,C)]||0;L>0&&f.push([s[N],L])}h.push(f)}return h}function xs(e){const a=Eu(e);for(const n of a)for(const s of n){const r=rt(e.stars,s[0],e.tier);s[1]*=r}return a}var bt={};D(bt,{FindByName:()=>js,GetByType:()=>uu,GetList:()=>_u});var Tu=[{Name:"SakuraShrimpCrackers",Type:1,Effects:[[E.HP_PERCENT,.2,.25]],Stars:3},{Name:"PileEmUp",Type:0,Effects:[[E.CRIT_RATE,.1,.2]],Stars:3},{Name:"AdeptusTemptation",Type:0,Effects:[[E.ATK_FLAT,260,372],[E.CRIT_RATE,.08,.12]],Stars:5},{Name:"AdventurersBreakfastSandwich",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"AlmondTofu",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"Baklava",Type:0,Effects:[[E.CRIT_RATE,.1,.2]],Stars:3},{Name:"BerryMintBurst",Type:0,Effects:[[E.CRIT_RATE,.16,.16]],Stars:2},{Name:"Biryani",Type:1,Effects:[[E.DEF_FLAT,215,308],[E.HEALING_BONUS,.06,.1]],Stars:4},{Name:"BountifulYear",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"BraisedMeat",Type:0,Effects:[[E.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"ButterChicken",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"ButterCrab",Type:1,Effects:[[E.DEF_FLAT,215,308],[E.HEALING_BONUS,.06,.1]],Stars:4},{Name:"CallaLilySeafoodSoup",Type:1,Effects:[[E.DEF_FLAT,165,235]],Stars:3},{Name:"CandiedAjilenakhNut",Type:1,Effects:[[E.DEF_FLAT,165,235]],Stars:3},{Name:"ChickenTofuPudding",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"ColdCutPlatter",Type:0,Effects:[[E.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"ComeandGetIt",Type:0,Effects:[[E.CRIT_RATE,.1,.2]],Stars:3},{Name:"CrabRoeKourayaki",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"CrocodileJerky",Type:0,Effects:[[E.ATK_FLAT,114,114]],Stars:2},{Name:"CuredPorkDryHotpot",Type:0,Effects:[[E.CRIT_RATE,.1,.2]],Stars:3},{Name:"DragonBeardNoodles",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"FishermansToast",Type:1,Effects:[[E.DEF_FLAT,88,126]],Stars:2},{Name:"FlamingEssentialOil",Type:3,Effects:[[E.PYRO_DMG,.25,.25]],Stars:3},{Name:"ForestEssentialOil",Type:3,Effects:[[E.DENDRO_DMG,.25,.25]],Stars:3},{Name:"FragrantMashedPotatoes",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"FriedRadishBalls",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"FrostingEssentialOil",Type:3,Effects:[[E.CRYO_DMG,.25,.25]],Stars:3},{Name:"FruitsoftheFestival",Type:1,Effects:[[E.HEALING_BONUS,.15,.2]],Stars:3},{Name:"GoldenCrab",Type:1,Effects:[[E.DEF_FLAT,215,308],[E.HEALING_BONUS,.06,.1]],Stars:4},{Name:"GoldenFriedChicken",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"GushingEssentialOil",Type:3,Effects:[[E.ANEMO_DMG,.25,.25]],Stars:3},{Name:"ImportedPoultry",Type:0,Effects:[[E.CRIT_RATE,.1,.2]],Stars:3},{Name:"JadeParcels",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"JewelrySoup",Type:1,Effects:[[E.DEF_FLAT,88,126]],Stars:2},{Name:"JueyunChiliChicken",Type:0,Effects:[[E.CRIT_RATE,.06,.12]],Stars:2},{Name:"JueyunGuoba",Type:0,Effects:[[E.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"KatsuSandwich",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"LanternRiteSpecialComeandGetIt",Type:0,Effects:[[E.CRIT_RATE,.2,.2]],Stars:3},{Name:"LanternRiteSpecialFriedRadishBalls",Type:0,Effects:[[E.ATK_FLAT,95,95]],Stars:2},{Name:"LanternRiteSpecialJewelrySoup",Type:1,Effects:[[E.DEF_FLAT,126,126]],Stars:2},{Name:"LotusFlowerCrisp",Type:1,Effects:[[E.DEF_FLAT,165,235]],Stars:3},{Name:"MasalaCheeseBalls",Type:0,Effects:[[E.CRIT_RATE,.06,.12]],Stars:2},{Name:"MeatLoversMushroomPizza",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"MintSalad",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"MoonPie",Type:1,Effects:[[E.DEF_FLAT,165,235]],Stars:4},{Name:"MoreandMore",Type:0,Effects:[[E.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"MushroomHodgepodge",Type:1,Effects:[[E.DEF_FLAT,88,126]],Stars:2},{Name:"QingceStirFry",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"RadishandFishStew",Type:0,Effects:[[E.CRIT_RATE,.06,.12]],Stars:2},{Name:"RiceCakeSoup",Type:1,Effects:[[E.DEF_FLAT,165,235]],Stars:3},{Name:"SashimiPlatter",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"SatisfyingSalad",Type:0,Effects:[[E.CRIT_RATE,.06,.12]],Stars:2},{Name:"SautedMatsutake",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"ShawarmaWrap",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"ShockingEssentialOil",Type:3,Effects:[[E.ELECTRO_DMG,.25,.25]],Stars:3},{Name:"StoneHarborDelicacies",Type:0,Effects:[[E.CRIT_RATE,.06,.12]],Stars:2},{Name:"StreamingEssentialOil",Type:3,Effects:[[E.HYDRO_DMG,.25,.25]],Stars:3},{Name:"SunsetBerryTea",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"TandooriRoastChicken",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"TianshuMeat",Type:0,Effects:[[E.PHYSICAL_DMG,.25,.45],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"TriFlavoredSkewer",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"UnagiChazuke",Type:1,Effects:[[E.HEALING_BONUS,.15,.2]],Stars:3},{Name:"UnmovingEssentialOil",Type:3,Effects:[[E.GEO_DMG,.25,.25]],Stars:3},{Name:"Wakatakeni",Type:1,Effects:[[E.DEF_FLAT,88,126]],Stars:2},{Name:"WolfhookJuice",Type:0,Effects:[[E.ATK_FLAT,114,114]],Stars:2},{Name:"OnceUponaTimeinMondstadt",Type:0,Effects:[[E.CRIT_RATE,.2,.2],[E.CRIT_DMG,.2,.2]],Stars:3},{Name:"SweetDream",Type:0,Effects:[[E.ATK_FLAT,114,114]],Stars:2},{Name:"APrizeCatch",Type:1,Effects:[[E.DEF_FLAT,282,282]],Stars:3},{Name:"DerWeisheitLetzterSchlussLife",Type:0,Effects:[[E.CRIT_RATE,.16,.16]],Stars:2},{Name:"DieHeiligeSinfonie",Type:0,Effects:[[E.PHYSICAL_DMG,.55,.55]],Stars:3},{Name:"FishFlavoredToast",Type:1,Effects:[[E.DEF_FLAT,151,151]],Stars:2},{Name:"ForestWatchersChoice",Type:1,Effects:[[E.DEF_FLAT,151,151]],Stars:2},{Name:"Halvamazd",Type:1,Effects:[[E.DEF_FLAT,282,282]],Stars:3},{Name:"HeartstringNoodles",Type:0,Effects:[[E.ATK_FLAT,274,274]],Stars:3},{Name:"NoTomorrow",Type:0,Effects:[[E.CRIT_RATE,.2,.2],[E.CRIT_DMG,.2,.2]],Stars:3},{Name:"QingceHouseholdDish",Type:0,Effects:[[E.ATK_FLAT,274,274]],Stars:3},{Name:"RockinRiffinChicken",Type:0,Effects:[[E.CRIT_RATE,.16,.16]],Stars:2},{Name:"ShimiChazuke",Type:1,Effects:[[E.HEALING_BONUS,.25,.25]],Stars:3},{Name:"ShowMetheMora",Type:0,Effects:[[E.ATK_FLAT,274,274]],Stars:3},{Name:"TheOnlyTruth",Type:0,Effects:[[E.ATK_FLAT,114,114]],Stars:2}],ze=[...Tu].sort((e,a)=>e.Stars===a.Stars?e.Name.localeCompare(a.Name):a.Stars-e.Stars).map(e=>Ms(e)),Us=new Q(e=>e.Name);Us.AddList(ze);var se=new Map,Ws;for(const e of ze)se.has(e.Type)||se.set(e.Type,[]),(Ws=se.get(e.Type))==null||Ws.push(e);function _u(){return ze}function js(e){return Us.Find(e)}function uu(e){return se.get(e)||[]}function zs(e){const a={},n={},s={};for(const _ of e.GetEffects())n[_.Options.Name]=Ue(_);const r=e.GetWeapon();r&&(a[r.Options.Name]=Rs(r));const i=e.GetArtifacts();i&&st.Values().forEach(_=>s[_]=bs(i.Get(_)));const c=e.GetModifiers().map(_=>({stat:_.GetProp(),value:_.GetValue()}));return{character:as(e.GetCharacter()),weapon:a,effects:n,artifacts:s,modifiers:c}}function qs(e,a){const n=a.GetWeapon();if(n){const r=e.weapon[n.Options.Name];r&&Is(r,n)}const s=a.GetArtifacts();s&&st.Values().forEach(r=>{const i=e.artifacts[r];i&&Ks(i,s.Get(r))});for(const r of a.GetEffects()){const i=e.effects[r.Options.Name];!i||We(i,r)}a.ClearModifiers();for(const{stat:r,value:i}of e.modifiers)a.AddModifier(a.GetCharacter().CreateModifier(r,i));ns(e.character,a.GetCharacter())}function $s(e){const a={};for(const i of e.GetMembers())a[i.GetCharacter().Options.Name]=zs(i);const n={};for(const i of e.GetResonances())n[i.Options.Name]=Ue(i);const s={};for(const i of e.GetAllEffects()){const c=i.Owner.GetCharacter().Options.Name;s[c]||(s[c]={}),s[c][i.Options.Name]=i.GetTargets().map(_=>_.GetCharacter().Options.Name)}const r=e.GetFoods().GetAll().map(i=>[i.Name,i.GetRank()]);return{characters:a,resonances:n,targets:s,foods:r}}function qe(e,a){const n=a.GetMembers();for(const s of n){const r=e.characters[s.GetCharacter().Options.Name];r&&qs(r,s)}for(const s of a.GetResonances()){const r=e.resonances[s.Options.Name];r&&We(r,s)}for(const s of a.GetAllEffects()){const r=s.Owner.GetCharacter().Options.Name,i=s.Options.Name,c=e.targets[r];if(!c)continue;const _=c[i];if(!_)continue;const u=[];for(const A of n)_.includes(A.GetCharacter().Options.Name)&&u.push(A);s.ApplyMultiple(u)}if(a.GetFoods().Clear(),e.foods)for(const[s,r]of e.foods){const i=js(s);if(!i)continue;a.GetFoods().Add(i).SetRank(r)}}var Lt={};D(Lt,{Artbox:()=>mu});var tt={};D(tt,{ArchaicPetra:()=>wr,Berserker:()=>Br,BlizzardStrayer:()=>br,BloodstainedChivalry:()=>dr,BraveHeart:()=>Cr,CrimsonWitchOfFlames:()=>Dr,DeepwoodMemories:()=>Hr,DefenderWill:()=>Mr,DesertPavilionChronicle:()=>sr,EchoesOfAnOffering:()=>gr,EmblemOfSeveredFate:()=>Ir,FindByName:()=>re,FlowerOfParadiseLost:()=>nr,Gambler:()=>Nr,GetList:()=>Kr,GildedDreams:()=>pr,GladiatorsFinale:()=>vr,GoldenTroupe:()=>tr,HeartOfDepth:()=>Lr,HuskOfOpulentDreams:()=>fr,Instructor:()=>Rr,Lavawalker:()=>mr,MaidenBeloved:()=>hr,MarechausseeHunter:()=>Zs,MartialArtist:()=>Sr,NighttimeWhispersInTheEchoingWoods:()=>Xs,NoblesseOblige:()=>Gr,NymphsDream:()=>ar,OceanHuedClam:()=>Ar,PaleFlame:()=>ur,ResolutionOfSojourner:()=>_r,RetracingBolide:()=>Tr,Scholar:()=>Er,ShimenawasReminiscence:()=>yr,SongOfDaysPast:()=>Js,TenacityOfTheMillelith:()=>cr,TheExile:()=>or,ThunderingFury:()=>lr,Thundersoother:()=>ir,VermillionHereafter:()=>rr,ViridescentVenerer:()=>Pr,VourukashasGlow:()=>er,WanderersTroupe:()=>Or});var Qs={};D(Qs,{ArchaicPetra:()=>wr,Berserker:()=>Br,BlizzardStrayer:()=>br,BloodstainedChivalry:()=>dr,BraveHeart:()=>Cr,CrimsonWitchOfFlames:()=>Dr,DeepwoodMemories:()=>Hr,DefenderWill:()=>Mr,DesertPavilionChronicle:()=>sr,EchoesOfAnOffering:()=>gr,EmblemOfSeveredFate:()=>Ir,FlowerOfParadiseLost:()=>nr,Gambler:()=>Nr,GildedDreams:()=>pr,GladiatorsFinale:()=>vr,GoldenTroupe:()=>tr,HeartOfDepth:()=>Lr,HuskOfOpulentDreams:()=>fr,Instructor:()=>Rr,Lavawalker:()=>mr,MaidenBeloved:()=>hr,MarechausseeHunter:()=>Zs,MartialArtist:()=>Sr,NighttimeWhispersInTheEchoingWoods:()=>Xs,NoblesseOblige:()=>Gr,NymphsDream:()=>ar,OceanHuedClam:()=>Ar,PaleFlame:()=>ur,ResolutionOfSojourner:()=>_r,RetracingBolide:()=>Tr,Scholar:()=>Er,ShimenawasReminiscence:()=>yr,SongOfDaysPast:()=>Js,TenacityOfTheMillelith:()=>cr,TheExile:()=>or,ThunderingFury:()=>lr,Thundersoother:()=>ir,VermillionHereafter:()=>rr,ViridescentVenerer:()=>Pr,VourukashasGlow:()=>er,WanderersTroupe:()=>Or});var Xs=I.Set({Name:"NighttimeWhispersInTheEchoingWoods",Stars:5,Piece2:[l.Factory({Name:"NighttimeWhispersInTheEchoingWoods2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"NighttimeWhispersInTheEchoingWoods4",MaxConditions:2,Conditions:["CAST_SKILL","CRYSTALLIZE"],OnApply:new l.Builder().Where({effect:{conditions:["CAST_SKILL"]}}).stat.Char(t.stat.GEO_DMG).Values(.2).Next().Where({effect:{conditions:["CAST_SKILL","CRYSTALLIZE"],conditionQuery:"every"}}).stat.Char(t.stat.GEO_DMG).Values(.2*1.5).Next().Build()})]}),Js=I.Set({Name:"SongOfDaysPast",Stars:5,Piece2:[l.Factory({Name:"SongOfDaysPast2",OnApply:new l.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.15).Build()})],Piece4:[l.Factory({Name:"SongOfDaysPast4",MaxStacks:15e3,ApplyOther:!0,MaxTargets:1,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT,t.stat.CHARGED_ATTACK_DMG_FLAT,t.stat.PLUNGE_ATTACK_DMG_FLAT,t.stat.ELEMENTAL_SKILL_DMG_FLAT,t.stat.ELEMENTAL_BURST_DMG_FLAT).Values(.08).Stacks().Build()})]}),Zs=I.Set({Name:"MarechausseeHunter",Stars:5,Piece2:[l.Factory({Name:"MarechausseeHunter2",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"MarechausseeHunter4",MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.12).Stacks().Build()})]}),tr=I.Set({Name:"GoldenTroupe",Stars:5,Piece2:[l.Factory({Name:"GoldenTroupe2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.2).Build()})],Piece4:[l.Factory({Name:"GoldenTroupe4",MaxConditions:1,Conditions:["OFF_FIELD","ON_FIELD"],OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.25).Next().Where({effect:{conditions:["OFF_FIELD"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.25).Build()})]}),er=I.Set({Name:"VourukashasGlow",Stars:5,Piece2:[l.Factory({Name:"VourukashasGlow2",OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2).Build()})],Piece4:[l.Factory({Name:"VourukashasGlow4",MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.1).Next().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.1).Next().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.08).Stacks().Next().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.08).Stacks().Next().Build()})]}),ar=I.Set({Name:"NymphsDream",Stars:5,Piece2:[l.Factory({Name:"NymphsDream2",OnApply:new l.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"NymphsDream4",MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Stacks([0,.07,.16,.25]).Next().stat.Char(t.stat.HYDRO_DMG).Stacks([0,.04,.09,.15]).Build()})]}),nr=I.Set({Name:"FlowerOfParadiseLost",Stars:5,Piece2:[l.Factory({Name:"FlowerOfParadiseLost2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[l.Factory({Name:"FlowerOfParadiseLost4",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.BLOOM_DMG,t.stat.HYPERBLOOM_DMG,t.stat.BURGEON_DMG).Values(.4).Next().stat.Char(t.stat.BLOOM_DMG,t.stat.HYPERBLOOM_DMG,t.stat.BURGEON_DMG).Values(.4*.25).Stacks().Next().Build()})]}),sr=I.Set({Name:"DesertPavilionChronicle",Stars:5,Piece2:[l.Factory({Name:"DesertPavilionChronicle2",OnApply:new l.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"DesertPavilionChronicle4",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.4).Build()})]}),rr=I.Set({Name:"VermillionHereafter",Stars:5,Piece2:[l.Factory({Name:"VermillionHereafter2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"VermillionHereafter4",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.08).Next().stat.Char(t.stat.ATK_PERCENT).Values(.1).Stacks().Build()})]}),ir=I.Set({Name:"Thundersoother",Stars:5,Piece2:[],Piece4:[l.Factory({Name:"Thundersoother4",OnApply:new l.Builder().Where({enemy:{affected:[t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.35).Build()})]}),lr=I.Set({Name:"ThunderingFury",Stars:5,Piece2:[l.Factory({Name:"ThunderingFury2",OnApply:new l.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"ThunderingFury4",OnApply:new l.Builder().stat.Char(t.stat.OVERLOAD_DMG,t.stat.ELECTROCHARGE_DMG,t.stat.SUPERCONDUCT_DMG,t.stat.HYPERBLOOM_DMG).Values(.4).Next().stat.Char(t.stat.AGGRAVATE_DMG).Values(.2).Build()})]}),or=I.Set({Name:"TheExile",Stars:4,Piece2:[l.Factory({Name:"TheExile2",OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[]}),cr=I.Set({Name:"TenacityOfTheMillelith",Stars:5,Piece2:[l.Factory({Name:"TenacityOfTheMillelith2",OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2).Build()})],Piece4:[l.Factory({Name:"TenacityOfTheMillelith4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()})]}),Er=I.Set({Name:"Scholar",Stars:4,Piece2:[l.Factory({Name:"Scholar2",OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[]}),Tr=I.Set({Name:"RetracingBolide",Stars:5,Piece2:[],Piece4:[l.Factory({Name:"RetracingBolide4",OnApply:new l.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.4).Build()})]}),_r=I.Set({Name:"ResolutionOfSojourner",Stars:4,Piece2:[l.Factory({Name:"ResolutionOfSojourner2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"ResolutionOfSojourner4",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_RATE).Values(.3).Build()})]}),ur=I.Set({Name:"PaleFlame",Stars:5,Piece2:[l.Factory({Name:"PaleFlame2",OnApply:new l.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.25).Build()})],Piece4:[l.Factory({Name:"PaleFlame4",MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.09).Stacks().Next().stat.Char(t.stat.PHYSICAL_DMG).Stacks([0,0,.25]).Build()})]}),Ar=I.Set({Name:"OceanHuedClam",Stars:5,Piece2:[l.Factory({Name:"OceanHuedClam2",OnApply:new l.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.15).Build()})],Piece4:[l.Factory({Name:"OceanHuedClam4",MaxStacks:3e4,OnApply(e,a,n){const[,,s]=n.Instance(e,"Extra",ke("HIT_OceanHuedClam",e.GetCharacter()));s.Options.Def=!1,s.Options.Crit=!1,s.Options.Dmg=!1;const r=n.Modifier(s.Subject.CreateModifier(t.stat.DMG_FLAT,0));function i(){const c=a.GetStacks()*.9;r.SetValue(c)}return i(),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_STACKS,i)),()=>0}})]}),Sr=I.Set({Name:"MartialArtist",Stars:4,Piece2:[l.Factory({Name:"MartialArtist2",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"MartialArtist4",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.25).Build()})]}),hr=I.Set({Name:"MaidenBeloved",Stars:5,Piece2:[l.Factory({Name:"MaidenBeloved2",OnApply:new l.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.15).Build()})],Piece4:[]}),mr=I.Set({Name:"Lavawalker",Stars:5,Piece2:[],Piece4:[l.Factory({Name:"Lavawalker4",OnApply:new l.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.35).Build()})]}),fr=I.Set({Name:"HuskOfOpulentDreams",Stars:5,Piece2:[l.Factory({Name:"HuskOfOpulentDreams2",OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Build()})],Piece4:[l.Factory({Name:"HuskOfOpulentDreams4",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT,t.stat.GEO_DMG).Values(.06).Stacks().Build()})]}),Lr=I.Set({Name:"HeartOfDepth",Stars:5,Piece2:[l.Factory({Name:"HeartOfDepth2",OnApply:new l.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"HeartOfDepth4",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.3).Build()})]}),pr=I.Set({Name:"GildedDreams",Stars:5,Piece2:[l.Factory({Name:"GildedDreams2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[l.Factory({Name:"GildedDreams4",OnApply(e,a,n){const s=e.GetCharacter(),r=s.Options.Element,i=n.Modifier(s.CreateModifier(t.stat.ELEMENTAL_MASTERY,0)),c=n.Modifier(s.CreateModifier(t.stat.ATK_PERCENT,0));function _(){const u=e.GetParty();if(!u){i.SetValue(0),c.SetValue(0);return}let A=0,S=0;for(const h of u.GetMembers())h!==e&&(h.GetCharacter().Options.Element===r?A++:S++);A=Math.min(3,A),S=Math.min(3,S),c.SetValue(.14*A),i.SetValue(50*S)}return _(),n.Observer(e.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,_)),()=>0}})]}),Nr=I.Set({Name:"Gambler",Stars:4,Piece2:[l.Factory({Name:"Gambler2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.2).Build()})],Piece4:[]}),dr=I.Set({Name:"BloodstainedChivalry",Stars:5,Piece2:[l.Factory({Name:"BloodstainedChivalry2",OnApply:new l.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.25).Build()})],Piece4:[l.Factory({Name:"BloodstainedChivalry4",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.5).Build()})]}),Cr=I.Set({Name:"BraveHeart",Stars:4,Piece2:[l.Factory({Name:"BraveHeart2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"BraveHeart4",OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.3).Build()})]}),Mr=I.Set({Name:"DefendersWill",Stars:4,Piece2:[l.Factory({Name:"DefendersWill2",OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Build()})],Piece4:[]}),gr=I.Set({Name:"EchoesOfAnOffering",Stars:5,Piece2:[l.Factory({Name:"EchoesOfAnOffering2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"EchoesOfAnOffering4",Conditions:["AVERAGE","MAXIMUM"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["MAXIMUM"]}}).mv.Mv(t.stat.ATK,.7,e=>e.Options.Talent===t.stat.NORMAL_ATTACK_DMG).Next().Where({effect:{conditions:["AVERAGE"]}}).mv.Mv(t.stat.ATK,.7*.502,e=>e.Options.Talent===t.stat.NORMAL_ATTACK_DMG).Build()})]}),Gr=I.Set({Name:"NoblesseOblige",Stars:5,Piece2:[l.Factory({Name:"NoblesseOblige2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.2).Build()})],Piece4:[l.Factory({Name:"NoblesseOblige4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()})]}),Rr=I.Set({Name:"Instructor",Stars:4,Piece2:[l.Factory({Name:"Instructor2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[l.Factory({Name:"Instructor4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(120).Build()})]}),Ir=I.Set({Name:"EmblemOfSeveredFate",Stars:5,Piece2:[l.Factory({Name:"EmblemOfSeveredFate2",OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[l.Factory({Name:"EmblemOfSeveredFate4",OnApply:new l.Builder().observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.25).Map((e,a)=>Math.max(0,Math.min(.75,e*a.GetCharacter().Get(t.stat.ENERGY_RECHARGE)))).Build()})]}),Or=I.Set({Name:"WanderersTroupe",Stars:5,Piece2:[l.Factory({Name:"WanderersTroupe2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[l.Factory({Name:"WanderersTroupe4",OnApply:new l.Builder().stat.Where({target:{weapon:[t.weapon.BOW,t.weapon.CATALYST]}}).Char(t.stat.CHARGED_ATTACK_DMG).Values(.35).Build()})]}),Dr=I.Set({Name:"CrimsonWitchOfFlames",Stars:5,Piece2:[l.Factory({Name:"CrimsonWitchOfFlames2",OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"CrimsonWitchOfFlames4",MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.VAPORIZE_DMG,t.stat.MELT_DMG).Values(.15).Next().stat.Char(t.stat.OVERLOAD_DMG,t.stat.BURGEON_DMG,t.stat.BURNING_DMG).Values(.4).Next().stat.Char(t.stat.PYRO_DMG).Values(.075).Stacks().Build()})]}),vr=I.Set({Name:"GladiatorsFinale",Stars:5,Piece2:[l.Factory({Name:"GladiatorsFinale2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"GladiatorsFinale4",OnApply:new l.Builder().Where({target:{weapon:[t.weapon.CLAYMORE,t.weapon.SWORD,t.weapon.POLEARM]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.35).Build()})]}),yr=I.Set({Name:"ShimenawasReminiscence",Stars:5,Piece2:[l.Factory({Name:"ShimenawasReminiscence2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"ShimenawasReminiscence4",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.5).Build()})]}),Pr=I.Set({Name:"ViridescentVenerer",Stars:5,Piece2:[l.Factory({Name:"ViridescentVenerer2",OnApply:new l.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"ViridescentVenerer4_1",OnApply:new l.Builder().stat.Char(t.stat.SWIRL_DMG).Values(.6).Build()}),l.Factory({Name:"ViridescentVenerer4",ApplyOther:!0,ValidAuras:t.Swirlable,MaxAuras:5,OnApply(e,a,n){const s=e.GetCharacter().GetEnemy(),r=Su.map(c=>n.Modifier(s.Subject.CreateModifier(c,0)));function i(){if(a.Owner.GetCharacter().Options.Element!==t.stat.ANEMO_DMG)return;const c=a.GetAuras().map(_=>t.DmgToRes(t.AuraToDmg(_)));for(const _ of r)c.includes(_.GetProp())?_.SetValue(Au):_.SetValue(0)}return i(),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,i)),()=>0}})]}),Au=-.4,Su=t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG).map(e=>t.DmgToRes(e)),Hr=I.Set({Name:"DeepwoodMemories",Stars:5,Piece2:[l.Factory({Name:"DeepwoodMemories2",OnApply:new l.Builder().stat.Char(t.stat.DENDRO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"DeepwoodMemories4",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.DENDRO_RES).Values(-.3).Build()})]}),wr=I.Set({Name:"ArchaicPetra",Stars:5,Piece2:[l.Factory({Name:"ArchaicPetra2",OnApply:new l.Builder().stat.Char(t.stat.GEO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"ArchaicPetra4",MaxAuras:1,ApplyOther:!0,ValidAuras:t.Swirlable,OnApply(e,a,n){const s=e.GetCharacter(),r=t.Elements.filter(c=>c!==t.stat.PHYSICAL_DMG).map(c=>n.Modifier(s.CreateModifier(c,0)));function i(){const c=a.GetAuras().map(_=>t.AuraToDmg(_));for(const _ of r)c.includes(_.GetProp())?_.SetValue(.4):_.SetValue(0)}return n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,i)),()=>0}})]}),Br=I.Set({Name:"Berserker",Stars:4,Piece2:[l.Factory({Name:"Berserker2",OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.12).Build()})],Piece4:[l.Factory({Name:"Berserker4",OnApply:new l.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.CRIT_RATE).Values(.24).Build()})]}),br=I.Set({Name:"BlizzardStrayer",Stars:5,Piece2:[l.Factory({Name:"BlizzardStrayer2",OnApply:new l.Builder().stat.Char(t.stat.CRYO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"BlizzardStrayer4",OnApply:new l.Builder().Where({enemy:{affected:[t.stat.CRYO_DMG]}}).stat.Char(t.stat.EXTRA_CRIT_RATE).Values(.2).Next().Where({enemy:{aura:[t.aura.FROZEN]}}).stat.Char(t.stat.EXTRA_CRIT_RATE).Values(.2).Next().Build()})]}),hu=Object.values(Qs).sort((e,a)=>e.Stars===a.Stars?e.Name.localeCompare(a.Name):e.Stars-a.Stars),$e=new Q(e=>e.Name);$e.AddList(hu);function Kr(){return $e.Get()}function re(e){return $e.Find(e)}function Qe(e){const a=[];for(const r of e){if(!r)continue;const i=a.find(c=>c[0].toLowerCase()===r.toLowerCase());i?i[1]++:a.push([r.toLowerCase(),1])}const n=[],s=[];for(const r of a)r[1]>=4?(n.push([r[0],4]),s.push(r[0]),s.push(r[0])):r[1]>=2&&(n.push([r[0],2]),s.push(r[0]));return[n,s]}var mu=class{constructor(e){this.target=e,this.effects=new Q(a=>a.Options.Name),this.sets=[],this.artifacts=st.Values().map(a=>{const n=new Bs(a).Equip(e.GetCharacter());return n.Event.CreateObserver($.CHANGE_SET,()=>this.onChangeSet()),n})}GetArtifacts(){return this.artifacts}GetActiveSets(){return this.sets}onChangeSet(){const[e,a]=Qe(this.artifacts.map(n=>n.GetSet()||""));this.effects.Get().forEach(n=>n.Disable().UnapplyAll()),this.effects.Clear(),this.sets=a;for(const[n,s]of e){if(!n)continue;const r=re(n);!r||(s>=2&&r.Piece2.map(i=>{const c=i(this.target).Enable();return c.Apply(this.target),c}).forEach(i=>this.effects.Add(i)),s>=4&&r.Piece4.map(i=>{const c=i(this.target).Enable();return c.Apply(this.target),c}).forEach(i=>this.effects.Add(i)))}}UnequipAll(){return this.artifacts.forEach(e=>e.Unequip()),this}EquipAll(){return this.artifacts.forEach(e=>e.Equip(this.target.GetCharacter())),this}GetEffects(){return this.effects.Get()}FindEffect(e){return this.effects.Find(e)}Get(e){return this.artifacts[e]}Remove(){this.UnequipAll(),this.effects.Get().forEach(e=>e.Disable().UnapplyAll())}EquipRolls(e){try{const a=xs(b({stars:5,mainstats:[this.artifacts[2].GetMainstat(),this.artifacts[3].GetMainstat(),this.artifacts[4].GetMainstat()]},e));return this.artifacts.forEach((n,s)=>{const r=a[s];n.ClearSubstats(),r.forEach(([i,c],_)=>{n.SubstatsLength()<=_?n.AddSubstat(i,c):(n.SetSubstat(_,i),n.SetSubstatValue(_,c))})}),!0}catch(a){return console.error("[EQUIP SUBSTATS]",a),!1}}RollSummary(){const e=Yr(),a=[],n={};for(const s of this.artifacts){const r=s.Rolls();for(const[i,c]of r){n[i]===void 0&&(n[i]=a.length,a.push([i,Yr()]));const[,_]=a[n[i]];for(let u=0;u<4;u++)_[u]+=c[u]||0,e[u]+=c[u]||0,_[4]+=c[u]||0,e[4]+=c[u]||0}for(let i=0;i<s.SubstatsLength();i++){const c=s.GetSubstat(i),_=s.GetSubstatValue(i),u=Math.round(_/rt(s.GetStars(),c,4));e[5]+=u,a[n[c]][1][5]+=u}}return{result:a,total:e}}},Yr=()=>[0,0,0,0,0,0],ie={};D(ie,{Rotation:()=>fu});var fu=class{constructor(){this.characters=new Q(e=>e.GetCharacter().Options.Name),this.actions=[],this.damage=0,this.Duration=NaN,this.details=[]}SetCharacters(...e){return this.characters.Clear(),this.characters.AddList(e),this}Run(){let e=-1;return this.Log&&(e=this.Log.line),this.damage=0,this.details=[],this.actions.forEach(a=>this.runAction(a)),this.Log&&this.Log.setLine(e),this.damage}AddFn(e,a){return this.actions.push({fn:e,line:a}),this}AddHit(e,a,n,s,r,i){return r=Math.max(0,Math.min(1,r)),s=Math.max(0,Math.min(r,s)),this.actions.push({hit:{charname:e,hitname:a,multiplier:n,aura:r,reaction:s},line:i}),this}Clear(){return this.actions=[],this}GetDetails(){const e={};return this.details.forEach((a,n)=>{e[a.charname]||(e[a.charname]=[]),e[a.charname][n]=a}),e}GetSummary(){const e={damage:this.damage,dps:this.damage/this.Duration,duration:this.Duration,characters:{}};for(const a of this.characters.Get())e.characters[a.GetCharacter().Options.Name]={relative:0,damage:0,dps:0,elements:{},talents:{},instances:{}};for(const{charname:a,hitname:n,talent:s,element:r,damage:i}of this.details){const c=e.characters[a];c.damage+=i,c.elements[r]||(c.elements[r]={damage:0,relative:0}),c.elements[r].damage+=i,c.talents[s]||(c.talents[s]={damage:0,relative:0}),c.talents[s].damage+=i,c.instances[n]||(c.instances[n]={damage:0,relative:0}),c.instances[n].damage+=i}for(const a in e.characters){const n=e.characters[a];n.dps=n.damage/this.Duration,n.relative=n.damage/this.damage;for(const s in n.instances)n.instances[s].relative=n.instances[s].damage/n.damage;for(const s in n.talents)n.talents[s].relative=n.talents[s].damage/n.damage;for(const s in n.elements)n.elements[s].relative=n.elements[s].damage/n.damage}return e}getCharacter(e){const a=this.characters.Find(e);return a||this.Log&&this.Log.errorf("Character not found: %s",e),a}getInstance(e,a){const n=this.getCharacter(e);if(!n)return;const s=n.FindInstance(a);return s||this.Log&&this.Log.errorf("Instance %s not found in character %s",a,e),s}addDamage(e){this.damage+=e.damage,this.Log&&this.details.push(e)}runAction(e){if(e.line&&this.Log&&this.Log.setLine(e.line),e.fn){e.fn();return}if(!e.hit)return;const{hit:a}=e,n=this.getCharacter(a.charname);if(!n)return;const s=this.getInstance(a.charname,a.hitname);if(!s)return;const r=n.GetCharacter().Options.Name,i=s.Options.Name,c=n.GetCharacter().GetEnemy(),_=c.GetAuras(),u=s.DmgAvg(!0),A=s.DmgAvg(!1);c.SetAuras();const S=s.DmgAvg(!1),h=S;c.SetAuras(..._);const m=es(S,h,A,u,a.aura,a.reaction),f=a.multiplier*m;this.addDamage({charname:r,hitname:i,talent:s.Options.Talent,element:s.GetElement(),damage:f,single_damage:m,multiplier:a.multiplier,auras:_,noaura_noreaction:S,noaura_yesreaction:h,yesaura_noreaction:A,yesaura_yesreaction:u,aura:a.aura,reaction:a.reaction}),this.Log&&this.Log.logf("%s hit %s did (%.2f * %.2f) = %.2f damage",r,i,a.multiplier,m,f)}},pt={};D(pt,{Albedo:()=>Ii,Alhaitham:()=>Ri,Amber:()=>Gi,Ayaka:()=>hi,Ayato:()=>Si,Beidou:()=>Oi,Bennett:()=>wi,Chevreuse:()=>Vr,Chongyun:()=>Mi,Collei:()=>Ci,Cyno:()=>di,Dehya:()=>zr,Diluc:()=>Ni,Eula:()=>pi,Faruzan:()=>qr,FindByName:()=>Y1,Fischl:()=>Bi,Furina:()=>Ur,Ganyu:()=>Li,GetList:()=>Fi,Gorou:()=>fi,HuTao:()=>vi,Itto:()=>gi,Jean:()=>mi,Kazuha:()=>bi,Keqing:()=>Ai,Klee:()=>ui,Kokomi:()=>oi,Mika:()=>jr,Mona:()=>_i,Nahida:()=>Yi,Navia:()=>xr,Neuvillette:()=>Wr,Nilou:()=>Qr,Ningguang:()=>Ti,Noelle:()=>Ei,Raiden:()=>Hi,Rosaria:()=>ci,Sara:()=>Ki,Shenhe:()=>li,Sucrose:()=>ii,Tartaglia:()=>ri,Venti:()=>si,Wanderer:()=>ni,Xiangling:()=>ai,Xiao:()=>ei,Xingqiu:()=>Di,Yae:()=>ti,Yanfei:()=>Zr,Yelan:()=>yi,Yoimiya:()=>Jr,Yunjin:()=>Xr,Zhongli:()=>Pi});var Fr={};D(Fr,{Albedo:()=>Ii,Alhaitham:()=>Ri,Amber:()=>Gi,Ayaka:()=>hi,Ayato:()=>Si,Beidou:()=>Oi,Bennett:()=>wi,Chevreuse:()=>Vr,Chongyun:()=>Mi,Collei:()=>Ci,Cyno:()=>di,Dehya:()=>zr,Diluc:()=>Ni,Eula:()=>pi,Faruzan:()=>qr,Fischl:()=>Bi,Furina:()=>Ur,Ganyu:()=>Li,Gorou:()=>fi,HuTao:()=>vi,Itto:()=>gi,Jean:()=>mi,Kazuha:()=>bi,Keqing:()=>Ai,Klee:()=>ui,Kokomi:()=>oi,Mika:()=>jr,Mona:()=>_i,Nahida:()=>Yi,Navia:()=>xr,Neuvillette:()=>Wr,Nilou:()=>Qr,Ningguang:()=>Ti,Noelle:()=>Ei,Raiden:()=>Hi,Rosaria:()=>ci,Sara:()=>Ki,Shenhe:()=>li,Sucrose:()=>ii,Tartaglia:()=>ri,Venti:()=>si,Wanderer:()=>ni,Xiangling:()=>ai,Xiao:()=>ei,Xingqiu:()=>Di,Yae:()=>ti,Yanfei:()=>Zr,Yelan:()=>yi,Yoimiya:()=>Jr,Yunjin:()=>Xr,Zhongli:()=>Pi});var T={};D(T,{ArrObjTable:()=>Ou,Artifact:()=>gu,ArtifactRolls:()=>Ru,Character:()=>Nu,Effect:()=>Cu,EffectDetail:()=>Mu,Enemy:()=>Du,Food:()=>Hu,Horizontal:()=>At,Instance:()=>pu,ObjArrTable:()=>Iu,Rotation:()=>yu,Table:()=>Y,hits:()=>Lu,labels:()=>v});var Y=class{constructor(...e){this.DecimalPlaces=2,this.HeaderLine=!0,this.rows=[e],this.n_cols=e.length}AddRow(...e){for(;e.length<this.n_cols;)e.push("");return this.rows.push(e),this}GetHeaders(){return this.rows[0]}GetRows(){return this.rows.slice(1)}toString(){return this.String()}String(){const e=this.n_cols,a=this.rows.length,n=[],s=[];for(let i=0;i<e;i++){let c=0;for(let _=0;_<a;_++){const u=this.rows[_][i];let A;typeof u=="number"?A=u.toFixed(this.DecimalPlaces):A=(u==null?void 0:u.toString())||"",A.length>c&&(c=A.length),n[_*e+i]=A}s[i]=c}for(let i=0;i<e;i++)for(let c=0;c<a;c++){const _=s[i];for(;n[c*e+i].length<_;)n[c*e+i]+=" "}let r="";for(let i=0;i<a;i++){for(let c=0;c<e;c++)r+=n[i*e+c]+" | ";if(this.HeaderLine&&i===0){r+=`
`;const c=r.length;for(let _=0;_<c;_++)r+="-"}r+=`
`}return r}RemoveColumn(e){for(const a of this.rows)a.splice(e,1);return this.n_cols--,this}RemoveColumns(...e){e.sort((a,n)=>n-a);for(const a of e)this.RemoveColumn(a);return this}RemoveEmptyColumns(){const e=this.n_cols;for(let a=e-1;a>=0;a--){let n=!0;for(let s=1;s<this.rows.length;s++)if(this.rows[s][a]){n=!1;break}n&&this.RemoveColumn(a)}return this}Serialize(){return this.rows.map(e=>e.map(a=>String(a).valueOf()||""))}static Deserialize(e){const a=e.shift()||[],n=new Y(...a);for(const s of e)n.AddRow(...s);return n}};function kr(...e){const a={};return e.forEach(n=>{if(typeof n=="string")a[n]=n;else for(const s in n)a[s]=s}),a}var Lu=kr("HIT_N1","HIT_N1_1","HIT_N1_2","HIT_N1_3","HIT_N1_4","HIT_N2","HIT_N2_1","HIT_N2_2","HIT_N2_3","HIT_N2_4","HIT_N3","HIT_N3_1","HIT_N3_2","HIT_N3_3","HIT_N3_4","HIT_N4","HIT_N4_1","HIT_N4_2","HIT_N4_3","HIT_N4_4","HIT_N5","HIT_N5_1","HIT_N5_2","HIT_N5_3","HIT_N5_4","HIT_N6","HIT_N6_1","HIT_N6_2","HIT_N6_3","HIT_N6_4","HIT_CHARGED","HIT_CHARGED_1","HIT_CHARGED_2","HIT_CHARGED_3","HIT_CHARGED_4","HIT_CHARGED_SPIN","HIT_CHARGED_FINAL","HIT_PLUNGE","HIT_PLUNGE_LOW","HIT_PLUNGE_HIGH","HIT_AIMED_NORMAL","HIT_AIMED_CHARGED","HIT_E","HIT_E_PRESS","HIT_E_HOLD","HIT_E_DOT","HIT_E_1","HIT_E_1_1","HIT_E_1_2","HIT_E_2","HIT_E_2_1","HIT_E_2_2","HIT_E_3","HIT_E_3_1","HIT_E_3_2","HIT_E_4","HIT_E_EXPLOSION","HIT_Q","HIT_Q_EXPLOSION","HIT_Q_DOT","HIT_Q_1","HIT_Q_2","HIT_Q_3","HIT_WEAPON_HIT","HIT_WEAPON_HIT_N1","HIT_WEAPON_HIT_N2","HIT_WEAPON_HIT_N3","HIT_WEAPON_HIT_N4","HIT_WEAPON_HIT_N5","HIT_WEAPON_HIT_N6","HIT_OVERLOAD","HIT_SHATTER","HIT_SUPERCONDUCT","HIT_ELECTROCHARGE","HIT_SWIRL_PYRO","HIT_SWIRL_HYDRO","HIT_SWIRL_CRYO","HIT_SWIRL_ELECTRO","HIT_BLOOM","HIT_HYPERBLOOM","HIT_BURNING","HIT_BURGEON"),v=kr("REGION","NONE","NAME","MV","STAT","HIT","ELEMENT","TALENT","VALUE","NO_CRIT","CRIT","AVG","STAT_BASE","STAT_FLAT","STAT_PERCENT","STAT_TOTAL","SET","PIECE","LEVEL","BONUS","STARS","CHARACTER","ASCENDED","CURRENT","WEAPON","ARTIFACT","EFFECT","ENABLED","STACKS","AURA","TARGET","CONDITION","DAMAGE","MIN","MAX","HIT","OWNER","RELATIVE","BENEFIT","ROTATION_DAMAGE","DPS");function pu(...e){const a=new Y(v.HIT,v.ELEMENT,v.TALENT,v.NO_CRIT,v.CRIT,v.AVG);return e.forEach(n=>a.AddRow(n.Options.Name,t.stat.Name(n.GetElement()),t.stat.Name(n.Options.Talent),n.DmgNoCrit(!0),n.DmgCrit(!0),n.DmgAvg(!0))),a.String()}function Nu(...e){const a=[];for(let n=0;n<e.length;n++)a[2*n]=du(e[n]),a[2*n+1]=" ".repeat(4);return At(...a)}function du(e){var a;const n=e.GetCharacter();let s;n.IsAscended()?s="+":s="";let r=`(${n.Options.Stars}*) ${n.Options.Name} ${n.GetLevel()}${s}`;r+=` (${n.Get(t.stat.NORMAL_ATTACK_LEVEL)}/${n.Get(t.stat.ELEMENTAL_SKILL_LEVEL)}/${n.Get(t.stat.ELEMENTAL_BURST_LEVEL)})
`;const i=e.GetWeapon();i?(i.IsAscended()?s="+":s="",r+=`(${i.Options.Stars}*) ${i.Options.Name} ${i.GetLevel()}${s} (R${i.GetRank()})
`):r+=`(No weapon)
`;const c=(a=e.GetArtifacts())==null?void 0:a.GetActiveSets();if(c&&c.length>0){const A=c.map(S=>{var h;return(h=re(S))==null?void 0:h.Name});A[0]===A[1]?r+=A[0]+` (4)
`:A.forEach(S=>{S&&S!==""&&(r+=S+` (2)
`)})}const _=new Y(v.STAT,v.VALUE);_.DecimalPlaces=4,_.AddRow(t.stat.Name(t.stat.ATK),n.Get(t.stat.ATK)),_.AddRow(t.stat.Name(t.stat.DEF),n.Get(t.stat.DEF)),_.AddRow(t.stat.Name(t.stat.HP),n.Get(t.stat.HP)),_.AddRow(t.stat.Name(t.stat.CRIT_RATE),n.Get(t.stat.CRIT_RATE)),_.AddRow(t.stat.Name(t.stat.CRIT_DMG),n.Get(t.stat.CRIT_DMG)),_.AddRow(t.stat.Name(t.stat.ENERGY_RECHARGE),n.Get(t.stat.ENERGY_RECHARGE)),_.AddRow(t.stat.Name(t.stat.ELEMENTAL_MASTERY),n.Get(t.stat.ELEMENTAL_MASTERY));const u=n.Options.Element;return _.AddRow(t.stat.Name(u),n.Get(u)),r+=_.String(),r}function Cu(...e){const a=new Y(v.NAME,v.ENABLED,v.STACKS,v.OWNER,v.TARGET);for(const n of e){const s=n.GetTargets().map(r=>r.GetCharacter().Options.Name);a.AddRow(n.Options.Name,n.Enabled(),n.GetStacks(),n.Owner.GetCharacter().Options.Name,s.join(", "))}return a.String()}function Mu(e){let a=e.Options.Name+`
`;const n=new Y(v.OWNER,v.ENABLED,v.STACKS);n.AddRow(e.Owner.GetCharacter().Options.Name,e.Enabled(),e.GetStacks()+"/"+e.Options.MaxStacks),a+=n.String()+`
`;const s=new Y(v.TARGET);for(const c of e.GetTargets())s.AddRow(c.GetCharacter().Options.Name);const r=new Y(v.CONDITION);for(const c of e.Options.Conditions)r.AddRow(c+" ("+e.HasCondition(c)+")");const i=new Y(v.AURA);for(const c of t.aura.Values())e.HasAura(c)&&i.AddRow(t.aura.Name(c));return a+=At(s.String(),r.String(),i.String()),a}function gu(...e){const a=[];for(let n=0;n<e.length;n++)a[2*n]=Gu(e[n]),a[2*n+1]=" ".repeat(4);return At(...a)}function Gu(e){let a=`(${e.GetStars()}*) ${t.piece.Name(e.GetPiece())} (+${e.GetLevel()})
`;const n=e.GetSet();if(n){const r=re(n);r?a+=v.SET+": "+r.Name+`
`:a+=v.SET+": "+v.NONE+`
`}else a+=v.SET+": "+v.NONE+`
`;const s=new Y(v.STAT,v.VALUE);s.DecimalPlaces=4,s.AddRow(t.stat.Name(e.GetMainstat()),e.GetMainstatValue());for(let r=0;r<e.SubstatsLength();r++)s.AddRow(t.stat.Name(e.GetSubstat(r)),e.GetSubstatValue(r));return a+=s.String(),a}function Ru(e){const a=e.FormatRolls(),n=new Y(v.STAT,"","","","","","");return a.forEach(([s,r])=>n.AddRow(t.stat.Name(s),...r)),n.DecimalPlaces=4,`${t.piece.Name(e.GetPiece())}
`+n}function Iu(e){const a=Object.keys(e),n=new Y(...a),s=Math.max(...a.map(r=>e[r].length));for(let r=0;r<s;r++){const i=[];for(const c of a)r<e[c].length?i.push(e[c][r]):i.push(void 0);n.AddRow(...i)}return n}function Ou(e){const a=[];for(const s of e){const r=Object.keys(s);for(const i of r)a.includes(i)||a.push(i)}const n=new Y(...a);for(const s of e)n.AddRow(...a.map(r=>s[r]));return n}function Du(...e){const a=[];for(let n=0;n<e.length;n++)a[2*n]=vu(e[n]),a[2*n+1]=" ".repeat(4);return At(...a)}function vu(e){const a=new Y(v.STAT,v.STAT_BASE,v.STAT_TOTAL);a.AddRow(v.LEVEL,"",e.GetLevel());for(const s of t.Elements){const r=t.DmgToRes(s);a.AddRow(t.stat.Name(r),e.GetBaseRes(r),e.Subject.Get(r))}const n=new Y(v.AURA);for(const s of t.aura.Values())e.HasAura(s)&&n.AddRow(t.aura.Name(s));return a.DecimalPlaces=4,e.name+`
`+At(a.String(),n.String())}function yu(e){const a=Object.keys(e.characters).map(s=>s+`
`+Pu(s,e.characters[s])),n=[];for(let s=0;s<a.length;s++)n[2*s]=a[s],n[2*s+1]=" ".repeat(4);return`${v.ROTATION_DAMAGE}: ${e.damage.toFixed(2)}

${v.DPS}: ${e.dps.toFixed(2)}

`+At(...n)}function Pu(e,a){const n=new Y(v.NAME,v.DAMAGE,v.RELATIVE);n.AddRow(e,a.damage,le(a.relative));for(const s in a.elements){const r=parseInt(s);n.AddRow(t.stat.Name(r),a.elements[s].damage,le(a.elements[s].relative))}for(const s in a.talents){const r=parseInt(s);n.AddRow(t.stat.Name(r),a.talents[s].damage,le(a.talents[s].relative))}for(const s in a.instances)n.AddRow(s,a.instances[s].damage,le(a.instances[s].relative));return n.toString()}var le=e=>e*100;function Hu(...e){const a=new Y("NAME","STARS","TYPE","EFFECTS");for(const n of e){const s=(()=>{if(n instanceof Ot.Food){const r=n.GetRank();return n.Options.Effects.map(([i,c,_])=>{const u=c+(_-c)*(r-1)/2;return`${t.stat.Name(i)}: ${u}`}).join(", ")}else return n.Effects.map(([r,i,c])=>`${t.stat.Name(r)}: ${i}-${c}`).join(", ")})();a.AddRow(n.Name,n.Stars,n.Type,s)}return a.String()}var wu=[{Name:T.hits.HIT_Q_1,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.6816000000000004}]},{Name:T.hits.HIT_Q_2,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.49090000000000006}]}],Bu=l.Factory({Name:"ChevreuseC2",OnApply:new l.Builder().instance.Options({Name:"HIT_C2",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:1.2,Talent:t.stat.NONE}]}).Build()}),bu=l.Factory({Name:"ChevreuseC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Ku=l.Factory({Name:"ChevreuseC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Yu=l.Factory({Name:"ChevreuseC6",ApplyOther:!0,MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG,t.stat.ELECTRO_DMG).Values(.2).Stacks().Build()}),Fu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5313}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.49310000000000004}]},{Name:T.hits.HIT_N3_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2764}]},{Name:T.hits.HIT_N3_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3245}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7726000000000001}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2168999999999999}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],ku=l.Factory({Name:"ChevreuseA1",Conditions:["HIT_OVERLOAD"],ApplyOther:!0,MaxConditions:1,OnApply:new l.Builder().Where({owner:{ascension:1},effect:{conditions:["HIT_OVERLOAD"]}}).stat.Enemy(t.stat.PYRO_RES,t.stat.ELECTRO_RES).Values(-.4).Build()}),Vu=l.Factory({Name:"ChevreuseA4",ApplyOther:!0,MaxConditions:1,OnApply:new l.Builder().Where({owner:{ascension:4},target:{element:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).observe.Owner(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Enemy(t.stat.ATK_PERCENT).Values(1/100).Map((e,a,n)=>{const r=n.Owner.GetCharacter().Get(t.stat.HP);return Math.min(e*r/1e3,.4)}).Build()}),xu=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1520000000000001}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.7280000000000002}]},{Name:T.hits.HIT_E_HOLD+"_2",Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.824}]},{Name:T.hits.HIT_E+"_OUSIA",Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.28800000000000003}]}],Vr=G.Factory({Name:"Chevreuse",Stars:4,Weapon:t.weapon.POLEARM,Element:t.stat.PYRO_DMG,StatBonus:t.stat.HP_PERCENT,BurstCost:60,Region:t.region.FONTAINE,HpBase:[1002.9700927734,3588.6091308594],AtkBase:[16.205280303955,57.983562469482],DefBase:[50.701351165771,181.40849304199],Normals:Fu,Skills:xu,Bursts:wu,Extra:[],Effects:[ku,Vu,Bu,bu,Ku,Yu]}),Uu=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.752}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4315}]}],Wu=new l.Builder().stat.Char(t.stat.CRIT_RATE).Instance("HIT_E").Values(.12).Map((e,a)=>{const n=a.FindEffect("NaviaE");if(!n)throw new Error("NaviaE not found");const s=Math.min(n.GetStacks(),3);return e*s}).Build(),ju=l.Factory({Name:"NaviaC2",OnApply(e,a,n){const s=Wu(e,a,n),r=e.FindEffect("NaviaE");if(!r)throw new Error("NaviaE not found");return n.Observer(r.CreateObserver(l.EffectEvent.CHANGE_STACKS,s)),s}}),zu=l.Factory({Name:"NaviaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),qu=l.Factory({Name:"NaviaC4",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.GEO_RES).Values(-.2).Build()}),$u=l.Factory({Name:"NaviaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Qu=new l.Builder().stat.Char(t.stat.CRIT_DMG).Instance("HIT_E").Values(.45).Map((e,a)=>{const n=a.FindEffect("NaviaE");if(!n)throw new Error("NaviaE not found");const s=Math.max(0,Math.min(n.GetStacks()-3,3));return e*s}).Build(),Xu=l.Factory({Name:"NaviaC6",OnApply(e,a,n){const s=Qu(e,a,n),r=e.FindEffect("NaviaE");if(!r)throw new Error("NaviaE not found");return n.Observer(r.CreateObserver(l.EffectEvent.CHANGE_STACKS,s)),s}}),Ju=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9352}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8651}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3489}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.3343}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6252}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1309}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],Zu=l.Factory({Name:"NaviaA1",OnApply:new l.Builder().Where({target:{ascension:1}}).infusion.Set(t.stat.GEO_DMG,!0).Next().Where({target:{ascension:1}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.4).Build()}),tA=l.Factory({Name:"NaviaA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Party(!0).stat.Char(t.stat.ATK_PERCENT).Values(.2).Map((e,a)=>{var n;const s=((n=a.GetParty())==null?void 0:n.GetMembers())||[a];let r=0;for(const i of s){const c=i.GetCharacter().Options.Element;t.Swirlable.includes(t.DmgToAura(c))&&r++}return r>2&&(r=2),e*r}).Build()}),eA=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.948}]},{Name:T.hits.HIT_E+"_OUSIA",Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.36}]}],aA=l.Factory({Name:"NaviaE2",MaxStacks:6,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Instance(T.hits.HIT_E).Values(.15).Map((e,a,n)=>e*Math.max(0,n.GetStacks()-3)).Next().Where({effect:{conditions:["ALL_STRIKE"]}}).mv.Multiplier(2,T.hits.HIT_E).Build()}),nA=l.Factory({Name:"NaviaE",MaxStacks:11,OnApply:new l.Builder().mv.Multiplier(1,T.hits.HIT_E).Map((e,a,n)=>e*n.GetStacks()/11+1).Build()}),xr=G.Factory({Name:"Navia",Element:t.stat.GEO_DMG,Stars:5,Weapon:t.weapon.CLAYMORE,StatBonus:t.stat.CRIT_DMG,BurstCost:60,Region:t.region.FONTAINE,HpBase:[984.78,4044.0373535156],AtkBase:[27.3714,112.3935546875],DefBase:[61.74456,253.56239318848],Normals:Ju,Skills:eA,Bursts:Uu,Extra:[],Effects:[nA,aA,Zu,tA,ju,zu,qu,$u,Xu]}),sA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4839}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4373}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5512}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.733}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7422}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]},{Name:"HIT_ARKHE",Element:t.stat.HYDRO_DMG,Talent:t.stat.NONE,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.0946}]}],rA=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0786}]},{Name:T.hits.HIT_E_1,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0596}]},{Name:T.hits.HIT_E_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0323}]},{Name:T.hits.HIT_E_3,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0829}]}],iA=l.Factory({Name:"FurinaE",OnApply(e,a,n){const s=lA(e,a,n),r=[],i=()=>{for(const u of r)n.RemoveObserver(u);let c=[];const _=e.GetParty();_&&(c=_.GetMembers());for(const u of c){if(u===e)continue;const A=n.Observer(u.GetCharacter().CreateObserver(t.stat.HP_CURRENT,s));r.push(A)}};return n.Observer(e.Event.CreateObserver(ut.CHANGE_PARTY,i)),i(),()=>0}}),lA=new l.Builder().observe.Party(!0).observe.Target(t.stat.HP_CURRENT).mv.Multiplier(1,/E_\d/).Map((e,a)=>{let n=[];const s=a.GetParty();s?n=s.GetMembers():n=[a];let r=0;for(const i of n)i.GetCharacter().Get(t.stat.HP_CURRENT)>.5&&r++;return r=Math.min(r,4),1+r/10}).Build(),oA=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1141}]}],cA=l.Factory({Name:"FurinaQ",MaxStacks:400,ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ALL_DMG).Values(1).Stacks().Map((e,a,n)=>{let r=.05+.02*n.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL);return r=r*e/100,r}).Build()}),EA=l.Factory({Name:"FurinaA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.HP,t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ALL_DMG).Instance(/E_\d/).Values(.7/100).Map((e,a)=>Math.min(.28,e*a.GetCharacter().Get(t.stat.HP)/1e3)).Build()}),TA=l.Factory({Name:"FurinaC1",OnApply(e,a,n){const s=e.FindEffect("FurinaQ");if(!s)throw new Error("FurinaC1: could not find FurinaQ");let r=0,i=a.Enabled();const c=()=>{const _=s.GetStacks();a.Enabled()?!i&&_<r&&s.SetStacks(r):_>300&&(r=_,s.SetStacks(300)),i=a.Enabled()};return c(),n.Observer(a.CreateObserver(U.ENABLE,c)),n.Observer(a.CreateObserver(U.DISABLE,c)),s.CreateObserver(U.CHANGE_STACKS,c),()=>0}}),_A=l.Factory({Name:"FurinaC2",MaxStacks:400,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.35/100).Stacks().Build()}),uA=l.Factory({Name:"FurinaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),AA=l.Factory({Name:"FurinaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),SA=l.Factory({Name:"FurinaC6",Conditions:["ARKHE_PNEUMA"],MaxConditions:1,OnApply:new l.Builder().infusion.Set(t.stat.HYDRO_DMG,!0).Next().mv.Mv(t.stat.HP,.18,/N\d|Charged|Plunge/i).Next().Where({effect:{conditions:["ARKHE_PNEUMA"]}}).mv.Mv(t.stat.HP,.25,/N\d|Charged|Plunge/i).Build()}),Ur=G.Factory({Name:"Furina",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.SWORD,StatBonus:t.stat.CRIT_RATE,BurstCost:60,Region:t.region.FONTAINE,Normals:sA,Skills:rA,Bursts:oA,Extra:[],Effects:[iA,cA,EA,TA,_A,uA,AA,SA],HpBase:[1191.65,4893.5590820312],AtkBase:[18.9924,77.987365722656],DefBase:[54.146148681641,222.35850524902]}),hA=[{Name:T.hits.HIT_N1,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5458}]},{Name:T.hits.HIT_N2,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4625}]},{Name:T.hits.HIT_N3,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.7234}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.368}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.HP,Scaling:o.TalentScaling.PHYSICAL_1,Initial:.0732}]},{Name:T.hits.HIT_CHARGED+"_C6",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.HP,Scaling:o.TalentScaling.NONE,Initial:.1}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],mA=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1286}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.208}]}],fA=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.2226}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0911}]}],LA=l.Factory({Name:"NeuvilletteA1",MaxStacks:3,OnApply:new l.Builder().Where({target:{ascension:1}}).mv.Multiplier(1,"HIT_CHARGED_2","HIT_CHARGED_C6").Map((e,a,n)=>[0,1.1,1.25,1.6][n.GetStacks()]).Build()}),pA=l.Factory({Name:"NeuvilletteA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.HP_CURRENT).stat.Char(t.stat.HYDRO_DMG).Values(1).Map((e,a)=>Math.min(.3,.6*Math.max(0,a.GetCharacter().Get(t.stat.HP_CURRENT)-.3))).Build()}),NA=l.Factory({Name:"NeuvilletteC2",OnApply(e,a,n){const s=e.FindEffect("NeuvilletteA1");if(!s)throw new Error("NeuvilletteC2: Could not find NeuvilletteA1");const r=e.FindInstance("HIT_CHARGED_2"),i=e.FindInstance("HIT_CHARGED_C6");if(!r)throw new Error("NeuvilletteC2: Could not find HIT_CHARGED_2");if(!i)throw new Error("NeuvilletteC2: Could not find HIT_CHARGED_C6");const c=n.Modifier(r.Subject.CreateModifier(t.stat.CRIT_DMG,0)),_=n.Modifier(i.Subject.CreateModifier(t.stat.CRIT_DMG,0)),u=()=>{if(e.GetCharacter().GetAscension()<1){c.SetValue(0),_.SetValue(0);return}const A=s.GetStacks();c.SetValue(.14*A),_.SetValue(.14*A)};return u(),n.Observer(s.CreateObserver(l.EffectEvent.CHANGE_STACKS,u)),n.Observer(e.GetCharacter().CreateObserver(t.stat.LEVEL,u)),n.Observer(e.GetCharacter().CreateObserver(t.stat.ASCENSION,u)),()=>0}}),dA=l.Factory({Name:"NeuvilletteC3",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_LEVEL_UP).Values(3).Build()}),CA=l.Factory({Name:"NeuvilletteC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Wr=G.Factory({Name:"Neuvillette",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.CATALYST,StatBonus:t.stat.CRIT_DMG,BurstCost:70,Region:t.region.FONTAINE,HpBase:[1143.984,4697.8169],AtkBase:[16.218,66.595],DefBase:[44.8725,184.275],Normals:hA,Skills:mA,Bursts:fA,Extra:[],Effects:[LA,pA,NA,dA,CA]}),MA=l.Factory({Name:"MikaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),gA=l.Factory({Name:"MikaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),GA=l.Factory({Name:"MikaC6",ApplyOther:!0,MaxTargets:1,OnApply:new l.Builder().stat.Char(t.stat.PHYSICAL_CRIT_DMG).Values(.6).Build()}),RA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4326}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.415}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.545}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2761}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7087}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1275}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],IA=l.Factory({Name:"MikaA1",MaxStacks:4,ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.PHYSICAL_DMG).Values(.1).Stacks().Build()}),OA=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.252}]}],jr=G.Factory({Name:"Mika",Element:t.stat.CRYO_DMG,Stars:4,Weapon:t.weapon.POLEARM,StatBonus:t.stat.HP_PERCENT,BurstCost:70,Region:t.region.MONDSTADT,HpBase:[1048.5597,3751.7275],AtkBase:[18.6984,66.90411],DefBase:[59.800125,213.96375],Normals:RA,Skills:OA,Bursts:[],Extra:[],Effects:[IA,MA,gA,GA]}),DA=[{Name:T.hits.HIT_N1+"_Q",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.987},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0169}]},{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.393},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.0239}]}],vA=l.Factory({Name:"DehyaC1",OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2).Next().mv.Mv(t.stat.HP,.036,e=>e.Options.Talent===t.stat.ELEMENTAL_SKILL_DMG).Next().mv.Mv(t.stat.HP,.06,e=>e.Options.Talent===t.stat.ELEMENTAL_BURST_DMG).Build()}),yA=l.Factory({Name:"DehyaC2",OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Instance("HIT_E_DOT").Values(.5).Build()}),PA=l.Factory({Name:"DehyaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),HA=l.Factory({Name:"DehyaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),wA=l.Factory({Name:"DehyaC6",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.1).Next().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_DMG).Values(.15).Stacks().Build()}),BA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6212}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6171}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7663}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9529}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5633}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0182}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],bA=[{Name:T.hits.HIT_E_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1288}]},{Name:T.hits.HIT_E_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.328}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.602},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0103}]}],zr=G.Factory({Name:"Dehya",Stars:5,Element:t.stat.PYRO_DMG,Weapon:t.weapon.CLAYMORE,StatBonus:t.stat.HP_PERCENT,Region:t.region.SUMERU,BurstCost:70,HpBase:[1220.2496,5011.0044],AtkBase:[20.6682,84.8686],DefBase:[48.88111,200.7369],Normals:BA,Skills:bA,Bursts:DA,Extra:[],Effects:[vA,yA,PA,HA,wA]}),KA=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.776}]}],YA=l.Factory({Name:"FaruzanQ",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.ANEMO_RES).Values(-.3).Next().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ANEMO_DMG).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(e=>e*.18).Build()}),FA=l.Factory({Name:"FaruzanC3",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),kA=l.Factory({Name:"FaruzanC5",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),VA=l.Factory({Name:"FaruzanC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ANEMO_CRIT_DMG).Values(.4).Build()}),xA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4473}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4219}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5316}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7062}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],UA=l.Factory({Name:"FaruzanA4",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:4}}).observe.Owner(t.stat.ATK_BASE).stat.Char(t.stat.ANEMO_DMG_FLAT).Values(.32).Map((e,a,n)=>n.Owner.GetCharacter().Get(t.stat.ATK_BASE)*e).Build()}),WA=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.488}]},{Name:T.hits.HIT_E_2,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.08}]}],qr=G.Factory({Name:"Faruzan",Stars:4,Element:t.stat.ANEMO_DMG,Weapon:t.weapon.BOW,StatBonus:t.stat.ATK_PERCENT,BurstCost:80,Region:t.region.SUMERU,HpBase:[802.3761,2870.8872],AtkBase:[16.4724,58.939335],DefBase:[52.647,188.37],Normals:xA,Skills:WA,Bursts:KA,Extra:[],Effects:[YA,UA,FA,kA,VA]}),jA=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1843}]},{Name:T.hits.HIT_Q_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.2253}]}],zA=l.Factory({Name:"NilouC1",OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Instance("HIT_E_3_1").Values(.65).Build()}),qA=l.Factory({Name:"NilouC2",ApplyOther:!0,Conditions:["BLOOM"],MaxConditions:1,OnApply:new l.Builder().Where({owner:{ascension:1}}).stat.Enemy(t.stat.HYDRO_RES).Values(-.35).Next().Where({owner:{ascension:1},effect:{conditions:["BLOOM"]}}).stat.Enemy(t.stat.DENDRO_RES).Values(-.35).Build()}),$A=l.Factory({Name:"NilouC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),QA=l.Factory({Name:"NilouC4",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.5).Build()}),XA=l.Factory({Name:"NilouC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),JA=l.Factory({Name:"NilouC6",OnApply:new l.Builder().observe.Target(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.Char(t.stat.CRIT_RATE).Values(.6/100).Map((e,a)=>Math.max(0,Math.min(.3,e*a.GetCharacter().Get(t.stat.HP)/1e3))).Next().observe.Target(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.Char(t.stat.CRIT_DMG).Values(1.2/100).Map((e,a)=>Math.max(0,Math.min(.6,e*a.GetCharacter().Get(t.stat.HP)/1e3))).Build()}),ZA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5031}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4544}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7035}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5022}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5444}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}];function $r(e){const a=e.GetParty();if(!a)return!1;let n=!1,s=!1;for(const r of a.GetMembers()){const i=r.GetCharacter().Options.Element;if(i===t.stat.DENDRO_DMG)n=!0;else if(i===t.stat.HYDRO_DMG)s=!0;else return!1}return n&&s}var tS=l.Factory({Name:"NilouA1",ApplyOther:!0,OnApply:new l.Builder().Where((e,a)=>a.GetCharacter().GetAscension()<1?!1:$r(e)).observe.Party(!0).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100).Build()}),eS=l.Factory({Name:"NilouA4",ApplyOther:!0,OnApply:new l.Builder().Where((e,a)=>a.GetCharacter().GetAscension()<4?!1:$r(e)).observe.Party(!0).observe.Owner(t.stat.HP_FLAT,t.stat.HP_BASE,t.stat.HP_PERCENT).stat.Char(t.stat.BLOOM_DMG).Values(.09).Map((e,a,n)=>Math.max(0,Math.min(4,(n.Owner.GetCharacter().Get(t.stat.HP)-3e4)*e/1e3))).Build()}),aS=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0334}]},{Name:T.hits.HIT_E_1+"_1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0455}]},{Name:T.hits.HIT_E_1+"_2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0326}]},{Name:T.hits.HIT_E_2+"_1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0514}]},{Name:T.hits.HIT_E_2+"_2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0396}]},{Name:T.hits.HIT_E_3+"_1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0717}]},{Name:T.hits.HIT_E_3+"_2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0506}]}],Qr=G.Factory({Name:"Nilou",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.SWORD,StatBonus:t.stat.HP_PERCENT,Region:t.region.SUMERU,BurstCost:70,HpBase:[1182.1168,4854.4106],AtkBase:[17.8752,73.39987],DefBase:[56.71884,232.9236],Normals:ZA,Skills:aS,Bursts:jA,Extra:[],Effects:[tS,eS,zA,qA,$A,QA,XA,JA]}),Xe=new Set,Je=[.025,.05,.075,.115];function nS(e){const a=e.FindEffect("YunjinA4");if(!a||!a.Enabled()||e.GetCharacter().GetAscension()<4)return 0;const n=e.GetParty();if(!n)return Je[0];Xe.clear();for(const r of n.GetMembers()){const i=r.GetCharacter().Options.Element;Xe.add(i)}const s=Math.max(1,Math.min(Je.length,Xe.size));return Je[s-1]}var sS=l.Factory({Name:"YunjinA4",OnApply(e,a,n){const s=e.FindEffect("YunjinQ");if(!s)throw new Error("Yunjin Burst effect not found");const r=s;function i(){r.Enabled()&&(r.Disable(),r.Enable())}return i(),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,i)),n.Observer(a.CreateObserver(l.EffectEvent.DISABLE,i)),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_TARGET,i)),()=>0}}),rS=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.44}]}],iS=l.Factory({Name:"YunjinQ",ApplyOther:!0,OnApply:new l.Builder().observe.Party(!0).observe.Owner(t.stat.DEF_PERCENT,t.stat.DEF_BASE,t.stat.DEF_FLAT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a,n)=>(.3216*e+nS(n.Owner))*n.Owner.GetCharacter().Get(t.stat.DEF)).Build()}),lS=l.Factory({Name:"YunjinC2",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.15).Build()}),oS=l.Factory({Name:"YunjinC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),cS=l.Factory({Name:"YunjinC4",OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.2).Build()}),ES=l.Factory({Name:"YunjinC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),TS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4051}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4025}]},{Name:T.hits.HIT_N3_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2296}]},{Name:T.hits.HIT_N3_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2752}]},{Name:T.hits.HIT_N4_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2399}]},{Name:T.hits.HIT_N4_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2881}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6734}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2169}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],_S=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.4912}]},{Name:T.hits.HIT_E_1,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.6096}]},{Name:T.hits.HIT_E_2,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.728}]}],Xr=G.Factory({Name:"Yunjin",Stars:4,Weapon:t.weapon.POLEARM,Element:t.stat.GEO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Region:t.region.LIYUE,BurstCost:60,HpBase:[893.5552,3197.1245],AtkBase:[16.0272,57.34638],DefBase:[61.5741,220.311],Normals:TS,Skills:_S,Bursts:rS,Extra:[],Effects:[iS,sS,lS,oS,cS,ES]}),uS=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.272}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.22}]}],AS=l.Factory({Name:"YoimiyaC1",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()}),SS=l.Factory({Name:"YoimiyaC2",OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Values(.25).Build()}),hS=l.Factory({Name:"YoimiyaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),mS=l.Factory({Name:"YoimiyaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),fS=l.Factory({Name:"YoimiyaC6",OnApply:new l.Builder().instance.Location("Normal").Options({Name:"HIT_C6",Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Talent:t.stat.NORMAL_ATTACK_LEVEL,Initial:.164*.6}]}).Build()}),LS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3564}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6838}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8889}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4642}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0586}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_KindlingArrow",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.164}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],pS=l.Factory({Name:"YoimiyaA1",MaxStacks:10,OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.PYRO_DMG).Values(.02).Stacks().Build()}),NS=l.Factory({Name:"YoimiyaA4",ApplyOther:!0,ApplySelf:!1,OnApply(e,a,n){const s=e.GetCharacter(),r=a.Owner.GetCharacter(),i=a.Owner.FindEffect("YoimiyaA1");if(!i)throw new Error("Cannot find Yoimiya A1");const c=n.Modifier(s.CreateModifier(t.stat.ATK_PERCENT,0)),_=()=>{if(r.GetAscension()<4){c.SetValue(0);return}c.SetValue(.1+.01*i.GetStacks())};return _(),n.Observer(r.CreateObserver(t.stat.LEVEL,_)),n.Observer(r.CreateObserver(t.stat.ASCENSION,_)),n.Observer(i.CreateObserver(l.EffectEvent.CHANGE_STACKS,_)),()=>0}}),dS=l.Factory({Name:"YoimiyaE",OnApply:new l.Builder().infusion.Set(t.stat.PYRO_DMG,!0).Next().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.3791,/hit_n\d/i).Map((e,a)=>1+e*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),Jr=G.Factory({Name:"Yoimiya",Stars:5,Weapon:t.weapon.BOW,Element:t.stat.PYRO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.INAZUMA,BurstCost:60,HpBase:[791.2556,3249.3232],AtkBase:[25.137,103.21857],DefBase:[47.864,196.56],Normals:LS,Skills:[],Bursts:uS,Extra:[],Effects:[dS,pS,NS,AS,SS,hS,mS,fS]}),CS=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.824}]}],MS=l.Factory({Name:"YanfeiQ",OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(...o.TalentScaling.ELEMENTAL_2).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(e=>.334*e).Build()}),gS=l.Factory({Name:"YanfeiC2",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_RATE).Values(.2).Build()}),GS=l.Factory({Name:"YanfeiC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),RS=l.Factory({Name:"YanfeiC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),IS=[{Name:T.hits.HIT_N1,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5834}]},{Name:T.hits.HIT_N2,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5213}]},{Name:T.hits.HIT_N3,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.7601}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_2,Initial:.9823}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],OS=l.Factory({Name:"YanfeiA1",OnApply(e,a,n){const s=e.GetCharacter(),r=e.FindEffect("YanfeiSeal");if(!r)throw new Error("Cannot find Yanfei Scarlet Seals");const i=n.Modifier(s.CreateModifier(t.stat.PYRO_DMG,0)),c=()=>{if(s.GetAscension()<1){i.SetValue(0);return}i.SetValue(r.GetStacks()*.05)};return c(),n.Observer(r.CreateObserver(l.EffectEvent.CHANGE_STACKS,c)),n.Observer(s.CreateObserver(t.stat.LEVEL,c)),n.Observer(s.CreateObserver(t.stat.ASCENSION,c)),()=>0}}),DS=l.Factory({Name:"YanfeiA4",OnApply:new l.Builder().Where({target:{ascension:4}}).instance.Location("Normal").Options({Name:"HIT_A4",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Initial:.8,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),vS=l.Factory({Name:"YanfeiSeal",MaxStacks:4,OnApply:new l.Builder().observe.Target(t.stat.NORMAL_ATTACK_LEVEL,t.stat.NORMAL_ATTACK_LEVEL_UP).mv.Mv(t.stat.ATK,.1733,"HIT_CHARGED").Map((e,a,n)=>e*n.GetStacks()*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.NORMAL_ATTACK_LEVEL)-1]).Build()}),yS=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.696}]}],Zr=G.Factory({Name:"Yanfei",Stars:4,Element:t.stat.PYRO_DMG,StatBonus:t.stat.PYRO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.LIYUE,BurstCost:80,HpBase:[784.14026,2805.64],AtkBase:[20.12304,72.001564],DefBase:[49.2135,176.085],Normals:IS,Skills:yS,Bursts:CS,Extra:[],Effects:[vS,MS,OS,DS,gS,GS,RS]}),PS=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.6}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.3382}]}],HS=l.Factory({Name:"YaeC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),wS=l.Factory({Name:"YaeC4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.2).Build()}),BS=l.Factory({Name:"YaeC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),bS=l.Factory({Name:"YaeC6",OnApply:new l.Builder().stat.Char(t.stat.DEFIGNORED).Instance(/HIT_E_\d/i).Values(.6).Build()}),KS=[{Name:T.hits.HIT_N1,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3966}]},{Name:T.hits.HIT_N2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3852}]},{Name:T.hits.HIT_N3,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5689}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4289}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],YS=l.Factory({Name:"YaeA4",OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({target:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.15/100).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()}),FS=[{Name:T.hits.HIT_E_1,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6067}]},{Name:T.hits.HIT_E_2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7584}]},{Name:T.hits.HIT_E_3,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.948}]},{Name:T.hits.HIT_E_4,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.185}]}],ti=G.Factory({Name:"Yae",Stars:5,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_RATE,Weapon:t.weapon.CATALYST,Region:t.region.INAZUMA,BurstCost:90,HpBase:[807.46204,3315.8757],AtkBase:[26.4404,108.57064],DefBase:[44.2742,181.818],Normals:KS,Skills:FS,Bursts:PS,Extra:[],Effects:[YS,HS,wS,BS,bS]}),kS=l.Factory({Name:"XiaoQ",OnApply:new l.Builder().infusion.Set(t.stat.ANEMO_DMG,!0).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(...o.TalentScaling.ELEMENTAL_2).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(e=>.5845*e).Build()}),VS=l.Factory({Name:"XiaoC2",OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.25).Build()}),xS=l.Factory({Name:"XiaoC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),US=l.Factory({Name:"XiaoC4",OnApply:new l.Builder().Where({target:{hp:{leq:.5}}}).stat.Char(t.stat.DEF_PERCENT).Values(1).Build()}),WS=l.Factory({Name:"XiaoC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),jS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.2754}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.5694}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6855}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.3766}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.7154}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.9583}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.2109}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],zS=l.Factory({Name:"XiaoA1",MaxStacks:5,OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.ALL_DMG).Values(.05).Stacks().Build()}),qS=l.Factory({Name:"XiaoA4",MaxStacks:3,OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.15).Stacks().Build()}),$S=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.528}]}],ei=G.Factory({Name:"Xiao",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.CRIT_RATE,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,BurstCost:70,HpBase:[991.4528,4071.4412],AtkBase:[27.1852,111.628975],DefBase:[62.2232,255.528],Normals:jS,Skills:$S,Bursts:[],Extra:[],Effects:[kS,zS,qS,VS,xS,US,WS]}),QS=[{Name:T.hits.HIT_Q_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]},{Name:T.hits.HIT_Q_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_Q_3,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.096}]},{Name:"HIT_PYRONADO",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.12}]}],XS=l.Factory({Name:"XianglingC1",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.PYRO_RES).Values(-.15).Build()}),JS=l.Factory({Name:"XianglingC2",OnApply:new l.Builder().instance.Options({Name:"HIT_C2",Element:t.stat.PYRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.75,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),ZS=l.Factory({Name:"XianglingC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),t0=l.Factory({Name:"XianglingC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),e0=l.Factory({Name:"XianglingC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Build()}),a0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4205}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4214}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2606}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.141}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7104}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.2169}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],n0=l.Factory({Name:"XianglingA4",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.ATK_PERCENT).Values(.1).Build()}),s0=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1128}]}],ai=G.Factory({Name:"Xiangling",Stars:4,Element:t.stat.PYRO_DMG,StatBonus:t.stat.ELEMENTAL_MASTERY,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,BurstCost:80,HpBase:[911.791,3262.3718],AtkBase:[18.87648,67.54129],DefBase:[56.0805,200.655],Normals:a0,Skills:s0,Bursts:QS,Extra:[],Effects:[n0,XS,JS,ZS,t0,e0]}),r0=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.472}]}],i0=l.Factory({Name:"WandererC1",OnApply(e,a,n){if(!e.FindEffect("WandererA4"))throw new Error("Cannot find Wanderer A4");let r;const i=()=>{const c=e.FindInstance("HIT_A4");!c||r||(r=n.Mv({Stat:t.stat.ATK,Value:.25,Enabled:!0},c))};return i(),n.Observer(e.GetCharacter().CreateObserver(t.stat.LEVEL,i)),n.Observer(e.GetCharacter().CreateObserver(t.stat.ASCENSION,i)),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,i)),n.Observer(a.CreateObserver(l.EffectEvent.DISABLE,i)),()=>0}}),l0=l.Factory({Name:"WandererC2",MaxStacks:120,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.04).Stacks().Map(e=>Math.min(2,e)).Build()}),o0=l.Factory({Name:"WandererC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),c0=l.Factory({Name:"WandererC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),E0=[{Name:T.hits.HIT_N1,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6871}]},{Name:T.hits.HIT_N2,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6502}]},{Name:T.hits.HIT_N3,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4764}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.3208}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]},{Name:T.hits.HIT_N1+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6871*.4}]},{Name:T.hits.HIT_N2+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6502*.4}]},{Name:T.hits.HIT_N3+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4764*.4}]}],T0=l.Factory({Name:"WandererA1",MaxAuras:1,ValidAuras:t.Swirlable,OnApply:new l.Builder().Where({target:{ascension:1},effect:{affected:[t.stat.PYRO_DMG]}}).stat.Char(t.stat.ATK_PERCENT).Values(.3).Next().Where({target:{ascension:1},effect:{affected:[t.stat.CRYO_DMG]}}).stat.Char(t.stat.CRIT_RATE).Values(.2).Build()}),_0=l.Factory({Name:"WandererA4",OnApply:new l.Builder().Where({target:{ascension:4}}).instance.Options({Name:"HIT_A4",Element:t.stat.ANEMO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.35,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),u0=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.952}]}],A0=l.Factory({Name:"WandererE",OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.3298,/hit_n\d/i).Map((e,a)=>1+e*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.2639,/hit_charged/i).Map((e,a)=>1+e*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),ni=G.Factory({Name:"Wanderer",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.SUMERU,BurstCost:60,HpBase:[791.2556,3249.3232],AtkBase:[25.5094,104.747734],DefBase:[47.2657,194.103],Normals:E0,Skills:u0,Bursts:r0,Extra:[],Effects:[A0,T0,_0,i0,l0,o0,c0]}),S0=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.376}]}],h0=l.Factory({Name:"VentiQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,n){m0(e,a,n);function s(){const r=e.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!r)return;const i=a.GetAuras()[0];!i||(r.Options.Element=t.AuraToDmg(i))}return s(),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,s)),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,s)),()=>0}}),m0=new l.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.188,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),f0=l.Factory({Name:"VentiC1",OnApply:new l.Builder().instance.Location("Normal").Options({Name:"HIT_C1",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:.4386*.33}]}).Next().instance.Location("Normal").Options({Name:"HIT_CHARGED_C1",Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:1.24*.33}]}).Next().Build()}),L0=l.Factory({Name:"VentiC2",ApplyOther:!0,Conditions:["AIRBORNE","NO_AIRBORNE"],MaxConditions:1,OnApply:new l.Builder().stat.Enemy(t.stat.ANEMO_RES,t.stat.PHYSICAL_RES).Values(-.12).Next().Where({effect:{conditions:["AIRBORNE"]}}).stat.Enemy(t.stat.ANEMO_RES,t.stat.PHYSICAL_RES).Values(-.12).Build()}),p0=l.Factory({Name:"VentiC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),N0=l.Factory({Name:"VentiC4",OnApply:new l.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.25).Build()}),d0=l.Factory({Name:"VentiC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),C0=l.Factory({Name:"VentiC6",ApplyOther:!0,OnApply(e,a,n){const s=e.GetCharacter().GetEnemy(),r=a.Owner.FindEffect("VentiQ");if(!r)throw new Error("Venti Q not found");n.Modifier(s.Subject.CreateModifier(t.stat.ANEMO_RES,-.2));const i=n.Modifier(s.Subject.CreateModifier(t.stat.ANEMO_RES,0)),c=()=>{const _=r.GetAuras();if(!_.length||_[0]===t.aura.NONE)i.SetValue(0);else{const u=t.DmgToRes(t.AuraToDmg(_[0]));i.SetValue(-.2),i.SetProp(u)}};return c(),n.Observer(r.CreateObserver(l.EffectEvent.CHANGE_AURAS,c)),()=>0}}),M0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2038}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4438}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5237}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2606}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5065}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7095}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],g0=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.76}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.8}]}],si=G.Factory({Name:"Venti",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Weapon:t.weapon.BOW,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[819.8552,3366.7688],AtkBase:[20.482,84.10402],DefBase:[52.0521,213.759],Normals:M0,Skills:g0,Bursts:S0,Extra:[],Effects:[h0,f0,L0,p0,N0,d0,C0]}),G0=[{Name:T.hits.HIT_Q+"_MELEE",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.64}]},{Name:T.hits.HIT_Q+"_RANGED",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.784}]},{Name:"HIT_RiptideBlast",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2}]}],R0=l.Factory({Name:"TartagliaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),I0=l.Factory({Name:"TartagliaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),O0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4128}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4627}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5538}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5702}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6089}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7276}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_RiptideFlash",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.124}]},{Name:"HIT_RiptideBurst",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.62}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],D0=l.Factory({Name:"TartagliaA0",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_LEVEL_UP).Values(1).Build()}),v0=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]},{Name:T.hits.HIT_N1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3887}]},{Name:T.hits.HIT_N2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4162}]},{Name:T.hits.HIT_N3+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5633}]},{Name:T.hits.HIT_N4+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5994}]},{Name:T.hits.HIT_N5+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.553}]},{Name:T.hits.HIT_N6_1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3543}]},{Name:T.hits.HIT_N6_2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3767}]},{Name:T.hits.HIT_CHARGED_1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.602}]},{Name:T.hits.HIT_CHARGED_2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7198}]},{Name:"HIT_RiptideSlash",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.602}]}],ri=G.Factory({Name:"Tartaglia",Stars:5,Weapon:t.weapon.BOW,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.HYDRO_DMG,Region:t.region.SNEZHNAYA,BurstCost:60,HpBase:[1020.0524,4188.8867],AtkBase:[23.4612,96.33733],DefBase:[63.4198,260.442],Normals:O0,Skills:v0,Bursts:G0,Extra:[],Effects:[D0,R0,I0]}),y0=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.48}]}],P0=l.Factory({Name:"SucroseQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,n){H0(e,a,n);function s(){const r=e.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!r)return;const i=a.GetAuras()[0];!i||(r.Options.Element=t.AuraToDmg(i))}return s(),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,s)),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,s)),()=>0}}),H0=new l.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.44,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),w0=l.Factory({Name:"SucroseC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),B0=l.Factory({Name:"SucroseC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),b0=l.Factory({Name:"SucroseC6",ApplyOther:!0,OnApply(e,a,n){const s=a.Owner.FindEffect("SucroseQ"),r=e.GetCharacter();if(!s)throw new Error("Cannot find Sucrose Q");const i=n.Modifier(r.CreateModifier(t.stat.PYRO_DMG,0)),c=()=>{const _=s.GetAuras();(!_.length||_[0]===t.aura.NONE)&&i.SetValue(0);const u=t.AuraToDmg(_[0]);i.SetProp(u),i.SetValue(.2)};return c(),n.Observer(s.CreateObserver(l.EffectEvent.CHANGE_AURAS,c)),()=>0}}),K0=[{Name:T.hits.HIT_N1,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3346}]},{Name:T.hits.HIT_N2,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3062}]},{Name:T.hits.HIT_N3,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3845}]},{Name:T.hits.HIT_N4,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4792}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.2016}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],Y0=l.Factory({Name:"SucroseA1",ApplySelf:!1,ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(50).Build()}),F0=l.Factory({Name:"SucroseA4",ApplySelf:!1,ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_MASTERY).Where({owner:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(.2).Map((e,a,n)=>e*n.Owner.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()}),k0=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.112}]}],ii=G.Factory({Name:"Sucrose",Stars:4,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ANEMO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.MONDSTADT,BurstCost:80,HpBase:[775.02234,2773.016],AtkBase:[14.2464,50.97456],DefBase:[58.94175,210.8925],Normals:K0,Skills:k0,Bursts:y0,Extra:[],Effects:[P0,Y0,F0,w0,B0,b0]}),V0=l.Factory({Name:"ShenheA1",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.CRYO_DMG).Values(.15).Build()}),x0=l.Factory({Name:"ShenheA4",ApplyOther:!0,Conditions:["PRESS","HOLD"],MaxConditions:1,OnApply:new l.Builder().Where({owner:{ascension:4},effect:{conditions:["PRESS"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.15).Next().Where({owner:{ascension:4},effect:{conditions:["HOLD"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.15).Build()}),U0=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.008}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3312}]}],W0=l.Factory({Name:"ShenheQ",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Enemy(t.stat.CRYO_RES,t.stat.PHYSICAL_RES).Values(-.06,-.07,-.08,-.09,-.1,-.11,-.12,-.13,-.14,-.15).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),j0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4326}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4025}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5332}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2632}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6562}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1067}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],z0=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.392}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.888}]}],q0=l.Factory({Name:"ShenheE",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP,t.stat.ATK_PERCENT,t.stat.ATK_BASE,t.stat.ATK_FLAT).stat.Char(t.stat.CRYO_DMG_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a,n)=>.4566*e*n.Owner.GetCharacter().Get(t.stat.ATK)).Build()}),$0=l.Factory({Name:"ShenheC2",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.CRYO_CRIT_DMG).Values(.15).Build()}),Q0=l.Factory({Name:"ShenheC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),X0=l.Factory({Name:"ShenheC4",MaxStacks:50,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.05).Stacks().Build()}),J0=l.Factory({Name:"ShenheC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),li=G.Factory({Name:"Shenhe",Stars:5,Element:t.stat.CRYO_DMG,Weapon:t.weapon.POLEARM,StatBonus:t.stat.ATK_PERCENT,Region:t.region.LIYUE,BurstCost:80,HpBase:[1011.47253,4153.653],AtkBase:[23.6474,97.10191],DefBase:[64.6164,265.356],Normals:j0,Skills:z0,Bursts:U0,Extra:[],Effects:[q0,W0,V0,x0,$0,Q0,X0,J0]}),Z0=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1042}]}],th=l.Factory({Name:"KokomiQ",OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.0484,/HIT_N\d/i).Map((e,a)=>e*o.TalentScaling.ELEMENTAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.0678,/charged/i).Map((e,a)=>e*o.TalentScaling.ELEMENTAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.071,/HIT_E$/i).Map((e,a)=>e*o.TalentScaling.ELEMENTAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Build()}),eh=l.Factory({Name:"KokomiC1",OnApply:new l.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.HYDRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.HP,Initial:.3,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Build()}),ah=l.Factory({Name:"KokomiC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),nh=l.Factory({Name:"KokomiC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),sh=l.Factory({Name:"KokomiC6",OnApply:new l.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.4).Build()}),rh=[{Name:T.hits.HIT_N1,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6838}]},{Name:T.hits.HIT_N2,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6154}]},{Name:T.hits.HIT_N3,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.9431}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4832}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],ih=l.Factory({Name:"KokomiA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.HEALING_BONUS).Values(.25).Next().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Values(-1).Next().Build()}),lh=l.Factory({Name:"KokomiA4",OnApply(e,a,n){const s=e.GetCharacter(),r=e.FindEffect("KokomiQ");if(!r)throw new Error("Kokomi Q effect not found");const i=ne(e.GetNormals(),[/HIT_N\d/i]),c=ne(e.GetNormals(),[/charged/i]),_=n.Mv({Stat:t.stat.HP,Value:0,Enabled:!0},...i),u=n.Mv({Stat:t.stat.HP,Value:0,Enabled:!0},...c),A=()=>{(!r.Enabled()||s.GetAscension()<4)&&(_.Value=0,u.Value=0);const S=s.Get(t.stat.HEALING_BONUS);_.Value=u.Value=.15*S};return A(),n.Observer(s.CreateObserver(t.stat.HEALING_BONUS,A)),n.Observer(r.CreateObserver(l.EffectEvent.ENABLE,A)),n.Observer(r.CreateObserver(l.EffectEvent.DISABLE,A)),()=>0}}),oh=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.0919}]}],oi=G.Factory({Name:"Kokomi",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.HYDRO_DMG,Region:t.region.INAZUMA,BurstCost:70,HpBase:[1048.652,4306.332],AtkBase:[18.2476,74.92904],DefBase:[51.15465,210.0735],Normals:rh,Skills:oh,Bursts:Z0,Extra:[],Effects:[th,ih,lh,eh,ah,nh,sh]}),ch=[{Name:T.hits.HIT_Q_1,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.04}]},{Name:T.hits.HIT_Q_2,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.52}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]}],Eh=l.Factory({Name:"RosariaC1",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.1).Build()}),Th=l.Factory({Name:"RosariaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),_h=l.Factory({Name:"RosariaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),uh=l.Factory({Name:"RosariaC6",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.PHYSICAL_RES).Values(-.2).Build()}),Ah=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5246}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.516}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3182}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6966}]},{Name:T.hits.HIT_N5_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4162}]},{Name:T.hits.HIT_N5_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.43}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.3674}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Sh=l.Factory({Name:"RosariaA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Values(.12).Build()}),hh=l.Factory({Name:"RosariaA4",ApplySelf:!1,ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.CRIT_RATE).Where({owner:{ascension:4}}).stat.Char(t.stat.CRIT_RATE).Values(.15).Map((e,a,n)=>Math.max(0,Math.min(1,e*n.Owner.GetCharacter().Get(t.stat.CRIT_RATE)))).Build()}),mh=[{Name:T.hits.HIT_E_1,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.584}]},{Name:T.hits.HIT_E_2,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.36}]}],ci=G.Factory({Name:"Rosaria",Stars:4,Weapon:t.weapon.POLEARM,Element:t.stat.CRYO_DMG,Region:t.region.MONDSTADT,StatBonus:t.stat.ATK_PERCENT,BurstCost:60,HpBase:[1030.3239,3686.4802],AtkBase:[20.12304,72.001564],DefBase:[59.514,212.94],Normals:Ah,Skills:mh,Bursts:ch,Extra:[],Effects:[Sh,hh,Eh,Th,_h,uh]}),fh=[{Name:T.hits.HIT_Q_1,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672}]},{Name:T.hits.HIT_Q_2,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.928}]}],Lh=l.Factory({Name:"NoelleQ",OnApply:new l.Builder().infusion.Set(t.stat.GEO_DMG,!0).Next().observe.Target(t.stat.DEF_FLAT,t.stat.DEF_PERCENT,t.stat.DEF_FLAT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(.4,.43,.46,.5,.53,.56,.6,.64,.68,.72,.76,.8,.85,.9,.95).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a)=>e*a.GetCharacter().Get(t.stat.DEF)).Build()}),ph=l.Factory({Name:"NoelleC2",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()}),Nh=l.Factory({Name:"NoelleC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),dh=l.Factory({Name:"NoelleC4",OnApply:new l.Builder().instance.Location("Skill").Options({Name:"HIT_C4",Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:4}]}).Build()}),Ch=l.Factory({Name:"NoelleC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Mh=l.Factory({Name:"NoelleC6",OnApply(e,a,n){const s=e.GetCharacter(),r=e.FindEffect("NoelleQ");if(!r)throw new Error("Noelle Q effect not found");const i=n.Modifier(s.CreateModifier(t.stat.ATK_FLAT,0)),c=()=>{r.Enabled()?i.SetValue(.5*s.Get(t.stat.DEF)):i.SetValue(0)};return c(),n.Observer(s.CreateObserver(t.stat.DEF_FLAT,c)),n.Observer(s.CreateObserver(t.stat.DEF_PERCENT,c)),n.Observer(s.CreateObserver(t.stat.DEF_BASE,c)),n.Observer(r.CreateObserver(l.EffectEvent.ENABLE,c)),n.Observer(r.CreateObserver(l.EffectEvent.DISABLE,c)),()=>0}}),gh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7912}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7336}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8626}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1343}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5074}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9047}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],Gh=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:1.2}]}],Ei=G.Factory({Name:"Noelle",Stars:4,Element:t.stat.GEO_DMG,StatBonus:t.stat.DEF_PERCENT,BurstCost:60,Region:t.region.MONDSTADT,Weapon:t.weapon.CLAYMORE,HpBase:[1012.088,3621.2327],AtkBase:[16.0272,57.34638],DefBase:[66.95325,239.5575],Normals:gh,Skills:Gh,Bursts:fh,Extra:[],Effects:[Lh,ph,Nh,dh,Ch,Mh]}),Rh=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.8696}]}],Ih=l.Factory({Name:"NingguangC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Oh=l.Factory({Name:"NingguangC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Dh=[{Name:T.hits.HIT_N1,Element:t.stat.GEO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.28}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.7408}]},{Name:"HIT_Jade",Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.496}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],vh=l.Factory({Name:"NingguangA4",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.GEO_DMG).Values(.12).Build()}),yh=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.304}]}],Ti=G.Factory({Name:"Ningguang",Stars:4,Element:t.stat.GEO_DMG,StatBonus:t.stat.GEO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.LIYUE,BurstCost:40,HpBase:[820.6119,2936.1348],AtkBase:[17.808,63.7182],DefBase:[48.069,171.99],Normals:Dh,Skills:yh,Bursts:Rh,Extra:[],Effects:[vh,Ih,Oh]}),Ph=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.424}]}],Hh=l.Factory({Name:"MonaQ",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ALL_DMG).Values(.4,.42,.44,.46,.48,.5,.52,.54,.56,.58,.6).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),wh=l.Factory({Name:"MonaC1",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELECTROCHARGE_DMG,t.stat.VAPORIZE_DMG).Values(.15).Next().stat.Char(t.stat.ALL_DMG).Instance("HIT_SWIRL_HYDRO").Values(.15).Build()}),Bh=l.Factory({Name:"MonaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),bh=l.Factory({Name:"MonaC4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.15).Build()}),Kh=l.Factory({Name:"MonaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Yh=l.Factory({Name:"MonaC6",MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.6).Stacks().Build()}),Fh=[{Name:T.hits.HIT_N1,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.376}]},{Name:T.hits.HIT_N2,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.36}]},{Name:T.hits.HIT_N3,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.448}]},{Name:T.hits.HIT_N4,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5616}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.4972}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],kh=l.Factory({Name:"MonaA1",OnApply:new l.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_SKILL_LEVEL,Stat:t.stat.ATK,Initial:1.328*.5}]}).Build()}),Vh=l.Factory({Name:"MonaA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.HYDRO_DMG).Values(.2).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ENERGY_RECHARGE)).Build()}),xh=[{Name:T.hits.HIT_E_DOT,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.32}]},{Name:T.hits.HIT_E_EXPLOSION,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.328}]}],_i=G.Factory({Name:"Mona",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[810.322,3327.62],AtkBase:[22.344,91.74984],DefBase:[50.8555,208.845],Normals:Fh,Skills:xh,Bursts:Ph,Extra:[],Effects:[Hh,kh,Vh,wh,Bh,bh,Kh,Yh]}),Uh=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4264}]}],Wh=l.Factory({Name:"KleeC1",OnApply:new l.Builder().instance.Location("Burst").Options({Name:"HIT_C1",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:.4264*1.2}]}).Build()}),jh=l.Factory({Name:"KleeC2",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.DEFREDUCTION).Values(.23).Build()}),zh=l.Factory({Name:"KleeC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),qh=l.Factory({Name:"KleeC4",OnApply:new l.Builder().instance.Location("Burst").Options({Name:"HIT_C4",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:5.55}]}).Build()}),$h=l.Factory({Name:"KleeC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Qh=l.Factory({Name:"KleeC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Build()}),Xh=[{Name:T.hits.HIT_N1,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.7216}]},{Name:T.hits.HIT_N2,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.624}]},{Name:T.hits.HIT_N3,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.8992}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.5736}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],Jh=l.Factory({Name:"KleeA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.5).Build()}),Zh=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.952}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.328}]}],ui=G.Factory({Name:"Klee",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.PYRO_DMG,StatBonus:t.stat.PYRO_DMG,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[800.7888,3288.4717],AtkBase:[24.206,99.39566],DefBase:[47.864,196.56],Normals:Xh,Skills:Zh,Bursts:Uh,Extra:[],Effects:[Jh,Wh,jh,zh,qh,$h,Qh]}),tm=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.24}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.888}]}],em=l.Factory({Name:"KeqingC1",OnApply:new l.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.5,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),am=l.Factory({Name:"KeqingC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),nm=l.Factory({Name:"KeqingC4",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.25).Build()}),sm=l.Factory({Name:"KeqingC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),rm=l.Factory({Name:"KeqingC6",OnApply:new l.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.06).Build()}),im=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4102}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4102}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5444}]},{Name:T.hits.HIT_N4_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3148}]},{Name:T.hits.HIT_N4_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.344}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6699}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.768}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.86}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],lm=l.Factory({Name:"KeqingA1",OnApply:new l.Builder().Where({target:{ascension:1}}).infusion.Set(t.stat.ELECTRO_DMG,!1).Build()}),om=l.Factory({Name:"KeqingA4",OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.CRIT_RATE,t.stat.ENERGY_RECHARGE).Values(.15).Build()}),cm=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.504}]},{Name:T.hits.HIT_E+"_SLASH",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.68}]},{Name:T.hits.HIT_E+"_SLASH_2",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]}],Ai=G.Factory({Name:"Keqing",Stars:5,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_DMG,Weapon:t.weapon.SWORD,Region:t.region.LIYUE,BurstCost:40,HpBase:[1020.0524,4188.8867],AtkBase:[25.137,103.21857],DefBase:[62.2232,255.528],Normals:im,Skills:cm,Bursts:tm,Extra:[],Effects:[lm,om,em,am,nm,sm,rm]}),Em=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6646}]}],Tm=l.Factory({Name:"AyatoQ",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.11,.12,.13,.14,.15,.16,.17,.18,.19,.2).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),_m=l.Factory({Name:"AyatoC1",OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Instance(/HIT_N\d_E/i).Values(.4).Build()}),um=l.Factory({Name:"AyatoC2",OnApply(e,a,n){const s=e.FindEffect("AyatoE");if(!s)throw new Error("Cannot find Ayato Skill");const r=n.Modifier(e.GetCharacter().CreateModifier(t.stat.HP_PERCENT,0)),i=function(){s.GetStacks()>=3?r.SetValue(.5):r.SetValue(0)};return i(),n.Observer(s.CreateObserver(l.EffectEvent.CHANGE_STACKS,i)),()=>0}}),Am=l.Factory({Name:"AyatoC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Sm=l.Factory({Name:"AyatoC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),hm=l.Factory({Name:"AyatoC6",OnApply:new l.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:4.5}]}).Build()}),mm=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4496}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4716}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5861}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2945}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.756}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2953}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],fm=[{Name:T.hits.HIT_N1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5289}]},{Name:T.hits.HIT_N2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5891}]},{Name:T.hits.HIT_N3+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6493}]},{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0148}]}],Lm=l.Factory({Name:"AyatoE",MaxStacks:5,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Mv(t.stat.HP,.56/100,/HIT_N\d_E/i).Map((e,a,n)=>e*n.GetStacks()*o.TalentScaling.PHYSICAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),Si=G.Factory({Name:"Ayato",Stars:5,Weapon:t.weapon.SWORD,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.CRIT_DMG,Region:t.region.INAZUMA,BurstCost:80,HpBase:[1067.7184,4384.629],AtkBase:[23.275,95.57275],DefBase:[59.83,245.7],Normals:mm,Skills:fm,Bursts:Em,Extra:[],Effects:[Lm,Tm,_m,um,Am,Sm,hm]}),pm=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.123}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.6845}]}],Nm=l.Factory({Name:"AyakaC2",OnApply:new l.Builder().instance.Location("Burst").Options({Name:"HIT_C2",Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:1.123}]}).Build()}),dm=l.Factory({Name:"AyakaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Cm=l.Factory({Name:"AyakaC4",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.DEFREDUCTION).Values(.3).Build()}),Mm=l.Factory({Name:"AyakaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),gm=l.Factory({Name:"AyakaC6",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(2.98).Build()}),Gm=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4573}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4868}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6262}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2265}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7818}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5513}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Rm=l.Factory({Name:"AyakaSprint",OnApply:new l.Builder().infusion.Set(t.stat.CRYO_DMG,!1).Build()}),Im=l.Factory({Name:"AyakaA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.3).Build()}),Om=l.Factory({Name:"AyakaA4",OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.CRYO_DMG).Values(.18).Build()}),Dm=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.392}]}],hi=G.Factory({Name:"Ayaka",Stars:5,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,Weapon:t.weapon.SWORD,Region:t.region.INAZUMA,BurstCost:80,HpBase:[1000.986,4110.59],AtkBase:[26.6266,109.33523],DefBase:[61.0266,250.614],Normals:Gm,Skills:Dm,Bursts:pm,Extra:[],Effects:[Rm,Im,Om,Nm,dm,Cm,Mm,gm]}),vm=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.248}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.784}]}],ym=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4833}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4558}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6029}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6588}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7921}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.6202}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Pm=l.Factory({Name:"JeanC1",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.4).Build()}),Hm=l.Factory({Name:"JeanC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),wm=l.Factory({Name:"JeanC4",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.ANEMO_RES).Values(-.4).Build()}),Bm=l.Factory({Name:"JeanC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),bm=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.92}]}],mi=G.Factory({Name:"Jean",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.HEALING_BONUS,Weapon:t.weapon.SWORD,Region:t.region.MONDSTADT,BurstCost:80,HpBase:[1143.984,4697.817],AtkBase:[18.62,76.4582],DefBase:[59.83,245.7],Normals:ym,Skills:bm,Bursts:vm,Extra:[],Effects:[Pm,Hm,wm,Bm]}),Km=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:.9822}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:.613}]}];function Ze(e){const a=e.GetParty();if(!a)return e.GetCharacter().Options.Element===t.stat.GEO_DMG?1:0;let n=0;for(const s of a.GetMembers())s.GetCharacter().Options.Element===t.stat.GEO_DMG&&n++;return n}var Ym=l.Factory({Name:"GorouC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Fm=l.Factory({Name:"GorouC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),km=l.Factory({Name:"GorouC6",ApplyOther:!0,OnApply:new l.Builder().observe.Party(!0).stat.Char(t.stat.GEO_CRIT_DMG).Values(.1,.2,.4).Rank(e=>Ze(e)).Build()}),Vm=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3775}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3715}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4945}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.59}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],xm=l.Factory({Name:"GorouA1",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.DEF_PERCENT).Values(.25).Build()}),Um=l.Factory({Name:"GorouA4",OnApply:new l.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,1.56,"HIT_E").Next().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,.156,"HIT_Q","HIT_Q_DOT").Next().Build()}),Wm=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.072}]}],jm=l.Factory({Name:"GorouE",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).observe.Party(!0).stat.Char(t.stat.DEF_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a)=>206.16*e*(Ze(a)>=1?1:0)).Next().observe.Party(!0).stat.Char(t.stat.GEO_DMG).Values(.15).Map((e,a)=>e*(Ze(a)>=3?1:0)).Build()}),fi=G.Factory({Name:"Gorou",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.GEO_DMG,StatBonus:t.stat.GEO_DMG,BurstCost:80,Region:t.region.INAZUMA,HpBase:[802.3761,2870.8872],AtkBase:[15.31488,54.797653],DefBase:[54.36375,194.5125],Normals:Vm,Skills:Wm,Bursts:Km,Extra:[],Effects:[jm,xm,Um,Ym,Fm,km]}),zm=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7027}]}],qm=l.Factory({Name:"GanyuC1",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.CRYO_RES).Values(-.15).Build()}),$m=l.Factory({Name:"GanyuC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Qm=l.Factory({Name:"GanyuC4",ApplyOther:!0,MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.05).Stacks().Build()}),Xm=l.Factory({Name:"GanyuC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Jm=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3173}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.356}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4549}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4549}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4825}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5762}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_Frostflake",Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.28}]},{Name:"HIT_FrostflakeBloom",Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.176}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],Zm=l.Factory({Name:"GanyuA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Instance(/Frostflake/i).Values(.2).Build()}),tf=l.Factory({Name:"GanyuA4",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.CRYO_DMG).Values(.2).Build()}),ef=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]}],Li=G.Factory({Name:"Ganyu",Stars:5,Weapon:t.weapon.BOW,Region:t.region.LIYUE,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:60,HpBase:[762.656,3131.878],AtkBase:[26.068,107.04148],DefBase:[49.0606,201.474],Normals:Jm,Skills:ef,Bursts:zm,Extra:[],Effects:[Zm,tf,qm,$m,Qm,Xm]}),af=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.456}]},{Name:"HIT_LightfallSword",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:3.6705}]}],nf=l.Factory({Name:"EulaQ",MaxStacks:30,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.7499,"HIT_LightfallSword").Map((e,a,n)=>{const s=Math.max(1,Math.min(15,a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)));return n.GetStacks()*e*o.TalentScaling.PHYSICAL_1A[s-1]}).Build()}),sf=l.Factory({Name:"EulaC1",OnApply:new l.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.3).Build()}),rf=l.Factory({Name:"EulaC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),lf=l.Factory({Name:"EulaC4",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.25).Build()}),of=l.Factory({Name:"EulaC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),cf=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8973}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.9355}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.568}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1264}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7183}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.688}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.244}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.8629}]}],Ef=l.Factory({Name:"EulaA1",OnApply:new l.Builder().Where({target:{ascension:1}}).instance.Location("Burst").Options({Name:"HIT_A1",Talent:t.stat.ELEMENTAL_BURST_DMG,Element:t.stat.PHYSICAL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:3.6705*.5}]}).Build()}),Tf=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.464}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.456}]},{Name:"HIT_Icewhirl",Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]}],_f=l.Factory({Name:"EulaE_1",MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Stacks().Build()}),uf=l.Factory({Name:"EulaE_2",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Enemy(t.stat.CRYO_RES,t.stat.PHYSICAL_RES).Values(-.16,-.17,-.18,-.19,-.2,-.21,-.22,-.23,-.24,-.25).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Build()}),pi=G.Factory({Name:"Eula",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:80,Region:t.region.MONDSTADT,HpBase:[1029.5856,4228.035],AtkBase:[26.6266,109.33523],DefBase:[58.45391,240.0489],Normals:cf,Skills:Tf,Bursts:af,Extra:[],Effects:[_f,uf,nf,Ef,sf,rf,lf,of]}),Af=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.04}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.04}]}],Sf=l.Factory({Name:"DilucQ",OnApply:new l.Builder().infusion.Set(t.stat.PYRO_DMG,!1).Build()}),hf=l.Factory({Name:"DilucC1",OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.15).Build()}),mf=l.Factory({Name:"DilucC2",MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.1).Stacks().Build()}),ff=l.Factory({Name:"DilucC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Lf=l.Factory({Name:"DilucC4",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.4).Build()}),pf=l.Factory({Name:"DilucC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Nf=l.Factory({Name:"DilucC6",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.3).Build()}),df=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.897}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8763}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.9881}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.3399}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.688}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.247}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8951}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.7897}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.2355}]}],Cf=l.Factory({Name:"DilucA4",OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.PYRO_DMG).Values(.2).Build()}),Mf=[{Name:T.hits.HIT_E_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.944}]},{Name:T.hits.HIT_E_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.976}]},{Name:T.hits.HIT_E_3,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.288}]}],Ni=G.Factory({Name:"Diluc",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.PYRO_DMG,StatBonus:t.stat.CRIT_RATE,BurstCost:40,Region:t.region.MONDSTADT,HpBase:[1010.5192,4149.7383],AtkBase:[26.068,107.04148],DefBase:[61.0266,250.614],Normals:df,Skills:Mf,Bursts:Af,Extra:[],Effects:[Sf,Cf,hf,mf,ff,Lf,pf,Nf]}),gf=[{Name:T.hits.HIT_N1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7828}]},{Name:T.hits.HIT_N2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8247}]},{Name:T.hits.HIT_N3+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0463}]},{Name:T.hits.HIT_N4+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5169}]},{Name:T.hits.HIT_N5+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.3084}]},{Name:T.hits.HIT_CHARGED+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0105}]},{Name:T.hits.HIT_PLUNGE+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Gf=l.Factory({Name:"CynoQ",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100).Build()}),Rf=l.Factory({Name:"CynoC2",MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.1).Stacks().Build()}),If=l.Factory({Name:"CynoC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Of=l.Factory({Name:"CynoC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Df=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4926}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4792}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2931}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7589}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2238}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],vf=l.Factory({Name:"CynoA1",OnApply:new l.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Initial:.35,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Next().Where({target:{ascension:1}}).stat.Char(t.stat.ALL_DMG).Instance("HIT_E","HIT_E_2").Values(.35).Build()}),yf=new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.DMG_FLAT).Instance(/N\d_Q$/i).Values(1.5).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build(),Pf=l.Factory({Name:"CynoA4",OnApply(e,a,n){yf(e,a,n);const s=e.GetCharacter(),r=e.FindEffect("CynoA1");let i;if(!r)throw new Error("Cannot find Cyno A1");function c(){if(!i){const _=e.FindInstance("HIT_A1");if(!_)return;i=n.Modifier(_.Subject.CreateModifier(t.stat.DMG_FLAT,0))}!i||(s.GetAscension()>=4?i.SetValue(2.5*s.Get(t.stat.ELEMENTAL_MASTERY)):i.SetValue(0))}c();for(const _ of l.EffectEvent.Values())n.Observer(r.CreateObserver(_,c));return n.Observer(s.CreateObserver(t.stat.ELEMENTAL_MASTERY,c)),n.Observer(s.CreateObserver(t.stat.LEVEL,c)),n.Observer(s.CreateObserver(t.stat.ASCENSION,c)),()=>0}}),Hf=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.568}]}],di=G.Factory({Name:"Cyno",Stars:5,Weapon:t.weapon.POLEARM,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:80,Region:t.region.SUMERU,HpBase:[972.3864,3993.1443],AtkBase:[24.7646,101.68941],DefBase:[66.88994,274.6926],Normals:Df,Skills:Hf,Bursts:gf,Extra:[],Effects:[Gf,vf,Pf,Rf,If,Of]}),wf=[{Name:T.hits.HIT_Q,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.0182}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4325}]}],Bf=l.Factory({Name:"ColleiC1",OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()}),bf=l.Factory({Name:"ColleiC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Kf=l.Factory({Name:"ColleiC4",ApplyOther:!0,ApplySelf:!1,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60).Build()}),Yf=l.Factory({Name:"ColleiC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Ff=l.Factory({Name:"ColleiC6",OnApply:new l.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Initial:2}]}).Build()}),kf=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.436}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4266}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5409}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6803}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.DENDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],Vf=l.Factory({Name:"ColleiA1",OnApply:new l.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Initial:.4}]}).Build()}),xf=[{Name:T.hits.HIT_E,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.512}]}],Ci=G.Factory({Name:"Collei",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.DENDRO_DMG,StatBonus:t.stat.ATK_PERCENT,BurstCost:60,Region:t.region.SUMERU,HpBase:[820.6119,2936.1348],AtkBase:[16.73952,59.895107],DefBase:[50.358,180.18],Normals:kf,Skills:xf,Bursts:wf,Extra:[],Effects:[Vf,Bf,bf,Kf,Yf,Ff]}),Uf=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.424}]}],Wf=l.Factory({Name:"ChongyunC1",OnApply:new l.Builder().instance.Basic({Name:"HIT_C1",Element:t.stat.CRYO_DMG,Stat:t.stat.ATK,Values:[.5]}).Build()}),jf=l.Factory({Name:"ChongyunC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),zf=l.Factory({Name:"ChongyunC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),qf=l.Factory({Name:"ChongyunC6",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.15).Build()}),$f=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6312}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8032}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0122}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5629}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0178}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],Qf=l.Factory({Name:"ChongyunA4",ApplyOther:!0,OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Enemy(t.stat.CRYO_RES).Values(-.1).Build()}),Xf=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.7204}]}],Jf=l.Factory({Name:"ChongyunE",ApplyOther:!0,OnApply:new l.Builder().infusion.Set(t.stat.CRYO_DMG,!1).Build()}),Mi=G.Factory({Name:"Chongyun",Stars:4,Element:t.stat.CRYO_DMG,Weapon:t.weapon.CLAYMORE,StatBonus:t.stat.ATK_PERCENT,BurstCost:40,Region:t.region.LIYUE,HpBase:[920.90894,3294.9956],AtkBase:[18.6984,66.90411],DefBase:[54.36375,194.5125],Normals:$f,Skills:Xf,Bursts:Uf,Extra:[],Effects:[Jf,Qf,Wf,jf,zf,qf]}),Zf=l.Factory({Name:"IttoQ",OnApply:new l.Builder().observe.Target(t.stat.DEF_FLAT,t.stat.DEF_BASE,t.stat.DEF_PERCENT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a)=>.576*e*a.GetCharacter().Get(t.stat.DEF)).Next().infusion.Set(t.stat.GEO_DMG,!0).Build()}),tL=l.Factory({Name:"IttoC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),eL=l.Factory({Name:"IttoC4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT,t.stat.ATK_PERCENT).Values(.2).Build()}),aL=l.Factory({Name:"IttoC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),nL=l.Factory({Name:"IttoC6",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_DMG).Values(.7).Build()}),sL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7923}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7637}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9164}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1722}]},{Name:"HIT_KesagiriSlash",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9116}]},{Name:"HIT_KesagiriFinal",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.9092}]},{Name:"HIT_SaichimonjiSlash",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9047}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],rL=l.Factory({Name:"IttoA4",OnApply:new l.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,.35,/Kesagiri/i).Build()}),iL=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.072}]}],gi=G.Factory({Name:"Itto",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.GEO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.INAZUMA,BurstCost:70,HpBase:[1000.986,4110.59],AtkBase:[17.689,72.63529],DefBase:[74.66784,306.6336],Normals:sL,Skills:iL,Bursts:[],Extra:[],Effects:[Zf,rL,tL,eL,aL,nL]}),lL=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.2808}]}],oL=l.Factory({Name:"AmberC1",OnApply:new l.Builder().instance.Location("Normal").Options({Name:"HIT_C1",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:1.24*.2}]}).Build()}),cL=l.Factory({Name:"AmberC2",OnApply:new l.Builder().mv.Mv(t.stat.ATK,2,/hit_e/i).Build()}),EL=l.Factory({Name:"AmberC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),TL=l.Factory({Name:"AmberC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),_L=l.Factory({Name:"AmberC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()}),uL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3612}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3612}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4644}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5934}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],AL=l.Factory({Name:"AmberA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.1).Build()}),SL=l.Factory({Name:"AmberA4",OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()}),hL=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.232}]}],Gi=G.Factory({Name:"Amber",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.PYRO_DMG,StatBonus:t.stat.ATK_PERCENT,BurstCost:40,Region:t.region.MONDSTADT,HpBase:[793.2582,2838.2634],AtkBase:[18.6984,66.90411],DefBase:[50.358,180.18],Normals:uL,Skills:hL,Bursts:lL,Extra:[],Effects:[AL,SL,oL,cL,EL,TL,_L]}),mL=l.Factory({Name:"AlhaithamA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.1/100).Map((e,a)=>Math.min(1,e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY))).Build()}),fL=[{Name:T.hits.HIT_Q,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:.9728}]}],LL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4953}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5075}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3418}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6677}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8385}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5526}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],pL=[{Name:T.hits.HIT_E,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.936},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.5488}]},{Name:T.hits.HIT_E_DOT+"_1",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344}]},{Name:T.hits.HIT_E_DOT+"_2",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672*2},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344*2}]},{Name:T.hits.HIT_E_DOT+"_3",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672*3},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344*3}]}],NL=l.Factory({Name:"AlhaithamE",OnApply:new l.Builder().infusion.Set(t.stat.DENDRO_DMG,!0).Build()}),dL=l.Factory({Name:"AlhaithamC2",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(50).Stacks().Build()}),CL=l.Factory({Name:"AlhaithamC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),ML=l.Factory({Name:"AlhaithamC4",MaxStacks:3,ApplyOther:!0,OnApply:new l.Builder().Where({target:{isOwner:!0}}).stat.Char(t.stat.DENDRO_DMG).Values(.1).Stacks().Next().Where({target:{isOwner:!1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(30).Stacks().Build()}),gL=l.Factory({Name:"AlhaithamC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),GL=l.Factory({Name:"AlhaithamC6",OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.1).Next().stat.Char(t.stat.CRIT_DMG).Values(.7).Build()}),Ri=G.Factory({Name:"Alhaitham",Stars:5,Weapon:t.weapon.SWORD,Element:t.stat.DENDRO_DMG,StatBonus:t.stat.DENDRO_DMG,Region:t.region.SUMERU,BurstCost:70,AtkBase:[24.3922,100.16024],DefBase:[60.84711,249.8769],HpBase:[1039.1188,4267.1836],Normals:LL,Skills:pL,Bursts:fL,Extra:[],Effects:[NL,mL,dL,CL,ML,gL,GL]}),RL=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.672}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]}],IL=l.Factory({Name:"AlbedoC2",MaxStacks:4,OnApply:new l.Builder().mv.Mv(t.stat.DEF,.3,/HIT_Q/i).Map((e,a,n)=>e*n.GetStacks()).Build()}),OL=l.Factory({Name:"AlbedoC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),DL=l.Factory({Name:"AlbedoC4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.PLUNGE_ATTACK_DMG).Values(.3).Build()}),vL=l.Factory({Name:"AlbedoC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),yL=l.Factory({Name:"AlbedoC6",ApplyOther:!0,OnApply:new l.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.ALL_DMG).Values(.17).Build()}),PL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3674}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3674}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4745}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4975}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6207}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.602}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],HL=l.Factory({Name:"AlbedoA1",OnApply(e,a,n){const s=e.GetCharacter(),r=e.FindSkill(T.hits.HIT_E_DOT);if(!r)throw new Error("Cannot find Albedo Skill");const i=n.Modifier(r.Subject.CreateModifier(t.stat.ALL_DMG,0));function c(){s.GetAscension()>=1?i.SetValue(.25):i.SetValue(0)}return c(),n.Observer(s.CreateObserver(t.stat.LEVEL,c)),n.Observer(s.CreateObserver(t.stat.ASCENSION,c)),()=>0}}),wL=l.Factory({Name:"AlbedoA4",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(125).Build()}),BL=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:1.336}]}],Ii=G.Factory({Name:"Albedo",Element:t.stat.GEO_DMG,Stars:5,Weapon:t.weapon.SWORD,StatBonus:t.stat.GEO_DMG,Region:t.region.MONDSTADT,AtkBase:[19.551,80.28111],DefBase:[68.2062,280.098],HpBase:[1029.5856,4228.035],BurstCost:40,Normals:PL,Skills:BL,Bursts:RL,Extra:[],Effects:[HL,wL,IL,OL,DL,vL,yL]}),bL=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]}],KL=l.Factory({Name:"BeidouC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),YL=l.Factory({Name:"BeidouC4",ApplySelf:!0,OnApply:new l.Builder().instance.Options({Name:"HIT_C4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.2,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Build()}),FL=l.Factory({Name:"BeidouC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),kL=l.Factory({Name:"BeidouC6",ApplySelf:!0,ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.ELECTRO_RES).Values(-.15).Build()}),VL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7112}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7086}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8832}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8652}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1214}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5624}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.0182}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],xL=l.Factory({Name:"BeidouA4",OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()}),UL=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216}]}],WL=l.Factory({Name:"BeidouE",MaxStacks:2,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Mv(t.stat.ATK,.96,T.hits.HIT_E).Map((e,a,n)=>{const s=n.GetStacks(),r=a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1,i=o.TalentScaling.ELEMENTAL_1[r];return e*i*s}).Build()}),Oi=G.Factory({Name:"Beidou",Stars:4,Weapon:t.weapon.CLAYMORE,Element:t.stat.ELECTRO_DMG,Region:t.region.LIYUE,StatBonus:t.stat.ELECTRO_DMG,AtkBase:[18.87648,67.54129],DefBase:[54.36375,194.5125],HpBase:[1094.1492,3914.8462],BurstCost:80,Normals:VL,Skills:UL,Bursts:bL,Extra:[],Effects:[WL,xL,KL,YL,FL,kL]}),jL=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.5427}]}],zL=l.Factory({Name:"XingqiuC2",ApplySelf:!0,ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.HYDRO_RES).Values(-.15).Build()}),qL=l.Factory({Name:"XingqiuC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),$L=l.Factory({Name:"XingqiuC4",ApplySelf:!0,OnApply:new l.Builder().mv.Multiplier(1.5,/^HIT_E_/i).Build()}),QL=l.Factory({Name:"XingqiuC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),XL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4661}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4764}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2855}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5599}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3586}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5616}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],JL=l.Factory({Name:"XingqiuA4",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.HYDRO_DMG).Where({owner:{ascension:4}}).Values(.2).Build()}),ZL=[{Name:T.hits.HIT_E_1,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.68}]},{Name:T.hits.HIT_E_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.912}]}],Di=G.Factory({Name:"Xingqiu",Stars:4,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.SWORD,Region:t.region.LIYUE,HpBase:[857.08356,3066.6296],AtkBase:[16.9176,60.53229],DefBase:[63.51975,227.2725],StatBonus:t.stat.ATK_PERCENT,Normals:XL,Skills:ZL,Bursts:jL,Extra:[],Effects:[JL,zL,qL,$L,QL],BurstCost:80}),tp=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_2,Stat:t.stat.ATK,Initial:3.0327}]}],ep=l.Factory({Name:"HuTaoQ",OnApply:new l.Builder().mv.Where({target:{hp:{leq:.5}}}).Multiplier(3.7909/3.0327,"HIT_Q").Build()}),ap=l.Factory({Name:"HuTaoC2",ApplySelf:!0,OnApply:new l.Builder().mv.Mv(t.stat.HP,.1,"HIT_E").Build()}),np=l.Factory({Name:"HuTaoC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),sp=l.Factory({Name:"HuTaoC4",ApplySelf:!1,ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.12).Build()}),rp=l.Factory({Name:"HuTaoC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),ip=l.Factory({Name:"HuTaoC6",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(1).Build()}),lp=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.4689}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.4825}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6105}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6564}]},{Name:T.hits.HIT_N5_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.3327}]},{Name:T.hits.HIT_N5_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.352}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.8596}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.3596}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6542}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.3081}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.6339}]}],op=l.Factory({Name:"HuTaoA1",ApplySelf:!1,ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Where({owner:{ascension:1}}).Values(.12).Build()}),cp=l.Factory({Name:"HuTaoA4",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Where({owner:{ascension:4,hp:{leq:.5}}}).Values(.33).Build()}),Ep=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.64}]}],Tp=l.Factory({Name:"HuTaoE",ApplySelf:!0,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP,t.stat.ATK_BASE,t.stat.HP_BASE,t.stat.HP_FLAT,t.stat.HP_PERCENT).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_2).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a)=>{const n=a.GetCharacter(),s=.0384*e*n.Get(t.stat.HP),r=n.Get(t.stat.ATK_BASE)*4;return Math.max(0,Math.min(r,s))}).Next().infusion.Set(t.stat.PYRO_DMG,!0).Build()}),vi=G.Factory({Name:"HuTao",Element:t.stat.PYRO_DMG,Region:t.region.LIYUE,Stars:5,Weapon:t.weapon.POLEARM,HpBase:[1210.7164,4971.856],AtkBase:[8.2859,34.0239],DefBase:[68.2062,280.098],StatBonus:t.stat.CRIT_DMG,Normals:lp,Skills:Ep,Bursts:tp,Extra:[],Effects:[Tp,ep,op,cp,ap,np,sp,rp,ip],BurstCost:60}),_p=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0731}]},{Name:T.hits.HIT_Q+"_THROW",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0487}]}],up=l.Factory({Name:"YelanC2",OnApply:new l.Builder().instance.Options({Name:"HIT_C2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.14,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build()}),Ap=l.Factory({Name:"YelanC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Sp=l.Factory({Name:"YelanC4",MaxStacks:4,ApplySelf:!0,ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.1).Stacks().Build()}),hp=l.Factory({Name:"YelanC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),mp=l.Factory({Name:"YelanC6",OnApply:new l.Builder().instance.Options({Name:"HIT_C6",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:1.56*.1158,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),fp=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4068}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3904}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.516}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3251}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_BREAKTHROUGH_BARB",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1158}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],Lp=l.Factory({Name:"YelanA1",ApplySelf:!0,OnApply:new l.Builder().observe.Party(!0).stat.Char(t.stat.HP_PERCENT).Where({owner:{ascension:1}}).Values(.06,.12,.18,.3).Rank(e=>{const a=e.GetParty();if(!a)return 1;const n=a.GetMembers(),s=new Map;for(const i of n)s.set(i.GetCharacter().Options.Element,!0);let r=0;for(const i of s.values())i&&r++;return r}).Build()}),pp=l.Factory({Name:"YelanA4",ApplySelf:!0,ApplyOther:!0,MaxTargets:1,MaxStacks:15,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Where({owner:{ascension:4}}).Values(.01).Next().stat.Char(t.stat.ALL_DMG).Where({owner:{ascension:4}}).Values(.035).Stacks().Map(e=>Math.min(.5,e)).Build()}),Np=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.2261}]}],yi=G.Factory({Name:"Yelan",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.BOW,Region:t.region.LIYUE,BurstCost:70,HpBase:[1124.9176,4619.52],AtkBase:[18.9924,77.987366],DefBase:[42.65879,175.1841],StatBonus:t.stat.CRIT_RATE,Normals:fp,Skills:Np,Bursts:_p,Extra:[],Effects:[Lp,pp,up,Ap,Sp,hp,mp]}),dp=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:[1,1.108,1.216,1.351,1.473,1.595,1.757,1.919,2.081,2.243,2.405,2.568,2.703,2.838,2.973],Stat:t.stat.ATK,Initial:4.0108}]}],Cp=l.Factory({Name:"ZhongliC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Mp=l.Factory({Name:"ZhongliC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),gp=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3077}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3115}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3858}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4294}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.1075}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.545}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1103}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Gp=l.Factory({Name:"ZhongliA4",ApplySelf:!0,OnApply:new l.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.0139,/HIT_(N(\d)|CHARGED|PLUNGE)/).Next().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.019,/HIT_E/).Next().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.33,/HIT_Q/).Build()}),Rp=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.16}]},{Name:T.hits.HIT_E+"_RESONANCE",Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.32}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.8}]}],Ip=l.Factory({Name:"ZhongliE",ApplySelf:!0,ApplyOther:!0,OnApply:(e,a,n)=>{const s=t.Elements;for(const r of s){const i=t.DmgToRes(r);n.Modifier(e.GetCharacter().GetEnemy().Subject.CreateModifier(i,-.2))}return()=>0}}),Pi=G.Factory({Name:"Zhongli",Stars:5,Element:t.stat.GEO_DMG,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,HpBase:[1143.984,4697.817],AtkBase:[19.551,80.2811],DefBase:[57.4368,235.872],StatBonus:t.stat.GEO_DMG,BurstCost:40,Normals:gp,Skills:Rp,Bursts:dp,Extra:[],Effects:[Ip,Gp,Cp,Mp]}),Op=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.008}]},{Name:T.hits.HIT_N1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4447}]},{Name:T.hits.HIT_N2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4396}]},{Name:T.hits.HIT_N3+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.5382}]},{Name:T.hits.HIT_N4+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3089}]},{Name:T.hits.HIT_N5+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7394}]},{Name:T.hits.HIT_CHARGED_1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.616}]},{Name:T.hits.HIT_CHARGED_2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7436}]},{Name:T.hits.HIT_PLUNGE+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Dp=l.Factory({Name:"RaidenQ",MaxStacks:60,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.0389,T.hits.HIT_Q).Map((e,a,n)=>n.GetStacks()*e*o.TalentScaling.ELEMENTAL_1[Math.max(0,Math.min(o.TalentScaling.ELEMENTAL_1.length-1,a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1))]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.0073,/_.+_Q$/).Map((e,a,n)=>n.GetStacks()*e*o.TalentScaling.ELEMENTAL_1[Math.max(0,Math.min(o.TalentScaling.ELEMENTAL_1.length-1,a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1))]).Build()}),vp=l.Factory({Name:"RaidenC2",OnApply:new l.Builder().stat.Char(t.stat.DEFIGNORED).Values(.6).Build()}),yp=l.Factory({Name:"RaidenC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Pp=l.Factory({Name:"RaidenC4",ApplyOther:!0,ApplySelf:!1,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.3).Build()}),Hp=l.Factory({Name:"RaidenC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),wp=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3965}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3973}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4988}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2898}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6545}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9959}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Bp=l.Factory({Name:"RaidenA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ELECTRO_DMG).Values(.4).Map((e,a)=>e*Math.max(0,a.GetCharacter().Get(t.stat.ENERGY_RECHARGE)-1)).Build()}),bp=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.172}]},{Name:T.hits.HIT_E+"_COORDINATED",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.42}]}],Kp=l.Factory({Name:"RaidenE",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.0022,.0023,.0024,.0025,.0026,.0027,.0028,.0029,.003).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a)=>e*a.GetCharacter().Options.BurstCost).Build()}),Hi=G.Factory({Name:"Raiden",Stars:5,Weapon:t.weapon.POLEARM,Region:t.region.INAZUMA,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,BurstCost:90,AtkBase:[26.2542,107.80606],DefBase:[61.44541,252.3339],HpBase:[1004.79926,4126.249],Normals:wp,Skills:bp,Bursts:Op,Extra:[],Effects:[Kp,Dp,Bp,vp,yp,Pp,Hp]}),Yp=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.328}]}],Fp=l.Factory({Name:"BennettQ",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ATK_BASE,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a,n)=>{const s=n.Owner.FindEffect("BennettC1");return(.56*e+(s&&s.Enabled()?.2:0))*n.Owner.GetCharacter().Get(t.stat.ATK_BASE)}).Build()}),kp=l.Factory({Name:"BennettC1",OnApply(e,a,n){const s=e.FindEffect("BennettQ");if(!s)throw new Error("Bennett Burst effect not found");const r=s;function i(){r.Enabled()&&(r.Disable(),r.Enable())}return i(),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,i)),n.Observer(a.CreateObserver(l.EffectEvent.DISABLE,i)),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_TARGET,i)),()=>0}}),Vp=l.Factory({Name:"BennettC2",OnApply:new l.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.ENERGY_RECHARGE).Values(.3).Build()}),xp=l.Factory({Name:"BennettC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Up=l.Factory({Name:"BennettC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Wp=l.Factory({Name:"BennettC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Next().Where({target:{weapon:[t.weapon.CLAYMORE,t.weapon.SWORD,t.weapon.POLEARM]}}).infusion.Set(t.stat.PYRO_DMG,!1).Build()}),jp=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4455}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4274}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5461}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5968}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.719}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.559}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6072}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],zp=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.376}]},{Name:T.hits.HIT_E_1_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]},{Name:T.hits.HIT_E_1_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.92}]},{Name:T.hits.HIT_E_2_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_E_2_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]},{Name:T.hits.HIT_E_EXPLOSION,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]},{Name:"HIT_C4",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.92*1.35}]}],wi=G.Factory({Name:"Bennett",Stars:4,Weapon:t.weapon.SWORD,Element:t.stat.PYRO_DMG,Region:t.region.MONDSTADT,StatBonus:t.stat.ENERGY_RECHARGE,BurstCost:60,HpBase:[1039.4418,3719.104],AtkBase:[16.0272,57.34638],DefBase:[64.66425,231.3675],Normals:jp,Skills:zp,Bursts:Yp,Effects:[Fp,kp,Vp,xp,Up,Wp],Extra:[]}),qp=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.08}]}],$p=l.Factory({Name:"FischlC1",OnApply:new l.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.22,Talent:t.stat.NONE}]}).Build()}),Qp=l.Factory({Name:"FischlC2",OnApply:new l.Builder().mv.Mv(t.stat.ATK,2,/HIT_E$/).Build()}),Xp=l.Factory({Name:"FischlC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Jp=l.Factory({Name:"FischlC4",OnApply:new l.Builder().instance.Options({Name:"HIT_C4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:2.22,Talent:t.stat.NONE}]}).Build()}),Zp=l.Factory({Name:"FischlC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),t1=l.Factory({Name:"FischlC6",OnApply:new l.Builder().instance.Options({Name:"HIT_C6",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.3,Talent:t.stat.NONE}]}).Build()}),e1=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4412}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4678}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5814}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5771}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7207}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],a1=l.Factory({Name:"FischlA1",OnApply:new l.Builder().Where({target:{ascension:1}}).instance.Options({Name:"HIT_A1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24*1.527,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),n1=l.Factory({Name:"FischlA4",OnApply:new l.Builder().Where({target:{ascension:4}}).instance.Options({Name:"HIT_A4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.8,Talent:t.stat.NONE}]}).Build()}),s1=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1544}]},{Name:"HIT_OZ",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.888}]}],Bi=G.Factory({Name:"Fischl",Stars:4,Element:t.stat.ELECTRO_DMG,Region:t.region.MONDSTADT,Weapon:t.weapon.BOW,StatBonus:t.stat.ATK_PERCENT,AtkBase:[20.4792,73.27593],HpBase:[770.4634,2756.704],DefBase:[49.78575,178.1325],BurstCost:60,Normals:e1,Skills:s1,Bursts:qp,Extra:[],Effects:[a1,n1,$p,Qp,Xp,Jp,Zp,t1]}),r1=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.624}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2}]}],i1=l.Factory({Name:"KazuhaQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,n){l1(e,a,n);function s(){const r=e.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!r)return;const i=a.GetAuras()[0];!i||(r.Options.Element=t.AuraToDmg(i))}return s(),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,s)),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,s)),()=>0}}),l1=new l.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.36,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),o1=l.Factory({Name:"KazuhaC2",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(200).Build()}),c1=l.Factory({Name:"KazuhaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),E1=l.Factory({Name:"KazuhaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),T1=l.Factory({Name:"KazuhaC6",OnApply:new l.Builder().infusion.Set(t.stat.ANEMO_DMG,!1).Build()}),_1=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4498}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4524}]},{Name:T.hits.HIT_N3_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.258}]},{Name:T.hits.HIT_N3_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3096}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6072}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2537}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.43}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7465}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],u1=l.Factory({Name:"KazuhaA1",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,n){A1(e,a,n);function s(){const r=e.FindNormal("HIT_A1");if(!r)return;const i=a.GetAuras()[0];!i||(r.Options.Element=t.AuraToDmg(i))}return s(),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,s)),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,s)),()=>0}}),A1=new l.Builder().Where({target:{ascension:1}}).instance.Location("Normal").Options({Name:"HIT_A1",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:2,Talent:t.stat.NONE}]}).Build(),S1=l.Factory({Name:"KazuhaA4",ApplyOther:!0,MaxAuras:1/0,ValidAuras:t.Swirlable,OnApply(e,a,n){const s=a.Owner.GetCharacter(),r=e.GetCharacter(),i=t.Elements.filter(_=>_!==t.stat.PHYSICAL_DMG).map(_=>n.Modifier(r.CreateModifier(_,0)));function c(){const _=a.GetAuras().map(u=>t.AuraToDmg(u));for(const u of i)_.includes(u.GetProp())&&s.GetAscension()>=4?u.SetValue(.04/100*s.Get(t.stat.ELEMENTAL_MASTERY)):u.SetValue(0)}return c(),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,c)),n.Observer(s.CreateObserver(t.stat.ELEMENTAL_MASTERY,c)),n.Observer(s.CreateObserver(t.stat.LEVEL,c)),n.Observer(s.CreateObserver(t.stat.ASCENSION,c)),()=>0}}),h1=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.92}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.608}]}],m1=l.Factory({Name:"KazuhaE",OnApply:new l.Builder().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Next().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE_LOW+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Next().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE_HIGH+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),bi=G.Factory({Name:"Kazuha",Stars:5,Weapon:t.weapon.SWORD,Region:t.region.INAZUMA,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ELEMENTAL_MASTERY,BurstCost:60,HpBase:[1039.1188,4267.1836],AtkBase:[23.0888,94.80817],DefBase:[62.8215,257.985],Normals:_1,Skills:h1,Bursts:r1,Extra:[],Effects:[m1,i1,u1,S1,o1,c1,E1,T1]}),f1=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.096}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3412}]}],L1=l.Factory({Name:"SaraC2",OnApply:new l.Builder().instance.Location("Skill").Options({Name:"HIT_C2",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2576*.3,Talent:t.stat.ELEMENTAL_SKILL_LEVEL}]}).Build()}),p1=l.Factory({Name:"SaraC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),N1=l.Factory({Name:"SaraC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),d1=l.Factory({Name:"SaraC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELECTRO_CRIT_DMG).Values(.6).Build()}),C1=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3689}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.387}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.485}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.504}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.585}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],M1=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2576}]}],g1=l.Factory({Name:"SaraE",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ATK_BASE,t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a,n)=>.4296*e*n.Owner.GetCharacter().Get(t.stat.ATK_BASE)).Build()}),Ki=G.Factory({Name:"Sara",Stars:4,Weapon:t.weapon.BOW,Region:t.region.INAZUMA,Element:t.stat.ELECTRO_DMG,BurstCost:80,HpBase:[802.3761,2870.8872],AtkBase:[16.38336,58.620743],DefBase:[52.647,188.37],StatBonus:t.stat.ATK_PERCENT,Normals:C1,Skills:M1,Bursts:f1,Extra:[],Effects:[g1,L1,p1,N1,d1]}),G1=[{Name:T.hits.HIT_N1,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.403}]},{Name:T.hits.HIT_N2,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3697}]},{Name:T.hits.HIT_N3,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4587}]},{Name:T.hits.HIT_N4,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5841}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.DENDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.32}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],R1=l.Factory({Name:"NahidaA1",ApplyOther:!0,MaxTargets:1,OnApply(e,a,n){const s=e.GetCharacter(),r=a.Owner.GetCharacter(),i=n.Modifier(s.CreateModifier(t.stat.ELEMENTAL_MASTERY,0));let c=[];const _=[];function u(S){if(S===i)return;if(r.Get(t.stat.ASCENSION)<1){i.SetValue(0);return}let h=0,m=s;for(const N of c){const L=N.Get(t.stat.ELEMENTAL_MASTERY);L>h&&(h=L,m=N)}m===s&&(h-=i.GetValue());const f=Math.min(250,Math.max(0,.25*h));i.SetValue(f)}function A(){_.forEach(h=>h.Remove());const S=e.GetParty();if(!S)c=[s];else{c=[];for(const h of S.GetMembers())c.push(h.GetCharacter())}for(const h of c)_.push(n.Observer(h.CreateObserver(t.stat.ELEMENTAL_MASTERY,u)));u()}return A(),n.Observer(e.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,A)),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,A)),n.Observer(a.CreateObserver(l.EffectEvent.DISABLE,A)),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_CONDITIONS,A)),n.Observer(r.CreateObserver(t.stat.LEVEL,u)),n.Observer(r.CreateObserver(t.stat.ASCENSION,u)),()=>0}}),I1=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.984}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.032},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:2.064}]}],O1=l.Factory({Name:"NahidaA4",OnApply(e,a,n){const s=e.GetCharacter(),r=e.FindSkill(T.hits.HIT_E_DOT);if(!r)throw new Error("Cannot find Nahida Skill");const i=n.Modifier(r.Subject.CreateModifier(t.stat.ALL_DMG,0)),c=n.Modifier(r.Subject.CreateModifier(t.stat.CRIT_RATE,0));let _,u;function A(){if(s.GetAscension()<4){i.SetValue(0),c.SetValue(0),_&&_.SetValue(0),u&&u.SetValue(0);return}const S=e.FindSkill("HIT_C6");S&&(_||(_=n.Modifier(S.Subject.CreateModifier(t.stat.ALL_DMG,0))),u||(u=n.Modifier(S.Subject.CreateModifier(t.stat.CRIT_RATE,0))));const h=Math.max(0,s.Get(t.stat.ELEMENTAL_MASTERY)-200),m=Math.min(.24,h*.03/100),f=Math.min(.8,h*.1/100);i.SetValue(f),c.SetValue(m),_&&_.SetValue(f),u&&u.SetValue(m)}return A(),n.Observer(s.CreateObserver(t.stat.ELEMENTAL_MASTERY,A)),n.Observer(s.CreateObserver(t.stat.LEVEL,A)),n.Observer(s.CreateObserver(t.stat.ASCENSION,A)),()=>0}}),D1=l.Factory({Name:"NahidaQ",OnApply(e,a,n){const s=e.FindSkill(T.hits.HIT_E_DOT);if(!s)throw new Error("Cannot find Nahida Skill");const r=n.Modifier(s.Subject.CreateModifier(t.stat.ALL_DMG,0));let i;function c(){const _=e.GetParty();if(!_){r.SetValue(0),i&&i.SetValue(0);return}const u=e.FindSkill("HIT_C6");u&&!i&&(i=n.Modifier(u.Subject.CreateModifier(t.stat.ALL_DMG,0)));const A=e.FindEffect("NahidaC1");let h=A&&A.Enabled()&&A.GetTargets().includes(e)?1:0;for(const N of _.GetMembers())N.GetCharacter().Options.Element===t.stat.PYRO_DMG&&h++;let m=0;h>=1&&(m=.1488),h>=2&&(m=.2232);const f=m*o.TalentScaling.ELEMENTAL_1[e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1];r.SetValue(f),i&&i.SetValue(f)}return c(),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,c)),n.Observer(a.CreateObserver(l.EffectEvent.DISABLE,c)),n.Observer(e.GetCharacter().CreateObserver(t.stat.ELEMENTAL_BURST_LEVEL,c)),n.Observer(e.GetCharacter().CreateObserver(t.stat.ELEMENTAL_BURST_LEVEL_UP,c)),n.Observer(e.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,c)),()=>0}}),v1=l.Factory({Name:"NahidaC1",OnApply(e,a,n){const s=e.FindEffect("NahidaQ");if(!s)throw new Error("Nahida Burst effect not found");const r=s;function i(){r.Enabled()&&(r.Disable(),r.Enable())}return i(),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,i)),n.Observer(a.CreateObserver(l.EffectEvent.DISABLE,i)),n.Observer(a.CreateObserver(l.EffectEvent.CHANGE_TARGET,i)),()=>0}}),y1=l.Factory({Name:"NahidaC2",ApplyOther:!0,MaxAuras:1,ValidAuras:[t.aura.QUICKEN],OnApply(e,a,n){P1(e,a,n);const r=["BURGEON","BLOOM","HYPERBLOOM","BURNING"].map(i=>e.FindTr("HIT_"+i));for(const i of r)!i||(n.Modifier(i.Subject.CreateModifier(t.stat.CRIT_RATE,.2)),n.Modifier(i.Subject.CreateModifier(t.stat.CRIT_DMG,1)));return()=>0}}),P1=new l.Builder().Where({effect:{aura:[t.aura.QUICKEN]}}).stat.Enemy(t.stat.DEFREDUCTION).Values(.3).Build(),H1=l.Factory({Name:"NahidaC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),w1=l.Factory({Name:"NahidaC4",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Stacks([0,100,120,140,160]).Build()}),B1=l.Factory({Name:"NahidaC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),b1=l.Factory({Name:"NahidaC6",OnApply(e,a,n){K1(e,a,n);function s(){const r=e.FindEffect("NahidaQ"),i=e.FindEffect("NahidaA4");r&&r.Enabled()&&(r.Disable(),r.Enable()),i&&i.Enabled()&&(i.Disable(),i.Enable())}return s(),n.Observer(a.CreateObserver(l.EffectEvent.ENABLE,s)),n.Observer(a.CreateObserver(l.EffectEvent.DISABLE,s)),()=>0}}),K1=new l.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Talent:t.stat.NONE,Initial:2},{Scaling:o.TalentScaling.NONE,Stat:t.stat.ELEMENTAL_MASTERY,Talent:t.stat.NONE,Initial:4}]}).Build(),Yi=G.Factory({Name:"Nahida",Stars:5,Element:t.stat.DENDRO_DMG,Region:t.region.SUMERU,Weapon:t.weapon.CATALYST,StatBonus:t.stat.ELEMENTAL_MASTERY,BurstCost:50,HpBase:[806.5087,3311.961],AtkBase:[23.275,95.57275],DefBase:[49.0606,201.474],Normals:G1,Skills:I1,Bursts:[],Extra:[],Effects:[D1,R1,O1,v1,y1,H1,w1,B1,b1]}),ta=new Q(e=>e.Name);ta.AddList(Object.values(Fr).sort((e,a)=>e.Name.localeCompare(a.Name)));function Fi(){return ta.Get()}function Y1(e){return ta.Find(e)}var et={};D(et,{Akuoumaru:()=>Tl,AlleyHunter:()=>Po,AmberBead:()=>Tc,AmenomaKageuchi:()=>to,AmosBow:()=>Mo,AquaSimulacra:()=>No,AquilaFavonia:()=>ql,BalladOfTheFjords:()=>al,BeaconOfTheReedSea:()=>ol,BlackTassel:()=>bc,BlackcliffAgate:()=>rc,BlackcliffLongsword:()=>so,BlackcliffPole:()=>Yc,BlackcliffSlasher:()=>Sl,BlackcliffWarbow:()=>sl,BloodtaintedGreatsword:()=>hl,CalamityQueller:()=>fc,CinnabarSpindle:()=>Zl,CompoundBow:()=>wo,CoolSteel:()=>fo,CrescentPike:()=>Oc,DarkIronSword:()=>Ao,Deathmatch:()=>Fc,DebateClub:()=>ml,DodocoTales:()=>ac,DragonsBane:()=>vc,DragonspineSpear:()=>Rc,ElegyForTheEnd:()=>Pc,EmeraldOrb:()=>uc,EndOfTheLine:()=>go,EngulfingLightning:()=>Mc,EverlastingMoonglow:()=>$o,EyeOfPerception:()=>sc,FadingTwilight:()=>yo,FavoniusCodex:()=>Ec,FavoniusGreatsword:()=>fl,FavoniusLance:()=>wc,FavoniusSword:()=>xc,FavoniusWarbow:()=>Uc,FerrousShadow:()=>Ll,FesteringDesire:()=>eo,FilletBlade:()=>So,FinaleOfTheDeep:()=>$i,FindByName:()=>Q1,FleuveCendreFerryman:()=>Qi,FlowingPurity:()=>qi,ForestRegalia:()=>dl,FreedomSworn:()=>kl,Frostbearer:()=>nc,FruitOfFulfillment:()=>Zo,GetByType:()=>X1,GetList:()=>zc,HakushinRing:()=>ec,Halberd:()=>Dc,Hamayumi:()=>Oo,HaranGeppakuFutsu:()=>Ul,HarbingerOfDawn:()=>mo,HuntersPath:()=>Lo,IbisPiercer:()=>rl,IronSting:()=>ro,JadeCutter:()=>jl,JadeSpear:()=>Lc,JadefallSplendor:()=>il,KagotsurubeIsshin:()=>Jl,KagurasVerity:()=>qo,KatsuragikiriNagamasa:()=>Cl,KeyOfKhajNisut:()=>xl,KingsSquire:()=>Go,KitainCrossSpear:()=>Gc,LightOfFoliarIncision:()=>Vl,LionsRoar:()=>lo,LithicBlade:()=>gl,LithicSpear:()=>Ic,LostPrayer:()=>Xo,LuxuriousSeaLord:()=>pl,MagicGuide:()=>hc,MailedFlower:()=>ll,MakhairaAquamarine:()=>Al,MappaMare:()=>ic,MemoryOfDust:()=>Qo,Messenger:()=>Fo,MissiveWindspear:()=>dc,MistsplitterReforged:()=>Wl,MitternachtsWaltz:()=>vo,Moonpiercer:()=>Cc,MouunsMoon:()=>Ro,OathswornEye:()=>tc,OtherworldlyStory:()=>Ac,PolarStar:()=>Co,Predator:()=>Io,PrototypeAmber:()=>lc,PrototypeArchaic:()=>Rl,PrototypeCrescent:()=>Bo,PrototypeRancour:()=>io,PrototypeStarglitter:()=>Kc,Rainslasher:()=>Il,RavenBow:()=>Uo,RecurveBow:()=>Vo,RedhornStonethresher:()=>Ol,RightfulReward:()=>ji,RoyalBow:()=>To,RoyalGreatsword:()=>Dl,RoyalGrimoire:()=>co,RoyalLongsword:()=>_o,RoyalSpear:()=>Eo,Rust:()=>bo,SacrificialBow:()=>Ko,SacrificialFragments:()=>cc,SacrificialGreatsword:()=>vl,SacrificialJade:()=>Zi,SacrificialSword:()=>yc,SapwoodBlade:()=>Xl,ScionOfTheBlazingSun:()=>tl,SerpentSpine:()=>Fl,SharpshootersOath:()=>xo,SkyriderGreatsword:()=>yl,SkyriderSword:()=>uo,SkywardAtlas:()=>Jo,SkywardBlade:()=>kc,SkywardHarp:()=>Vc,SkywardPride:()=>Pl,SkywardSpine:()=>Nc,Slingshot:()=>ko,SnowTombedStarsilver:()=>Hl,SolarPearl:()=>oc,SongOfBrokenPines:()=>Gl,SongOfStillness:()=>zi,SplendorOfTranquilWaters:()=>Ui,StaffOfHoma:()=>Hc,StaffOfTheScarletSands:()=>mc,SummitShaper:()=>zl,SwordOfDescension:()=>ao,TalkingStick:()=>el,TheAlleyFlash:()=>no,TheBell:()=>wl,TheBlackSword:()=>cl,TheCatch:()=>El,TheFirstGreatMagic:()=>nl,TheFlute:()=>oo,TheStringless:()=>Yo,TheUnforged:()=>Bl,TheViridescentHunt:()=>Ho,TheWidsith:()=>Wc,ThousandFloatingDreams:()=>jo,ThrillingTalesOfDragonSlayers:()=>Sc,ThunderingPulse:()=>po,TidalShadow:()=>Xi,TomeOfTheEternalFlow:()=>Wi,ToukabouShigure:()=>$l,TravelersHandySword:()=>ho,TulaytullahsRemembrance:()=>Wo,TwinNephrite:()=>_c,UltimateOverlordsMegaMagicSword:()=>Vi,Veredict:()=>xi,VortexVanquisher:()=>pc,WanderingEvenstar:()=>zo,WavebreakerFin:()=>gc,WhiteIronGreatsword:()=>Kl,WhiteTassel:()=>Bc,Whiteblind:()=>bl,WindblumeOde:()=>Do,WineAndSong:()=>_l,WolfFang:()=>Ji,WolfsGravestone:()=>Yl,XiphosMoonlight:()=>Ql});var ki={};D(ki,{Akuoumaru:()=>Tl,AlleyHunter:()=>Po,AmberBead:()=>Tc,AmenomaKageuchi:()=>to,AmosBow:()=>Mo,AquaSimulacra:()=>No,AquilaFavonia:()=>ql,BalladOfTheFjords:()=>al,BeaconOfTheReedSea:()=>ol,BlackTassel:()=>bc,BlackcliffAgate:()=>rc,BlackcliffLongsword:()=>so,BlackcliffPole:()=>Yc,BlackcliffSlasher:()=>Sl,BlackcliffWarbow:()=>sl,BloodtaintedGreatsword:()=>hl,CalamityQueller:()=>fc,CinnabarSpindle:()=>Zl,CompoundBow:()=>wo,CoolSteel:()=>fo,CrescentPike:()=>Oc,DarkIronSword:()=>Ao,Deathmatch:()=>Fc,DebateClub:()=>ml,DodocoTales:()=>ac,DragonsBane:()=>vc,DragonspineSpear:()=>Rc,ElegyForTheEnd:()=>Pc,EmeraldOrb:()=>uc,EndOfTheLine:()=>go,EngulfingLightning:()=>Mc,EverlastingMoonglow:()=>$o,EyeOfPerception:()=>sc,FadingTwilight:()=>yo,FavoniusCodex:()=>Ec,FavoniusGreatsword:()=>fl,FavoniusLance:()=>wc,FavoniusSword:()=>xc,FavoniusWarbow:()=>Uc,FerrousShadow:()=>Ll,FesteringDesire:()=>eo,FilletBlade:()=>So,FinaleOfTheDeep:()=>$i,FleuveCendreFerryman:()=>Qi,FlowingPurity:()=>qi,ForestRegalia:()=>dl,FreedomSworn:()=>kl,Frostbearer:()=>nc,FruitOfFulfillment:()=>Zo,HakushinRing:()=>ec,Halberd:()=>Dc,Hamayumi:()=>Oo,HaranGeppakuFutsu:()=>Ul,HarbingerOfDawn:()=>mo,HuntersPath:()=>Lo,IbisPiercer:()=>rl,IronSting:()=>ro,JadeCutter:()=>jl,JadeSpear:()=>Lc,JadefallSplendor:()=>il,KagotsurubeIsshin:()=>Jl,KagurasVerity:()=>qo,KatsuragikiriNagamasa:()=>Cl,KeyOfKhajNisut:()=>xl,KingsSquire:()=>Go,KitainCrossSpear:()=>Gc,LightOfFoliarIncision:()=>Vl,LionsRoar:()=>lo,LithicBlade:()=>gl,LithicSpear:()=>Ic,LostPrayer:()=>Xo,LuxuriousSeaLord:()=>pl,MagicGuide:()=>hc,MailedFlower:()=>ll,MakhairaAquamarine:()=>Al,MappaMare:()=>ic,MemoryOfDust:()=>Qo,Messenger:()=>Fo,MissiveWindspear:()=>dc,MistsplitterReforged:()=>Wl,MitternachtsWaltz:()=>vo,Moonpiercer:()=>Cc,MouunsMoon:()=>Ro,OathswornEye:()=>tc,OtherworldlyStory:()=>Ac,PolarStar:()=>Co,Predator:()=>Io,PrototypeAmber:()=>lc,PrototypeArchaic:()=>Rl,PrototypeCrescent:()=>Bo,PrototypeRancour:()=>io,PrototypeStarglitter:()=>Kc,Rainslasher:()=>Il,RavenBow:()=>Uo,RecurveBow:()=>Vo,RedhornStonethresher:()=>Ol,RightfulReward:()=>ji,RoyalBow:()=>To,RoyalGreatsword:()=>Dl,RoyalGrimoire:()=>co,RoyalLongsword:()=>_o,RoyalSpear:()=>Eo,Rust:()=>bo,SacrificialBow:()=>Ko,SacrificialFragments:()=>cc,SacrificialGreatsword:()=>vl,SacrificialJade:()=>Zi,SacrificialSword:()=>yc,SapwoodBlade:()=>Xl,ScionOfTheBlazingSun:()=>tl,SerpentSpine:()=>Fl,SharpshootersOath:()=>xo,SkyriderGreatsword:()=>yl,SkyriderSword:()=>uo,SkywardAtlas:()=>Jo,SkywardBlade:()=>kc,SkywardHarp:()=>Vc,SkywardPride:()=>Pl,SkywardSpine:()=>Nc,Slingshot:()=>ko,SnowTombedStarsilver:()=>Hl,SolarPearl:()=>oc,SongOfBrokenPines:()=>Gl,SongOfStillness:()=>zi,SplendorOfTranquilWaters:()=>Ui,StaffOfHoma:()=>Hc,StaffOfTheScarletSands:()=>mc,SummitShaper:()=>zl,SwordOfDescension:()=>ao,TalkingStick:()=>el,TheAlleyFlash:()=>no,TheBell:()=>wl,TheBlackSword:()=>cl,TheCatch:()=>El,TheFirstGreatMagic:()=>nl,TheFlute:()=>oo,TheStringless:()=>Yo,TheUnforged:()=>Bl,TheViridescentHunt:()=>Ho,TheWidsith:()=>Wc,ThousandFloatingDreams:()=>jo,ThrillingTalesOfDragonSlayers:()=>Sc,ThunderingPulse:()=>po,TidalShadow:()=>Xi,TomeOfTheEternalFlow:()=>Wi,ToukabouShigure:()=>$l,TravelersHandySword:()=>ho,TulaytullahsRemembrance:()=>Wo,TwinNephrite:()=>_c,UltimateOverlordsMegaMagicSword:()=>Vi,Veredict:()=>xi,VortexVanquisher:()=>pc,WanderingEvenstar:()=>zo,WavebreakerFin:()=>gc,WhiteIronGreatsword:()=>Kl,WhiteTassel:()=>Bc,Whiteblind:()=>bl,WindblumeOde:()=>Do,WineAndSong:()=>_l,WolfFang:()=>Ji,WolfsGravestone:()=>Yl,XiphosMoonlight:()=>Ql});var vt=4,Vi=p.Factory({Name:"UltimateOverlordsMegaMagicSword",Stars:4,Type:t.weapon.CLAYMORE,Substat:t.stat.ENERGY_RECHARGE,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"UltimateOverlordsMegaMagicSword1",MaxRank:5,MaxStacks:vt,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ATK_PERCENT).Values(.12/vt,.15/vt,.18/vt,.21/vt,.24/vt).Stacks().Build()})]}),xi=p.Factory({Name:"Verdict",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"Verdict1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.ATK).Values(.2,.25,.3,.35,.4).Next().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.18,.225,.27,.315,.36).Stacks().Build()})]}),Ui=p.Factory({Name:"SplendorOfTranquilWaters",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"SplendorOfTranquilWaters1",MaxStacks:3,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.08,.1,.12,.14,.16).Stacks().Build()}),l.Factory({Name:"SplendorOfTranquilWaters2",MaxStacks:2,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.14,.175,.21,.245,.28).Stacks().Build()})]}),Wi=p.Factory({Name:"TomeOfTheEternalFlow",Stars:5,Type:t.weapon.CATALYST,Substat:t.stat.CRIT_DMG,Scaling:o.WeaponScaling.TYPE_44b,Effects:[l.Factory({Name:"TomeOfTheEternalFlow1",MaxStacks:3,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.14,.18,.22,.26,.3).Stacks().Build()})]}),ji=p.Factory({Name:"RightfulReward",Stars:4,Type:t.weapon.POLEARM,Substat:t.stat.HP_PERCENT,Scaling:o.WeaponScaling.TYPE_44,Effects:[]}),zi=p.Factory({Name:"SongOfStillness",Stars:4,Type:t.weapon.BOW,Substat:t.stat.ATK_PERCENT,Scaling:o.WeaponScaling.TYPE_42,Effects:[l.Factory({Name:"SongOfStillness1",MaxRank:5,MaxConditions:1,Conditions:["HEALED"],OnApply:new l.Builder().Where({effect:{conditions:["HEALED"]}}).stat.Char(t.stat.ALL_DMG).Values(.16,.2,.24,.28,.32).Build()})]}),qi=p.Factory({Name:"FlowingPurity",Stars:4,Type:t.weapon.CATALYST,Substat:t.stat.ATK_PERCENT,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"FlowingPurity1",MaxRank:5,MaxConditions:1,MaxStacks:6e3,Conditions:["CAST_SKILL"],OnApply:new l.Builder().Where({effect:{conditions:["CAST_SKILL"]}}).stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.08,.1,.12,.14,.16).Next().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(...[.02,.025,.03,.035,.04].map(e=>e/1e3)).Stacks().Build()})]}),$i=p.Factory({Name:"FinaleOfTheDeep",Stars:4,Type:t.weapon.SWORD,Substat:t.stat.ATK_PERCENT,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"FinaleOfTheDeep1",MaxRank:5,MaxStacks:100,MaxConditions:1,Conditions:["CAST_SKILL"],OnApply:new l.Builder().Where({effect:{conditions:["CAST_SKILL"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Next().observe.Target(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ATK_FLAT).Values(.024,.03,.036,.042,.048).Map((e,a,n)=>{let s=e*n.GetStacks()/100*.25*a.GetCharacter().Get(t.stat.HP);return s=Math.min(s,150/.024*e),s}).Build()})]}),Qi=p.Factory({Name:"FleuveCendreFerryman",Stars:4,Type:t.weapon.SWORD,Substat:t.stat.ENERGY_RECHARGE,Scaling:o.WeaponScaling.TYPE_42,Effects:[l.Factory({Name:"FleuveCendreFerryman1",MaxRank:5,Conditions:["CAST_SKILL"],MaxConditions:1,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_CRIT_RATE).Values(.08,.1,.12,.14,.16).Next().Where({effect:{conditions:["CAST_SKILL"]}}).stat.Char(t.stat.ENERGY_RECHARGE).Values(.16,.2,.24,.28,.32).Build()})]}),Xi=p.Factory({Name:"TidalShadow",Stars:4,Type:t.weapon.CLAYMORE,Substat:t.stat.ATK_PERCENT,Scaling:o.WeaponScaling.TYPE_42,Effects:[l.Factory({Name:"TidalShadow1",MaxRank:5,Conditions:["HEALED"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["HEALED"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.24,.3,.36,.42,.48).Build()})]}),Ji=p.Factory({Name:"WolfFang",Stars:4,Type:t.weapon.SWORD,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_42,Effects:[l.Factory({Name:"WolfFang1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.16,.2,.24,.28,.32).Build()}),l.Factory({Name:"WolfFang2",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_CRIT_RATE).Values(.02,.025,.03,.035,.04).Stacks().Build()}),l.Factory({Name:"WolfFang3",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.02,.025,.03,.035,.04).Stacks().Build()})]}),Zi=p.Factory({Name:"SacrificialJade",Stars:4,Type:t.weapon.CATALYST,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_42,Effects:[l.Factory({Name:"SacrificialJade1",MaxRank:5,Conditions:["OFF_FIELD"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["OFF_FIELD"]}}).stat.Char(t.stat.HP_PERCENT).Values(.32,.4,.48,.56,.64).Next().Where({effect:{conditions:["OFF_FIELD"]}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(40,50,60,70,80).Build()})]}),tl=p.Factory({Name:"ScionOfTheBlazingSun",Stars:4,Type:t.weapon.BOW,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"ScionOfTheBlazingSun1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_ScionOfTheBlazingSun",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.6,.75,.9,1.05,1.2]}).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.28,.35,.42,.49,.56).Build()})]}),el=p.Factory({Name:"TalkingStick",Stars:4,Type:t.weapon.CLAYMORE,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"TalkingStick1",MaxRank:5,MaxAuras:2,ValidAuras:[t.aura.PYRO,t.aura.HYDRO],OnApply:new l.Builder().Where({effect:{aura:[t.aura.PYRO]}}).stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Next().Where({effect:{aura:[t.aura.HYDRO]}}).stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Build()})]}),al=p.Factory({Name:"BalladOfTheFjords",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"BalladOfTheFjords1",MaxRank:5,OnApply:new l.Builder().observe.Party(!0).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(120,150,180,210,240).Map((e,a)=>{const n=a.GetParty();if(!n)return 0;const s=new Set;for(const r of n.GetMembers())s.add(r.GetCharacter().Options.Element);return s.size>=3?e:0}).Build()})]}),nl=p.Factory({Name:"TheFirstGreatMagic",Type:t.weapon.BOW,Stars:5,Substat:t.stat.CRIT_DMG,Scaling:o.WeaponScaling.TYPE_46,Effects:[l.Factory({Name:"TheFirstGreatMagic1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().observe.Party(!0).stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Map((e,a)=>{let n=1;const s=a.GetCharacter().Options.Element,r=a.GetParty();if(r)for(const i of r.GetMembers())i!==a&&i.GetCharacter().Options.Element===s&&n++;return n=Math.min(n,3),e*n}).Build()})]}),Kt=e=>l.Factory({Name:e,MaxRank:5,MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Stacks().Build()}),sl=p.Factory({Name:"BlackcliffWarbow",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.CRIT_DMG,Effects:[Kt("BlackcliffWarbow1")]}),rl=p.Factory({Name:"IbisPiercer",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"IbisPiercer1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(40,50,60,70,80).Stacks().Build()})]}),il=p.Factory({Name:"JadefallSplendor",Type:t.weapon.CATALYST,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"JadefallSplendor1",MaxRank:5,OnApply:new l.Builder().observe.Owner(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.MapStat(e=>[e.GetCharacter().Options.Element]).Values(.3,.5,.7,.9,1.1).Map((e,a,n)=>Math.min([.12,.2,.28,.36,.44][n.GetRank()-1],e/100*a.GetCharacter().Get(t.stat.HP)/1e3)).Build()})]}),ll=p.Factory({Name:"MailedFlower",Stars:4,Type:t.weapon.CLAYMORE,Substat:t.stat.ELEMENTAL_MASTERY,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"MailedFlower1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(48,60,72,84,96).Build()})]}),ol=p.Factory({Name:"BeaconOfTheReedSea",Stars:5,Type:t.weapon.CLAYMORE,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_46,Effects:[l.Factory({Name:"BeaconOfTheReedSea1",MaxRank:5,Conditions:["HIT_SKILL","DMG_TAKEN"],MaxConditions:2,OnApply:new l.Builder().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["DMG_TAKEN"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().Where({target:{shielded:!1}}).stat.Char(t.stat.HP_PERCENT).Values(.32,.4,.48,.56,.64).Build()})]}),cl=p.Factory({Name:"TheBlackSword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"TheBlackSword1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),El=p.Factory({Name:"TheCatch",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"TheCatch1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.06,.075,.09,.105,.12).Build()})]}),ea=e=>l.Factory({Name:e,MaxRank:5,OnApply(a,n,s){const r=a.GetCharacter(),i=s.Modifier(r.CreateModifier(t.stat.ELEMENTAL_BURST_DMG,0));function c(){let _=[r];const u=a.GetParty();u&&(_=u.GetMembers().map(h=>h.GetCharacter()));let A=0;for(const h of _)A+=h.Options.BurstCost;const S=Math.min(k1[n.GetRank()-1],F1[n.GetRank()-1]*A);i.SetValue(S)}return s.Observer(n.Event.CreateObserver(l.EffectEvent.CHANGE_RANK,c)),s.Observer(a.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,c)),()=>0}}),F1=[.12/100,.15/100,.18/100,.21/100,.24/100],k1=[.4,.5,.6,.7,.8],Tl=p.Factory({Name:"Akuoumaru",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[ea("Akuoumaru1")]}),_l=p.Factory({Name:"WineAndSong",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"WineAndSong1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),ul=(e,a,n)=>l.Factory({Name:e,ApplyOther:!0,StackSelf:!0,MaxRank:5,OnApply(s,r,i){const c=r.Owner.GetCharacter(),_=s.GetCharacter(),u=i.Modifier(_.CreateModifier(a,0));function A(){const S=c.Get(t.stat.ELEMENTAL_MASTERY);let h=n[r.GetRank()-1]*S;c!==_&&(h*=.3),u.SetValue(h)}return A(),i.Observer(c.CreateObserver(t.stat.ELEMENTAL_MASTERY,A)),()=>0}}),Al=p.Factory({Name:"MakhairaAquamarine",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[ul("MakhairaAquamarine1",t.stat.ATK_FLAT,[.24,.3,.36,.42,.48])]}),Sl=p.Factory({Name:"BlackcliffSlasher",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[Kt("BlackcliffSlasher1")]}),hl=p.Factory({Name:"BloodtaintedGreatsword",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"BloodtaintedGreatsword1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),ml=p.Factory({Name:"DebateClub",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"DebateClub1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_DebateClub",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.6,.75,.9,1.05,1.2]}).Build()})]}),fl=p.Factory({Name:"FavoniusGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Ll=p.Factory({Name:"FerrousShadow",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"FerrousShadow1",MaxRank:5,OnApply:new l.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.3,.35,.4,.45,.5).Build()})]}),pl=p.Factory({Name:"LuxuriousSeaLord",Type:t.weapon.CLAYMORE,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"LuxuriousSeaLord1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.12,.15,.18,.21,.24).Next().instance.Basic({Name:"HIT_LuxuriousSeaLord",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),Nl=e=>l.Factory({Name:e,MaxRank:5,ApplyOther:!0,MaxTargets:1,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,75,90,105,120).Build()}),dl=p.Factory({Name:"ForestRegalia",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[Nl("ForestRegalia1")]}),Cl=p.Factory({Name:"KatsuragikiriNagamasa",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"KatsuragikiriNagamasa1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.06,.075,.09,.105,.12).Build()})]}),Ml=e=>l.Factory({Name:e,MaxRank:5,OnApply(a,n,s){const r=a.GetCharacter(),i=s.Modifier(r.CreateModifier(t.stat.CRIT_RATE,0)),c=s.Modifier(r.CreateModifier(t.stat.ATK_PERCENT,0));function _(){let u=[r];const A=a.GetParty();A&&(u=A.GetMembers().map(f=>f.GetCharacter()));const S=Math.min(4,u.filter(f=>f.Options.Region===t.region.LIYUE).length),h=V1[n.GetRank()-1]*S,m=x1[n.GetRank()-1]*S;i.SetValue(h),c.SetValue(m)}return _(),s.Observer(n.CreateObserver(l.EffectEvent.CHANGE_RANK,_)),s.Observer(a.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,_)),()=>0}}),V1=[.03,.04,.05,.06,.07],x1=[.07,.08,.09,.1,.11],gl=p.Factory({Name:"LithicBlade",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Ml("LithicBlade1")]}),aa=new Map;function U1(e){const a=aa.get(e);if(!a){const n=new Set;return aa.set(e,n),n}return a}var na=({Name:e,OnApply:a})=>l.Factory({Name:e,MaxRank:5,ApplyOther:!0,OnApply(n,s,r){a(n,s,r);const i=r.GetModifiers(),c=U1(n);i.forEach(u=>c.add(u));function _(){for(const u of i)Array.from(c).some(S=>S!==u&&S.GetProp()===u.GetProp()&&S.Enabled()&&S.GetValue()!==0)&&(u.SetValue(0),u.Disable())}_();for(const u of l.EffectEvent.Values())r.Observer(s.CreateObserver(u,_));return()=>{i.forEach(u=>c.delete(u)),c.size===0&&aa.delete(n)}}}),Gl=p.Factory({Name:"SongOfBrokenPines",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_49,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"SongOfBrokenPines1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()}),na({Name:"SongOfBrokenPines2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),Rl=p.Factory({Name:"PrototypeArchaic",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"PrototypeArchaic1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_PrototypeArchaic",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,3,3.6,4.2,4.8]}).Build()})]}),Il=p.Factory({Name:"Rainslasher",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"Rainslasher1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),Ol=p.Factory({Name:"RedhornStonethresher",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"RedhornStonethresher1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.28,.35,.42,.49,.56).Next().observe.Target(t.stat.DEF,t.stat.DEF_PERCENT,t.stat.DEF_FLAT).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(.4,.5,.6,.7,.8).Map((e,a)=>e*a.GetCharacter().Get(t.stat.DEF)).Build()})]}),Yt=e=>l.Factory({Name:e,MaxRank:5,OnApply(a,n,s){const r=a.GetCharacter();function i(c=!0){if(!c)r.MapCritRate=_=>_;else{const _=n.GetRank();r.MapCritRate=u=>W1(_,u)}}return i(!0),s.Observer(n.CreateObserver(l.EffectEvent.ENABLE,()=>i(!0))),s.Observer(n.CreateObserver(l.EffectEvent.CHANGE_RANK,()=>i(!0))),s.Observer(n.CreateObserver(l.EffectEvent.DISABLE,()=>i(!1))),()=>i(!1)}});function W1(e,a){const n=Math.max,s=.08+.02*(e-1);return a<0?((5*s+a)*n(0,a)-(5*s*a-5*s+g(a,2)-a)*n(0,s+a)+(5*g(s,2)*a-5*g(s,2)+6*s*g(a,2)-11*s*a+5*s+g(a,3)-2*g(a,2)+a)*n(0,2*s+a)-(10*g(s,3)*a-10*g(s,3)+17*g(s,2)*g(a,2)-32*g(s,2)*a+15*g(s,2)+8*s*g(a,3)-21*s*g(a,2)+18*s*a-5*s+g(a,4)-3*g(a,3)+3*g(a,2)-a)*n(0,3*s+a)+(30*g(s,4)*a-30*g(s,4)+61*g(s,3)*g(a,2)-116*g(s,3)*a+55*g(s,3)+41*g(s,2)*g(a,3)-112*g(s,2)*g(a,2)+101*g(s,2)*a-30*g(s,2)+11*s*g(a,4)-38*s*g(a,3)+48*s*g(a,2)-26*s*a+5*s+g(a,5)-4*g(a,4)+6*g(a,3)-4*g(a,2)+a)*n(0,4*s+a)-(24*g(s,4)*a-24*g(s,4)+50*g(s,3)*g(a,2)-100*g(s,3)*a+50*g(s,3)+35*g(s,2)*g(a,3)-105*g(s,2)*g(a,2)+105*g(s,2)*a-35*g(s,2)+10*s*g(a,4)-40*s*g(a,3)+60*s*g(a,2)-40*s*a+10*s+g(a,5)-5*g(a,4)+10*g(a,3)-10*g(a,2)+5*a-1)*n(0,5*s+a))/(6*g(s,4)*a-6*g(s,4)+11*g(s,3)*g(a,2)-26*g(s,3)*a+15*g(s,3)+6*g(s,2)*g(a,3)-24*g(s,2)*g(a,2)+33*g(s,2)*a-15*g(s,2)+s*g(a,4)-6*s*g(a,3)+15*s*g(a,2)-20*s*a+15*s+1):(5*s+a)/(6*g(s,4)*a-6*g(s,4)+11*g(s,3)*g(a,2)-26*g(s,3)*a+15*g(s,3)+6*g(s,2)*g(a,3)-24*g(s,2)*g(a,2)+33*g(s,2)*a-15*g(s,2)+s*g(a,4)-6*s*g(a,3)+15*s*g(a,2)-20*s*a+15*s+1)}var Dl=p.Factory({Name:"RoyalGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Yt("RoyalGreatsword1")]}),vl=p.Factory({Name:"SacrificialGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),yl=p.Factory({Name:"SkyriderGreatsword",Type:t.weapon.CLAYMORE,Stars:3,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"SkyriderGreatsword1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.06,.07,.08,.09,.1).Build()})]}),Pl=p.Factory({Name:"SkywardPride",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"SkywardPride1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.08,.1,.12,.14,.16).Next().instance.Basic({Name:"HIT_SkywardPride",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.8,1,1.2,1.4,1.6]}).Build()})]}),sa=(e,a)=>l.Factory({Name:e,MaxRank:5,OnApply:new l.Builder().instance.Options({Name:a,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NONE,Scaling:[{Initial:0,Stat:t.stat.NONE,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Next().Where({not:!0,enemy:{affected:[t.stat.CRYO_DMG]}}).mv.Mv(t.stat.ATK,.8,a).Map((n,s,r)=>[.8,.95,1.1,1.25,1.4][r.GetRank()-1]).Next().Where({enemy:{affected:[t.stat.CRYO_DMG]}}).mv.Mv(t.stat.ATK,2,a).Map((n,s,r)=>[2,2.4,2.8,3.2,3.6][r.GetRank()-1]).Build()}),Hl=p.Factory({Name:"SnowTombedStarsilver",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[sa("SnowTombedStarsilver1","HIT_SnowTombedStarsilver")]}),wl=p.Factory({Name:"TheBell",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"TheBell1",MaxRank:5,OnApply:new l.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),oe=e=>l.Factory({Name:e,MaxRank:5,MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Next().Where({target:{shielded:!0}}).stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()}),Bl=p.Factory({Name:"TheUnforged",Type:t.weapon.CLAYMORE,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[oe("TheUnforged1")]}),bl=p.Factory({Name:"Whiteblind",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.DEF_PERCENT,Effects:[l.Factory({Name:"Whiteblind1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),Kl=p.Factory({Name:"WhiteIronGreatsword",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.DEF_PERCENT,Effects:[]}),Yl=p.Factory({Name:"WolfsGravestone",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"WolfsGravestone1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()}),l.Factory({Name:"WolfsGravestone2",MaxRank:5,ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.4,.5,.6,.7,.8).Build()})]}),Fl=p.Factory({Name:"SerpentSpine",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"SerpentSpine1",MaxRank:5,MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.06,.07,.08,.09,.1).Stacks().Build()})]}),kl=p.Factory({Name:"FreedomSworn",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"FreedomSworn1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.1,.125,.15,.175,.2).Build()}),na({Name:"FreedomSworn2",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),Vl=p.Factory({Name:"LightOfFoliarIncision",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"LightOfFoliarIncision1",MaxRank:5,Conditions:["HIT_NORMAL"],MaxConditions:1,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.04,.05,.06,.07,.08).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT,t.stat.ELEMENTAL_SKILL_DMG_FLAT).Values(1.2,1.5,1.8,2.1,2.4).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()})]}),xl=p.Factory({Name:"KeyOfKhajNisut",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"KeyOfKhajNisut1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Build()}),l.Factory({Name:"KeyOfKhajNisut2",MaxRank:5,MaxStacks:3,ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.HP,t.stat.HP_PERCENT,t.stat.HP_FLAT).Where({target:{isOwner:!0}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(.12,.15,.18,.21,.24).Stacks().Map((e,a)=>e*a.GetCharacter().Get(t.stat.HP)/100).Next().observe.Owner(t.stat.HP,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ELEMENTAL_MASTERY).Stacks([0,0,0,.2],[0,0,0,.25],[0,0,0,.3],[0,0,0,.35],[0,0,0,.4]).Map((e,a,{Owner:n})=>e*n.GetCharacter().Get(t.stat.HP)/100).Build()})]}),Ul=p.Factory({Name:"HaranGeppakuFutsu",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"HaranGeppakuFutsu1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Stacks().Build()})]}),Wl=p.Factory({Name:"MistsplitterReforged",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"MistsplitterReforged1",MaxRank:5,MaxStacks:3,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char().MapStat(e=>[e.GetCharacter().Options.Element]).Stacks([0,.08,.16,.28],[0,.1,.2,.35],[0,.12,.24,.42],[0,.14,.28,.49],[0,.16,.32,.56]).Build()})]}),jl=p.Factory({Name:"JadeCutter",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"JadeCutter1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Next().observe.Target(t.stat.HP_PERCENT,t.stat.HP_FLAT,t.stat.HP_BASE).stat.Char(t.stat.ATK_FLAT).Values(.012,.015,.018,.021,.024).Map((e,a)=>e*a.GetCharacter().Get(t.stat.HP)).Build()})]}),zl=p.Factory({Name:"SummitShaper",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[oe("SummitShaper1")]}),ql=p.Factory({Name:"AquilaFavonia",Type:t.weapon.SWORD,Stars:5,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"AquilaFavonia1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().instance.Basic({Name:"HIT_AquilaFavonia",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2,2.3,2.6,2.9,3.2]}).Build()})]}),$l=p.Factory({Name:"ToukabouShigure",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"ToukabouShigure1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.16,.2,.24,.28,.32).Build()})]}),Ql=p.Factory({Name:"XiphosMoonlight",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[ul("XiphosMoonlight1",t.stat.ENERGY_RECHARGE,[.036/100,.045/100,.054/100,.063/100,.072/100])]}),Xl=p.Factory({Name:"SapwoodBlade",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[Nl("SapwoodBlade1")]}),Jl=p.Factory({Name:"KagotsurubeIsshin",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"KagotsurubeIsshin1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_KagotsurubeIsshin",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.8]}).Next().stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()})]}),Zl=p.Factory({Name:"CinnabarSpindle",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.DEF_PERCENT,Effects:[l.Factory({Name:"CinnabarSpindle1",MaxRank:5,OnApply:new l.Builder().mv.Mv(t.stat.DEF,.4,e=>e.Options.Talent===t.stat.ELEMENTAL_SKILL_DMG).Map((e,a,n)=>[.4,.5,.6,.7,.8][n.GetRank()-1]).Build()})]}),to=p.Factory({Name:"AmenomaKageuchi",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[]}),eo=p.Factory({Name:"FesteringDesire",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"FesteringDesire1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ELEMENTAL_SKILL_CRIT_RATE).Values(.06,.075,.09,.105,.12).Build()})]}),ao=p.Factory({Name:"SwordOfDescension",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39b,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"SwordOfDescension1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_SwordOfDescension",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2]}).Next().Where({target:{name:/traveler/i}}).stat.Char(t.stat.ATK_FLAT).Values(66).Build()})]}),no=p.Factory({Name:"TheAlleyFlash",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_45,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"TheAlleyFlash1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),so=p.Factory({Name:"BlackcliffLongsword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.CRIT_DMG,Effects:[Kt("BlackcliffLongsword1")]}),ro=p.Factory({Name:"IronSting",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"IronSting1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),io=p.Factory({Name:"PrototypeRancour",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"PrototypeRancour1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()})]}),lo=p.Factory({Name:"LionsRoar",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"LionsRoar1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),oo=p.Factory({Name:"TheFlute",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"TheFlute1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_TheFlute",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),co=p.Factory({Name:"RoyalGrimoire",Type:t.weapon.CATALYST,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Yt("RoyalGrimoire1")]}),Eo=p.Factory({Name:"RoyalSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Yt("RoyalSpear1")]}),To=p.Factory({Name:"RoyalBow",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Yt("RoyalBow1")]}),_o=p.Factory({Name:"RoyalLongsword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Yt("RoyalLongsword1")]}),uo=p.Factory({Name:"SkyriderSword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"SkyriderSword1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Build()})]}),Ao=p.Factory({Name:"DarkIronSword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"DarkIronSword1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),So=p.Factory({Name:"FilletBlade",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"FilletBlade1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_FilletBlade",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,2.8,3.2,3.6,4]}).Build()})]}),ho=p.Factory({Name:"TravelersHandySword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.DEF_PERCENT,Effects:[]}),mo=p.Factory({Name:"HarbingerOfDawn",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"HarbingerOfDawn1",MaxRank:5,OnApply:new l.Builder().Where({target:{hp:{geq:.9}}}).stat.Char(t.stat.CRIT_RATE).Values(.14,.175,.21,.245,.28).Build()})]}),fo=p.Factory({Name:"CoolSteel",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"CoolSteel1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.CRYO_DMG,t.stat.HYDRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),Lo=p.Factory({Name:"HuntersPath",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"HuntersPath1",MaxRank:5,Conditions:["HIT_CHARGED"],MaxConditions:1,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({effect:{conditions:["HIT_CHARGED"]}}).stat.Char(t.stat.CHARGED_ATTACK_DMG_FLAT).Values(1.6,2,2.4,2.8,3.2).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()})]}),po=p.Factory({Name:"ThunderingPulse",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"ThunderingPulse1",MaxRank:5,MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG).Stacks([0,.12,.24,.4],[0,.15,.3,.5],[0,.18,.36,.6],[0,.21,.42,.7],[0,.24,.48,.8]).Build()})]}),No=p.Factory({Name:"AquaSimulacra",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"AquaSimulacra1",MaxRank:5,Conditions:["FAR","NEAR"],MaxConditions:1,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["NEAR"]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),Co=p.Factory({Name:"PolarStar",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"PolarStar1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Stacks([0,.1,.2,.3,.48],[0,.125,.25,.375,.6],[0,.15,.3,.45,.72],[0,.175,.35,.525,.84],[0,.2,.4,.6,.96]).Build()})]}),Mo=p.Factory({Name:"AmosBow",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"AmosBow1",MaxRank:5,MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),go=p.Factory({Name:"EndOfTheLine",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"EndOfTheLine1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_EndOfTheLine",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.8,1,1.2,1.4,1.6]}).Build()})]}),Go=p.Factory({Name:"KingsSquire",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"KingsSquire1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,80,100,120,140).Next().instance.Basic({Name:"HIT_KingsSquire",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.2,1.4,1.6,1.8]}).Build()})]}),Ro=p.Factory({Name:"MouunsMoon",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[ea("MouunsMoon1")]}),Io=p.Factory({Name:"Predator",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"Predator1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.1).Stacks().Next().Where({target:{name:"Aloy"}}).stat.Char(t.stat.ATK_FLAT).Values(66).Build()})]}),Oo=p.Factory({Name:"Hamayumi",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"Hamayumi1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().Where({target:{energy:{geq:1}}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().Where({target:{energy:{geq:1}}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().Build()})]}),Do=p.Factory({Name:"WindblumeOde",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"WindblumeOde1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()})]}),vo=p.Factory({Name:"MitternachtsWaltz",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"MitternachtsWaltz1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_SKILL"],MaxConditions:2,OnApply:new l.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),yo=p.Factory({Name:"FadingTwilight",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"FadingTwilight1",MaxRank:5,MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Stacks([0,.06,.1,.14],[0,.075,.125,.175],[0,.09,.15,.21],[0,.105,.175,.245],[0,.12,.2,.28]).Build()})]}),Po=p.Factory({Name:"AlleyHunter",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"AlleyHunter1",MaxRank:5,MaxStacks:10,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.02,.025,.03,.035,.04).Stacks().Build()})]}),Ho=p.Factory({Name:"TheViridescentHunt",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"TheViridescentHunt1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_TheViridescentHunt",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.4,.5,.6,.7,.8]}).Build()})]}),wo=p.Factory({Name:"CompoundBow",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"CompoundBow1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()})]}),Bo=p.Factory({Name:"PrototypeCrescent",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"PrototypeCrescent1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.36,.45,.54,.63,.72).Build()})]}),bo=p.Factory({Name:"Rust",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"Rust1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.4,.5,.6,.7,.8).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(-.1).Build()})]}),Ko=p.Factory({Name:"SacrificialBow",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Yo=p.Factory({Name:"TheStringless",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"TheStringless1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),Fo=p.Factory({Name:"Messenger",Type:t.weapon.BOW,Stars:3,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"Messenger1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_Messenger",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),ko=p.Factory({Name:"Slingshot",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"Slingshot1",MaxRank:5,Conditions:["FAR","NEAR"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["FAR"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.36,.42,.48,.54,.6).Next().Where({effect:{conditions:["NEAR"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(-.1).Build()})]}),Vo=p.Factory({Name:"RecurveBow",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.HP_PERCENT,Effects:[]}),xo=p.Factory({Name:"SharpshootersOath",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"SharpshootersOath1",Conditions:["WEAK_SPOT"],MaxConditions:1,MaxRank:5,OnApply:new l.Builder().Where({effect:{conditions:["WEAK_SPOT"]}}).stat.Char(t.stat.AIMED_SHOT_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),Uo=p.Factory({Name:"RavenBow",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"RavenBow1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),Wo=p.Factory({Name:"TulaytullahsRemembrance",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"TulaytullahsRemembrance1",MaxRank:5,MaxStacks:10,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.048,.06,.072,.084,.096).Stacks().Build()})]}),jo=p.Factory({Name:"ThousandFloatingDreams",Type:t.weapon.CATALYST,Stars:5,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"ThousandFloatingDreams1",MaxRank:5,OnApply(e,a,n){const s=e.GetCharacter(),r=n.Modifier(s.CreateModifier(t.stat.ELEMENTAL_MASTERY,0)),i=[n.Modifier(s.CreateModifier(s.Options.Element,0)),n.Modifier(s.CreateModifier(s.Options.Element,0)),n.Modifier(s.CreateModifier(s.Options.Element,0))];function c(){i.forEach(h=>h.SetValue(0));let _=[s];const u=e.GetParty();u&&(_=u.GetMembers().map(h=>h.GetCharacter()));let A=0,S=0;for(const h of _)if(h!==s)if(h.Options.Element===s.Options.Element)A++;else{const m=i[S++];if(!m)continue;m.SetProp(h.Options.Element),m.SetValue(z1[a.GetRank()-1])}A=Math.min(3,A),r.SetValue(j1[a.GetRank()-1]*A)}return c(),n.Observer(e.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,c)),n.Observer(a.Event.CreateObserver(l.EffectEvent.CHANGE_RANK,c)),()=>0}}),l.Factory({Name:"ThousandFloatingDreams2",MaxRank:5,ApplyOther:!0,ApplySelf:!1,StackSelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(40,42,44,46,48).Build()})]}),j1=[32,40,48,56,64],z1=[.1,.14,.18,.22,.26],zo=p.Factory({Name:"WanderingEvenstar",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"WanderingEvenstar1",StackSelf:!0,ApplyOther:!0,MaxRank:5,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.24,.3,.36,.42,.48).Map((e,a,n)=>e*n.Owner.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)*(a===n.Owner?1:.3)).Build()})]}),qo=p.Factory({Name:"KagurasVerity",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"KagurasVerity1",MaxRank:5,MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.12,.15,.18,.21,.24).Stacks().Next().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Stacks([0,0,0,.12],[0,0,0,.15],[0,0,0,.18],[0,0,0,.21],[0,0,0,.24]).Build()})]}),$o=p.Factory({Name:"EverlastingMoonglow",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"EverlastingMoonglow1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.1,.125,.15,.175,.2).Next().observe.Target(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(.01,.015,.02,.025,.03).Map((e,a)=>e*a.GetCharacter().Get(t.stat.HP)).Build()})]}),Qo=p.Factory({Name:"MemoryOfDust",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[oe("MemoryOfDust1")]}),Xo=p.Factory({Name:"LostPrayer",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"LostPrayer1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),Jo=p.Factory({Name:"SkywardAtlas",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"SkywardAtlas1",MaxRank:5,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().instance.Basic({Name:"HIT_SkywardAtlas",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.6,2,2.4,4.8,3.2]}).Build()})]}),Zo=p.Factory({Name:"FruitOfFulfillment",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"FruitOfFulfillment1",MaxRank:5,MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(24,27,30,33,36).Stacks().Next().stat.Char(t.stat.ATK_PERCENT).Values(-.05).Stacks().Build()})]}),tc=p.Factory({Name:"OathswornEye",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"OathswornEye1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.24,.3,.36,.42,.48).Build()})]}),ec=p.Factory({Name:"HakushinRing",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"HakushinRing1",ApplyOther:!0,MaxRank:5,OnApply:new l.Builder().stat.Char().MapStat(e=>[e.GetCharacter().Options.Element]).Values(.1,.125,.15,.175,.2).Build()})]}),ac=p.Factory({Name:"DodocoTales",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"DodocoTales1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_CHARGED"],MaxConditions:2,OnApply:new l.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["HIT_CHARGED"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.08,.1,.12,.14,.16).Next().Build()})]}),nc=p.Factory({Name:"Frostbearer",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[sa("Frostbearer1","HIT_Frostbearer")]}),sc=p.Factory({Name:"EyeOfPerception",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"EyeOfPerception1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_EyeOfPerception",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,2.7,3,3.3,3.6]}).Build()})]}),rc=p.Factory({Name:"BlackcliffAgate",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[Kt("BlackcliffAgate1")]}),ic=p.Factory({Name:"MappaMare",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"MappaMare1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),lc=p.Factory({Name:"PrototypeAmber",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.HP_PERCENT,Effects:[]}),oc=p.Factory({Name:"SolarPearl",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"SolarPearl1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_SKILL"],MaxConditions:2,OnApply:new l.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Next().Build()})]}),cc=p.Factory({Name:"SacrificialFragments",Type:t.weapon.CATALYST,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[]}),Ec=p.Factory({Name:"FavoniusCodex",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Tc=p.Factory({Name:"AmberBead",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"AmberBead1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),_c=p.Factory({Name:"TwinNephrite",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"TwinNephrite1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.14,.16,.18,.2).Build()})]}),uc=p.Factory({Name:"EmeraldOrb",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"EmeraldOrb1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),Ac=p.Factory({Name:"OtherworldlyStory",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Sc=p.Factory({Name:"ThrillingTalesOfDragonSlayers",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"ThrillingTalesOfDragonSlayers1",MaxRank:5,ApplySelf:!1,ApplyOther:!0,MaxTargets:1,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.24,.3,.36,.42,.48).Build()})]}),hc=p.Factory({Name:"MagicGuide",Type:t.weapon.CATALYST,Stars:3,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"MagicGuide1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),mc=p.Factory({Name:"StaffOfTheScarletSands",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"StaffOfTheScarletSands1",MaxRank:5,MaxStacks:3,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.52,.65,.78,.91,1.04).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.28,.35,.42,.49,.56).Stacks().Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Next().Build()})]}),fc=p.Factory({Name:"CalamityQueller",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_49,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"CalamityQueller1",MaxRank:5,MaxStacks:6,Conditions:["ON_FIELD","OFF_FIELD"],MaxConditions:1,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ATK_PERCENT).Values(.032,.04,.048,.056,.064).Stacks().Next().Where({effect:{conditions:["OFF_FIELD"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.032,.04,.048,.056,.064).Stacks().Next().Build()})]}),Lc=p.Factory({Name:"JadeSpear",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"JadeSpear1",MaxRank:5,MaxStacks:7,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.032,.039,.046,.053,.06).Stacks().Next().stat.Char(t.stat.ALL_DMG).Stacks([0,0,0,0,0,0,0,.12],[0,0,0,0,0,0,0,.15],[0,0,0,0,0,0,0,.18],[0,0,0,0,0,0,0,.21],[0,0,0,0,0,0,0,.24]).Build()})]}),pc=p.Factory({Name:"VortexVanquisher",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[oe("VortexVanquisher1")]}),Nc=p.Factory({Name:"SkywardSpine",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"SkywardSpine1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.08,.1,.12,.14,.16).Next().instance.Basic({Name:"HIT_SkywardSpine",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.4,.55,.7,.85,1]}).Build()})]}),dc=p.Factory({Name:"MissiveWindspear",Type:t.weapon.POLEARM,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"MissiveWindspear1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(48,60,72,84,96).Build()})]}),Cc=p.Factory({Name:"Moonpiercer",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"Moonpiercer1",ApplyOther:!0,MaxTargets:1,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()})]}),Mc=p.Factory({Name:"EngulfingLightning",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"EngulfingLightning1",MaxRank:5,Conditions:["CAST_BURST","NO_BURST"],MaxConditions:1,OnApply:new l.Builder().observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ATK_PERCENT).Values(.28,.35,.42,.49,.56).Map((e,a,n)=>q1(e,a.GetCharacter().Get(t.stat.ENERGY_RECHARGE),n.GetRank())).Next().Where({effect:{conditions:["CAST_BURST"]}}).stat.Char(t.stat.ENERGY_RECHARGE).Values(.3,.35,.4,.45,.5).Build()})]});function q1(e,a,n){return Math.min(e*Math.max(0,a-1),$1[n-1])}var $1=[.8,.9,1,1.1,1.2],gc=p.Factory({Name:"WavebreakerFin",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_45,Substat:t.stat.ATK_PERCENT,Effects:[ea("WavebreakerFin1")]}),Gc=p.Factory({Name:"KitainCrossSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"KitainCrossSpear1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.06,.075,.09,.105,.12).Build()})]}),Rc=p.Factory({Name:"DragonspineSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.PHYSICAL_DMG,Effects:[sa("DragonspineSpear1","HIT_DragonspineSpear")]}),Ic=p.Factory({Name:"LithicSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Ml("LithicSpear1")]}),Oc=p.Factory({Name:"CrescentPike",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"CrescentPike1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_CrescentPike",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.2,.25,.3,.35,.4]}).Build()})]}),Dc=p.Factory({Name:"Halberd",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"Halberd1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_Halberd",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.6,2,2.4,2.8,3.2]}).Build()})]}),vc=p.Factory({Name:"DragonsBane",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"DragonsBane1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.PYRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),yc=p.Factory({Name:"SacrificialSword",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Pc=p.Factory({Name:"ElegyForTheEnd",Type:t.weapon.BOW,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"ElegyForTheEnd1",ApplySelf:!0,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,75,90,105,120).Build()}),na({Name:"ElegyForTheEnd2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100,125,150,175,200).Next().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),Hc=p.Factory({Name:"StaffOfHoma",Type:t.weapon.POLEARM,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"StaffOfHoma1",ApplySelf:!0,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Next().observe.Target(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ATK_FLAT).Values(.008,.01,.012,.014,.016).Map((e,a)=>a.GetCharacter().Get(t.stat.HP)*e).Next().observe.Target(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ATK_FLAT).Where({target:{hp:{leq:.5}}}).Values(.01,.012,.014,.016,.018).Map((e,a)=>a.GetCharacter().Get(t.stat.HP)*e).Build()})]}),wc=p.Factory({Name:"FavoniusLance",Type:t.weapon.POLEARM,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Bc=p.Factory({Name:"WhiteTassel",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"WhiteTassel1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),bc=p.Factory({Name:"BlackTassel",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"BlackTassel1",MaxRank:5,Conditions:["NO_SLIMES","SLIMES"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["SLIMES"]}}).stat.Char(t.stat.ALL_DMG).Values(.4,.5,.6,.7,.8).Build()})]}),Kc=p.Factory({Name:"PrototypeStarglitter",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"PrototypeStarglitter1",MaxStacks:2,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.08,.1,.12,.14,.16).Stacks().Next().Build()})]}),Yc=p.Factory({Name:"BlackcliffPole",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[Kt("BlackcliffPole1")]}),Fc=p.Factory({Name:"Deathmatch",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"Deathmatch1",MaxRank:5,MaxConditions:1,Conditions:["ENEMY_1","ENEMY_2"],OnApply:new l.Builder().Where({effect:{conditions:["ENEMY_2"]}}).stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["ENEMY_1"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.24,.3,.36,.42,.48).Build()})]}),kc=p.Factory({Name:"SkywardBlade",Stars:5,Type:t.weapon.SWORD,Substat:t.stat.ENERGY_RECHARGE,Scaling:o.WeaponScaling.TYPE_46,Effects:[l.Factory({Name:"SkywardBlade1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.04,.05,.06,.07,.08).Next().instance.Basic({Name:"HIT_SkywardBlade",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.2,.25,.3,.35,.4]}).Build()})]}),Vc=p.Factory({Name:"SkywardHarp",Type:t.weapon.BOW,Stars:5,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"SkywardHarp1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.CRIT_DMG).Values(.2,.25,.3,.35,.4).Next().instance.Basic({Name:"HIT_SkywardHarp",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.25]}).Build()})]}),xc=p.Factory({Name:"FavoniusSword",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Uc=p.Factory({Name:"FavoniusWarbow",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Wc=p.Factory({Name:"TheWidsith",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"TheWidsith1",MaxRank:5,Conditions:["RECITATIVE","ARIA","INTERLUDE"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["RECITATIVE"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.6,.75,.9,1.05,1.2).Next().Where({effect:{conditions:["ARIA"]}}).stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.48,.6,.72,.84,.96).Next().Where({effect:{conditions:["INTERLUDE"]}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(240,300,360,420,480).Build()})]}),jc=Object.values(ki).sort((e,a)=>e.Type===a.Type?e.Stars===a.Stars?e.Name.localeCompare(a.Name):e.Stars-a.Stars:e.Type-a.Type),ce={};for(const e of jc)ce[e.Type]||(ce[e.Type]=[]),ce[e.Type].push(e);var ra=new Q(e=>e.Name);ra.AddList(jc);function zc(){return ra.Get()}function Q1(e){return ra.Find(e)}function X1(e){return ce[e]||[]}var Ee={};D(Ee,{FindByName:()=>Z1,GetList:()=>J1});var Nt=new Q(e=>e.Name);for(const e of Fi())e.Effects.forEach(a=>Nt.Add(a));for(const e of zc())e.Effects.forEach(a=>Nt.Add(a));for(const e of Kr())e.Piece2.forEach(a=>Nt.Add(a)),e.Piece4.forEach(a=>Nt.Add(a));for(const e of ps())Nt.Add(e);function J1(){return Nt.Get()}function Z1(e){return Nt.Find(e)}var Ft={};D(Ft,{ArtifactStore:()=>aN,CopyCharbox:()=>lN,FilterArtifacts:()=>ia,PartyFrom:()=>tN});function tN(e){const a=new G.Party;for(const n in e.characters){const s=pt.FindByName(n);if(!s)throw new Error(`Character not found: ${n}`);const r=s();a.Add(r);const i=e.characters[n],c=Object.keys(i.weapon)[0];if(c){const _=et.FindByName(c);if(!_)throw new Error(`Weapon not found: ${n}`);r.SetWeapon(_)}i.artifacts&&Object.keys(i.artifacts).length>0&&r.SetArtifacts(new Lt.Artbox(r))}return G.ImportParty(e,a),a}function ia(e,a,n){const s=a.map(r=>eN(r));return n&&s.push({filter(r){return!(n.pieces&&!n.pieces.includes(r.piece)||n.only&&n.only==="locked"!==!!r.locked)}}),tn.Filter({values:e,mode:"every",filters:s})}function eN(e){const a=e.pieces||t.piece.Values(),n=e.subsMode||"some";return{for(s){return a.includes(s.piece)},filter(s){if(e.main&&!e.main.includes(s.mainstat))return!1;if(e.subs){const r=s.substats.map(c=>c.stat);if(!e.subs[n](c=>r.includes(c)))return!1}return!(Number.isFinite(e.stars)&&s.stars<(e.stars||0)||Number.isFinite(e.level)&&s.level<(e.level||0))}}}var aN=class{constructor(e){this.onChange=e,this.list=[],this.filtered=[]}Update(){this.onChange()}All(){return this.list}Clear(){this.list.splice(0,this.list.length),this.filtered.splice(0,this.filtered.length),this.onChange()}Add(e,a="push"){const n=I.Export(e);this.list[a](n),this.filtered=[...this.list],this.onChange()}AddExported(e,a="push"){this.list[a](e),this.filtered=[...this.list],this.onChange()}Filter(e,a){const{values:n}=ia(this.list,e,a);return this.filtered=n,n}Get(){return this.filtered}Replace(e,a){const n=this.list.indexOf(e);return n===-1?!1:(this.list.splice(n,1,a),this.onChange(),!0)}RemoveMultiple(e,a){const{indexes:n}=ia(this.list,e,a),s=[];return this.list.forEach((r,i)=>{n.includes(i)||s.push(r)}),this.list=s,this.onChange(),s.length}Remove(e){const a=this.list.indexOf(e);return a===-1?!1:(this.list.splice(a,1),this.onChange(),!0)}};function nN(e,a){const n=e.GetArtifacts();let s=a.GetArtifacts();if(!n){a.SetArtifacts(void 0);return}s||(s=new Lt.Artbox(a),a.SetArtifacts(s));const r=s,i=n.GetActiveSets(),c=r.GetActiveSets(),_=(()=>{const u=new Map;return n.GetEffects().forEach(A=>{const S=A.GetTargets().map(h=>h===e?a:h);u.set(A.Options.Name,S)}),u})();r.GetArtifacts().forEach((u,A)=>{const S=n.Get(A);I.Import(I.Export(S),u)}),i.every(u=>c.includes(u))&&r.GetEffects().forEach(u=>{const A=_.get(u.Options.Name);A&&u.ApplyMultiple(A)})}var sN=[[t.stat.NORMAL_ATTACK_LEVEL,t.stat.NORMAL_ATTACK_LEVEL_UP],[t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP],[t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP]];function rN(e,a){const n=e.GetCharacter(),s=a.GetCharacter();for(const[r,i]of sN){const c=n.Get(r)-n.Get(i),_=s.Get(i);s.Set(r,c+_)}}function iN(e,a){const n=e.GetWeapon(),s=a.GetWeapon();if(!n){a.SetWeapon(void 0);return}if(!s||s.Options.Name!==n.Options.Name){const i=et.FindByName(n.Options.Name);if(!i)throw new Error(`Weapon not found: ${n.Options.Name}`);a.SetWeapon(i)}const r=a.GetWeapon();if(!r)throw new Error("Target has no weapon");p.Import(p.Export(n),r)}function lN(e,a){a.GetCharacter().SetLevel(e.GetCharacter().GetLevel()),a.GetCharacter().SetAscension(e.GetCharacter().GetAscension()),rN(e,a),iN(e,a),nN(e,a)}var la=class extends qa{constructor(e){super(e),this.functions=new Map;const a=Mt.Contexts("math","logic",{functions:{pick:{name:"pick",arguments:[{name:"index",description:"integer index of the item to pick, starting at 1"},"..."],evaluate({values:[s,...r]}){return r[s-1]}},var:{name:"var",arguments:[{name:"name",description:"name of the variable to set",expression:!0},{name:"value",description:"value to set the variable to"}],evaluate:({values:[,s],expressions:[r]})=>{const i=r.token.value;return n.setVar(i,s),s}},add:{name:"add",arguments:[{name:"variable",description:"name of the variable to add to",expression:!0},{name:"value",description:"value to add to the variable"}],evaluate:({values:[,s],expressions:[r],location:i})=>{const c=r.token.value,_=n.getVar(c);if(_===void 0)throw new Error(`Variable ${c} is not defined at ${i}`);const u=_+s;return n.setVar(c,u),u}},multiply:{name:"multiply",arguments:[{name:"variable",description:"name of the variable to multiply",expression:!0},{name:"value",description:"value to multiply the variable by"}],evaluate:({values:[,s],expressions:[r]})=>{const i=r.token.value,c=n.getVar(i);if(c===void 0)throw new Error(`Variable ${i} is not defined`);const _=c*s;return n.setVar(i,_),_}},func:{name:"func",description:"define a function. Example: function(myfunc, (arg1, arg2), (arg1 + arg2))",arguments:[{name:"name",description:"name of the function to define",expression:!0},{name:"arguments",description:"arguments to the function",expression:!0},{name:"body",description:"body of the function",expression:!0}],evaluate:({expressions:[s,r,i],location:c})=>{const _=s.token.value,u=r.children.length?r.children.map(({token:S})=>S.value):r.token.value==="0"?[]:[r.token.value],A=(()=>i.evaluate?[i.evaluate]:i.children.map(S=>S.evaluate||(()=>0)))();if(!A)throw new Error(`Function body is not an expression at ${c}`);return this.functions.set(_,{args:u,expr:A}),0}},call:{name:"call",description:"call a function. Example: call(myfunc, arg1, arg2)",arguments:[{name:"name",description:"name of the function to call",expression:!0},"..."],evaluate:({expressions:[s],values:[,...r],location:i})=>{var c;const _=s.token.value,u=this.functions.get(_);if(!u)throw new Error(`Function ${_} is not defined at ${i}`);if(r.length!==u.args.length)throw new Error(`Function ${_} expects ${u.args.length} arguments, but ${r.length} were provided at ${i}`);for(let A=0;A<r.length;A++)n.setVar(u.args[A],r[A]);return(c=u.expr.map(A=>A()).pop())!=null?c:0}}}});a.ignoreCase=!0;const n=new Mt(a);this.exprParser=n}};function B(e){if(typeof e=="number")return e;const a=e.endsWith("%");a&&(e=e.slice(0,e.length-1));let n=parseFloat(e);if(!Number.isFinite(n))throw new Error(`Invalid number format: "${e}"`);return a&&(n/=100),n}function Rd(e){return e}var oN=()=>({show:{name:"show",description:"Shows the rolls of the character artifacts",compile(e,{context:a,logger:n}){return function(){const i=a.GetChar().GetArtifacts();if(!i){n.error("Current character has no artifacts");return}n.log(`
`+i.GetArtifacts().map(c=>T.ArtifactRolls(c)).join(`
`))}}},tier:{name:"tier",arguments:"tier",description:"Sets the rolls tier to equip.`",example:"artifact rolls tier 3",docs:{tier:"a number from 0 to 4, where 0 is the lowest tier and 3 is the highest tier.Also, the number 4 or the word `avg` can be used to set the tier to the average."},compile({values:[e]},{context:a,logger:n}){let s,r;return e==="avg"?(s=4,r="AVERAGE"):(s=Math.max(0,Math.min(4,Math.floor(B(e)))),r=s+""),function(){a.Config.substats.tier=s,n.logf("Rolls tier set to %s",r)}}},equip:{name:"equip",arguments:"stat rolls more...",description:"Equips the given rolls to the artifacts.Arguments in the form `[stat] [rolls] [stat] [rolls] ...`.",example:"artifact rolls equip crit_rate 10 crit_dmg 12 elemental_mastery 3",compile({values:e},{context:a,logger:n}){const s=[];for(let r=0;r<e.length;r+=2){const i=e[r].toUpperCase(),c=t.stat.Get(i),_=t.stat.Name(c),u=e[r+1];if(!u)throw new Error("Missing # of rolls for stat "+_);const A=Math.max(0,Math.floor(B(u)));s.push([c,A])}return function(){const i=a.GetChar().GetArtifacts();if(!i)throw new Error("Current character has no artifacts");i.EquipRolls({substats:s,tier:a.Config.substats.tier})?a.Config.substats.tier===4?n.logf("Equipped rolls of tier %s","AVERAGE"):n.logf("Equipped rolls of tier %d",a.Config.substats.tier):n.error("Rolls could not be equipped")}}}}),cN=()=>({list:{name:"list",description:"Lists the registered artifact sets",compile(e,{logger:a}){const n=new T.Table(T.labels.SET,T.labels.STARS),s=tt.GetList();return s.forEach(r=>n.AddRow(r.Name,r.Stars)),function(){a.logf("Total artifact sets: %d",s.length),a.log(`
`+n.String())}}},add:{name:"add",description:"Adds a build of 5 artifacts to the current character",compile(e,{context:a,logger:n}){return function(){const r=a.GetChar();r.GetArtifacts()?n.warn("Artifacts not created. Character already has artifacts"):(r.SetArtifacts(new Lt.Artbox(r)),n.log("Artifacts created"))}}},fill:{name:"fill",description:"Adds 4 empty substats to all artifacts in the current character",compile(e,{context:a,logger:n}){return function(){const i=a.GetChar().GetArtifacts();i?(i.GetArtifacts().forEach(c=>c.FillSubstats()),n.log("All artifacts filled")):n.error("Character has no artifacts")}}},main:{name:"main",description:"Sets the mainstats of the character artifacts.",arguments:"sands goblet circlet",example:"artifact main atk_percent pyro_dmg crit_rate",compile({values:[e,a,n]},{context:s,logger:r}){const i=t.stat.Get(e.toUpperCase()),c=t.stat.Get(a.toUpperCase()),_=t.stat.Get(n.toUpperCase());return function(){const S=s.GetChar().GetArtifacts();if(!S){r.error("Current character has no artifacts");return}S.Get(2).SetMainstat(i),S.Get(3).SetMainstat(c),S.Get(4).SetMainstat(_);const h=S.GetArtifacts().map(m=>t.stat.Name(m.GetMainstat()));r.logf("Artifact mainstats set to %s",h.join(", "))}}},level:{name:"level",description:"Sets the level of all the artifacts of the current character.",example:"artifact level 20",arguments:"level",compile({values:[e]},{context:a,logger:n}){const s=B(e);return function(){const c=a.GetChar().GetArtifacts();if(!c){n.error("Current character has no artifacts");return}c.GetArtifacts().forEach(u=>u.SetLevel(s));const _=c.GetArtifacts().map(u=>u.GetLevel());n.logf("Artifact levels set to %s",_.join(", "))}}},stars:{name:"stars",description:"Sets the stars of all the artifacts of the current character.",example:"artifact stars 5",arguments:"stars",compile({values:[e]},{context:a,logger:n}){const s=B(e);return function(){const c=a.GetChar().GetArtifacts();if(!c){n.error("Current character has no artifacts");return}c.GetArtifacts().forEach(u=>u.SetStars(s));const _=c.GetArtifacts().map(u=>u.GetStars());n.logf("Artifact stars set to %s",_.join(", "))}}},remove:{name:"remove",description:"Removes all artifacts from the current character",compile(e,{context:a,logger:n}){return function(){a.GetChar().SetArtifacts(void 0),n.log("Artifacts removed")}}},show:{name:"show",description:"Shows the artifacts of the current character",compile(e,{context:a,logger:n}){return function(){const i=a.GetChar().GetArtifacts();if(!i){n.error("Current character has no artifacts");return}n.log(`
`+T.Artifact(...i.GetArtifacts()))}}},rolls:{name:"rolls",description:"Control the artifact rolls in the current character",children:oN()},sets:{name:"sets",arguments:"firstName [otherNameOrPieces]",docs:{firstName:"the name of the first set",otherNameOrPieces:"the name of the second set, or the number of pieces of the first set (2 or 4)"},description:"Changes the artifact sets. Arguments in one of the following forms:\n- `artifact sets [firstName]`: 2-piece effect of the given set\n- `artifact sets [firstName] [otherName]`: 2-piece effect of the given sets, or the 4-piece effect if they're both the same.\n- `artifact sets [firstName] [Pieces]`: the given set with 2-piece or 4-piece effects.\n\nrun without arguments to remove all the sets.",example:`artifact sets CrimsonWitchOfFlames 4 // 4-piece set
artifact sets CrimsonWitchOfFlames WanderersTroupe // 2 + 2 piece set`,compile({values:e},{context:a,logger:n}){if(e.length===0)return function(){const u=a.GetChar().GetArtifacts();if(!u)throw new Error("Current character has no artifacts");u.GetArtifacts().forEach(A=>A.SetSet(void 0)),n.log("Removed all artifact sets")};e.length===1&&e.push("2");let s,r;const i=tt.FindByName(e[0]);if(!i)throw new Error("Set "+e[0]+" not found");if(s=i.Name,e[1]==="2")r=void 0;else if(e[1]==="4")r=s;else{const c=tt.FindByName(e[1]);if(!c)throw new Error("Set "+e[1]+" not found");r=c.Name}return function(){const u=a.GetChar().GetArtifacts();if(!u)throw new Error("Current character has no artifacts");u.Get(0).SetSet(s),u.Get(1).SetSet(s),u.Get(2).SetSet(r),u.Get(3).SetSet(r),n.logf("Artifact sets set to %s",u.GetActiveSets().join(", "))}}}}),EN=()=>{const e={};return t.piece.Values().forEach(a=>{const n=t.piece.Name(a).toLowerCase();e[n]={name:n,description:"Controls the artifact "+t.piece.Name(a),children:TN(a)()}}),e},TN=e=>()=>({main:{name:"main",description:"Sets the mainstat of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" main "+t.stat.Name(t.PieceToMainstats(e)[0]),arguments:"mainstat",compile({values:[a]},{context:n,logger:s}){const r=t.stat.Get(a.toUpperCase());return function(){const _=n.GetChar().GetArtifacts();if(!_){s.error("Current character has no artifacts");return}_.Get(e).SetMainstat(r),s.logf("%s mainstat set to %s",t.piece.Name(e),_.Get(e).GetMainstat())}}},set:{name:"set",description:"Sets the set name of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" set WanderersTroupe",arguments:"set",compile({values:[a]},{context:n,logger:s}){return function(){const c=n.GetChar().GetArtifacts();if(!c){s.error("Current character has no artifacts");return}c.Get(e).SetSet(a),s.logf("%s set changed to %s",t.piece.Name(e),c.Get(e).GetSet())}}},level:{name:"level",description:"Sets the level of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" level 16",arguments:"level",compile({values:[a]},{context:n,logger:s}){const r=B(a);return function(){const _=n.GetChar().GetArtifacts();if(!_){s.error("Current character has no artifacts");return}_.Get(e).SetLevel(r),s.logf("%s level set to %d",t.piece.Name(e),_.Get(e).GetLevel())}}},stars:{name:"stars",description:"Sets the stars of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" stars 4",arguments:"stars",compile({values:[a]},{context:n,logger:s}){const r=B(a);return function(){const _=n.GetChar().GetArtifacts();if(!_){s.error("Current character has no artifacts");return}_.Get(e).SetStars(r),s.logf("%s stars set to %d",t.piece.Name(e),_.Get(e).GetStars())}}},show:{name:"show",description:"Shows the "+t.piece.Name(e),compile(a,{context:n,logger:s}){return function(){const c=n.GetChar().GetArtifacts();if(!c){s.error("Current character has no artifacts");return}s.log(`
`+T.Artifact(c.Get(e)))}}},rolls:{name:"rolls",description:"Shows the rolls of the "+t.piece.Name(e),compile(a,{context:n,logger:s}){return function(){const c=n.GetChar().GetArtifacts();if(!c){s.error("Current character has no artifacts");return}const _=c.Get(e);s.log(T.ArtifactRolls(_))}}},sub:{name:"sub",description:"Control the substats of the "+t.piece.Name(e),children:{clear:{name:"clear",description:"Set all substats to 0",compile(a,{context:n,logger:s}){return function(){const c=n.GetChar().GetArtifacts();if(!c){s.error("Current character has no artifacts");return}c.Get(e).ClearSubstats(),s.log("Substats cleared")}}},add:{name:"add",description:"Adds a new substat to the artifact.",example:t.piece.Name(e).toLowerCase()+" sub add crit_rate 7.8%",arguments:"stat value",compile({values:[a,n]},{context:s,logger:r}){const i=t.stat.Get(a.toUpperCase()),c=B(n);return function(){const A=s.GetChar().GetArtifacts();if(!A){r.error("Current character has no artifacts");return}A.Get(e).AddSubstat(i,c)?r.log("Substat added"):r.warn("Substat not added")}}},set:{name:"set",description:"Changes a substat. Substat index starts from zero.",example:t.piece.Name(e).toLowerCase()+" sub set 2 crit_rate 7.8%",arguments:"index stat value",compile({values:[a,n,s]},{context:r,logger:i}){const c=B(a),_=t.stat.Get(n.toUpperCase()),u=B(s);return function(){const h=r.GetChar().GetArtifacts();if(!h){i.error("Current character has no artifacts");return}const m=h.Get(e);if(c>=m.SubstatsLength()){i.errorf("Substat index out of range [0-%d]",m.SubstatsLength()-1);return}m.SetSubstat(c,_),m.SetSubstatValue(c,u),i.logf("Substat %d changed",c)}}}}},downgrade:{name:"downgrade",description:"Converts a 5-star artifact to a 4-star artifact, reducing the value of substats.",compile(a,{context:n,logger:s}){return function(){const c=n.GetChar().GetArtifacts();if(!c){s.error("Current character has no artifacts");return}const _=c.Get(e);I.transform.Downgrade(_),s.log("Artifact downgraded")}}}}),_N=()=>({list:{name:"list",description:"Lists the stats of the current character",compile(e,{context:a,logger:n}){return function(){const r=a.GetChar().GetCharacter(),i=new T.Table(T.labels.STAT,T.labels.VALUE);i.DecimalPlaces=4;for(const c of t.stat.Values())i.AddRow(t.stat.Name(c),r.Get(c));n.log(`
`+i.String())}}},get:{name:"get",description:"Gets the value of stats in the current character",example:"character stat get crit_rate crit_dmg",arguments:"stats...",compile({values:e},{context:a,logger:n}){const s=e.map(r=>t.stat.Get(r.toUpperCase()));return function(){const i=a.GetChar().GetCharacter(),c=new T.Table(T.labels.STAT,T.labels.VALUE);c.DecimalPlaces=4;for(const _ of s)c.AddRow(t.stat.Name(_),i.Get(_));n.log(`
`+c.String())}}},set:{name:"set",description:"Sets the value of a stat in the current character",example:"character stat set atk_percent 45%",arguments:"stat value",compile({values:[e],get:a},{context:n,logger:s}){const r=t.stat.Get(e.toUpperCase());return function(){const c=a.number(1),u=n.GetChar().SetStat(r,c);s.logf("Character stat %s set to %.4f",t.stat.Name(r),u)}}},add:{name:"add",description:"Adds to the value of a stat in the current character",example:"character stat add atk_percent 10%",arguments:"stat value",compile({values:[e],get:a},{context:n,logger:s}){const r=t.stat.Get(e.toUpperCase());return function(){const c=a.number(1),u=n.GetChar().AddStat(r,c);s.logf("Modified %s + %.4f = %.4f",t.stat.Name(r),c,u)}}},mods:{name:"mods",description:"Lists the stats added to the character with `stat add [...]`",compile(e,{context:a,logger:n}){return function(){const r=a.GetChar(),i=new T.Table(T.labels.STAT,T.labels.VALUE);i.DecimalPlaces=4,r.GetModifiers().forEach(c=>i.AddRow(t.stat.Name(c.GetProp()),c.GetValue())),n.log(`
`+i.String())}}},clear:{name:"clear",description:"Removes the stat modifiers created by `stat add [...]`",compile(e,{context:a,logger:n}){return function(){a.GetChar().ClearModifiers(),n.log("Cleared modifiers")}}}}),uN=()=>({add:{name:"add",description:"Adds a new character.",example:"character add hutao",arguments:"name",compile({values:[e]},{context:a,logger:n}){const s=pt.FindByName(e);if(!s)throw new Error("Character not found: "+e);return function(){if(a.Party.FindMember(e)){n.errorf("Cannot add character %s because it is already added",s.Name);return}const c=s();a.Party.Add(c),n.logf("Character %s added to the party",c.GetCharacter().Options.Name),a.GetCompiler().compileString(`character set ${s.Name}`,{line:n.line})()}}},remove:{name:"remove",description:"Removes a character from the party",example:"character remove Hutao",arguments:"name",compile({values:[e]},{context:a,logger:n}){return function(){const r=a.Party.FindMember(e);if(!r){n.errorf("Cannot remove character %s because it is not added",e);return}a.Party.Remove(r)?(r.GetEffects().forEach(i=>i.Disable().UnapplyAll()),a.GetChar()===r&&a.GetCompiler().compileString("character unset",{line:n.line})(),n.logf("Character %s removed",r.GetCharacter().Options.Name)):n.errorf("Cannot remove character %s",r.GetCharacter().Options.Name)}}},set:{name:"set",description:"Sets the current character",example:"character set Hutao",arguments:"name",compile({values:[e]},{context:a,logger:n}){return function(){const r=a.Party.FindMember(e);if(!r){n.errorf("Cannot set character %s because it is not added",e);return}a.SetChar(r),n.logf("Character %s set as current",r.GetCharacter().Options.Name)}}},unset:{name:"unset",description:"Unsets the current character",compile(e,{context:a,logger:n}){return function(){a.SetChar(void 0),n.log("Character unset. There is no current character selected")}}},level:{name:"level",description:"Sets the level of the current character",example:`character level 70
character level 80+ // level 80 ascended`,arguments:"level",compile({values:[e]},{context:a,logger:n}){let s=e;const r=e.endsWith("+");r&&(s=e.slice(0,s.length-1));const i=B(s),c=r?6:0;return function(){const u=a.GetChar().GetCharacter();u.SetLevel(i),u.SetAscension(c),n.logf("Character level set to %d%s",u.GetLevel(),u.IsAscended()?"+":"")}}},talent:{name:"talent",description:"Sets the talent levels of the current character",example:"character talent 9 5 7",arguments:"normal skill burst",compile({values:e},{context:a,logger:n}){const[s,r,i]=e.map(c=>B(c));return function(){const _=a.GetChar().GetCharacter();_.Set(t.stat.NORMAL_ATTACK_LEVEL,s),_.Set(t.stat.ELEMENTAL_SKILL_LEVEL,r),_.Set(t.stat.ELEMENTAL_BURST_LEVEL,i),n.logf("Character Normal Attack level set to %d",s),n.logf("Character Elemental Skill level set to %d",r),n.logf("Character Elemental Burst level set to %d",i)}}},list:{name:"list",description:"Lists all the registered characters",compile(e,{logger:a}){const n=new T.Table(T.labels.CHARACTER,T.labels.ELEMENT,T.labels.WEAPON,T.labels.STARS,T.labels.REGION),s=pt.GetList();s.forEach(i=>n.AddRow(i.Name,t.stat.Name(i.Element),t.weapon.Name(i.Weapon),i.Stars,t.region.Name(i.Region)));const r=n.String();return function(){a.logf("Total characters: %d",s.length),a.log(`
`+r)}}},show:{name:"show",description:"Shows the characters in the party",compile(e,{context:a,logger:n}){return function(){n.log(`
`+T.Character(...a.Party.GetMembers()))}}},damage:{name:"damage",description:"Shows the current character's damage instances",compile(e,{context:a,logger:n}){return function(){const r=a.GetChar();n.log(`
`+T.Instance(...r.GetInstances()))}}},stat:{name:"stat",description:"Controls character stats directly",children:_N()}});function W(e,a){return e.split(";").map(n=>n.split(",").map(r=>AN(r)).flat().map(a))}function AN(e){const a=e.split(":");if(a.length===1)return[e];if(a.length===2){const[n,s]=a.map(r=>{const i=parseInt(r);if(!Number.isFinite(i))throw new Error("Invalid range");return i});return Array.from({length:s-n+1},(r,i)=>i+n+"")}else if(a.length===3){const[n,s,r]=a.map(i=>{const c=parseInt(i);if(!Number.isFinite(c))throw new Error("Invalid range");return c});return Array.from({length:Math.floor((s-n)/r)+1},(i,c)=>c*r+n+"")}else throw new Error("Invalid range")}var SN=()=>({config:{name:"config",description:"shortcut for all effect configurations (stacks, condition, aura, etc.) in one command",arguments:"owner effect [enable=1|0] [stacks=] [condition=] [aura=] [target=] [target_add=] [lock=]",docs:{owner:"the owner of the effect",effect:"the effect name",enable:"enable (1) or disable (0) the effect. If not provided, the effect will not be changed",stacks:"the effect stacks. If not provided, the effect will not be changed",condition:"the effect condition or conditions, separated by commas. If not provided, the effect will not be changed",aura:"the effect aura or auras, separated by commas. If not provided, the effect will not be changed",target:"the effect target or targets, separated by commas. Also accepts `all`. If not provided, the effect will not be changed",target_add:"Similar to `target`, but adds the targets instead of replacing them",lock:"If provided, the effect will be locked to prevent being modified by character stat changes. Read more about this in the `effect lock` command."},example:"effect config Yelan YelanQ stacks=9 target=Hutao",compile({values:[e,a],named:n,get:s},{context:r,logger:i}){return function(){const _=r.Party.FindMember(e);if(!_){i.errorf("Cannot find owner %s",e);return}const u=_.FindEffect(a);if(!u){i.errorf("Cannot find effect %s",a);return}const A=u.Options.Name;if(n.enable!==void 0&&(n.enable==="1"?(u.Enable(),i.logf("Effect %s enabled",A)):(u.Disable(),i.logf("Effect %s disabled",A))),n.stacks!==void 0){const S=s.number("stacks");u.SetStacks(S),i.logf("Effect %s stacks set to %d",A,u.GetStacks())}if(n.condition!==void 0){const S=W(n.condition,m=>m)[0];u.SetConditions(...S);const h=u.GetConditions();i.logf("Effect %s conditions set to ["+"%s".repeat(h.length)+"]",A,...h)}if(n.aura!==void 0){const S=W(n.aura,f=>f)[0],h=S.length>0&&S[0].match(/all/i)?t.aura.Values().filter(f=>f!==t.aura.NONE):S.map(f=>t.aura.Get(f.toUpperCase()));u.SetAuras(...h);const m=u.GetAuras().map(f=>t.aura.Name(f));i.logf("Effect %s auras set to ["+"%s".repeat(m.length)+"]",A,...m)}if(n.target!==void 0){const S=W(n.target,h=>h)[0];if(S[0]==="all"){for(const h of r.Party.GetMembers())u.Apply(h);i.logf("Effect %s applied to all members",A);return}u.UnapplyAll();for(const h of S){const m=r.Party.FindMember(h);if(!m){i.errorf("Cannot find target %s",h);return}u.Apply(m)?i.logf("Effect %s applied to target %s",A,m.GetCharacter().Options.Name):i.warnf("Effect %s NOT applied to target %s",A,m.GetCharacter().Options.Name)}}if(n.target_add!==void 0){const S=W(n.target_add,h=>h)[0];if(S[0]==="all"){for(const h of r.Party.GetMembers())u.Apply(h);i.logf("Effect %s applied to all members",A);return}for(const h of S){const m=r.Party.FindMember(h);if(!m){i.errorf("Cannot find target %s",h);return}u.Apply(m)?i.logf("Effect %s applied to target %s",A,m.GetCharacter().Options.Name):i.warnf("Effect %s NOT applied to target %s",A,m.GetCharacter().Options.Name)}}if(n.lock!==void 0){const S=W(n.lock,h=>h)[0];if(S[0]==="all"){for(const h of r.Party.GetMembers())u.Lock(h);i.logf("Effect %s locked for all members",A);return}for(const h of S){const m=r.Party.FindMember(h);if(!m){i.errorf("Cannot find target %s",h);return}u.Lock(m),i.logf("Effect %s locked for target %s",A,m.GetCharacter().Options.Name)}}}}},all:{name:"all",description:"List all effects in the party",compile(e,{context:a,logger:n}){return function(){n.log(`
`+T.Effect(...a.Party.GetAllEffects()))}}},list:{name:"list",description:"Lists the effects of the current character",compile(e,{context:a,logger:n}){return function(){const i=[...a.GetChar().GetEffects(),...a.Party.GetResonances()];n.log(`
`+T.Effect(...i))}}},applied:{name:"applied",description:"Lists all the effects in the party that are applied to the current character.",compile(e,{context:a,logger:n}){return function(){const r=a.GetChar(),i=a.Party.GetAppliedEffects(r);n.log(`
`+T.Effect(...i))}}},set:{name:"set",description:"Sets the current effect",example:"effect set RaidenE",arguments:"name",compile({values:[e]},{context:a,logger:n}){return function(){let i=a.GetChar().FindEffect(e);if(i||(i=a.Party.GetResonances().find(c=>c.Options.Name.toLowerCase()===e.toLowerCase())),!i){n.errorf("Cannot find effect %s",e);return}a.SetEffect(i),n.logf("Effect set to %s",i.Options.Name)}}},unset:{name:"unset",description:"Unsets the current effect",compile(e,{context:a,logger:n}){return function(){a.SetEffect(void 0),n.log("Current effect unset")}}},show:{name:"show",description:"Shows details about the current effect",compile(e,{context:a,logger:n}){return function(){const r=a.GetEffect();n.log(`
`+T.EffectDetail(r))}}},enable:{name:"enable",description:"Enables the current effect",compile(e,{context:a,logger:n}){return function(){const r=a.GetEffect();r.Enable(),n.logf("Effect %s enabled",r.Options.Name)}}},disable:{name:"disable",description:"Disables the current effect",compile(e,{context:a,logger:n}){return function(){const r=a.GetEffect();r.Disable(),n.logf("Effect %s disabled",r.Options.Name)}}},apply:{name:"apply",arguments:"characters...",description:"Applies the current effect to the given characters, or all",example:`effect apply HuTao
effect apply HuTao Xingqiu
effect apply all`,compile({values:e},{context:a,logger:n}){return function(){const r=a.GetEffect();if(e[0]==="all"){for(const i of a.Party.GetMembers())r.Apply(i);n.logf("Effect %s applied to all members",r.Options.Name);return}for(const i of e){const c=a.Party.FindMember(i);if(!c){n.errorf("Cannot find target %s",i);return}r.Apply(c)?n.logf("Effect %s applied to target %s",r.Options.Name,c.GetCharacter().Options.Name):n.warnf("Effect %s NOT applied to target %s",r.Options.Name,c.GetCharacter().Options.Name)}}}},unapply:{name:"unapply",arguments:"characters...",description:"Unapplies the current effect from the given characters, or all",example:`effect apply HuTao
effect unapply HuTao Xingqiu
effect unapply all`,compile({values:e},{context:a,logger:n}){return function(){const r=a.GetEffect();if(e[0]==="all"){for(const i of a.Party.GetMembers())r.Unapply(i);n.logf("Effect %s unapplied from all members",r.Options.Name);return}for(const i of e){const c=a.Party.FindMember(i);if(!c){n.errorf("Cannot find target %s",i);return}r.Unapply(c)?n.logf("Effect %s unapplied from target %s",r.Options.Name,c.GetCharacter().Options.Name):n.warnf("Effect %s NOT unapplied from target %s",r.Options.Name,c.GetCharacter().Options.Name)}}}},lock:{name:"lock",arguments:"characters",description:`Locks the effect to prevent being modified by character stat changes.

This will disable all the effect observers for the provided character.

Note that enabling the effect again will re-activate all the observers again.`,example:`effect set HuTaoE
effect enable
effect lock HuTao
character level 1
// this code will lock the HP to ATK conversion of Hu Tao to prevent it from changing`,compile({values:[e]},{context:a,logger:n}){return function(){const r=a.GetEffect(),i=a.Party.FindMember(e);if(!i){n.errorf("Cannot find character %s in the party",e);return}r.Lock(i),n.logf("Effect %s locked for character %s. Note that enabling the effect again will re-activate all the observers again.",r.Options.Name,i.GetCharacter().Options.Name)}}},stacks:{name:"stacks",description:"Sets the current effect's stacks",example:"effect stacks 9",arguments:"stacks",compile({get:e},{context:a,logger:n}){return function(){const r=e.number(0),i=a.GetEffect();i.SetStacks(r),n.logf("Effect stacks set to %f",i.GetStacks())}}},condition:{name:"condition",arguments:"conditions...",description:"Sets the current effect's condition (s)",example:`effect condition near
effect condition far
effect condition // this removes all conditions`,compile({values:e},{context:a,logger:n}){return function(){const r=a.GetEffect();r.SetConditions(...e);const i=r.GetConditions();n.logf("Effect conditions set to ["+"%s".repeat(i.length)+"]",...i)}}},aura:{name:"aura",arguments:"auras...",description:"Sets the current effect's applied aura (s), or all",example:`effect aura frozen
effect aura hydro electro
effect aura // this removes all auras
effect aura all // this applies all auras`,compile({values:e},{context:a,logger:n}){return function(){const r=a.GetEffect(),i=e.length>0&&e[0].match(/all/i)?t.aura.Values().filter(_=>_!==t.aura.NONE):e.map(_=>t.aura.Get(_.toUpperCase()));r.SetAuras(...i);const c=r.GetAuras().map(_=>t.aura.Name(_));n.logf("Effect auras set to ["+"%s".repeat(c.length)+"]",...c)}}},details:{name:"details",description:"Shows the registered modifiers of the current effect",compile(e,{context:a,logger:n}){return function(){const r=a.GetEffect();n.log(`
`+r.Register())}}}}),hN=()=>({show:{name:"show",description:"Shows all the enemies",compile(e,{context:a,logger:n}){return function(){const i=a.Party.GetMembers().map(c=>c.GetCharacter().GetEnemy());n.logf(`
`+T.Enemy(...i))}}},level:{name:"level",description:"Sets the level of all enemies",example:"enemy level 100",arguments:"level",compile({values:[e]},{context:a,logger:n}){const s=B(e);return function(){a.Party.GetMembers().forEach(i=>i.GetCharacter().GetEnemy().SetLevel(s)),n.logf("All enemy levels changed to %d",s)}}},aura:{name:"aura",arguments:"auras...",description:"Sets enemies applied aura (s), or all",example:`enemy aura frozen
enemy aura hydro electro
enemy aura // this removes all auras
enemy aura all // this applies all auras`,compile({values:e},{context:a,logger:n}){const s=e.length>0&&e[0].match(/all/i)?t.aura.Values().filter(r=>r!==t.aura.NONE):e.map(r=>t.aura.Get(r.toUpperCase()));return function(){a.Party.GetMembers().forEach(i=>i.GetCharacter().GetEnemy().SetAuras(...s)),n.logf("All enemy auras changed to %s",s.map(i=>t.aura.Name(i)).join(", "))}}}}),mN="https://enka.network";function qc(e){return gt(this,null,function*(){try{return yield(yield fetch($c(e))).json()}catch(a){console.error("[ENKA ERROR]",a)}})}function $c(e){return mN+"/api/uid/"+e}var Qc={};D(Qc,{ReadOnly:()=>O_});var Xc=(e=>(e[e.Ascension=1002]="Ascension",e[e.Level=4001]="Level",e))(Xc||{}),Jc={EQUIP_BRACER:t.piece.FLOWER,EQUIP_NECKLACE:t.piece.PLUME,EQUIP_SHOES:t.piece.SANDS,EQUIP_RING:t.piece.GOBLET,EQUIP_DRESS:t.piece.CIRCLET},Zc={20848859:"BlackcliffSlasher",37147251:"SolarPearl",160493219:"DarkIronSword",197755235:"VortexVanquisher",231836963:"JadeCutter",310247243:"KagurasVerity",313300315:"SapwoodBlade",342097547:"CinnabarSpindle",346510395:"LuxuriousSeaLord",411685275:"CompoundBow",452357939:"Moonpiercer",479076483:"CoolSteel",481755219:"BlackcliffPole",540938627:"Predator",578575283:"CrescentPike",618786571:"Halberd",623534363:"FavoniusCodex",650049651:"WindblumeOde",656120259:"SharpshootersOath",680510411:"Whiteblind",688991243:"CalamityQueller",693354267:"MemoryOfDust",716252627:"LithicSpear",735056795:"FavoniusGreatsword",807607555:"SkywardAtlas",828711395:"AmosBow",850802171:"WhiteIronGreatsword",877751435:"RoyalGreatsword",902184579:"ForestRegalia",902264035:"AquilaFavonia",930640955:"TheBell",944332883:"SummitShaper",1012170803:"KagotsurubeIsshin",1021898539:"Slingshot",1072884907:"MappaMare",1075647299:"SongOfBrokenPines",1089950259:"SkywardPride",1154009435:"PrototypeStarglitter",1163263227:"TheWidsith",1148024603:"TheCatch",1240067179:"FavoniusWarbow",1321135667:"LionsRoar",1348687251:"HuntersPath",1388004931:"SkyriderSword",1390797107:"WhiteTassel",1406746947:"OtherworldlyStory",1437658243:"SerpentSpine",1455107995:"LostPrayer",1470442731:"MissiveWindspear",1479961579:"FerrousShadow",1600275315:"HaranGeppakuFutsu",1608953539:"HarbingerOfDawn",1675686363:"SacrificialGreatsword",1773425155:"SwordOfDescension",1860795787:"MouunsMoon",1890163363:"EverlastingMoonglow",1901973075:"PolarStar",1990641987:"SacrificialSword",1990820123:"AmenomaKageuchi",1991707099:"PrototypeRancour",1997709467:"JadeSpear",2006422931:"LithicBlade",2195665683:"SacrificialFragments",2267978875:"FruitOfFulfillment",2279290283:"MagicGuide",2324146259:"HakushinRing",2359799475:"Akuoumaru",2375993851:"RoyalLongsword",2400012995:"SacrificialBow",2417717595:"AlleyHunter",2425414923:"FadingTwilight",2474354867:"FavoniusSword",2491797315:"KitainCrossSpear",2521338131:"PrototypeAmber",2539208459:"OathswornEye",2556914683:"TheStringless",2587614459:"Frostbearer",2614170427:"SkyriderGreatsword",2664629131:"DragonsBane",2749853923:"FesteringDesire",2753539619:"SnowTombedStarsilver",2792766467:"TheUnforged",2832648187:"RoyalBow",2918525947:"ThunderingPulse",2935286715:"RoyalSpear",2947140987:"TheAlleyFlash",2949448555:"FreedomSworn",2963220587:"EmeraldOrb",3063191787:"EndOfTheLine",3073454867:"MakhairaAquamarine",3090373787:"WineAndSong",3097441915:"DebateClub",3112679155:"ElegyForTheEnd",3156385731:"EyeOfPerception",3169209451:"Rust",3176599083:"KingsSquire",3235324891:"StaffOfHoma",3273999011:"BlackcliffAgate",3378007475:"BlackcliffLongsword",3421967235:"FilletBlade",3439749859:"TheViridescentHunt",3443142923:"DragonspineSpear",3447737235:"BlackcliffWarbow",3456986819:"DodocoTales",3500935003:"ThrillingTalesOfDragonSlayers",3587621259:"TheFlute",3625393819:"PrototypeCrescent",3673792067:"TravelersHandySword",3684723963:"Rainslasher",3717849275:"EngulfingLightning",3719372715:"TwinNephrite",3722933411:"PrototypeArchaic",3755004051:"FavoniusLance",3796905611:"TheBlackSword",3827789435:"RoyalGrimoire",3914951691:"RedhornStonethresher",3933622347:"SkywardHarp",3949653579:"MitternachtsWaltz",3975746731:"RavenBow",3995710363:"WolfsGravestone",4049410651:"Deathmatch",4055003299:"SkywardBlade",4090429643:"BloodtaintedGreatsword",4103022435:"IronSting",4103766499:"BlackTassel",4122509083:"WavebreakerFin",4124851547:"MistsplitterReforged",4158505619:"SkywardSpine",4186179883:"Hamayumi",4193089947:"KatsuragikiriNagamasa",4230231107:"AquaSimulacra",4238339131:"StaffOfTheScarletSands",4267718859:"RecurveBow",302691299:"AmberBead",2834063555:"BeaconOfTheReedSea",316078811:"IbisPiercer",4007372867:"JadefallSplendor",454086795:"KeyOfKhajNisut",275622963:"LightOfFoliarIncision",1200948859:"MailedFlower",4139294531:"Messenger",1201790667:"ThousandFloatingDreams",2448629019:"ToukabouShigure",359484419:"TulaytullahsRemembrance",426363739:"WanderingEvenstar",143051931:"XiphosMoonlight",449192923:"BalladOfTheFjords",800766043:"FinaleOfTheDeep",1921306659:"FleuveCendreFerryman",2432865507:"FlowingPurity",4158971171:"RightfulReward",2275710883:"SacrificialJade",2958179435:"ScionOfTheBlazingSun",2600875323:"SongOfStillness",3459616011:"TalkingStick",2988480723:"TheFirstGreatMagic",2077869763:"TidalShadow",2265792579:"WolfFang",4176923379:"TomeOfTheEternalFlow",1473399443:"SplendorOfTranquilWaters",933442195:"UltimateOverlordsMegaMagicSword",3812523339:"Verdict"},tE={83115355:"MaidenBeloved",147298547:"WanderersTroupe",156294403:"HeartOfDepth",855894507:"Berserker",862591315:"PaleFlame",933076627:"BlizzardStrayer",1186209435:"Gambler",1212345779:"GladiatorsFinale",1337666507:"TenacityOfTheMillelith",1438974835:"RetracingBolide",1524173875:"CrimsonWitchOfFlames",1541919827:"BloodstainedChivalry",1558036915:"VermillionHereafter",1562601179:"ViridescentVenerer",1632377563:"Lavawalker",1675079283:"DeepwoodMemories",1751039235:"NoblesseOblige",1756609915:"OceanHuedClam",1873342283:"Thundersoother",2040573235:"ArchaicPetra",2276480763:"EmblemOfSeveredFate",2364208851:"ResolutionOfSojourner",2512309395:"ThunderingFury",2546254811:"HuskOfOpulentDreams",2764598579:"TheExile",2890909531:"MartialArtist",3535784755:"BraveHeart",3618167299:"Scholar",3626268211:"EchoesOfAnOffering",3890292467:"Instructor",4082302819:"DefendersWill",4144069251:"ShimenawasReminiscence",4145306051:"GildedDreams",3094139291:"FlowerOfParadiseLost",2538235187:"DesertPavilionChronicle",1925210475:"NymphsDream",235897163:"VourukashasGlow",3410220315:"GoldenTroupe",1249831867:"MarechausseeHunter",2803305851:"SongOfDaysPast",279470883:"NighttimeWhispersInTheEchoingWoods"},oa={FIGHT_PROP_BASE_ATTACK:t.stat.ATK_BASE,FIGHT_PROP_HP:t.stat.HP_FLAT,FIGHT_PROP_ATTACK:t.stat.ATK_FLAT,FIGHT_PROP_DEFENSE:t.stat.DEF_FLAT,FIGHT_PROP_HP_PERCENT:t.stat.HP_PERCENT,FIGHT_PROP_ATTACK_PERCENT:t.stat.ATK_PERCENT,FIGHT_PROP_DEFENSE_PERCENT:t.stat.DEF_PERCENT,FIGHT_PROP_CRITICAL:t.stat.CRIT_RATE,FIGHT_PROP_CRITICAL_HURT:t.stat.CRIT_DMG,FIGHT_PROP_CHARGE_EFFICIENCY:t.stat.ENERGY_RECHARGE,FIGHT_PROP_HEAL_ADD:t.stat.HEALING_BONUS,FIGHT_PROP_ELEMENT_MASTERY:t.stat.ELEMENTAL_MASTERY,FIGHT_PROP_PHYSICAL_ADD_HURT:t.stat.PHYSICAL_DMG,FIGHT_PROP_FIRE_ADD_HURT:t.stat.PYRO_DMG,FIGHT_PROP_ELEC_ADD_HURT:t.stat.ELECTRO_DMG,FIGHT_PROP_WATER_ADD_HURT:t.stat.HYDRO_DMG,FIGHT_PROP_WIND_ADD_HURT:t.stat.ANEMO_DMG,FIGHT_PROP_ICE_ADD_HURT:t.stat.CRYO_DMG,FIGHT_PROP_ROCK_ADD_HURT:t.stat.GEO_DMG,FIGHT_PROP_GRASS_ADD_HURT:t.stat.DENDRO_DMG},eE={10000002:"Ayaka",10000003:"Jean",10000006:"Lisa",10000014:"Barbara",10000015:"Kaeya",10000016:"Diluc",10000020:"Razor",10000021:"Amber",10000022:"Venti",10000023:"Xiangling",10000024:"Beidou",10000025:"Xingqiu",10000026:"Xiao",10000027:"Ningguang",10000029:"Klee",10000030:"Zhongli",10000031:"Fischl",10000032:"Bennett",10000033:"Tartaglia",10000034:"Noelle",10000035:"Qiqi",10000036:"Chongyun",10000037:"Ganyu",10000038:"Albedo",10000039:"Diona",10000041:"Mona",10000042:"Keqing",10000043:"Sucrose",10000044:"Xinyan",10000045:"Rosaria",10000046:"HuTao",10000047:"Kazuha",10000048:"Yanfei",10000049:"Yoimiya",10000050:"Thoma",10000051:"Eula",10000052:"Raiden",10000053:"Sayu",10000054:"Kokomi",10000055:"Gorou",10000056:"Sara",10000057:"Itto",10000058:"Yae",10000059:"Heizou",10000060:"Yelan",10000062:"Aloy",10000063:"Shenhe",10000064:"Yunjin",10000065:"Kuki",10000066:"Ayato",10000067:"Collei",10000068:"Dori",10000069:"Tighnari",10000070:"Nilou",10000071:"Cyno",10000079:"Dehya",10000072:"Candace",10000073:"Nahida",10000074:"Layla",10000075:"Wanderer",10000076:"Faruzan",10000078:"Alhaitham",10000080:"Mika",10000087:"Neuvillette",10000089:"Furina",10000091:"Navia",10000090:"Chevreuse"};function aE(e){const a=[];for(const n of e.avatarInfoList){const s=eE[n.avatarId];if(!s){console.error(`[ENKA ERROR] Cannot find character by avatarId ${n.avatarId}`);continue}const r=pt.FindByName(s);if(!r){console.error(`[ENKA ERROR] Cannot find character by name ${s}`);continue}const i=parseInt(n.propMap[4001].val)||1,c=parseInt(n.propMap[1002].val)||1,_=Object.values(n.skillLevelMap),u=r(),A=new Lt.Artbox(u);u.SetArtifacts(A);const S=u.GetCharacter();S.SetLevel(i),S.SetAscension(c),S.Set(t.stat.NORMAL_ATTACK_LEVEL,_[0]),S.Set(t.stat.ELEMENTAL_SKILL_LEVEL,_[1]),S.Set(t.stat.ELEMENTAL_BURST_LEVEL,_[2]);const h=n.equipList.filter(f=>f.flat.itemType==="ITEM_RELIQUARY"),m=n.equipList.filter(f=>f.flat.itemType==="ITEM_WEAPON");for(const f of h){const{reliquary:N,flat:L}=f;if(!N)continue;const{level:C}=N;if(!L.equipType){console.error("Cannot get artifact piece");continue}const d=Jc[L.equipType];if(L.rankLevel<4){console.error("[ENKA ERROR] Cannot set 3-star artifacts");continue}const M=A.Get(d);if(M.SetStars(L.rankLevel),M.SetLevel(C-1),!L.reliquaryMainstat){console.error("[ENKA ERROR] Cannot get artifact mainstat");continue}M.SetMainstat(oa[L.reliquaryMainstat.mainPropId]);const R=L.reliquarySubstats;if(!R){console.error("[ENKA ERROR] Cannot get artifact substats");continue}for(const y of R){const H=oa[y.appendPropId];let w=y.statValue;t.FlatStats.includes(H)||(w/=100),M.AddSubstat(H,w)}const O=f.flat.setNameTextMapHash;if(O){const y=parseInt(O),H=tE[y];M.SetSet(H)}}A.GetArtifacts().forEach(f=>f.FillSubstats());for(const f of m){const N=parseInt(f.flat.nameTextMapHash),L=Zc[N];if(!L){console.error("[ENKA ERROR] Cannot find weapon by key "+f.flat.nameTextMapHash);continue}const C=et.FindByName(L);if(!C){console.error("[ENKA ERROR] Cannot find weapon by name "+L);continue}u.SetWeapon(C);const d=u.GetWeapon();if(!d){console.error("[ENKA ERROR] Cannot equip weapon by name "+C.Name);continue}if(!f.weapon)continue;const{level:M,promoteLevel:R,affixMap:O}=f.weapon;d.SetLevel(M),d.SetAscension(R);const y=Object.values(O).reduce((H,w)=>Math.max(H,w),0)+1;d.SetRank(y)}a.push(u)}return a}function nE(e){return gt(this,null,function*(){const a=yield qc(e);if(!a)throw new Error("[ENKA ERROR] Cannot fetch data from Enka.Network");return aE(a)})}var fN=()=>{let e=[];return{uid:{name:"uid",description:"Imports characters from a player UID using Enka.Network service",example:"enka uid 609609619",arguments:"UID",compile({values:[a]},{logger:n}){return function(){n.log("Importing from Enka.Network service. Please wait..."),nE(a).then(r=>{e=r;const i=new T.Table(T.labels.CHARACTER,T.labels.LEVEL);for(const c of e){const _=c.GetCharacter();i.AddRow(_.Options.Name,_.GetLevel())}n.log(`
Imported characters:
`+i.String()),n.logf("Imported %d characters from Enka.Network",r.length),n.log("Run `enka load <characters...>` to load an imported character to the current party")}).catch(r=>n.error(String(r).valueOf()))}}},load:{name:"load",arguments:"characters...",description:"Loads characters imported from Enka.Network to the current party",example:"enka load hutao xingqiu yelan zhongli",compile({values:a},{context:n,logger:s}){return function(){const i=[];for(const c of a){const _=e.find(u=>u.GetCharacter().Options.Name.toLowerCase()===c);if(!_){s.errorf('Character "%s" not found in Enka',c);continue}n.Party.Add(_),i.push(_)}s.logf("Added %d characters to the party",i.length),i.length>0&&n.GetCompiler().compileString("character set "+i[0].GetCharacter().Options.Name,{line:s.line})()}}}}},LN=()=>({list:{name:"list",description:"Lists all the registered foods",compile(e,{logger:a}){const n=bt.GetList(),s=T.Food(...n);return function(){a.log(`
`+s)}}},add:{name:"add",arguments:"name rank",description:"Adds a food to the party. Rank is the food quality (1 = suspicious, 2 = normal, 3 = delicious)",example:"food add adeptustemptation 3",compile({values:[e,a]},{context:n,logger:s}){const r=bt.FindByName(e),i=Math.floor(B(a));if(!r)throw new Error("Cannot find food: "+e);return function(){n.Party.GetFoods().Add(r).SetRank(i),s.logf("Food %s added",r.Name)}}},remove:{name:"remove",description:"Removes a food from the party",arguments:"name",example:"food remove adeptustemptation",compile({values:[e]},{context:a,logger:n}){return function(){a.Party.GetFoods().Remove(e),n.logf("Food %s removed",e)}}},show:{name:"show",description:"Shows the currently added foods",compile(e,{context:a,logger:n}){return function(){const r=a.Party.GetFoods().GetAll();n.log(`
`+T.Food(...r))}}},clear:{name:"clear",description:"Clears all the foods from the party",compile(e,{context:a,logger:n}){return function(){a.Party.GetFoods().Clear(),n.log("Cleared all foods")}}}}),pN=()=>({clear:{name:"clear",description:"Clears all the rotation actions",compile(e,{context:a,logger:n}){return function(){a.Rotation.Clear(),n.log("Rotation cleared")}}},run:{name:"run",description:"Runs the rotation",compile(e,{context:a,logger:n}){return function(){n.warn("Running rotation..."),a.Rotation.SetCharacters(...a.Party.GetMembers());const r=a.Rotation.Run();n.logf("Rotation damage: %d",r)}}},log:{name:"log",description:"Controls rotation logs",children:{enable:{name:"enable",description:"Enables the rotation logs",compile(e,{context:a,logger:n}){return function(){a.Rotation.Log=n,n.log("Rotation log enabled")}}},disable:{name:"disable",description:"Disables the rotation logs",compile(e,{context:a,logger:n}){return function(){a.Rotation.Log=void 0,n.log("Rotation log disabled")}}}}},summary:{name:"summary",description:"Prints a summary of the last rotation run",compile(e,{context:a,logger:n}){return function(){n.log(`
`+T.Rotation(a.Rotation.GetSummary()))}}},hit:{name:"hit",arguments:"charname hitname [aura=] [reaction=] multipliers...",description:"Adds a hit to the rotation.",example:`rotation hit Hutao Charged *9 // 9 charged attacks from Hu Tao
rotation hit Hutao N1 aura=90% reaction=40% // hutao normal attack 1 with 90% aura and 40% reaction uptime`,docs:{charname:"the name of the character",hitname:"the name of the hit, without the prefix `hit_`",aura:"the aura uptime, where `0 <= x <= 1`",reaction:"the reaction uptime, where `0 <= x <= aura`",multipliers:"a multiplier in the form `*3`, `*0.5`, etc."},compile({values:[e,a,...n],named:s},{context:r,logger:i}){var c,_;a="HIT_"+a;let u=1;const A=B((c=s.aura)!=null?c:1),S=B((_=s.reaction)!=null?_:1);n.forEach(m=>{const f=m.match(NN);if(!f)return;const N=B(f[1]);u*=N});const h=i.line;return function(){r.Rotation.AddHit(e,a,u,S,A,h),i.logf("Added hit %s (%s) to rotation with multiplier=%.2f, aura=%.2f, reaction=%.2f",a,e,u,A,S)}}},do:{name:"do",arguments:"[*=] commands...",docs:{commands:"a list of commands to be executed as a rotation action"},description:"Saves a command to be executed as a rotation action.",example:"rotation do effect stacks 9",compile({parts:e,expressions:a},{context:n,logger:s}){const r=s.line,i=n.GetCompiler().compileParts(e,r,a);if(!i)throw new Error(`Could not compile command for rotation action at ${r}`);return function(){n.Rotation.AddFn(i,r),s.logf("Added action to rotation: `%s`",e.join(" "))}}},duration:{name:"duration",arguments:"duration",description:"Sets the rotation duration, in seconds.",example:"rotation duration 22 // 22 seconds",compile({values:[e]},{context:a,logger:n}){const s=B(e);return function(){a.Rotation.Duration=s,n.logf("Rotation duration set to %.2f seconds.",s)}}}}),NN=/^\*([0-9]+(?:\.[0-9]+)?%?)$/i,sE=()=>({substats:{tier:4}}),dN=class{constructor(){this.Party=new G.Party,this.Rotation=new ie.Rotation,this.Config=sE(),this.Variables={},this.VarProxy=new Proxy({},{get:(e,a)=>{const n=a.toString(),s=n.split("_");if(s.length>1){const r=s.shift()||"",i=r==="char"?this.Character:this.Party.FindMember(r);if(i){const c=s.join("_").toUpperCase();switch(c){case"MAX_CONSTELLATIONS":let _=0;for(let A=1;A<=6;A++){const S=i.FindEffect(`${r}C${A}`);S&&S.Enabled()&&(_=A)}return _;default:const u=t.stat.Get(c);return i.GetCharacter().Get(u)}}}return this.Variables[n]},set:(e,a,n)=>{var s;const r=a.toString(),i=r.split("_");if(i.length>1){const c=i.shift()||"",_=c==="char"?this.Character:this.Party.FindMember(c);if(_){const u=i.join("_").toUpperCase(),A=t.stat.Get(u),S=typeof n=="number"?n:B(String(n).valueOf());if(!Number.isFinite(S))throw new Error(`Cannot set variable ${r} to ${n}: value is not a number`);_.SetStat(A,S),(s=this.compiler)==null||s.program.logger.logf("Character %s stat %s set to %.4f",_.GetCharacter().Options.Name,t.stat.Name(A),S)}}return this.Variables[r]=n,!0}})}Reset(){this.Party=new G.Party,this.Rotation=new ie.Rotation,this.Character=void 0,this.Effect=void 0,this.Config=sE(),this.State=void 0}GetEffect(){if(!this.Effect)throw new Error("Effect not set");return this.Effect}SetEffect(e){this.Effect=e}GetChar(){if(!this.Character)throw new Error("Character not set");return this.Character}SetChar(e){if(e&&!this.Party.GetMembers().includes(e))throw new Error("Cannot set scenario character: character not in party");this.Character=e}SetCompiler(e){this.compiler=e}GetCompiler(){if(!this.compiler)throw new Error("Scenario compiler not set");return this.compiler}},CN=()=>({set:{name:"set",description:"Sets the value of a stat for a character or characters",arguments:"character stat value [exclude=]",docs:{character:"name of the character to set the stat for. Can be a comma-separated list of names., or the keyword 'all' to set the stat for all characters",stat:"name of the stat to set",value:"value to set the stat to. Can be a percentage like 10% or 0.1",exclude:"name of the characters to exclude from the set. Can be a comma-separated list of names."},compile({values:[e,a],named:{exclude:n},get:s},{context:r,logger:i}){const c=t.stat.Get(a.toUpperCase()),_=e==="all",u=W(e,h=>h)[0];if(n==="all")throw new Error("exclude cannot be 'all'");const A=W(n||"",h=>h)[0],S=u.filter(h=>!A.includes(h));return function(){const m=s.number(2),f=r.Party,L=(f?f.GetMembers():[r.GetChar()]).filter(C=>{const d=C.GetCharacter().Options.Name.toLowerCase();return _?!A.includes(d):S.includes(d)});for(const C of L){const d=C.GetCharacter().Options.Name,M=C.SetStat(c,m);i.logf("Set stat %s=%.2f for %s",t.stat.Name(c),M,d)}}}},add:{name:"add",description:"Adds to the value of a stat for a character or characters",arguments:"character stat value [exclude=]",docs:{character:"name of the character to add the stat to. Can be a comma-separated list of names., or the keyword 'all' to add the stat to all characters",stat:"name of the stat to add",value:"value to add to the stat. Can be a percentage like 10% or 0.1",exclude:"name of the characters to exclude from the add. Can be a comma-separated list of names."},compile({values:[e,a,n],named:{exclude:s}},{context:r,logger:i}){const c=t.stat.Get(a.toUpperCase()),_=B(n),u=e==="all",A=W(e,m=>m)[0];if(s==="all")throw new Error("exclude cannot be 'all'");const S=W(s||"",m=>m)[0];console.log(s,S);const h=A.filter(m=>!S.includes(m));return function(){const f=r.GetChar().GetParty(),L=(f?f.GetMembers():[r.GetChar()]).filter(C=>{const d=C.GetCharacter().Options.Name.toLowerCase();return u?!S.includes(d):h.includes(d)});for(const C of L){const d=C.GetCharacter().Options.Name,M=C.AddStat(c,_);i.logf("Added stat %s+=%.2f for %s",t.stat.Name(c),M,d)}}}}}),MN=()=>({save:{name:"save",description:"Saves the current party state.",compile(e,{context:a,logger:n}){return function(){a.State=G.ExportParty(a.Party),n.log("State saved")}}},load:{name:"load",description:"Loads a previously saved party state.",compile(e,{context:a,logger:n}){return function(){if(!a.State){n.error("No state saved");return}a.Party=Ft.PartyFrom(a.State);const r=a.Party.GetMembers()[0],i=r?r.GetCharacter().Options.Name:void 0,c=n.line,_=a.GetCompiler();_.compileString("character unset",{line:c})(),_.compileString("effect unset",{line:c})(),i&&_.compileString("character set "+i,{line:c})(),n.log("Party loaded from saved state")}}},clear:{name:"clear",description:"Removes the saved state",compile(e,{context:a,logger:n}){return function(){a.State=void 0,n.log("State cleared")}}},b64:{name:"b64",description:"Exports/imports party state as base64 strings",children:{export:{name:"export",description:"Exports party state as a base64 string.",compile(e,{context:a,logger:n}){return function(){if(!a.State){n.error("No state saved");return}const r=btoa(JSON.stringify(a.State));n.log(r)}}},import:{name:"import",description:"Imports party state from a base64 string.",arguments:"base64string",compile({values:[e]},{context:a,logger:n}){const s=JSON.parse(atob(e)),r=n.line;return function(){a.State=s,a.GetCompiler().compileString("state load",{line:r})()}}}}}}),gN=()=>({list:{name:"list",description:"List all registered weapons",compile(e,{logger:a}){const n=pt.Bennett(),s=et.GetList(),r=new T.Table(T.labels.NAME,T.labels.WEAPON,t.stat.Name(t.stat.ATK_BASE),T.labels.STAT,T.labels.VALUE,T.labels.STARS);for(const c of s){const _=c(n);_.SetLevel(90),r.AddRow(c.Name,t.weapon.Name(c.Type),_.GetAtkBase(),t.stat.Name(_.GetSubstat()),_.GetSubstatValue(),c.Stars)}r.DecimalPlaces=4;const i=r.String();return function(){a.logf("Total weapons: %d",s.length),a.log(`
`+i)}}},set:{name:"set",description:"Sets the weapon of the current character",example:"weapon set StaffOfHoma",arguments:"name",compile({values:[e]},{context:a,logger:n}){const s=et.FindByName(e);if(!s)throw new Error("Cannot find weapon: "+e);return function(){a.GetChar().SetWeapon(s),n.logf("Weapon set to %s",s.Name)}}},level:{name:"level",description:"Sets the level of the current character's weapon",example:`weapon level 70
weapon level 80+ //level 80 ascended`,arguments:"level",compile({values:[e]},{context:a,logger:n}){let s=e;const r=e.endsWith("+");r&&(s=e.slice(0,s.length-1));const i=B(s),c=r?6:0;return function(){const u=a.GetChar().GetWeapon();if(!u){n.error("Character weapon is not set");return}u.SetLevel(i),u.SetAscension(c),n.logf("Weapon level set to %d%s",u.GetLevel(),u.IsAscended()?"+":"")}}},rank:{name:"rank",description:"Sets the rank of the current character's weapon",example:"weapon rank 5",arguments:"rank",compile({values:[e]},{context:a,logger:n}){const s=B(e);return function(){const i=a.GetChar().GetWeapon();if(!i){n.error("Character weapon is not set");return}i.SetRank(s),n.logf("Weapon rank set to %d",i.GetRank())}}},remove:{name:"remove",description:"Removes the character weapon",compile(e,{context:a,logger:n}){return function(){a.GetChar().SetWeapon(void 0),n.log("Weapon removed")}}}}),ca=class extends la{constructor(){const e=new dN,a=new qt(e,nt(b({character:{name:"character",description:"Controls characters in the party",children:uN()},stat:{name:"stat",description:"Shortcut for `character stat` subcommands",children:CN()},weapon:{name:"weapon",description:"Controls weapons in the party",children:gN()},effect:{name:"effect",description:"Controls effects in the party",children:SN()},artifact:{name:"artifact",description:"Controls all the artifacts",children:cN()}},EN()),{enemy:{name:"enemy",description:"Controls all enemies in the party.",children:hN()},food:{name:"food",description:"Controls food buffs",children:LN()},rotation:{name:"rotation",description:"Controls the rotation",children:pN()},reset:{name:"reset",description:"Resets the scenario to its initial state",compile(n,{context:s,logger:r}){return function(){s.Reset(),r.warnf("Command `reset` executed.")}}},state:{name:"state",description:"Functions to save/load the party state",children:MN()},enka:{name:"enka",description:"Imports characters from Enka.Network service",children:fN()},echo:{name:"echo",arguments:"[*=] any...",description:"Prints the arguments to the console",compile({parts:n,expressions:s},{logger:r}){const i=r.line;return function(){const _=r.line;r.setLine(i);const u=n.map((A,S)=>{const h=s[S];return h?h.evaluateAll().pop():A});r.log(u.join("")),r.setLine(_)}}},void:{name:"void",arguments:"[*=] any...",description:"Does nothing, can be used to include expression blocks without printing the result",example:"void { 1 + 1 }",compile({expressions:n}){return function(){for(const r of n)!r||r.evaluateAll()}}}}));super(a),this.Scenario=e,this.Scenario.SetCompiler(this),this.exprParser.context.variables=this.Scenario.VarProxy,this.exprParser.context.functions=nt(b({},this.exprParser.context.functions),{print:{name:"print",description:"Prints the arguments to the console",arguments:["..."],evaluate:({values:n,location:s})=>{var r;const i=a.logger.line;return a.logger.setLine(s[0]),a.logger.log(n.join(", ")),a.logger.setLine(i),(r=n[0])!=null?r:0}},foreachcharacter:{name:"foreachcharacter",description:"Executes the expression for each character in the party. Returns the sum of the results of each expression.",arguments:[{name:"expression",description:"expression to evaluate for each character",expression:!0}],evaluate:({expressions:[n]})=>{const s=e.Party.GetMembers(),r=(()=>n.evaluate?[n.evaluate]:n.children.map(_=>_.evaluate||(()=>0)))(),i=e.Character;let c=0;for(const _ of s){e.SetChar(_);for(const u of r)c+=u()}return e.SetChar(i),c}}})}},rE={};D(rE,{BackendWorker:()=>ld,Generate:()=>lE,Optimizer:()=>cd,RotationDamage:()=>od,SetGenerator:()=>IN,UpgradesOptimizer:()=>Ed,VirtualWorker:()=>iE});var GN=0,iE=class{constructor(e){this.poster=e,this.listenersByPath=new Map,this.pathsByListener=new Map,this.errorListeners=[]}SetPoster(e){this.poster=e}SetKiller(e){this.killer=e}Kill(){if(!this.killer)throw new Error("No killer function is defined for this worker");this.killer()}Post(e,a){const n=(++GN).toString(36);return this.poster(e,n,a),n}Recieve(e,a,n){return gt(this,null,function*(){const s=this.listenersByPath.get(e);if(!s){console.error("WORKER PATH NOT FOUND: ",e);return}for(const r of[...s])yield r(a,n)})}Error(e){return gt(this,null,function*(){for(const a of[...this.errorListeners])yield a(e)})}AddErrorListener(e){if(this.errorListeners.includes(e))throw new Error("Cannot add the same listener twice");return this.errorListeners.push(e),e}RemoveErrorListener(e){const a=this.errorListeners.indexOf(e);return a===-1?!1:(this.errorListeners.splice(a,1),!0)}AddListener(e,a){if(this.pathsByListener.has(a))throw new Error("Cannot add the same listener twice");this.pathsByListener.set(a,e);let n=this.listenersByPath.get(e);return n||(n=[],this.listenersByPath.set(e,n)),n.push(a),a}RemoveListener(e){const a=this.pathsByListener.get(e);if(!a)return!1;const n=this.listenersByPath.get(a);if(!n)return!1;const s=n.indexOf(e);return s===-1?!1:(n.splice(s,1),!0)}};function*RN(e,a){let n=[];for(const s of a)n.push(s),n.length>=e&&(yield n,n=[]);n.length>0&&(yield n)}var Ea=void 0;function IN(e){Ea=e}function lE(){if(!Ea)throw new Error("No backend worker generator is defined");return Ea()}var Te=class{constructor(e){this.actions=e,this.listeners=[]}Post(e,a){const n=this.worker;if(!n)throw new Error("Worker not set for this action");n.Post(e,a)}SetWorker(e){this.worker&&this.RemoveWorker();for(const a in this.actions){const n=this.actions[a];e.AddListener(a,n),this.listeners.push(n)}this.worker=e}RemoveWorker(){if(!!this.worker)for(const e of this.listeners)this.worker.RemoveListener(e)}},_e=class{constructor(){this.worker=lE()}Kill(){this.worker.Kill()}},oE={};D(oE,{Filter:()=>Ta});function Ta(e,...a){return a.every(n=>ON(e,n))}function ON(e,a){const n=e.Get(a.stat);return a.operator==="<="?n<=a.value:n>=a.value}function cE(e){const a={},n=[t.stat.LEVEL,t.stat.ASCENSION,t.stat.HP_CURRENT,t.stat.ENERGY_CURRENT,t.stat.NORMAL_ATTACK_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL];for(const s of e.GetMembers()){const r=s.GetCharacter(),c=r.Options.Name.toLowerCase()+"_";for(const _ of n){const u=c+t.stat.Name(_).toLowerCase();a[u]=r.Get(_).toString()}}return a}var Tt=class{constructor(){this.MAX_CHUNK_SIZE=1/0,this.MAX_CHILDREN=1/0,this.TRANSFORM=!1,this.total=0}SetConfig(e){this.config=e}SetTarget(e){this.target=e}SetParty(e){this.party=e}SetRotation(e){this.rotation=e}SetRunner(e){this.runner=e}Init(e){this.config=e,this.runner=new ca;const a=this.runner.Scenario;e.Party&&(a.Party=Ft.PartyFrom(e.Party),this.party=a.Party),e.Cmd&&(this.runner.compileString(e.Cmd)(),this.rotation=a.Rotation,this.rotation.Log=void 0),e.Target&&(this.runner.compileString("character set "+e.Target)(),this.target=a.Character),this.variables=b({},this.runner.Scenario.Variables),this.init(e)}setTotal(e){this.total=e}GetTotal(){return this.total}GetConfig(){if(!this.config)throw new Error("Configuration not set for this optimizer. Try to run `.Init()` first");return this.config}GetParty(){if(!this.party)throw new Error("Party not set for this optimizer. Try to run `.Init()` first");return this.party}GetTarget(){if(!this.target)throw new Error("Target character not set for this optimizer. Try to run `.Init()` first");return this.target}GetRotation(){if(!this.rotation)throw new Error("Rotation not set for this optimizer. Try to run `.Init()` first");return this.rotation}GetRunner(){if(!this.runner)throw new Error("Runner not set for this optimizer. Try to run `.Init()` first");return this.runner}Run(){if(!this.rotation)throw new Error("Rotation not set for this optimizer. Try to run `.Init()` first");if(!this.runner)throw new Error("Runner not set for this optimizer. Try to run `.Init()` first");this.runner.Scenario.Variables=b({},this.variables);const e=G.ExportParty(this.GetParty());this.rotation.SetCharacters(...this.GetParty().GetMembers());const a=this.rotation.Run();return G.ImportParty(e,this.GetParty()),a}Optimize(){for(const e of this.Generate())this.Insert(this.Evaluate(e));return this.Get()}Transform(e){throw new Error("Method not implemented.")}RecieveMessage(e){}getConstants(){const e={};if(this.target&&(e.target_name=this.target.GetCharacter().Options.Name,e.target_element=t.stat.Name(this.target.GetCharacter().Options.Element),e.target_element_aura=t.aura.Name(t.DmgToAura(this.target.GetCharacter().Options.Element))),this.party){this.party.GetMembers().forEach((s,r)=>{const i=s.GetCharacter(),c="member_"+r;e[c+"_name"]=i.Options.Name,e[c+"_element"]=t.stat.Name(i.Options.Element),e[c+"_element_aura"]=t.aura.Name(t.DmgToAura(i.Options.Element))});const n=cE(this.party);Object.assign(e,n)}return e}},EE=5,kt=class extends Tt{constructor(){super(...arguments),this.queue=new it,this.initDamage=0}init(e){if(e.substats.length>EE)throw new Error(`Cannot optimize more than ${EE} substats at once. Requested ${e.substats.length} substats instead`);const a=this.GetTarget(),n=(()=>{const c=a.GetArtifacts();if(!c)throw new Error("Cannot optimize substats without artifacts");return c})();this.initDamage=this.Run();for(const c of n.GetArtifacts())c.SetStars(5),c.ClearSubstats();const s=e.substats.map(({stat:c})=>c),r=e.substats.map(({min:c})=>c),i=e.substats.map(({max:c})=>c);this.modifiers=s.map(c=>a.GetCharacter().CreateModifier(c,0)),this.generator=Ds(s.length,e.total,r,i)}*Generate(){if(!this.generator)throw new Error("No generator has been initialized");yield*this.generator}Evaluate(e){const{tier:a,filter:n}=this.GetConfig(),s=this.GetTarget();if(!this.modifiers)throw new Error("Optimizer initialized incorrectly (no modifiers created)");const r=this.modifiers;e.forEach((A,S)=>r[S].SetValue(A*o.GetSubstatValue(5,r[S].GetProp(),a)));const i=[],c=[];r.forEach(A=>{const S=A.GetProp();i.push(s.GetCharacter().Get(S)),c.push(S)});const _=[s.GetCharacter().Get(t.stat.ATK),s.GetCharacter().Get(t.stat.DEF),s.GetCharacter().Get(t.stat.HP)];if(n&&!Ta(s.GetCharacter(),...n))return{rolls:e,stats:i,optimized:c,damage:-1,relative:0,basic:_};const u=this.Run();return{rolls:e,stats:i,optimized:c,damage:u,relative:u/this.initDamage,basic:_}}Insert(e){e.damage>=0&&this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=this.GetConfig(),n=a.substats.map(({stat:r})=>t.stat.Name(r)),s=new Y(t.stat.Name(t.stat.ATK),t.stat.Name(t.stat.DEF),t.stat.Name(t.stat.HP),...n,T.labels.DAMAGE,T.labels.RELATIVE);for(const r of e){const i=[];r.stats.forEach((_,u)=>{const S=t.FlatStats.includes(a.substats[u].stat)?K(_,0):K(_*100,2)+"%";i.push(S+` (${r.rolls[u]})`)});const c=r.basic.map(_=>K(_,0));s.AddRow(...c,...i,K(r.damage,0),K(r.relative*100,2)+"%")}return s}EquipCmd(e){const a=this.GetConfig();let n=`artifact add
artifact fill
artifact stars 5
artifact rolls tier `+a.tier+`
`;return n+="artifact rolls equip "+e.rolls.map((s,r)=>({rolls:s,stat:a.substats[r].stat})).reduce((s,r)=>s+t.stat.Name(r.stat)+" "+r.rolls+" ",""),n}Clear(){var e;(e=this.modifiers)==null||e.forEach(a=>a.Disable())}},TE={};D(TE,{SubstatsOptimizer:()=>kt,defaultConfig:()=>_a});var _a=()=>({total:25,tier:o.SubstatTier.ROLL_AVG,substats:[{stat:t.stat.CRIT_RATE,min:0,max:10},{stat:t.stat.CRIT_DMG,min:0,max:12},{stat:t.stat.ATK_PERCENT,min:0,max:12},{stat:t.stat.ELEMENTAL_MASTERY,min:0,max:12}]}),_E={[t.piece.FLOWER]:t.PieceToMainstats(t.piece.FLOWER),[t.piece.PLUME]:t.PieceToMainstats(t.piece.PLUME),[t.piece.SANDS]:t.PieceToMainstats(t.piece.SANDS),[t.piece.GOBLET]:t.PieceToMainstats(t.piece.GOBLET),[t.piece.CIRCLET]:t.PieceToMainstats(t.piece.CIRCLET)},uE=class extends Tt{constructor(){super(...arguments),this.results=new it,this.initDamage=0,this.allStats=_E}init(e){if(e.mainstats)for(const s of t.piece.Values()){let r=e.mainstats[s];!r||(r=r.filter(i=>_E[s].includes(i)),r.length!==0&&(this.allStats[s]=r))}const a=Object.values(this.allStats).map(s=>s.length).reduce((s,r)=>s*r,1);this.setTotal(a);const n=this.GetTarget();this.state=G.Export(n),this.initDamage=this.Run(),e.substats&&(this.subsOptimizer=new kt,this.subsOptimizer.SetParty(this.GetParty()),this.subsOptimizer.SetTarget(this.GetTarget()),this.subsOptimizer.SetRotation(this.GetRotation()),this.subsOptimizer.Init(b({},e.substats)),this.subsCombinations=Array.from(this.subsOptimizer.Generate()),this.state=G.Export(n))}*Generate(){for(const e of this.allStats[t.piece.FLOWER])for(const a of this.allStats[t.piece.PLUME])for(const n of this.allStats[t.piece.SANDS])for(const s of this.allStats[t.piece.GOBLET])for(const r of this.allStats[t.piece.CIRCLET])yield[e,a,n,s,r]}Evaluate(e){const a=this.GetTarget(),n=a.GetArtifacts();if(!n)throw new Error("Target character has no artifacts to be optimized");for(let r=0;r<e.length;r++)n.Get(r).SetMainstat(e[r]);const s={damage:-1,mainstats:e,relative:0};if(this.subsOptimizer&&this.subsCombinations){const r=this.subsOptimizer;this.subsCombinations.forEach(_=>r.Insert(r.Evaluate(_)));const c=r.Get()[0];c&&(s.damage=c.damage,s.substats=c)}else s.damage=this.Run();return s.relative=s.damage/this.initDamage,this.state&&G.Import(this.state,a),s}Insert(e){e.damage>=0&&this.results.Push(e,e.damage)}Get(){return this.results.Extract()}Format(e){const a=this.GetConfig(),n=[t.piece.Name(t.piece.SANDS),t.piece.Name(t.piece.GOBLET),t.piece.Name(t.piece.CIRCLET)];if(a.substats){n.push(t.stat.Name(t.stat.ATK),t.stat.Name(t.stat.DEF),t.stat.Name(t.stat.HP));const r=a.substats.substats.map(i=>t.stat.Name(i.stat));n.push(...r)}n.push(T.labels.DAMAGE,T.labels.RELATIVE);const s=new Y(...n);for(const r of e){const i=r.mainstats.slice(2).map(c=>t.stat.Name(c));if(a.substats&&r.substats){const c=a.substats,_=r.substats,u=[];_.stats.forEach((S,h)=>{const f=t.FlatStats.includes(c.substats[h].stat)?K(S,0):K(S*100,2)+"%";u.push(f+` (${_.rolls[h]})`)});const A=_.basic.map(S=>K(S,0));i.push(...A,...u)}i.push(K(r.damage,0),K(r.relative*100,2)+"%"),s.AddRow(...i)}return s}EquipCmd(e){const a=this.GetConfig();let n=`artifact add
artifact fill
`;for(const s of[t.piece.SANDS,t.piece.GOBLET,t.piece.CIRCLET]){const r=t.piece.Name(s).toLowerCase(),i=t.stat.Name(e.mainstats[s]);n+=r+" main "+i+`
`}if(e.substats&&a.substats){const s=new kt;s.SetConfig(a.substats),n+=s.EquipCmd(e.substats)}return n}},ua=Array.from(new Set([...t.Substats,...t.Elements,t.stat.HEALING_BONUS]).values()),AE=class extends Tt{constructor(){super(...arguments),this.modifiers={},this.queue=new it}init(){const e=this.GetTarget();ua.forEach(a=>this.modifiers[a]=e.GetCharacter().CreateModifier(a,0)),this.setTotal(ua.length)}*Generate(){for(const e of ua)yield e}Evaluate(e){const a=this.GetConfig(),n=o.GetSubstatValue(5,e,a.tier);if(!this.modifiers)throw new Error("No modifiers has been initialized. Try to run `.Init()` first.");const s=this.modifiers[e];s.SetValue(0);const r=this.Run();s.SetValue(n);const i=this.Run();return s.SetValue(0),{stat:e,damage:i,benefit:i/r-1}}Insert(e){this.queue.Push(e,e.benefit)}Get(){return this.queue.Extract()}Format(e){const a=this.GetConfig(),n=new T.Table(T.labels.STAT,T.labels.VALUE,T.labels.DAMAGE,T.labels.BENEFIT);for(const{stat:s,damage:r,benefit:i}of e){const c=t.FlatStats.includes(s)?K(o.GetSubstatValue(5,s,a.tier),0):K(o.GetSubstatValue(5,s,a.tier)*100,2);n.AddRow(t.stat.Name(s),c,K(r,2),K(i*100,4)+"%")}return n}EquipCmd(){throw new Error("Method not implemented.")}};function*Vt(...e){e.length===0&&(yield[]);function*a(n,s){for(const r of e[n]){const i=[...s,r];n===e.length-1?yield i:yield*a(n+1,i)}}yield*a(0,[])}function*DN(e,a){function*n(s,r,i){i.length===a&&(yield i);for(let c=r;c<s.length;c++){const _=s[c];yield*n(s,c+1,[...i,_])}}yield*n(e,0,[])}function SE(e,a){const n=e.map(i=>{const c=a==null?void 0:a.get(i.Name.toLowerCase());if(c)return[c];{const _=[...i.Conditions||[""]],u=new Set([0]);u.add(i.MaxStacks||0),u.add(Math.floor((i.MaxStacks||0)/2));const A=i.MaxConditions||1,S=Array.from(DN(_,A));return Array.from(Vt(S,Array.from(u))).map(([m,f])=>["effect condition "+m.join(" ")+`
effect stacks `+f])}});n.length===0&&n.push([]);const s=Array.from(Vt(...n)),r=[];for(const i of s){const c={};i.forEach((_,u)=>{c[e[u].Name]=_}),r.push(c)}return r}var vN=/case([^:]*):/g;function Aa(e){e=Ne(e);const a=new Map,n=Array.from(e.matchAll(vN));n.forEach((r,i)=>{var c;const _=r[0],u=r[1];if(!_||!u)return;const A=u.split(/\s|,|;/).map(f=>f.trim()).filter(f=>!!f),S=(r.index||0)+_.length,h=((c=n[i+1])==null?void 0:c.index)||e.length,m=e.slice(0,S).replace(/[^\n]/g,"")+e.slice(S,h).trim()+e.slice(h,e.length).replace(/[^\n]/g,"");for(let f of A){f=f.toLowerCase();let N=a.get(f);N||a.set(f,N=[]),N.push(m)}});const s=a.get("all");if(s)for(const r of a.values())r.unshift(...s);return a}var ue=tt.GetList(),hE=class extends Tt{constructor(){super(...arguments),this.cases=new Map,this.combinations=[],this.initDamage=0,this.queue=new it}init(e){this.Combinate(e),this.setTotal(this.combinations.length);const a=this.getConstants(),n=this.GetRunner();for(const i in a)n.constants.set(i,a[i]);this.initDamage=this.Run();const r=this.GetTarget().GetArtifacts();if(!r)throw new Error("Target character has no artifacts to be optimized");this.initState=r.GetArtifacts().map(i=>I.Export(i))}Combinate(e){e.ConfigCmd&&(this.cases=Aa(e.ConfigCmd)),this.combinations=[];for(let a=0;a<ue.length;a++)for(let n=a;n<ue.length;n++){const s=[ue[a],ue[n]].sort((r,i)=>r.Stars-i.Stars);this.combinations.push(...this.createRows(s[0],s[1]))}}createRows(e,a){const n=(()=>e===a?[...e.Piece2,...e.Piece4]:[...e.Piece2,...a.Piece2])(),s=SE(n,this.cases),r=[];for(const i of s){const c={sets:[e.Name,a.Name],cmds:i};r.push(c)}return r}*Generate(){for(const e of this.combinations)yield e}Evaluate(e){const a=this.GetRunner(),s=this.GetTarget().GetArtifacts();if(!s)throw new Error("Target character has no artifacts to be optimized");const[r,i]=e.sets,c=tt.FindByName(r),_=tt.FindByName(i);s.Get(0).SetSet(r),s.Get(1).SetSet(r),s.Get(2).SetSet(i),s.Get(3).SetSet(i);const u=new Set;c&&c.Stars===4&&(u.add(0),u.add(1)),_&&_.Stars===4&&(u.add(2),u.add(3));for(const h of u)I.transform.Downgrade(s.Get(h));const A={sets:[r,i],states:[],damage:0,relative:0};for(const h of s.GetEffects()){const m=h.Options.Name;a.Scenario.Effect=h;const f=e.cmds[m];if(!f)continue;let N="";for(const L of f){const C=a.compileString(L);C(),N+=C.String()+`
`}A.states.push({state:l.Export(h),cmd:"effect set "+m+`
`+N,effect:m})}const S=this.Run();if(A.damage=S,A.relative=S/this.initDamage,this.initState&&u.size>0){const h=this.initState;s.GetArtifacts().forEach((m,f)=>I.Import(h[f],m))}return A}Insert(e){this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=new T.Table(T.labels.SET,T.labels.SET,T.labels.STACKS,T.labels.CONDITION,T.labels.DAMAGE,T.labels.RELATIVE);for(const n of e){let[s,r]=n.sets;s===r?(s+=" (2)",r+=" (4)"):(s+=" (2)",r+=" (2)");const i=n.states.map(({state:_,effect:u})=>{const A=Ee.FindByName(u);return A&&(A.MaxStacks||0)>0?_.stacks+"":""}).filter(_=>!!_).join(", "),c=n.states.map(({state:_})=>[..._.conditions]).reduce((_,u)=>(u.forEach(A=>_.push(A)),_),[]).filter(_=>!!_).join(", ");a.AddRow(s,r,i,c,n.damage,K(n.relative*100,2)+"%")}return a}EquipCmd(e){let a=`artifact add
artifact sets `+e.sets.join(" ")+`
`;const[n,s]=e.sets,r=tt.FindByName(n),i=tt.FindByName(s),c=new Set;r&&r.Stars===4&&(c.add("flower"),c.add("plume")),i&&i.Stars===4&&(c.add("sands"),c.add("goblet"));for(const _ of c)a+=_+` downgrade
`;for(const{cmd:_}of e.states)a+=_+`

`;return a+="effect unset",a}},mE=class extends Tt{constructor(){super(...arguments),this.cases=new Map,this.combinations=[],this.initDamage=0,this.queue=new it}init(e){this.Combinate(e),this.setTotal(this.combinations.length);const a=this.getConstants(),n=this.GetRunner();for(const s in a)n.constants.set(s,a[s]);this.initDamage=this.Run()}Combinate(e){var a;e.ConfigCmd&&(this.cases=Aa(e.ConfigCmd));const n=(()=>e.All?et.GetList():et.GetByType(this.GetTarget().GetCharacter().Options.Weapon||0))();this.combinations=[];for(const s of n){const r=((a=e.Ranks)==null?void 0:a[s.Stars])||[1];if(s.Effects.length===0){for(const c of r)this.combinations.push({weapon:s.Name,cmds:{},cmd:`weapon level 90
weapon rank `+c});continue}const i=SE(s.Effects,this.cases);for(const c of i)for(const _ of r){const u={weapon:s.Name,cmds:c,cmd:`weapon level 90
weapon rank `+_};this.combinations.push(u)}}}*Generate(){for(const e of this.combinations)yield e}Evaluate(e){var a;const n=this.GetRunner(),s=this.GetTarget();n.Scenario.Character=s,(a=s.GetWeapon())==null||a.Unequip();const r=et.FindByName(e.weapon);if(!r)throw new Error("Cannot find weapon: "+e.weapon);s.SetWeapon(r);const i=s.GetWeapon();if(!i)throw new Error("Cannot equip the weapon: "+e.weapon);const c=n.compileString(e.cmd);c();const _={weapon:i.Options.Name,states:[],damage:0,relative:0,cmd:c.String(),rank:i.GetRank()};for(const A of i.GetEffects()){const S=A.Options.Name;n.Scenario.Effect=A;const h=e.cmds[S];if(!h)continue;let m="";for(const f of h){const N=n.compileString(f);N(),m+=N.String()+`
`}_.states.push({state:l.Export(A),cmd:"effect set "+S+`
`+m,effect:S})}const u=this.Run();return _.damage=u,_.relative=u/this.initDamage,_}Insert(e){this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=new Y(T.labels.WEAPON,T.labels.STACKS,T.labels.CONDITION,T.labels.DAMAGE,T.labels.RELATIVE);for(const n of e){const s=n.states.map(({state:i,effect:c})=>{const _=Ee.FindByName(c);return _&&(_.MaxStacks||0)>0?i.stacks+"":""}).filter(i=>!!i).join(", "),r=n.states.map(({state:i})=>[...i.conditions]).reduce((i,c)=>(c.forEach(_=>i.push(_)),i),[]).filter(i=>!!i).join(", ");a.AddRow(n.weapon+` (R${n.rank})`,s,r,n.damage,K(n.relative*100,2)+"%")}return a}EquipCmd(e){let a="weapon set "+e.weapon+`
`+e.cmd+`
`;for(const{cmd:n}of e.states)a+=n+`

`;return a+="effect unset",a}};function yN(e,a){if(e.allowSetNumber){const n=e.allowSetNumber;if(a.length===0&&!n.includes(0)||!a.map(([,r])=>r).some(r=>n.includes(r)))return!1}if(e.allowOnly){const n=e.allowOnly.map(r=>r.toLowerCase());if(!a.map(r=>r[0].toLowerCase()).every(r=>n.includes(r)))return!1}return!0}var PN=[...t.Mainstats,...t.Substats],fE=class extends Tt{constructor(){super(...arguments),this.compiled=new Map,this.groups=[],this.mods=new Map,this.initDamage=0,this.initSets=[],this.queue=new it(5),this.prevSets="",this.equipCmd=""}init(e){var a,n;e.artifacts=[...e.artifacts];const s=Aa(e.ConfigCmd||""),r=this.GetRunner(),i=this.getConstants();for(const _ in i)r.constants.set(_,i[_]);for(const[_,u]of s){const A="effect set "+_+`
`+u.join(`
`)+`
effect unset`,S=r.compileString(A);this.compiled.set(_,S)}for(const _ of t.piece.Values())this.groups[_]=[];if(e.artifacts.forEach((_,u)=>this.groups[_.piece].push([u,_])),this.target){this.initDamage=this.Run();let _=(a=this.target.GetArtifacts())==null?void 0:a.GetArtifacts();_||(this.target.SetArtifacts(new Lt.Artbox(this.target)),_=(n=this.target.GetArtifacts())==null?void 0:n.GetArtifacts());const u=[];_&&_.forEach(A=>{this.groups[A.GetPiece()].length>0&&A.Disable(),u[A.GetPiece()]=A.GetSet()}),this.initSets=u;for(const A of PN)this.mods.set(A,this.target.GetCharacter().CreateModifier(A,0))}for(const _ of t.piece.Values())this.groups[_].length||this.groups[_].push([-1,void 0]);let c=1;for(const _ of Object.values(this.groups))_.sort((u,A)=>{var S,h;return(((S=u[1])==null?void 0:S.set)||"").localeCompare(((h=A[1])==null?void 0:h.set)||"")}),c*=_.length;this.setTotal(c)}*Generate(){for(let e=0;e<this.groups[t.piece.FLOWER].length;e++)for(let a=0;a<this.groups[t.piece.PLUME].length;a++)for(let n=0;n<this.groups[t.piece.SANDS].length;n++)for(let s=0;s<this.groups[t.piece.GOBLET].length;s++)for(let r=0;r<this.groups[t.piece.CIRCLET].length;r++)yield this.Combinate([e,a,n,s,r])}Combinate(e){const a=this.GetConfig(),n=t.piece.Values().map(A=>this.groups[A][e[A]]),s=n.map(([,A])=>A),r=n.map(([A])=>A),i=[...this.initSets];for(const A of s)!A||(i[A.piece]=A.set);const[c,_]=Qe(i);if(!yN(a,c))return;const u=[];for(const A of s){if(!A)continue;const S=A,h=o.GetMainstatValue(S.stars,S.mainstat,S.level),m=u.find(f=>f.stat===S.mainstat);m?m.value+=h:u.push({stat:S.mainstat,value:h});for(const{stat:f,value:N}of S.substats){const L=u.find(C=>C.stat===f);L?L.value+=N:u.push({stat:f,value:N})}}return{indexes:r,sets:_,stats:u}}configSets(e,a){const n=a.join(";");if(n!==this.prevSets){this.equipCmd="",e.Get(0).SetSet(a[0]),e.Get(1).SetSet(a[0]),e.Get(2).SetSet(a[1]),e.Get(3).SetSet(a[1]),e.Get(4).SetSet(void 0);for(const s of e.GetEffects()){const r=this.compiled.get(s.Options.Name.toLowerCase());r&&(r(),this.equipCmd+=r.toString()+`
`)}this.prevSets=n}}Evaluate(e){if(!e)return;const a=this.GetTarget(),n=a.GetArtifacts(),{filter:s}=this.GetConfig();if(!n)throw new Error("Target has no artifacts to be optimized. Try to run `.Init()` first");for(const{stat:c,value:_}of e.stats){const u=this.mods.get(c);if(!u)throw new Error("Modifier not initialized for stat "+c+". Try to run `.Init()` first");u.SetValue(_)}if(this.configSets(n,e.sets),s&&!Ta(a.GetCharacter(),...s))return;const r=this.Run(),i=r/this.initDamage;for(const{stat:c}of e.stats){const _=this.mods.get(c);if(!_)throw new Error("Modifier not initialized for stat "+c+". Try to run `.Init()` first");_.SetValue(0)}return{indexes:e.indexes,sets:e.sets,cmd:this.equipCmd,damage:r,relative:i}}Insert(e){e&&e.damage>0&&this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(){throw new Error("Method not implemented.")}GetArtifacts({indexes:e}){const{artifacts:a}=this.GetConfig();return e.filter(n=>n>=0).map(n=>a[n])}EquipCmd(e){return(e==null?void 0:e.cmd)||""}},LE={};D(LE,{FoodOptimizer:()=>pE});var pE=class extends Tt{constructor(){super(...arguments),this.initDamage=0,this.queue=new it,this.groups=[]}init(){this.initDamage=this.Run();for(const e of[Ot.FoodType.OFFENSIVE,Ot.FoodType.ELEMENTAL,Ot.FoodType.DEFENSIVE]){const a=bt.GetByType(e);this.groups.push(a.map(n=>n.Name))}this.setTotal(this.groups.reduce((e,a)=>e*a.length,1))}Generate(){return Vt(...this.groups)}Evaluate(e){const a=this.GetRunner(),n=e.map(r=>"food add "+r+" 3").join(`
`);a.compileString(n)();const s=this.Run();return{foods:e,cmd:n,damage:s,relative:s/this.initDamage}}Insert(e){this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=new Y("FOOD_TYPE_0","FOOD_TYPE_3","FOOD_TYPE_1","DAMAGE","RELATIVE");for(const n of e)a.AddRow(...n.foods,K(n.damage,0),K(n.relative*100,2)+"%");return a}EquipCmd(e){return e.cmd}};function*NE(e){const a=Object.keys(e),n=a.map(r=>e[r]),s=Vt(...n);for(const r of s){const i={};for(let c=0;c<a.length;c++){const _=a[c],u=r[c];i[_]=u}yield i}}function dE(e){let a=1;const n=Object.keys(e);for(const s of n)a*=e[s].length;return a}var Ae=class{constructor(){this.weapons=[],this.artifacts=[]}addWeapon(e){this.weapons.push(e)}getWeapons(){return this.weapons.length>0?this.weapons:[{empty:[!0],name:[""],rank:[0]}]}addArtifacts(e){this.artifacts.push(e)}getArtifacts(){return this.artifacts.length>0?this.artifacts:[{empty:[!0],sands:[0],goblet:[0],circlet:[0]}]}*generate(){const e=Vt(this.getWeapons(),this.getArtifacts());for(const a of e){const n=NE(a[0]);for(const s of n){const r=NE(a[1]);for(const i of r)yield{weapon:s,artifact:i}}}}get(){return{weapon:this.weapons,artifact:this.artifacts}}clear(){this.weapons=[],this.artifacts=[]}static*Generate(...e){const a=new Ae;for(const n of e){for(const s of n.weapon)a.addWeapon(s);for(const s of n.artifact)a.addArtifacts(s);yield*a.generate(),a.clear()}}static Count(...e){let a=0;for(const n of e){const s=n.weapon.map(i=>dE(i)).reduce((i,c)=>i+c,0),r=n.artifact.map(i=>dE(i)).reduce((i,c)=>i+c,0);a+=s*r}return a}};function HN(e){let a="";return e.weapon.empty||(a+=wN(e.weapon)+`
`),e.artifact.empty||(a+=BN(e.artifact)),a}function wN(e){const a=et.FindByName(e.name);if(!a)throw new Error(`Weapon ${e.name} not found`);const n=[`weapon set ${e.name}`,`weapon rank ${e.rank}`,"weapon level 90"];for(const s of a.Effects)n.push("effect unset",`effect set ${s.Name}`),n.push(CE(e,s.ApplyOther)),n.push("effect unset");return n.join(`
`)}function BN(e){const a=["artifact add","artifact main "+[e.sands,e.goblet,e.circlet].map(n=>t.stat.Name(n)).join(" "),"artifact stars 5","artifact level 20"];if(e.set&&(a.push("artifact sets "+e.set.join(" ")),e.set[0]===e.set[1])){const n=tt.FindByName(e.set[0]);if(!n)throw new Error(`Set ${e.set[0]} not found`);for(const s of n.Piece4)a.push("effect unset",`effect set ${s.Name}`),a.push(CE(e,s.ApplyOther)),a.push("effect unset")}return a.join(`
`)}function CE(e,a){const n=[];return Number.isFinite(e.stacks)&&n.push(`effect stacks ${e.stacks}`),e.condition&&n.push(`effect condition ${e.condition.join(" ")}`),e.aura&&n.push(`effect aura ${e.aura.join(" ")}`),e.target&&a&&n.push("effect unapply all",`effect apply ${e.target.join(" ")}`),n.join(`
`)}function ME(e){const{list:a,query:n,count:s=1,threshold:r=.5,substring:i=!0}=e,c=new it(s);for(const _ of a){if(i&&_.includes(n)){const A=_.length/n.length;c.Push(_,A);continue}const u=en.stringSimilarity(n,_);u>=r&&c.Push(_,u)}return c.Extract()}var J=new Map;t.stat.Values().forEach(e=>{const a=t.stat.Name(e).toLowerCase();J.set(a,e)}),J.set("hp",t.stat.HP_FLAT),J.set("hp%",t.stat.HP_PERCENT),J.set("atk",t.stat.ATK_FLAT),J.set("atk%",t.stat.ATK_PERCENT),J.set("def",t.stat.DEF_FLAT),J.set("def%",t.stat.DEF_PERCENT),J.set("er",t.stat.ENERGY_RECHARGE),J.set("em",t.stat.ELEMENTAL_MASTERY),J.set("cr",t.stat.CRIT_RATE),J.set("cd",t.stat.CRIT_DMG),J.set("cdmg",t.stat.CRIT_DMG),t.Elements.forEach(e=>{const a=t.stat.Name(e).toLowerCase().replace(/_?dmg/ig,"");J.set(a,e)}),Array.from(J.keys());function xt(e){return J.get(e)}function gE(e){var a,n,s,r;const i=W((a=e.stacks)!=null?a:"0",A=>parseInt(A))[0],c=W((n=e.condition)!=null?n:"",A=>A),_=W((s=e.aura)!=null?s:"",A=>A),u=W((r=e.target)!=null?r:"",A=>A);return{stacks:i,condition:c,aura:_,target:u}}var bN=tt.GetList().map(e=>e.Name.toLowerCase());function KN(e){var a,n,s,r;const i=W((a=e.sands)!=null?a:"",S=>S)[0].map(S=>{const h=xt(S);if(!h)throw new Error(`Main stat "${S}" not found`);return h}),c=W((n=e.goblet)!=null?n:"",S=>S)[0].map(S=>{const h=xt(S);if(!h)throw new Error(`Main stat "${S}" not found`);return h}),_=W((s=e.circlet)!=null?s:"",S=>S)[0].map(S=>{const h=xt(S);if(!h)throw new Error(`Main stat "${S}" not found`);return h}),u=b({sands:i,goblet:c,circlet:_},gE(e)),A=W((r=e.set)!=null?r:"",S=>S)[0].map(S=>kN(S));return e.set&&(u.set=A),u}var YN=/^([a-z]+)\+([a-z]+)$/i,FN=/^([a-z]+)\*(4|2)$/i;function kN(e){let a=e.match(YN);if(a){const[,n,s]=a;return[Se(n),Se(s)]}if(a=e.match(FN),a){const[,n,s]=a,r=[];for(let i=0;i<parseInt(s)/2;i++)r.push(Se(n));return r}return[Se(e)]}function Se(e){const a=ME({list:bN,query:e,count:1,threshold:.2});if(a.length===0)throw new Error(`Set name "${e}" not found`);return a[0]}var VN=class{constructor(){this.Value=_a(),this.Enabled=!1}Apply(e){return this.Enabled?e.substats=[b({},this.Value)]:delete e.substats,this.Enabled}DefaultRange(){const e=new Y(v.STAT,v.MIN,v.MAX);this.Value=_a();for(const{stat:a,min:n,max:s}of this.Value.substats){const r=t.stat.Name(a);e.AddRow(r,n,s)}return`Total: ${this.Value.total}
Tier: ${this.Value.tier}
`+e.toString()}ParseRange(e){const a=new Y(v.STAT,v.MIN,v.MAX),n=[];for(const s in e){const r=W(e[s],A=>A)[0],i=xt(s);if(!i)throw new Error(`Substat "${s}" not found`);let c=1/0,_=0;r.forEach(A=>{const S=B(A);S<c&&(c=S),S>_&&(_=S)}),n.push({stat:i,min:c,max:_});const u=t.stat.Name(i);a.AddRow(u,c,_)}return this.Value.substats=n,a+""}ParseMin(e){const a=new Y(v.STAT,v.MIN),n=[];for(const s in e){const r=W(e[s],_=>_)[0],i=xt(s);if(!i)throw new Error(`Substat "${s}" not found`);if(r.length!==1)throw new Error(`Substat "${s}" min must be a single value`);const c=B(r[0]);n.push({stat:i,value:c,operator:">="}),a.AddRow(t.stat.Name(i),c)}return this.Value.filter=n,a}Cmd(){return{enable:{name:"enable",description:"Enables substat optimization. When enabled, substats currently in artifacts will be removed, and replaced with an optimal combination of substats based on the ranges defined.",compile:(e,{logger:a})=>()=>{a.log("Substat optimization enabled"),this.Enabled=!0}},disable:{name:"disable",description:"Disables substat optimization. When disabled, substats currently in artifacts will be kept.",compile:(e,{logger:a})=>()=>{this.Enabled=!1,a.log("Substat optimization disabled")}},total:{name:"total",description:"Sets the total substat rolls to optimize. Values must be between 0 and 45.",arguments:"total",example:"substats total 25 // optimize for 25 substat rolls",compile:({values:[e]},{logger:a})=>{const n=parseInt(e);if(isNaN(n)||n<0||n>45)throw new Error("Total must be between 0 and 45");return()=>{this.Value.total=n,a.log(`Substat optimization total set to ${n}`),this.Enabled=!0,a.log("Substat optimization enabled")}}},tier:{name:"tier",description:`Sets the tier of substat rolls to optimize. 
`,arguments:"tier",docs:{tier:"a number from 0 to 4, where 0 is the lowest tier and 3 is the highest tier.Also, the number 4 or the word `avg` can be used to set the tier to the average."},example:`substats tier 3 // optimize max-rolls
substats tier avg // optimize average rolls`,compile:({values:[e]},{logger:a})=>{let n,s;return e==="avg"||e==="4"?(n=4,s="AVERAGE"):(n=Math.max(0,Math.min(4,Math.floor(B(e)))),s=n+""),()=>{this.Value.tier=n,a.logf("Substat optimization tier set to %s",s),this.Enabled=!0,a.log("Substat optimization enabled")}}},range:{name:"range",arguments:"[stat*=min:max]",description:`Defines the range of substats to be used in optimization in the form:

\`range <stat>=<min>:<max> [stat2=<min>:<max> ...]\`

When executed, the substats optimization will be enabled.`,example:"substats range atk=2:12 cr=2:10 cd=2:12 em=2:12 // standard range",compile:({named:e},{logger:a})=>()=>{const n=this.ParseRange(e);a.log("Substat optimization ranges:"),a.log(`
`+n.toString()),this.Enabled=!0,a.log("Substat optimization enabled")}},min:{name:"min",arguments:"[stat*=min]",description:`Adds a minimum value for a substat in the form:

\`min <stat>=<min> [stat2=<min> ...]\`

When executed, the substats optimization will be enabled.`,compile:({named:e},{logger:a})=>()=>{const n=this.ParseMin(e);a.log("Substat optimization minimums:"),a.log(`
`+n.toString()),this.Enabled=!0,a.log("Substat optimization enabled")}},default:{name:"default",description:"Resets the substat ranges to the default values.",compile:(e,{logger:a})=>()=>{const n=this.DefaultRange();a.log(`Substat optimization ranges reset to default:
`+n),this.Enabled=!0,a.log("Substat optimization enabled")}}}}},xN=class{constructor(e){const a=Number.isFinite(e)?et.GetByType(e):et.GetList();this.namesAll=a.map(n=>n.Name.toLowerCase()),this.names4=a.filter(n=>n.Stars===4).map(n=>n.Name.toLowerCase()),this.names5=a.filter(n=>n.Stars===5).map(n=>n.Name.toLowerCase())}Parse(e,a){var n;const s=this.parseName(e),r=W((n=a.rank)!=null?n:"1",i=>parseInt(i))[0];return b({name:s,rank:r},gE(a))}parseName(e){if(e==="all")return this.namesAll;if(e==="4*")return this.names4;if(e==="5*")return this.names5;const a=ME({list:this.namesAll,query:e,count:1,threshold:.4});if(a.length===0)throw new Error(`Weapon name "${e}" not found`);return a}},GE=class extends la{constructor(e){super({}),this.combinator=new Ae,this.groups=[],this.Substats=new VN,this.catch=!1;const a=new xN(e),n=new qt(this.combinator,{add:{name:"add",description:"Saves the current combinations group and starts a new one.",compile:(s,{logger:r})=>()=>{this.groups.push(this.combinator.get()),this.combinator.clear(),r.log("Combination group saved")}},weapon:{name:"weapon",arguments:"name [rank=] [stacks=] [condition=] [aura=] [target=]",docs:{name:"The weapon name can be a partial or similar name, and can be `all`, `4*`, or `5*`.",rank:"Weapon rank, can be a list or range, e.g.:\n- `rank=1,2,3` will use ranks 1, 2, and 3.\n- `rank=1:3` will use ranks 1, 2, and 3.\n- `rank=1:5:2` will use ranks 1, 3, and 5.\n",stacks:"Weapon stacks, can be a list or range, e.g:\n- `stacks=0,1,2` will use stacks 0, 1, and 2.\n- `stacks=0:2` will use stacks 0, 1, and 2.\n- `stacks=0:7:2` will use stacks 0, 2, 4, and 6.\nIf the weapon has multiple effects, you can define stack ranges for each effect, e.g.:\n- `stacks=0:2;0:1` will use stacks 0, 1, and 2 for the first effect, and stacks 0 and 1 for the second effect.\n",condition:"Weapon condition, can be a list, e.g.:\n- `condition=on_field,of_field` will use the condition `on_field` and `of_field`.\nIf the weapon has multiple effects, you can define conditions for each effect, e.g.:\n- `condition=on_field,of_field;on_field` will use the condition `on_field` and `of_field` for the first effect,and `on_field` for the second effect.\n",aura:"Weapon aura, can be a list, e.g.:\n- `aura=pyro,hydro` will use the aura `pyro` and `hydro`.\nIf the weapon has multiple effects, you can define auras for each effect, e.g.:\n- `aura=pyro,hydro;pyro` will use the aura `pyro` and `hydro` for the first effect,and `pyro` for the second effect.\n",target:"Weapon targets, can be a list, e.g.:\n- `target=mona,keqing` will use the target `mona` and `keqing`.\nIf the weapon has multiple effects, you can define targets for each effect, e.g.:\n- `target=mona,keqing;mona` will use the target `mona` and `keqing` for the first effect,and `mona` for the second effect.\n"},description:"Adds weapons to be combined",example:`weapon all // all weapons
weapon 4* // all 4* weapons
weapon jadespear rank=1,5 stacks=0:7 // Jade Spear, rank 1 or 5, all stacks
weapon thrillingtales rank=5 target=mona // Thrilling Tales, rank 5, apply to Mona
`,compile:({values:[s],named:r},{logger:i})=>{const c=a.Parse(s,r);return()=>{var _,u,A,S,h,m,f;this.combinator.addWeapon(c),i.logf(`
Added weapons: %s
  Rank: %s
  Stacks: %s
  Condition: %s
  Aura: %s
  Target: %s
`,c.name.join(", "),c.rank.join(", "),(_=c.stacks)==null?void 0:_.join(", "),(A=(u=c.condition)==null?void 0:u.join(", "))!=null?A:"",(h=(S=c.aura)==null?void 0:S.join(", "))!=null?h:"",(f=(m=c.target)==null?void 0:m.join(", "))!=null?f:"")}}},artifact:{name:"artifact",arguments:"sands= goblet= circlet= [set=] [stacks=] [condition=] [aura=] [target=]",docs:{sands:"Main stats for sands, can be a short name",goblet:"Main stats for goblet, can be a short name",circlet:"Main stats for circlet, can be a short name",set:"Artifact sets, can be the exact name or a partial name, in the form:\n- `set=SetName*2` will use the set `SetName` with 2 pieces.\n- `set=SetName*4` will use the set `SetName` with 4 pieces.\n- `set=SetName+OtherSet` will use the 2+2 combination of `SetName` and `OtherSet`.\nYou can also include lists of sets to combine, e.g.:\n- `set=SetA+SetB,SetC*4` two combinations: 2+2 of `SetA` and `SetB`, and 4 of `SetC`.\n",stacks:"Artifact set stacks, can be a list or range, e.g:\n- `stacks=0,1,2` will use stacks 0, 1, and 2.\n- `stacks=0:2` will use stacks 0, 1, and 2.\n- `stacks=0:7:2` will use stacks 0, 2, 4, and 6.\nIf the set has multiple effects, you can define stack ranges for each effect, e.g.:\n- `stacks=0:2;0:1` will use stacks 0, 1, and 2 for the first effect, and stacks 0 and 1 for the second effect.\n",condition:"Artifact set condition, can be a list, e.g.:\n- `condition=on_field,of_field` will use the condition `on_field` and `of_field`.\nIf the set has multiple effects, you can define conditions for each effect, e.g.:\n- `condition=on_field,of_field;on_field` will use the condition `on_field` and `of_field` for the first effect,and `on_field` for the second effect.\n",aura:"Artifact set aura, can be a list, e.g.:\n- `aura=pyro,hydro` will use the aura `pyro` and `hydro`.\nIf the set has multiple effects, you can define auras for each effect, e.g.:\n- `aura=pyro,hydro;pyro` will use the aura `pyro` and `hydro` for the first effect,and `pyro` for the second effect.\n",target:"Artifact set targets, can be a list, e.g.:\n- `target=mona,keqing` will use the target `mona` and `keqing`.\nIf the set has multiple effects, you can define targets for each effect, e.g.:\n- `target=mona,keqing;mona` will use the target `mona` and `keqing` for the first effect,and `mona` for the second effect.\n"},description:"Adds artifacts to be combined",example:`// compare 4pc Crimson Witch and Emblem of Severed Fate,
// with ATK% vs EM sands, Pyro goblet, and CR vs CD circlet
artifact sands=atk%,em goblet=pyro circlet=cr,cd set=crimson*4,emblem*4`,compile:({named:s},{logger:r})=>{const i=KN(s);return()=>{var c,_,u,A,S,h,m;const f=b({},i),N=this.Substats.Apply(f);this.combinator.addArtifacts(f),r.logf(`
Added artifacts:
  Sands: %s
  Goblet: %s
  Circlet: %s
  Stacks: %s
  Condition: %s
  Aura: %s
  Target: %s
`,f.sands.map(L=>t.stat.Name(L)).join(", "),f.goblet.map(L=>t.stat.Name(L)).join(", "),f.circlet.map(L=>t.stat.Name(L)).join(", "),(c=f.stacks)==null?void 0:c.join(", "),(u=(_=f.condition)==null?void 0:_.join(", "))!=null?u:"",(S=(A=f.aura)==null?void 0:A.join(", "))!=null?S:"",(m=(h=f.target)==null?void 0:h.join(", "))!=null?m:""),N&&r.log("Applied substats optimization to artifacts")}}},substats:{name:"substats",description:"Configures substats to optimize for the next combination group. By default, substats are not optimized and current artifacts will be used.",children:this.Substats.Cmd()}});this.setProgram(n)}Groups(){return this.groups}};function UN(e){const a=new Set,n=new Map;for(const{substats:i}of e)if(!!(i!=null&&i.optimized))for(const c of i.optimized)a.add(c);const s=[...a].map((i,c)=>(n.set(i,c),t.stat.Name(i))),r=new Y("WEAPON","STACKS","CONDITION","AURA","SANDS","GOBLET","CIRCLET","SET","STACKS","CONDITION","AURA","ATK","DEF","HP",...s,"DAMAGE","RELATIVE");for(const{combination:i,substats:c,damage:_,relative:u}of e){const A={name:"",stacks:"",condition:"",aura:""},S={name:"",stacks:"",condition:"",aura:""};i.weapon.empty||(A.name=i.weapon.name+` (R${i.weapon.rank})`,Number.isFinite(i.weapon.stacks)&&(A.stacks=i.weapon.stacks===0?"":i.weapon.stacks+""),i.weapon.condition&&(A.condition=i.weapon.condition.join(", ")),i.weapon.aura&&(A.aura=i.weapon.aura.join(", ")));let h=Sa(3);if(!i.artifact.empty){if(h=[i.artifact.sands,i.artifact.goblet,i.artifact.circlet].map(L=>t.stat.Name(L)),i.artifact.set){const L=[];for(const d of i.artifact.set)L.push(d,d);const[C]=Qe(L);S.name=C.map(([d,M])=>`${d} (${M})`).join(" + ")}Number.isFinite(i.artifact.stacks)&&(S.stacks=i.artifact.stacks===0?"":i.artifact.stacks+""),i.artifact.condition&&(S.condition=i.artifact.condition.join(", ")),i.artifact.aura&&(S.aura=i.artifact.aura.join(", "))}const m=Sa(3),f=Sa(s.length);c&&(c.optimized.forEach((N,L)=>{const C=n.get(N);if(C!==void 0){const d=c.stats[L],R=t.FlatStats.includes(N)?K(d,0):K(d*100,2)+"%";f[C]=R+` (${c.rolls[L]})`}}),c.basic.forEach((N,L)=>m[L]=K(N,0))),r.AddRow(A.name,A.stacks,A.condition,A.aura,...h,S.name,S.stacks,S.condition,S.aura,...m,...f,K(_,0),K(u*100,2)+"%")}return r.RemoveEmptyColumns(),r}function Sa(e,...a){const n=Array.from(Array(e)).fill(void 0);for(let s=0;s<e;s++)n[s]=a[s];return n}var ha=class extends Tt{constructor(){super(...arguments),this.generator=void 0,this.initDamage=0,this.results=new it}init(e){var a;const n=new GE((a=this.target)==null?void 0:a.GetCharacter().Options.Weapon);n.program.logger=new k,n.program.logger.out=()=>{};const s=this.getConstants();for(const r in s)n.constants.set(r,s[r]);n.compileString(e.ConfigCmd)(),this.generator=Ae.Generate(...n.Groups()),this.setTotal(Ae.Count(...n.Groups())),this.party&&(this.initState=$s(this.party),this.initDamage=this.Run()),WN()===1&&console.log(`[MAIN WORKER INIT LOG]
`+n.program.logger.toString())}*Generate(){yield*this.generator}Evaluate(e){const a=this.GetRunner(),n=this.GetTarget();a.Scenario.Character=n;let s=HN(e);a.compileString(s)();let i=0,c;if(e.artifact.substats){const u=new kt;u.SetParty(this.GetParty()),u.SetTarget(n),u.SetRotation(this.GetRotation()),u.Init(b({},e.artifact.substats)),u.variables=b({},this.variables),u.SetRunner(a);for(const A of u.Generate())u.Insert(u.Evaluate(A));if(c=u.Get()[0],!c){u.Clear(),qe(this.initState,this.party);return}i=c.damage,s+=`
`+u.EquipCmd(c),u.Clear(),qe(this.initState,this.party)}else i=this.Run();const _=i/this.initDamage;return{cmd:s,combination:e,substats:c,damage:i,relative:_}}Insert(e){!e||this.results.Push(e,e.damage)}Get(){return this.results.Extract()}Format(e){return ha.Format(e)}static Format(e){const a=e.filter(n=>n!==void 0);return UN(a)}EquipCmd(e){return(e==null?void 0:e.cmd)||""}},RE={SubstatsOptimizer:kt,MainstatOptimizer:uE,NextRollOptimizer:AE,SetOptimizer:hE,WeaponOptimizer:mE,ArtifactsOptimizer:fE,FoodOptimizer:pE,GeneralOptimizer:ha};function Id(e){return e}var IE=0;function WN(){return IE}function ma(e){IE=e}var jN=class extends _e{Init(e){return new Promise((a,n)=>{const s=this.worker.Post("backend:optimizer/run/child/init",e),r=this.worker.AddListener("frontend:optimizer/run/child/init",(c,{id:_})=>{_===s&&(a(),this.worker.RemoveListener(r))}),i=this.worker.AddErrorListener(c=>{this.worker.RemoveErrorListener(i),n(c)})})}Send(e){return new Promise((a,n)=>{const s=this.worker.Post("backend:optimizer/run/child/run",e),r=this.worker.AddListener("frontend:optimizer/run/child/run",(c,{id:_,result:u})=>{_===s&&(a(u),this.worker.RemoveListener(r))}),i=this.worker.AddErrorListener(c=>{this.worker.RemoveErrorListener(i),n(c)})})}SendMessage(e){return new Promise((a,n)=>{const s=this.worker.Post("backend:optimizer/run/child/msg",e),r=this.worker.AddListener("frontend:optimizer/run/child/msg",(c,{id:_})=>{_===s&&(a(),this.worker.RemoveListener(r))}),i=this.worker.AddErrorListener(c=>{this.worker.RemoveErrorListener(i),n(c)})})}},zN=class extends Te{constructor(){super({["backend:optimizer/run"]:(e,a)=>this.Run(e,a)})}Run(e,a){return gt(this,null,function*(){ma(1),k.Global.save=!1,k.Global.out=()=>{};const n=new RE[a.tool];n.Init(a.config);const s=(()=>{const N=n.SendMessage;return N?()=>gt(this,null,function*(){const L=N();n.RecieveMessage(L),yield Promise.all(_.map(C=>C.SendMessage(L)))}):()=>{}})(),r=n.GetTotal();this.Post("frontend:optimizer/run",{id:"progress:"+e,result:[],progress:0,total:r});const i=Math.min(a.chunk,n.MAX_CHUNK_SIZE),c=Math.min(a.children,n.MAX_CHILDREN);console.log(`[WORKER] Spawning ${c} child workers`);const _=qN(c);yield Promise.all(_.map(N=>N.Init(nt(b({},a),{rows:[]}))));const u=RN(i*_.length,n.Generate());let A=0;for(const N of u){const C=(yield Promise.all(_.map((d,M)=>{const R=N.slice(M*i,(M+1)*i);return d.Send(nt(b({},a),{rows:R}))}))).reduce((d,M)=>(M.forEach(R=>d.push(R)),d),[]);for(const d of C)n.Insert(d);yield s(),A+=N.length,this.Post("frontend:optimizer/run",{id:"progress:"+e,result:[],progress:A,total:r})}const S=n.Get(),h=(()=>{if(n.TRANSFORM)return n.Transform(S)})(),m=(()=>{try{return n.Format(S).Serialize()}catch(N){console.error("Could not format optimizer results",N);return}})(),f=S.map(N=>{try{return n.EquipCmd(N)}catch(L){return"// "+String(L).valueOf()}});_.forEach(N=>N.Kill()),this.Post("frontend:optimizer/run",{id:e,result:S,transform:h,cmd:f,formatted:m})})}};function qN(e){return Array.from(Array(e)).fill(0).map(()=>new jN)}var $N=class extends Te{constructor(){super({["backend:optimizer/run/child/init"]:(e,a)=>this.Init(e,a),["backend:optimizer/run/child/run"]:(e,a)=>this.Run(e,a),["backend:optimizer/run/child/msg"]:(e,a)=>this.Msg(e,a)})}Init(e,a){ma(2),k.Global.save=!1,k.Global.out=()=>{},(this.optimizer=new RE[a.tool]).Init(a.config),console.log("[CHILD WORKER] Child worker initialized"),this.Post("frontend:optimizer/run/child/init",{id:e})}Run(e,a){if(!this.optimizer)throw new Error("[CHILD WORKER] Optimizer not set in the child worker");for(const s of a.rows)this.optimizer.Insert(this.optimizer.Evaluate(s));const n=this.optimizer.Get();this.Post("frontend:optimizer/run/child/run",{id:e,result:n})}Msg(e,a){if(ma(2),!this.optimizer)throw new Error("[CHILD WORKER] Optimizer not set in the child worker");this.optimizer.RecieveMessage(a),this.Post("frontend:optimizer/run/child/msg",{id:e})}},QN=class extends Te{constructor(){super({["backend:rotation-damage/run"]:(e,a)=>this.Run(e,a)})}Run(e,a){k.Global.out=()=>{},k.Global.save=!0;const n=Ft.PartyFrom(a.party),s=new ca;s.Scenario.Party=n;const r=cE(n);for(const i in r)s.constants.set(i,r[i]);try{s.compileString(a.command)();const i=s.Scenario.Rotation;s.compileString("rotation log enable")(),s.compileString("rotation run")();const c=i.GetSummary(),_=i.GetDetails();this.Post("frontend:rotation-damage/run",{result:{summary:c,details:_,log:k.Global.toString()},id:e})}catch(i){this.Post("frontend:rotation-damage/run",{result:{log:k.Global.toString()},id:e}),console.error(i)}}},j=ct("NORMAL_ATTACK_LEVEL","ELEMENTAL_SKILL_LEVEL","ELEMENTAL_BURST_LEVEL","CHARACTER_LEVEL","CHARACTER_ASCENSION","WEAPON_LEVEL","WEAPON_ASCENSION");function XN(e,a){const n=JN(a),s=e[n];if(!s)throw new Error(`Cost not found for ${n}`);return s}function JN(e){switch(e.type){case j.NORMAL_ATTACK_LEVEL:case j.ELEMENTAL_SKILL_LEVEL:case j.ELEMENTAL_BURST_LEVEL:return"talent_"+e.value;default:return j.Name(e.type).toLowerCase()+"_"+e.value}}var he={damage:{criteria:"max",fn(e,a){return a}},cost:{criteria:"min",fn(e){return e.cost}},efficiency:{criteria:"max",fn(e,a,n){return n/e.cost}}};function Od(e){return e}function ZN(e,a,...n){var s;const r={};for(const i of n){const c=(s=e.upgrades[a])==null?void 0:s[i];if(!c)throw new Error(`Upgrade ${i} not found for ${a} stars`);try{r[i]=td(e,c)}catch(_){throw new Error(`cannot calculate cost for upgrade ${i} at ${a} stars: 
${_}`)}}return r}function td(e,a){const n=Object.keys(a),s=Object.keys(e.domains),r=new Dt(s);r.Objective(Dt.Vars(s,u=>[u,e.domains[u].cost]));for(const u of n)r.Constraint(Dt.Vars(s,A=>[A,-e.domains[A][u]]),-a[u]);const i=r.Solve("min");if(!i.feasible)throw new Error("cannot calculate cost because the problem is infeasible. Check that the required resources are obtainable from the given domains.");const c=i.result,_=Dt.Vars(s,u=>{const A=i[u];if(!!A)return[u,A]});return b({cost:c},_)}var ed=()=>({domains:{},upgrades:{5:{},4:{},3:{}}}),OE=class extends la{constructor(){super({}),this.pool=ed(),this.stars=[5],this.pointer="domains",this.catch=!1,this.program=new qt(this.pool,{domain:{name:"domain",description:"Sets the current domain to add resources to.",arguments:"name",compile:({values:[e]},{logger:a})=>()=>{this.pool.domains[e]||(this.pool.domains[e]={}),this.pointer="domains",this.name=e,a.log(`Domain set to ${e}`)}},upgrade:{name:"upgrade",description:"Sets the current upgrade to add resources to,in the currently selected stars with the `stars` command.",arguments:"name",compile:({values:[e]},{logger:a})=>()=>{for(const n of this.stars)this.pool.upgrades[n][e]||(this.pool.upgrades[n][e]={});this.pointer="upgrades",this.name=e,a.log(`Upgrade set to ${e}`)}},stars:{name:"stars",description:"Sets the current stars to add upgrades to.",arguments:"stars...",compile:({values:e},{logger:a})=>{const n=e.map(B);return()=>{for(const s of n)this.pool.upgrades[s]||(this.pool.upgrades[s]={});this.stars=n,a.log(`Stars set to ${n}`)}}},cost:{name:"cost",description:"Sets the resin cost for the current domain.",arguments:"cost",compile:({values:[e]},{logger:a})=>{const n=B(e);return()=>{const s=this.getLists();for(const r of s)r.cost=n;a.log(`Resin cost set to ${n}`)}}},resource:{name:"resource",description:"Adds a resource to the current domain or upgrade.",arguments:"name value",compile:({values:[e,a]},{logger:n})=>{const s=B(a);return()=>{const r=this.getLists();for(const i of r)i[e]=s;n.log(`Resource ${s} set to ${e}`)}}}})}getLists(){if(!this.name)throw new Error("No domain or upgrade selected");if(this.pointer==="domains"){const a=this.pool.domains[this.name];if(!a)throw new Error(`No domain named ${this.name}`);return[a]}const e=[];for(const a of this.stars){const n=this.pool.upgrades[a][this.name];if(!n)throw new Error(`No upgrade named ${this.name}`);e.push(n)}return e}GetDomains(){return this.pool.domains}GetResources(){const e=new Set;for(const a of Object.values(this.pool.domains))for(const n of Object.keys(a))e.add(n);for(const a of Object.values(this.pool.upgrades))for(const n of Object.values(a))for(const s of Object.keys(n))e.add(s);return Array.from(e)}GetStars(){return Object.keys(this.pool.upgrades).map(B)}GetUpgrades(e){return this.pool.upgrades[e]}GetPool(){return this.pool}CalculateCost(){const e={};for(const a of Object.keys(this.pool.upgrades)){const n=B(a);e[n]=ZN(this.GetPool(),n,...Object.keys(this.pool.upgrades[n]))}return e}};function ad(e){const a=e.GetCharacter(),n=e.GetWeapon(),s=a.Options.Name,r=DE(s,a);return n&&r.push(...DE(s,n,!1)),r.push(...nd(a)),r}function DE(e,a,n=!0){const s=a.GetLevel(),r=a.GetAscension(),i=pn(r);return s<i?[{target:e,type:n?j.CHARACTER_LEVEL:j.WEAPON_LEVEL,stars:a.Options.Stars,value:i,visible:i}]:r<6?[{target:e,type:n?j.CHARACTER_ASCENSION:j.WEAPON_ASCENSION,stars:a.Options.Stars,value:r+1,visible:r+1}]:[]}var fa=[1,1,2,4,6,8,10];function nd(e){const a=e.GetAscension(),n=e.Get(t.stat.NORMAL_ATTACK_LEVEL_UP),s=e.Get(t.stat.ELEMENTAL_SKILL_LEVEL_UP),r=e.Get(t.stat.ELEMENTAL_BURST_LEVEL_UP),i=e.Get(t.stat.NORMAL_ATTACK_LEVEL)-n,c=e.Get(t.stat.ELEMENTAL_SKILL_LEVEL)-s,_=e.Get(t.stat.ELEMENTAL_BURST_LEVEL)-r,u=[];return i<fa[a]&&u.push({target:e.Options.Name,type:j.NORMAL_ATTACK_LEVEL,stars:e.Options.Stars,value:i+1,visible:i+1+n}),c<fa[a]&&u.push({target:e.Options.Name,type:j.ELEMENTAL_SKILL_LEVEL,stars:e.Options.Stars,value:c+1,visible:c+1+s}),_<fa[a]&&u.push({target:e.Options.Name,type:j.ELEMENTAL_BURST_LEVEL,stars:e.Options.Stars,value:_+1,visible:_+1+r}),u}function sd(e){let a="character set "+e.target+`
`;const n=j.Name(e.type),s=pn(e.visible-1);switch(e.type){case j.NORMAL_ATTACK_LEVEL:case j.ELEMENTAL_SKILL_LEVEL:case j.ELEMENTAL_BURST_LEVEL:a+=`character stat set ${n} ${e.visible}
`;break;case j.CHARACTER_LEVEL:a+=`character level ${e.visible}
`;break;case j.CHARACTER_ASCENSION:a+=`character level ${s}+
`;break;case j.WEAPON_LEVEL:a+=`weapon level ${e.visible}
`;break;case j.WEAPON_ASCENSION:a+=`weapon level ${s}+
`;break}return a}var vE=class extends Tt{constructor(){super(...arguments),this.queue=new it,this.initDamage=0,this.prevDamage=0,this.costs={},this.criteria=he.damage,this.result=[]}init(e){if(!e.costs){const a=new OE;a.compileString(e.resourceCmd)(),e.costs=a.CalculateCost()}this.prevDamage=this.initDamage=this.Run(),this.costs=e.costs,this.criteria=he[e.criteria]}*Generate(){let e;do e=this.getUpgrades(),yield e.map(n=>({step:"upgrade",upgrade:n,cmd:sd(n)}));while(e.length>0)}getUpgrades(){const e=[],n=this.GetParty().GetMembers();for(const s of n){const r=ad(s);e.push(...r)}return e}evaluateRow(e){const a=this.GetParty(),n=G.ExportParty(a);this.GetRunner().compileString(e.cmd)();const r=this.Run(),i=r/this.prevDamage-1;G.ImportParty(n,a);const c=XN(this.costs[e.upgrade.stars],e.upgrade),_={};for(const[u,A]of Object.entries(he))_[u]=A.fn(c,r,i);return nt(b({criteria:this.GetConfig().criteria},_),{cmd:e.cmd,costData:c,upgrade:e.upgrade,relative:r/this.initDamage,increase:i})}Evaluate(e){this.queue.Extract();for(const n of e){const s=this.evaluateRow(n),r=s[this.GetConfig().criteria]*(this.criteria.criteria==="max"?1:-1);this.queue.Push(s,r)}return this.queue.Extract()}Insert(e){const a=e[0];a&&(this.GetRunner().compileString(a.cmd)(),this.prevDamage=this.Run(),a.selected=!0),e.length>1&&(e=e.filter((n,s)=>s===0||n.increase>1e-12)),this.result.push(e)}Get(){return this.result}Format(){throw new Error("Method not implemented.")}static Curve(e){const a=[];let n=0;if(e[0]&&e[0][0]){const s=e[0][0];a.push([0,s.damage/(1+s.increase)])}for(const[s]of e){if(!s)continue;const r=s.costData;n+=r.cost,a.push([n,s.damage])}return a}EquipCmd(){throw new Error("Method not implemented.")}},rd=class extends Te{constructor(){super({["backend:upgrades-optimizer/run"]:(e,a)=>this.Run(e,a)})}Run(e,a){k.Global.out=()=>{},k.Global.save=!0;const n=new vE;n.Init(a);let s=0;this.Post("frontend:upgrades-optimizer/run",{id:e,progress:s});for(const i of n.Generate()){const c=n.Evaluate(i);n.Insert(c),this.Post("frontend:upgrades-optimizer/run",{id:e,progress:s}),s++}const r=n.Get();this.Post("frontend:upgrades-optimizer/run",{id:e,result:r})}},id=[QN,zN,$N,rd];function ld(e){const a=new iE(e);for(const n of id)new n().SetWorker(a);return a}var od=class extends _e{Run(e,a){const n=G.ExportParty(e);return new Promise((s,r)=>{const i=this.worker.Post("backend:rotation-damage/run",{party:n,command:a}),c=this.worker.AddListener("frontend:rotation-damage/run",(u,{result:A,id:S})=>{S===i&&(s(A),this.worker.RemoveListener(c))}),_=this.worker.AddErrorListener(u=>{this.worker.RemoveErrorListener(_),r(u)})})}},cd=class extends _e{constructor(){super(...arguments),this.Children=1,this.Chunk=100,this.OnProgress=()=>{}}Run(e,a){return console.log("[CLIENT] Running optimizer worker for tool: "+e),new Promise((n,s)=>{const r=this.worker.Post("backend:optimizer/run",{tool:e,config:a,children:this.Children,chunk:this.Chunk}),i=this.worker.AddListener("frontend:optimizer/run",(_,u)=>{const{id:A,progress:S,total:h}=u;if(A!==r){A==="progress:"+r&&Number.isFinite(S)&&Number.isFinite(h)&&this.OnProgress(S||0,h||0);return}n(u),this.worker.RemoveListener(i)}),c=this.worker.AddErrorListener(_=>{this.worker.RemoveErrorListener(c),s(_)})})}},Ed=class extends _e{constructor(){super(...arguments),this.OnProgress=()=>{}}Run(e){return new Promise((a,n)=>{const s=this.worker.Post("backend:upgrades-optimizer/run",e),r=this.worker.AddListener("frontend:upgrades-optimizer/run",(c,{id:_,progress:u,total:A,result:S})=>{_===s&&(Number.isFinite(u)&&this.OnProgress(u,A),S&&(a(S),this.worker.RemoveListener(r)))}),i=this.worker.AddErrorListener(c=>{this.worker.RemoveErrorListener(i),n(c)})})}},yE={};D(yE,{artifacts:()=>bE,filter:()=>oE,food:()=>LE,general:()=>KE,mainstat:()=>PE,nextroll:()=>HE,set:()=>wE,substats:()=>TE,upgrades:()=>YE,weapon:()=>BE});var PE={};D(PE,{MainstatOptimizer:()=>uE,defaultConfig:()=>Td});var Td=()=>({}),HE={};D(HE,{NextRollOptimizer:()=>AE,defaultConfig:()=>_d});var _d=()=>({tier:o.SubstatTier.ROLL_AVG}),wE={};D(wE,{SetOptimizer:()=>hE,defaultConfig:()=>ud});var ud=()=>({ConfigCmd:`
/*
IMPORTANT: Remember to mark the "Shielded" checkbox in the character attributes
if you want to optimize Retracing Bolide with its 4-piece set effect enabled.

Note that the effect configurations in this section will override the configurations you do
in the application, but will be overrided by configurations done in the rotation code.
*/

case 
SongOfDaysPast4
NoblesseOblige4
TenacityOfTheMillelith4
DeepwoodMemories4
ArchaicPetra4
ViridescentVenerer4
Instructor4:
  // by default, these party effects will be applied to the entire party.
  effect apply all
  /* 
  you can apply the effect to the member you want, for example:

  effect apply Xiangling

  If you don't want the effect to be applied to the target, then unapply
  from it:

  effect unapply $target_name
  */
  
case 
ArchaicPetra4 
ViridescentVenerer4:
  // by default, Petra and VV effects will have applied the aura corresponding to the target's element,
  // you can change it to the aura (s) you want, or all.
  effect aura $target_element_aura
  // the constant $target_element_aura is predefined by the optimizer, 
  // you can read more about it in the documentation.
  
case OceanHuedClam4:
  // stacks refer to accumulated healing so by default will be 0.
  // set this to the corresponding value if you're optimizing a character
  // with healing capabilities.
  effect stacks 0  
  
/* 
you can add more custom configurations here. Something like, for example:

case CrimsonWitchOfFlames4:
  effect stacks 1

to optimize Crimson with 1 stacks.
*/  
`.trim()}),BE={};D(BE,{WeaponOptimizer:()=>mE,defaultConfig:()=>Ad});var Ad=()=>({Ranks:{3:[5],4:[1,5],5:[1]},ConfigCmd:`
/*
IMPORTANT: Remember to mark the "Shielded" checkbox in the 
character attributes if you want to optimize weapons from
Golden Majesty series (Memory of Dust, Summit Shaper, etc.).
*/
case
WolfsGravestone2
ElegyForTheEnd2
FreedomSworn2
SongOfBrokenPines2
ThousandFloatingDreams2
KeyOfKhajNisut2
HakushinRing1
MakhairaAquamarine1
WanderingEvenstar1
XiphosMoonlight1:
  /*
  These weapon effects will be applied to the entire party
  by default. You can write your own configurations to apply
  to specific characters.
  */
  effect apply all

case KeyOfKhajNisut2:
  effect stacks 3

case
ThrillingTalesOfDragonSlayers1
ForestRegalia1
SapwoodBlade1:
  /*
  By default, these weapon effects will be applied ONLY to the
  first character in the party.
  */
  effect unapply all
  effect apply $member_0_name
`.trim()}),bE={};D(bE,{ArtifactsOptimizer:()=>fE,defaultConfig:()=>Sd});var Sd=()=>({artifacts:[],allowSetNumber:[2,4],ConfigCmd:`
/*
You will have to configure all set effects here. This optimizer won't 
automatically set any stacks or conditions to the effects.

Also remember to mark the "Shielded" checkbox in the character attributes
if you want to optimize Retracing Bolide with its 4-piece set effect enabled.

Note that the effect configurations in this section will override the configurations 
you do in the application, but will be overrided by configurations done in the 
rotation code.
*/

case 
NoblesseOblige4
TenacityOfTheMillelith4
DeepwoodMemories4
ArchaicPetra4
ViridescentVenerer4
Instructor4:
  // by default, these party effects will be applied to the entire party.
  effect apply all
  /* 
  you can apply the effect to the member you want, for example:

  effect apply Xiangling

  If you don't want the effect to be applied to the target, then unapply
  from it:

  effect unapply $target_name
  */
  
case 
ArchaicPetra4 
ViridescentVenerer4:
  // by default, Petra and VV effects will have applied the aura corresponding to 
  // the target's element, you can change it to the aura (s) you want, or all.
  effect aura $target_element_aura
  // the constant $target_element_aura is predefined by the optimizer, 
  // you can read more about it in the documentation.
  
case OceanHuedClam4:
  // stacks refer to accumulated healing so by default will be 0.
  // set this to the corresponding value if you're optimizing a character
  // with healing capabilities.
  effect stacks 0

case CrimsonWitchOfFlames4:
  effect stacks 1 // optimize CW4 with 1 stacks

case PaleFlame4:
  effect stacks 2

case
HuskOfOpulentDreams4
FlowerOfParadiseLost4
VermillionHereafter4:
  effect stacks 4
    `.trim()}),KE={};D(KE,{CombinatorCmd:()=>GE,GeneralOptimizer:()=>ha,defaultConfig:()=>hd});var hd=()=>({ConfigCmd:`# Uncomment the line below if you want to generate optimal substats
# using the default ranges of rolls:
    // substats default
# Also, you can define your own rolls range:
    // substats range atk%=0:12 cr=0:10 cd=0:12 em=0:12 er=0:12
# And you can define minimum values for substats:
    // substats min atk%=5 cr=3 cd=3 em=3 er=3
# And general rolls configuration:
    // substats tier 3   // use max rolls
    // substats tier avg // use average rolls
    // substats total 25 // optimize 25 rolls
# By default, the substats optimization is disabled., which means
# that it will be used the values defined in the artifacts.
# Any of the commands above will enable the substats optimization.


weapon 4* rank=1,5 # optimize all 4* weapons at rank 1 and 5
artifact \\
    sands=atk% \\
    goblet=atk% \\
    circlet=cr,cd # compare crit rate and crit damage circlets
add

weapon 5* rank=1 # optimize all 5* weapons at rank 1
artifact \\
    sands=atk% \\
    goblet=atk% \\
    circlet=cr,cd # compare crit rate and crit damage circlets
add

# You can also add specific weapons and configurations:
// weapon jadespear rank=3 stacks=1,3,5
// weapon alleyhunter rank=5 stacks=1:10

# Or specific combinations of artifact sets:
// artifact sands=atk% goblet=pyro,physical circlet=cr,cd set=gladiator*4
// artifact sands=atk% goblet=pyro,physical circlet=cr,cd set=gladiator+noblesse`}),YE={};D(YE,{Criteria:()=>he,ResourceCmd:()=>OE,Upgrade:()=>j,UpgradesOptimizer:()=>vE,defaultConfig:()=>Ld});var md=`
domain mora_ley_line
cost 20
resource mora 60000

domain exp_ley_line
cost 20
resource exp 122500

domain talent_domain
cost 20
resource mora 2375
resource talent_book 1.1311111111111112

domain weapon_domain
cost 20
resource mora 2375
resource weapon_ascension 0.6314814814814815

domain elite_boss
cost 40
resource mora 6000
resource elite 2.55
resource character_ascension 0.31807407407407406

domain weekly_boss
cost 60
resource mora 8100
resource character_ascension 0.07998148148148147
resource weekly 0.7966666666666667
`.trim(),fd=`
stars 4 5 // 4* and 5* characters
upgrade character_level_20
resource mora 24200
resource exp 120175

upgrade character_level_40
resource mora 115800
resource exp 578325

upgrade character_level_50
resource mora 116000
resource exp 579100

upgrade character_level_60
resource mora 171000
resource exp 854125

upgrade character_level_70
resource mora 239200
resource exp 1195925

upgrade character_level_80
resource mora 322400
resource exp 1611875

upgrade character_level_90
resource mora 684800
resource exp 3423125

upgrade character_ascension_1
resource mora 20000

upgrade character_ascension_2
resource mora 40000
resource elite 2

upgrade character_ascension_3
resource mora 60000
resource elite 4

upgrade character_ascension_4
resource mora 80000
resource elite 8

upgrade character_ascension_5
resource mora 100000
resource elite 12

upgrade character_ascension_6
resource mora 120000
resource elite 20

upgrade talent_2
resource mora 12500
resource talent_book 0.3333333333333333

upgrade talent_3
resource mora 17500
resource talent_book 0.6666666666666666

upgrade talent_4
resource mora 25000
resource talent_book 1.3333333333333333

upgrade talent_5
resource mora 30000
resource talent_book 2

upgrade talent_6
resource mora 37000
resource talent_book 3

upgrade talent_7
resource mora 120000
resource talent_book 4
resource weekly 1

upgrade talent_8
resource mora 260000
resource talent_book 6
resource weekly 1

upgrade talent_9
resource mora 450000
resource talent_book 12
resource weekly 2

upgrade talent_10
resource mora 700000
resource talent_book 16
resource weekly 2

stars 3 // 3* weapons
upgrade weapon_ascension_1
resource mora 5000
resource weapon_ascension 0.07407407407407407

upgrade weapon_ascension_2
resource mora 10000
resource weapon_ascension 0.2222222222222222

upgrade weapon_ascension_3
resource mora 15000
resource weapon_ascension 0.4444444444444444

upgrade weapon_ascension_4
resource mora 20000
resource weapon_ascension 0.6666666666666666

upgrade weapon_ascension_5
resource mora 25000
resource weapon_ascension 1.3333333333333333

upgrade weapon_ascension_6
resource mora 30000
resource weapon_ascension 3

upgrade weapon_level_20
resource mora 5360

upgrade weapon_level_40
resource mora 27400

upgrade weapon_level_50
resource mora 27640

upgrade weapon_level_60
resource mora 40820

upgrade weapon_level_70
resource mora 57180

upgrade weapon_level_80
resource mora 77020

upgrade weapon_level_90
resource mora 163460

stars 4 // 4* weapons
upgrade weapon_ascension_1
resource mora 5000
resource weapon_ascension 0.1111111111111111

upgrade weapon_ascension_2
resource mora 15000
resource weapon_ascension 0.3333333333333333

upgrade weapon_ascension_3
resource mora 20000
resource weapon_ascension 0.6666666666666666

upgrade weapon_ascension_4
resource mora 30000
resource weapon_ascension 1

upgrade weapon_ascension_5
resource mora 35000
resource weapon_ascension 2

upgrade weapon_ascension_6
resource mora 45000
resource weapon_ascension 4

upgrade weapon_level_20
resource mora 8120

upgrade weapon_level_40
resource mora 41520

upgrade weapon_level_50
resource mora 41880

upgrade weapon_level_60
resource mora 61840

upgrade weapon_level_70
resource mora 86640

upgrade weapon_level_80
resource mora 116720

upgrade weapon_level_90
resource mora 247640

stars 5 // 5* weapons
upgrade weapon_ascension_1
resource mora 10000
resource weapon_ascension 0.18518518518518517

upgrade weapon_ascension_2
resource mora 20000
resource weapon_ascension 0.5555555555555556

upgrade weapon_ascension_3
resource mora 30000
resource weapon_ascension 1

upgrade weapon_ascension_4
resource mora 45000
resource weapon_ascension 1.6666666666666665

upgrade weapon_ascension_5
resource mora 55000
resource weapon_ascension 3

upgrade weapon_ascension_6
resource mora 65000
resource weapon_ascension 6

upgrade weapon_level_20
resource mora 12160

upgrade weapon_level_40
resource mora 62280

upgrade weapon_level_50
resource mora 62840

upgrade weapon_level_60
resource mora 92800

upgrade weapon_level_70
resource mora 129920

upgrade weapon_level_80
resource mora 175040

upgrade weapon_level_90
resource mora 371480

`.trim(),Ld=()=>({resourceCmd:pd+`
`+md+`

`+Nd+`
`+fd,criteria:"damage"}),pd=`
# Configures the resources obtained in each domain,
# and the resources required to adquire each upgrade.
# This data will be used to calculate the cost of each
# upgrade.
`.trim(),Nd=`
# Configures the resources required by each upgrade.
# Levels, ascensions and talents require a certain
# amount of resources to be adquired, and so they
# have a cost associated with them.
# The cost will be calculated based on the resources
# configured here.
`,FE={};D(FE,{enka:()=>kE,good:()=>VE});var kE={};D(kE,{Characters:()=>eE,FetchEnka:()=>qc,GetEnka:()=>nE,GetEnkaUrl:()=>$c,ParseEnka:()=>aE,Pieces:()=>Jc,PropMapStat:()=>Xc,Props:()=>oa,Sets:()=>tE,Weapons:()=>Zc});var VE={};D(VE,{MapPieces:()=>xE,MapStats:()=>La,Parse:()=>dd,ParseArtifact:()=>UE});var xE={flower:t.piece.FLOWER,plume:t.piece.PLUME,sands:t.piece.SANDS,goblet:t.piece.GOBLET,circlet:t.piece.CIRCLET},La={hp:t.stat.HP_FLAT,hp_:t.stat.HP_PERCENT,atk:t.stat.ATK_FLAT,atk_:t.stat.ATK_PERCENT,def:t.stat.DEF_FLAT,def_:t.stat.DEF_PERCENT,eleMas:t.stat.ELEMENTAL_MASTERY,enerRech_:t.stat.ENERGY_RECHARGE,heal_:t.stat.HEALING_BONUS,critRate_:t.stat.CRIT_RATE,critDMG_:t.stat.CRIT_DMG,physical_dmg_:t.stat.PHYSICAL_DMG,anemo_dmg_:t.stat.ANEMO_DMG,geo_dmg_:t.stat.GEO_DMG,electro_dmg_:t.stat.ELECTRO_DMG,hydro_dmg_:t.stat.HYDRO_DMG,pyro_dmg_:t.stat.PYRO_DMG,cryo_dmg_:t.stat.CRYO_DMG,dendro_dmg_:t.stat.DENDRO_DMG};function UE(e){const a=xE[e.slotKey];t.piece.Name(a);const n=new I.Artifact(a),s=tt.FindByName(e.setKey);s?n.SetSet(s.Name):(console.warn(`Could not find artifacts set "${e.setKey}"`),n.SetSet(e.setKey)),n.SetStars(e.rarity),n.SetLevel(e.level);const r=La[e.mainStatKey];t.stat.Name(r),n.SetMainstat(r);for(const{key:i,value:c}of e.substats){const _=La[i];t.stat.Name(_);let u=c;if(t.FlatStats.includes(_)||(u/=100),!Number.isFinite(u)||u<0)throw new Error(`Invalid substat value: ${u}`);n.AddSubstat(_,u)}return n}function dd(e){return(e.artifacts||[]).map(n=>UE(n))}const me=self,pa=En.worker.BackendWorker((e,a,n)=>me.postMessage({path:e,id:a,data:n}));pa.SetKiller(()=>me.terminate()),me.addEventListener("message",async({data:e})=>{try{await pa.Recieve(e.path,e.id,e.data)}catch(a){console.error("[CHILD WORKER ERROR]",a),pa.Error(a),me.postMessage({error:a})}})})();
