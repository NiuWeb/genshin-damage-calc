(function(){"use strict";var Mt={exports:{}},ae={exports:{}},na;function uc(){return na||(na=1,function(e){const a=typeof process<"u"&&{}.TERM_PROGRAM==="Hyper",n=typeof process<"u"&&process.platform==="win32",s=typeof process<"u"&&process.platform==="linux",i={ballotDisabled:"\u2612",ballotOff:"\u2610",ballotOn:"\u2611",bullet:"\u2022",bulletWhite:"\u25E6",fullBlock:"\u2588",heart:"\u2764",identicalTo:"\u2261",line:"\u2500",mark:"\u203B",middot:"\xB7",minus:"\uFF0D",multiplication:"\xD7",obelus:"\xF7",pencilDownRight:"\u270E",pencilRight:"\u270F",pencilUpRight:"\u2710",percent:"%",pilcrow2:"\u2761",pilcrow:"\xB6",plusMinus:"\xB1",question:"?",section:"\xA7",starsOff:"\u2606",starsOn:"\u2605",upDownArrow:"\u2195"},l=Object.assign({},i,{check:"\u221A",cross:"\xD7",ellipsisLarge:"...",ellipsis:"...",info:"i",questionSmall:"?",pointer:">",pointerSmall:"\xBB",radioOff:"( )",radioOn:"(*)",warning:"\u203C"}),E=Object.assign({},i,{ballotCross:"\u2718",check:"\u2714",cross:"\u2716",ellipsisLarge:"\u22EF",ellipsis:"\u2026",info:"\u2139",questionFull:"\uFF1F",questionSmall:"\uFE56",pointer:s?"\u25B8":"\u276F",pointerSmall:s?"\u2023":"\u203A",radioOff:"\u25EF",radioOn:"\u25C9",warning:"\u26A0"});e.exports=n&&!a?l:E,Reflect.defineProperty(e.exports,"common",{enumerable:!1,value:i}),Reflect.defineProperty(e.exports,"windows",{enumerable:!1,value:l}),Reflect.defineProperty(e.exports,"other",{enumerable:!1,value:E})}(ae)),ae.exports}const hc=e=>e!==null&&typeof e=="object"&&!Array.isArray(e),Lc=/[\u001b\u009b][[\]#;?()]*(?:(?:(?:[^\W_]*;?[^\W_]*)\u0007)|(?:(?:[0-9]{1,4}(;[0-9]{0,4})*)?[~0-9=<>cf-nqrtyA-PRZ]))/g,Nc=()=>typeof process<"u"?{}.FORCE_COLOR!=="0":!1,sa=()=>{const e={enabled:Nc(),visible:!0,styles:{},keys:{}},a=l=>{let E=l.open=`\x1B[${l.codes[0]}m`,_=l.close=`\x1B[${l.codes[1]}m`,A=l.regex=new RegExp(`\\u001b\\[${l.codes[1]}m`,"g");return l.wrap=(S,u)=>{S.includes(_)&&(S=S.replace(A,_+E));let h=E+S+_;return u?h.replace(/\r*\n/g,`${_}$&${E}`):h},l},n=(l,E,_)=>typeof l=="function"?l(E):l.wrap(E,_),s=(l,E)=>{if(l===""||l==null)return"";if(e.enabled===!1)return l;if(e.visible===!1)return"";let _=""+l,A=_.includes(`
`),S=E.length;for(S>0&&E.includes("unstyle")&&(E=[...new Set(["unstyle",...E])].reverse());S-- >0;)_=n(e.styles[E[S]],_,A);return _},i=(l,E,_)=>{e.styles[l]=a({name:l,codes:E}),(e.keys[_]||(e.keys[_]=[])).push(l),Reflect.defineProperty(e,l,{configurable:!0,enumerable:!0,set(S){e.alias(l,S)},get(){let S=u=>s(u,S.stack);return Reflect.setPrototypeOf(S,e),S.stack=this.stack?this.stack.concat(l):[l],S}})};return i("reset",[0,0],"modifier"),i("bold",[1,22],"modifier"),i("dim",[2,22],"modifier"),i("italic",[3,23],"modifier"),i("underline",[4,24],"modifier"),i("inverse",[7,27],"modifier"),i("hidden",[8,28],"modifier"),i("strikethrough",[9,29],"modifier"),i("black",[30,39],"color"),i("red",[31,39],"color"),i("green",[32,39],"color"),i("yellow",[33,39],"color"),i("blue",[34,39],"color"),i("magenta",[35,39],"color"),i("cyan",[36,39],"color"),i("white",[37,39],"color"),i("gray",[90,39],"color"),i("grey",[90,39],"color"),i("bgBlack",[40,49],"bg"),i("bgRed",[41,49],"bg"),i("bgGreen",[42,49],"bg"),i("bgYellow",[43,49],"bg"),i("bgBlue",[44,49],"bg"),i("bgMagenta",[45,49],"bg"),i("bgCyan",[46,49],"bg"),i("bgWhite",[47,49],"bg"),i("blackBright",[90,39],"bright"),i("redBright",[91,39],"bright"),i("greenBright",[92,39],"bright"),i("yellowBright",[93,39],"bright"),i("blueBright",[94,39],"bright"),i("magentaBright",[95,39],"bright"),i("cyanBright",[96,39],"bright"),i("whiteBright",[97,39],"bright"),i("bgBlackBright",[100,49],"bgBright"),i("bgRedBright",[101,49],"bgBright"),i("bgGreenBright",[102,49],"bgBright"),i("bgYellowBright",[103,49],"bgBright"),i("bgBlueBright",[104,49],"bgBright"),i("bgMagentaBright",[105,49],"bgBright"),i("bgCyanBright",[106,49],"bgBright"),i("bgWhiteBright",[107,49],"bgBright"),e.ansiRegex=Lc,e.hasColor=e.hasAnsi=l=>(e.ansiRegex.lastIndex=0,typeof l=="string"&&l!==""&&e.ansiRegex.test(l)),e.alias=(l,E)=>{let _=typeof E=="string"?e[E]:E;if(typeof _!="function")throw new TypeError("Expected alias to be the name of an existing color (string) or a function");_.stack||(Reflect.defineProperty(_,"name",{value:l}),e.styles[l]=_,_.stack=[l]),Reflect.defineProperty(e,l,{configurable:!0,enumerable:!0,set(A){e.alias(l,A)},get(){let A=S=>s(S,A.stack);return Reflect.setPrototypeOf(A,e),A.stack=this.stack?this.stack.concat(_.stack):_.stack,A}})},e.theme=l=>{if(!hc(l))throw new TypeError("Expected theme to be an object");for(let E of Object.keys(l))e.alias(E,l[E]);return e},e.alias("unstyle",l=>typeof l=="string"&&l!==""?(e.ansiRegex.lastIndex=0,l.replace(e.ansiRegex,"")):""),e.alias("noop",l=>l),e.none=e.clear=e.noop,e.stripColor=e.unstyle,e.symbols=uc(),e.define=i,e};Mt.exports=sa(),Mt.exports.create=sa;var ne={},Dt={},ia={},vt={};Object.defineProperty(vt,"__esModule",{value:!0}),vt.boolean=void 0;const fc=function(e){switch(Object.prototype.toString.call(e)){case"[object String]":return["true","t","yes","y","on","1"].includes(e.trim().toLowerCase());case"[object Number]":return e.valueOf()===1;case"[object Boolean]":return e.valueOf();default:return!1}};vt.boolean=fc;var yt={};Object.defineProperty(yt,"__esModule",{value:!0}),yt.isBooleanable=void 0;const mc=function(e){switch(Object.prototype.toString.call(e)){case"[object String]":return["true","t","yes","y","on","1","false","f","no","n","off","0"].includes(e.trim().toLowerCase());case"[object Number]":return[0,1].includes(e.valueOf());case"[object Boolean]":return!0;default:return!1}};yt.isBooleanable=mc,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isBooleanable=e.boolean=void 0;const a=vt;Object.defineProperty(e,"boolean",{enumerable:!0,get:function(){return a.boolean}});const n=yt;Object.defineProperty(e,"isBooleanable",{enumerable:!0,get:function(){return n.isBooleanable}})}(ia);var Ht={};Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.tokenize=void 0;const Mc=/(?:%(?<flag>([+0-]|-\+))?(?<width>\d+)?(?<position>\d+\$)?(?<precision>\.\d+)?(?<conversion>[%BCESb-iosux]))|(\\%)/g,Cc=e=>{let a;const n=[];let s=0,i=0,l=null;for(;(a=Mc.exec(e))!==null;){a.index>i&&(l={literal:e.slice(i,a.index),type:"literal"},n.push(l));const E=a[0];i=a.index+E.length,E==="\\%"||E==="%%"?l&&l.type==="literal"?l.literal+="%":(l={literal:"%",type:"literal"},n.push(l)):a.groups&&(l={conversion:a.groups.conversion,flag:a.groups.flag||null,placeholder:E,position:a.groups.position?Number.parseInt(a.groups.position,10)-1:s++,precision:a.groups.precision?Number.parseInt(a.groups.precision.slice(1),10):null,type:"placeholder",width:a.groups.width?Number.parseInt(a.groups.width,10):null},n.push(l))}return i<=e.length-1&&(l&&l.type==="literal"?l.literal+=e.slice(i):n.push({literal:e.slice(i),type:"literal"})),n};Ht.tokenize=Cc,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.createPrintf=void 0;const ra=ia,pc=Ht,Gc=(e,a)=>a.placeholder,dc=e=>{var a;const n=(l,E,_)=>_==="-"?l.padEnd(E," "):_==="-+"?((Number(l)>=0?"+":"")+l).padEnd(E," "):_==="+"?((Number(l)>=0?"+":"")+l).padStart(E," "):_==="0"?l.padStart(E,"0"):l.padStart(E," "),s=(a=e==null?void 0:e.formatUnboundExpression)!==null&&a!==void 0?a:Gc,i={};return(l,...E)=>{let _=i[l];_||(_=i[l]=pc.tokenize(l));let A="";for(const S of _)if(S.type==="literal")A+=S.literal;else{let u=E[S.position];if(u===void 0)A+=s(l,S,E);else if(S.conversion==="b")A+=ra.boolean(u)?"true":"false";else if(S.conversion==="B")A+=ra.boolean(u)?"TRUE":"FALSE";else if(S.conversion==="c")A+=u;else if(S.conversion==="C")A+=String(u).toUpperCase();else if(S.conversion==="i"||S.conversion==="d")u=String(Math.trunc(u)),S.width!==null&&(u=n(u,S.width,S.flag)),A+=u;else if(S.conversion==="e")A+=Number(u).toExponential();else if(S.conversion==="E")A+=Number(u).toExponential().toUpperCase();else if(S.conversion==="f")S.precision!==null&&(u=Number(u).toFixed(S.precision)),S.width!==null&&(u=n(String(u),S.width,S.flag)),A+=u;else if(S.conversion==="o")A+=(Number.parseInt(String(u),10)>>>0).toString(8);else if(S.conversion==="s")S.width!==null&&(u=n(String(u),S.width,S.flag)),A+=u;else if(S.conversion==="S")S.width!==null&&(u=n(String(u),S.width,S.flag)),A+=String(u).toUpperCase();else if(S.conversion==="u")A+=Number.parseInt(String(u),10)>>>0;else if(S.conversion==="x")u=(Number.parseInt(String(u),10)>>>0).toString(16),S.width!==null&&(u=n(String(u),S.width,S.flag)),A+=u;else throw new Error("Unknown format specifier.")}return A}};Dt.createPrintf=dc,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.printf=e.createPrintf=void 0;const a=Dt;Object.defineProperty(e,"createPrintf",{enumerable:!0,get:function(){return a.createPrintf}}),e.printf=a.createPrintf()}(ne);var se=function(e,a){return se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i])},se(e,a)};function la(e,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");se(e,a);function n(){this.constructor=e}e.prototype=a===null?Object.create(a):(n.prototype=a.prototype,new n)}function oa(e,a){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var s=n.call(e),i,l=[],E;try{for(;(a===void 0||a-- >0)&&!(i=s.next()).done;)l.push(i.value)}catch(_){E={error:_}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(E)throw E.error}}return l}function ca(e,a,n){if(n||arguments.length===2)for(var s=0,i=a.length,l;s<i;s++)(l||!(s in a))&&(l||(l=Array.prototype.slice.call(a,0,s)),l[s]=a[s]);return e.concat(l||Array.prototype.slice.call(a))}var Ea=function(){function e(){this.t=0}return Object.defineProperty(e.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),e.prototype.size=function(){return this.t},e.prototype.empty=function(){return this.t===0},e}();(function(e){la(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a})(Ea);var Ta=function(e){la(a,e);function a(n,s,i){n===void 0&&(n=[]),s===void 0&&(s=function(S,u){return S>u?-1:S<u?1:0}),i===void 0&&(i=!0);var l=e.call(this)||this;if(l.i=s,Array.isArray(n))l.u=i?ca([],oa(n),!1):n;else{l.u=[];var E=l;n.forEach(function(S){E.u.push(S)})}l.t=l.u.length;for(var _=l.t>>1,A=l.t-1>>1;A>=0;--A)l.o(A,_);return l}return a.prototype.h=function(n){for(var s=this.u[n];n>0;){var i=n-1>>1,l=this.u[i];if(this.i(l,s)<=0)break;this.u[n]=l,n=i}this.u[n]=s},a.prototype.o=function(n,s){for(var i=this.u[n];n<s;){var l=n<<1|1,E=l+1,_=this.u[l];if(E<this.t&&this.i(_,this.u[E])>0&&(l=E,_=this.u[E]),this.i(_,i)>=0)break;this.u[n]=_,n=l}this.u[n]=i},a.prototype.clear=function(){this.t=0,this.u.length=0},a.prototype.push=function(n){this.u.push(n),this.h(this.t),this.t+=1},a.prototype.pop=function(){if(this.t!==0){var n=this.u[0],s=this.u.pop();return this.t-=1,this.t&&(this.u[0]=s,this.o(0,this.t>>1)),n}},a.prototype.top=function(){return this.u[0]},a.prototype.find=function(n){return this.u.indexOf(n)>=0},a.prototype.remove=function(n){var s=this.u.indexOf(n);return s<0?!1:(s===0?this.pop():s===this.t-1?(this.u.pop(),this.t-=1):(this.u.splice(s,1,this.u.pop()),this.t-=1,this.h(s),this.o(s,this.t>>1)),!0)},a.prototype.updateItem=function(n){var s=this.u.indexOf(n);return s<0?!1:(this.h(s),this.o(s,this.t>>1),!0)},a.prototype.toArray=function(){return ca([],oa(this.u),!1)},a}(Ea),gc=Object.defineProperty,Rc=(e,a)=>{for(var n in a)gc(e,n,{get:a[n],enumerable:!0})},_a={};Rc(_a,{Filter:()=>Oc,ReduceSearchItem:()=>Pt,Search:()=>Ic});function Pt(e){const a=[];if(e===void 0)return a;if(Array.isArray(e))for(const n of e){const s=Pt(n);for(const i of s)a.push(i)}else a.push(e);return a}function Ic(e){const a=Pt(e.search),n={values:[],indexes:[],results:[]},s=e.mode||"some";for(let i=0;i<e.values.length;i++){const l=Pt(e.map(e.values[i]));a[s](_=>l.some(A=>typeof _!=typeof A?!1:(e.ignoreCase&&(typeof _=="string"&&(_=_.toLowerCase()),typeof A=="string"&&(A=A.toLowerCase())),e.exact||typeof _=="number"?_===A:typeof A=="string"?A.includes(_):!1)))&&(n.values.push(e.values[i]),n.indexes.push(i),n.results.push({value:e.values[i],index:i}))}return n}function Oc(e){const a={values:[],indexes:[],results:[]};return e.values.forEach((n,s)=>{e.filters[e.mode||"some"](l=>l.for?l.for(n)?l.filter(n):!0:l.filter(n))&&(a.values.push(n),a.indexes.push(s),a.results.push({value:n,index:s}))}),a}var Dc=Object.create,Bt=Object.defineProperty,vc=Object.defineProperties,yc=Object.getOwnPropertyDescriptor,Hc=Object.getOwnPropertyDescriptors,Aa=Object.getOwnPropertyNames,Sa=Object.getOwnPropertySymbols,Pc=Object.getPrototypeOf,ua=Object.prototype.hasOwnProperty,Bc=Object.prototype.propertyIsEnumerable,bc=Math.pow,ha=(e,a,n)=>a in e?Bt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,z=(e,a)=>{for(var n in a||(a={}))ua.call(a,n)&&ha(e,n,a[n]);if(Sa)for(var n of Sa(a))Bc.call(a,n)&&ha(e,n,a[n]);return e},st=(e,a)=>vc(e,Hc(a)),K=(e,a)=>function(){return a||(0,e[Aa(e)[0]])((a={exports:{}}).exports,a),a.exports},O=(e,a)=>{for(var n in a)Bt(e,n,{get:a[n],enumerable:!0})},Kc=(e,a,n,s)=>{if(a&&typeof a=="object"||typeof a=="function")for(let i of Aa(a))!ua.call(e,i)&&i!==n&&Bt(e,i,{get:()=>a[i],enumerable:!(s=yc(a,i))||s.enumerable});return e},wc=(e,a,n)=>(n=e!=null?Dc(Pc(e)):{},Kc(a||!e||!e.__esModule?Bt(n,"default",{value:e,enumerable:!0}):n,e)),Ct=(e,a,n)=>new Promise((s,i)=>{var l=A=>{try{_(n.next(A))}catch(S){i(S)}},E=A=>{try{_(n.throw(A))}catch(S){i(S)}},_=A=>A.done?s(A.value):Promise.resolve(A.value).then(l,E);_((n=n.apply(e,a)).next())}),La=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/Solution.js"(e,a){function n(s,i,l,E){this.feasible=l,this.evaluation=i,this.bounded=E,this._tableau=s}a.exports=n,n.prototype.generateSolutionSet=function(){for(var s={},i=this._tableau,l=i.varIndexByRow,E=i.variablesPerIndex,_=i.matrix,A=i.rhsColumn,S=i.height-1,u=Math.round(1/i.precision),h=1;h<=S;h+=1){var N=l[h],L=E[N];if(!(L===void 0||L.isSlack===!0)){var m=_[h][A];s[L.id]=Math.round((Number.EPSILON+m)*u)/u}}return s}}}),Yc=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/MilpSolution.js"(e,a){var n=La();function s(i,l,E,_,A){n.call(this,i,l,E,_),this.iter=A}a.exports=s,s.prototype=Object.create(n.prototype),s.constructor=s}}),tt=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/Tableau.js"(e,a){var n=La(),s=Yc();function i(E){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=E||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}a.exports=i,i.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()};function l(E,_){this.priority=E,this.reducedCosts=new Array(_);for(var A=0;A<_;A+=1)this.reducedCosts[A]=0}l.prototype.copy=function(){var E=new l(this.priority,this.reducedCosts.length);return E.reducedCosts=this.reducedCosts.slice(),E},i.prototype.setOptionalObjective=function(E,_,A){var S=this.objectivesByPriority[E];if(S===void 0){var u=Math.max(this.width,_+1);S=new l(E,u),this.objectivesByPriority[E]=S,this.optionalObjectives.push(S),this.optionalObjectives.sort(function(h,N){return h.priority-N.priority})}S.reducedCosts[_]=A},i.prototype.initialize=function(E,_,A,S){this.variables=A,this.unrestrictedVars=S,this.width=E,this.height=_;for(var u=new Array(E),h=0;h<E;h++)u[h]=0;this.matrix=new Array(_);for(var N=0;N<_;N++)this.matrix[N]=u.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=E+_-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},i.prototype._resetMatrix=function(){var E=this.model.variables,_=this.model.constraints,A=E.length,S=_.length,u,h,N=this.matrix[0],L=this.model.isMinimization===!0?-1:1;for(u=0;u<A;u+=1){var m=E[u],C=m.priority,G=L*m.cost;C===0?N[u+1]=G:this.setOptionalObjective(C,u+1,G),h=E[u].index,this.rowByVarIndex[h]=-1,this.colByVarIndex[h]=u+1,this.varIndexByCol[u+1]=h}for(var M=1,p=0;p<S;p+=1){var g=_[p],D=g.index;this.rowByVarIndex[D]=M,this.colByVarIndex[D]=-1,this.varIndexByRow[M]=D;var R,y,H,Y=g.terms,j=Y.length,$=this.matrix[M++];if(g.isUpperBound){for(R=0;R<j;R+=1)y=Y[R],H=this.colByVarIndex[y.variable.index],$[H]=y.coefficient;$[0]=g.rhs}else{for(R=0;R<j;R+=1)y=Y[R],H=this.colByVarIndex[y.variable.index],$[H]=-y.coefficient;$[0]=-g.rhs}}},i.prototype.setModel=function(E){this.model=E;var _=E.nVariables+1,A=E.nConstraints+1;return this.initialize(_,A,E.variables,E.unrestrictedVariables),this._resetMatrix(),this},i.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var E=this.lastElementIndex;return this.lastElementIndex+=1,E},i.prototype.density=function(){for(var E=0,_=this.matrix,A=0;A<this.height;A++)for(var S=_[A],u=0;u<this.width;u++)S[u]!==0&&(E+=1);return E/(this.height*this.width)},i.prototype.setEvaluation=function(){var E=Math.round(1/this.precision),_=this.matrix[this.costRowIndex][this.rhsColumn],A=Math.round((Number.EPSILON+_)*E)/E;this.evaluation=A,this.simplexIters===0&&(this.bestPossibleEval=A)},i.prototype.getSolution=function(){var E=this.model.isMinimization===!0?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new s(this,E,this.feasible,this.bounded,this.branchAndCutIterations):new n(this,E,this.feasible,this.bounded)}}}),Fc=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/simplex.js"(){var e=tt();e.prototype.simplex=function(){return this.bounded=!0,this.phase1(),this.feasible===!0&&this.phase2(),this},e.prototype.phase1=function(){for(var n=this.model.checkForCycles,s=[],i=this.matrix,l=this.rhsColumn,E=this.width-1,_=this.height-1,A,S=0;;){for(var u=0,h=-this.precision,N=1;N<=_;N++){A=this.unrestrictedVars[this.varIndexByRow[N]]===!0;var L=i[N][l];L<h&&(h=L,u=N)}if(u===0)return this.feasible=!0,S;for(var m=0,C=-1/0,G=i[0],M=i[u],p=1;p<=E;p++){var g=M[p];if(A=this.unrestrictedVars[this.varIndexByCol[p]]===!0,A||g<-this.precision){var D=-G[p]/g;C<D&&(C=D,m=p)}}if(m===0)return this.feasible=!1,S;if(n){s.push([this.varIndexByRow[u],this.varIndexByCol[m]]);var R=this.checkForCycles(s);if(R.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+R[0]),this.model.messages.push("Length :"+R[1]),this.feasible=!1,S}this.pivot(u,m),S+=1}},e.prototype.phase2=function(){for(var n=this.model.checkForCycles,s=[],i=this.matrix,l=this.rhsColumn,E=this.width-1,_=this.height-1,A=this.precision,S=this.optionalObjectives.length,u=null,h=0,N,L;;){var m=i[this.costRowIndex];S>0&&(u=[]);for(var C=0,G=A,M=!1,p=1;p<=E;p++){if(N=m[p],L=this.unrestrictedVars[this.varIndexByCol[p]]===!0,S>0&&-A<N&&N<A){u.push(p);continue}if(L&&N<0){-N>G&&(G=-N,C=p,M=!0);continue}N>G&&(G=N,C=p,M=!1)}if(S>0)for(var g=0;C===0&&u.length>0&&g<S;){var D=[],R=this.optionalObjectives[g].reducedCosts;G=A;for(var y=0;y<u.length;y++){if(p=u[y],N=R[p],L=this.unrestrictedVars[this.varIndexByCol[p]]===!0,-A<N&&N<A){D.push(p);continue}if(L&&N<0){-N>G&&(G=-N,C=p,M=!0);continue}N>G&&(G=N,C=p,M=!1)}u=D,g+=1}if(C===0)return this.setEvaluation(),this.simplexIters+=1,h;var H=0,Y=1/0;this.varIndexByRow;for(var j=1;j<=_;j++){var $=i[j],et=$[l],q=$[C];if(!(-A<q&&q<A)){if(q>0&&A>et&&et>-A){Y=0,H=j;break}var At=M?-et/q:et/q;At>A&&Y>At&&(Y=At,H=j)}}if(Y===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[C],h;if(n){s.push([this.varIndexByRow[H],this.varIndexByCol[C]]);var St=this.checkForCycles(s);if(St.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+St[0]),this.model.messages.push("Length :"+St[1]),this.feasible=!1,h}this.pivot(H,C,!0),h+=1}};var a=[];e.prototype.pivot=function(n,s){var i=this.matrix,l=i[n][s],E=this.height-1,_=this.width-1,A=this.varIndexByRow[n],S=this.varIndexByCol[s];this.varIndexByRow[n]=S,this.varIndexByCol[s]=A,this.rowByVarIndex[S]=n,this.rowByVarIndex[A]=-1,this.colByVarIndex[S]=-1,this.colByVarIndex[A]=s;for(var u=i[n],h=0,N=0;N<=_;N++)u[N]>=-1e-16&&u[N]<=1e-16?u[N]=0:(u[N]/=l,a[h]=N,h+=1);u[s]=1/l;var L,m,C;this.precision;for(var G=0;G<=E;G++)if(G!==n&&!(i[G][s]>=-1e-16&&i[G][s]<=1e-16)){var M=i[G];if(L=M[s],L>=-1e-16&&L<=1e-16)L!==0&&(M[s]=0);else{for(m=0;m<h;m++)N=a[m],C=u[N],C>=-1e-16&&C<=1e-16?C!==0&&(u[N]=0):M[N]=M[N]-L*C;M[s]=-L/l}}var p=this.optionalObjectives.length;if(p>0)for(var g=0;g<p;g+=1){var D=this.optionalObjectives[g].reducedCosts;if(L=D[s],L!==0){for(m=0;m<h;m++)N=a[m],C=u[N],C!==0&&(D[N]=D[N]-L*C);D[s]=-L/l}}},e.prototype.checkForCycles=function(n){for(var s=0;s<n.length-1;s++)for(var i=s+1;i<n.length;i++){var l=n[s],E=n[i];if(l[0]===E[0]&&l[1]===E[1]){if(i-s>n.length-i)break;for(var _=!0,A=1;A<i-s;A++){var S=n[s+A],u=n[i+A];if(S[0]!==u[0]||S[1]!==u[1]){_=!1;break}}if(_)return[s,i-s]}}return[]}}}),ie=K({"node_modules/@bygdle/javascript-lp-solver/src/expressions.js"(e,a){function n(S,u,h,N){this.id=S,this.cost=u,this.index=h,this.value=0,this.priority=N}function s(S,u,h,N){n.call(this,S,u,h,N)}s.prototype.isInteger=!0;function i(S,u){n.call(this,S,0,u,0)}i.prototype.isSlack=!0;function l(S,u){this.variable=S,this.coefficient=u}function E(S,u,h){return h===0||h==="required"?null:(u=u||1,h=h||1,S.isMinimization===!1&&(u=-u),S.addVariable(u,"r"+S.relaxationIndex++,!1,!1,h))}function _(S,u,h,N){this.slack=new i("s"+h,h),this.index=h,this.model=N,this.rhs=S,this.isUpperBound=u,this.terms=[],this.termsByVarIndex={},this.relaxation=null}_.prototype.addTerm=function(S,u){var h=u.index,N=this.termsByVarIndex[h];if(N===void 0)N=new l(u,S),this.termsByVarIndex[h]=N,this.terms.push(N),this.isUpperBound===!0&&(S=-S),this.model.updateConstraintCoefficient(this,u,S);else{var L=N.coefficient+S;this.setVariableCoefficient(L,u)}return this},_.prototype.removeTerm=function(S){return this},_.prototype.setRightHandSide=function(S){if(S!==this.rhs){var u=S-this.rhs;this.isUpperBound===!0&&(u=-u),this.rhs=S,this.model.updateRightHandSide(this,u)}return this},_.prototype.setVariableCoefficient=function(S,u){var h=u.index;if(h===-1){console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.");return}var N=this.termsByVarIndex[h];if(N===void 0)this.addTerm(S,u);else if(S!==N.coefficient){var L=S-N.coefficient;this.isUpperBound===!0&&(L=-L),N.coefficient=S,this.model.updateConstraintCoefficient(this,u,L)}return this},_.prototype.relax=function(S,u){this.relaxation=E(this.model,S,u),this._relax(this.relaxation)},_.prototype._relax=function(S){S!==null&&(this.isUpperBound?this.setVariableCoefficient(-1,S):this.setVariableCoefficient(1,S))};function A(S,u){this.upperBound=S,this.lowerBound=u,this.model=S.model,this.rhs=S.rhs,this.relaxation=null}A.prototype.isEquality=!0,A.prototype.addTerm=function(S,u){return this.upperBound.addTerm(S,u),this.lowerBound.addTerm(S,u),this},A.prototype.removeTerm=function(S){return this.upperBound.removeTerm(S),this.lowerBound.removeTerm(S),this},A.prototype.setRightHandSide=function(S){this.upperBound.setRightHandSide(S),this.lowerBound.setRightHandSide(S),this.rhs=S},A.prototype.relax=function(S,u){this.relaxation=E(this.model,S,u),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)},a.exports={Constraint:_,Variable:n,IntegerVariable:s,SlackVariable:i,Equality:A,Term:l}}}),Vc=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/cuttingStrategies.js"(){var e=tt(),a=ie().SlackVariable;e.prototype.addCutConstraints=function(n){for(var s=n.length,i=this.height,l=i+s,E=i;E<l;E+=1)this.matrix[E]===void 0&&(this.matrix[E]=this.matrix[E-1].slice());this.height=l,this.nVars=this.width+this.height-2;for(var _,A=this.width-1,S=0;S<s;S+=1){var u=n[S],h=i+S,N=u.type==="min"?-1:1,L=u.varIndex,m=this.rowByVarIndex[L],C=this.matrix[h];if(m===-1){for(C[this.rhsColumn]=N*u.value,_=1;_<=A;_+=1)C[_]=0;C[this.colByVarIndex[L]]=N}else{var G=this.matrix[m],M=G[this.rhsColumn];for(C[this.rhsColumn]=N*(u.value-M),_=1;_<=A;_+=1)C[_]=-N*G[_]}var p=this.getNewElementIndex();this.varIndexByRow[h]=p,this.rowByVarIndex[p]=h,this.colByVarIndex[p]=-1,this.variablesPerIndex[p]=new a("s"+p,p),this.nVars+=1}},e.prototype._addLowerBoundMIRCut=function(n){if(n===this.costRowIndex)return!1;this.model;var s=this.matrix,i=this.variablesPerIndex[this.varIndexByRow[n]];if(!i.isInteger)return!1;var l=s[n][this.rhsColumn],E=l-Math.floor(l);if(E<this.precision||1-this.precision<E)return!1;var _=this.height;s[_]=s[_-1].slice(),this.height+=1,this.nVars+=1;var A=this.getNewElementIndex();this.varIndexByRow[_]=A,this.rowByVarIndex[A]=_,this.colByVarIndex[A]=-1,this.variablesPerIndex[A]=new a("s"+A,A),s[_][this.rhsColumn]=Math.floor(l);for(var S=1;S<this.varIndexByCol.length;S+=1){var u=this.variablesPerIndex[this.varIndexByCol[S]];if(!u.isInteger)s[_][S]=Math.min(0,s[n][S]/(1-E));else{var h=s[n][S],N=Math.floor(h)+Math.max(0,h-Math.floor(h)-E)/(1-E);s[_][S]=N}}for(var L=0;L<this.width;L+=1)s[_][L]-=s[n][L];return!0},e.prototype._addUpperBoundMIRCut=function(n){if(n===this.costRowIndex)return!1;this.model;var s=this.matrix,i=this.variablesPerIndex[this.varIndexByRow[n]];if(!i.isInteger)return!1;var l=s[n][this.rhsColumn],E=l-Math.floor(l);if(E<this.precision||1-this.precision<E)return!1;var _=this.height;s[_]=s[_-1].slice(),this.height+=1,this.nVars+=1;var A=this.getNewElementIndex();this.varIndexByRow[_]=A,this.rowByVarIndex[A]=_,this.colByVarIndex[A]=-1,this.variablesPerIndex[A]=new a("s"+A,A),s[_][this.rhsColumn]=-E;for(var S=1;S<this.varIndexByCol.length;S+=1){var u=this.variablesPerIndex[this.varIndexByCol[S]],h=s[n][S],N=h-Math.floor(h);u.isInteger?N<=E?s[_][S]=-N:s[_][S]=-(1-N)*E/N:h>=0?s[_][S]=-h:s[_][S]=h*E/(1-E)}return!0},e.prototype.applyMIRCuts=function(){}}}),xc=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/dynamicModification.js"(){var e=tt();e.prototype._putInBase=function(a){var n=this.rowByVarIndex[a];if(n===-1){for(var s=this.colByVarIndex[a],i=1;i<this.height;i+=1){var l=this.matrix[i][s];if(l<-this.precision||this.precision<l){n=i;break}}this.pivot(n,s)}return n},e.prototype._takeOutOfBase=function(a){var n=this.colByVarIndex[a];if(n===-1){for(var s=this.rowByVarIndex[a],i=this.matrix[s],l=1;l<this.height;l+=1){var E=i[l];if(E<-this.precision||this.precision<E){n=l;break}}this.pivot(s,n)}return n},e.prototype.updateVariableValues=function(){for(var a=this.variables.length,n=Math.round(1/this.precision),s=0;s<a;s+=1){var i=this.variables[s],l=i.index,E=this.rowByVarIndex[l];if(E===-1)i.value=0;else{var _=this.matrix[E][this.rhsColumn];i.value=Math.round((_+Number.EPSILON)*n)/n}}},e.prototype.updateRightHandSide=function(a,n){var s=this.height-1,i=this.rowByVarIndex[a.index];if(i===-1){for(var l=this.colByVarIndex[a.index],E=0;E<=s;E+=1){var _=this.matrix[E];_[this.rhsColumn]-=n*_[l]}var A=this.optionalObjectives.length;if(A>0)for(var S=0;S<A;S+=1){var u=this.optionalObjectives[S].reducedCosts;u[this.rhsColumn]-=n*u[l]}}else this.matrix[i][this.rhsColumn]-=n},e.prototype.updateConstraintCoefficient=function(a,n,s){if(a.index===n.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var i=this._putInBase(a.index),l=this.colByVarIndex[n.index];if(l===-1)for(var E=this.rowByVarIndex[n.index],_=0;_<this.width;_+=1)this.matrix[i][_]+=s*this.matrix[E][_];else this.matrix[i][l]-=s},e.prototype.updateCost=function(a,n){var s=a.index,i=this.width-1,l=this.colByVarIndex[s];if(l===-1){var E=this.matrix[this.rowByVarIndex[s]],_;if(a.priority===0){var A=this.matrix[0];for(_=0;_<=i;_+=1)A[_]+=n*E[_]}else{var S=this.objectivesByPriority[a.priority].reducedCosts;for(_=0;_<=i;_+=1)S[_]+=n*E[_]}}else this.matrix[0][l]-=n},e.prototype.addConstraint=function(a){var n=a.isUpperBound?1:-1,s=this.height,i=this.matrix[s];i===void 0&&(i=this.matrix[0].slice(),this.matrix[s]=i);for(var l=this.width-1,E=0;E<=l;E+=1)i[E]=0;i[this.rhsColumn]=n*a.rhs;for(var _=a.terms,A=_.length,S=0;S<A;S+=1){var u=_[S],h=u.coefficient,N=u.variable.index,L=this.rowByVarIndex[N];if(L===-1)i[this.colByVarIndex[N]]+=n*h;else{var m=this.matrix[L];for(m[this.rhsColumn],E=0;E<=l;E+=1)i[E]-=n*h*m[E]}}var C=a.index;this.varIndexByRow[s]=C,this.rowByVarIndex[C]=s,this.colByVarIndex[C]=-1,this.height+=1},e.prototype.removeConstraint=function(a){var n=a.index,s=this.height-1,i=this._putInBase(n),l=this.matrix[s];this.matrix[s]=this.matrix[i],this.matrix[i]=l,this.varIndexByRow[i]=this.varIndexByRow[s],this.varIndexByRow[s]=-1,this.rowByVarIndex[n]=-1,this.availableIndexes[this.availableIndexes.length]=n,a.slack.index=-1,this.height-=1},e.prototype.addVariable=function(a){var n=this.height-1,s=this.width,i=this.model.isMinimization===!0?-a.cost:a.cost,l=a.priority,E=this.optionalObjectives.length;if(E>0)for(var _=0;_<E;_+=1)this.optionalObjectives[_].reducedCosts[s]=0;l===0?this.matrix[0][s]=i:(this.setOptionalObjective(l,s,i),this.matrix[0][s]=0);for(var A=1;A<=n;A+=1)this.matrix[A][s]=0;var S=a.index;this.varIndexByCol[s]=S,this.rowByVarIndex[S]=-1,this.colByVarIndex[S]=s,this.width+=1},e.prototype.removeVariable=function(a){var n=a.index,s=this._takeOutOfBase(n),i=this.width-1;if(s!==i){for(var l=this.height-1,E=0;E<=l;E+=1){var _=this.matrix[E];_[s]=_[i]}var A=this.optionalObjectives.length;if(A>0)for(var S=0;S<A;S+=1){var u=this.optionalObjectives[S].reducedCosts;u[s]=u[i]}var h=this.varIndexByCol[i];this.varIndexByCol[s]=h,this.colByVarIndex[h]=s}this.varIndexByCol[i]=-1,this.colByVarIndex[n]=-1,this.availableIndexes[this.availableIndexes.length]=n,a.index=-1,this.width-=1}}}),kc=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/log.js"(){var e=tt();e.prototype.log=function(a,n){console.log("****",a,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var s=5,i="",l=[" "],E,_,A,S,u,h,N,L,m,C,G;for(_=1;_<this.width;_+=1)u=this.varIndexByCol[_],S=this.variablesPerIndex[u],S===void 0?h="c"+u:h=S.id,N=h.length,L=" ",m="	",N>5?L+=" ":m+="	",l[_]=L,i+=m+h;console.log(i);var M,p=this.matrix[this.costRowIndex],g="	";for(E=1;E<this.width;E+=1)M="	",g+=M,g+=l[E],g+=p[E].toFixed(s);for(M="	",g+=M+l[0]+p[0].toFixed(s),console.log(g+"	Z"),A=1;A<this.height;A+=1){for(C=this.matrix[A],G="	",_=1;_<this.width;_+=1)M="	",G+=M+l[_]+C[_].toFixed(s);M="	",G+=M+l[0]+C[0].toFixed(s),u=this.varIndexByRow[A],S=this.variablesPerIndex[u],S===void 0?h="c"+u:h=S.id,console.log(G+"	"+h)}console.log("");var D=this.optionalObjectives.length;if(D>0){console.log("    Optional objectives:");for(var R=0;R<D;R+=1){var y=this.optionalObjectives[R].reducedCosts,H="";for(E=1;E<this.width;E+=1)M=y[E]<0?"":" ",H+=M,H+=l[E],H+=y[E].toFixed(s);M=y[0]<0?"":" ",H+=M+l[0]+y[0].toFixed(s),console.log(H+" z"+R)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this}}}),Uc=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/backup.js"(){var e=tt();e.prototype.copy=function(){var a=new e(this.precision);a.width=this.width,a.height=this.height,a.nVars=this.nVars,a.model=this.model,a.variables=this.variables,a.variablesPerIndex=this.variablesPerIndex,a.unrestrictedVars=this.unrestrictedVars,a.lastElementIndex=this.lastElementIndex,a.varIndexByRow=this.varIndexByRow.slice(),a.varIndexByCol=this.varIndexByCol.slice(),a.rowByVarIndex=this.rowByVarIndex.slice(),a.colByVarIndex=this.colByVarIndex.slice(),a.availableIndexes=this.availableIndexes.slice();for(var n=[],s=0;s<this.optionalObjectives.length;s++)n[s]=this.optionalObjectives[s].copy();a.optionalObjectives=n;for(var i=this.matrix,l=new Array(this.height),E=0;E<this.height;E++)l[E]=i[E].slice();return a.matrix=l,a},e.prototype.save=function(){this.savedState=this.copy()},e.prototype.restore=function(){if(this.savedState!==null){var a=this.savedState,n=a.matrix;this.nVars=a.nVars,this.model=a.model,this.variables=a.variables,this.variablesPerIndex=a.variablesPerIndex,this.unrestrictedVars=a.unrestrictedVars,this.lastElementIndex=a.lastElementIndex,this.width=a.width,this.height=a.height;var s,i;for(s=0;s<this.height;s+=1){var l=n[s],E=this.matrix[s];for(i=0;i<this.width;i+=1)E[i]=l[i]}var _=a.varIndexByRow;for(i=0;i<this.height;i+=1)this.varIndexByRow[i]=_[i];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var A=a.varIndexByCol;for(s=0;s<this.width;s+=1)this.varIndexByCol[s]=A[s];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var S=a.rowByVarIndex,u=a.colByVarIndex,h=0;h<this.nVars;h+=1)this.rowByVarIndex[h]=S[h],this.colByVarIndex[h]=u[h];if(a.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var N=0;N<a.optionalObjectives.length;N++){var L=a.optionalObjectives[N].copy();this.optionalObjectives[N]=L,this.optionalObjectivePerPriority[L.priority]=L}}}}}}),Wc=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/branchingStrategies.js"(){var e=tt();function a(n,s){this.index=n,this.value=s}e.prototype.getMostFractionalVar=function(){for(var n=0,s=null,i=null,l=this.model.integerVariables,E=l.length,_=0;_<E;_++){var A=l[_].index,S=this.rowByVarIndex[A];if(S!==-1){var u=this.matrix[S][this.rhsColumn],h=Math.abs(u-Math.round(u));n<h&&(n=h,s=A,i=u)}}return new a(s,i)},e.prototype.getFractionalVarWithLowestCost=function(){for(var n=1/0,s=null,i=null,l=this.model.integerVariables,E=l.length,_=0;_<E;_++){var A=l[_],S=A.index,u=this.rowByVarIndex[S];if(u!==-1){var h=this.matrix[u][this.rhsColumn];if(Math.abs(h-Math.round(h))>this.precision){var N=A.cost;n>N&&(n=N,s=S,i=h)}}}return new a(s,i)}}}),jc=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/integerProperties.js"(){var e=tt();e.prototype.countIntegerValues=function(){for(var a=0,n=1;n<this.height;n+=1)if(this.variablesPerIndex[this.varIndexByRow[n]].isInteger){var s=this.matrix[n][this.rhsColumn];s=s-Math.floor(s),s<this.precision&&-s<this.precision&&(a+=1)}return a},e.prototype.isIntegral=function(){for(var a=this.model.integerVariables,n=a.length,s=0;s<n;s++){var i=this.rowByVarIndex[a[s].index];if(i!==-1){var l=this.matrix[i][this.rhsColumn];if(Math.abs(l-Math.round(l))>this.precision)return!1}}return!0},e.prototype.computeFractionalVolume=function(a){for(var n=-1,s=1;s<this.height;s+=1)if(this.variablesPerIndex[this.varIndexByRow[s]].isInteger){var i=this.matrix[s][this.rhsColumn];i=Math.abs(i);var l=Math.min(i-Math.floor(i),Math.floor(i+1));if(l<this.precision){if(!a)return 0}else n===-1?n=i:n*=i}return n===-1?0:n}}}),qc=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/index.js"(e,a){Fc(),Vc(),xc(),kc(),Uc(),Wc(),jc(),a.exports=tt()}}),Na=K({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/branchAndCut.js"(){var e=tt();function a(i,l,E){this.type=i,this.varIndex=l,this.value=E}function n(i,l){this.relaxedEvaluation=i,this.cuts=l}function s(i,l){return l.relaxedEvaluation-i.relaxedEvaluation}e.prototype.applyCuts=function(i){if(this.restore(),this.addCutConstraints(i),this.simplex(),this.model.useMIRCuts)for(var l=!0;l;){var E=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex();var _=this.computeFractionalVolume(!0);_>=.9*E&&(l=!1)}},e.prototype.branchAndCut=function(){var i=[],l=0,E=this.model.tolerance,_=!0,A=1e99;this.model.timeout&&(A=Date.now()+this.model.timeout);for(var S=1/0,u=null,h=[],N=0;N<this.optionalObjectives.length;N+=1)h.push(1/0);var L=new n(-1/0,[]),m;for(i.push(L);i.length>0&&_===!0&&Date.now()<A;)if(this.model.isMinimization?m=this.bestPossibleEval*(1+E):m=this.bestPossibleEval*(1-E),E>0&&S<m&&(_=!1),L=i.pop(),!(L.relaxedEvaluation>S)){var C=L.cuts;if(this.applyCuts(C),l++,this.feasible!==!1){var G=this.evaluation;if(!(G>S)){if(G===S){for(var M=!0,p=0;p<this.optionalObjectives.length&&!(this.optionalObjectives[p].reducedCosts[0]>h[p]);p+=1)if(this.optionalObjectives[p].reducedCosts[0]<h[p]){M=!1;break}if(M)continue}if(this.isIntegral()===!0){if(this.__isIntegral=!0,l===1){this.branchAndCutIterations=l;return}u=L,S=G;for(var g=0;g<this.optionalObjectives.length;g+=1)h[g]=this.optionalObjectives[g].reducedCosts[0];if(this.model.keep_solutions){var D=this.model.tableau.getSolution(),R=D.generateSolutionSet();R.result=D.evaluation,this.model.solutions||(this.model.solutions=[]),this.model.solutions.push(R)}}else{l===1&&this.save();for(var y=this.getMostFractionalVar(),H=y.index,Y=[],j=[],$=C.length,et=0;et<$;et+=1){var q=C[et];q.varIndex===H?q.type==="min"?j.push(q):Y.push(q):(Y.push(q),j.push(q))}var At=Math.ceil(y.value),St=Math.floor(y.value),Ze=new a("min",H,At);Y.push(Ze);var Je=new a("max",H,St);j.push(Je),i.push(new n(G,Y)),i.push(new n(G,j)),i.sort(s)}}}}u!==null&&this.applyCuts(u.cuts),this.branchAndCutIterations=l}}}),zc=K({"node_modules/@bygdle/javascript-lp-solver/src/Model.js"(e,a){var n=tt();Na();var s=ie(),i=s.Constraint,l=s.Equality,E=s.Variable,_=s.IntegerVariable;s.Term;function A(S,u){this.tableau=new n(S),this.name=u,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}a.exports=A,A.prototype.minimize=function(){return this.isMinimization=!0,this},A.prototype.maximize=function(){return this.isMinimization=!1,this},A.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var S=this.lastElementIndex;return this.lastElementIndex+=1,S},A.prototype._addConstraint=function(S){var u=S.slack;this.tableau.variablesPerIndex[u.index]=u,this.constraints.push(S),this.nConstraints+=1,this.tableauInitialized===!0&&this.tableau.addConstraint(S)},A.prototype.smallerThan=function(S){var u=new i(S,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(u),u},A.prototype.greaterThan=function(S){var u=new i(S,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(u),u},A.prototype.equal=function(S){var u=new i(S,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(u);var h=new i(S,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(h),new l(u,h)},A.prototype.addVariable=function(S,u,h,N,L){if(typeof L=="string")switch(L){case"required":L=0;break;case"strong":L=1;break;case"medium":L=2;break;case"weak":L=3;break;default:L=0;break}var m=this.tableau.getNewElementIndex();u==null&&(u="v"+m),S==null&&(S=0),L==null&&(L=0);var C;return h?(C=new _(u,S,m,L),this.integerVariables.push(C)):C=new E(u,S,m,L),this.variables.push(C),this.tableau.variablesPerIndex[m]=C,N&&(this.unrestrictedVariables[m]=!0),this.nVariables+=1,this.tableauInitialized===!0&&this.tableau.addVariable(C),C},A.prototype._removeConstraint=function(S){var u=this.constraints.indexOf(S);if(u===-1){console.warn("[Model.removeConstraint] Constraint not present in model");return}this.constraints.splice(u,1),this.nConstraints-=1,this.tableauInitialized===!0&&this.tableau.removeConstraint(S),S.relaxation&&this.removeVariable(S.relaxation)},A.prototype.removeConstraint=function(S){return S.isEquality?(this._removeConstraint(S.upperBound),this._removeConstraint(S.lowerBound)):this._removeConstraint(S),this},A.prototype.removeVariable=function(S){var u=this.variables.indexOf(S);if(u===-1){console.warn("[Model.removeVariable] Variable not present in model");return}return this.variables.splice(u,1),this.tableauInitialized===!0&&this.tableau.removeVariable(S),this},A.prototype.updateRightHandSide=function(S,u){return this.tableauInitialized===!0&&this.tableau.updateRightHandSide(S,u),this},A.prototype.updateConstraintCoefficient=function(S,u,h){return this.tableauInitialized===!0&&this.tableau.updateConstraintCoefficient(S,u,h),this},A.prototype.setCost=function(S,u){var h=S-u.cost;return this.isMinimization===!1&&(h=-h),u.cost=S,this.tableau.updateCost(u,h),this},A.prototype.loadJson=function(S){this.isMinimization=S.opType!=="max";for(var u=S.variables,h=S.constraints,N={},L={},m=Object.keys(h),C=m.length,G=0;G<C;G+=1){var M=m[G],p=h[M],g=p.equal,D=p.weight,R=p.priority,y=D!==void 0||R!==void 0,H,Y;if(g===void 0){var j=p.min;j!==void 0&&(H=this.greaterThan(j),N[M]=H,y&&H.relax(D,R));var $=p.max;$!==void 0&&(Y=this.smallerThan($),L[M]=Y,y&&Y.relax(D,R))}else{H=this.greaterThan(g),N[M]=H,Y=this.smallerThan(g),L[M]=Y;var et=new l(H,Y);y&&et.relax(D,R)}}var q=Object.keys(u),At=q.length;this.tolerance=S.tolerance||0,S.timeout&&(this.timeout=S.timeout),S.options&&(S.options.timeout&&(this.timeout=S.options.timeout),this.tolerance===0&&(this.tolerance=S.options.tolerance||0),S.options.useMIRCuts&&(this.useMIRCuts=S.options.useMIRCuts),typeof S.options.exitOnCycles>"u"?this.checkForCycles=!0:this.checkForCycles=S.options.exitOnCycles,S.options.keep_solutions?this.keep_solutions=S.options.keep_solutions:this.keep_solutions=!1);for(var St=S.ints||{},Ze=S.binaries||{},Je=S.unrestricted||{},cc=S.optimize,ta=0;ta<At;ta+=1){var Ot=q[ta],ea=u[Ot],J1=ea[cc]||0,Ec=!!Ze[Ot],tN=!!St[Ot]||Ec,eN=!!Je[Ot],aa=this.addVariable(J1,Ot,tN,eN);Ec&&this.smallerThan(1).addTerm(1,aa);var Tc=Object.keys(ea);for(G=0;G<Tc.length;G+=1){var ee=Tc[G];if(ee!==cc){var _c=ea[ee],Ac=N[ee];Ac!==void 0&&Ac.addTerm(_c,aa);var Sc=L[ee];Sc!==void 0&&Sc.addTerm(_c,aa)}}}return this},A.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},A.prototype.solve=function(){return this.tableauInitialized===!1&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},A.prototype.isFeasible=function(){return this.tableau.feasible},A.prototype.save=function(){return this.tableau.save()},A.prototype.restore=function(){return this.tableau.restore()},A.prototype.activateMIRCuts=function(S){this.useMIRCuts=S},A.prototype.debug=function(S){this.checkForCycles=S},A.prototype.log=function(S){return this.tableau.log(S)}}}),Qc=K({"node_modules/@bygdle/javascript-lp-solver/src/Validation.js"(e){e.CleanObjectiveAttributes=function(a){var n,s,i;if(typeof a.optimize=="string")if(a.constraints[a.optimize]){n=Math.random();for(s in a.variables)a.variables[s][a.optimize]&&(a.variables[s][n]=a.variables[s][a.optimize]);return a.constraints[n]=a.constraints[a.optimize],delete a.constraints[a.optimize],a}else return a;else{for(i in a.optimize)if(a.constraints[i])if(a.constraints[i]==="equal")delete a.optimize[i];else{n=Math.random();for(s in a.variables)a.variables[s][i]&&(a.variables[s][n]=a.variables[s][i]);a.constraints[n]=a.constraints[i],delete a.constraints[i]}return a}}}}),re=K({"node_modules/@bygdle/javascript-lp-solver/src/External/lpsolve/Reformat.js"(e,a){function n(i){var l={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},E={opType:"",optimize:"_obj",constraints:{},variables:{}},_={">=":"min","<=":"max","=":"equal"},A="",S=null,u="",h="",N="",L=0;typeof i=="string"&&(i=i.split(`
`));for(var m=0;m<i.length;m++)if(N="__"+m,A=i[m],S=null,l.is_objective.test(A))E.opType=A.match(/(max|min)/gi)[0],S=A.match(l.parse_lhs).map(function(M){return M.replace(/\s+/,"")}).slice(1),S.forEach(function(M){u=M.match(l.get_num),u===null?M.substr(0,1)==="-"?u=-1:u=1:u=u[0],u=parseFloat(u),h=M.match(l.get_word)[0].replace(/\;$/,""),E.variables[h]=E.variables[h]||{},E.variables[h]._obj=u});else if(l.is_int.test(A))S=A.match(l.parse_int).slice(1),E.ints=E.ints||{},S.forEach(function(M){M=M.replace(";",""),E.ints[M]=1});else if(l.is_bin.test(A))S=A.match(l.parse_bin).slice(1),E.binaries=E.binaries||{},S.forEach(function(M){M=M.replace(";",""),E.binaries[M]=1});else if(l.is_constraint.test(A)){var C=A.indexOf(":"),G=C===-1?A:A.slice(C+1);S=G.match(l.parse_lhs).map(function(M){return M.replace(/\s+/,"")}),S.forEach(function(M){u=M.match(l.get_num),u===null?M.substr(0,1)==="-"?u=-1:u=1:u=u[0],u=parseFloat(u),h=M.match(l.get_word)[0],E.variables[h]=E.variables[h]||{},E.variables[h][N]=u}),L=parseFloat(A.match(l.parse_rhs)[0]),A=_[A.match(l.parse_dir)[0]],E.constraints[N]=E.constraints[N]||{},E.constraints[N][A]=L}else l.is_unrestricted.test(A)&&(S=A.match(l.parse_int).slice(1),E.unrestricted=E.unrestricted||{},S.forEach(function(M){M=M.replace(";",""),E.unrestricted[M]=1}));return E}function s(i){if(!i)throw new Error("Solver requires a model to operate on");var l="",E={max:"<=",min:">=",equal:"="},_=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(i.opType){l+=i.opType+":";for(var A in i.variables)i.variables[A][A]=i.variables[A][A]?i.variables[A][A]:1,i.variables[A][i.optimize]&&(l+=" "+i.variables[A][i.optimize]+" "+A.replace(_,"_"))}else l+="max:";l+=`;

`;for(var S in i.constraints)for(var u in i.constraints[S])if(typeof E[u]<"u"){for(var h in i.variables)typeof i.variables[h][S]<"u"&&(l+=" "+i.variables[h][S]+" "+h.replace(_,"_"));l+=" "+E[u]+" "+i.constraints[S][u],l+=`;
`}if(i.ints){l+=`

`;for(var N in i.ints)l+="int "+N.replace(_,"_")+`;
`}if(i.unrestricted){l+=`

`;for(var L in i.unrestricted)l+="unrestricted "+L.replace(_,"_")+`;
`}return l}a.exports=function(i){return i.length?n(i):s(i)}}}),$c=K({"node_modules/@bygdle/javascript-lp-solver/src/External/lpsolve/main.js"(e){e.reformat=re(),e.solve=function(a){return new Promise(function(n,s){typeof window<"u"&&s("Function Not Available in Browser"),re()(a),a.external||s("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),a.external.binPath||s("No Executable | Binary path provided in arguments as 'binPath'"),a.external.args||s("No arguments array for cli | bash provided on 'args' attribute"),a.external.tempName||s("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on")})}}}),Xc=K({"node_modules/@bygdle/javascript-lp-solver/src/External/main.js"(e,a){a.exports={lpsolve:$c()}}}),fa=K({"node_modules/@bygdle/javascript-lp-solver/src/Polyopt.js"(e,a){a.exports=function(n,s){var i=s.optimize,l=JSON.parse(JSON.stringify(s.optimize)),E=Object.keys(s.optimize),_,A=0,S={},u="",h={},N=[],L,m,C,G;for(delete s.optimize,L=0;L<E.length;L++)l[E[L]]=0;for(L=0;L<E.length;L++){s.optimize=E[L],s.opType=i[E[L]],_=n.Solve(s,void 0,void 0,!0);for(G in E)if(!s.variables[E[G]]){_[E[G]]=_[E[G]]?_[E[G]]:0;for(C in s.variables)s.variables[C][E[G]]&&_[C]&&(_[E[G]]+=_[C]*s.variables[C][E[G]])}for(u="base",m=0;m<E.length;m++)_[E[m]]?u+="-"+(_[E[m]]*1e3|0)/1e3:u+="-0";if(!S[u]){for(S[u]=1,A++,m=0;m<E.length;m++)_[E[m]]&&(l[E[m]]+=_[E[m]]);delete _.feasible,delete _.result,N.push(_)}}for(L=0;L<E.length;L++)s.constraints[E[L]]={equal:l[E[L]]/A};s.optimize="cheater-"+Math.random(),s.opType="max";for(L in s.variables)s.variables[L].cheater=1;for(L in N)for(C in N[L])h[C]=h[C]||{min:1e99,max:-1e99};for(L in h)for(C in N)N[C][L]?(N[C][L]>h[L].max&&(h[L].max=N[C][L]),N[C][L]<h[L].min&&(h[L].min=N[C][L])):(N[C][L]=0,h[L].min=0);return _=n.Solve(s,void 0,void 0,!0),{midpoint:_,vertices:N,ranges:h}}}}),Zc=K({"node_modules/@bygdle/javascript-lp-solver/src/main.js"(e,a){var n=qc(),s=zc(),i=Na(),l=ie(),E=Qc(),_=l.Constraint,A=l.Variable,S=l.Numeral,u=l.Term,h=Xc(),N=function(){this.Model=s,this.branchAndCut=i,this.Constraint=_,this.Variable=A,this.Numeral=S,this.Term=u,this.Tableau=n,this.lastSolvedModel=null,this.External=h,this.ReformatLP=re(),this.MultiObjective=function(L){return fa()(this,L)}};N.prototype.Solve=function(L,m,C,G){if(G)for(var M in E)L=E[M](L);if(!L)throw new Error("Solver requires a model to operate on");if(typeof L.optimize=="object"&&Object.keys(L.optimize>1))return fa()(this,L);if(L.external){var p=Object.keys(h);if(p=JSON.stringify(p),!L.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+p);if(!h[L.external.solver])throw new Error("No support (yet) for "+L.external.solver+". Please use one of these instead:"+p);return h[L.external.solver].solve(L)}else{L instanceof s||(L=new s(m).loadJson(L));var g=L.solve();if(g.solutionSet=g.generateSolutionSet(),C)return g;var D={};return D.feasible=g.feasible,D.result=g.evaluation,D.bounded=g.bounded,g._tableau.__isIntegral&&(D.isIntegral=!0),Object.keys(g.solutionSet).forEach(function(R){g.solutionSet[R]!==0&&(D[R]=g.solutionSet[R])}),D}},typeof define=="function"?define([],function(){return new N}):typeof window=="object"?window.solver=new N:typeof self=="object"&&(self.solver=new N),a.exports=new N}}),ma={};O(ma,{Runner:()=>We,api:()=>nc,artbox:()=>Et,artifact:()=>I,character:()=>Ma,characters:()=>Tt,charbox:()=>d,cmd2:()=>fn,effect:()=>r,effects:()=>Xt,enemy:()=>Ca,formula:()=>va,instance:()=>Sn,optimizer:()=>Xo,resonances:()=>Ln,rotation:()=>jt,scaling:()=>o,sets:()=>J,stats:()=>t,store:()=>It,strings:()=>T,subject:()=>Ra,utils:()=>oc,weapon:()=>f,weapons:()=>nt,worker:()=>bo});var Ma={};O(Ma,{Character:()=>me,Export:()=>_n,Import:()=>An});var Ca={};O(Ca,{Enemy:()=>Ia,EnemyConnector:()=>Oa,EnemyEvent:()=>lt,Export:()=>Se,Import:()=>Kt});var t={};O(t,{AuraToDmg:()=>_e,DmgToAtkFlat:()=>ce,DmgToAtkPercent:()=>le,DmgToAura:()=>eE,DmgToCritDmg:()=>Te,DmgToCritRate:()=>Ee,DmgToFlatDmg:()=>oe,DmgToRes:()=>bt,Elements:()=>ut,FlatStats:()=>da,Mainstats:()=>Jc,PieceToMainstats:()=>Ae,Substats:()=>pt,Swirlable:()=>tE,TrToDmg:()=>ga,aura:()=>F,piece:()=>X,region:()=>Ga,stat:()=>c,weapon:()=>pa});function at(...e){const a={},n={};let s=0;for(const i of e)a[i]=s,n[s]=i,s++;return st(z({},a),{Get(i){const l=a[i];if(l===void 0)throw new Error(`Stat not found: ${i}`);return l},Name(i){const l=n[i];if(l===void 0)throw new Error(`Stat not found: ${i}`);return l},Has(i){return Object.keys(a).includes(i)},Values(){return Object.values(a)},Length(){return e.length}})}var c=at("NONE","SHIELDED","ATK","ATK_BASE","ATK_PERCENT","ATK_FLAT","HP_CURRENT","HP","HP_BASE","HP_PERCENT","HP_FLAT","DEF","DEF_BASE","DEF_PERCENT","DEF_FLAT","ENERGY_CURRENT","ELEMENTAL_MASTERY","ENERGY_RECHARGE","HEALING_BONUS","CRIT_RATE","EXTRA_CRIT_RATE","CRIT_DMG","ALL_DMG","DEFIGNORED","DEFREDUCTION","DMG_FLAT","PYRO_DMG","CRYO_DMG","HYDRO_DMG","ELECTRO_DMG","ANEMO_DMG","GEO_DMG","DENDRO_DMG","PHYSICAL_DMG","PYRO_DMG_FLAT","CRYO_DMG_FLAT","HYDRO_DMG_FLAT","ELECTRO_DMG_FLAT","ANEMO_DMG_FLAT","GEO_DMG_FLAT","DENDRO_DMG_FLAT","PHYSICAL_DMG_FLAT","MELT_DMG","VAPORIZE_DMG","SWIRL_DMG","OVERLOAD_DMG","ELECTROCHARGE_DMG","SUPERCONDUCT_DMG","SHATTER_DMG","AGGRAVATE_DMG","SPREAD_DMG","BLOOM_DMG","HYPERBLOOM_DMG","BURGEON_DMG","BURNING_DMG","NORMAL_ATTACK_DMG","CHARGED_ATTACK_DMG","AIMED_SHOT_DMG","CHARGED_AIMED_SHOT_DMG","PLUNGE_ATTACK_DMG","ELEMENTAL_SKILL_DMG","ELEMENTAL_BURST_DMG","NORMAL_ATTACK_DMG_FLAT","CHARGED_ATTACK_DMG_FLAT","AIMED_SHOT_DMG_FLAT","CHARGED_AIMED_SHOT_DMG_FLAT","PLUNGE_ATTACK_DMG_FLAT","ELEMENTAL_SKILL_DMG_FLAT","ELEMENTAL_BURST_DMG_FLAT","NORMAL_ATTACK_LEVEL","ELEMENTAL_SKILL_LEVEL","ELEMENTAL_BURST_LEVEL","NORMAL_ATTACK_LEVEL_UP","ELEMENTAL_SKILL_LEVEL_UP","ELEMENTAL_BURST_LEVEL_UP","NORMAL_ATTACK_ATK_PERCENT","CHARGED_ATTACK_ATK_PERCENT","PLUNGE_ATTACK_ATK_PERCENT","AIMED_SHOT_ATK_PERCENT","CHARGED_AIMED_SHOT_ATK_PERCENT","ELEMENTAL_SKILL_ATK_PERCENT","ELEMENTAL_BURST_ATK_PERCENT","PYRO_ATK_PERCENT","CRYO_ATK_PERCENT","ELECTRO_ATK_PERCENT","HYDRO_ATK_PERCENT","GEO_ATK_PERCENT","ANEMO_ATK_PERCENT","DENDRO_ATK_PERCENT","PHYSICAL_ATK_PERCENT","NORMAL_ATTACK_ATK_FLAT","CHARGED_ATTACK_ATK_FLAT","PLUNGE_ATTACK_ATK_FLAT","AIMED_SHOT_ATK_FLAT","CHARGED_AIMED_SHOT_ATK_FLAT","ELEMENTAL_SKILL_ATK_FLAT","ELEMENTAL_BURST_ATK_FLAT","PYRO_ATK_FLAT","CRYO_ATK_FLAT","ELECTRO_ATK_FLAT","HYDRO_ATK_FLAT","GEO_ATK_FLAT","ANEMO_ATK_FLAT","DENDRO_ATK_FLAT","PHYSICAL_ATK_FLAT","NORMAL_ATTACK_CRIT_RATE","CHARGED_ATTACK_CRIT_RATE","PLUNGE_ATTACK_CRIT_RATE","AIMED_SHOT_CRIT_RATE","CHARGED_AIMED_SHOT_CRIT_RATE","ELEMENTAL_SKILL_CRIT_RATE","ELEMENTAL_BURST_CRIT_RATE","PYRO_CRIT_RATE","CRYO_CRIT_RATE","ELECTRO_CRIT_RATE","HYDRO_CRIT_RATE","GEO_CRIT_RATE","ANEMO_CRIT_RATE","DENDRO_CRIT_RATE","PHYSICAL_CRIT_RATE","NORMAL_ATTACK_CRIT_DMG","CHARGED_ATTACK_CRIT_DMG","PLUNGE_ATTACK_CRIT_DMG","AIMED_SHOT_CRIT_DMG","CHARGED_AIMED_SHOT_CRIT_DMG","ELEMENTAL_SKILL_CRIT_DMG","ELEMENTAL_BURST_CRIT_DMG","PYRO_CRIT_DMG","CRYO_CRIT_DMG","ELECTRO_CRIT_DMG","HYDRO_CRIT_DMG","GEO_CRIT_DMG","ANEMO_CRIT_DMG","DENDRO_CRIT_DMG","PHYSICAL_CRIT_DMG","LEVEL","ASCENSION","PYRO_RES","CRYO_RES","ELECTRO_RES","HYDRO_RES","GEO_RES","ANEMO_RES","DENDRO_RES","PHYSICAL_RES"),F=at("NONE","PYRO","CRYO","HYDRO","ELECTRO","DENDRO","FROZEN","QUICKEN"),pa=at("SWORD","CLAYMORE","POLEARM","CATALYST","BOW"),X=at("FLOWER","PLUME","SANDS","GOBLET","CIRCLET"),Ga=at("NONE","MONDSTADT","LIYUE","INAZUMA","SUMERU","FONTAINE","NATLAN","SNEZHNAYA","KHAENRIAH"),ut=[c.PYRO_DMG,c.CRYO_DMG,c.HYDRO_DMG,c.ELECTRO_DMG,c.ANEMO_DMG,c.GEO_DMG,c.DENDRO_DMG,c.PHYSICAL_DMG],Jc=[c.HP_FLAT,c.ATK_FLAT,c.ATK_PERCENT,c.HP_PERCENT,c.DEF_PERCENT,c.ENERGY_RECHARGE,c.ELEMENTAL_MASTERY,c.PYRO_DMG,c.CRYO_DMG,c.HYDRO_DMG,c.ELECTRO_DMG,c.ANEMO_DMG,c.GEO_DMG,c.DENDRO_DMG,c.PHYSICAL_DMG,c.CRIT_RATE,c.CRIT_DMG,c.HEALING_BONUS],pt=[c.DEF_FLAT,c.HP_FLAT,c.ATK_FLAT,c.ATK_PERCENT,c.HP_PERCENT,c.DEF_PERCENT,c.ENERGY_RECHARGE,c.ELEMENTAL_MASTERY,c.CRIT_RATE,c.CRIT_DMG],da=[c.SHIELDED,c.DEF,c.DEF_BASE,c.DEF_FLAT,c.HP,c.HP_BASE,c.HP_FLAT,c.ATK,c.ATK_BASE,c.ATK_FLAT,c.ELEMENTAL_MASTERY,c.DMG_FLAT,c.LEVEL,c.ASCENSION,c.NORMAL_ATTACK_LEVEL,c.ELEMENTAL_SKILL_LEVEL,c.ELEMENTAL_BURST_LEVEL,c.NORMAL_ATTACK_LEVEL_UP,c.ELEMENTAL_SKILL_LEVEL_UP,c.ELEMENTAL_BURST_LEVEL_UP,c.NORMAL_ATTACK_ATK_FLAT,c.CHARGED_ATTACK_ATK_FLAT,c.PLUNGE_ATTACK_ATK_FLAT,c.AIMED_SHOT_ATK_FLAT,c.CHARGED_AIMED_SHOT_ATK_FLAT,c.ELEMENTAL_SKILL_ATK_FLAT,c.ELEMENTAL_BURST_ATK_FLAT,c.PYRO_ATK_FLAT,c.CRYO_ATK_FLAT,c.ELECTRO_ATK_FLAT,c.HYDRO_ATK_FLAT,c.GEO_ATK_FLAT,c.ANEMO_ATK_FLAT,c.DENDRO_ATK_FLAT,c.PHYSICAL_DMG_FLAT,c.NORMAL_ATTACK_DMG_FLAT,c.CHARGED_ATTACK_DMG_FLAT,c.PLUNGE_ATTACK_DMG_FLAT,c.AIMED_SHOT_DMG_FLAT,c.CHARGED_AIMED_SHOT_DMG_FLAT,c.ELEMENTAL_SKILL_DMG_FLAT,c.ELEMENTAL_BURST_DMG_FLAT,c.PYRO_DMG_FLAT,c.CRYO_DMG_FLAT,c.ELECTRO_DMG_FLAT,c.HYDRO_DMG_FLAT,c.GEO_DMG_FLAT,c.ANEMO_DMG_FLAT,c.DENDRO_DMG_FLAT,c.PHYSICAL_DMG_FLAT],tE=[F.CRYO,F.PYRO,F.HYDRO,F.ELECTRO,F.FROZEN];function le(e){switch(e){case c.PYRO_DMG:return c.PYRO_ATK_PERCENT;case c.HYDRO_DMG:return c.HYDRO_ATK_PERCENT;case c.CRYO_DMG:return c.CRYO_ATK_PERCENT;case c.ELECTRO_DMG:return c.ELECTRO_ATK_PERCENT;case c.ANEMO_DMG:return c.ANEMO_ATK_PERCENT;case c.GEO_DMG:return c.GEO_ATK_PERCENT;case c.DENDRO_DMG:return c.DENDRO_ATK_PERCENT;case c.PHYSICAL_DMG:return c.PHYSICAL_ATK_PERCENT;case c.NORMAL_ATTACK_DMG:return c.NORMAL_ATTACK_ATK_PERCENT;case c.CHARGED_ATTACK_DMG:return c.CHARGED_ATTACK_ATK_PERCENT;case c.AIMED_SHOT_DMG:return c.AIMED_SHOT_ATK_PERCENT;case c.CHARGED_AIMED_SHOT_DMG:return c.CHARGED_AIMED_SHOT_ATK_PERCENT;case c.PLUNGE_ATTACK_DMG:return c.PLUNGE_ATTACK_ATK_PERCENT;case c.ELEMENTAL_SKILL_DMG:return c.ELEMENTAL_SKILL_ATK_PERCENT;case c.ELEMENTAL_BURST_DMG:return c.ELEMENTAL_BURST_ATK_PERCENT}return c.NONE}function oe(e){switch(e){case c.PYRO_DMG:return c.PYRO_DMG_FLAT;case c.HYDRO_DMG:return c.HYDRO_DMG_FLAT;case c.CRYO_DMG:return c.CRYO_DMG_FLAT;case c.ELECTRO_DMG:return c.ELECTRO_DMG_FLAT;case c.ANEMO_DMG:return c.ANEMO_DMG_FLAT;case c.GEO_DMG:return c.GEO_DMG_FLAT;case c.DENDRO_DMG:return c.DENDRO_DMG_FLAT;case c.PHYSICAL_DMG:return c.PHYSICAL_DMG_FLAT;case c.NORMAL_ATTACK_DMG:return c.NORMAL_ATTACK_DMG_FLAT;case c.CHARGED_ATTACK_DMG:return c.CHARGED_ATTACK_DMG_FLAT;case c.AIMED_SHOT_DMG:return c.AIMED_SHOT_DMG_FLAT;case c.CHARGED_AIMED_SHOT_DMG:return c.CHARGED_AIMED_SHOT_DMG_FLAT;case c.PLUNGE_ATTACK_DMG:return c.PLUNGE_ATTACK_DMG_FLAT;case c.ELEMENTAL_SKILL_DMG:return c.ELEMENTAL_SKILL_DMG_FLAT;case c.ELEMENTAL_BURST_DMG:return c.ELEMENTAL_BURST_DMG_FLAT}return c.NONE}function ce(e){switch(e){case c.PYRO_DMG:return c.PYRO_ATK_FLAT;case c.HYDRO_DMG:return c.HYDRO_ATK_FLAT;case c.CRYO_DMG:return c.CRYO_ATK_FLAT;case c.ELECTRO_DMG:return c.ELECTRO_ATK_FLAT;case c.ANEMO_DMG:return c.ANEMO_ATK_FLAT;case c.GEO_DMG:return c.GEO_ATK_FLAT;case c.DENDRO_DMG:return c.DENDRO_ATK_FLAT;case c.PHYSICAL_DMG:return c.PHYSICAL_ATK_FLAT;case c.NORMAL_ATTACK_DMG:return c.NORMAL_ATTACK_ATK_FLAT;case c.CHARGED_ATTACK_DMG:return c.CHARGED_ATTACK_ATK_FLAT;case c.AIMED_SHOT_DMG:return c.AIMED_SHOT_ATK_FLAT;case c.CHARGED_AIMED_SHOT_DMG:return c.CHARGED_AIMED_SHOT_ATK_FLAT;case c.PLUNGE_ATTACK_DMG:return c.PLUNGE_ATTACK_ATK_FLAT;case c.ELEMENTAL_SKILL_DMG:return c.ELEMENTAL_SKILL_ATK_FLAT;case c.ELEMENTAL_BURST_DMG:return c.ELEMENTAL_BURST_ATK_FLAT}return c.NONE}function Ee(e){switch(e){case c.PYRO_DMG:return c.PYRO_CRIT_RATE;case c.HYDRO_DMG:return c.HYDRO_CRIT_RATE;case c.CRYO_DMG:return c.CRYO_CRIT_RATE;case c.ELECTRO_DMG:return c.ELECTRO_CRIT_RATE;case c.ANEMO_DMG:return c.ANEMO_CRIT_RATE;case c.GEO_DMG:return c.GEO_CRIT_RATE;case c.DENDRO_DMG:return c.DENDRO_CRIT_RATE;case c.PHYSICAL_DMG:return c.PHYSICAL_CRIT_RATE;case c.NORMAL_ATTACK_DMG:return c.NORMAL_ATTACK_CRIT_RATE;case c.CHARGED_ATTACK_DMG:return c.CHARGED_ATTACK_CRIT_RATE;case c.AIMED_SHOT_DMG:return c.AIMED_SHOT_CRIT_RATE;case c.CHARGED_AIMED_SHOT_DMG:return c.CHARGED_AIMED_SHOT_CRIT_RATE;case c.PLUNGE_ATTACK_DMG:return c.PLUNGE_ATTACK_CRIT_RATE;case c.ELEMENTAL_SKILL_DMG:return c.ELEMENTAL_SKILL_CRIT_RATE;case c.ELEMENTAL_BURST_DMG:return c.ELEMENTAL_BURST_CRIT_RATE}return c.NONE}function Te(e){switch(e){case c.PYRO_DMG:return c.PYRO_CRIT_DMG;case c.HYDRO_DMG:return c.HYDRO_CRIT_DMG;case c.CRYO_DMG:return c.CRYO_CRIT_DMG;case c.ELECTRO_DMG:return c.ELECTRO_CRIT_DMG;case c.ANEMO_DMG:return c.ANEMO_CRIT_DMG;case c.GEO_DMG:return c.GEO_CRIT_DMG;case c.DENDRO_DMG:return c.DENDRO_CRIT_DMG;case c.PHYSICAL_DMG:return c.PHYSICAL_CRIT_DMG;case c.NORMAL_ATTACK_DMG:return c.NORMAL_ATTACK_CRIT_DMG;case c.CHARGED_ATTACK_DMG:return c.CHARGED_ATTACK_CRIT_DMG;case c.AIMED_SHOT_DMG:return c.AIMED_SHOT_CRIT_DMG;case c.CHARGED_AIMED_SHOT_DMG:return c.CHARGED_AIMED_SHOT_CRIT_DMG;case c.PLUNGE_ATTACK_DMG:return c.PLUNGE_ATTACK_CRIT_DMG;case c.ELEMENTAL_SKILL_DMG:return c.ELEMENTAL_SKILL_CRIT_DMG;case c.ELEMENTAL_BURST_DMG:return c.ELEMENTAL_BURST_CRIT_DMG}return c.NONE}function bt(e){switch(e){case c.PYRO_DMG:return c.PYRO_RES;case c.HYDRO_DMG:return c.HYDRO_RES;case c.CRYO_DMG:return c.CRYO_RES;case c.ELECTRO_DMG:return c.ELECTRO_RES;case c.ANEMO_DMG:return c.ANEMO_RES;case c.GEO_DMG:return c.GEO_RES;case c.DENDRO_DMG:return c.DENDRO_RES;case c.PHYSICAL_DMG:return c.PHYSICAL_RES}return c.NONE}function _e(e){switch(e){case F.PYRO:return c.PYRO_DMG;case F.HYDRO:return c.HYDRO_DMG;case F.CRYO:return c.CRYO_DMG;case F.FROZEN:return c.CRYO_DMG;case F.ELECTRO:return c.ELECTRO_DMG;case F.DENDRO:return c.DENDRO_DMG;case F.QUICKEN:return c.DENDRO_DMG}return c.NONE}function eE(e){switch(e){case c.PYRO_DMG:return F.PYRO;case c.HYDRO_DMG:return F.HYDRO;case c.CRYO_DMG:return F.CRYO;case c.ELECTRO_DMG:return F.ELECTRO;case c.DENDRO_DMG:return F.DENDRO}return c.NONE}function ga(e){switch(e){case c.OVERLOAD_DMG:return c.PYRO_DMG;case c.ELECTROCHARGE_DMG:return c.ELECTRO_DMG;case c.SUPERCONDUCT_DMG:return c.CRYO_DMG;case c.SHATTER_DMG:return c.PHYSICAL_DMG;case c.BURNING_DMG:return c.PYRO_DMG;case c.BURGEON_DMG:return c.DENDRO_DMG;case c.BLOOM_DMG:return c.DENDRO_DMG;case c.HYPERBLOOM_DMG:return c.DENDRO_DMG}return c.NONE}function Ae(e){switch(e){case X.FLOWER:return[c.HP_FLAT];case X.PLUME:return[c.ATK_FLAT];case X.SANDS:return[c.ATK_PERCENT,c.HP_PERCENT,c.DEF_PERCENT,c.ENERGY_RECHARGE,c.ELEMENTAL_MASTERY];case X.GOBLET:return[c.ATK_PERCENT,c.HP_PERCENT,c.DEF_PERCENT,c.ELEMENTAL_MASTERY,...ut];case X.CIRCLET:return[c.ATK_PERCENT,c.HP_PERCENT,c.DEF_PERCENT,c.ELEMENTAL_MASTERY,c.CRIT_RATE,c.CRIT_DMG,c.HEALING_BONUS]}return[]}var Ra={};O(Ra,{Subject:()=>it});var it=class{constructor(e,a){this.Title=a,this.props=new Float64Array(e),this.observers=Array.from(Array(e)).fill(0).map(()=>[])}Length(){return this.props.length}Get(e){const a=this.props[e];if(a===void 0)throw new Error(`Subject property out of bounds: ${e}`);return a}Set(e,a,n){return this.props[e]=a,this.Notify(e,n)}Notify(e,a){for(const n of this.observers[e])n.Enabled()&&n.Notify(a);return this}CreateObserver(e,a){let n=!0;const s={prop:e,Enabled(){return n},Enable(){return n=!0,s},Disable(){return n=!1,s},Remove:()=>this.RemoveObserver(s),Notify(i){return a(i),s}};return this.observers[e].push(s),s}RemoveObserver(e){const a=this.observers[e.prop].indexOf(e);return a===-1?!1:(this.observers[e.prop].splice(a,1),!0)}CreateModifier(e,a){let n=!1;const s={Title:this.Title,Enabled(){return n},Enable:()=>(n||(this.Set(e,this.Get(e)+a,s),n=!0),s),Disable:()=>(n&&(this.Set(e,this.Get(e)-a,s),n=!1),s),GetProp(){return e},GetValue(){return a},SetProp(i){const l=n;return s.Disable(),e=i,l&&s.Enable(),s},SetValue(i){const l=n;return s.Disable(),a=i,l&&s.Enable(),s}};return s.Enable(),s}},lt=at("CHANGE_AURA","CHANGE_BASE_RES"),Ia=class{constructor(e){this.name=e,this.Event=new it(lt.Length(),"ENEMY_EVENT"),this.Subject=new it(c.Length(),"ENEMY_STATS"),this.auras=[],this.baseMods=ut.map(a=>this.Subject.CreateModifier(bt(a),.1)),this.SetLevel(90)}GetLevel(){return this.Subject.Get(c.LEVEL)}SetLevel(e){return this.Subject.Set(c.LEVEL,e),this}Affected(e){for(const a of this.auras)if(_e(a)===e)return!0;return!1}HasAura(e){return this.auras.includes(e)}SetAuras(...e){return this.auras=e,this.Event.Notify(lt.CHANGE_AURA),this}GetAuras(){return this.auras}GetBaseRes(e){const a=this.baseMods.find(n=>n.GetProp()===e);if(!a)throw new Error(`Cannot find the given RES: ${e}`);return a.GetValue()}SetBaseRes(e,a){const n=this.baseMods.find(s=>s.GetProp()===e);if(!n)throw new Error(`Cannot find the given RES: ${e}`);return n.SetValue(a),this.Event.Notify(lt.CHANGE_BASE_RES),this}};function Se(e){const a={level:e.GetLevel(),auras:e.GetAuras(),modifiers:[]};for(const n of ut){const s=bt(n),i=e.GetBaseRes(s);a.modifiers.push({stat:s,value:i})}return a}function Kt(e,a){a.SetLevel(e.level),a.SetAuras(...e.auras);for(const{stat:n,value:s}of e.modifiers)a.SetBaseRes(n,s)}var Oa=class{constructor(...e){this.members=new Set,this.observers=new Map,this.updating=!1,e.forEach(a=>this.Add(a))}onChange(e){if(this.updating)return;const a=this.state=Se(e);this.updating=!0;for(const n of this.members)n!==e&&Kt(a,n);this.updating=!1}Add(e){if(this.members.has(e))return!1;const a=this.members.size===0;this.members.add(e),!a&&this.state&&Kt(this.state,e);const n=()=>this.onChange(e);return this.observers.set(e,[e.Subject.CreateObserver(c.LEVEL,n),e.Event.CreateObserver(lt.CHANGE_AURA,n),e.Event.CreateObserver(lt.CHANGE_BASE_RES,n)]),!0}Remove(e){this.members.delete(e);const a=this.observers.get(e);!a||(a.forEach(n=>n.Remove()),this.observers.delete(e))}},wt=[20,40,50,60,70,80,90];function Yt(e){e<0?e=0:e>90&&(e=90);for(let a=0;a<wt.length;a++){const n=wt[a];if(e<=n)return a}return 0}function ht(e){e<0?e=0:e>90&&(e=90);for(let a=0;a<wt.length;a++){const n=wt[a];if(e===n){let s=a+1;return s>6&&(s=6),s}else if(e<=n)return a}return 0}var Da={[c.PYRO_DMG]:3,[c.CRYO_DMG]:2,[c.ELECTRO_DMG]:1};function aE(e){return[...e].sort((n,s)=>{const i=n.Max?1/0:Da[n.Element]||0;return(s.Max?1/0:Da[s.Element]||0)-i}).filter(n=>n.Enabled)[0]}var va={};O(va,{AmpBonus:()=>en,AmpType:()=>rn,CritAvg:()=>Za,CritType:()=>sn,Damage:()=>En,DamageOptions:()=>cn,DamageStats:()=>on,Def:()=>tn,QuickenBonus:()=>fe,QuickenType:()=>ln,Res:()=>Ja,Rotation:()=>Tn,TotalStat:()=>gt,TrBase:()=>Ft,TrBonus:()=>an,TrMultiplier:()=>nn});var o={};O(o,{ASCENSION_MULTIPLIER:()=>Ba,AddCharacterScaling:()=>wa,AddTalentScaling:()=>Fa,BONUS_ASCENSION_MULTIPLIER:()=>ue,BONUS_STAT_4:()=>ba,BONUS_STAT_5:()=>Ka,CHARACTER_ATTRIBUTE_4:()=>Ha,CHARACTER_ATTRIBUTE_5:()=>Pa,GetMainstatValue:()=>$a,GetMaxRolls:()=>cE,GetSubstatMax:()=>Ne,GetSubstatMaxRolls:()=>Le,GetSubstatValue:()=>Z,GetWeaponAtkBase:()=>za,GetWeaponSubstat:()=>Qa,SubstatTier:()=>Xa,TRANSFORMATIVE:()=>ya,TalentScaling:()=>Ya,WEAPON_ATK_BASE:()=>xa,WEAPON_ATK_BASE_ASCENSION_3:()=>ka,WEAPON_ATK_BASE_ASCENSION_4:()=>Ua,WEAPON_ATK_BASE_ASCENSION_5:()=>Wa,WEAPON_SUBSTAT_INITIAL:()=>qa,WEAPON_SUBSTAT_SCALING:()=>ja,WeaponScaling:()=>Va});function nE(e){return e}var ya=[8.5828025,9.267524,9.952427,10.6374515,11.3227,12.3248065,13.3203215,14.4342935,15.6838395,17.0716715,18.6005,20.33,22.223334,24.2817595,26.87424,29.5409485,32.2100235,34.8622275,37.5615685,40.2923875,43.056014,45.851871,48.622314,51.406322,54.2047815,56.600847,59.051453,61.489659,64.863665,68.146455,71.335425,74.5145145,77.7084935,80.9127475,84.5531565,88.2590385,92.0363705,95.854759,99.778454,103.691021,107.69945,112.0828335,116.75108,121.6752865,128.0315335,134.2717465,140.7630375,147.506824,154.533594,161.8007985,168.378771,175.265156,182.2413525,189.3095905,199.3002085,208.199127,217.193498,226.4755255,236.3031085,246.442445,256.7842715,269.551599,282.7552815,296.2693765,312.2217135,325.735074,339.748415,353.89703,368.335711,382.8201155,397.3867015,412.3386985,425.5788905,438.871045,457.1145615,473.373376,489.705693,505.611511,522.395873,538.721834,554.99877,571.4883075,588.1847415,605.0921965,626.9178295,644.4764005,662.742046,681.728464,702.5486885,723.426729,744.1077735,764.2222835,790.1839555,815.423764,855.5988925,890.2269705,923.6614045,955.7371545,986.432171,1015.035904],Ha=[1,1.083,1.165,1.248,1.33,1.413,1.495,1.578,1.661,1.743,1.826,1.908,1.991,2.073,2.156,2.239,2.321,2.404,2.486,2.569,2.651,2.734,2.817,2.899,2.982,3.064,3.147,3.229,3.312,3.394,3.477,3.56,3.642,3.725,3.807,3.89,3.972,4.055,4.138,4.22,4.303,4.385,4.468,4.55,4.633,4.716,4.798,4.881,4.963,5.046,5.128,5.211,5.294,5.376,5.459,5.541,5.624,5.706,5.789,5.872,5.954,6.037,6.119,6.202,6.284,6.367,6.45,6.532,6.615,6.697,6.78,6.862,6.945,7.028,7.11,7.193,7.275,7.358,7.44,7.523,7.606,7.688,7.771,7.853,7.936,8.018,8.101,8.183,8.266,8.349],Pa=[1,1.083,1.166,1.25,1.333,1.417,1.5,1.584,1.668,1.751,1.835,1.919,2.003,2.088,2.172,2.256,2.341,2.425,2.51,2.594,2.679,2.764,2.849,2.934,3.019,3.105,3.19,3.275,3.361,3.446,3.532,3.618,3.704,3.789,3.875,3.962,4.048,4.134,4.22,4.307,4.393,4.48,4.567,4.653,4.74,4.827,4.914,5.001,5.089,5.176,5.263,5.351,5.438,5.526,5.614,5.702,5.79,5.878,5.966,6.054,6.142,6.23,6.319,6.407,6.496,6.585,6.673,6.762,6.851,6.94,7.029,7.119,7.208,7.297,7.387,7.476,7.566,7.656,7.746,7.836,7.926,8.016,8.106,8.196,8.286,8.377,8.467,8.558,8.649,8.739],Ba=[38/182,65/182,101/182,128/182,155/182,1],ue=[0,1,2,2,3,4],ba={[c.ATK_PERCENT]:.06,[c.HP_PERCENT]:.06,[c.DEF_PERCENT]:.075,[c.PHYSICAL_DMG]:.075,[c.ENERGY_RECHARGE]:.067,[c.ELEMENTAL_MASTERY]:24,[c.PYRO_DMG]:.06,[c.CRYO_DMG]:.06,[c.HYDRO_DMG]:.06,[c.ELECTRO_DMG]:.06,[c.ANEMO_DMG]:.06,[c.GEO_DMG]:.06,[c.DENDRO_DMG]:.06,[c.PHYSICAL_DMG]:.06},Ka={[c.ATK_PERCENT]:.072,[c.HP_PERCENT]:.072,[c.PHYSICAL_DMG]:0,[c.ENERGY_RECHARGE]:.08,[c.ELEMENTAL_MASTERY]:28.8,[c.HEALING_BONUS]:.055,[c.CRIT_RATE]:.048,[c.CRIT_DMG]:.096,[c.PYRO_DMG]:.072,[c.CRYO_DMG]:.072,[c.HYDRO_DMG]:.072,[c.ELECTRO_DMG]:.072,[c.ANEMO_DMG]:.072,[c.GEO_DMG]:.072,[c.DENDRO_DMG]:.072,[c.PHYSICAL_DMG]:.072};function wa(e,a){const n=e.CreateModifier(c.ATK_BASE,0),s=e.CreateModifier(c.DEF_BASE,0),i=e.CreateModifier(c.HP_BASE,0),l=e.CreateModifier(a.StatBonus,0);a.Scaling||(e.Options.Stars===4?a.Scaling=Ha:a.Scaling=Pa);const E=a.Scaling,_=()=>{n.SetValue(he(E,a.AtkBase[0],a.AtkBase[1],e.GetLevel(),e.GetAscension())),s.SetValue(he(E,a.DefBase[0],a.DefBase[1],e.GetLevel(),e.GetAscension())),i.SetValue(he(E,a.HpBase[0],a.HpBase[1],e.GetLevel(),e.GetAscension())),l.SetValue(rE(e.Options.Stars,a.StatBonus,e.GetAscension()))};return _(),e.CreateObserver(c.LEVEL,_),e.CreateObserver(c.ASCENSION,_),e}function sE(e,a){return e[a-1]}function iE(e){const a=e-1;return a<0?0:Ba[a]}function he(e,a,n,s,i){return a*sE(e,s)+n*iE(i)}function rE(e,a,n){const s=n-1;return s<0?0:e===4?ba[a]*ue[s]:Ka[a]*ue[s]}var Ya={NONE:Array.from(Array(15)).fill(1),PHYSICAL_1:[1,1.081,1.163,1.279,1.36,1.453,1.581,1.709,1.837,1.977,2.116,2.256,2.395,2.535,2.674],PHYSICAL_1A:[1,1.081,1.163,1.279,1.36,1.453,1.581,1.709,1.837,1.977,2.137,2.325,2.513,2.701,2.906],PHYSICAL_2:[1,1.068,1.136,1.227,1.295,1.375,1.477,1.58,1.682,1.784,1.886,1.989,2.091,2.193,2.295],ELEMENTAL_1:[1,1.075,1.15,1.25,1.325,1.4,1.5,1.6,1.7,1.8,1.9,2,2.125,2.25,2.375],ELEMENTAL_1A:[1,1.075,1.15,1.25,1.325,1.4,1.5,1.6,1.7,1.8,1.904,2.04,2.176,2.312,2.448],ELEMENTAL_2:[1,1.06,1.12,1.198,1.257,1.317,1.395,1.473,1.551,1.629,1.707,1.784,1.862,1.94,2.018],FLAT_1:[1,1.1,1.208,1.325,1.45,1.583,1.725,1.875,2.033,2.2,2.375,2.559,2.75,2.95,3.159]};function Fa(e,a){const n=[],s=e.Base.CreateMv(a.Stat,0),i=()=>{let E=e.Get(a.Talent);E<1?E=1:E>15&&(E=15),s.Value=a.Initial*a.Scaling[E-1]};i();const l=e.Character;switch(n.push(l.CreateObserver(a.Talent,i)),a.Talent){case c.NORMAL_ATTACK_LEVEL:n.push(l.CreateObserver(c.NORMAL_ATTACK_LEVEL_UP,i));break;case c.ELEMENTAL_SKILL_LEVEL:n.push(l.CreateObserver(c.ELEMENTAL_SKILL_LEVEL_UP,i));break;case c.ELEMENTAL_BURST_LEVEL:n.push(l.CreateObserver(c.ELEMENTAL_BURST_LEVEL_UP,i));break}return n}var Va=(e=>(e[e.TYPE_38=0]="TYPE_38",e[e.TYPE_39=1]="TYPE_39",e[e.TYPE_40=2]="TYPE_40",e[e.TYPE_39b=3]="TYPE_39b",e[e.TYPE_41=4]="TYPE_41",e[e.TYPE_42=5]="TYPE_42",e[e.TYPE_44=6]="TYPE_44",e[e.TYPE_45=7]="TYPE_45",e[e.TYPE_44b=8]="TYPE_44b",e[e.TYPE_46=9]="TYPE_46",e[e.TYPE_48=10]="TYPE_48",e[e.TYPE_49=11]="TYPE_49",e))(Va||{}),xa={[0]:[37.6075,40.13116315789474,42.65482631578948,45.17848947368421,47.70215263157895,50.225815789473685,52.749478947368424,55.27314210526316,57.79680526315789,60.32046842105264,62.84413157894737,65.36779473684211,67.89145789473685,70.41512105263158,72.93878421052631,75.46244736842105,77.9861105263158,80.50977368421053,83.03343684210526,85.5571,87.86808,90.17906,92.49004000000001,94.80102000000001,97.11200000000001,99.42298000000001,101.73396,104.04494,106.35592,108.6669,110.97788,113.28886,115.59984,117.91082,120.2218,122.53278,124.84376,127.15474,129.46572,131.7767,133.97050000000002,136.1643,138.3581,140.5519,142.7457,144.9395,147.1333,149.3271,151.52089999999998,153.7147,155.86208,158.00946,160.15684,162.30422,164.45159999999998,166.59898,168.74636,170.89374,173.04112,175.1885,177.28829000000002,179.38808,181.48787,183.58766,185.68745,187.78724,189.88702999999998,191.98682,194.08661,196.1864,198.26233,200.33826,202.41419,204.49012,206.56605,208.64198,210.71791,212.79384,214.86977,216.9457,218.98907,221.03243999999998,223.07581,225.11918,227.16255,229.20592,231.24929,233.29266,235.33603,237.3794],[1]:[38.7413,41.636700000000005,44.5321,47.4275,50.322900000000004,53.2183,56.1137,59.009100000000004,61.9045,64.79990000000001,67.6953,70.5907,73.4861,76.3815,79.27690000000001,82.1723,85.0677,87.9631,90.85849999999999,93.7539,96.5549,99.3559,102.15690000000001,104.9579,107.7589,110.5599,113.3609,116.1619,118.96289999999999,121.7639,124.5649,127.3659,130.1669,132.9679,135.7689,138.5699,141.3709,144.1719,146.97289999999998,149.7739,152.50678,155.23966,157.97254,160.70542,163.4383,166.17118,168.90406,171.63694,174.36982,177.1027,179.81459,182.52648,185.23837,187.95026,190.66215,193.37403999999998,196.08593,198.79782,201.50970999999998,204.2216,206.90025,209.5789,212.25755,214.9362,217.61485,220.2935,222.97215,225.6508,228.32945,231.0081,233.68512,236.36214,239.03916,241.71618,244.3932,247.07022,249.74724,252.42426,255.10128,257.7783,260.42983,263.08136,265.73289,268.38442000000003,271.03595,273.68748,276.33901000000003,278.99054,281.64207000000005,284.2936],[2]:[39.8751,43.142757894736846,46.41041578947369,49.67807368421053,52.945731578947374,56.21338947368422,59.48104736842105,62.748705263157895,66.01636315789474,69.28402105263157,72.55167894736843,75.81933684210526,79.0869947368421,82.35465263157894,85.62231052631579,88.88996842105263,92.15762631578947,95.42528421052631,98.69294210526316,101.9606,105.248305,108.53601,111.82371499999999,115.11142,118.399125,121.68683,124.974535,128.26224,131.549945,134.83765,138.125355,141.41306,144.700765,147.98847,151.276175,154.56387999999998,157.851585,161.13929,164.426995,167.7147,170.99041,174.26612,177.54183,180.81754,184.09325,187.36896000000002,190.64467,193.92038,197.19609,200.4718,203.74953,207.02726,210.30499,213.58272,216.86045000000001,220.13818,223.41591,226.69364,229.97137,233.2491,236.51284,239.77658,243.04032,246.30406,249.5678,252.83154000000002,256.09528,259.35902,262.62276,265.8865,269.15626000000003,272.42602,275.69578,278.96554,282.2353,285.50506,288.77482,292.04458,295.31433999999996,298.5841,301.84785,305.1116,308.37534999999997,311.6391,314.90285,318.1666,321.43035000000003,324.6941,327.95785,331.2216],[3]:[38.7413,41.636700000000005,44.5321,47.4275,50.322900000000004,53.2183,56.1137,59.009100000000004,61.9045,64.79990000000001,67.6953,70.5907,73.4861,76.3815,79.27690000000001,82.1723,85.0677,87.9631,90.85849999999999,93.7539,96.5549,99.3559,102.15690000000001,104.9579,107.7589,110.5599,113.3609,116.1619,118.96289999999999,121.7639,124.5649,127.3659,130.1669,132.9679,135.7689,138.5699,141.3709,144.1719,146.97289999999998,149.7739,152.52678,155.27966,158.03253999999998,160.78542,163.5383,166.29118,169.04406,171.79693999999998,174.54981999999998,177.3027,180.01459,182.72647999999998,185.43837,188.15026,190.86214999999999,193.57404,196.28593,198.99782000000002,201.70971,204.4216,207.11025,209.7989,212.48755,215.1762,217.86485,220.55349999999999,223.24215,225.9308,228.61945,231.3081,233.99512,236.68214,239.36916,242.05617999999998,244.7432,247.43022,250.11723999999998,252.80425999999997,255.49128,258.1783,260.83983,263.50136,266.16289,268.82442,271.48595,274.14748000000003,276.80901,279.47054,282.13207,284.7936],[4]:[41.0671,44.129842105263165,47.19258421052632,50.255326315789475,53.31806842105264,56.3808105263158,59.44355263157895,62.50629473684211,65.56903684210528,68.63177894736843,71.69452105263159,74.75726315789476,77.8200052631579,80.88274736842106,83.94548947368422,87.00823157894737,90.07097368421054,93.13371578947368,96.19645789473685,99.2592,102.18523,105.11126,108.03729000000001,110.96332000000001,113.88935000000001,116.81538,119.74141,122.66744,125.59347,128.5195,131.44553,134.37156,137.29759,140.22361999999998,143.14965,146.07568,149.00171,151.92774,154.85377,157.7798,160.65627999999998,163.53276,166.40924,169.28572,172.16219999999998,175.03868,177.91516000000001,180.79164,183.66812,186.5446,189.38234,192.22008,195.05782,197.89556,200.73329999999999,203.57103999999998,206.40878,209.24652,212.08426,214.922,217.7351,220.5482,223.3613,226.1744,228.9875,231.8006,234.6137,237.4268,240.2399,243.053,245.86377,248.67454,251.48531,254.29608000000002,257.10685,259.91762,262.72839,265.53916000000004,268.34993000000003,271.1607,273.94095000000004,276.7212,279.50145,282.2817,285.06195,287.8422,290.62244999999996,293.4027,296.18295,298.9632],[5]:[42.401,45.90243157894737,49.40386315789474,52.90529473684211,56.40672631578948,59.908157894736846,63.40958947368421,66.91102105263158,70.41245263157894,73.91388421052632,77.41531578947368,80.91674736842106,84.41817894736842,87.91961052631578,91.42104210526315,94.92247368421053,98.42390526315789,101.92533684210525,105.42676842105263,108.9282,112.42840000000001,115.9286,119.4288,122.929,126.42920000000001,129.9294,133.4296,136.9298,140.43,143.9302,147.4304,150.9306,154.4308,157.93099999999998,161.4312,164.9314,168.4316,171.9318,175.432,178.9322,182.44453,185.95686,189.46919,192.98152,196.49385,200.00618,203.51851,207.03083999999998,210.54317,214.0555,217.55782,221.06014,224.56246,228.06477999999998,231.56709999999998,235.06941999999998,238.57174,242.07406,245.57638,249.0787,252.57677999999999,256.07486,259.57294,263.07102,266.5691,270.06718,273.56526,277.06334000000004,280.56142,284.0595,287.57182,291.08414,294.59646000000004,298.10878,301.6211,305.13342,308.64574,312.15806000000003,315.67038,319.1827,322.68503,326.18736,329.68969000000004,333.19202,336.69435,340.19668,343.69901000000004,347.20134,350.70367,354.206],[6]:[43.7349,47.67334210526316,51.61178421052632,55.55022631578947,59.48866842105264,63.42711052631579,67.36555263157895,71.30399473684211,75.24243684210526,79.18087894736843,83.11932105263159,87.05776315789474,90.99620526315789,94.93464736842105,98.87308947368422,102.81153157894738,106.74997368421053,110.68841578947368,114.62685789473684,118.5653,122.64139499999999,126.71749,130.793585,134.86968,138.945775,143.02187,147.097965,151.17406,155.250155,159.32625000000002,163.402345,167.47844,171.554535,175.63063,179.706725,183.78282000000002,187.858915,191.93501,196.011105,200.0872,204.23452,208.38183999999998,212.52916,216.67648,220.8238,224.97111999999998,229.11844,233.26576,237.41307999999998,241.5604,245.72395999999998,249.88752,254.05108,258.21464000000003,262.3782,266.54176,270.70532000000003,274.86888,279.03244,283.196,287.38581000000005,291.57562,295.76543000000004,299.95524,304.14505,308.33486000000005,312.52467,316.71448000000004,320.90429,325.0941,329.30702,333.51994,337.73286,341.94578,346.1587,350.37162,354.58454,358.79746,363.01038,367.2233,371.43934,375.65538,379.87142,384.08745999999996,388.3035,392.51954,396.73557999999997,400.95162,405.16765999999996,409.3837],[7]:[45.0687,49.44510526315789,53.82151052631579,58.19791578947368,62.574321052631575,66.95072631578947,71.32713157894736,75.70353684210527,80.07994210526316,84.45634736842105,88.83275263157896,93.20915789473685,97.58556315789474,101.96196842105263,106.33837368421052,110.71477894736842,115.09118421052631,119.4675894736842,123.84399473684209,128.2204,132.87149000000002,137.52258,142.17367000000002,146.82476,151.47585,156.12694,160.77803,165.42912,170.08021,174.7313,179.38239,184.03348,188.68457,193.33566000000002,197.98675,202.63783999999998,207.28893,211.94002,216.59111000000001,221.2422,226.02498,230.80776,235.59054,240.37332,245.15609999999998,249.93887999999998,254.72165999999999,259.50444,264.28722,269.07,273.89686,278.72372,283.55057999999997,288.37744,293.2043,298.03116,302.85802,307.68487999999996,312.51174,317.3386,322.21052,327.08243999999996,331.95436,336.82628,341.6982,346.57012,351.44203999999996,356.31396,361.18588,366.0578,370.97578,375.89376,380.81174,385.72972,390.6477,395.56568,400.48366,405.40164,410.31962,415.2376,420.17714,425.11668,430.05622,434.99575999999996,439.9353,444.87484,449.81437999999997,454.75392,459.69345999999996,464.633],[8]:[44.3358,47.80099473684211,51.26618947368421,54.731384210526315,58.196578947368415,61.66177368421052,65.12696842105262,68.59216315789473,72.05735789473684,75.52255263157895,78.98774736842105,82.45294210526315,85.91813684210526,89.38333157894735,92.84852631578946,96.31372105263156,99.77891578947367,103.24411052631578,106.70930526315789,110.1745,113.601655,117.02881,120.45596499999999,123.88311999999999,127.31027499999999,130.73743,134.164585,137.59174,141.018895,144.44605,147.87320499999998,151.30036,154.72751499999998,158.15467,161.581825,165.00898,168.436135,171.86329,175.290445,178.7176,182.17136,185.62512,189.07888,192.53264000000001,195.9864,199.44016,202.89392,206.34768,209.80144,213.2552,216.74556,220.23592,223.72628,227.21664,230.707,234.19736,237.68772,241.17808000000002,244.66844,248.1588,251.6835,255.2082,258.73290000000003,262.2576,265.7823,269.307,272.8317,276.3564,279.8811,283.4058,286.97039,290.53498,294.09956999999997,297.66416,301.22875,304.79334,308.35793,311.92251999999996,315.48711,319.0517,322.66951,326.28731999999997,329.90513,333.52294,337.14075,340.75856,344.37637,347.99418000000003,351.61199,355.2298],[9]:[45.9364,49.92561578947368,53.914831578947364,57.90404736842105,61.89326315789474,65.88247894736841,69.8716947368421,73.86091052631579,77.85012631578947,81.83934210526316,85.82855789473683,89.81777368421052,93.80698947368421,97.79620526315789,101.78542105263158,105.77463684210525,109.76385263157894,113.75306842105263,117.74228421052632,121.7315,125.849695,129.96789,134.086085,138.20428,142.322475,146.44067,150.558865,154.67706,158.795255,162.91345,167.031645,171.14984,175.268035,179.38623,183.50442500000003,187.62262,191.740815,195.85901,199.97720500000003,204.0954,208.30777,212.52014,216.73251000000002,220.94488,225.15725,229.36962,233.58199,237.79435999999998,242.00673,246.2191,250.51037,254.80164,259.09291,263.38418,267.67545,271.96672,276.25799,280.54926,284.84053,289.1318,293.47739,297.82298,302.16857,306.51416,310.85974999999996,315.20534,319.55093,323.89652,328.24210999999997,332.5877,337.00219,341.41668,345.83117,350.24566,354.66015,359.07464,363.48913,367.90362,372.31811,376.7326,381.2068,385.681,390.1552,394.6294,399.10360000000003,403.5778,408.052,412.5262,417.0004,421.4746],[10]:[47.537,52.05051052631579,56.564021052631574,61.077531578947365,65.59104210526316,70.10455263157894,74.61806315789474,79.13157368421052,83.6450842105263,88.1585947368421,92.6721052631579,97.18561578947367,101.69912631578947,106.21263684210527,110.72614736842104,115.23965789473684,119.75316842105264,124.2666789473684,128.7801894736842,133.2937,138.10207,142.91044,147.71881,152.52718,157.33555,162.14391999999998,166.95229,171.76066,176.56903,181.3774,186.18577,190.99414,195.80250999999998,200.61088,205.41924999999998,210.22762,215.03598999999997,219.84436,224.65273,229.4611,234.43822,239.41534,244.39246,249.36957999999998,254.3467,259.32382,264.30094,269.27806,274.25518,279.2323,284.31925,289.4062,294.49315,299.5801,304.66705,309.754,314.84095,319.9279,325.01485,330.1018,335.27383000000003,340.44586000000004,345.61789,350.78992,355.96195,361.13398,366.30601,371.47803999999996,376.65006999999997,381.8221,387.07493999999997,392.32777999999996,397.58062,402.83346,408.0863,413.33914,418.59198,423.84482,429.09766,434.3505,439.6889,445.0273,450.3657,455.70410000000004,461.0425,466.3809,471.71930000000003,477.0577,482.39610000000005,487.7345],[11]:[49.1377,54.17819473684211,59.218689473684215,64.25918421052631,69.29967894736842,74.34017368421053,79.38066842105263,84.42116315789474,89.46165789473685,94.50215263157895,99.54264736842106,104.58314210526316,109.62363684210527,114.66413157894738,119.70462631578948,124.74512105263159,129.7856157894737,134.8261105263158,139.8666052631579,144.9071,150.40315,155.8992,161.39525,166.8913,172.38735000000003,177.8834,183.37945000000002,188.87550000000002,194.37155,199.8676,205.36365,210.8597,216.35575,221.85180000000003,227.34785,232.84390000000002,238.33995,243.836,249.33205,254.8281,260.56738,266.30666,272.04594,277.78522,283.5245,289.26378,295.00306,300.74233999999996,306.48161999999996,312.2209,318.10776999999996,323.99464,329.88151,335.76838,341.65525,347.54212,353.42899,359.31586,365.20273000000003,371.0896,377.07949,383.06938,389.05927,395.04916000000003,401.03905,407.02894000000003,413.01883,419.00872,424.99861,430.9885,437.09139999999996,443.1943,449.2972,455.4001,461.503,467.6059,473.7088,479.8117,485.9146,492.0175,498.21376999999995,504.41004,510.60631,516.80258,522.99885,529.19512,535.39139,541.5876599999999,547.7839299999999,553.9802]},ka=19.5,Ua=25.9,Wa=31.1,ja=[1,1.040341234845879,1.0806824696917579,1.1210237045376368,1.1613649393835157,1.2017061742293946,1.2420474090752736,1.2823886439211527,1.3227298787670316,1.3630711136129106,1.4034123484587895,1.4437535833046684,1.4840948181505473,1.5244360529964263,1.5647772878423054,1.6051185226881843,1.6454597575340633,1.6858009923799422,1.7261422272258211,1.7664834620717,1.806904148964199,1.847324835856698,1.887745522749197,1.928166209641696,1.968586896534195,2.009007583426694,2.049428270319193,2.089848957211692,2.130269644104191,2.17069033099669,2.211111017889189,2.251531704781688,2.291952391674187,2.332373078566686,2.372793765459185,2.413214452351684,2.453635139244183,2.494055826136682,2.534476513029181,2.57489719992168,2.615292358123214,2.655687516324748,2.696082674526282,2.7364778327278163,2.77687299092935,2.817268149130884,2.8576633073324182,2.898058465533952,2.9384536237354864,2.97884878193702,3.0192357768865152,3.0596227718360103,3.1000097667855053,3.1403967617350004,3.1807837566844954,3.22117075163399,3.261557746583485,3.30194474153298,3.342331736482475,3.38271873143197,3.423020746682514,3.463322761933058,3.503624777183602,3.543926792434146,3.58422880768469,3.624530822935234,3.664832838185778,3.705134853436322,3.745436868686866,3.78573888393741,3.82613895285716,3.86653902177691,3.90693909069666,3.94733915961641,3.98773922853616,4.02813929745591,4.06853936637566,4.10893943529541,4.14933950421516,4.18973957313491,4.230135108674366,4.270530644213822,4.310926179753277,4.351321715292734,4.3917172508321904,4.432112786371646,4.472508321911102,4.512903857450558,4.553299392990015,4.59369492852947],qa={[0]:{[c.ATK_PERCENT]:.10213,[c.HP_PERCENT]:.10213,[c.DEF_PERCENT]:.12747,[c.ELEMENTAL_MASTERY]:40.8,[c.ENERGY_RECHARGE]:.11333,[c.CRIT_RATE]:.068,[c.CRIT_DMG]:.136,[c.PHYSICAL_DMG]:.12747},[1]:{[c.ATK_PERCENT]:.0766,[c.HP_PERCENT]:.0766,[c.DEF_PERCENT]:.0956,[c.ELEMENTAL_MASTERY]:30.6,[c.ENERGY_RECHARGE]:.085,[c.CRIT_RATE]:.051,[c.CRIT_DMG]:.102,[c.PHYSICAL_DMG]:.0956},[3]:{[c.ATK_PERCENT]:.0766,[c.HP_PERCENT]:.0766,[c.DEF_PERCENT]:.0956,[c.ELEMENTAL_MASTERY]:30.6,[c.ENERGY_RECHARGE]:.085,[c.CRIT_RATE]:.051,[c.CRIT_DMG]:.102,[c.PHYSICAL_DMG]:.0956},[2]:{[c.ATK_PERCENT]:.05107,[c.HP_PERCENT]:.05107,[c.DEF_PERCENT]:.06373,[c.ELEMENTAL_MASTERY]:20.4,[c.ENERGY_RECHARGE]:.05667,[c.CRIT_RATE]:.034,[c.CRIT_DMG]:.068,[c.PHYSICAL_DMG]:.06373},[4]:{[c.ATK_PERCENT]:.12,[c.HP_PERCENT]:.12,[c.DEF_PERCENT]:.15013,[c.ELEMENTAL_MASTERY]:48,[c.ENERGY_RECHARGE]:.13333,[c.CRIT_RATE]:.08,[c.CRIT_DMG]:.16,[c.PHYSICAL_DMG]:.15013},[5]:{[c.ATK_PERCENT]:.09,[c.HP_PERCENT]:.09,[c.DEF_PERCENT]:.1126,[c.ELEMENTAL_MASTERY]:36,[c.ENERGY_RECHARGE]:.1,[c.CRIT_RATE]:.06,[c.CRIT_DMG]:.12,[c.PHYSICAL_DMG]:.1126},[6]:{[c.ATK_PERCENT]:.06,[c.HP_PERCENT]:.06,[c.DEF_PERCENT]:.0751,[c.ELEMENTAL_MASTERY]:24,[c.ENERGY_RECHARGE]:.0667,[c.CRIT_RATE]:.04,[c.CRIT_DMG]:.08,[c.PHYSICAL_DMG]:.0751},[8]:{[c.ATK_PERCENT]:.144,[c.HP_PERCENT]:.144,[c.DEF_PERCENT]:.18,[c.ELEMENTAL_MASTERY]:57.6,[c.ENERGY_RECHARGE]:.16,[c.CRIT_RATE]:.096,[c.CRIT_DMG]:.192,[c.PHYSICAL_DMG]:.18},[7]:{[c.ATK_PERCENT]:.03,[c.HP_PERCENT]:.03,[c.DEF_PERCENT]:.03753,[c.ELEMENTAL_MASTERY]:12,[c.ENERGY_RECHARGE]:.03333,[c.CRIT_RATE]:.02,[c.CRIT_DMG]:.04,[c.PHYSICAL_DMG]:.03753},[9]:{[c.ATK_PERCENT]:.108,[c.HP_PERCENT]:.108,[c.DEF_PERCENT]:.135,[c.ELEMENTAL_MASTERY]:43.2,[c.ENERGY_RECHARGE]:.12,[c.CRIT_RATE]:.072,[c.CRIT_DMG]:.144,[c.PHYSICAL_DMG]:.135},[10]:{[c.ATK_PERCENT]:.072,[c.HP_PERCENT]:.072,[c.DEF_PERCENT]:.09,[c.ELEMENTAL_MASTERY]:28.8,[c.ENERGY_RECHARGE]:.08,[c.CRIT_RATE]:.048,[c.CRIT_DMG]:.096,[c.PHYSICAL_DMG]:.09},[11]:{[c.ATK_PERCENT]:.036,[c.HP_PERCENT]:.036,[c.DEF_PERCENT]:.045,[c.ELEMENTAL_MASTERY]:14.4,[c.ENERGY_RECHARGE]:.04,[c.CRIT_RATE]:.024,[c.CRIT_DMG]:.048,[c.PHYSICAL_DMG]:.045}};function za(e,a,n,s){if(n<1||n>90)throw new Error("Weapon level must be between 1 and 90");if(s<0||s>6)throw new Error("Weapon ascension must be between 0 and 6");let i;if(e===5)i=Wa;else if(e===4)i=Ua;else if(e===3)i=ka;else throw new Error("Weapon stars must be 3, 4 or 5.");return xa[a][n-1]+i*s}function Qa(e,a,n){const s=ja[a-1];return(qa[e][n]||0)*s}function $a(e,a,n){return e===5?lE[a][n]:oE[a][n]}var lE={[c.HP_FLAT]:[717,920,1123,1326,1530,1733,1936,2139,2342,2545,2749,2952,3155,3358,3561,3764,3967,4171,4374,4577,4780],[c.HP_PERCENT]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.ATK_FLAT]:[47,60,73,86,100,113,126,139,152,166,179,192,205,219,232,245,258,272,285,298,311],[c.ATK_PERCENT]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.DEF_PERCENT]:[.087,.112,.137,.162,.186,.211,.236,.261,.286,.31,.335,.36,.385,.409,.434,.459,.484,.508,.533,.558,.583],[c.CRIT_RATE]:[.047,.06,.073,.086,.099,.113,.126,.139,.152,.166,.179,.192,.205,.218,.232,.245,.258,.271,.284,.298,.311],[c.CRIT_DMG]:[.093,.12,.146,.173,.199,.225,.252,.278,.305,.331,.357,.384,.41,.437,.463,.49,.516,.542,.569,.595,.622],[c.ENERGY_RECHARGE]:[.078,.1,.122,.144,.166,.188,.21,.232,.254,.276,.298,.32,.342,.364,.386,.408,.43,.452,.474,.496,.518],[c.HEALING_BONUS]:[.054,.069,.084,.1,.115,.13,.145,.161,.176,.191,.206,.221,.237,.252,.267,.282,.298,.313,.328,.343,.359],[c.ELEMENTAL_MASTERY]:[28,35.9,43.8,51.8,59.7,67.6,75.5,83.5,91.4,99.3,107.2,115.2,123.1,131,138.9,146.9,154.8,162.7,170.6,178.6,186.5],[c.ANEMO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.GEO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.CRYO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.PYRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.HYDRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.ELECTRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.DENDRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.PHYSICAL_DMG]:[.087,.112,.137,.162,.186,.211,.236,.261,.286,.31,.335,.36,.385,.409,.434,.459,.484,.508,.533,.558,.583]},oE={[c.HP_FLAT]:[645,828,1011,1194,1377,1559,1742,1925,2108,2291,2474,2657,2839,3022,3205,3388,3571],[c.HP_PERCENT]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.ATK_FLAT]:[42,54,66,78,90,102,113,125,137,149,161,173,185,197,209,221,232],[c.ATK_PERCENT]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.DEF_PERCENT]:[.079,.101,.123,.146,.168,.19,.212,.235,.257,.279,.302,.324,.346,.368,.391,.413,.435],[c.CRIT_RATE]:[.042,.054,.066,.078,.09,.101,.113,.125,.137,.149,.161,.173,.185,.197,.208,.22,.232],[c.CRIT_DMG]:[.084,.108,.131,.155,.179,.203,.227,.25,.274,.298,.322,.345,.369,.393,.417,.441,.464],[c.ENERGY_RECHARGE]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387],[c.HEALING_BONUS]:[.048,.062,.076,.09,.103,.117,.131,.144,.158,.172,.186,.199,.213,.227,.24,.254,.268],[c.ELEMENTAL_MASTERY]:[25.2,32.3,39.4,46.6,53.7,60.8,68,75.1,82.2,89.4,96.5,103.6,110.8,117.9,125,132.2,139.3],[c.ANEMO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.CRYO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.ELECTRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.GEO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.HYDRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.PYRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.DENDRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.PHYSICAL_DMG]:[.079,.101,.123,.146,.168,.19,.212,.235,.257,.279,.302,.324,.346,.368,.391,.413,.435]},Xa=(e=>(e[e.ROLL_1=0]="ROLL_1",e[e.ROLL_2=1]="ROLL_2",e[e.ROLL_3=2]="ROLL_3",e[e.ROLL_4=3]="ROLL_4",e[e.ROLL_AVG=4]="ROLL_AVG",e[e.ROLL_MIN=0]="ROLL_MIN",e[e.ROLL_MAX=3]="ROLL_MAX",e))(Xa||{});function Z(e,a,n){return e===4?n===4?(dt[a][0]+dt[a][1]+dt[a][2]+dt[a][3])/4:dt[a][n]:e===5?n===4?(Gt[a][0]+Gt[a][1]+Gt[a][2]+Gt[a][3])/4:Gt[a][n]:0}function Le(e){return e===4?4:e===5?6:0}function cE(e){return e===4?7:e===5?9:0}function Ne(e,a){return Le(e)*Z(e,a,3)}var Gt={[c.HP_FLAT]:[209.13,239,268.88,298.75],[c.HP_PERCENT]:[.0408,.0466,.0525,.0583],[c.ATK_FLAT]:[13.62,15.56,17.51,19.45],[c.ATK_PERCENT]:[.0408,.0466,.0525,.0583],[c.PYRO_DMG]:[.0408,.0466,.0525,.0583],[c.CRYO_DMG]:[.0408,.0466,.0525,.0583],[c.HYDRO_DMG]:[.0408,.0466,.0525,.0583],[c.ELECTRO_DMG]:[.0408,.0466,.0525,.0583],[c.ANEMO_DMG]:[.0408,.0466,.0525,.0583],[c.GEO_DMG]:[.0408,.0466,.0525,.0583],[c.DENDRO_DMG]:[.0408,.0466,.0525,.0583],[c.PHYSICAL_DMG]:[.051,.0583,.0656,.0729],[c.HEALING_BONUS]:[.03143,.03589799019607843,.040443014705882345,.044911004901960774],[c.DEF_FLAT]:[16.2,18.52,20.83,23.15],[c.DEF_PERCENT]:[.051,.0583,.0656,.0729],[c.CRIT_RATE]:[.0272,.0311,.035,.0389],[c.CRIT_DMG]:[.0544,.0622,.0699,.0777],[c.ENERGY_RECHARGE]:[.0453,.0518,.0583,.0648],[c.ELEMENTAL_MASTERY]:[16.32,18.65,20.98,23.31]},dt={[c.HP_FLAT]:[167.3,191.2,215.1,239],[c.HP_PERCENT]:[.0326,.0373,.042,.0466],[c.ATK_FLAT]:[10.89,12.45,14,15.56],[c.ATK_PERCENT]:[.0326,.0373,.042,.0466],[c.PYRO_DMG]:[.0326,.0373,.042,.0466],[c.CRYO_DMG]:[.0326,.0373,.042,.0466],[c.HYDRO_DMG]:[.0326,.0373,.042,.0466],[c.ELECTRO_DMG]:[.0326,.0373,.042,.0466],[c.ANEMO_DMG]:[.0326,.0373,.042,.0466],[c.GEO_DMG]:[.0326,.0373,.042,.0466],[c.DENDRO_DMG]:[.0326,.0373,.042,.0466],[c.PHYSICAL_DMG]:[.0408,.0466,.0525,.0583],[c.HEALING_BONUS]:[.0251,.02866813725490196,.032297794117647056,.035865931372549016],[c.DEF_FLAT]:[12.96,14.82,16.67,18.52],[c.DEF_PERCENT]:[.0408,.0466,.0525,.0583],[c.CRIT_RATE]:[.0218,.0249,.028,.0311],[c.CRIT_DMG]:[.0435,.0497,.056,.0622],[c.ENERGY_RECHARGE]:[.0363,.0414,.0466,.0518],[c.ELEMENTAL_MASTERY]:[13.06,14.92,16.79,18.65]};function gt(e,a,n){return e*(1+a)+n}function Za(e,a){return e>1?e=1:e<0&&(e=0),1+e*a}function Ja(e){return e<0?1-e/2:e<.75?1-e:1/(4*e+1)}function tn(e,a,n,s){return(e+100)/((1-n)*(1-s)*(a+100)+e+100)}function en(e){return 2.78*e/(e+1400)}function an(e){return 16*e/(e+2e3)}function fe(e){return 5*e/(e+1200)}function Ft(e){return ya[e-1]}function nn(e){switch(e){case c.BURGEON_DMG:return 6;case c.HYPERBLOOM_DMG:return 6;case c.OVERLOAD_DMG:return 4;case c.BLOOM_DMG:return 4;case c.SHATTER_DMG:return 3;case c.ELECTROCHARGE_DMG:return 2.4;case c.SWIRL_DMG:return 1.2;case c.SUPERCONDUCT_DMG:return 1;case c.BURNING_DMG:return .5;case c.AGGRAVATE_DMG:return 2.3;case c.SPREAD_DMG:return 2.5}return 0}var sn=(e=>(e[e.NO_CRIT=0]="NO_CRIT",e[e.CRIT=1]="CRIT",e[e.CRIT_AVG=2]="CRIT_AVG",e))(sn||{}),rn=(e=>(e[e.AMP_STRONG=2]="AMP_STRONG",e[e.AMP_WEAK=1.5]="AMP_WEAK",e[e.AMP_NONE=0]="AMP_NONE",e))(rn||{}),ln=(e=>(e[e.QUICKEN_STRONG=2.5]="QUICKEN_STRONG",e[e.QUICKEN_WEAK=2.3]="QUICKEN_WEAK",e[e.QUICKEN_NONE=0]="QUICKEN_NONE",e))(ln||{});function on(e){return z({Char:0,Enemy:0,Base:0,Dmg:0,Critrate:0,Critdmg:0,Em:0,Res:0,Ignored:0,Reduced:0,Quicken:0,Amp:0,Tr:0},e)}function cn(e){return z({Base:!1,Def:!1,Res:!1,Dmg:!1,Crit:0,Quicken:0,Tr:0,Amp:0},e)}function En(e,a){let n=0;a.Base&&(n=e.Base);const s=nn(a.Tr);return n+=s*Ft(e.Char),s===0&&a.Quicken>0&&(n+=a.Quicken*Ft(e.Char)*(1+fe(e.Em)+e.Quicken)),a.Dmg&&(n*=1+e.Dmg),s>0&&(n*=1+an(e.Em)+e.Tr,a.Quicken>0&&(n+=a.Quicken*Ft(e.Char)*(1+fe(e.Em)+e.Quicken))),a.Crit===1?n*=1+e.Critdmg:a.Crit===2&&(n*=Za(e.Critrate,e.Critdmg)),a.Def&&(n*=tn(e.Char,e.Enemy,e.Ignored,e.Reduced)),a.Res&&(n*=Ja(e.Res)),a.Amp>0&&(n*=a.Amp*(1+en(e.Em)+e.Amp)),n}function Tn(e,a,n,s,i,l){const E=i;let _=0;i>0&&(_=l/i);let A=e*(1-E)*(1-_);return A+=a*(1-E)*_,A+=n*E*(1-_),A+=s*E*_,A}function EE(e,a){switch(a){case c.ATK:return gt(e.Get(c.ATK_BASE),e.Get(c.ATK_PERCENT),e.Get(c.ATK_FLAT));case c.HP:return gt(e.Get(c.HP_BASE),e.Get(c.HP_PERCENT),e.Get(c.HP_FLAT));case c.DEF:return gt(e.Get(c.DEF_BASE),e.Get(c.DEF_PERCENT),e.Get(c.DEF_FLAT));case c.NORMAL_ATTACK_LEVEL:return e.Get(c.NORMAL_ATTACK_LEVEL)+e.Get(c.NORMAL_ATTACK_LEVEL_UP);case c.ELEMENTAL_SKILL_LEVEL:return e.Get(c.ELEMENTAL_SKILL_LEVEL)+e.Get(c.ELEMENTAL_SKILL_LEVEL_UP);case c.ELEMENTAL_BURST_LEVEL:return e.Get(c.ELEMENTAL_BURST_LEVEL)+e.Get(c.ELEMENTAL_BURST_LEVEL_UP);case c.CHARGED_AIMED_SHOT_DMG:return e.Get(c.CHARGED_AIMED_SHOT_DMG)+e.Get(c.CHARGED_ATTACK_DMG)+e.Get(c.AIMED_SHOT_DMG);case c.CHARGED_AIMED_SHOT_ATK_FLAT:return e.Get(c.CHARGED_AIMED_SHOT_ATK_FLAT)+e.Get(c.CHARGED_ATTACK_ATK_FLAT)+e.Get(c.AIMED_SHOT_ATK_FLAT);case c.CHARGED_AIMED_SHOT_ATK_PERCENT:return e.Get(c.CHARGED_AIMED_SHOT_ATK_PERCENT)+e.Get(c.CHARGED_ATTACK_ATK_PERCENT)+e.Get(c.AIMED_SHOT_ATK_PERCENT);case c.CHARGED_AIMED_SHOT_CRIT_DMG:return e.Get(c.CHARGED_AIMED_SHOT_CRIT_DMG)+e.Get(c.CHARGED_ATTACK_CRIT_DMG)+e.Get(c.AIMED_SHOT_CRIT_DMG);case c.CHARGED_AIMED_SHOT_CRIT_RATE:return e.Get(c.CHARGED_AIMED_SHOT_CRIT_RATE)+e.Get(c.CHARGED_ATTACK_CRIT_RATE)+e.Get(c.AIMED_SHOT_CRIT_RATE);case c.CHARGED_AIMED_SHOT_DMG_FLAT:return e.Get(c.CHARGED_AIMED_SHOT_DMG_FLAT)+e.Get(c.CHARGED_ATTACK_DMG_FLAT)+e.Get(c.AIMED_SHOT_DMG_FLAT);default:return e.Get(a)}}function TE(e,a,n){let s,i,l,E;switch(a){case c.ATK:throw new Error("Cannot set Total ATK directly.");case c.HP:throw new Error("Cannot set Total HP directly.");case c.DEF:throw new Error("Cannot set Total DEF directly");case c.NORMAL_ATTACK_LEVEL:n=Math.max(1,Math.floor(n)),e.Set(c.NORMAL_ATTACK_LEVEL,n-e.Get(c.NORMAL_ATTACK_LEVEL_UP));break;case c.ELEMENTAL_SKILL_LEVEL:n=Math.max(1,Math.floor(n)),e.Set(c.ELEMENTAL_SKILL_LEVEL,n-e.Get(c.ELEMENTAL_SKILL_LEVEL_UP));break;case c.ELEMENTAL_BURST_LEVEL:n=Math.max(1,Math.floor(n)),e.Set(c.ELEMENTAL_BURST_LEVEL,n-e.Get(c.ELEMENTAL_BURST_LEVEL_UP));break;case c.LEVEL:n>90?n=90:n<1&&(n=1),n=Math.floor(n),i=Yt(n),l=ht(n),E=e.Get(c.ASCENSION),E<i?E=i:E>l&&(E=l),e.Set(c.ASCENSION,E),e.Set(c.LEVEL,n);break;case c.ASCENSION:s=e.Get(c.LEVEL),i=Yt(s),l=ht(s),E=Math.floor(n),E<i?E=i:E>l&&(E=l),e.Set(c.ASCENSION,E);break;default:e.Set(a,n);break}}var me=class{constructor(e){if(this.Subject=new it(c.Length(),"CHARACTER_STATS"),this.infusions=[],this.MapCritRate=a=>a,e.Stars!==4&&e.Stars!==5)throw new Error("Character stars must be 4 or 5.");this.Options=e,this.Subject.Set(c.LEVEL,1),this.Subject.Set(c.ASCENSION,0),this.Subject.Set(c.ENERGY_RECHARGE,1),this.Subject.Set(c.CRIT_RATE,.05),this.Subject.Set(c.CRIT_DMG,.5),this.Subject.Set(c.NORMAL_ATTACK_LEVEL,1),this.Subject.Set(c.ELEMENTAL_SKILL_LEVEL,1),this.Subject.Set(c.ELEMENTAL_BURST_LEVEL,1),this.Subject.Set(c.HP_CURRENT,1),this.Subject.Set(c.ENERGY_CURRENT,1),this.enemy=new Ia(e.Name)}GetEnemy(){return this.enemy}IsShielded(){return this.Subject.Get(c.SHIELDED)===1}SetShield(e){return this.Subject.Set(c.SHIELDED,e===!0?1:0),this}GetLevel(){return this.Subject.Get(c.LEVEL)}SetLevel(e){return this.Set(c.LEVEL,e)}GetAscension(){return this.Subject.Get(c.ASCENSION)}SetAscension(e){return this.Set(c.ASCENSION,e)}IsAscended(){return this.GetAscension()===ht(this.GetLevel())}Set(e,a){return TE(this.Subject,e,a),this}CreateModifier(e,a){return this.Subject.CreateModifier(e,a)}CreateObserver(e,a){return this.Subject.CreateObserver(e,a)}Get(e){return EE(this.Subject,e)}AddInfusion(e,a){const n={Enabled:!0,Element:e,Max:a,Remove:()=>this.RemoveInfusion(n)};return this.infusions.push(n),n}RemoveInfusion(e){const a=this.infusions.indexOf(e);return a===-1?!1:(this.infusions.splice(a,1),!0)}GetInfusion(){return aE(this.infusions)}};function _n(e){return{level:e.GetLevel(),ascension:e.GetAscension(),hp:e.Get(c.HP_CURRENT),energy:e.Get(c.ENERGY_CURRENT),shielded:e.Get(c.SHIELDED)===1,talents:[e.Get(c.NORMAL_ATTACK_LEVEL),e.Get(c.ELEMENTAL_SKILL_LEVEL),e.Get(c.ELEMENTAL_BURST_LEVEL)],enemy:Se(e.GetEnemy())}}function An(e,a){a.SetLevel(e.level),a.SetAscension(e.ascension),a.Set(c.NORMAL_ATTACK_LEVEL,e.talents[0]),a.Set(c.ELEMENTAL_SKILL_LEVEL,e.talents[1]),a.Set(c.ELEMENTAL_BURST_LEVEL,e.talents[2]),a.Set(c.HP_CURRENT,e.hp),a.Set(c.ENERGY_CURRENT,e.energy),a.Set(c.SHIELDED,e.shielded?1:0),Kt(e.enemy,a.GetEnemy())}var d={};O(d,{Charbox:()=>Vt,CharboxEvent:()=>Lt,Export:()=>As,ExportParty:()=>xE,Factory:()=>SE,Import:()=>Ss,ImportParty:()=>kE,Party:()=>HE});var Lt=at("CHANGE_PARTY"),Q=class{constructor(e){this.getName=e,this.list=[],this.map=new Map}AddList(e){for(const a of e)this.Add(a)}Add(e){const a=this.getName(e).toLowerCase();return this.map.has(a)?!1:(this.list.push(e),this.map.set(a,e),!0)}Has(e){return this.map.has(this.getName(e).toLowerCase())}Remove(e){const a=this.getName(e).toLowerCase(),n=this.list.indexOf(e);return n>=0&&this.list.splice(n,1),this.map.delete(a)}Clear(){this.list.splice(0,this.list.length),this.map.clear()}Find(e){return this.map.get(e.toLowerCase())}Get(){return this.list}},Vt=class{constructor(e){this.character=e,this.normals=new Q(a=>a.Options.Name),this.skills=new Q(a=>a.Options.Name),this.bursts=new Q(a=>a.Options.Name),this.tr=new Q(a=>a.Options.Name),this.extra=new Q(a=>a.Options.Name),this.effects=new Q(a=>a.Options.Name),this.modifiers=[],this.Event=new it(Lt.Length(),"CHARBOX_EVENT")}static create(e){const a=new Vt(e.character);return a.normals.AddList(e.normals),a.skills.AddList(e.skills),a.bursts.AddList(e.bursts),a.tr.AddList(e.tr),a.extra.AddList(e.extra),a.effects.AddList(e.effects),a}GetParty(){return this.party}SetParty(e){this.party=e}GetWeapon(){return this.weapon}SetWeapon(e){return this.weapon&&this.weapon.Unequip(),e?this.weapon=e(this):this.weapon=void 0,this}GetCharacter(){return this.character}GetNormals(){return this.normals.Get()}FindNormal(e){return this.normals.Find(e)}AddNormal(e){return this.normals.Add(e)}RemoveNormal(e){return this.normals.Remove(e)}GetSkills(){return this.skills.Get()}FindSkill(e){return this.skills.Find(e)}AddSkill(e){return this.skills.Add(e)}RemoveSkill(e){return this.skills.Remove(e)}GetBursts(){return this.bursts.Get()}FindBurst(e){return this.bursts.Find(e)}AddBurst(e){return this.bursts.Add(e)}RemoveBurst(e){return this.bursts.Remove(e)}GetTr(){return this.tr.Get()}FindTr(e){return this.tr.Find(e)}GetExtra(){return this.extra.Get()}FindExtra(e){return this.extra.Find(e)}AddExtra(e){return this.extra.Add(e)}RemoveExtra(e){return this.extra.Remove(e)}AddInstance(e,a){switch(e){case"Extra":return this.AddExtra(a);case"Normal":return this.AddNormal(a);case"Skill":return this.AddSkill(a);case"Burst":return this.AddBurst(a)}}RemoveInstance(e,a){switch(e){case"Extra":return this.RemoveExtra(a);case"Normal":return this.RemoveNormal(a);case"Skill":return this.RemoveSkill(a);case"Burst":return this.RemoveBurst(a)}}GetInstances(){return[...this.normals.Get(),...this.skills.Get(),...this.bursts.Get(),...this.tr.Get(),...this.extra.Get()]}FindInstance(e){for(const a of[this.normals,this.skills,this.bursts,this.tr,this.extra]){const n=a.Find(e);if(n)return n}}GetEffects(){var e,a;return[...((e=this.weapon)==null?void 0:e.GetEffects())||[],...((a=this.artifacts)==null?void 0:a.GetEffects())||[],...this.effects.Get()]}GetGroupedEffects(){const e=[],{weapon:a,artifacts:n,party:s}=this;a&&e.push(["WEAPON",a.GetEffects()]),n&&e.push(["ARTIFACTS",n.GetEffects()]);const i=[],l=[],E=new Set(this.effects.Get());for(const _ of E){const A=_.Options.Name;if(A.match(/C\d+$/))i.push(_);else if(A.match(/A\d+$/))l.push(_);else continue;E.delete(_)}return e.push(["TALENTS",Array.from(E)]),e.push(["PASSIVES",l]),e.push(["CONSTELLATIONS",i]),s&&e.push(["RESONANCES",s.GetResonances()]),e}FindEffect(e){let a=this.effects.Find(e);if(a||this.weapon&&(a=this.weapon.FindEffect(e),a)||this.artifacts&&(a=this.artifacts.FindEffect(e),a))return a}AddEffect(e){return this.effects.Add(e)}GetArtifacts(){return this.artifacts}SetArtifacts(e){return this.artifacts&&this.artifacts.Remove(),this.artifacts=e,this}AddModifier(e){return this.modifiers.unshift(e),this}RemoveModifier(e){const a=this.modifiers.indexOf(e);return a>=0&&this.modifiers.splice(a,1),this}GetModifiers(){return this.modifiers}ClearModifiers(){return this.modifiers.forEach(e=>e.Disable()),this.modifiers.splice(0,this.modifiers.length),this}},Sn={};O(Sn,{BaseDamage:()=>un,Instance:()=>Ce,Normal:()=>pe,NormalTalent:()=>Nt,Transformative:()=>P});var un=class{constructor(e){this.instance=e,this.motions=[],this.multipliers=[]}CreateMv(e,a){const n={Enabled:!0,Stat:e,Value:a};return this.motions.push(n),n}AddMv(e){return this.motions.includes(e)?!1:(this.motions.push(e),!0)}RemoveMv(e){const a=this.motions.indexOf(e);return a===-1?!1:(this.motions.splice(a,1),!0)}GetMvs(){return this.motions}CreateMultiplier(e){const a={Enabled:!0,Value:e};return this.multipliers.push(a),a}AddMultiplier(e){return this.multipliers.includes(e)?!1:(this.multipliers.push(e),!0)}RemoveMultiplier(e){const a=this.multipliers.indexOf(e);return a===-1?!1:(this.multipliers.splice(a,1),!0)}GetMultipliers(){return this.multipliers}Compute(){let e=0;for(const a of this.motions)a.Enabled&&(e+=this.instance.Get(a.Stat)*a.Value);for(const a of this.multipliers)a.Enabled&&(e*=a.Value);return e}};function _E(e,a){return e===c.HYDRO_DMG&&a.Affected(c.PYRO_DMG)?[c.VAPORIZE_DMG,2]:e===c.PYRO_DMG&&a.Affected(c.CRYO_DMG)?[c.MELT_DMG,2]:e===c.PYRO_DMG&&a.Affected(c.HYDRO_DMG)?[c.VAPORIZE_DMG,1.5]:e===c.CRYO_DMG&&a.Affected(c.PYRO_DMG)?[c.MELT_DMG,1.5]:[c.NONE,0]}function AE(e,a){return a.HasAura(F.QUICKEN)?e===c.ELECTRO_DMG?[c.AGGRAVATE_DMG,2.3]:e===c.DENDRO_DMG?[c.SPREAD_DMG,2.5]:[c.NONE,0]:[c.NONE,0]}function hn(e,a,n){const s=e.GetElement(),i=e.Options.Talent,l=e.Character.GetEnemy(),[E,_]=AE(s,l),[A,S]=_E(s,l),u=on({Char:e.Character.Get(c.LEVEL),Enemy:l.Subject.Get(c.LEVEL),Base:e.Base.Compute()+e.Get(c.DMG_FLAT),Dmg:e.Get(s)+e.Get(i)+e.Get(c.ALL_DMG),Critrate:Math.max(0,Math.min(1,e.Get(c.CRIT_RATE))),Critdmg:e.Get(c.CRIT_DMG),Em:e.Get(c.ELEMENTAL_MASTERY),Res:l.Subject.Get(bt(s)),Ignored:e.Get(c.DEFIGNORED)+l.Subject.Get(c.DEFIGNORED),Reduced:e.Get(c.DEFREDUCTION)+l.Subject.Get(c.DEFREDUCTION),Quicken:e.Get(E),Amp:e.Get(A),Tr:e.Get(e.Options.Tr)}),h=cn({Base:e.Options.Base,Def:e.Options.Def,Res:e.Options.Res,Dmg:e.Options.Dmg,Crit:n,Quicken:_,Tr:e.Options.Tr,Amp:S});return a||(u.Quicken=0,u.Amp=0,h.Quicken=0,h.Amp=0),e.Options.Amp||(h.Amp=0),e.Options.Quicken||(h.Quicken=0),e.Options.Crit||(h.Crit=0),{stats:u,options:h}}function Me(e,a,n){const{stats:s,options:i}=hn(e,a,n);return En(s,i)}var B=c,Ce=class{constructor(e,a){this.Character=e,this.Options=a,this.Base=new un(this),this.fixed=new Uint8Array(c.Length()),this.Subject=new it(c.Length(),"INSTANCE_"+this.Options.Name)}GetElement(){if(this.Options.Override){if(this.Options.OverrideElement!==c.NONE)return this.Options.OverrideElement;if(this.Options.Infusion){const e=this.Character.GetInfusion();if(e)return e.Element}}return this.Options.Element}Fix(e){return this.fixed[e]=1,this}Unfix(e){return this.fixed[e]=0,this}Get(e){if(e===B.ATK){const a=this.GetElement(),n=le(a),s=ce(a),i=this.Options.Talent,l=le(i),E=ce(i),_=this.Get(B.ATK_BASE);let A=this.Get(B.ATK_PERCENT),S=this.Get(B.ATK_FLAT);return n!==B.NONE&&(A+=this.Get(n)),l!==B.NONE&&(A+=this.Get(l)),s!==B.NONE&&(S+=this.Get(s)),E!==B.NONE&&(S+=this.Get(E)),gt(_,A,S)}else if(e===B.CRIT_RATE){const a=this.GetElement(),n=this.Options.Talent,s=Ee(a),i=Ee(n);let l=0;return l+=this.Subject.Get(B.CRIT_RATE),l+=this.Subject.Get(B.EXTRA_CRIT_RATE),this.fixed[B.CRIT_RATE]||(l+=this.Character.Get(B.CRIT_RATE)),this.fixed[B.EXTRA_CRIT_RATE]||(l+=this.Character.Get(B.EXTRA_CRIT_RATE)),l+=this.Get(s)+this.Get(i),this.Character.MapCritRate(l)}else if(e===B.CRIT_DMG){const a=this.GetElement(),n=this.Options.Talent,s=Te(a),i=Te(n);let l=this.Subject.Get(B.CRIT_DMG);return this.fixed[B.CRIT_DMG]||(l+=this.Character.Get(B.CRIT_DMG)),l+=this.Get(s)+this.Get(i),l}else if(e===B.DMG_FLAT){const a=this.GetElement(),n=this.Options.Talent,s=oe(a),i=oe(n);let l=this.Subject.Get(B.DMG_FLAT);return this.fixed[B.DMG_FLAT]||(l+=this.Character.Get(B.DMG_FLAT)),l+=this.Get(s)+this.Get(i),l}else return this.fixed[e]?this.Subject.Get(e):this.Character.Get(e)+this.Subject.Get(e)}DmgNoCrit(e){return Me(this,e,0)}DmgCrit(e){return Me(this,e,1)}DmgAvg(e){return Me(this,e,2)}Params(e,a){return hn(this,e,a)}};function pe(e,a){return new Ce(a,{Name:e,Element:c.PHYSICAL_DMG,Talent:c.NONE,Override:!0,OverrideElement:c.NONE,Infusion:!1,Base:!0,Def:!0,Res:!0,Dmg:!0,Crit:!0,Quicken:!0,Amp:!0,Tr:c.NONE})}function P(e,a,n){const s=new Ce(n,{Name:"HIT_"+c.Name(e).replace(/_DMG/g,""),Element:c.PHYSICAL_DMG,Talent:c.NONE,Override:!1,OverrideElement:c.NONE,Infusion:!1,Base:!1,Def:!1,Res:!0,Dmg:!1,Crit:!0,Quicken:!1,Amp:!1,Tr:e});if(s.Fix(c.CRIT_RATE),s.Fix(c.CRIT_DMG),e===c.SWIRL_DMG){if(!a)throw new Error("Swirl transformative damage must have an element");s.Options.Quicken=!0,s.Options.Amp=!0,s.Options.Name="HIT_"+(c.Name(e)+"_"+c.Name(a)).replace(/_DMG/g,""),s.Options.Element=a}else s.Options.Element=ga(e);return s}function Nt(e,a){const n=pe(a.Name,e),s=[];if(n.Options.Talent=a.Talent,n.Options.Element=a.Element,a.Scaling)for(const i of a.Scaling)s.push(...Fa(n,i));return[n,s]}function SE(e){return Object.assign(function(){const n=new me(e);wa(n,e);const s=Vt.create({character:n,normals:e.Normals.map(i=>Nt(n,Ge(i,c.NORMAL_ATTACK_LEVEL))[0]),skills:e.Skills.map(i=>Nt(n,Ge(i,c.ELEMENTAL_SKILL_LEVEL))[0]),bursts:e.Bursts.map(i=>Nt(n,Ge(i,c.ELEMENTAL_BURST_LEVEL))[0]),tr:uE(n),extra:e.Extra.map(i=>Nt(n,st(z({},i),{Scaling:void 0}))[0]),effects:[]});return s.GetNormals().forEach(i=>i.Options.Infusion=!0),e.Effects.forEach(i=>{const l=i(s);l.Apply(s),s.AddEffect(l)}),s},e)}function Ge(e,a){var n;return st(z({},e),{Scaling:(n=e.Scaling)==null?void 0:n.map(s=>st(z({},s),{Talent:a}))})}function uE(e){const a=e.Options.Element,n=[];switch(a){case c.PYRO_DMG:n.push(P(c.OVERLOAD_DMG,void 0,e)),n.push(P(c.BURGEON_DMG,void 0,e)),n.push(P(c.BURNING_DMG,void 0,e));break;case c.HYDRO_DMG:n.push(P(c.ELECTROCHARGE_DMG,void 0,e)),n.push(P(c.BLOOM_DMG,void 0,e));break;case c.CRYO_DMG:n.push(P(c.SUPERCONDUCT_DMG,void 0,e));break;case c.ELECTRO_DMG:n.push(P(c.SUPERCONDUCT_DMG,void 0,e)),n.push(P(c.ELECTROCHARGE_DMG,void 0,e)),n.push(P(c.OVERLOAD_DMG,void 0,e)),n.push(P(c.HYPERBLOOM_DMG,void 0,e));break;case c.DENDRO_DMG:n.push(P(c.BLOOM_DMG,void 0,e));break;case c.GEO_DMG:n.push(P(c.SHATTER_DMG,void 0,e));break;case c.ANEMO_DMG:n.push(P(c.SWIRL_DMG,c.PYRO_DMG,e)),n.push(P(c.SWIRL_DMG,c.HYDRO_DMG,e)),n.push(P(c.SWIRL_DMG,c.CRYO_DMG,e)),n.push(P(c.SWIRL_DMG,c.ELECTRO_DMG,e)),n.push(P(c.SUPERCONDUCT_DMG,void 0,e)),n.push(P(c.ELECTROCHARGE_DMG,void 0,e)),n.push(P(c.OVERLOAD_DMG,void 0,e)),n.push(P(c.HYPERBLOOM_DMG,void 0,e)),n.push(P(c.BLOOM_DMG,void 0,e)),n.push(P(c.BURGEON_DMG,void 0,e));break}return a!==c.GEO_DMG&&e.Options.Weapon===pa.CLAYMORE&&n.push(P(c.SHATTER_DMG,void 0,e)),n}var Ln={};O(Ln,{Cryo:()=>Vn,Dendro:()=>kn,FindByElement:()=>qn,Geo:()=>xn,GetList:()=>jn,Hydro:()=>Fn,Pyro:()=>Yn});var r={};O(r,{Builder:()=>ot,Effect:()=>Bn,EffectEvent:()=>U,Export:()=>ve,Factory:()=>ft,Import:()=>ye});function V(e,a){let n=e.toFixed(a);return n=n.replace(/\.([0-9]*)([1-9])0+$/,".$1$2"),n=n.replace(/\.0+$/,""),n}function Nn(e){switch(e.type){case 0:return NE(e.object);case 1:return fE(e.object);case 2:return mE(e.object);case 3:return LE(e.object);case 4:return hE(e.object)}}function hE(e){return"Damage instance: "+e.Options.Name}function LE(e){return`Infusion (${e.Enabled?"Enabled":"Disabled"}): `+de(e.Element)}function NE(e){const a=e.Enabled()?"Enabled":"Disabled";return`Modifier (${e.Title}) (${a}): `+de(e.GetProp())+" += "+V(e.GetValue(),4)}function fE(e){let n=`Multiplier (${e.object.Enabled?"Enabled":"Disabled"}): `+V(e.object.Value,4)+`
`;n+=`	For instances:
`;for(const s of e.instances)n+="		"+s.Options.Name+`
`;return n}function mE(e){let n=`MV (${e.object.Enabled?"Enabled":"Disabled"}): `+V(e.object.Value,4)+"*"+de(e.object.Stat)+`
`;n+=`	For instances:
`;for(const s of e.instances)n+="		"+s.Options.Name+`
`;return n}function de(e){try{return c.Name(e)}catch{return"unknown stat"}}var ME=class{constructor(){this.modifiers=new Set,this.observers=new Set,this.infusions=new Set,this.multipliers=new Set,this.mtins=new Set,this.mvs=new Set,this.mvins=new Set,this.instances=new Set,this.queryPool=[],this.queryGroups=new Map,this.nextQuery={}}GetModifiers(){return Array.from(this.modifiers)}Modifier(e){return this.modifiers.add(e),this.queryPool.push({type:0,object:e}),e}Observer(e){return this.observers.add(e),e}Infusion(e){return this.infusions.add(e),this.queryPool.push({type:3,object:e}),e}Multiplier(e,...a){return this.multipliers.add(e),a.forEach(n=>{n.Base.AddMultiplier(e),this.mtins.add(n)}),this.queryPool.push({type:1,object:{instances:a,object:e}}),e}Mv(e,...a){return this.mvs.add(e),a.forEach(n=>{n.Base.AddMv(e),this.mvins.add(n)}),this.queryPool.push({type:2,object:{instances:a,object:e}}),e}Instance(e,a,n){const s=[e,a,n];return this.instances.add(s),this.queryPool.push({type:4,object:n}),s}Enable(){return this.observers.forEach(e=>e.Enable().Notify()),this.modifiers.forEach(e=>e.Enable()),this.infusions.forEach(e=>e.Enabled=!0),this.mvs.forEach(e=>e.Enabled=!0),this.multipliers.forEach(e=>e.Enabled=!0),this.instances.forEach(([e,a,n])=>e.AddInstance(a,n)),this}DisableObs(){return this.observers.forEach(e=>e.Notify().Disable()),this}Disable(){return this.modifiers.forEach(e=>e.Disable()),this.DisableObs(),this.infusions.forEach(e=>e.Enabled=!1),this.mvs.forEach(e=>e.Enabled=!1),this.multipliers.forEach(e=>e.Enabled=!1),this.instances.forEach(([e,a,n])=>e.RemoveInstance(a,n)),this}Remove(){return this.Disable(),this.observers.forEach(e=>e.Remove()),this.infusions.forEach(e=>e.Remove()),this.mvins.forEach(e=>this.mvs.forEach(a=>e.Base.RemoveMv(a))),this.mtins.forEach(e=>this.multipliers.forEach(a=>e.Base.RemoveMultiplier(a))),this.instances.forEach(([e,a,n])=>e.RemoveInstance(a,n)),this}StartQuery(e){this.nextQuery=e}EndQuery(){this.queryGroups.set(this.nextQuery,[...this.queryPool]),this.queryPool=[]}String(){let e="";for(const[a,n]of this.queryGroups){e+="QUERY: "+JSON.stringify(a)+`
`;for(const s of n)e+=Nn(s)+`
`;e+="=".repeat(32)+`
`}this.queryGroups.size===0&&(e+="=".repeat(32)+`
`);for(const a of this.queryPool)e+=Nn(a)+`
`;return e}},U=at("ENABLE","DISABLE","CHANGE_RANK","CHANGE_TARGET","CHANGE_STACKS","CHANGE_AURAS","CHANGE_CONDITIONS");function rt(...e){const a=[],n=[];let s=0;e.forEach((l,E)=>{a[E]=l.split(`
`),a[E].forEach(_=>{_.length>(n[E]||0)&&(n[E]=_.length)}),a[E].length>s&&(s=a[E].length)});const i=[];return a.forEach((l,E)=>{for(let _=0;_<s;_++){let A;for(_<l.length?A=l[_]:A="";A.length<n[E];)A+=" ";i[_]===void 0&&(i[_]=""),i[_]+=A}}),i.join(`
`)}var fn={};O(fn,{CRLF_EXP:()=>dn,ColorizeArgs:()=>Mn,CommandHelp:()=>Oe,CommandListHelp:()=>De,DEFINE_CASE_EXP:()=>Rn,DEFINE_CONST_EXP:()=>pn,FindCommand:()=>ge,FindConstants:()=>In,INLINE_COMMENT_EXP:()=>Re,LogString:()=>mn,Logger:()=>b,MULT_COMMENT_EXP:()=>gn,ParseLine:()=>Dn,ParseLines:()=>vn,Program:()=>Pn,REPLACE_CONST_EXP:()=>Gn,RemoveComments:()=>Ie,ReplaceConstants:()=>On,SplitCases:()=>xt}),Mt.exports.enabled=!0;var CE={Log:"green",Warn:"yellow",Error:"red"};function mn(e,a,n){let s=n.msg;if(e){let i=`[Line ${n.line}] [${n.type}]`;a&&(i=Mt.exports[CE[n.type]](i)),s=i+" "+s}return s}function Mn(e,a){return a.replace(/%([.0-9]*[a-z]+)/g,n=>Mt.exports[e](n))}var Cn=class{constructor(){this.Line=1,this.SaveLogs=!0,this.Colorize=!0,this.Prefix=!0,this.logs=[],this.Out=e=>console.log(this.LogString(e))}send(e,a){const n={type:e,msg:a,line:this.Line};return this.SaveLogs&&this.logs.push(n),this.Out(n),n}format(e,a){return this.Colorize?ne.printf(Mn("cyan",e),...a):ne.printf(e,...a)}GetLog(){return this.logs}Clear(){this.logs.splice(0,this.logs.length)}Log(e){return this.send("Log",e)}Logf(e,...a){return this.send("Log",this.format(e,a))}Warn(e){return this.send("Warn",e)}Warnf(e,...a){return this.send("Warn",this.format(e,a))}Error(e){return this.send("Error",e)}Errorf(e,...a){return this.send("Error",this.format(e,a))}Throw(e){const{msg:a}=this.send("Error",e);throw a}Throwf(e,...a){const{msg:n}=this.send("Error",this.format(e,a));throw n}String(){return this.logs.map(e=>this.LogString(e)).join(`
`)}toString(){return this.String()}LogString(e){return mn(this.Prefix,this.Colorize,e)}},b=Cn;b.Global=new Cn;function ge(e,a){for(let n=0;n<a.length;n++){const s=a[n],i=e[s];if(!i)throw new Error("Command not found: `"+a.slice(0,n+1).join(" ")+"`");if(!i.children||n===a.length-1)return[i,a.slice(n+1),a.slice(0,n+1)];e=i.children}throw new Error("Command not found: "+a.join(" "))}var pn=/^ *const +\$([a-z_](?:\w|\.)*) *(.*)$/img,Gn=/\$([a-z_](?:\w|\.)*)/ig,dn=/(\r\n|\n\r)/g,Re=/(#|\/\/).*$/gm,gn=/\/\*((?:.|\n|\r)*?)\*\//gm,Rn=/case([^:]*):/g;function Ie(e){return e.replace(dn,`
`).replace(gn,a=>a.replace(/[^\n]/g," ")).replace(Re,"")}function In(e,a={}){return e=e.replace(pn,(n,s,i)=>(i=i.replace(Re,""),a[String(s).valueOf().toLowerCase()]=i,"")),[e,a]}function On(e,a={}){return e=e.replace(Gn,(n,s)=>{const i=a[String(s).valueOf().toLowerCase()];if(!i)throw new Error("Cannot find constant: $"+s);return i}),e}function Dn(e){return e.trim().split(/\s+/).filter(a=>!a.match(/^\s*$/))}function vn(e){return e.split(`
`).map((a,n)=>({text:a,line:n})).filter(({text:a})=>a.trim()!=="")}function xt(e){e=Ie(e);const a=new Map,n=Array.from(e.matchAll(Rn));n.forEach((i,l)=>{var E;const _=i[0],A=i[1];if(!_||!A)return;const S=A.split(/\s|,|;/).map(L=>L.trim()).filter(L=>!!L),u=(i.index||0)+_.length,h=((E=n[l+1])==null?void 0:E.index)||e.length,N=e.slice(0,u).replace(/[^\n]/g,"")+e.slice(u,h).trim()+e.slice(h,e.length).replace(/[^\n]/g,"");for(let L of S){L=L.toLowerCase();let m=a.get(L);m||a.set(L,m=[]),m.push(N)}});const s=a.get("all");if(s)for(const i of a.values())i.unshift(...s);return a}function Oe(e,a){const n=new b;n.Out=()=>{},n.Colorize=!1,n.Prefix=!1;const s=(a.arguments||["args..."]).map(l=>"["+l+"]");let i=a.description.split(`
`).join(`
`);return a.example&&(i+=`

**Example:**
\`\`\`
`+a.example+"\n```\n"),a.children&&(i+=`

Type \`help ${e}\` to show more about this subcommand`),n.Logf("### Command `"+e+" %s".repeat(s.length)+`\`:

`+i+`

`,...s),n.String()}function De(e,a){let n="";for(const[s,i]of Object.entries(a))n+=Oe(e+" "+s,i)+`

`;return n}function yn(e,a){return Object.assign(a,{String(){return e},toString(){return e}})}function Hn(e){return e.forEach((a,n)=>e[n]=a.toLowerCase()),e}function pE(e){let a=0,n=1/0;if(e){n=e.length;for(const s of e)s.includes("...")?n=1/0:a++}return[a,n]}function GE(e,a={},n=b.Global){const s=[];e=Ie(e);const[i,l]=In(e,a==null?void 0:a.constants),E=n.Line;return vn(i).forEach(({text:A,line:S})=>{n.Line=S+1;try{A=On(A,l)}catch(h){throw n.Error(String(h).valueOf()),n.Line=E,h}const u=Dn(A);!u.length||s.push({cmd:u,line:n.Line})}),n.Line=E,s}var Pn=class{constructor(e){this.Value=e,this.commands={},this.Log=b.Global,this.IgnoreCase=!0,this.Catch=!0}Set(e){return this.commands=e,this}Get(){return this.commands}Compile(e,a){const n=this.Log.Line,s=(a==null?void 0:a.line)||n;this.Log.Line=s;const i=l=>{if(this.Log.Line=s,typeof l=="string"?(this.Log.Line=n,l=new Error(l)):(this.Log.Error(String(l).valueOf()),this.Log.Line=n),!this.Catch)throw l;return l};try{this.IgnoreCase&&Hn(e);const[l,E,_]=ge(this.commands,e),A=_.join(" ");if(!l.compile){const{msg:N}=this.Log.Errorf("Command `%s` is defined but has no `.compile()` method",A);throw N}const[S,u]=pE(l.arguments);if(E.length<S){const{msg:N}=this.Log.Errorf("Command `%s` requires at least %d arguments, but %d were provided.",A,S,E.length);throw N}if(E.length>u){const{msg:N}=this.Log.Errorf("Command `%s` requires at most %d arguments, but %d were provided.",A,u,E.length);throw N}const h=l.compile(this,E);return this.Log.Line=n,yn(e.join(" "),()=>{const N=this.Log.Line;this.Log.Line=s;try{h()}catch(L){i(L)}this.Log.Line=N})}catch(l){throw i(l)}}CompileString(e,a){const n=GE(e,a,this.Log),s=[];for(const{cmd:l,line:E}of n){const _=this.Compile(l,{line:E});s.push(_)}const i=s.map(l=>l.String()).join(`
`);return yn(i,()=>s.forEach(l=>l()))}Help(e){if(!e.length||e[0].trim()==="")return De("",this.commands);this.IgnoreCase&&Hn(e);const[a,,n]=ge(this.commands,e);let s=Oe(n.join(" "),a);return a.children&&(s+=`

`+De(n.join(" "),a.children)),s}GetCommands(){const e=[];function a(n,s){for(const[i,l]of Object.entries(n)){const E=[...s,i];e.push(E.join(" ")),l.children&&a(l.children,E)}}return a(this.commands,[]),e}},Bn=class{constructor(e,a){this.Options=e,this.Owner=a,this.targets=new Set,this.register=new Map,this.onUnapply=new Map,this.enabled=!1,this.rank=1,this.stacks=0,this.conditions=new Set,this.auras=new Set,this.Event=new it(U.Length(),"EFFECT_EVENT")}CreateObserver(e,a){return this.Event.CreateObserver(e,a)}Enabled(){return this.enabled}Enable(){this.enabled=!0;for(const[,e]of this.register)e.Enable();return this.Event.Notify(U.ENABLE),this}Disable(){this.enabled=!1;for(const[,e]of this.register)e.Disable();return this.Event.Notify(U.DISABLE),this}GetTargets(){return Array.from(this.targets.values())}Lock(e){const a=this.register.get(e);return a?(a.DisableObs(),this):(b.Global.Warnf("Cannot lock effect %s for target %s because its not applied.",this.Options.Name,e.GetCharacter().Options.Name),this)}ApplyMultiple(e){const a=new Set(e);if(!this.Options.ApplyOther){const s=a.has(this.Owner),i=a.size;a.clear(),s&&(a.add(this.Owner),i>1&&b.Global.Warnf('Effect "%s" can only be applied to its owner: "%s"',this.Options.Name,this.Owner.GetCharacter().Options.Name))}if(this.Options.ApplySelf||(a.delete(this.Owner),b.Global.Warnf('Effect "%s" CANNOT be applied to its owner: "%s"',this.Options.Name,this.Owner.GetCharacter().Options.Name)),this.Options.MaxTargets>0){let s=0;for(let i=0;i<e.length&&a.size>this.Options.MaxTargets;i++)a.delete(e[i]),s++;s>0&&b.Global.Warnf('Effect "%s" maximum targets is %d.',this.Options.Name,this.Options.MaxTargets)}this.UnapplyAll();let n=0;for(const s of a)this.Apply(s)&&n++;return n}Apply(e){if(!this.Options.StackSelf){const s=e.GetParty();if(s&&s.GetAppliedEffects(e).find(l=>l.Options.Name===this.Options.Name))return b.Global.Warnf('Cannot apply effect "%s" to target "%s". Another instance of this effect is already applied to the target',this.Options.Name,e.GetCharacter().Options.Name),!1}if(!this.Options.ApplySelf&&e===this.Owner)return b.Global.Warnf('Cannot apply effect "%s" to target "%s". Effect CANNOT be applied to its owner: "%s"',this.Options.Name,e.GetCharacter().Options.Name,this.Owner.GetCharacter().Options.Name),!1;if(!this.Options.ApplyOther&&e!==this.Owner)return b.Global.Warnf('Cannot apply effect "%s" to target "%s". Effect can only be applied to its owner: "%s"',this.Options.Name,e.GetCharacter().Options.Name,this.Owner.GetCharacter().Options.Name),!1;if(this.Options.MaxTargets>0&&this.targets.size>=this.Options.MaxTargets)return b.Global.Warnf('Cannot apply effect "%s" to target "%s". Effect is applied to its maximum number of targets: %d',this.Options.Name,e.GetCharacter().Options.Name,this.Options.MaxTargets),!1;if(this.targets.has(e))return b.Global.Warnf('Cannot apply effect "%s" to target "%s". Effect is applied to this target',this.Options.Name,e.GetCharacter().Options.Name),!1;this.targets.add(e);const a=new ME;this.register.set(e,a);const n=this.Options.OnApply(e,this,a);return this.onUnapply.set(e,n),this.Enabled()?a.Enable():a.Disable(),this.Event.Notify(U.CHANGE_TARGET),!0}Unapply(e){var a,n;return this.targets.has(e)?(this.targets.delete(e),(a=this.register.get(e))==null||a.Remove(),this.register.delete(e),(n=this.onUnapply.get(e))==null||n(),this.onUnapply.delete(e),this.Event.Notify(U.CHANGE_TARGET),!0):!1}UnapplyAll(){return this.targets.forEach(e=>this.Unapply(e)),this}GetRank(){return this.rank}GetStacks(){return this.stacks}SetRank(e){return e=Math.floor(e),e>this.Options.MaxRank&&(e=this.Options.MaxRank),e<1&&(e=1),this.rank=e,this.Event.Notify(U.CHANGE_RANK),this}SetStacks(e){return e>this.Options.MaxStacks&&(e=this.Options.MaxStacks),e<0&&(e=0),this.stacks=e,this.Event.Notify(U.CHANGE_STACKS),this}HasCondition(e){return this.conditions.has(e.toUpperCase())}SetConditions(...e){this.conditions.clear();for(let a of e)a=a.toUpperCase(),this.Options.Conditions.includes(a)&&this.conditions.size<this.Options.MaxConditions&&this.conditions.add(a);return this.Event.Notify(U.CHANGE_CONDITIONS),this}GetConditions(){return Array.from(this.conditions)}HasAura(e){return this.auras.has(e)}SetAuras(...e){const a=this.Options.ValidAuras;this.auras.clear();for(const n of e)this.auras.size<this.Options.MaxAuras&&(a.length===0||a.length>0&&a.includes(n))&&this.auras.add(n);return this.Event.Notify(U.CHANGE_AURAS),this}GetAuras(){return Array.from(this.auras)}Affected(e){for(const a of this.auras)if(_e(a)===e)return!0;return!1}TargetRegister(e){const a=this.register.get(e);if(!!a)return a.String()}Register(){const e=this.GetTargets().map(n=>n.GetCharacter().Options.Name+`
`+this.TargetRegister(n)||""),a=[];for(let n=0;n<e.length;n++)a[2*n]=e[n],a[2*n+1]=" ".repeat(4);return rt(...a)}};function ft(e){const a=z({ApplySelf:!0,ApplyOther:!1,StackSelf:!1,MaxTargets:0,Conditions:[],MaxConditions:0,MaxAuras:0,ValidAuras:[],MaxRank:1,MaxStacks:0},e);return a.Conditions=a.Conditions.map(n=>n.toUpperCase()),Object.assign(function(s){return new Bn(a,s)},st(z({},e),{Options:e}))}function bn(e,a){return!(Number.isFinite(a.g)&&!(e>(a.g||0))||Number.isFinite(a.geq)&&!(e>=(a.geq||0))||Number.isFinite(a.l)&&!(e<(a.l||0))||Number.isFinite(a.leq)&&!(e<=(a.leq||0)))}function Kn(e,a,n){if(n.name){if(typeof n.name=="string"){if(e.Options.Name.toLowerCase()!==n.name.toLowerCase())return!1}else if(!e.Options.Name.match(n.name))return!1}if(e.GetAscension()<(n.ascension||0)||n.weapon&&n.weapon.length>0&&!n.weapon.some(E=>e.Options.Weapon===E))return!1;const s=e.Get(c.HP_CURRENT),i=e.Get(c.ENERGY_CURRENT);return!(n.hp&&!bn(s,n.hp)||n.energy&&!bn(i,n.energy)||n.shielded!==void 0&&e.IsShielded()!==n.shielded||n.isOwner!==void 0&&e===a!==n.isOwner)}function wn(e,a){return!(a.affected&&a.affected.length>0&&e.Affected&&!a.affected.some(s=>{var i;return(i=e.Affected)==null?void 0:i.call(e,s)})||a.aura&&a.aura.length>0&&!a.aura.some(s=>e.HasAura(s)))}function dE(e,a,n,s){return!(e.target&&!Kn(n,a,e.target)||e.owner&&!Kn(a,a,e.owner)||e.enemy&&!wn(n.GetEnemy(),e.enemy)||e.effect&&(!wn(s,e.effect)||e.effect.conditions&&e.effect.conditions.length>0&&!e.effect.conditions.some(l=>s.HasCondition(l))))}function gE(e,a,n,s){let i=dE(e,a,n,s);return e.not&&(i=!i),i}var RE=class{constructor(e){this.builder=e,this.target=[],this.owner=[],this.party=!1}Target(...e){return this.target=e,this.builder}Owner(...e){return this.owner=e,this.builder}Party(e){return this.party=e,this.builder}getTarget(){return this.target}getOwner(){return this.owner}getParty(){return this.party}},kt=class{constructor(e){this.builder=e}Next(){return this.builder.Next()}Build(){return this.builder.Build()}Where(e){return this.builder.Where(e),this}};function Ut(e,a){const n=[];for(const s of a)typeof s=="string"?e.filter(l=>l.Options.Name.toLowerCase()===s.toLowerCase()).forEach(l=>n.push(l)):typeof s=="function"?e.filter(l=>s(l)).forEach(l=>n.push(l)):e.filter(l=>l.Options.Name.match(s)).forEach(l=>n.push(l));return n}var IE=class extends kt{constructor(){super(...arguments),this.instances=[],this.mods=new Map,this.stat=[],this.target=0,this.usestacks=!1,this.values=[]}MapStat(e){return this.mapStatFn=e,this}Char(...e){return this.stat=e,this.target=0,this}Enemy(...e){return this.stat=e,this.target=1,this}Instance(...e){return this.instances=e,this.target=2,this}Values(...e){return this.usestacks=!1,this.values=e.map(a=>[a]),this}Stacks(...e){return this.usestacks=!0,e.length>0&&(this.values=e),this}Rank(e){return this.rankFn=e,this}Map(e){return this.mapFn=e,this}onBuild(e,a,n){const s=[];this.mapStatFn&&(this.stat=this.mapStatFn(e,a,n));const i=this.target===2?Ut(e.GetInstances(),this.instances):[];switch(this.target){case 0:for(const l of this.stat)s.push(n.Modifier(e.GetCharacter().CreateModifier(l,0)));break;case 1:for(const l of this.stat)s.push(n.Modifier(e.GetCharacter().GetEnemy().Subject.CreateModifier(l,0)));break;case 2:for(const l of this.stat)for(const E of i)s.push(n.Modifier(E.Subject.CreateModifier(l,0)));break;default:throw new Error("Cannot create the modifier. Unknown target "+String(this.target).valueOf())}this.mods.set(e,s)}onEnable(e,a,n){const s=this.mods.get(e);if(!s)return;if(this.values.length===0){s.forEach(_=>_.SetValue(0));return}let i;this.rankFn?i=this.rankFn(e,a,n):i=a.GetRank(),i>this.values.length&&(i=this.values.length);const l=this.values[i-1];let E=OE(this.usestacks,l,a.GetStacks());this.mapFn&&(E=this.mapFn(E,e,a,n));for(const _ of s)_.GetValue()!==E&&_.SetValue(E)}onDisable(e){const a=this.mods.get(e);!a||a.forEach(n=>n.SetValue(0))}};function OE(e,a,n){if(e){const s=a.length;return s===1?a[0]*n:s>1?(n>s-1&&(n=s-1),a[n]):0}else return a[0]}var DE=class extends kt{constructor(){super(...arguments),this.infusions=new Map,this.element=c.NONE,this.max=!1}Set(e,a){return this.element=e,this.max=a,this}onBuild(e,a,n){if(this.element!==c.NONE){const s=n.Infusion(e.GetCharacter().AddInfusion(this.element,this.max));this.infusions.set(e,s)}}onEnable(e,a){const n=this.infusions.get(e);n&&(n.Enabled=a.Enabled())}onDisable(e){const a=this.infusions.get(e);a&&(a.Enabled=!1)}},vE=class extends kt{constructor(){super(...arguments),this.mvs=new Map,this.mults=new Map,this.type="mv",this.stat=c.NONE,this.value=0,this.instances=[]}Mv(e,a,...n){return this.stat=e,this.value=a,this.instances=n,this.type="mv",this}Multiplier(e,...a){return this.value=e,this.type="mult",this.instances=a,this}Map(e){return this.mapFn=e,this}onBuild(e,a,n){const s=Ut(e.GetInstances(),this.instances);if(this.type==="mv"&&this.stat!==c.NONE&&this.value>0){const i=n.Mv({Enabled:!1,Stat:this.stat,Value:this.value},...s);this.mvs.set(e,i)}else if(this.type==="mult"&&this.value>0){const i=n.Multiplier({Enabled:!1,Value:this.value},...s);this.mults.set(e,i)}}onEnable(e,a,n){let s=this.mvs.get(e),i=this.mults.get(e);!s&&!i&&(this.onBuild(e,a,n),s=this.mvs.get(e),i=this.mults.get(e)),s&&(this.mapFn?s.Value=this.mapFn(this.value,e,a,n):s.Value=this.value),i&&(this.mapFn?i.Value=this.mapFn(this.value,e,a,n):i.Value=this.value)}onDisable(e){const a=this.mvs.get(e),n=this.mults.get(e);a&&(a.Value=0),n&&(n.Value=0)}},yE=class extends kt{constructor(){super(...arguments),this.store=new Map,this.location="Extra"}Location(e){return this.location=e,this}Options(e){return this.options=e,this}Basic(e){return this.builder.instance.Options({Name:e.Name,Element:e.Element,Talent:e.Talent||c.NONE,Scaling:[{Initial:0,Stat:c.NONE,Talent:c.NONE,Scaling:Ya.NONE}]}).Next().mv.Mv(e.Stat,e.Values[0],e.Name).Map((a,n,s)=>{const i=Math.max(1,Math.min(e.Values.length,s.GetRank()))-1;return e.Values[i]}),this}onBuild(e,a,n){if(!this.options)return;const s=Nt(e.GetCharacter(),this.options);s[1].forEach(i=>n.Observer(i)),n.Instance(e,this.location,s[0]),this.store.set(e,s)}onEnable(e){const a=this.store.get(e);!a||(a[1].forEach(n=>n.Notify()),e.AddInstance(this.location,a[0]))}onDisable(e){const a=this.store.get(e);!a||e.RemoveInstance(this.location,a[0])}},ot=class{constructor(){this.query={},this.container=[this],this.observe=new RE(this),this.stat=new IE(this),this.infusion=new DE(this),this.mv=new vE(this),this.instance=new yE(this),this.parts=[this.stat,this.infusion,this.mv,this.instance]}innerBuild(...[e,a,n]){n.StartQuery(this.query);const s=this.parts;s.forEach(_=>_.onBuild(e,a,n));const i=()=>s.forEach(_=>_.onEnable(e,a,n)),l=()=>s.forEach(_=>_.onDisable(e,a,n)),E=()=>{a.Enabled()&&gE(this.query,a.Owner.GetCharacter(),e.GetCharacter(),a)?i():l()};E();for(const _ of this.observe.getTarget())n.Observer(e.GetCharacter().CreateObserver(_,E));for(const _ of this.observe.getOwner())n.Observer(a.Owner.GetCharacter().CreateObserver(_,E));return this.observe.getParty()&&n.Observer(e.Event.CreateObserver(Lt.CHANGE_PARTY,E)),n.EndQuery(),E}Build(){return(...[e,a,n])=>{const s=this.container.map(A=>A.innerBuild(e,a,n)),i=()=>s.forEach(A=>A());i();const l=e.GetCharacter(),E=a.Owner.GetCharacter(),_=l.GetEnemy();for(const A of[U.CHANGE_RANK,U.CHANGE_STACKS,U.CHANGE_CONDITIONS,U.CHANGE_AURAS,U.ENABLE,U.DISABLE])n.Observer(a.CreateObserver(A,i));for(const A of[c.LEVEL,c.ASCENSION,c.HP_CURRENT,c.ENERGY_CURRENT,c.SHIELDED])n.Observer(l.CreateObserver(A,i)),n.Observer(E.CreateObserver(A,i));return n.Observer(_.Event.CreateObserver(lt.CHANGE_AURA,i)),()=>0}}Next(){const e=new ot;return e.container=this.container,this.container.push(e),e}Where(e){return this.query=e,this}};function ve(e){return{enabled:e.Enabled(),rank:e.GetRank(),stacks:e.GetStacks(),auras:e.GetAuras(),conditions:e.GetConditions()}}function ye(e,a){e.enabled?a.Enable():a.Disable(),a.SetRank(e.rank),a.SetStacks(e.stacks),a.SetAuras(...e.auras),a.SetConditions(...e.conditions)}var Yn=[ft({Name:"ResonancePyro",ApplyOther:!0,OnApply:new ot().stat.Char(c.ATK_PERCENT).Values(.25).Build()})],Fn=[ft({Name:"ResonanceHydro",ApplyOther:!0,OnApply:new ot().stat.Char(c.HP_PERCENT).Values(.25).Build()})],Vn=[ft({Name:"ResonanceCryo",ApplyOther:!0,OnApply:new ot().stat.Char(c.EXTRA_CRIT_RATE).Where({enemy:{affected:[c.CRYO_DMG]}}).Values(.15).Build()})],xn=[ft({Name:"ResonanceGeo",ApplyOther:!0,OnApply:new ot().stat.Enemy(c.GEO_RES).Values(-.15).Next().Where({target:{shielded:!0}}).stat.Char(c.ALL_DMG).Values(.15).Build()})],kn=[ft({Name:"ResonanceDendro",ApplyOther:!0,Conditions:["BURNING","QUICKEN","BLOOM","AGGRAVATE","SPREAD","HYPERBLOOM","BURGEON"],MaxConditions:7,OnApply:new ot().stat.Char(c.ELEMENTAL_MASTERY).Values(50).Next().stat.Char(c.ELEMENTAL_MASTERY).Values(30).Where({effect:{conditions:["BURNING","QUICKEN","BLOOM"]}}).Next().stat.Char(c.ELEMENTAL_MASTERY).Values(20).Where({effect:{conditions:["AGGRAVATE","SPREAD","HYPERBLOOM","BURGEON"]}}).Build()})],Un={[c.PYRO_DMG]:Yn,[c.HYDRO_DMG]:Fn,[c.CRYO_DMG]:Vn,[c.GEO_DMG]:xn,[c.DENDRO_DMG]:kn},Wn=[];for(const e of Object.values(Un))e.forEach(a=>Wn.push(a));function jn(){return Wn}function qn(e){return Un[e]}var HE=class{constructor(...e){this.handler=new Vt(new me({Name:"__party__",Region:Ga.NONE,Stars:4,Element:0,Weapon:0,BurstCost:0})),this.members=new Q(a=>a.GetCharacter().Options.Name),this.resonances=[],this.enemies=new Oa,e.forEach(a=>this.Add(a))}GetAppliedEffects(e){return this.GetAllEffects().filter(a=>a.GetTargets().includes(e))}GetResonances(){return this.resonances}GetAllEffects(){const e=[];return this.members.Get().forEach(a=>a.GetEffects().forEach(n=>e.push(n))),this.resonances.forEach(a=>e.push(a)),e}FindEffects(e){return e=e.toLowerCase(),this.GetAllEffects().filter(a=>a.Options.Name.toLowerCase()===e)}Add(e){if(this.members.Get().length>=4||this.members.Has(e))return!1;const a=e.GetParty();return a&&a.Remove(e),e.SetParty(this),this.members.Add(e),this.updateResonances(),this.members.Get().forEach(n=>n.Event.Notify(Lt.CHANGE_PARTY)),this.enemies.Add(e.GetCharacter().GetEnemy()),!0}Remove(e){return this.members.Remove(e),e.SetParty(void 0),this.updateResonances(),this.members.Get().forEach(a=>a.Event.Notify(Lt.CHANGE_PARTY)),e.Event.Notify(Lt.CHANGE_PARTY),this.enemies.Remove(e.GetCharacter().GetEnemy()),!0}GetMembers(){return this.members.Get()}FindMember(e){return this.members.Find(e)}updateResonances(){if(this.resonances.forEach(s=>s.Disable().UnapplyAll()),this.resonances=[],this.members.Get().length<4)return;const e={};ut.forEach(s=>e[s]=0),this.members.Get().forEach(s=>e[s.GetCharacter().Options.Element]++);const a=[];ut.forEach(s=>{e[s]>=2&&a.push(s)}),a.map(s=>qn(s)).filter(s=>!!s).forEach(s=>s==null?void 0:s.forEach(i=>{const l=i(this.handler);l.Enable(),this.members.Get().forEach(E=>l.Apply(E)),this.resonances.push(l)}))}},f={};O(f,{Export:()=>Qn,Factory:()=>PE,Import:()=>$n,Weapon:()=>zn});var zn=class{constructor(e,a){this.Options=e,this.effects=new Q(n=>n.Options.Name),this.level=1,this.ascension=0,this.rank=1,this.effects.AddList(a)}Equip(e){return this.target&&this.Unequip(),this.target=e,this.effects.Get().forEach(a=>a.Enable().Apply(e)),this.atkMod=e.GetCharacter().CreateModifier(c.ATK_BASE,0),this.subMod=e.GetCharacter().CreateModifier(this.Options.Substat,0),this.setMods(),this}Unequip(){var e,a;return this.effects.Get().forEach(n=>n.Disable().UnapplyAll()),(e=this.atkMod)==null||e.Disable(),(a=this.subMod)==null||a.Disable(),this.atkMod=void 0,this.subMod=void 0,this.target=void 0,this}GetLevel(){return this.level}GetAscension(){return this.ascension}IsAscended(){return this.GetAscension()===ht(this.level)}GetRank(){return this.rank}GetSubstat(){return this.Options.Substat}GetAtkBase(){return za(this.Options.Stars,this.Options.Scaling,this.level,this.ascension)}GetSubstatValue(){return Qa(this.Options.Scaling,this.level,this.Options.Substat)}GetEffects(){return this.effects.Get()}FindEffect(e){return this.effects.Find(e)}SetLevel(e){e=Math.max(1,Math.min(90,Math.floor(e)));const a=Yt(e),n=ht(e);let s=this.ascension;return s<a?s=a:s>n&&(s=n),this.ascension=s,this.level=e,this.setMods(),this}SetAscension(e){const a=Yt(this.level),n=ht(this.level);let s=e;return s<a?s=a:s>n&&(s=n),this.ascension=Math.floor(s),this.setMods(),this}SetRank(e){return e=Math.max(1,Math.min(5,Math.floor(e))),this.rank=e,this.effects.Get().forEach(a=>a.SetRank(e)),this}setMods(){var e,a;const n=this.GetAtkBase(),s=this.GetSubstatValue();(e=this.atkMod)==null||e.SetValue(n),(a=this.subMod)==null||a.SetValue(s)}};function PE(e){return Object.assign(function(n){const s=e.Effects.map(i=>i(n).Enable());return new zn(e,s).Equip(n)},e)}function Qn(e){return{level:e.GetLevel(),ascension:e.GetAscension(),rank:e.GetRank()}}function $n(e,a){a.SetLevel(e.level),a.SetAscension(e.ascension),a.SetRank(e.rank)}var I={};O(I,{Artifact:()=>is,Export:()=>rs,Import:()=>ls,Set:()=>BE,rolls:()=>Es,transform:()=>os});function BE(e){return e}var x=at("CHANGE_LEVEL","CHANGE_PIECE","CHANGE_STARS","CHANGE_SET","CHANGE_MAINSTAT","CHANGE_SUBSTAT"),Xn={};O(Xn,{CountRolls:()=>ns,FormatRolls:()=>ss});function Zn(e,a,n,s){const i=a;function*l(E,_,A,S){let u=0;if(A===e-1)u=i-S;else if(A===e){S===i&&(yield E);return}n[A]>u&&(u=n[A]);let h=_;s[A]<h&&(h=s[A]);const N=_-u;for(let L=u;L<=h;L++){const m=[...E,L];yield*l(m,N,A+1,S+L)}}return l([],i,0,0)}var ct=class{constructor(e){this.queue=new Ta([],(a,n)=>n.priority-a.priority,!1),e?(this.mirror=new Ta([],(a,n)=>a.priority-n.priority,!1),this.maxSize=e):this.maxSize=1/0}Length(){return this.queue.length}Push(e,a){const n={item:e,priority:a};if(this.queue.push(n),this.mirror&&(this.mirror.push(n),this.queue.length>this.maxSize)){const s=this.mirror.pop();s&&this.queue.remove(s)}}Pop(){const e=this.queue.pop();if(!e)throw new Error("Priority queue is empty");return[e.item,e.priority]}Extract(){const e=[];for(;this.queue.length>0;)e.push(this.Pop()[0]);return e}};function Jn(e){const a=[];for(const[n,s]of e.substats){if(n===0)continue;const i=bE(e.stars,n,s);a.push([n,i])}return a}function bE(e,a,n){if(n===0)return[];const s=[];for(let E=0;E<4;E++)s.push(Z(e,a,E));const i=new ct;ts.forEach(E=>{const _=E.map((S,u)=>S*s[u]).reduce((S,u)=>S+u,0),A=Math.floor(100*(Math.abs(_-n)/n));i.Push(E,-A)});const[l]=i.Pop();return l||[]}var KE=6,ts=[];for(let e=0;e<=KE;e++)for(const a of Zn(4,e,[0,0,0,0],[6,6,6,6]))ts.push(a);var wE=wc(Zc()),es=class{constructor(e){this.variables=e,this.ConstraintPrefix="_c_",this.ObjectivePrefix="_obj_",this._ints=[],this.objective={},this.constraints=[]}Ints(e){this._ints=e}Objective(e){return this.objective=e,e}Constraint(e,a){return this.constraints.push({left:e,right:a}),e}Format(){const e={},a={},n={};this.variables.forEach(s=>{const i=this.objective[s]||0;e[s]={[this.ObjectivePrefix]:i}}),this.constraints.forEach((s,i)=>{const l=this.ConstraintPrefix+i;a[l]={max:s.right},this.variables.forEach(E=>{const _=s.left[E];Number.isFinite(_)&&(e[E][l]=_)})});for(const s of this._ints)n[s]=!0;return{variables:e,constraints:a,ints:n}}Solve(e){const a=(0,wE.Solve)(z({optimize:this.ObjectivePrefix,opType:e},this.Format()));for(const n of this.variables)a[n]||(a[n]=0);return a}toString(){return this.String()}String(){let e=this.variables.map(n=>"var "+n+(this._ints.includes(n)?" integer":"")+";").join(`
`);const a=this.Matrix();e+=`

maximize z: `+this.strExpr(a.c)+`;

`;for(let n=0;n<a.A.length;n++)e+="subject to c"+n+": "+this.strExpr(a.A[n])+" <= "+a.b[n]+`;
`;return e}Matrix(){const e={c:[],A:[],b:[]};this.putIndex(e.c,this.objective);for(const{left:a,right:n}of this.constraints){e.b.push(n);const s=Array.from(Array(this.variables.length)).fill(0);this.putIndex(s,a),e.A.push(s)}return e}putIndex(e,a){for(const n in a){const s=a[n],i=this.variables.indexOf(n);i!==-1&&(e[i]=s)}}strExpr(e){return this.variables.map((a,n)=>e[n]===0?"":e[n]+"*"+a).filter(a=>a!=="").join(" + ").replace(/\+\s*-/g,"-")}};function He(e,a,n){return e+"_"+a+"_"+n}function as(e){const{level:a,stars:n}=e;if(a<0||a>20)throw new Error("Level must be between 0 and 20");if(n!==4&&n!==5)throw new Error("Stars must be 4 or 5");if(e.substats.length>4)throw new Error("Stats must be less or equal than 4");for(;e.substats.length<4;)e.substats.push([0,0]);const s=Math.floor(e.level/4),i=e.stars-2+s,l=i+1,E=e.substats.map(([M])=>M),_=e.substats.map(([,M])=>M),A=e.substats.map(([M])=>da.includes(M)?.5:.001),S=Le(e.stars),u=[];for(let M=0;M<4;M++)for(let p=0;p<4;p++)u.push(He("R",M,p));const h=new es(u);h.Ints(u);const N=h.Objective({});for(const M of u)N[M]=1;const L=h.Constraint({},l),m=h.Constraint({},-i);for(let M=0;M<4;M++){const p=h.Constraint({},S),g=h.Constraint({},_[M]+A[M]),D=h.Constraint({},-_[M]+A[M]);for(let R=0;R<4;R++){const y=He("R",M,R);p[y]=1,L[y]=1,m[y]=-1,g[y]=Z(n,E[M],R),D[y]=-g[y]}}const C=h.Solve("min");if(!C.feasible)throw new Error("[LP] Cannot find a feasible solution");const G=[];for(let M=0;M<4;M++){if(E[M]===0)continue;const p=[E[M],[]];for(let g=0;g<4;g++){const D=He("R",M,g),R=C[D]||0;p[1].push(R)}G.push(p)}return G}function ns(e,a="auto"){switch(a){case"auto":try{return as(e)}catch{return Jn(e)}case"lp":return as(e);case"brute":return Jn(e)}}function ss(e,a){const n=[];for(const[s,i]of a){const l=[];for(let E=0;E<4;E++){const _=Z(e,s,E);for(let A=0;A<i[E];A++)l.push(_)}n.push([s,l])}return n}var YE=0,is=class{constructor(e){this.piece=e,this.Locked=!1,this.Id=YE++,this.Event=new it(x.Length(),"ARTIFACT_EVENT"),this.enabled=!0,this.stars=4,this.level=0,this.substats=[],this.modifiers=[],this.observers=[],this.mainstat=Ae(e)[0]}GetPiece(){return this.piece}GetLevel(){return this.level}SetLevel(e){return this.stars===4?e=Math.min(16,e):this.stars===5&&(e=Math.min(20,e)),e<0&&(e=0),this.level=Math.floor(e),this.Event.Notify(x.CHANGE_LEVEL),this.Event.Notify(x.CHANGE_MAINSTAT),this}GetStars(){return this.stars}SetStars(e){if(e===4)this.GetLevel()>16&&this.SetLevel(16);else if(e===5)this.GetLevel()>20&&this.SetLevel(20);else throw new Error("Artifact stars must be 4 or 5");return this.stars=e,this.Event.Notify(x.CHANGE_STARS),this.Event.Notify(x.CHANGE_MAINSTAT),this}GetMainstat(){return this.mainstat}SetMainstat(e){if(Ae(this.piece).includes(e)){const n=this.substats.findIndex(l=>l.Stat===e),s=pt.filter(l=>!this.substats.find((E,_)=>_!==n&&E.Stat===l)),i=s.includes(this.mainstat)?this.mainstat:s[0];this.mainstat=e,n!==-1&&i&&this.SetSubstat(n,i),this.Event.Notify(x.CHANGE_MAINSTAT)}return this}GetMainstatValue(){return this.enabled?$a(this.stars,this.mainstat,this.level):0}GetSet(){return this.set}SetSet(e){return this.set=e,this.Event.Notify(x.CHANGE_SET),this}SubstatsLength(){return this.substats.length}AddSubstat(e,a){if(this.substats.length===4||!pt.includes(e)||[this.mainstat,...this.substats.map(i=>i.Stat)].includes(e))return!1;const s=Ne(this.stars,e);return a=Math.max(0,Math.min(s,a)),this.substats.push({Stat:e,Value:a}),this.Event.Notify(x.CHANGE_SUBSTAT),!0}GetSubstat(e){return this.substats[e].Stat}SetSubstat(e,a){if(this.mainstat===a||!pt.includes(a))return!1;const n=this.substats.findIndex((l,E)=>E!==e&&l.Stat===a),s=Z(this.stars,this.substats[e].Stat,1),i=Z(this.stars,a,1);return n>-1&&(this.substats[n].Stat=this.substats[e].Stat,this.substats[n].Value*=s/i),this.substats[e].Stat=a,this.substats[e].Value*=i/s,this.Event.Notify(x.CHANGE_SUBSTAT),!0}GetSubstatValue(e){return this.enabled?this.substats[e].Value:0}SetSubstatValue(e,a){const n=Ne(this.stars,this.substats[e].Stat);return a=Math.max(0,Math.min(n,a)),this.substats[e].Value=a,this.Event.Notify(x.CHANGE_SUBSTAT),this}ClearSubstats(){return this.substats.forEach(e=>e.Value=0),this.Event.Notify(x.CHANGE_SUBSTAT),this}FillSubstats(){const e=pt.filter(a=>a!==this.GetMainstat());for(let a=0;a<e.length;a++)this.AddSubstat(e[a],0);return this}FindSubstat(e){return this.substats.findIndex(a=>a.Stat===e)}Enable(){return this.enabled=!0,this.Event.Notify(x.CHANGE_MAINSTAT),this.Event.Notify(x.CHANGE_SUBSTAT),this}Disable(){return this.enabled=!1,this.Event.Notify(x.CHANGE_MAINSTAT),this.Event.Notify(x.CHANGE_SUBSTAT),this}Enabled(){return this.enabled}Unequip(){return this.character=void 0,this.modifiers.forEach(e=>e.Disable()),this.observers.forEach(e=>e.Remove()),this.modifiers=[],this.observers=[],this}Equip(e){this.character&&this.Unequip(),this.character=e;const a=e.CreateModifier(this.mainstat,this.GetMainstatValue()),n=this.Event.CreateObserver(x.CHANGE_MAINSTAT,()=>{a.SetProp(this.mainstat),a.SetValue(this.GetMainstatValue())}),s=[];for(let l=0;l<4;l++)s.push(e.CreateModifier(c.ATK_FLAT,0));const i=this.Event.CreateObserver(x.CHANGE_SUBSTAT,()=>{for(let l=0;l<4;l++)l<this.SubstatsLength()?(s[l].SetProp(this.GetSubstat(l)),s[l].SetValue(this.GetSubstatValue(l))):s[l].SetValue(0)});return i.Notify(),this.modifiers=[a,...s],this.observers=[n,i],this}Rolls(e="auto"){const a=this.substats.map(s=>[s.Stat,s.Value]);return ns({level:this.GetLevel(),stars:this.GetStars(),substats:a},e)}FormatRolls(){return ss(this.GetStars(),this.Rolls())}};function rs(e){const a={locked:e.Locked,piece:e.GetPiece(),stars:e.GetStars(),level:e.GetLevel(),set:e.GetSet(),mainstat:e.GetMainstat(),substats:[]};for(let n=0;n<e.SubstatsLength();n++)a.substats.push({stat:e.GetSubstat(n),value:e.GetSubstatValue(n)});return a}function ls(e,a){if(e.piece!==a.GetPiece())throw new Error(`Cannot import artifacts with incompatible pieces ${X.Name(e.piece)} -> ${X.Name(a.GetPiece())}`);a.Locked=!!e.locked,a.SetStars(e.stars),a.SetLevel(e.level),a.SetSet(e.set),a.SetMainstat(e.mainstat),e.substats.forEach(({stat:n,value:s},i)=>{if(!Number.isFinite(s)||s<0)throw new Error(`Invalid substat ${i} value: ${s}`);i<a.SubstatsLength()?(a.SetSubstat(i,n),a.SetSubstatValue(i,s)):a.AddSubstat(n,s)})}var os={};O(os,{Downgrade:()=>FE,Scale:()=>cs});function FE(e){e.GetStars()!==4&&(cs(e,4),e.SetStars(4))}function cs(e,a){const n=e.GetStars();for(let s=0;s<e.SubstatsLength();s++){const i=e.GetSubstat(s),l=e.GetSubstatValue(s),E=Z(n,i,0),_=Z(a,i,0),A=l*_/E;e.SetSubstatValue(s,A)}}var Es={};O(Es,{count:()=>Xn,equip:()=>Ts});var Ts={};O(Ts,{EquipRolls:()=>_s});function W(e,a,n){return e+"_"+a+"_"+n}function VE(e){const a=e.substats.length;for(let L=0;L<5-a;L++)e.substats.push([c.NONE,0]);const n=[c.HP_FLAT,c.ATK_FLAT,...e.mainstats],s=e.substats.map(([L])=>L),i=e.substats.map(([,L])=>L),l=s.length;function E(L,m){return s[L]!==n[m]}const _=[],A=new es(_),S=A.Objective({});for(let L=0;L<5;L++)for(let m=0;m<l;m++)_.push(W("S",m,L)),_.push(W("A",m,L)),s[m]===c.NONE?(S[W("A",m,L)]=2,S[W("S",m,L)]=1):(S[W("A",m,L)]=4,S[W("S",m,L)]=2);A.Ints(_);for(let L=0;L<5;L++){const m=A.Constraint({},-4),C=A.Constraint({},4),G=A.Constraint({},9);for(let M=0;M<l;M++)m[W("A",M,L)]=-1,C[W("A",M,L)]=1,G[W("S",M,L)]=1,A.Constraint({[W("A",M,L)]:1},E(M,L)?1:0),A.Constraint({[W("S",M,L)]:1,[W("A",M,L)]:E(M,L)?-6:0},0),A.Constraint({[W("S",M,L)]:-1,[W("A",M,L)]:E(M,L)?1:0},0)}for(let L=0;L<l;L++){const m=A.Constraint({},-i[L]);for(let C=0;C<5;C++)m[W("S",L,C)]=-1}const u=A.Solve("min");if(!u.feasible)throw new Error("[LP] Cannot find a feasible solution");const h={},N=[];for(let L=0;L<5;L++){N.push([]);for(let m=0;m<e.substats.length;m++){const[C,G]=e.substats[m];h[C]||(h[C]=0);const M=W("S",m,L),p=Math.max(0,Math.min(u[M]||0,G-h[C]));p>0&&C!==c.NONE&&N[L].push([C,p]),h[C]+=p}}return N}function _s(e){const a=VE(e);for(const n of a)for(const s of n){const i=Z(e.stars,s[0],e.tier);s[1]*=i}return a}function As(e){const a={},n={},s={};for(const _ of e.GetEffects())n[_.Options.Name]=ve(_);const i=e.GetWeapon();i&&(a[i.Options.Name]=Qn(i));const l=e.GetArtifacts();l&&X.Values().forEach(_=>s[_]=rs(l.Get(_)));const E=e.GetModifiers().map(_=>({stat:_.GetProp(),value:_.GetValue()}));return{character:_n(e.GetCharacter()),weapon:a,effects:n,artifacts:s,modifiers:E}}function Ss(e,a){const n=a.GetWeapon();if(n){const i=e.weapon[n.Options.Name];i&&$n(i,n)}const s=a.GetArtifacts();s&&X.Values().forEach(i=>{const l=e.artifacts[i];l&&ls(l,s.Get(i))});for(const i of a.GetEffects()){const l=e.effects[i.Options.Name];!l||ye(l,i)}a.ClearModifiers();for(const{stat:i,value:l}of e.modifiers)a.AddModifier(a.GetCharacter().CreateModifier(i,l));An(e.character,a.GetCharacter())}function xE(e){const a={};for(const i of e.GetMembers())a[i.GetCharacter().Options.Name]=As(i);const n={};for(const i of e.GetResonances())n[i.Options.Name]=ve(i);const s={};for(const i of e.GetAllEffects()){const l=i.Owner.GetCharacter().Options.Name;s[l]||(s[l]={}),s[l][i.Options.Name]=i.GetTargets().map(E=>E.GetCharacter().Options.Name)}return{characters:a,resonances:n,targets:s}}function kE(e,a){const n=a.GetMembers();for(const s of n){const i=e.characters[s.GetCharacter().Options.Name];i&&Ss(i,s)}for(const s of a.GetResonances()){const i=e.resonances[s.Options.Name];i&&ye(i,s)}for(const s of a.GetAllEffects()){const i=s.Owner.GetCharacter().Options.Name,l=s.Options.Name,E=e.targets[i];if(!E)continue;const _=E[l];if(!_)continue;const A=_.map(u=>n.find(h=>h.GetCharacter().Options.Name===u)),S=s.GetTargets();for(const u of n)A.includes(u)?S.includes(u)||s.Apply(u):s.Unapply(u)}}var Et={};O(Et,{Artbox:()=>qE});var J={};O(J,{ArchaicPetra:()=>zs,Berserker:()=>Qs,BlizzardStrayer:()=>$s,BloodstainedChivalry:()=>Bs,BraveHeart:()=>bs,CrimsonWitchOfFlames:()=>ks,DeepwoodMemories:()=>qs,DefenderWill:()=>Ks,DesertPavilionChronicle:()=>Ls,EchoesOfAnOffering:()=>ws,EmblemOfSeveredFate:()=>Vs,FindByName:()=>Wt,FlowerOfParadiseLost:()=>hs,Gambler:()=>Ps,GetList:()=>Xs,GildedDreams:()=>Hs,GladiatorsFinale:()=>Us,HeartOfDepth:()=>ys,HuskOfOpulentDreams:()=>vs,Instructor:()=>Fs,Lavawalker:()=>Ds,MaidenBeloved:()=>Os,MartialArtist:()=>Is,NoblesseOblige:()=>Ys,OceanHuedClam:()=>Rs,PaleFlame:()=>gs,ResolutionOfSojourner:()=>ds,RetracingBolide:()=>Gs,Scholar:()=>ps,ShimenawasReminiscence:()=>Ws,TenacityOfTheMillelith:()=>Cs,TheExile:()=>Ms,ThunderingFury:()=>ms,Thundersoother:()=>fs,VermillionHereafter:()=>Ns,ViridescentVenerer:()=>js,WanderersTroupe:()=>xs});var us={};O(us,{ArchaicPetra:()=>zs,Berserker:()=>Qs,BlizzardStrayer:()=>$s,BloodstainedChivalry:()=>Bs,BraveHeart:()=>bs,CrimsonWitchOfFlames:()=>ks,DeepwoodMemories:()=>qs,DefenderWill:()=>Ks,DesertPavilionChronicle:()=>Ls,EchoesOfAnOffering:()=>ws,EmblemOfSeveredFate:()=>Vs,FlowerOfParadiseLost:()=>hs,Gambler:()=>Ps,GildedDreams:()=>Hs,GladiatorsFinale:()=>Us,HeartOfDepth:()=>ys,HuskOfOpulentDreams:()=>vs,Instructor:()=>Fs,Lavawalker:()=>Ds,MaidenBeloved:()=>Os,MartialArtist:()=>Is,NoblesseOblige:()=>Ys,OceanHuedClam:()=>Rs,PaleFlame:()=>gs,ResolutionOfSojourner:()=>ds,RetracingBolide:()=>Gs,Scholar:()=>ps,ShimenawasReminiscence:()=>Ws,TenacityOfTheMillelith:()=>Cs,TheExile:()=>Ms,ThunderingFury:()=>ms,Thundersoother:()=>fs,VermillionHereafter:()=>Ns,ViridescentVenerer:()=>js,WanderersTroupe:()=>xs});var hs=I.Set({Name:"FlowerOfParadiseLost",Stars:5,Piece2:[r.Factory({Name:"FlowerOfParadiseLost2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[r.Factory({Name:"FlowerOfParadiseLost4",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.BLOOM_DMG,t.stat.HYPERBLOOM_DMG,t.stat.BURGEON_DMG).Values(.4).Next().stat.Char(t.stat.BLOOM_DMG,t.stat.HYPERBLOOM_DMG,t.stat.BURGEON_DMG).Values(.4*.25).Stacks().Next().Build()})]}),Ls=I.Set({Name:"DesertPavilionChronicle",Stars:5,Piece2:[r.Factory({Name:"DesertPavilionChronicle2",OnApply:new r.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"DesertPavilionChronicle4",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.4).Build()})]}),Ns=I.Set({Name:"VermillionHereafter",Stars:5,Piece2:[r.Factory({Name:"VermillionHereafter2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"VermillionHereafter4",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.08).Next().stat.Char(t.stat.ATK_PERCENT).Values(.1).Stacks().Build()})]}),fs=I.Set({Name:"Thundersoother",Stars:5,Piece2:[],Piece4:[r.Factory({Name:"Thundersoother4",OnApply:new r.Builder().Where({enemy:{affected:[t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.35).Build()})]}),ms=I.Set({Name:"ThunderingFury",Stars:5,Piece2:[r.Factory({Name:"ThunderingFury2",OnApply:new r.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"ThunderingFury4",OnApply:new r.Builder().stat.Char(t.stat.OVERLOAD_DMG,t.stat.ELECTROCHARGE_DMG,t.stat.SUPERCONDUCT_DMG,t.stat.HYPERBLOOM_DMG).Values(.4).Next().stat.Char(t.stat.AGGRAVATE_DMG).Values(.2).Build()})]}),Ms=I.Set({Name:"TheExile",Stars:4,Piece2:[r.Factory({Name:"TheExile2",OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[]}),Cs=I.Set({Name:"TenacityOfTheMillelith",Stars:5,Piece2:[r.Factory({Name:"TenacityOfTheMillelith2",OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2).Build()})],Piece4:[r.Factory({Name:"TenacityOfTheMillelith4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()})]}),ps=I.Set({Name:"Scholar",Stars:4,Piece2:[r.Factory({Name:"Scholar2",OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[]}),Gs=I.Set({Name:"RetracingBolide",Stars:5,Piece2:[],Piece4:[r.Factory({Name:"RetracingBolide4",OnApply:new r.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.4).Build()})]}),ds=I.Set({Name:"ResolutionOfSojourner",Stars:4,Piece2:[r.Factory({Name:"ResolutionOfSojourner2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"ResolutionOfSojourner4",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_RATE).Values(.3).Build()})]}),gs=I.Set({Name:"PaleFlame",Stars:5,Piece2:[r.Factory({Name:"PaleFlame2",OnApply:new r.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.25).Build()})],Piece4:[r.Factory({Name:"PaleFlame4",MaxStacks:2,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.09).Stacks().Next().stat.Char(t.stat.PHYSICAL_DMG).Stacks([0,0,.25]).Build()})]}),Rs=I.Set({Name:"OceanHuedClam",Stars:5,Piece2:[r.Factory({Name:"OceanHuedClam2",OnApply:new r.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.15).Build()})],Piece4:[r.Factory({Name:"OceanHuedClam4",MaxStacks:3e4,OnApply(e,a,n){const[,,s]=n.Instance(e,"Extra",pe("HIT_OceanHuedClam",e.GetCharacter()));s.Options.Def=!1,s.Options.Crit=!1,s.Options.Dmg=!1;const i=n.Modifier(s.Subject.CreateModifier(t.stat.DMG_FLAT,0));function l(){const E=a.GetStacks()*.9;i.SetValue(E)}return l(),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_STACKS,l)),()=>0}})]}),Is=I.Set({Name:"MartialArtist",Stars:4,Piece2:[r.Factory({Name:"MartialArtist2",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"MartialArtist4",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.25).Build()})]}),Os=I.Set({Name:"MaidenBeloved",Stars:5,Piece2:[r.Factory({Name:"MaidenBeloved2",OnApply:new r.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.15).Build()})],Piece4:[]}),Ds=I.Set({Name:"Lavawalker",Stars:5,Piece2:[],Piece4:[r.Factory({Name:"Lavawalker4",OnApply:new r.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.35).Build()})]}),vs=I.Set({Name:"HuskOfOpulentDreams",Stars:5,Piece2:[r.Factory({Name:"HuskOfOpulentDreams2",OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Build()})],Piece4:[r.Factory({Name:"HuskOfOpulentDreams4",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT,t.stat.GEO_DMG).Values(.06).Stacks().Build()})]}),ys=I.Set({Name:"HeartOfDepth",Stars:5,Piece2:[r.Factory({Name:"HeartOfDepth2",OnApply:new r.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"HeartOfDepth4",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.3).Build()})]}),Hs=I.Set({Name:"GildedDreams",Stars:5,Piece2:[r.Factory({Name:"GildedDreams2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[r.Factory({Name:"GildedDreams4",OnApply(e,a,n){const s=e.GetCharacter(),i=s.Options.Element,l=n.Modifier(s.CreateModifier(t.stat.ELEMENTAL_MASTERY,0)),E=n.Modifier(s.CreateModifier(t.stat.ATK_PERCENT,0));function _(){const A=e.GetParty();if(!A){l.SetValue(0),E.SetValue(0);return}let S=0,u=0;for(const h of A.GetMembers())h!==e&&(h.GetCharacter().Options.Element===i?S++:u++);S=Math.min(3,S),u=Math.min(3,u),E.SetValue(.14*S),l.SetValue(50*u)}return _(),n.Observer(e.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,_)),()=>0}})]}),Ps=I.Set({Name:"Gambler",Stars:4,Piece2:[r.Factory({Name:"Gambler2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.2).Build()})],Piece4:[]}),Bs=I.Set({Name:"BloodstainedChivalry",Stars:5,Piece2:[r.Factory({Name:"BloodstainedChivalry2",OnApply:new r.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.25).Build()})],Piece4:[r.Factory({Name:"BloodstainedChivalry4",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.5).Build()})]}),bs=I.Set({Name:"BraveHeart",Stars:4,Piece2:[r.Factory({Name:"BraveHeart2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"BraveHeart4",OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.3).Build()})]}),Ks=I.Set({Name:"DefendersWill",Stars:4,Piece2:[r.Factory({Name:"DefendersWill2",OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Build()})],Piece4:[]}),ws=I.Set({Name:"EchoesOfAnOffering",Stars:5,Piece2:[r.Factory({Name:"EchoesOfAnOffering2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"EchoesOfAnOffering4",Conditions:["AVERAGE","MAXIMUM"],MaxConditions:1,OnApply:new r.Builder().Where({effect:{conditions:["MAXIMUM"]}}).mv.Mv(t.stat.ATK,.7,e=>e.Options.Talent===t.stat.NORMAL_ATTACK_DMG).Next().Where({effect:{conditions:["AVERAGE"]}}).mv.Mv(t.stat.ATK,.7*.502,e=>e.Options.Talent===t.stat.NORMAL_ATTACK_DMG).Build()})]}),Ys=I.Set({Name:"NoblesseOblige",Stars:5,Piece2:[r.Factory({Name:"NoblesseOblige2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.2).Build()})],Piece4:[r.Factory({Name:"NoblesseOblige4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()})]}),Fs=I.Set({Name:"Instructor",Stars:4,Piece2:[r.Factory({Name:"Instructor2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[r.Factory({Name:"Instructor4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(120).Build()})]}),Vs=I.Set({Name:"EmblemOfSeveredFate",Stars:5,Piece2:[r.Factory({Name:"EmblemOfSeveredFate2",OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[r.Factory({Name:"EmblemOfSeveredFate4",OnApply:new r.Builder().observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.25).Map((e,a)=>Math.max(0,Math.min(.75,e*a.GetCharacter().Get(t.stat.ENERGY_RECHARGE)))).Build()})]}),xs=I.Set({Name:"WanderersTroupe",Stars:5,Piece2:[r.Factory({Name:"WanderersTroupe2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[r.Factory({Name:"WanderersTroupe4",OnApply:new r.Builder().stat.Where({target:{weapon:[t.weapon.BOW,t.weapon.CATALYST]}}).Char(t.stat.CHARGED_ATTACK_DMG).Values(.35).Build()})]}),ks=I.Set({Name:"CrimsonWitchOfFlames",Stars:5,Piece2:[r.Factory({Name:"CrimsonWitchOfFlames2",OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"CrimsonWitchOfFlames4",MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.VAPORIZE_DMG,t.stat.MELT_DMG).Values(.15).Next().stat.Char(t.stat.OVERLOAD_DMG,t.stat.BURGEON_DMG,t.stat.BURNING_DMG).Values(.4).Next().stat.Char(t.stat.PYRO_DMG).Values(.075).Stacks().Build()})]}),Us=I.Set({Name:"GladiatorsFinale",Stars:5,Piece2:[r.Factory({Name:"GladiatorsFinale2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"GladiatorsFinale4",OnApply:new r.Builder().Where({target:{weapon:[t.weapon.CLAYMORE,t.weapon.SWORD,t.weapon.POLEARM]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.35).Build()})]}),Ws=I.Set({Name:"ShimenawasReminiscence",Stars:5,Piece2:[r.Factory({Name:"ShimenawasReminiscence2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"ShimenawasReminiscence4",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.5).Build()})]}),js=I.Set({Name:"ViridescentVenerer",Stars:5,Piece2:[r.Factory({Name:"ViridescentVenerer2",OnApply:new r.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"ViridescentVenerer4_1",OnApply:new r.Builder().stat.Char(t.stat.SWIRL_DMG).Values(.6).Build()}),r.Factory({Name:"ViridescentVenerer4",ApplyOther:!0,ValidAuras:t.Swirlable,MaxAuras:5,OnApply(e,a,n){const s=e.GetCharacter().GetEnemy(),i=WE.map(E=>n.Modifier(s.Subject.CreateModifier(E,0)));function l(){if(a.Owner.GetCharacter().Options.Element!==t.stat.ANEMO_DMG)return;const E=a.GetAuras().map(_=>t.DmgToRes(t.AuraToDmg(_)));for(const _ of i)E.includes(_.GetProp())?_.SetValue(UE):_.SetValue(0)}return l(),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_AURAS,l)),()=>0}})]}),UE=-.4,WE=t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG).map(e=>t.DmgToRes(e)),qs=I.Set({Name:"DeepwoodMemories",Stars:5,Piece2:[r.Factory({Name:"DeepwoodMemories2",OnApply:new r.Builder().stat.Char(t.stat.DENDRO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"DeepwoodMemories4",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.DENDRO_RES).Values(-.3).Build()})]}),zs=I.Set({Name:"ArchaicPetra",Stars:5,Piece2:[r.Factory({Name:"ArchaicPetra2",OnApply:new r.Builder().stat.Char(t.stat.GEO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"ArchaicPetra4",MaxAuras:1,ApplyOther:!0,ValidAuras:t.Swirlable,OnApply(e,a,n){const s=e.GetCharacter(),i=t.Elements.filter(E=>E!==t.stat.PHYSICAL_DMG).map(E=>n.Modifier(s.CreateModifier(E,0)));function l(){const E=a.GetAuras().map(_=>t.AuraToDmg(_));for(const _ of i)E.includes(_.GetProp())?_.SetValue(.4):_.SetValue(0)}return n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_AURAS,l)),()=>0}})]}),Qs=I.Set({Name:"Berserker",Stars:4,Piece2:[r.Factory({Name:"Berserker2",OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.12).Build()})],Piece4:[r.Factory({Name:"Berserker4",OnApply:new r.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.CRIT_RATE).Values(.24).Build()})]}),$s=I.Set({Name:"BlizzardStrayer",Stars:5,Piece2:[r.Factory({Name:"BlizzardStrayer2",OnApply:new r.Builder().stat.Char(t.stat.CRYO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"BlizzardStrayer4",OnApply:new r.Builder().Where({enemy:{affected:[t.stat.CRYO_DMG]}}).stat.Char(t.stat.EXTRA_CRIT_RATE).Values(.2).Next().Where({enemy:{aura:[t.aura.FROZEN]}}).stat.Char(t.stat.EXTRA_CRIT_RATE).Values(.2).Next().Build()})]}),jE=Object.values(us).sort((e,a)=>e.Stars===a.Stars?e.Name.localeCompare(a.Name):e.Stars-a.Stars),Pe=new Q(e=>e.Name);Pe.AddList(jE);function Xs(){return Pe.Get()}function Wt(e){return Pe.Find(e)}function Zs(e){const a=[];for(const i of e){if(!i)continue;const l=a.find(E=>E[0].toLowerCase()===i.toLowerCase());l?l[1]++:a.push([i.toLowerCase(),1])}const n=[],s=[];for(const i of a)i[1]>=4?(n.push([i[0],4]),s.push(i[0]),s.push(i[0])):i[1]>=2&&(n.push([i[0],2]),s.push(i[0]));return[n,s]}var qE=class{constructor(e){this.target=e,this.effects=new Q(a=>a.Options.Name),this.sets=[],this.artifacts=X.Values().map(a=>{const n=new is(a).Equip(e.GetCharacter());return n.Event.CreateObserver(x.CHANGE_SET,()=>this.onChangeSet()),n})}GetArtifacts(){return this.artifacts}GetActiveSets(){return this.sets}onChangeSet(){const[e,a]=Zs(this.artifacts.map(n=>n.GetSet()||""));this.effects.Get().forEach(n=>n.Disable().UnapplyAll()),this.effects.Clear(),this.sets=a;for(const[n,s]of e){if(!n)continue;const i=Wt(n);!i||(s>=2&&i.Piece2.map(l=>{const E=l(this.target).Enable();return E.Apply(this.target),E}).forEach(l=>this.effects.Add(l)),s>=4&&i.Piece4.map(l=>{const E=l(this.target).Enable();return E.Apply(this.target),E}).forEach(l=>this.effects.Add(l)))}}UnequipAll(){return this.artifacts.forEach(e=>e.Unequip()),this}EquipAll(){return this.artifacts.forEach(e=>e.Equip(this.target.GetCharacter())),this}GetEffects(){return this.effects.Get()}FindEffect(e){return this.effects.Find(e)}Get(e){return this.artifacts[e]}Remove(){this.UnequipAll(),this.effects.Get().forEach(e=>e.Disable().UnapplyAll())}EquipRolls(e){try{const a=_s(z({stars:5,mainstats:[this.artifacts[2].GetMainstat(),this.artifacts[3].GetMainstat(),this.artifacts[4].GetMainstat()]},e));return this.artifacts.forEach((n,s)=>{const i=a[s];n.ClearSubstats(),i.forEach(([l,E],_)=>{n.SubstatsLength()<=_?n.AddSubstat(l,E):(n.SetSubstat(_,l),n.SetSubstatValue(_,E))})}),!0}catch(a){return console.error("[EQUIP SUBSTATS]",a),!1}}RollSummary(){const e=Js(),a=[],n={};for(const s of this.artifacts){const i=s.Rolls();for(const[l,E]of i){n[l]===void 0&&(n[l]=a.length,a.push([l,Js()]));const[,_]=a[n[l]];for(let A=0;A<4;A++)_[A]+=E[A]||0,e[A]+=E[A]||0,_[4]+=E[A]||0,e[4]+=E[A]||0}for(let l=0;l<s.SubstatsLength();l++){const E=s.GetSubstat(l),_=s.GetSubstatValue(l),A=Math.round(_/Z(s.GetStars(),E,4));e[5]+=A,a[n[E]][1][5]+=A}}return{result:a,total:e}}},Js=()=>[0,0,0,0,0,0],jt={};O(jt,{Rotation:()=>zE});var zE=class{constructor(){this.characters=new Q(e=>e.GetCharacter().Options.Name),this.actions=[],this.damage=0,this.Duration=NaN,this.details=[]}SetCharacters(...e){return this.characters.Clear(),this.characters.AddList(e),this}Run(){let e=-1;return this.Log&&(e=this.Log.Line),this.damage=0,this.details=[],this.actions.forEach(a=>this.runAction(a)),this.Log&&(this.Log.Line=e),this.damage}AddFn(e,a){return this.actions.push({fn:e,line:a}),this}AddHit(e,a,n,s,i,l){return i=Math.max(0,Math.min(1,i)),s=Math.max(0,Math.min(i,s)),this.actions.push({hit:{charname:e,hitname:a,multiplier:n,aura:i,reaction:s},line:l}),this}Clear(){return this.actions=[],this}GetDetails(){const e={};return this.details.forEach((a,n)=>{e[a.charname]||(e[a.charname]=[]),e[a.charname][n]=a}),e}GetSummary(){const e={damage:this.damage,dps:this.damage/this.Duration,duration:this.Duration,characters:{}};for(const a of this.characters.Get())e.characters[a.GetCharacter().Options.Name]={relative:0,damage:0,dps:0,elements:{},talents:{},instances:{}};for(const{charname:a,hitname:n,talent:s,element:i,damage:l}of this.details){const E=e.characters[a];E.damage+=l,E.elements[i]||(E.elements[i]={damage:0,relative:0}),E.elements[i].damage+=l,E.talents[s]||(E.talents[s]={damage:0,relative:0}),E.talents[s].damage+=l,E.instances[n]||(E.instances[n]={damage:0,relative:0}),E.instances[n].damage+=l}for(const a in e.characters){const n=e.characters[a];n.dps=n.damage/this.Duration,n.relative=n.damage/this.damage;for(const s in n.instances)n.instances[s].relative=n.instances[s].damage/n.damage;for(const s in n.talents)n.talents[s].relative=n.talents[s].damage/n.damage;for(const s in n.elements)n.elements[s].relative=n.elements[s].damage/n.damage}return e}getCharacter(e){const a=this.characters.Find(e);return a||this.Log&&this.Log.Errorf("Character not found: %s",e),a}getInstance(e,a){const n=this.getCharacter(e);if(!n)return;const s=n.FindInstance(a);return s||this.Log&&this.Log.Errorf("Instance %s not found in character %s",a,e),s}addDamage(e){this.damage+=e.damage,this.Log&&this.details.push(e)}runAction(e){if(e.line&&this.Log&&(this.Log.Line=e.line),e.fn){e.fn();return}if(!e.hit)return;const{hit:a}=e,n=this.getCharacter(a.charname);if(!n)return;const s=this.getInstance(a.charname,a.hitname);if(!s)return;const i=n.GetCharacter().Options.Name,l=s.Options.Name,E=n.GetCharacter().GetEnemy(),_=E.GetAuras(),A=s.DmgAvg(!0),S=s.DmgAvg(!1);E.SetAuras();const u=s.DmgAvg(!1),h=u;E.SetAuras(..._);const N=Tn(u,h,S,A,a.aura,a.reaction),L=a.multiplier*N;this.addDamage({charname:i,hitname:l,talent:s.Options.Talent,element:s.GetElement(),damage:L,single_damage:N,multiplier:a.multiplier,auras:_,noaura_noreaction:u,noaura_yesreaction:h,yesaura_noreaction:S,yesaura_yesreaction:A,aura:a.aura,reaction:a.reaction}),this.Log&&this.Log.Logf("%s hit %s did (%.2f * %.2f) = %.2f damage",i,l,a.multiplier,N,L)}},Tt={};O(Tt,{Albedo:()=>Hi,Alhaitham:()=>yi,Amber:()=>vi,Ayaka:()=>Mi,Ayato:()=>mi,Beidou:()=>Pi,Bennett:()=>Fi,Chongyun:()=>Oi,Collei:()=>Ii,Cyno:()=>Ri,Diluc:()=>gi,Eula:()=>di,FindByName:()=>WL,Fischl:()=>Vi,Ganyu:()=>Gi,GetList:()=>Wi,Gorou:()=>pi,HuTao:()=>bi,Itto:()=>Di,Jean:()=>Ci,Kazuha:()=>xi,Keqing:()=>fi,Klee:()=>Ni,Kokomi:()=>Ai,Mona:()=>Li,Nahida:()=>Ui,Ningguang:()=>hi,Noelle:()=>ui,Raiden:()=>Yi,Rosaria:()=>Si,Sara:()=>ki,Shenhe:()=>_i,Sucrose:()=>Ti,Tartaglia:()=>Ei,Venti:()=>ci,Wanderer:()=>oi,Xiangling:()=>li,Xiao:()=>ri,Xingqiu:()=>Bi,Yae:()=>ii,Yanfei:()=>si,Yelan:()=>Ki,Yoimiya:()=>ni,Yunjin:()=>ai,Zhongli:()=>wi});var ti={};O(ti,{Albedo:()=>Hi,Alhaitham:()=>yi,Amber:()=>vi,Ayaka:()=>Mi,Ayato:()=>mi,Beidou:()=>Pi,Bennett:()=>Fi,Chongyun:()=>Oi,Collei:()=>Ii,Cyno:()=>Ri,Diluc:()=>gi,Eula:()=>di,Fischl:()=>Vi,Ganyu:()=>Gi,Gorou:()=>pi,HuTao:()=>bi,Itto:()=>Di,Jean:()=>Ci,Kazuha:()=>xi,Keqing:()=>fi,Klee:()=>Ni,Kokomi:()=>Ai,Mona:()=>Li,Nahida:()=>Ui,Ningguang:()=>hi,Noelle:()=>ui,Raiden:()=>Yi,Rosaria:()=>Si,Sara:()=>ki,Shenhe:()=>_i,Sucrose:()=>Ti,Tartaglia:()=>Ei,Venti:()=>ci,Wanderer:()=>oi,Xiangling:()=>li,Xiao:()=>ri,Xingqiu:()=>Bi,Yae:()=>ii,Yanfei:()=>si,Yelan:()=>Ki,Yoimiya:()=>ni,Yunjin:()=>ai,Zhongli:()=>wi});var T={};O(T,{ArrObjTable:()=>iT,Artifact:()=>eT,ArtifactRolls:()=>nT,Character:()=>XE,Effect:()=>JE,EffectDetail:()=>tT,Enemy:()=>rT,Horizontal:()=>rt,Instance:()=>$E,ObjArrTable:()=>sT,Rotation:()=>oT,Table:()=>k,hits:()=>QE,labels:()=>v});var k=class{constructor(...e){this.DecimalPlaces=2,this.HeaderLine=!0,this.rows=[e],this.n_cols=e.length}AddRow(...e){for(;e.length<this.n_cols;)e.push("");return this.rows.push(e),this}GetHeaders(){return this.rows[0]}GetRows(){return this.rows.slice(1)}toString(){return this.String()}String(){const e=this.n_cols,a=this.rows.length,n=[],s=[];for(let l=0;l<e;l++){let E=0;for(let _=0;_<a;_++){const A=this.rows[_][l];let S;typeof A=="number"?S=A.toFixed(this.DecimalPlaces):S=(A==null?void 0:A.toString())||"",S.length>E&&(E=S.length),n[_*e+l]=S}s[l]=E}for(let l=0;l<e;l++)for(let E=0;E<a;E++){const _=s[l];for(;n[E*e+l].length<_;)n[E*e+l]+=" "}let i="";for(let l=0;l<a;l++){for(let E=0;E<e;E++)i+=n[l*e+E]+" | ";if(this.HeaderLine&&l===0){i+=`
`;const E=i.length;for(let _=0;_<E;_++)i+="-"}i+=`
`}return i}};function ei(...e){const a={};return e.forEach(n=>{if(typeof n=="string")a[n]=n;else for(const s in n)a[s]=s}),a}var QE=ei("HIT_N1","HIT_N1_1","HIT_N1_2","HIT_N1_3","HIT_N1_4","HIT_N2","HIT_N2_1","HIT_N2_2","HIT_N2_3","HIT_N2_4","HIT_N3","HIT_N3_1","HIT_N3_2","HIT_N3_3","HIT_N3_4","HIT_N4","HIT_N4_1","HIT_N4_2","HIT_N4_3","HIT_N4_4","HIT_N5","HIT_N5_1","HIT_N5_2","HIT_N5_3","HIT_N5_4","HIT_N6","HIT_N6_1","HIT_N6_2","HIT_N6_3","HIT_N6_4","HIT_CHARGED","HIT_CHARGED_1","HIT_CHARGED_2","HIT_CHARGED_3","HIT_CHARGED_4","HIT_CHARGED_SPIN","HIT_CHARGED_FINAL","HIT_PLUNGE","HIT_PLUNGE_LOW","HIT_PLUNGE_HIGH","HIT_AIMED_NORMAL","HIT_AIMED_CHARGED","HIT_E","HIT_E_PRESS","HIT_E_HOLD","HIT_E_DOT","HIT_E_1","HIT_E_1_1","HIT_E_1_2","HIT_E_2","HIT_E_2_1","HIT_E_2_2","HIT_E_3","HIT_E_3_1","HIT_E_3_2","HIT_E_4","HIT_E_EXPLOSION","HIT_Q","HIT_Q_EXPLOSION","HIT_Q_DOT","HIT_Q_1","HIT_Q_2","HIT_Q_3","HIT_WEAPON_HIT","HIT_WEAPON_HIT_N1","HIT_WEAPON_HIT_N2","HIT_WEAPON_HIT_N3","HIT_WEAPON_HIT_N4","HIT_WEAPON_HIT_N5","HIT_WEAPON_HIT_N6","HIT_OVERLOAD","HIT_SHATTER","HIT_SUPERCONDUCT","HIT_ELECTROCHARGE","HIT_SWIRL_PYRO","HIT_SWIRL_HYDRO","HIT_SWIRL_CRYO","HIT_SWIRL_ELECTRO","HIT_BLOOM","HIT_HYPERBLOOM","HIT_BURNING","HIT_BURGEON"),v=ei("REGION","NONE","NAME","MV","STAT","HIT","ELEMENT","TALENT","VALUE","NO_CRIT","CRIT","AVG","STAT_BASE","STAT_FLAT","STAT_PERCENT","STAT_TOTAL","SET","PIECE","LEVEL","BONUS","STARS","CHARACTER","ASCENDED","CURRENT","WEAPON","ARTIFACT","EFFECT","ENABLED","STACKS","AURA","TARGET","CONDITION","DAMAGE","MIN","MAX","HIT","OWNER","RELATIVE","BENEFIT","ROTATION_DAMAGE","DPS");function $E(...e){const a=new k(v.HIT,v.ELEMENT,v.TALENT,v.NO_CRIT,v.CRIT,v.AVG);return e.forEach(n=>a.AddRow(n.Options.Name,t.stat.Name(n.GetElement()),t.stat.Name(n.Options.Talent),n.DmgNoCrit(!0),n.DmgCrit(!0),n.DmgAvg(!0))),a.String()}function XE(...e){const a=[];for(let n=0;n<e.length;n++)a[2*n]=ZE(e[n]),a[2*n+1]=" ".repeat(4);return rt(...a)}function ZE(e){var a;const n=e.GetCharacter();let s;n.IsAscended()?s="+":s="";let i=`(${n.Options.Stars}*) ${n.Options.Name} ${n.GetLevel()}${s}`;i+=` (${n.Get(t.stat.NORMAL_ATTACK_LEVEL)}/${n.Get(t.stat.ELEMENTAL_SKILL_LEVEL)}/${n.Get(t.stat.ELEMENTAL_BURST_LEVEL)})
`;const l=e.GetWeapon();l?(l.IsAscended()?s="+":s="",i+=`(${l.Options.Stars}*) ${l.Options.Name} ${l.GetLevel()}${s} (R${l.GetRank()})
`):i+=`(No weapon)
`;const E=(a=e.GetArtifacts())==null?void 0:a.GetActiveSets();if(E&&E.length>0){const S=E.map(u=>{var h;return(h=Wt(u))==null?void 0:h.Name});S[0]===S[1]?i+=S[0]+` (4)
`:S.forEach(u=>{u&&u!==""&&(i+=u+` (2)
`)})}const _=new k(v.STAT,v.VALUE);_.DecimalPlaces=4,_.AddRow(t.stat.Name(t.stat.ATK),n.Get(t.stat.ATK)),_.AddRow(t.stat.Name(t.stat.DEF),n.Get(t.stat.DEF)),_.AddRow(t.stat.Name(t.stat.HP),n.Get(t.stat.HP)),_.AddRow(t.stat.Name(t.stat.CRIT_RATE),n.Get(t.stat.CRIT_RATE)),_.AddRow(t.stat.Name(t.stat.CRIT_DMG),n.Get(t.stat.CRIT_DMG)),_.AddRow(t.stat.Name(t.stat.ENERGY_RECHARGE),n.Get(t.stat.ENERGY_RECHARGE)),_.AddRow(t.stat.Name(t.stat.ELEMENTAL_MASTERY),n.Get(t.stat.ELEMENTAL_MASTERY));const A=n.Options.Element;return _.AddRow(t.stat.Name(A),n.Get(A)),i+=_.String(),i}function JE(...e){const a=new k(v.NAME,v.ENABLED,v.STACKS,v.OWNER,v.TARGET);for(const n of e){const s=n.GetTargets().map(i=>i.GetCharacter().Options.Name);a.AddRow(n.Options.Name,n.Enabled(),n.GetStacks(),n.Owner.GetCharacter().Options.Name,s.join(", "))}return a.String()}function tT(e){let a=e.Options.Name+`
`;const n=new k(v.OWNER,v.ENABLED,v.STACKS);n.AddRow(e.Owner.GetCharacter().Options.Name,e.Enabled(),e.GetStacks()+"/"+e.Options.MaxStacks),a+=n.String()+`
`;const s=new k(v.TARGET);for(const E of e.GetTargets())s.AddRow(E.GetCharacter().Options.Name);const i=new k(v.CONDITION);for(const E of e.Options.Conditions)i.AddRow(E+" ("+e.HasCondition(E)+")");const l=new k(v.AURA);for(const E of t.aura.Values())e.HasAura(E)&&l.AddRow(t.aura.Name(E));return a+=rt(s.String(),i.String(),l.String()),a}function eT(...e){const a=[];for(let n=0;n<e.length;n++)a[2*n]=aT(e[n]),a[2*n+1]=" ".repeat(4);return rt(...a)}function aT(e){let a=`(${e.GetStars()}*) ${t.piece.Name(e.GetPiece())} (+${e.GetLevel()})
`;const n=e.GetSet();if(n){const i=Wt(n);i?a+=v.SET+": "+i.Name+`
`:a+=v.SET+": "+v.NONE+`
`}else a+=v.SET+": "+v.NONE+`
`;const s=new k(v.STAT,v.VALUE);s.DecimalPlaces=4,s.AddRow(t.stat.Name(e.GetMainstat()),e.GetMainstatValue());for(let i=0;i<e.SubstatsLength();i++)s.AddRow(t.stat.Name(e.GetSubstat(i)),e.GetSubstatValue(i));return a+=s.String(),a}function nT(e){const a=e.FormatRolls(),n=new k(v.STAT,"","","","","","");return a.forEach(([s,i])=>n.AddRow(t.stat.Name(s),...i)),n.DecimalPlaces=4,`${t.piece.Name(e.GetPiece())}
`+n}function sT(e){const a=Object.keys(e),n=new k(...a),s=Math.max(...a.map(i=>e[i].length));for(let i=0;i<s;i++){const l=[];for(const E of a)i<e[E].length?l.push(e[E][i]):l.push(void 0);n.AddRow(...l)}return n}function iT(e){const a=[];for(const s of e){const i=Object.keys(s);for(const l of i)a.includes(l)||a.push(l)}const n=new k(...a);for(const s of e)n.AddRow(...a.map(i=>s[i]));return n}function rT(...e){const a=[];for(let n=0;n<e.length;n++)a[2*n]=lT(e[n]),a[2*n+1]=" ".repeat(4);return rt(...a)}function lT(e){const a=new k(v.STAT,v.STAT_BASE,v.STAT_TOTAL);a.AddRow(v.LEVEL,"",e.GetLevel());for(const s of t.Elements){const i=t.DmgToRes(s);a.AddRow(t.stat.Name(i),e.GetBaseRes(i),e.Subject.Get(i))}const n=new k(v.AURA);for(const s of t.aura.Values())e.HasAura(s)&&n.AddRow(t.aura.Name(s));return a.DecimalPlaces=4,e.name+`
`+rt(a.String(),n.String())}function oT(e){const a=Object.keys(e.characters).map(s=>s+`
`+cT(s,e.characters[s])),n=[];for(let s=0;s<a.length;s++)n[2*s]=a[s],n[2*s+1]=" ".repeat(4);return`${v.ROTATION_DAMAGE}: ${e.damage.toFixed(2)}

${v.DPS}: ${e.dps.toFixed(2)}

`+rt(...n)}function cT(e,a){const n=new k(v.NAME,v.DAMAGE,v.RELATIVE);n.AddRow(e,a.damage,qt(a.relative));for(const s in a.elements){const i=parseInt(s);n.AddRow(t.stat.Name(i),a.elements[s].damage,qt(a.elements[s].relative))}for(const s in a.talents){const i=parseInt(s);n.AddRow(t.stat.Name(i),a.talents[s].damage,qt(a.talents[s].relative))}for(const s in a.instances)n.AddRow(s,a.instances[s].damage,qt(a.instances[s].relative));return n.toString()}var qt=e=>e*100,Be=new Set,be=[.025,.05,.075,.115];function ET(e){const a=e.FindEffect("YunjinA4");if(!a||!a.Enabled()||e.GetCharacter().GetAscension()<4)return 0;const n=e.GetParty();if(!n)return be[0];Be.clear();for(const i of n.GetMembers()){const l=i.GetCharacter().Options.Element;Be.add(l)}const s=Math.max(1,Math.min(be.length,Be.size));return be[s-1]}var TT=r.Factory({Name:"YunjinA4",OnApply(e,a,n){const s=e.FindEffect("YunjinQ");if(!s)throw new Error("Yunjin Burst effect not found");const i=s;function l(){i.Enabled()&&(i.Disable(),i.Enable())}return l(),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,l)),n.Observer(a.CreateObserver(r.EffectEvent.DISABLE,l)),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_TARGET,l)),()=>0}}),_T=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.44}]}],AT=r.Factory({Name:"YunjinQ",ApplyOther:!0,OnApply:new r.Builder().observe.Party(!0).observe.Owner(t.stat.DEF_PERCENT,t.stat.DEF_BASE,t.stat.DEF_FLAT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a,n)=>(.3216*e+ET(n.Owner))*n.Owner.GetCharacter().Get(t.stat.DEF)).Build()}),ST=r.Factory({Name:"YunjinC2",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.15).Build()}),uT=r.Factory({Name:"YunjinC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),hT=r.Factory({Name:"YunjinC4",OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.2).Build()}),LT=r.Factory({Name:"YunjinC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),NT=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4051}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4025}]},{Name:T.hits.HIT_N3_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2296}]},{Name:T.hits.HIT_N3_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2752}]},{Name:T.hits.HIT_N4_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2399}]},{Name:T.hits.HIT_N4_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2881}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6734}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2169}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],fT=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.4912}]},{Name:T.hits.HIT_E_1,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.6096}]},{Name:T.hits.HIT_E_2,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.728}]}],ai=d.Factory({Name:"Yunjin",Stars:4,Weapon:t.weapon.POLEARM,Element:t.stat.GEO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Region:t.region.LIYUE,BurstCost:60,HpBase:[893.5552,3197.1245],AtkBase:[16.0272,57.34638],DefBase:[61.5741,220.311],Normals:NT,Skills:fT,Bursts:_T,Extra:[],Effects:[AT,TT,ST,uT,hT,LT]}),mT=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.272}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.22}]}],MT=r.Factory({Name:"YoimiyaC1",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()}),CT=r.Factory({Name:"YoimiyaC2",OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Values(.25).Build()}),pT=r.Factory({Name:"YoimiyaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),GT=r.Factory({Name:"YoimiyaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),dT=r.Factory({Name:"YoimiyaC6",OnApply:new r.Builder().instance.Location("Normal").Options({Name:"HIT_C6",Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Talent:t.stat.NORMAL_ATTACK_LEVEL,Initial:.164*.6}]}).Build()}),gT=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3564}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6838}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8889}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4642}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0586}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_KindlingArrow",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.164}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],RT=r.Factory({Name:"YoimiyaA1",MaxStacks:10,OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.PYRO_DMG).Values(.02).Stacks().Build()}),IT=r.Factory({Name:"YoimiyaA4",ApplyOther:!0,ApplySelf:!1,OnApply(e,a,n){const s=e.GetCharacter(),i=a.Owner.GetCharacter(),l=a.Owner.FindEffect("YoimiyaA1");if(!l)throw new Error("Cannot find Yoimiya A1");const E=n.Modifier(s.CreateModifier(t.stat.ATK_PERCENT,0)),_=()=>{if(i.GetAscension()<4){E.SetValue(0);return}E.SetValue(.1+.01*l.GetStacks())};return _(),n.Observer(i.CreateObserver(t.stat.LEVEL,_)),n.Observer(i.CreateObserver(t.stat.ASCENSION,_)),n.Observer(l.CreateObserver(r.EffectEvent.CHANGE_STACKS,_)),()=>0}}),OT=r.Factory({Name:"YoimiyaE",OnApply:new r.Builder().infusion.Set(t.stat.PYRO_DMG,!0).Next().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.3791,/hit_n\d/i).Map((e,a)=>1+e*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),ni=d.Factory({Name:"Yoimiya",Stars:5,Weapon:t.weapon.BOW,Element:t.stat.PYRO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.INAZUMA,BurstCost:60,HpBase:[791.2556,3249.3232],AtkBase:[25.137,103.21857],DefBase:[47.864,196.56],Normals:gT,Skills:[],Bursts:mT,Extra:[],Effects:[OT,RT,IT,MT,CT,pT,GT,dT]}),DT=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.824}]}],vT=r.Factory({Name:"YanfeiQ",OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(...o.TalentScaling.ELEMENTAL_2).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(e=>.334*e).Build()}),yT=r.Factory({Name:"YanfeiC2",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_RATE).Values(.2).Build()}),HT=r.Factory({Name:"YanfeiC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),PT=r.Factory({Name:"YanfeiC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),BT=[{Name:T.hits.HIT_N1,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5834}]},{Name:T.hits.HIT_N2,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5213}]},{Name:T.hits.HIT_N3,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.7601}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_2,Initial:.9823}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],bT=r.Factory({Name:"YanfeiA1",OnApply(e,a,n){const s=e.GetCharacter(),i=e.FindEffect("YanfeiSeal");if(!i)throw new Error("Cannot find Yanfei Scarlet Seals");const l=n.Modifier(s.CreateModifier(t.stat.PYRO_DMG,0)),E=()=>{if(s.GetAscension()<1){l.SetValue(0);return}l.SetValue(i.GetStacks()*.05)};return E(),n.Observer(i.CreateObserver(r.EffectEvent.CHANGE_STACKS,E)),n.Observer(s.CreateObserver(t.stat.LEVEL,E)),n.Observer(s.CreateObserver(t.stat.ASCENSION,E)),()=>0}}),KT=r.Factory({Name:"YanfeiA4",OnApply:new r.Builder().Where({target:{ascension:4}}).instance.Location("Normal").Options({Name:"HIT_A4",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Initial:.8,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),wT=r.Factory({Name:"YanfeiSeal",MaxStacks:4,OnApply:new r.Builder().observe.Target(t.stat.NORMAL_ATTACK_LEVEL,t.stat.NORMAL_ATTACK_LEVEL_UP).mv.Mv(t.stat.ATK,.1733,"HIT_CHARGED").Map((e,a,n)=>e*n.GetStacks()*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.NORMAL_ATTACK_LEVEL)-1]).Build()}),YT=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.696}]}],si=d.Factory({Name:"Yanfei",Stars:4,Element:t.stat.PYRO_DMG,StatBonus:t.stat.PYRO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.LIYUE,BurstCost:80,HpBase:[784.14026,2805.64],AtkBase:[20.12304,72.001564],DefBase:[49.2135,176.085],Normals:BT,Skills:YT,Bursts:DT,Extra:[],Effects:[wT,vT,bT,KT,yT,HT,PT]}),FT=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.6}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.3382}]}],VT=r.Factory({Name:"YaeC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),xT=r.Factory({Name:"YaeC4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.2).Build()}),kT=r.Factory({Name:"YaeC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),UT=r.Factory({Name:"YaeC6",OnApply:new r.Builder().stat.Char(t.stat.DEFIGNORED).Instance(/HIT_E_\d/i).Values(.6).Build()}),WT=[{Name:T.hits.HIT_N1,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3966}]},{Name:T.hits.HIT_N2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3852}]},{Name:T.hits.HIT_N3,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5689}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4289}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],jT=r.Factory({Name:"YaeA4",OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({target:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.15/100).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()}),qT=[{Name:T.hits.HIT_E_1,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6067}]},{Name:T.hits.HIT_E_2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7584}]},{Name:T.hits.HIT_E_3,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.948}]},{Name:T.hits.HIT_E_4,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.185}]}],ii=d.Factory({Name:"Yae",Stars:5,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_RATE,Weapon:t.weapon.CATALYST,Region:t.region.INAZUMA,BurstCost:90,HpBase:[807.46204,3315.8757],AtkBase:[26.4404,108.57064],DefBase:[44.2742,181.818],Normals:WT,Skills:qT,Bursts:FT,Extra:[],Effects:[jT,VT,xT,kT,UT]}),zT=r.Factory({Name:"XiaoQ",OnApply:new r.Builder().infusion.Set(t.stat.ANEMO_DMG,!0).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(...o.TalentScaling.ELEMENTAL_2).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(e=>.5845*e).Build()}),QT=r.Factory({Name:"XiaoC2",OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.25).Build()}),$T=r.Factory({Name:"XiaoC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),XT=r.Factory({Name:"XiaoC4",OnApply:new r.Builder().Where({target:{hp:{leq:.5}}}).stat.Char(t.stat.DEF_PERCENT).Values(1).Build()}),ZT=r.Factory({Name:"XiaoC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),JT=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.2754}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.5694}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6855}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.3766}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.7154}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.9583}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.2109}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],t_=r.Factory({Name:"XiaoA1",MaxStacks:5,OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.ALL_DMG).Values(.05).Stacks().Build()}),e_=r.Factory({Name:"XiaoA4",MaxStacks:3,OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.15).Stacks().Build()}),a_=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.528}]}],ri=d.Factory({Name:"Xiao",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.CRIT_RATE,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,BurstCost:70,HpBase:[991.4528,4071.4412],AtkBase:[27.1852,111.628975],DefBase:[62.2232,255.528],Normals:JT,Skills:a_,Bursts:[],Extra:[],Effects:[zT,t_,e_,QT,$T,XT,ZT]}),n_=[{Name:T.hits.HIT_Q_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]},{Name:T.hits.HIT_Q_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_Q_3,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.096}]},{Name:"HIT_PYRONADO",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.12}]}],s_=r.Factory({Name:"XianglingC1",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.PYRO_RES).Values(-.15).Build()}),i_=r.Factory({Name:"XianglingC2",OnApply:new r.Builder().instance.Options({Name:"HIT_C2",Element:t.stat.PYRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.75,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),r_=r.Factory({Name:"XianglingC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),l_=r.Factory({Name:"XianglingC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),o_=r.Factory({Name:"XianglingC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Build()}),c_=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4205}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4214}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2606}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.141}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7104}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.2169}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],E_=r.Factory({Name:"XianglingA4",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.ATK_PERCENT).Values(.1).Build()}),T_=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1128}]}],li=d.Factory({Name:"Xiangling",Stars:4,Element:t.stat.PYRO_DMG,StatBonus:t.stat.ELEMENTAL_MASTERY,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,BurstCost:80,HpBase:[911.791,3262.3718],AtkBase:[18.87648,67.54129],DefBase:[56.0805,200.655],Normals:c_,Skills:T_,Bursts:n_,Extra:[],Effects:[E_,s_,i_,r_,l_,o_]}),__=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.472}]}],A_=r.Factory({Name:"WandererC1",OnApply(e,a,n){if(!e.FindEffect("WandererA4"))throw new Error("Cannot find Wanderer A4");let i;const l=()=>{const E=e.FindInstance("HIT_A4");!E||i||(i=n.Mv({Stat:t.stat.ATK,Value:.25,Enabled:!0},E))};return l(),n.Observer(e.GetCharacter().CreateObserver(t.stat.LEVEL,l)),n.Observer(e.GetCharacter().CreateObserver(t.stat.ASCENSION,l)),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,l)),n.Observer(a.CreateObserver(r.EffectEvent.DISABLE,l)),()=>0}}),S_=r.Factory({Name:"WandererC2",MaxStacks:120,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.04).Stacks().Map(e=>Math.min(2,e)).Build()}),u_=r.Factory({Name:"WandererC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),h_=r.Factory({Name:"WandererC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),L_=[{Name:T.hits.HIT_N1,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6871}]},{Name:T.hits.HIT_N2,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6502}]},{Name:T.hits.HIT_N3,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4764}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.3208}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]},{Name:T.hits.HIT_N1+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6871*.4}]},{Name:T.hits.HIT_N2+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6502*.4}]},{Name:T.hits.HIT_N3+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4764*.4}]}],N_=r.Factory({Name:"WandererA1",MaxAuras:1,ValidAuras:t.Swirlable,OnApply:new r.Builder().Where({target:{ascension:1},effect:{affected:[t.stat.PYRO_DMG]}}).stat.Char(t.stat.ATK_PERCENT).Values(.3).Next().Where({target:{ascension:1},effect:{affected:[t.stat.CRYO_DMG]}}).stat.Char(t.stat.CRIT_RATE).Values(.2).Build()}),f_=r.Factory({Name:"WandererA4",OnApply:new r.Builder().Where({target:{ascension:4}}).instance.Options({Name:"HIT_A4",Element:t.stat.ANEMO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.35,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),m_=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.952}]}],M_=r.Factory({Name:"WandererE",OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.3298,/hit_n\d/i).Map((e,a)=>1+e*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.2639,/hit_charged/i).Map((e,a)=>1+e*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),oi=d.Factory({Name:"Wanderer",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.SUMERU,BurstCost:60,HpBase:[791.2556,3249.3232],AtkBase:[25.5094,104.747734],DefBase:[47.2657,194.103],Normals:L_,Skills:m_,Bursts:__,Extra:[],Effects:[M_,N_,f_,A_,S_,u_,h_]}),C_=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.376}]}],p_=r.Factory({Name:"VentiQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,n){G_(e,a,n);function s(){const i=e.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!i)return;const l=a.GetAuras()[0];!l||(i.Options.Element=t.AuraToDmg(l))}return s(),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_AURAS,s)),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,s)),()=>0}}),G_=new r.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.188,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),d_=r.Factory({Name:"VentiC1",OnApply:new r.Builder().instance.Location("Normal").Options({Name:"HIT_C1",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:.4386*.33}]}).Next().instance.Location("Normal").Options({Name:"HIT_CHARGED_C1",Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:1.24*.33}]}).Next().Build()}),g_=r.Factory({Name:"VentiC2",ApplyOther:!0,Conditions:["AIRBORNE","NO_AIRBORNE"],MaxConditions:1,OnApply:new r.Builder().stat.Enemy(t.stat.ANEMO_RES,t.stat.PHYSICAL_RES).Values(-.12).Next().Where({effect:{conditions:["AIRBORNE"]}}).stat.Enemy(t.stat.ANEMO_RES,t.stat.PHYSICAL_RES).Values(-.12).Build()}),R_=r.Factory({Name:"VentiC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),I_=r.Factory({Name:"VentiC4",OnApply:new r.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.25).Build()}),O_=r.Factory({Name:"VentiC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),D_=r.Factory({Name:"VentiC6",ApplyOther:!0,OnApply(e,a,n){const s=e.GetCharacter().GetEnemy(),i=a.Owner.FindEffect("VentiQ");if(!i)throw new Error("Venti Q not found");n.Modifier(s.Subject.CreateModifier(t.stat.ANEMO_RES,-.2));const l=n.Modifier(s.Subject.CreateModifier(t.stat.ANEMO_RES,0)),E=()=>{const _=i.GetAuras();if(!_.length||_[0]===t.aura.NONE)l.SetValue(0);else{const A=t.DmgToRes(t.AuraToDmg(_[0]));l.SetValue(-.2),l.SetProp(A)}};return E(),n.Observer(i.CreateObserver(r.EffectEvent.CHANGE_AURAS,E)),()=>0}}),v_=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2038}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4438}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5237}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2606}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5065}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7095}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],y_=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.76}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.8}]}],ci=d.Factory({Name:"Venti",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Weapon:t.weapon.BOW,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[819.8552,3366.7688],AtkBase:[20.482,84.10402],DefBase:[52.0521,213.759],Normals:v_,Skills:y_,Bursts:C_,Extra:[],Effects:[p_,d_,g_,R_,I_,O_,D_]}),H_=[{Name:T.hits.HIT_Q+"_MELEE",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.64}]},{Name:T.hits.HIT_Q+"_RANGED",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.784}]},{Name:"HIT_RiptideBlast",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2}]}],P_=r.Factory({Name:"TartagliaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),B_=r.Factory({Name:"TartagliaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),b_=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4128}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4627}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5538}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5702}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6089}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7276}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_RiptideFlash",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.124}]},{Name:"HIT_RiptideBurst",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.62}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],K_=r.Factory({Name:"TartagliaA0",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_LEVEL_UP).Values(1).Build()}),w_=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]},{Name:T.hits.HIT_N1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3887}]},{Name:T.hits.HIT_N2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4162}]},{Name:T.hits.HIT_N3+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5633}]},{Name:T.hits.HIT_N4+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5994}]},{Name:T.hits.HIT_N5+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.553}]},{Name:T.hits.HIT_N6_1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3543}]},{Name:T.hits.HIT_N6_2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3767}]},{Name:T.hits.HIT_CHARGED_1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.602}]},{Name:T.hits.HIT_CHARGED_2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7198}]},{Name:"HIT_RiptideSlash",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.602}]}],Ei=d.Factory({Name:"Tartaglia",Stars:5,Weapon:t.weapon.BOW,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.HYDRO_DMG,Region:t.region.SNEZHNAYA,BurstCost:60,HpBase:[1020.0524,4188.8867],AtkBase:[23.4612,96.33733],DefBase:[63.4198,260.442],Normals:b_,Skills:w_,Bursts:H_,Extra:[],Effects:[K_,P_,B_]}),Y_=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.48}]}],F_=r.Factory({Name:"SucroseQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,n){V_(e,a,n);function s(){const i=e.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!i)return;const l=a.GetAuras()[0];!l||(i.Options.Element=t.AuraToDmg(l))}return s(),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_AURAS,s)),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,s)),()=>0}}),V_=new r.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.44,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),x_=r.Factory({Name:"SucroseC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),k_=r.Factory({Name:"SucroseC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),U_=r.Factory({Name:"SucroseC6",ApplyOther:!0,OnApply(e,a,n){const s=a.Owner.FindEffect("SucroseQ"),i=e.GetCharacter();if(!s)throw new Error("Cannot find Sucrose Q");const l=n.Modifier(i.CreateModifier(t.stat.PYRO_DMG,0)),E=()=>{const _=s.GetAuras();(!_.length||_[0]===t.aura.NONE)&&l.SetValue(0);const A=t.AuraToDmg(_[0]);l.SetProp(A),l.SetValue(.2)};return E(),n.Observer(s.CreateObserver(r.EffectEvent.CHANGE_AURAS,E)),()=>0}}),W_=[{Name:T.hits.HIT_N1,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3346}]},{Name:T.hits.HIT_N2,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3062}]},{Name:T.hits.HIT_N3,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3845}]},{Name:T.hits.HIT_N4,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4792}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.2016}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],j_=r.Factory({Name:"SucroseA1",ApplySelf:!1,ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(50).Build()}),q_=r.Factory({Name:"SucroseA4",ApplySelf:!1,ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_MASTERY).Where({owner:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(.2).Map((e,a,n)=>e*n.Owner.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()}),z_=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.112}]}],Ti=d.Factory({Name:"Sucrose",Stars:4,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ANEMO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.MONDSTADT,BurstCost:80,HpBase:[775.02234,2773.016],AtkBase:[14.2464,50.97456],DefBase:[58.94175,210.8925],Normals:W_,Skills:z_,Bursts:Y_,Extra:[],Effects:[F_,j_,q_,x_,k_,U_]}),Q_=r.Factory({Name:"ShenheA1",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.CRYO_DMG).Values(.15).Build()}),$_=r.Factory({Name:"ShenheA4",ApplyOther:!0,Conditions:["PRESS","HOLD"],MaxConditions:1,OnApply:new r.Builder().Where({owner:{ascension:4},effect:{conditions:["PRESS"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.15).Next().Where({owner:{ascension:4},effect:{conditions:["HOLD"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.15).Build()}),X_=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.008}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3312}]}],Z_=r.Factory({Name:"ShenheQ",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Enemy(t.stat.CRYO_RES,t.stat.PHYSICAL_RES).Values(-.06,-.07,-.08,-.09,-.1,-.11,-.12,-.13,-.14,-.15).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),J_=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4326}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4025}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5332}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2632}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6562}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1067}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],tA=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.392}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.888}]}],eA=r.Factory({Name:"ShenheE",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP,t.stat.ATK_PERCENT,t.stat.ATK_BASE,t.stat.ATK_FLAT).stat.Char(t.stat.CRYO_DMG_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a,n)=>.4566*e*n.Owner.GetCharacter().Get(t.stat.ATK)).Build()}),aA=r.Factory({Name:"ShenheC2",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.CRYO_CRIT_DMG).Values(.15).Build()}),nA=r.Factory({Name:"ShenheC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),sA=r.Factory({Name:"ShenheC4",MaxStacks:50,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.05).Stacks().Build()}),iA=r.Factory({Name:"ShenheC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),_i=d.Factory({Name:"Shenhe",Stars:5,Element:t.stat.CRYO_DMG,Weapon:t.weapon.POLEARM,StatBonus:t.stat.ATK_PERCENT,Region:t.region.LIYUE,BurstCost:80,HpBase:[1011.47253,4153.653],AtkBase:[23.6474,97.10191],DefBase:[64.6164,265.356],Normals:J_,Skills:tA,Bursts:X_,Extra:[],Effects:[eA,Z_,Q_,$_,aA,nA,sA,iA]}),rA=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1042}]}],lA=r.Factory({Name:"KokomiQ",OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.0484,/HIT_N\d/i).Map((e,a)=>e*o.TalentScaling.ELEMENTAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.0678,/charged/i).Map((e,a)=>e*o.TalentScaling.ELEMENTAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.071,/HIT_E$/i).Map((e,a)=>e*o.TalentScaling.ELEMENTAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Build()}),oA=r.Factory({Name:"KokomiC1",OnApply:new r.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.HYDRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.HP,Initial:.3,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Build()}),cA=r.Factory({Name:"KokomiC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),EA=r.Factory({Name:"KokomiC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),TA=r.Factory({Name:"KokomiC6",OnApply:new r.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.4).Build()}),_A=[{Name:T.hits.HIT_N1,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6838}]},{Name:T.hits.HIT_N2,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6154}]},{Name:T.hits.HIT_N3,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.9431}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4832}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],AA=r.Factory({Name:"KokomiA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.HEALING_BONUS).Values(.25).Next().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Values(-1).Next().Build()}),SA=r.Factory({Name:"KokomiA4",OnApply(e,a,n){const s=e.GetCharacter(),i=e.FindEffect("KokomiQ");if(!i)throw new Error("Kokomi Q effect not found");const l=Ut(e.GetNormals(),[/HIT_N\d/i]),E=Ut(e.GetNormals(),[/charged/i]),_=n.Mv({Stat:t.stat.HP,Value:0,Enabled:!0},...l),A=n.Mv({Stat:t.stat.HP,Value:0,Enabled:!0},...E),S=()=>{(!i.Enabled()||s.GetAscension()<4)&&(_.Value=0,A.Value=0);const u=s.Get(t.stat.HEALING_BONUS);_.Value=A.Value=.15*u};return S(),n.Observer(s.CreateObserver(t.stat.HEALING_BONUS,S)),n.Observer(i.CreateObserver(r.EffectEvent.ENABLE,S)),n.Observer(i.CreateObserver(r.EffectEvent.DISABLE,S)),()=>0}}),uA=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.0919}]}],Ai=d.Factory({Name:"Kokomi",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.HYDRO_DMG,Region:t.region.INAZUMA,BurstCost:70,HpBase:[1048.652,4306.332],AtkBase:[18.2476,74.92904],DefBase:[51.15465,210.0735],Normals:_A,Skills:uA,Bursts:rA,Extra:[],Effects:[lA,AA,SA,oA,cA,EA,TA]}),hA=[{Name:T.hits.HIT_Q_1,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.04}]},{Name:T.hits.HIT_Q_2,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.52}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]}],LA=r.Factory({Name:"RosariaC1",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.1).Build()}),NA=r.Factory({Name:"RosariaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),fA=r.Factory({Name:"RosariaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),mA=r.Factory({Name:"RosariaC6",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.PHYSICAL_RES).Values(-.2).Build()}),MA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5246}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.516}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3182}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6966}]},{Name:T.hits.HIT_N5_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4162}]},{Name:T.hits.HIT_N5_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.43}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.3674}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],CA=r.Factory({Name:"RosariaA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Values(.12).Build()}),pA=r.Factory({Name:"RosariaA4",ApplySelf:!1,ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.CRIT_RATE).Where({owner:{ascension:4}}).stat.Char(t.stat.CRIT_RATE).Values(.15).Map((e,a,n)=>Math.max(0,Math.min(1,e*n.Owner.GetCharacter().Get(t.stat.CRIT_RATE)))).Build()}),GA=[{Name:T.hits.HIT_E_1,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.584}]},{Name:T.hits.HIT_E_2,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.36}]}],Si=d.Factory({Name:"Rosaria",Stars:4,Weapon:t.weapon.POLEARM,Element:t.stat.CRYO_DMG,Region:t.region.MONDSTADT,StatBonus:t.stat.ATK_PERCENT,BurstCost:60,HpBase:[1030.3239,3686.4802],AtkBase:[20.12304,72.001564],DefBase:[59.514,212.94],Normals:MA,Skills:GA,Bursts:hA,Extra:[],Effects:[CA,pA,LA,NA,fA,mA]}),dA=[{Name:T.hits.HIT_Q_1,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672}]},{Name:T.hits.HIT_Q_2,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.928}]}],gA=r.Factory({Name:"NoelleQ",OnApply:new r.Builder().infusion.Set(t.stat.GEO_DMG,!0).Next().observe.Target(t.stat.DEF_FLAT,t.stat.DEF_PERCENT,t.stat.DEF_FLAT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(.4,.43,.46,.5,.53,.56,.6,.64,.68,.72,.76,.8,.85,.9,.95).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a)=>e*a.GetCharacter().Get(t.stat.DEF)).Build()}),RA=r.Factory({Name:"NoelleC2",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()}),IA=r.Factory({Name:"NoelleC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),OA=r.Factory({Name:"NoelleC4",OnApply:new r.Builder().instance.Location("Skill").Options({Name:"HIT_C4",Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:4}]}).Build()}),DA=r.Factory({Name:"NoelleC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),vA=r.Factory({Name:"NoelleC6",OnApply(e,a,n){const s=e.GetCharacter(),i=e.FindEffect("NoelleQ");if(!i)throw new Error("Noelle Q effect not found");const l=n.Modifier(s.CreateModifier(t.stat.ATK_FLAT,0)),E=()=>{i.Enabled()?l.SetValue(.5*s.Get(t.stat.DEF)):l.SetValue(0)};return E(),n.Observer(s.CreateObserver(t.stat.DEF_FLAT,E)),n.Observer(s.CreateObserver(t.stat.DEF_PERCENT,E)),n.Observer(s.CreateObserver(t.stat.DEF_BASE,E)),n.Observer(i.CreateObserver(r.EffectEvent.ENABLE,E)),n.Observer(i.CreateObserver(r.EffectEvent.DISABLE,E)),()=>0}}),yA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7912}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7336}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8626}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1343}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5074}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9047}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],HA=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:1.2}]}],ui=d.Factory({Name:"Noelle",Stars:4,Element:t.stat.GEO_DMG,StatBonus:t.stat.DEF_PERCENT,BurstCost:60,Region:t.region.MONDSTADT,Weapon:t.weapon.CLAYMORE,HpBase:[1012.088,3621.2327],AtkBase:[16.0272,57.34638],DefBase:[66.95325,239.5575],Normals:yA,Skills:HA,Bursts:dA,Extra:[],Effects:[gA,RA,IA,OA,DA,vA]}),PA=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.8696}]}],BA=r.Factory({Name:"NingguangC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),bA=r.Factory({Name:"NingguangC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),KA=[{Name:T.hits.HIT_N1,Element:t.stat.GEO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.28}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.7408}]},{Name:"HIT_Jade",Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.496}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],wA=r.Factory({Name:"NingguangA4",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.GEO_DMG).Values(.12).Build()}),YA=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.304}]}],hi=d.Factory({Name:"Ningguang",Stars:4,Element:t.stat.GEO_DMG,StatBonus:t.stat.GEO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.LIYUE,BurstCost:40,HpBase:[820.6119,2936.1348],AtkBase:[17.808,63.7182],DefBase:[48.069,171.99],Normals:KA,Skills:YA,Bursts:PA,Extra:[],Effects:[wA,BA,bA]}),FA=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.424}]}],VA=r.Factory({Name:"MonaQ",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ALL_DMG).Values(.4,.42,.44,.46,.48,.5,.52,.54,.56,.58,.6).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),xA=r.Factory({Name:"MonaC1",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELECTROCHARGE_DMG,t.stat.VAPORIZE_DMG).Values(.15).Next().stat.Char(t.stat.ALL_DMG).Instance("HIT_SWIRL_HYDRO").Values(.15).Build()}),kA=r.Factory({Name:"MonaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),UA=r.Factory({Name:"MonaC4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.15).Build()}),WA=r.Factory({Name:"MonaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),jA=r.Factory({Name:"MonaC6",MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.6).Stacks().Build()}),qA=[{Name:T.hits.HIT_N1,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.376}]},{Name:T.hits.HIT_N2,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.36}]},{Name:T.hits.HIT_N3,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.448}]},{Name:T.hits.HIT_N4,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5616}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.4972}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],zA=r.Factory({Name:"MonaA1",OnApply:new r.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_SKILL_LEVEL,Stat:t.stat.ATK,Initial:1.328*.5}]}).Build()}),QA=r.Factory({Name:"MonaA4",OnApply:new r.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.HYDRO_DMG).Values(.2).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ENERGY_RECHARGE)).Build()}),$A=[{Name:T.hits.HIT_E_DOT,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.32}]},{Name:T.hits.HIT_E_EXPLOSION,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.328}]}],Li=d.Factory({Name:"Mona",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[810.322,3327.62],AtkBase:[22.344,91.74984],DefBase:[50.8555,208.845],Normals:qA,Skills:$A,Bursts:FA,Extra:[],Effects:[VA,zA,QA,xA,kA,UA,WA,jA]}),XA=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4264}]}],ZA=r.Factory({Name:"KleeC1",OnApply:new r.Builder().instance.Location("Burst").Options({Name:"HIT_C1",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:.4264*1.2}]}).Build()}),JA=r.Factory({Name:"KleeC2",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.DEFREDUCTION).Values(.23).Build()}),tS=r.Factory({Name:"KleeC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),eS=r.Factory({Name:"KleeC4",OnApply:new r.Builder().instance.Location("Burst").Options({Name:"HIT_C4",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:5.55}]}).Build()}),aS=r.Factory({Name:"KleeC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),nS=r.Factory({Name:"KleeC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Build()}),sS=[{Name:T.hits.HIT_N1,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.7216}]},{Name:T.hits.HIT_N2,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.624}]},{Name:T.hits.HIT_N3,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.8992}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.5736}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],iS=r.Factory({Name:"KleeA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.5).Build()}),rS=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.952}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.328}]}],Ni=d.Factory({Name:"Klee",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.PYRO_DMG,StatBonus:t.stat.PYRO_DMG,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[800.7888,3288.4717],AtkBase:[24.206,99.39566],DefBase:[47.864,196.56],Normals:sS,Skills:rS,Bursts:XA,Extra:[],Effects:[iS,ZA,JA,tS,eS,aS,nS]}),lS=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.24}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.888}]}],oS=r.Factory({Name:"KeqingC1",OnApply:new r.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.5,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),cS=r.Factory({Name:"KeqingC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),ES=r.Factory({Name:"KeqingC4",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.25).Build()}),TS=r.Factory({Name:"KeqingC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),_S=r.Factory({Name:"KeqingC6",OnApply:new r.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.06).Build()}),AS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4102}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4102}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5444}]},{Name:T.hits.HIT_N4_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3148}]},{Name:T.hits.HIT_N4_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.344}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6699}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.768}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.86}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],SS=r.Factory({Name:"KeqingA1",OnApply:new r.Builder().Where({target:{ascension:1}}).infusion.Set(t.stat.ELECTRO_DMG,!1).Build()}),uS=r.Factory({Name:"KeqingA4",OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.CRIT_RATE,t.stat.ENERGY_RECHARGE).Values(.15).Build()}),hS=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.504}]},{Name:T.hits.HIT_E+"_SLASH",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.68}]},{Name:T.hits.HIT_E+"_SLASH_2",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]}],fi=d.Factory({Name:"Keqing",Stars:5,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_DMG,Weapon:t.weapon.SWORD,Region:t.region.LIYUE,BurstCost:40,HpBase:[1020.0524,4188.8867],AtkBase:[25.137,103.21857],DefBase:[62.2232,255.528],Normals:AS,Skills:hS,Bursts:lS,Extra:[],Effects:[SS,uS,oS,cS,ES,TS,_S]}),LS=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6646}]}],NS=r.Factory({Name:"AyatoQ",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.11,.12,.13,.14,.15,.16,.17,.18,.19,.2).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),fS=r.Factory({Name:"AyatoC1",OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Instance(/HIT_N\d_E/i).Values(.4).Build()}),mS=r.Factory({Name:"AyatoC2",OnApply(e,a,n){const s=e.FindEffect("AyatoE");if(!s)throw new Error("Cannot find Ayato Skill");const i=n.Modifier(e.GetCharacter().CreateModifier(t.stat.HP_PERCENT,0)),l=function(){s.GetStacks()>=3?i.SetValue(.5):i.SetValue(0)};return l(),n.Observer(s.CreateObserver(r.EffectEvent.CHANGE_STACKS,l)),()=>0}}),MS=r.Factory({Name:"AyatoC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),CS=r.Factory({Name:"AyatoC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),pS=r.Factory({Name:"AyatoC6",OnApply:new r.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:4.5}]}).Build()}),GS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4496}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4716}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5861}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2945}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.756}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2953}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],dS=[{Name:T.hits.HIT_N1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5289}]},{Name:T.hits.HIT_N2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5891}]},{Name:T.hits.HIT_N3+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6493}]},{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0148}]}],gS=r.Factory({Name:"AyatoE",MaxStacks:5,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Mv(t.stat.HP,.56/100,/HIT_N\d_E/i).Map((e,a,n)=>e*n.GetStacks()*o.TalentScaling.PHYSICAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),mi=d.Factory({Name:"Ayato",Stars:5,Weapon:t.weapon.SWORD,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.CRIT_DMG,Region:t.region.INAZUMA,BurstCost:80,HpBase:[1067.7184,4384.629],AtkBase:[23.275,95.57275],DefBase:[59.83,245.7],Normals:GS,Skills:dS,Bursts:LS,Extra:[],Effects:[gS,NS,fS,mS,MS,CS,pS]}),RS=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.123}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.6845}]}],IS=r.Factory({Name:"AyakaC2",OnApply:new r.Builder().instance.Location("Burst").Options({Name:"HIT_C2",Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:1.123}]}).Build()}),OS=r.Factory({Name:"AyakaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),DS=r.Factory({Name:"AyakaC4",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.DEFREDUCTION).Values(.3).Build()}),vS=r.Factory({Name:"AyakaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),yS=r.Factory({Name:"AyakaC6",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(2.98).Build()}),HS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4573}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4868}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6262}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2265}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7818}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5513}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],PS=r.Factory({Name:"AyakaSprint",OnApply:new r.Builder().infusion.Set(t.stat.CRYO_DMG,!1).Build()}),BS=r.Factory({Name:"AyakaA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.3).Build()}),bS=r.Factory({Name:"AyakaA4",OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.CRYO_DMG).Values(.18).Build()}),KS=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.392}]}],Mi=d.Factory({Name:"Ayaka",Stars:5,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,Weapon:t.weapon.SWORD,Region:t.region.INAZUMA,BurstCost:80,HpBase:[1000.986,4110.59],AtkBase:[26.6266,109.33523],DefBase:[61.0266,250.614],Normals:HS,Skills:KS,Bursts:RS,Extra:[],Effects:[PS,BS,bS,IS,OS,DS,vS,yS]}),wS=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.248}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.784}]}],YS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4833}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4558}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6029}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6588}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7921}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.6202}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],FS=r.Factory({Name:"JeanC1",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.4).Build()}),VS=r.Factory({Name:"JeanC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),xS=r.Factory({Name:"JeanC4",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.ANEMO_RES).Values(-.4).Build()}),kS=r.Factory({Name:"JeanC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),US=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.92}]}],Ci=d.Factory({Name:"Jean",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.HEALING_BONUS,Weapon:t.weapon.SWORD,Region:t.region.MONDSTADT,BurstCost:80,HpBase:[1143.984,4697.817],AtkBase:[18.62,76.4582],DefBase:[59.83,245.7],Normals:YS,Skills:US,Bursts:wS,Extra:[],Effects:[FS,VS,xS,kS]}),WS=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:.9822}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:.613}]}];function Ke(e){const a=e.GetParty();if(!a)return e.GetCharacter().Options.Element===t.stat.GEO_DMG?1:0;let n=0;for(const s of a.GetMembers())s.GetCharacter().Options.Element===t.stat.GEO_DMG&&n++;return n}var jS=r.Factory({Name:"GorouC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),qS=r.Factory({Name:"GorouC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),zS=r.Factory({Name:"GorouC6",ApplyOther:!0,OnApply:new r.Builder().observe.Party(!0).stat.Char(t.stat.GEO_CRIT_DMG).Values(.1,.2,.4).Rank(e=>Ke(e)).Build()}),QS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3775}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3715}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4945}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.59}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],$S=r.Factory({Name:"GorouA1",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.DEF_PERCENT).Values(.25).Build()}),XS=r.Factory({Name:"GorouA4",OnApply:new r.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,1.56,"HIT_E").Next().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,.156,"HIT_Q","HIT_Q_DOT").Next().Build()}),ZS=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.072}]}],JS=r.Factory({Name:"GorouE",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).observe.Party(!0).stat.Char(t.stat.DEF_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a)=>206.16*e*(Ke(a)>=1?1:0)).Next().observe.Party(!0).stat.Char(t.stat.GEO_DMG).Values(.15).Map((e,a)=>e*(Ke(a)>=3?1:0)).Build()}),pi=d.Factory({Name:"Gorou",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.GEO_DMG,StatBonus:t.stat.GEO_DMG,BurstCost:80,Region:t.region.INAZUMA,HpBase:[802.3761,2870.8872],AtkBase:[15.31488,54.797653],DefBase:[54.36375,194.5125],Normals:QS,Skills:ZS,Bursts:WS,Extra:[],Effects:[JS,$S,XS,jS,qS,zS]}),tu=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7027}]}],eu=r.Factory({Name:"GanyuC1",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.CRYO_RES).Values(-.15).Build()}),au=r.Factory({Name:"GanyuC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),nu=r.Factory({Name:"GanyuC4",ApplyOther:!0,MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.05).Stacks().Build()}),su=r.Factory({Name:"GanyuC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),iu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3173}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.356}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4549}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4549}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4825}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5762}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_Frostflake",Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.28}]},{Name:"HIT_FrostflakeBloom",Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.176}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],ru=r.Factory({Name:"GanyuA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Instance(/Frostflake/i).Values(.2).Build()}),lu=r.Factory({Name:"GanyuA4",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.CRYO_DMG).Values(.2).Build()}),ou=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]}],Gi=d.Factory({Name:"Ganyu",Stars:5,Weapon:t.weapon.BOW,Region:t.region.LIYUE,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:60,HpBase:[762.656,3131.878],AtkBase:[26.068,107.04148],DefBase:[49.0606,201.474],Normals:iu,Skills:ou,Bursts:tu,Extra:[],Effects:[ru,lu,eu,au,nu,su]}),cu=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.456}]},{Name:"HIT_LightfallSword",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:3.6705}]}],Eu=r.Factory({Name:"EulaQ",MaxStacks:30,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.7499,"HIT_LightfallSword").Map((e,a,n)=>{const s=Math.max(1,Math.min(15,a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)));return n.GetStacks()*e*o.TalentScaling.PHYSICAL_1A[s-1]}).Build()}),Tu=r.Factory({Name:"EulaC1",OnApply:new r.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.3).Build()}),_u=r.Factory({Name:"EulaC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Au=r.Factory({Name:"EulaC4",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.25).Build()}),Su=r.Factory({Name:"EulaC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),uu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8973}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.9355}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.568}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1264}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7183}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.688}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.244}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.8629}]}],hu=r.Factory({Name:"EulaA1",OnApply:new r.Builder().Where({target:{ascension:1}}).instance.Location("Burst").Options({Name:"HIT_A1",Talent:t.stat.ELEMENTAL_BURST_DMG,Element:t.stat.PHYSICAL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:3.6705*.5}]}).Build()}),Lu=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.464}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.456}]},{Name:"HIT_Icewhirl",Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]}],Nu=r.Factory({Name:"EulaE_1",MaxStacks:2,OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Stacks().Build()}),fu=r.Factory({Name:"EulaE_2",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Enemy(t.stat.CRYO_RES,t.stat.PHYSICAL_RES).Values(-.16,-.17,-.18,-.19,-.2,-.21,-.22,-.23,-.24,-.25).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Build()}),di=d.Factory({Name:"Eula",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:80,Region:t.region.MONDSTADT,HpBase:[1029.5856,4228.035],AtkBase:[26.6266,109.33523],DefBase:[58.45391,240.0489],Normals:uu,Skills:Lu,Bursts:cu,Extra:[],Effects:[Nu,fu,Eu,hu,Tu,_u,Au,Su]}),mu=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.04}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.04}]}],Mu=r.Factory({Name:"DilucQ",OnApply:new r.Builder().infusion.Set(t.stat.PYRO_DMG,!1).Build()}),Cu=r.Factory({Name:"DilucC1",OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.15).Build()}),pu=r.Factory({Name:"DilucC2",MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.1).Stacks().Build()}),Gu=r.Factory({Name:"DilucC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),du=r.Factory({Name:"DilucC4",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.4).Build()}),gu=r.Factory({Name:"DilucC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Ru=r.Factory({Name:"DilucC6",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.3).Build()}),Iu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.897}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8763}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.9881}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.3399}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.688}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.247}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8951}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.7897}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.2355}]}],Ou=r.Factory({Name:"DilucA4",OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.PYRO_DMG).Values(.2).Build()}),Du=[{Name:T.hits.HIT_E_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.944}]},{Name:T.hits.HIT_E_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.976}]},{Name:T.hits.HIT_E_3,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.288}]}],gi=d.Factory({Name:"Diluc",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.PYRO_DMG,StatBonus:t.stat.CRIT_RATE,BurstCost:40,Region:t.region.MONDSTADT,HpBase:[1010.5192,4149.7383],AtkBase:[26.068,107.04148],DefBase:[61.0266,250.614],Normals:Iu,Skills:Du,Bursts:mu,Extra:[],Effects:[Mu,Ou,Cu,pu,Gu,du,gu,Ru]}),vu=[{Name:T.hits.HIT_N1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7828}]},{Name:T.hits.HIT_N2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8247}]},{Name:T.hits.HIT_N3+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0463}]},{Name:T.hits.HIT_N4+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5169}]},{Name:T.hits.HIT_N5+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.3084}]},{Name:T.hits.HIT_CHARGED+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0105}]},{Name:T.hits.HIT_PLUNGE+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],yu=r.Factory({Name:"CynoQ",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100).Build()}),Hu=r.Factory({Name:"CynoC2",MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.1).Stacks().Build()}),Pu=r.Factory({Name:"CynoC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Bu=r.Factory({Name:"CynoC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),bu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4926}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4792}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2931}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7589}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2238}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Ku=r.Factory({Name:"CynoA1",OnApply:new r.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Initial:.35,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Next().Where({target:{ascension:1}}).stat.Char(t.stat.ALL_DMG).Instance("HIT_E","HIT_E_2").Values(.35).Build()}),wu=new r.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.DMG_FLAT).Instance(/N\d_Q$/i).Values(1.5).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build(),Yu=r.Factory({Name:"CynoA4",OnApply(e,a,n){wu(e,a,n);const s=e.GetCharacter(),i=e.FindEffect("CynoA1");let l;if(!i)throw new Error("Cannot find Cyno A1");function E(){if(!l){const _=e.FindInstance("HIT_A1");if(!_)return;l=n.Modifier(_.Subject.CreateModifier(t.stat.DMG_FLAT,0))}!l||(s.GetAscension()>=4?l.SetValue(2.5*s.Get(t.stat.ELEMENTAL_MASTERY)):l.SetValue(0))}E();for(const _ of r.EffectEvent.Values())n.Observer(i.CreateObserver(_,E));return n.Observer(s.CreateObserver(t.stat.ELEMENTAL_MASTERY,E)),n.Observer(s.CreateObserver(t.stat.LEVEL,E)),n.Observer(s.CreateObserver(t.stat.ASCENSION,E)),()=>0}}),Fu=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.568}]}],Ri=d.Factory({Name:"Cyno",Stars:5,Weapon:t.weapon.POLEARM,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:80,Region:t.region.SUMERU,HpBase:[972.3864,3993.1443],AtkBase:[24.7646,101.68941],DefBase:[66.88994,274.6926],Normals:bu,Skills:Fu,Bursts:vu,Extra:[],Effects:[yu,Ku,Yu,Hu,Pu,Bu]}),Vu=[{Name:T.hits.HIT_Q,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.0182}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4325}]}],xu=r.Factory({Name:"ColleiC1",OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()}),ku=r.Factory({Name:"ColleiC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Uu=r.Factory({Name:"ColleiC4",ApplyOther:!0,ApplySelf:!1,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60).Build()}),Wu=r.Factory({Name:"ColleiC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),ju=r.Factory({Name:"ColleiC6",OnApply:new r.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Initial:2}]}).Build()}),qu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.436}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4266}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5409}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6803}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.DENDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],zu=r.Factory({Name:"ColleiA1",OnApply:new r.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Initial:.4}]}).Build()}),Qu=[{Name:T.hits.HIT_E,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.512}]}],Ii=d.Factory({Name:"Collei",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.DENDRO_DMG,StatBonus:t.stat.ATK_PERCENT,BurstCost:60,Region:t.region.SUMERU,HpBase:[820.6119,2936.1348],AtkBase:[16.73952,59.895107],DefBase:[50.358,180.18],Normals:qu,Skills:Qu,Bursts:Vu,Extra:[],Effects:[zu,xu,ku,Uu,Wu,ju]}),$u=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.424}]}],Xu=r.Factory({Name:"ChongyunC1",OnApply:new r.Builder().instance.Basic({Name:"HIT_C1",Element:t.stat.CRYO_DMG,Stat:t.stat.ATK,Values:[.5]}).Build()}),Zu=r.Factory({Name:"ChongyunC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Ju=r.Factory({Name:"ChongyunC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),t0=r.Factory({Name:"ChongyunC6",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.15).Build()}),e0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6312}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8032}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0122}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5629}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0178}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],a0=r.Factory({Name:"ChongyunA4",ApplyOther:!0,OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Enemy(t.stat.CRYO_RES).Values(-.1).Build()}),n0=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.7204}]}],s0=r.Factory({Name:"ChongyunE",ApplyOther:!0,OnApply:new r.Builder().infusion.Set(t.stat.CRYO_DMG,!1).Build()}),Oi=d.Factory({Name:"Chongyun",Stars:4,Element:t.stat.CRYO_DMG,Weapon:t.weapon.CLAYMORE,StatBonus:t.stat.ATK_PERCENT,BurstCost:40,Region:t.region.LIYUE,HpBase:[920.90894,3294.9956],AtkBase:[18.6984,66.90411],DefBase:[54.36375,194.5125],Normals:e0,Skills:n0,Bursts:$u,Extra:[],Effects:[s0,a0,Xu,Zu,Ju,t0]}),i0=r.Factory({Name:"IttoQ",OnApply:new r.Builder().observe.Target(t.stat.DEF_FLAT,t.stat.DEF_BASE,t.stat.DEF_PERCENT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a)=>.576*e*a.GetCharacter().Get(t.stat.DEF)).Next().infusion.Set(t.stat.GEO_DMG,!0).Build()}),r0=r.Factory({Name:"IttoC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),l0=r.Factory({Name:"IttoC4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT,t.stat.ATK_PERCENT).Values(.2).Build()}),o0=r.Factory({Name:"IttoC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),c0=r.Factory({Name:"IttoC6",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_DMG).Values(.7).Build()}),E0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7923}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7637}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9164}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1722}]},{Name:"HIT_KesagiriSlash",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9116}]},{Name:"HIT_KesagiriFinal",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.9092}]},{Name:"HIT_SaichimonjiSlash",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9047}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],T0=r.Factory({Name:"IttoA4",OnApply:new r.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,.35,/Kesagiri/i).Build()}),_0=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.072}]}],Di=d.Factory({Name:"Itto",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.GEO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.INAZUMA,BurstCost:70,HpBase:[1000.986,4110.59],AtkBase:[17.689,72.63529],DefBase:[74.66784,306.6336],Normals:E0,Skills:_0,Bursts:[],Extra:[],Effects:[i0,T0,r0,l0,o0,c0]}),A0=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.2808}]}],S0=r.Factory({Name:"AmberC1",OnApply:new r.Builder().instance.Location("Normal").Options({Name:"HIT_C1",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:1.24*.2}]}).Build()}),u0=r.Factory({Name:"AmberC2",OnApply:new r.Builder().mv.Mv(t.stat.ATK,2,/hit_e/i).Build()}),h0=r.Factory({Name:"AmberC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),L0=r.Factory({Name:"AmberC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),N0=r.Factory({Name:"AmberC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()}),f0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3612}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3612}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4644}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5934}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],m0=r.Factory({Name:"AmberA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.1).Build()}),M0=r.Factory({Name:"AmberA4",OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()}),C0=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.232}]}],vi=d.Factory({Name:"Amber",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.PYRO_DMG,StatBonus:t.stat.ATK_PERCENT,BurstCost:40,Region:t.region.MONDSTADT,HpBase:[793.2582,2838.2634],AtkBase:[18.6984,66.90411],DefBase:[50.358,180.18],Normals:f0,Skills:C0,Bursts:A0,Extra:[],Effects:[m0,M0,S0,u0,h0,L0,N0]}),p0=r.Factory({Name:"AlhaithamA4",OnApply:new r.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.1/100).Map((e,a)=>Math.min(1,e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY))).Build()}),G0=[{Name:T.hits.HIT_Q,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:.9728}]}],d0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4953}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5075}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3418}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6677}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8385}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5526}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],g0=[{Name:T.hits.HIT_E,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.936},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.5488}]},{Name:T.hits.HIT_E_DOT+"_1",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344}]},{Name:T.hits.HIT_E_DOT+"_2",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672*2},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344*2}]},{Name:T.hits.HIT_E_DOT+"_3",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672*3},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344*3}]}],R0=r.Factory({Name:"AlhaithamE",OnApply:new r.Builder().infusion.Set(t.stat.DENDRO_DMG,!0).Build()}),I0=r.Factory({Name:"AlhaithamC2",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(50).Stacks().Build()}),O0=r.Factory({Name:"AlhaithamC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),D0=r.Factory({Name:"AlhaithamC4",MaxStacks:3,ApplyOther:!0,OnApply:new r.Builder().Where({target:{isOwner:!0}}).stat.Char(t.stat.DENDRO_DMG).Values(.1).Stacks().Next().Where({target:{isOwner:!1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(30).Stacks().Build()}),v0=r.Factory({Name:"AlhaithamC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),y0=r.Factory({Name:"AlhaithamC6",OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.1).Next().stat.Char(t.stat.CRIT_DMG).Values(.7).Build()}),yi=d.Factory({Name:"Alhaitham",Stars:5,Weapon:t.weapon.SWORD,Element:t.stat.DENDRO_DMG,StatBonus:t.stat.DENDRO_DMG,Region:t.region.SUMERU,BurstCost:70,AtkBase:[24.3922,100.16024],DefBase:[60.84711,249.8769],HpBase:[1039.1188,4267.1836],Normals:d0,Skills:g0,Bursts:G0,Extra:[],Effects:[R0,p0,I0,O0,D0,v0,y0]}),H0=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.672}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]}],P0=r.Factory({Name:"AlbedoC2",MaxStacks:4,OnApply:new r.Builder().mv.Mv(t.stat.DEF,.3,/HIT_Q/i).Map((e,a,n)=>e*n.GetStacks()).Build()}),B0=r.Factory({Name:"AlbedoC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),b0=r.Factory({Name:"AlbedoC4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.PLUNGE_ATTACK_DMG).Values(.3).Build()}),K0=r.Factory({Name:"AlbedoC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),w0=r.Factory({Name:"AlbedoC6",ApplyOther:!0,OnApply:new r.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.ALL_DMG).Values(.17).Build()}),Y0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3674}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3674}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4745}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4975}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6207}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.602}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],F0=r.Factory({Name:"AlbedoA1",OnApply(e,a,n){const s=e.GetCharacter(),i=e.FindSkill(T.hits.HIT_E_DOT);if(!i)throw new Error("Cannot find Albedo Skill");const l=n.Modifier(i.Subject.CreateModifier(t.stat.ALL_DMG,0));function E(){s.GetAscension()>=1?l.SetValue(.25):l.SetValue(0)}return E(),n.Observer(s.CreateObserver(t.stat.LEVEL,E)),n.Observer(s.CreateObserver(t.stat.ASCENSION,E)),()=>0}}),V0=r.Factory({Name:"AlbedoA4",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(125).Build()}),x0=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:1.336}]}],Hi=d.Factory({Name:"Albedo",Element:t.stat.GEO_DMG,Stars:5,Weapon:t.weapon.SWORD,StatBonus:t.stat.GEO_DMG,Region:t.region.MONDSTADT,AtkBase:[19.551,80.28111],DefBase:[68.2062,280.098],HpBase:[1029.5856,4228.035],BurstCost:40,Normals:Y0,Skills:x0,Bursts:H0,Extra:[],Effects:[F0,V0,P0,B0,b0,K0,w0]}),k0=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]}],U0=r.Factory({Name:"BeidouC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),W0=r.Factory({Name:"BeidouC4",ApplySelf:!0,OnApply:new r.Builder().instance.Options({Name:"HIT_C4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.2,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Build()}),j0=r.Factory({Name:"BeidouC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),q0=r.Factory({Name:"BeidouC6",ApplySelf:!0,ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.ELECTRO_RES).Values(-.15).Build()}),z0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7112}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7086}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8832}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8652}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1214}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5624}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.0182}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],Q0=r.Factory({Name:"BeidouA4",OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()}),$0=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216}]}],X0=r.Factory({Name:"BeidouE",MaxStacks:2,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Mv(t.stat.ATK,.96,T.hits.HIT_E).Map((e,a,n)=>{const s=n.GetStacks(),i=a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1,l=o.TalentScaling.ELEMENTAL_1[i];return e*l*s}).Build()}),Pi=d.Factory({Name:"Beidou",Stars:4,Weapon:t.weapon.CLAYMORE,Element:t.stat.ELECTRO_DMG,Region:t.region.LIYUE,StatBonus:t.stat.ELECTRO_DMG,AtkBase:[18.87648,67.54129],DefBase:[54.36375,194.5125],HpBase:[1094.1492,3914.8462],BurstCost:80,Normals:z0,Skills:$0,Bursts:k0,Extra:[],Effects:[X0,Q0,U0,W0,j0,q0]}),Z0=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.5427}]}],J0=r.Factory({Name:"XingqiuC2",ApplySelf:!0,ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.HYDRO_RES).Values(-.15).Build()}),th=r.Factory({Name:"XingqiuC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),eh=r.Factory({Name:"XingqiuC4",ApplySelf:!0,OnApply:new r.Builder().mv.Multiplier(1.5,/^HIT_E_/i).Build()}),ah=r.Factory({Name:"XingqiuC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),nh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4661}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4764}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2855}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5599}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3586}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5616}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],sh=r.Factory({Name:"XingqiuA4",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.HYDRO_DMG).Where({owner:{ascension:4}}).Values(.2).Build()}),ih=[{Name:T.hits.HIT_E_1,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.68}]},{Name:T.hits.HIT_E_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.912}]}],Bi=d.Factory({Name:"Xingqiu",Stars:4,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.SWORD,Region:t.region.LIYUE,HpBase:[857.08356,3066.6296],AtkBase:[16.9176,60.53229],DefBase:[63.51975,227.2725],StatBonus:t.stat.ATK_PERCENT,Normals:nh,Skills:ih,Bursts:Z0,Extra:[],Effects:[sh,J0,th,eh,ah],BurstCost:80}),rh=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_2,Stat:t.stat.ATK,Initial:3.0327}]}],lh=r.Factory({Name:"HuTaoQ",OnApply:new r.Builder().mv.Where({target:{hp:{leq:.5}}}).Multiplier(3.7909/3.0327,"HIT_Q").Build()}),oh=r.Factory({Name:"HuTaoC2",ApplySelf:!0,OnApply:new r.Builder().mv.Mv(t.stat.HP,.1,"HIT_E").Build()}),ch=r.Factory({Name:"HuTaoC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Eh=r.Factory({Name:"HuTaoC4",ApplySelf:!1,ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.12).Build()}),Th=r.Factory({Name:"HuTaoC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),_h=r.Factory({Name:"HuTaoC6",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(1).Build()}),Ah=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.4689}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.4825}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6105}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6564}]},{Name:T.hits.HIT_N5_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.3327}]},{Name:T.hits.HIT_N5_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.352}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.8596}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.3596}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6542}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.3081}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.6339}]}],Sh=r.Factory({Name:"HuTaoA1",ApplySelf:!1,ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Where({owner:{ascension:1}}).Values(.12).Build()}),uh=r.Factory({Name:"HuTaoA4",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Where({owner:{ascension:4,hp:{leq:.5}}}).Values(.33).Build()}),hh=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.64}]}],Lh=r.Factory({Name:"HuTaoE",ApplySelf:!0,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP,t.stat.ATK_BASE,t.stat.HP_BASE,t.stat.HP_FLAT,t.stat.HP_PERCENT).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_2).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a)=>{const n=a.GetCharacter(),s=.0384*e*n.Get(t.stat.HP),i=n.Get(t.stat.ATK_BASE)*4;return Math.max(0,Math.min(i,s))}).Next().infusion.Set(t.stat.PYRO_DMG,!0).Build()}),bi=d.Factory({Name:"HuTao",Element:t.stat.PYRO_DMG,Region:t.region.LIYUE,Stars:5,Weapon:t.weapon.POLEARM,HpBase:[1210.7164,4971.856],AtkBase:[8.2859,34.0239],DefBase:[68.2062,280.098],StatBonus:t.stat.CRIT_DMG,Normals:Ah,Skills:hh,Bursts:rh,Extra:[],Effects:[Lh,lh,Sh,uh,oh,ch,Eh,Th,_h],BurstCost:60}),Nh=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0731}]},{Name:T.hits.HIT_Q+"_THROW",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0487}]}],fh=r.Factory({Name:"YelanC2",OnApply:new r.Builder().instance.Options({Name:"HIT_C2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.14,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build()}),mh=r.Factory({Name:"YelanC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Mh=r.Factory({Name:"YelanC4",MaxStacks:4,ApplySelf:!0,ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.1).Stacks().Build()}),Ch=r.Factory({Name:"YelanC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),ph=r.Factory({Name:"YelanC6",OnApply:new r.Builder().instance.Options({Name:"HIT_C6",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:1.56*.1158,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),Gh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4068}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3904}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.516}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3251}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_BREAKTHROUGH_BARB",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1158}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],dh=r.Factory({Name:"YelanA1",ApplySelf:!0,OnApply:new r.Builder().observe.Party(!0).stat.Char(t.stat.HP_PERCENT).Where({owner:{ascension:1}}).Values(.06,.12,.18,.3).Rank(e=>{const a=e.GetParty();if(!a)return 1;const n=a.GetMembers(),s=new Map;for(const l of n)s.set(l.GetCharacter().Options.Element,!0);let i=0;for(const l of s.values())l&&i++;return i}).Build()}),gh=r.Factory({Name:"YelanA4",ApplySelf:!0,ApplyOther:!0,MaxTargets:1,MaxStacks:15,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Where({owner:{ascension:4}}).Values(.01).Next().stat.Char(t.stat.ALL_DMG).Where({owner:{ascension:4}}).Values(.035).Stacks().Map(e=>Math.min(.5,e)).Build()}),Rh=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.2261}]}],Ki=d.Factory({Name:"Yelan",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.BOW,Region:t.region.LIYUE,BurstCost:70,HpBase:[1124.9176,4619.52],AtkBase:[18.9924,77.987366],DefBase:[42.65879,175.1841],StatBonus:t.stat.CRIT_RATE,Normals:Gh,Skills:Rh,Bursts:Nh,Extra:[],Effects:[dh,gh,fh,mh,Mh,Ch,ph]}),Ih=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:[1,1.108,1.216,1.351,1.473,1.595,1.757,1.919,2.081,2.243,2.405,2.568,2.703,2.838,2.973],Stat:t.stat.ATK,Initial:4.0108}]}],Oh=r.Factory({Name:"ZhongliC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Dh=r.Factory({Name:"ZhongliC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),vh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3077}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3115}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3858}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4294}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.1075}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.545}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1103}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],yh=r.Factory({Name:"ZhongliA4",ApplySelf:!0,OnApply:new r.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.0139,/HIT_(N(\d)|CHARGED|PLUNGE)/).Next().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.019,/HIT_E/).Next().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.33,/HIT_Q/).Build()}),Hh=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.16}]},{Name:T.hits.HIT_E+"_RESONANCE",Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.32}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.8}]}],Ph=r.Factory({Name:"ZhongliE",ApplySelf:!0,ApplyOther:!0,OnApply:(e,a,n)=>{const s=t.Elements;for(const i of s){const l=t.DmgToRes(i);n.Modifier(e.GetCharacter().GetEnemy().Subject.CreateModifier(l,-.2))}return()=>0}}),wi=d.Factory({Name:"Zhongli",Stars:5,Element:t.stat.GEO_DMG,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,HpBase:[1143.984,4697.817],AtkBase:[19.551,80.2811],DefBase:[57.4368,235.872],StatBonus:t.stat.GEO_DMG,BurstCost:40,Normals:vh,Skills:Hh,Bursts:Ih,Extra:[],Effects:[Ph,yh,Oh,Dh]}),Bh=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.008}]},{Name:T.hits.HIT_N1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4447}]},{Name:T.hits.HIT_N2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4396}]},{Name:T.hits.HIT_N3+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.5382}]},{Name:T.hits.HIT_N4+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3089}]},{Name:T.hits.HIT_N5+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7394}]},{Name:T.hits.HIT_CHARGED_1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.616}]},{Name:T.hits.HIT_CHARGED_2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7436}]},{Name:T.hits.HIT_PLUNGE+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],bh=r.Factory({Name:"RaidenQ",MaxStacks:60,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.0389,T.hits.HIT_Q).Map((e,a,n)=>n.GetStacks()*e*o.TalentScaling.ELEMENTAL_1[Math.max(0,Math.min(o.TalentScaling.ELEMENTAL_1.length-1,a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1))]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.0073,/_.+_Q$/).Map((e,a,n)=>n.GetStacks()*e*o.TalentScaling.ELEMENTAL_1[Math.max(0,Math.min(o.TalentScaling.ELEMENTAL_1.length-1,a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1))]).Build()}),Kh=r.Factory({Name:"RaidenC2",OnApply:new r.Builder().stat.Char(t.stat.DEFIGNORED).Values(.6).Build()}),wh=r.Factory({Name:"RaidenC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Yh=r.Factory({Name:"RaidenC4",ApplyOther:!0,ApplySelf:!1,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.3).Build()}),Fh=r.Factory({Name:"RaidenC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Vh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3965}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3973}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4988}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2898}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6545}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9959}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],xh=r.Factory({Name:"RaidenA4",OnApply:new r.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ELECTRO_DMG).Values(.4).Map((e,a)=>e*Math.max(0,a.GetCharacter().Get(t.stat.ENERGY_RECHARGE)-1)).Build()}),kh=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.172}]},{Name:T.hits.HIT_E+"_COORDINATED",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.42}]}],Uh=r.Factory({Name:"RaidenE",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.0022,.0023,.0024,.0025,.0026,.0027,.0028,.0029,.003).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a)=>e*a.GetCharacter().Options.BurstCost).Build()}),Yi=d.Factory({Name:"Raiden",Stars:5,Weapon:t.weapon.POLEARM,Region:t.region.INAZUMA,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,BurstCost:90,AtkBase:[26.2542,107.80606],DefBase:[61.44541,252.3339],HpBase:[1004.79926,4126.249],Normals:Vh,Skills:kh,Bursts:Bh,Extra:[],Effects:[Uh,bh,xh,Kh,wh,Yh,Fh]}),Wh=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.328}]}],jh=r.Factory({Name:"BennettQ",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ATK_BASE,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a,n)=>{const s=n.Owner.FindEffect("BennettC1");return(.56*e+(s&&s.Enabled()?.2:0))*n.Owner.GetCharacter().Get(t.stat.ATK_BASE)}).Build()}),qh=r.Factory({Name:"BennettC1",OnApply(e,a,n){const s=e.FindEffect("BennettQ");if(!s)throw new Error("Bennett Burst effect not found");const i=s;function l(){i.Enabled()&&(i.Disable(),i.Enable())}return l(),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,l)),n.Observer(a.CreateObserver(r.EffectEvent.DISABLE,l)),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_TARGET,l)),()=>0}}),zh=r.Factory({Name:"BennettC2",OnApply:new r.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.ENERGY_RECHARGE).Values(.3).Build()}),Qh=r.Factory({Name:"BennettC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),$h=r.Factory({Name:"BennettC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Xh=r.Factory({Name:"BennettC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Next().Where({target:{weapon:[t.weapon.CLAYMORE,t.weapon.SWORD,t.weapon.POLEARM]}}).infusion.Set(t.stat.PYRO_DMG,!1).Build()}),Zh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4455}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4274}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5461}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5968}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.719}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.559}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6072}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Jh=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.376}]},{Name:T.hits.HIT_E_1_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]},{Name:T.hits.HIT_E_1_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.92}]},{Name:T.hits.HIT_E_2_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_E_2_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]},{Name:T.hits.HIT_E_EXPLOSION,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]},{Name:"HIT_C4",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.92*1.35}]}],Fi=d.Factory({Name:"Bennett",Stars:4,Weapon:t.weapon.SWORD,Element:t.stat.PYRO_DMG,Region:t.region.MONDSTADT,StatBonus:t.stat.ENERGY_RECHARGE,BurstCost:60,HpBase:[1039.4418,3719.104],AtkBase:[16.0272,57.34638],DefBase:[64.66425,231.3675],Normals:Zh,Skills:Jh,Bursts:Wh,Effects:[jh,qh,zh,Qh,$h,Xh],Extra:[]}),tL=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.08}]}],eL=r.Factory({Name:"FischlC1",OnApply:new r.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.22,Talent:t.stat.NONE}]}).Build()}),aL=r.Factory({Name:"FischlC2",OnApply:new r.Builder().mv.Mv(t.stat.ATK,2,/HIT_E$/).Build()}),nL=r.Factory({Name:"FischlC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),sL=r.Factory({Name:"FischlC4",OnApply:new r.Builder().instance.Options({Name:"HIT_C4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:2.22,Talent:t.stat.NONE}]}).Build()}),iL=r.Factory({Name:"FischlC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),rL=r.Factory({Name:"FischlC6",OnApply:new r.Builder().instance.Options({Name:"HIT_C6",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.3,Talent:t.stat.NONE}]}).Build()}),lL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4412}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4678}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5814}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5771}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7207}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],oL=r.Factory({Name:"FischlA1",OnApply:new r.Builder().Where({target:{ascension:1}}).instance.Options({Name:"HIT_A1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24*1.527,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),cL=r.Factory({Name:"FischlA4",OnApply:new r.Builder().Where({target:{ascension:4}}).instance.Options({Name:"HIT_A4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.8,Talent:t.stat.NONE}]}).Build()}),EL=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1544}]},{Name:"HIT_OZ",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.888}]}],Vi=d.Factory({Name:"Fischl",Stars:4,Element:t.stat.ELECTRO_DMG,Region:t.region.MONDSTADT,Weapon:t.weapon.BOW,StatBonus:t.stat.ATK_PERCENT,AtkBase:[20.4792,73.27593],HpBase:[770.4634,2756.704],DefBase:[49.78575,178.1325],BurstCost:60,Normals:lL,Skills:EL,Bursts:tL,Extra:[],Effects:[oL,cL,eL,aL,nL,sL,iL,rL]}),TL=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.624}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2}]}],_L=r.Factory({Name:"KazuhaQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,n){AL(e,a,n);function s(){const i=e.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!i)return;const l=a.GetAuras()[0];!l||(i.Options.Element=t.AuraToDmg(l))}return s(),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_AURAS,s)),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,s)),()=>0}}),AL=new r.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.36,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),SL=r.Factory({Name:"KazuhaC2",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(200).Build()}),uL=r.Factory({Name:"KazuhaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),hL=r.Factory({Name:"KazuhaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),LL=r.Factory({Name:"KazuhaC6",OnApply:new r.Builder().infusion.Set(t.stat.ANEMO_DMG,!1).Build()}),NL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4498}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4524}]},{Name:T.hits.HIT_N3_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.258}]},{Name:T.hits.HIT_N3_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3096}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6072}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2537}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.43}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7465}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],fL=r.Factory({Name:"KazuhaA1",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,n){mL(e,a,n);function s(){const i=e.FindNormal("HIT_A1");if(!i)return;const l=a.GetAuras()[0];!l||(i.Options.Element=t.AuraToDmg(l))}return s(),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_AURAS,s)),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,s)),()=>0}}),mL=new r.Builder().Where({target:{ascension:1}}).instance.Location("Normal").Options({Name:"HIT_A1",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:2,Talent:t.stat.NONE}]}).Build(),ML=r.Factory({Name:"KazuhaA4",ApplyOther:!0,MaxAuras:1/0,ValidAuras:t.Swirlable,OnApply(e,a,n){const s=a.Owner.GetCharacter(),i=e.GetCharacter(),l=t.Elements.filter(_=>_!==t.stat.PHYSICAL_DMG).map(_=>n.Modifier(i.CreateModifier(_,0)));function E(){const _=a.GetAuras().map(A=>t.AuraToDmg(A));for(const A of l)_.includes(A.GetProp())&&s.GetAscension()>=4?A.SetValue(.04/100*s.Get(t.stat.ELEMENTAL_MASTERY)):A.SetValue(0)}return E(),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_AURAS,E)),n.Observer(s.CreateObserver(t.stat.ELEMENTAL_MASTERY,E)),n.Observer(s.CreateObserver(t.stat.LEVEL,E)),n.Observer(s.CreateObserver(t.stat.ASCENSION,E)),()=>0}}),CL=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.92}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.608}]}],pL=r.Factory({Name:"KazuhaE",OnApply:new r.Builder().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Next().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE_LOW+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Next().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE_HIGH+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),xi=d.Factory({Name:"Kazuha",Stars:5,Weapon:t.weapon.SWORD,Region:t.region.INAZUMA,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ELEMENTAL_MASTERY,BurstCost:60,HpBase:[1039.1188,4267.1836],AtkBase:[23.0888,94.80817],DefBase:[62.8215,257.985],Normals:NL,Skills:CL,Bursts:TL,Extra:[],Effects:[pL,_L,fL,ML,SL,uL,hL,LL]}),GL=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.096}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3412}]}],dL=r.Factory({Name:"SaraC2",OnApply:new r.Builder().instance.Location("Skill").Options({Name:"HIT_C2",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2576*.3,Talent:t.stat.ELEMENTAL_SKILL_LEVEL}]}).Build()}),gL=r.Factory({Name:"SaraC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),RL=r.Factory({Name:"SaraC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),IL=r.Factory({Name:"SaraC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELECTRO_CRIT_DMG).Values(.6).Build()}),OL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3689}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.387}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.485}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.504}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.585}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],DL=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2576}]}],vL=r.Factory({Name:"SaraE",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ATK_BASE,t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a,n)=>.4296*e*n.Owner.GetCharacter().Get(t.stat.ATK_BASE)).Build()}),ki=d.Factory({Name:"Sara",Stars:4,Weapon:t.weapon.BOW,Region:t.region.INAZUMA,Element:t.stat.ELECTRO_DMG,BurstCost:80,HpBase:[802.3761,2870.8872],AtkBase:[16.38336,58.620743],DefBase:[52.647,188.37],StatBonus:t.stat.ATK_PERCENT,Normals:OL,Skills:DL,Bursts:GL,Extra:[],Effects:[vL,dL,gL,RL,IL]}),yL=[{Name:T.hits.HIT_N1,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.403}]},{Name:T.hits.HIT_N2,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3697}]},{Name:T.hits.HIT_N3,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4587}]},{Name:T.hits.HIT_N4,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5841}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.DENDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.32}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],HL=r.Factory({Name:"NahidaA1",ApplyOther:!0,MaxTargets:1,OnApply(e,a,n){const s=e.GetCharacter(),i=a.Owner.GetCharacter(),l=n.Modifier(s.CreateModifier(t.stat.ELEMENTAL_MASTERY,0));let E=[];const _=[];function A(u){if(u===l)return;if(i.Get(t.stat.ASCENSION)<1){l.SetValue(0);return}let h=0,N=s;for(const m of E){const C=m.Get(t.stat.ELEMENTAL_MASTERY);C>h&&(h=C,N=m)}N===s&&(h-=l.GetValue());const L=Math.min(250,Math.max(0,.25*h));l.SetValue(L)}function S(){_.forEach(h=>h.Remove());const u=e.GetParty();if(!u)E=[s];else{E=[];for(const h of u.GetMembers())E.push(h.GetCharacter())}for(const h of E)_.push(n.Observer(h.CreateObserver(t.stat.ELEMENTAL_MASTERY,A)));A()}return S(),n.Observer(e.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,S)),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,S)),n.Observer(a.CreateObserver(r.EffectEvent.DISABLE,S)),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_CONDITIONS,S)),n.Observer(i.CreateObserver(t.stat.LEVEL,A)),n.Observer(i.CreateObserver(t.stat.ASCENSION,A)),()=>0}}),PL=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.984}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.032},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:2.064}]}],BL=r.Factory({Name:"NahidaA4",OnApply(e,a,n){const s=e.GetCharacter(),i=e.FindSkill(T.hits.HIT_E_DOT);if(!i)throw new Error("Cannot find Nahida Skill");const l=n.Modifier(i.Subject.CreateModifier(t.stat.ALL_DMG,0)),E=n.Modifier(i.Subject.CreateModifier(t.stat.CRIT_RATE,0));let _,A;function S(){if(s.GetAscension()<4){l.SetValue(0),E.SetValue(0),_&&_.SetValue(0),A&&A.SetValue(0);return}const u=e.FindSkill("HIT_C6");u&&(_||(_=n.Modifier(u.Subject.CreateModifier(t.stat.ALL_DMG,0))),A||(A=n.Modifier(u.Subject.CreateModifier(t.stat.CRIT_RATE,0))));const h=Math.max(0,s.Get(t.stat.ELEMENTAL_MASTERY)-200),N=Math.min(.24,h*.03/100),L=Math.min(.8,h*.1/100);l.SetValue(L),E.SetValue(N),_&&_.SetValue(L),A&&A.SetValue(N)}return S(),n.Observer(s.CreateObserver(t.stat.ELEMENTAL_MASTERY,S)),n.Observer(s.CreateObserver(t.stat.LEVEL,S)),n.Observer(s.CreateObserver(t.stat.ASCENSION,S)),()=>0}}),bL=r.Factory({Name:"NahidaQ",OnApply(e,a,n){const s=e.FindSkill(T.hits.HIT_E_DOT);if(!s)throw new Error("Cannot find Nahida Skill");const i=n.Modifier(s.Subject.CreateModifier(t.stat.ALL_DMG,0));let l;function E(){const _=e.GetParty();if(!_){i.SetValue(0),l&&l.SetValue(0);return}const A=e.FindSkill("HIT_C6");A&&!l&&(l=n.Modifier(A.Subject.CreateModifier(t.stat.ALL_DMG,0)));const S=e.FindEffect("NahidaC1");let h=S&&S.Enabled()&&S.GetTargets().includes(e)?1:0;for(const m of _.GetMembers())m.GetCharacter().Options.Element===t.stat.PYRO_DMG&&h++;let N=0;h>=1&&(N=.1488),h>=2&&(N=.2232);const L=N*o.TalentScaling.ELEMENTAL_1[e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1];i.SetValue(L),l&&l.SetValue(L)}return E(),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,E)),n.Observer(a.CreateObserver(r.EffectEvent.DISABLE,E)),n.Observer(e.GetCharacter().CreateObserver(t.stat.ELEMENTAL_BURST_LEVEL,E)),n.Observer(e.GetCharacter().CreateObserver(t.stat.ELEMENTAL_BURST_LEVEL_UP,E)),n.Observer(e.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,E)),()=>0}}),KL=r.Factory({Name:"NahidaC1",OnApply(e,a,n){const s=e.FindEffect("NahidaQ");if(!s)throw new Error("Nahida Burst effect not found");const i=s;function l(){i.Enabled()&&(i.Disable(),i.Enable())}return l(),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,l)),n.Observer(a.CreateObserver(r.EffectEvent.DISABLE,l)),n.Observer(a.CreateObserver(r.EffectEvent.CHANGE_TARGET,l)),()=>0}}),wL=r.Factory({Name:"NahidaC2",ApplyOther:!0,MaxAuras:1,ValidAuras:[t.aura.QUICKEN],OnApply(e,a,n){YL(e,a,n);const i=["BURGEON","BLOOM","HYPERBLOOM","BURNING"].map(l=>e.FindTr("HIT_"+l));for(const l of i)!l||(n.Modifier(l.Subject.CreateModifier(t.stat.CRIT_RATE,.2)),n.Modifier(l.Subject.CreateModifier(t.stat.CRIT_DMG,1)));return()=>0}}),YL=new r.Builder().Where({effect:{aura:[t.aura.QUICKEN]}}).stat.Enemy(t.stat.DEFREDUCTION).Values(.3).Build(),FL=r.Factory({Name:"NahidaC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),VL=r.Factory({Name:"NahidaC4",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Stacks([0,100,120,140,160]).Build()}),xL=r.Factory({Name:"NahidaC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),kL=r.Factory({Name:"NahidaC6",OnApply(e,a,n){UL(e,a,n);function s(){const i=e.FindEffect("NahidaQ"),l=e.FindEffect("NahidaA4");i&&i.Enabled()&&(i.Disable(),i.Enable()),l&&l.Enabled()&&(l.Disable(),l.Enable())}return s(),n.Observer(a.CreateObserver(r.EffectEvent.ENABLE,s)),n.Observer(a.CreateObserver(r.EffectEvent.DISABLE,s)),()=>0}}),UL=new r.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Talent:t.stat.NONE,Initial:2},{Scaling:o.TalentScaling.NONE,Stat:t.stat.ELEMENTAL_MASTERY,Talent:t.stat.NONE,Initial:4}]}).Build(),Ui=d.Factory({Name:"Nahida",Stars:5,Element:t.stat.DENDRO_DMG,Region:t.region.SUMERU,Weapon:t.weapon.CATALYST,StatBonus:t.stat.ELEMENTAL_MASTERY,BurstCost:50,HpBase:[806.5087,3311.961],AtkBase:[23.275,95.57275],DefBase:[49.0606,201.474],Normals:yL,Skills:PL,Bursts:[],Extra:[],Effects:[bL,HL,BL,KL,wL,FL,VL,xL,kL]}),we=new Q(e=>e.Name);we.AddList(Object.values(ti).sort((e,a)=>e.Name.localeCompare(a.Name)));function Wi(){return we.Get()}function WL(e){return we.Find(e)}var nt={};O(nt,{Akuoumaru:()=>Qi,AlleyHunter:()=>ul,AmberBead:()=>ql,AmenomaKageuchi:()=>Kr,AmosBow:()=>rl,AquaSimulacra:()=>sl,AquilaFavonia:()=>vr,BlackTassel:()=>fo,BlackcliffAgate:()=>Vl,BlackcliffLongsword:()=>Vr,BlackcliffPole:()=>Mo,BlackcliffSlasher:()=>Zi,BloodtaintedGreatsword:()=>Ji,CalamityQueller:()=>to,CinnabarSpindle:()=>br,CompoundBow:()=>Ll,CoolSteel:()=>el,CrescentPike:()=>To,DarkIronSword:()=>Xr,Deathmatch:()=>Co,DebateClub:()=>tr,DodocoTales:()=>wl,DragonsBane:()=>Ao,DragonspineSpear:()=>co,ElegyForTheEnd:()=>uo,EmeraldOrb:()=>Ql,EndOfTheLine:()=>ll,EngulfingLightning:()=>ro,EverlastingMoonglow:()=>vl,EyeOfPerception:()=>Fl,FadingTwilight:()=>Sl,FavoniusCodex:()=>jl,FavoniusGreatsword:()=>er,FavoniusLance:()=>Lo,FavoniusSword:()=>go,FavoniusWarbow:()=>Ro,FerrousShadow:()=>ar,FesteringDesire:()=>wr,FilletBlade:()=>Zr,FindByName:()=>n1,ForestRegalia:()=>ir,FreedomSworn:()=>Gr,Frostbearer:()=>Yl,FruitOfFulfillment:()=>Bl,GetByType:()=>s1,GetList:()=>Do,HakushinRing:()=>Kl,Halberd:()=>_o,Hamayumi:()=>Tl,HaranGeppakuFutsu:()=>Rr,HarbingerOfDawn:()=>tl,HuntersPath:()=>al,IronSting:()=>xr,JadeCutter:()=>Or,JadeSpear:()=>eo,KagotsurubeIsshin:()=>Br,KagurasVerity:()=>Dl,KatsuragikiriNagamasa:()=>rr,KeyOfKhajNisut:()=>gr,KingsSquire:()=>ol,KitainCrossSpear:()=>oo,LightOfFoliarIncision:()=>dr,LionsRoar:()=>Ur,LithicBlade:()=>or,LithicSpear:()=>Eo,LostPrayer:()=>Hl,LuxuriousSeaLord:()=>nr,MagicGuide:()=>Zl,MakhairaAquamarine:()=>Xi,MappaMare:()=>xl,MemoryOfDust:()=>yl,Messenger:()=>Cl,MissiveWindspear:()=>so,MistsplitterReforged:()=>Ir,MitternachtsWaltz:()=>Al,Moonpiercer:()=>io,MouunsMoon:()=>cl,OathswornEye:()=>bl,OtherworldlyStory:()=>$l,PolarStar:()=>il,Predator:()=>El,PrototypeAmber:()=>kl,PrototypeArchaic:()=>Er,PrototypeCrescent:()=>Nl,PrototypeRancour:()=>kr,PrototypeStarglitter:()=>mo,Rainslasher:()=>Tr,RavenBow:()=>gl,RecurveBow:()=>Gl,RedhornStonethresher:()=>_r,RoyalBow:()=>zr,RoyalGreatsword:()=>Ar,RoyalGrimoire:()=>jr,RoyalLongsword:()=>Qr,RoyalSpear:()=>qr,Rust:()=>fl,SacrificialBow:()=>ml,SacrificialFragments:()=>Wl,SacrificialGreatsword:()=>Sr,SacrificialSword:()=>So,SapwoodBlade:()=>Pr,SerpentSpine:()=>pr,SharpshootersOath:()=>dl,SkyriderGreatsword:()=>ur,SkyriderSword:()=>$r,SkywardAtlas:()=>Pl,SkywardBlade:()=>po,SkywardHarp:()=>Go,SkywardPride:()=>hr,SkywardSpine:()=>no,Slingshot:()=>pl,SnowTombedStarsilver:()=>Lr,SolarPearl:()=>Ul,SongOfBrokenPines:()=>cr,StaffOfHoma:()=>ho,StaffOfTheScarletSands:()=>Jl,SummitShaper:()=>Dr,SwordOfDescension:()=>Yr,TheAlleyFlash:()=>Fr,TheBell:()=>Nr,TheBlackSword:()=>qi,TheCatch:()=>zi,TheFlute:()=>Wr,TheStringless:()=>Ml,TheUnforged:()=>fr,TheViridescentHunt:()=>hl,TheWidsith:()=>Io,ThousandFloatingDreams:()=>Il,ThrillingTalesOfDragonSlayers:()=>Xl,ThunderingPulse:()=>nl,ToukabouShigure:()=>yr,TravelersHandySword:()=>Jr,TulaytullahsRemembrance:()=>Rl,TwinNephrite:()=>zl,VortexVanquisher:()=>ao,WanderingEvenstar:()=>Ol,WavebreakerFin:()=>lo,WhiteIronGreatsword:()=>Mr,WhiteTassel:()=>No,Whiteblind:()=>mr,WindblumeOde:()=>_l,WolfsGravestone:()=>Cr,XiphosMoonlight:()=>Hr});var ji={};O(ji,{Akuoumaru:()=>Qi,AlleyHunter:()=>ul,AmberBead:()=>ql,AmenomaKageuchi:()=>Kr,AmosBow:()=>rl,AquaSimulacra:()=>sl,AquilaFavonia:()=>vr,BlackTassel:()=>fo,BlackcliffAgate:()=>Vl,BlackcliffLongsword:()=>Vr,BlackcliffPole:()=>Mo,BlackcliffSlasher:()=>Zi,BloodtaintedGreatsword:()=>Ji,CalamityQueller:()=>to,CinnabarSpindle:()=>br,CompoundBow:()=>Ll,CoolSteel:()=>el,CrescentPike:()=>To,DarkIronSword:()=>Xr,Deathmatch:()=>Co,DebateClub:()=>tr,DodocoTales:()=>wl,DragonsBane:()=>Ao,DragonspineSpear:()=>co,ElegyForTheEnd:()=>uo,EmeraldOrb:()=>Ql,EndOfTheLine:()=>ll,EngulfingLightning:()=>ro,EverlastingMoonglow:()=>vl,EyeOfPerception:()=>Fl,FadingTwilight:()=>Sl,FavoniusCodex:()=>jl,FavoniusGreatsword:()=>er,FavoniusLance:()=>Lo,FavoniusSword:()=>go,FavoniusWarbow:()=>Ro,FerrousShadow:()=>ar,FesteringDesire:()=>wr,FilletBlade:()=>Zr,ForestRegalia:()=>ir,FreedomSworn:()=>Gr,Frostbearer:()=>Yl,FruitOfFulfillment:()=>Bl,HakushinRing:()=>Kl,Halberd:()=>_o,Hamayumi:()=>Tl,HaranGeppakuFutsu:()=>Rr,HarbingerOfDawn:()=>tl,HuntersPath:()=>al,IronSting:()=>xr,JadeCutter:()=>Or,JadeSpear:()=>eo,KagotsurubeIsshin:()=>Br,KagurasVerity:()=>Dl,KatsuragikiriNagamasa:()=>rr,KeyOfKhajNisut:()=>gr,KingsSquire:()=>ol,KitainCrossSpear:()=>oo,LightOfFoliarIncision:()=>dr,LionsRoar:()=>Ur,LithicBlade:()=>or,LithicSpear:()=>Eo,LostPrayer:()=>Hl,LuxuriousSeaLord:()=>nr,MagicGuide:()=>Zl,MakhairaAquamarine:()=>Xi,MappaMare:()=>xl,MemoryOfDust:()=>yl,Messenger:()=>Cl,MissiveWindspear:()=>so,MistsplitterReforged:()=>Ir,MitternachtsWaltz:()=>Al,Moonpiercer:()=>io,MouunsMoon:()=>cl,OathswornEye:()=>bl,OtherworldlyStory:()=>$l,PolarStar:()=>il,Predator:()=>El,PrototypeAmber:()=>kl,PrototypeArchaic:()=>Er,PrototypeCrescent:()=>Nl,PrototypeRancour:()=>kr,PrototypeStarglitter:()=>mo,Rainslasher:()=>Tr,RavenBow:()=>gl,RecurveBow:()=>Gl,RedhornStonethresher:()=>_r,RoyalBow:()=>zr,RoyalGreatsword:()=>Ar,RoyalGrimoire:()=>jr,RoyalLongsword:()=>Qr,RoyalSpear:()=>qr,Rust:()=>fl,SacrificialBow:()=>ml,SacrificialFragments:()=>Wl,SacrificialGreatsword:()=>Sr,SacrificialSword:()=>So,SapwoodBlade:()=>Pr,SerpentSpine:()=>pr,SharpshootersOath:()=>dl,SkyriderGreatsword:()=>ur,SkyriderSword:()=>$r,SkywardAtlas:()=>Pl,SkywardBlade:()=>po,SkywardHarp:()=>Go,SkywardPride:()=>hr,SkywardSpine:()=>no,Slingshot:()=>pl,SnowTombedStarsilver:()=>Lr,SolarPearl:()=>Ul,SongOfBrokenPines:()=>cr,StaffOfHoma:()=>ho,StaffOfTheScarletSands:()=>Jl,SummitShaper:()=>Dr,SwordOfDescension:()=>Yr,TheAlleyFlash:()=>Fr,TheBell:()=>Nr,TheBlackSword:()=>qi,TheCatch:()=>zi,TheFlute:()=>Wr,TheStringless:()=>Ml,TheUnforged:()=>fr,TheViridescentHunt:()=>hl,TheWidsith:()=>Io,ThousandFloatingDreams:()=>Il,ThrillingTalesOfDragonSlayers:()=>Xl,ThunderingPulse:()=>nl,ToukabouShigure:()=>yr,TravelersHandySword:()=>Jr,TulaytullahsRemembrance:()=>Rl,TwinNephrite:()=>zl,VortexVanquisher:()=>ao,WanderingEvenstar:()=>Ol,WavebreakerFin:()=>lo,WhiteIronGreatsword:()=>Mr,WhiteTassel:()=>No,Whiteblind:()=>mr,WindblumeOde:()=>_l,WolfsGravestone:()=>Cr,XiphosMoonlight:()=>Hr});var qi=f.Factory({Name:"TheBlackSword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"TheBlackSword1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),zi=f.Factory({Name:"TheCatch",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"TheCatch1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.06,.075,.09,.105,.12).Build()})]}),Ye=e=>r.Factory({Name:e,MaxRank:5,OnApply(a,n,s){const i=a.GetCharacter(),l=s.Modifier(i.CreateModifier(t.stat.ELEMENTAL_BURST_DMG,0));function E(){let _=[i];const A=a.GetParty();A&&(_=A.GetMembers().map(h=>h.GetCharacter()));let S=0;for(const h of _)S+=h.Options.BurstCost;const u=Math.min(qL[n.GetRank()-1],jL[n.GetRank()-1]*S);l.SetValue(u)}return s.Observer(n.Event.CreateObserver(r.EffectEvent.CHANGE_RANK,E)),s.Observer(a.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,E)),()=>0}}),jL=[.12/100,.15/100,.18/100,.21/100,.24/100],qL=[.4,.5,.6,.7,.8],Qi=f.Factory({Name:"Akuoumaru",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Ye("Akuoumaru1")]}),$i=(e,a,n)=>r.Factory({Name:e,ApplyOther:!0,StackSelf:!0,MaxRank:5,OnApply(s,i,l){const E=i.Owner.GetCharacter(),_=s.GetCharacter(),A=l.Modifier(_.CreateModifier(a,0));function S(){const u=E.Get(t.stat.ELEMENTAL_MASTERY);let h=n[i.GetRank()-1]*u;E!==_&&(h*=.3),A.SetValue(h)}return S(),l.Observer(E.CreateObserver(t.stat.ELEMENTAL_MASTERY,S)),()=>0}}),Xi=f.Factory({Name:"MakhairaAquamarine",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[$i("MakhairaAquamarine1",t.stat.ATK_FLAT,[.24,.3,.36,.42,.48])]}),zt=e=>r.Factory({Name:e,MaxRank:5,MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Stacks().Build()}),Zi=f.Factory({Name:"BlackcliffSlasher",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[zt("BlackcliffSlasher1")]}),Ji=f.Factory({Name:"BloodtaintedGreatsword",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"BloodtaintedGreatsword1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),tr=f.Factory({Name:"DebateClub",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"DebateClub1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_DebateClub",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.6,.75,.9,1.05,1.2]}).Build()})]}),er=f.Factory({Name:"FavoniusGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),ar=f.Factory({Name:"FerrousShadow",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"FerrousShadow1",MaxRank:5,OnApply:new r.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.3,.35,.4,.45,.5).Build()})]}),nr=f.Factory({Name:"LuxuriousSeaLord",Type:t.weapon.CLAYMORE,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"LuxuriousSeaLord1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.12,.15,.18,.21,.24).Next().instance.Basic({Name:"HIT_LuxuriousSeaLord",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),sr=e=>r.Factory({Name:e,MaxRank:5,ApplyOther:!0,MaxTargets:1,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,75,90,105,120).Build()}),ir=f.Factory({Name:"ForestRegalia",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[sr("ForestRegalia1")]}),rr=f.Factory({Name:"KatsuragikiriNagamasa",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"KatsuragikiriNagamasa1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.06,.075,.09,.105,.12).Build()})]}),lr=e=>r.Factory({Name:e,MaxRank:5,OnApply(a,n,s){const i=a.GetCharacter(),l=s.Modifier(i.CreateModifier(t.stat.CRIT_RATE,0)),E=s.Modifier(i.CreateModifier(t.stat.ATK_PERCENT,0));function _(){let A=[i];const S=a.GetParty();S&&(A=S.GetMembers().map(L=>L.GetCharacter()));const u=Math.min(4,A.filter(L=>L.Options.Region===t.region.LIYUE).length),h=zL[n.GetRank()-1]*u,N=QL[n.GetRank()-1]*u;l.SetValue(h),E.SetValue(N)}return _(),s.Observer(n.CreateObserver(r.EffectEvent.CHANGE_RANK,_)),s.Observer(a.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,_)),()=>0}}),zL=[.03,.04,.05,.06,.07],QL=[.07,.08,.09,.1,.11],or=f.Factory({Name:"LithicBlade",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[lr("LithicBlade1")]}),Fe=new Map;function $L(e){const a=Fe.get(e);if(!a){const n=new Set;return Fe.set(e,n),n}return a}var Ve=({Name:e,OnApply:a})=>r.Factory({Name:e,MaxRank:5,ApplyOther:!0,OnApply(n,s,i){a(n,s,i);const l=i.GetModifiers(),E=$L(n);l.forEach(A=>E.add(A));function _(){for(const A of l)Array.from(E).some(u=>u!==A&&u.GetProp()===A.GetProp()&&u.Enabled()&&u.GetValue()!==0)&&(A.SetValue(0),A.Disable())}_();for(const A of r.EffectEvent.Values())i.Observer(s.CreateObserver(A,_));return()=>{l.forEach(A=>E.delete(A)),E.size===0&&Fe.delete(n)}}}),cr=f.Factory({Name:"SongOfBrokenPines",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_49,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"SongOfBrokenPines1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()}),Ve({Name:"SongOfBrokenPines2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),Er=f.Factory({Name:"PrototypeArchaic",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"PrototypeArchaic1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_PrototypeArchaic",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,3,3.6,4.2,4.8]}).Build()})]}),Tr=f.Factory({Name:"Rainslasher",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"Rainslasher1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),_r=f.Factory({Name:"RedhornStonethresher",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"RedhornStonethresher1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.28,.35,.42,.49,.56).Next().observe.Target(t.stat.DEF,t.stat.DEF_PERCENT,t.stat.DEF_FLAT).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(.4,.5,.6,.7,.8).Map((e,a)=>e*a.GetCharacter().Get(t.stat.DEF)).Build()})]}),Rt=e=>r.Factory({Name:e,MaxRank:5,OnApply(a,n,s){const i=a.GetCharacter();function l(E=!0){if(!E)i.MapCritRate=_=>_;else{const _=n.GetRank();i.MapCritRate=A=>A+XL(_,A)}}return l(!0),s.Observer(n.CreateObserver(r.EffectEvent.ENABLE,()=>l(!0))),s.Observer(n.CreateObserver(r.EffectEvent.CHANGE_RANK,()=>l(!0))),s.Observer(n.CreateObserver(r.EffectEvent.DISABLE,()=>l(!1))),()=>l(!1)}});function XL(e,a){if(a<-1||a>1)return 0;const n=a,s=.08+.02*(e-1),i=n<0?0:n<1-s?1:2,l=ZL[e-1][i],E=l.map((_,A)=>n<-5*s?0:_*bc(n,l.length-A-1)).reduce((_,A)=>_+A,0);return Math.max(0,E)}var ZL=[[[-128.4499,-138.4761,-59.75334,-11.00387,-.4655975,.4539864,.189614],[-.10036,.30971,-.39967,.18932],[.86583,-1.7362,.87032]],[[-51.0823,-67.9198,-35.7478,-8.08299,-.414222,.417227,.211754],[-.097754,.31144,-.42638,.21147],[.85002,-1.7068,.85672]],[[-23.0139,-36.3491,-22.6081,-6.08691,-.374257,.388127,.230281],[-.092576,.30589,-.44477,.23006],[.81059,-1.6312,.82054]],[[-12.3361,-22.796,-16.482,-5.21919,-.421051,.360611,.246312],[-.087477,.29824,-.45863,.24612],[.80621,-1.623,.81666]],[[-6.99091,-14.7677,-12.1447,-4.39816,-.424118,.340408,.260555],[-.077554,.28287,-.46728,.2603],[.79212,-1.5973,.805]]],Ar=f.Factory({Name:"RoyalGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Rt("RoyalGreatsword1")]}),Sr=f.Factory({Name:"SacrificialGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),ur=f.Factory({Name:"SkyriderGreatsword",Type:t.weapon.CLAYMORE,Stars:3,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"SkyriderGreatsword1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.06,.07,.08,.09,.1).Build()})]}),hr=f.Factory({Name:"SkywardPride",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"SkywardPride1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.08,.1,.12,.14,.16).Next().instance.Basic({Name:"HIT_SkywardPride",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.8,1,1.2,1.4,1.6]}).Build()})]}),xe=(e,a)=>r.Factory({Name:e,MaxRank:5,OnApply:new r.Builder().instance.Options({Name:a,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NONE,Scaling:[{Initial:0,Stat:t.stat.NONE,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Next().Where({not:!0,enemy:{affected:[t.stat.CRYO_DMG]}}).mv.Mv(t.stat.ATK,.8,a).Map((n,s,i)=>[.8,.95,1.1,1.25,1.4][i.GetRank()-1]).Next().Where({enemy:{affected:[t.stat.CRYO_DMG]}}).mv.Mv(t.stat.ATK,2,a).Map((n,s,i)=>[2,2.4,2.8,3.2,3.6][i.GetRank()-1]).Build()}),Lr=f.Factory({Name:"SnowTombedStarsilver",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[xe("SnowTombedStarsilver1","HIT_SnowTombedStarsilver")]}),Nr=f.Factory({Name:"TheBell",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"TheBell1",MaxRank:5,OnApply:new r.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),Qt=e=>r.Factory({Name:e,MaxRank:5,MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Next().Where({target:{shielded:!0}}).stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()}),fr=f.Factory({Name:"TheUnforged",Type:t.weapon.CLAYMORE,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[Qt("TheUnforged1")]}),mr=f.Factory({Name:"Whiteblind",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.DEF_PERCENT,Effects:[r.Factory({Name:"Whiteblind1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),Mr=f.Factory({Name:"WhiteIronGreatsword",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.DEF_PERCENT,Effects:[]}),Cr=f.Factory({Name:"WolfsGravestone",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"WolfsGravestone1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()}),r.Factory({Name:"WolfsGravestone2",MaxRank:5,ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.4,.5,.6,.7,.8).Build()})]}),pr=f.Factory({Name:"SerpentSpine",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"SerpentSpine1",MaxRank:5,MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.06,.07,.08,.09,.1).Stacks().Build()})]}),Gr=f.Factory({Name:"FreedomSworn",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"FreedomSworn1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.1,.125,.15,.175,.2).Build()}),Ve({Name:"FreedomSworn2",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),dr=f.Factory({Name:"LightOfFoliarIncision",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"LightOfFoliarIncision1",MaxRank:5,Conditions:["HIT_NORMAL"],MaxConditions:1,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.04,.05,.06,.07,.08).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT,t.stat.ELEMENTAL_SKILL_DMG_FLAT).Values(1.2,1.5,1.8,2.1,2.4).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()})]}),gr=f.Factory({Name:"KeyOfKhajNisut",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"KeyOfKhajNisut1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Build()}),r.Factory({Name:"KeyOfKhajNisut2",MaxRank:5,MaxStacks:3,ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.HP,t.stat.HP_PERCENT,t.stat.HP_FLAT).Where({target:{isOwner:!0}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(.12,.15,.18,.21,.24).Stacks().Map((e,a)=>e*a.GetCharacter().Get(t.stat.HP)/100).Next().observe.Owner(t.stat.HP,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ELEMENTAL_MASTERY).Stacks([0,0,0,.2],[0,0,0,.25],[0,0,0,.3],[0,0,0,.35],[0,0,0,.4]).Map((e,a,{Owner:n})=>e*n.GetCharacter().Get(t.stat.HP)/100).Build()})]}),Rr=f.Factory({Name:"HaranGeppakuFutsu",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"HaranGeppakuFutsu1",MaxRank:5,MaxStacks:2,OnApply:new r.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Stacks().Build()})]}),Ir=f.Factory({Name:"MistsplitterReforged",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"MistsplitterReforged1",MaxRank:5,MaxStacks:3,OnApply:new r.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char().MapStat(e=>[e.GetCharacter().Options.Element]).Stacks([0,.08,.16,.28],[0,.1,.2,.35],[0,.12,.24,.42],[0,.14,.28,.49],[0,.16,.32,.56]).Build()})]}),Or=f.Factory({Name:"JadeCutter",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"JadeCutter1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Next().stat.Char(t.stat.ATK_FLAT).Values(.012,.015,.018,.021,.024).Map((e,a)=>e*a.GetCharacter().Get(t.stat.HP)).Build()})]}),Dr=f.Factory({Name:"SummitShaper",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[Qt("SummitShaper1")]}),vr=f.Factory({Name:"AquilaFavonia",Type:t.weapon.SWORD,Stars:5,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"AquilaFavonia1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().instance.Basic({Name:"HIT_AquilaFavonia",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2,2.3,2.6,2.9,3.2]}).Build()})]}),yr=f.Factory({Name:"ToukabouShigure",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"ToukabouShigure1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.16,.2,.24,.28,.32).Build()})]}),Hr=f.Factory({Name:"XiphosMoonlight",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[$i("XiphosMoonlight1",t.stat.ENERGY_RECHARGE,[.036/100,.045/100,.054/100,.063/100,.072/100])]}),Pr=f.Factory({Name:"SapwoodBlade",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[sr("SapwoodBlade1")]}),Br=f.Factory({Name:"KagotsurubeIsshin",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"KagotsurubeIsshin1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_KagotsurubeIsshin",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.8]}).Next().stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()})]}),br=f.Factory({Name:"CinnabarSpindle",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.DEF_PERCENT,Effects:[r.Factory({Name:"CinnabarSpindle1",MaxRank:5,OnApply:new r.Builder().mv.Mv(t.stat.DEF,.4,e=>e.Options.Talent===t.stat.ELEMENTAL_SKILL_DMG).Map((e,a,n)=>[.4,.5,.6,.7,.8][n.GetRank()-1]).Build()})]}),Kr=f.Factory({Name:"AmenomaKageuchi",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[]}),wr=f.Factory({Name:"FesteringDesire",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"FesteringDesire1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ELEMENTAL_SKILL_CRIT_RATE).Values(.06,.075,.09,.105,.12).Build()})]}),Yr=f.Factory({Name:"SwordOfDescension",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39b,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"SwordOfDescension1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_SwordOfDescension",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2]}).Next().Where({target:{name:/traveler/i}}).stat.Char(t.stat.ATK_FLAT).Values(66).Build()})]}),Fr=f.Factory({Name:"TheAlleyFlash",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"TheAlleyFlash1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),Vr=f.Factory({Name:"BlackcliffLongsword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.CRIT_DMG,Effects:[zt("BlackcliffLongsword1")]}),xr=f.Factory({Name:"IronSting",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"IronSting1",MaxRank:5,MaxStacks:2,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),kr=f.Factory({Name:"PrototypeRancour",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"PrototypeRancour1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()})]}),Ur=f.Factory({Name:"LionsRoar",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"LionsRoar1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),Wr=f.Factory({Name:"TheFlute",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"TheFlute1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_TheFlute",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),jr=f.Factory({Name:"RoyalGrimoire",Type:t.weapon.CATALYST,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Rt("RoyalGrimoire1")]}),qr=f.Factory({Name:"RoyalSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Rt("RoyalSpear1")]}),zr=f.Factory({Name:"RoyalBow",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Rt("RoyalBow1")]}),Qr=f.Factory({Name:"RoyalLongsword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Rt("RoyalLongsword1")]}),$r=f.Factory({Name:"SkyriderSword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"SkyriderSword1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Build()})]}),Xr=f.Factory({Name:"DarkIronSword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"DarkIronSword1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),Zr=f.Factory({Name:"FilletBlade",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"FilletBlade1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_FilletBlade",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,2.8,3.2,3.6,4]}).Build()})]}),Jr=f.Factory({Name:"TravelersHandySword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.DEF_PERCENT,Effects:[]}),tl=f.Factory({Name:"HarbingerOfDawn",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"HarbingerOfDawn1",MaxRank:5,OnApply:new r.Builder().Where({target:{hp:{geq:.9}}}).stat.Char(t.stat.CRIT_RATE).Values(.14,.175,.21,.245,.28).Build()})]}),el=f.Factory({Name:"CoolSteel",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"CoolSteel1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.CRYO_DMG,t.stat.HYDRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),al=f.Factory({Name:"HuntersPath",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"HuntersPath1",MaxRank:5,Conditions:["HIT_CHARGED"],MaxConditions:1,OnApply:new r.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({effect:{conditions:["HIT_CHARGED"]}}).stat.Char(t.stat.CHARGED_ATTACK_DMG_FLAT).Values(1.6,2,2.4,2.8,3.2).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()})]}),nl=f.Factory({Name:"ThunderingPulse",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"ThunderingPulse1",MaxRank:5,MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG).Stacks([0,.12,.24,.4],[0,.15,.3,.5],[0,.18,.36,.6],[0,.21,.42,.7],[0,.24,.48,.8]).Build()})]}),sl=f.Factory({Name:"AquaSimulacra",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"AquaSimulacra1",MaxRank:5,Conditions:["FAR","NEAR"],MaxConditions:1,OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["NEAR"]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),il=f.Factory({Name:"PolarStar",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"PolarStar1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Stacks([0,.1,.2,.3,.48],[0,.125,.25,.375,.6],[0,.15,.3,.45,.72],[0,.175,.35,.525,.84],[0,.2,.4,.6,.96]).Build()})]}),rl=f.Factory({Name:"AmosBow",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"AmosBow1",MaxRank:5,MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),ll=f.Factory({Name:"EndOfTheLine",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"EndOfTheLine1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_EndOfTheLine",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.8,1,1.2,1.4,1.6]}).Build()})]}),ol=f.Factory({Name:"KingsSquire",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"KingsSquire1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,80,100,120,140).Next().instance.Basic({Name:"HIT_KingsSquire",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.2,1.4,1.6,1.8]}).Build()})]}),cl=f.Factory({Name:"MouunsMoon",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Ye("MouunsMoon1")]}),El=f.Factory({Name:"Predator",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"Predator1",MaxRank:5,MaxStacks:2,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.1).Stacks().Next().Where({target:{name:"Aloy"}}).stat.Char(t.stat.ATK_FLAT).Values(66).Build()})]}),Tl=f.Factory({Name:"Hamayumi",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"Hamayumi1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().Where({target:{energy:{geq:1}}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().Where({target:{energy:{geq:1}}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().Build()})]}),_l=f.Factory({Name:"WindblumeOde",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"WindblumeOde1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()})]}),Al=f.Factory({Name:"MitternachtsWaltz",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"MitternachtsWaltz1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_SKILL"],MaxConditions:2,OnApply:new r.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),Sl=f.Factory({Name:"FadingTwilight",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"FadingTwilight1",MaxRank:5,MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Stacks([0,.06,.1,.14],[0,.075,.125,.175],[0,.09,.15,.21],[0,.105,.175,.245],[0,.12,.2,.28]).Build()})]}),ul=f.Factory({Name:"AlleyHunter",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"AlleyHunter1",MaxRank:5,MaxStacks:10,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.02,.025,.03,.035,.04).Stacks().Build()})]}),hl=f.Factory({Name:"TheViridescentHunt",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"TheViridescentHunt1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_TheViridescentHunt",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.4,.5,.6,.7,.8]}).Build()})]}),Ll=f.Factory({Name:"CompoundBow",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"CompoundBow1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()})]}),Nl=f.Factory({Name:"PrototypeCrescent",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"PrototypeCrescent1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.36,.45,.54,.63,.72).Build()})]}),fl=f.Factory({Name:"Rust",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"Rust1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.4,.5,.6,.7,.8).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(-.1).Build()})]}),ml=f.Factory({Name:"SacrificialBow",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Ml=f.Factory({Name:"TheStringless",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"TheStringless1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),Cl=f.Factory({Name:"Messenger",Type:t.weapon.BOW,Stars:3,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"Messenger1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_Messenger",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),pl=f.Factory({Name:"Slingshot",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"Slingshot1",MaxRank:5,Conditions:["FAR","NEAR"],MaxConditions:1,OnApply:new r.Builder().Where({effect:{conditions:["FAR"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.36,.42,.48,.54,.6).Next().Where({effect:{conditions:["NEAR"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(-.1).Build()})]}),Gl=f.Factory({Name:"RecurveBow",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.HP_PERCENT,Effects:[]}),dl=f.Factory({Name:"SharpshootersOath",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"SharpshootersOath1",Conditions:["WEAK_SPOT"],MaxConditions:1,MaxRank:5,OnApply:new r.Builder().Where({effect:{conditions:["WEAK_SPOT"]}}).stat.Char(t.stat.AIMED_SHOT_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),gl=f.Factory({Name:"RavenBow",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"RavenBow1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),Rl=f.Factory({Name:"TulaytullahsRemembrance",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"TulaytullahsRemembrance1",MaxRank:5,MaxStacks:10,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.048,.06,.072,.084,.096).Stacks().Build()})]}),Il=f.Factory({Name:"ThousandFloatingDreams",Type:t.weapon.CATALYST,Stars:5,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"ThousandFloatingDreams1",MaxRank:5,OnApply(e,a,n){const s=e.GetCharacter(),i=n.Modifier(s.CreateModifier(t.stat.ELEMENTAL_MASTERY,0)),l=[n.Modifier(s.CreateModifier(s.Options.Element,0)),n.Modifier(s.CreateModifier(s.Options.Element,0)),n.Modifier(s.CreateModifier(s.Options.Element,0))];function E(){l.forEach(h=>h.SetValue(0));let _=[s];const A=e.GetParty();A&&(_=A.GetMembers().map(h=>h.GetCharacter()));let S=0,u=0;for(const h of _)if(h!==s)if(h.Options.Element===s.Options.Element)S++;else{const N=l[u++];if(!N)continue;N.SetProp(h.Options.Element),N.SetValue(t1[a.GetRank()-1])}S=Math.min(3,S),i.SetValue(JL[a.GetRank()-1]*S)}return E(),n.Observer(e.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,E)),n.Observer(a.Event.CreateObserver(r.EffectEvent.CHANGE_RANK,E)),()=>0}}),r.Factory({Name:"ThousandFloatingDreams2",MaxRank:5,ApplyOther:!0,ApplySelf:!1,StackSelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(40,42,44,46,48).Build()})]}),JL=[32,40,48,56,64],t1=[.1,.14,.18,.22,.26],Ol=f.Factory({Name:"WanderingEvenstar",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"WanderingEvenstar1",StackSelf:!0,ApplyOther:!0,MaxRank:5,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.24,.3,.36,.42,.48).Map((e,a,n)=>e*n.Owner.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)*(a===n.Owner?1:.3)).Build()})]}),Dl=f.Factory({Name:"KagurasVerity",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"KagurasVerity1",MaxRank:5,MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.12,.15,.18,.21,.24).Stacks().Next().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Stacks([0,0,0,.12],[0,0,0,.15],[0,0,0,.18],[0,0,0,.21],[0,0,0,.24]).Build()})]}),vl=f.Factory({Name:"EverlastingMoonglow",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"EverlastingMoonglow1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.1,.125,.15,.175,.2).Next().observe.Target(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(.01,.015,.02,.025,.03).Map((e,a)=>e*a.GetCharacter().Get(t.stat.HP)).Build()})]}),yl=f.Factory({Name:"MemoryOfDust",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[Qt("MemoryOfDust1")]}),Hl=f.Factory({Name:"LostPrayer",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"LostPrayer1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),Pl=f.Factory({Name:"SkywardAtlas",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"SkywardAtlas1",MaxRank:5,OnApply:new r.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().instance.Basic({Name:"HIT_SkywardAtlas",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.6,2,2.4,4.8,3.2]}).Build()})]}),Bl=f.Factory({Name:"FruitOfFulfillment",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"FruitOfFulfillment1",MaxRank:5,MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(24,27,30,33,36).Stacks().Next().stat.Char(t.stat.ATK_PERCENT).Values(-.05).Stacks().Build()})]}),bl=f.Factory({Name:"OathswornEye",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"OathswornEye1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.24,.3,.36,.42,.48).Build()})]}),Kl=f.Factory({Name:"HakushinRing",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"HakushinRing1",ApplyOther:!0,MaxRank:5,OnApply:new r.Builder().stat.Char().MapStat(e=>[e.GetCharacter().Options.Element]).Values(.1,.125,.15,.175,.2).Build()})]}),wl=f.Factory({Name:"DodocoTales",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"DodocoTales1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_CHARGED"],MaxConditions:2,OnApply:new r.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["HIT_CHARGED"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.08,.1,.12,.14,.16).Next().Build()})]}),Yl=f.Factory({Name:"Frostbearer",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[xe("Frostbearer1","HIT_Frostbearer")]}),Fl=f.Factory({Name:"EyeOfPerception",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"EyeOfPerception1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_EyeOfPerception",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,2.7,3,3.3,3.6]}).Build()})]}),Vl=f.Factory({Name:"BlackcliffAgate",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[zt("BlackcliffAgate1")]}),xl=f.Factory({Name:"MappaMare",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"MappaMare1",MaxRank:5,MaxStacks:2,OnApply:new r.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),kl=f.Factory({Name:"PrototypeAmber",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.HP_PERCENT,Effects:[]}),Ul=f.Factory({Name:"SolarPearl",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"SolarPearl1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_SKILL"],MaxConditions:2,OnApply:new r.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Next().Build()})]}),Wl=f.Factory({Name:"SacrificialFragments",Type:t.weapon.CATALYST,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[]}),jl=f.Factory({Name:"FavoniusCodex",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),ql=f.Factory({Name:"AmberBead",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"AmberBead1",MaxRank:5,MaxStacks:2,OnApply:new r.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),zl=f.Factory({Name:"TwinNephrite",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"TwinNephrite1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.14,.16,.18,.2).Build()})]}),Ql=f.Factory({Name:"EmeraldOrb",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"EmeraldOrb1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),$l=f.Factory({Name:"OtherworldlyStory",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Xl=f.Factory({Name:"ThrillingTalesOfDragonSlayers",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"ThrillingTalesOfDragonSlayers1",MaxRank:5,ApplySelf:!1,ApplyOther:!0,MaxTargets:1,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.24,.3,.36,.42,.48).Build()})]}),Zl=f.Factory({Name:"MagicGuide",Type:t.weapon.CATALYST,Stars:3,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"MagicGuide1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),Jl=f.Factory({Name:"StaffOfTheScarletSands",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"StaffOfTheScarletSands1",MaxRank:5,MaxStacks:3,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.52,.65,.78,.91,1.04).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.28,.35,.42,.49,.56).Stacks().Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Next().Build()})]}),to=f.Factory({Name:"CalamityQueller",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_49,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"CalamityQueller1",MaxRank:5,MaxStacks:6,Conditions:["ON_FIELD","OFF_FIELD"],MaxConditions:1,OnApply:new r.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ATK_PERCENT).Values(.032,.04,.048,.056,.064).Stacks().Next().Where({effect:{conditions:["OFF_FIELD"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.032,.04,.048,.056,.064).Stacks().Next().Build()})]}),eo=f.Factory({Name:"JadeSpear",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"JadeSpear1",MaxRank:5,MaxStacks:7,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.032,.039,.046,.053,.06).Stacks().Next().stat.Char(t.stat.ALL_DMG).Stacks([0,0,0,0,0,0,0,.12],[0,0,0,0,0,0,0,.15],[0,0,0,0,0,0,0,.18],[0,0,0,0,0,0,0,.21],[0,0,0,0,0,0,0,.24]).Build()})]}),ao=f.Factory({Name:"VortexVanquisher",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[Qt("VortexVanquisher1")]}),no=f.Factory({Name:"SkywardSpine",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"SkywardSpine1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.08,.1,.12,.14,.16).Next().instance.Basic({Name:"HIT_SkywardSpine",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.4,.55,.7,.85,1]}).Build()})]}),so=f.Factory({Name:"MissiveWindspear",Type:t.weapon.POLEARM,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"MissiveWindspear1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(48,60,72,84,96).Build()})]}),io=f.Factory({Name:"Moonpiercer",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"Moonpiercer1",ApplyOther:!0,MaxTargets:1,MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()})]}),ro=f.Factory({Name:"EngulfingLightning",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"EngulfingLightning1",MaxRank:5,Conditions:["CAST_BURST","NO_BURST"],MaxConditions:1,OnApply:new r.Builder().observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ATK_PERCENT).Values(.28,.35,.42,.49,.56).Map((e,a,n)=>e1(e,a.GetCharacter().Get(t.stat.ENERGY_RECHARGE),n.GetRank())).Next().Where({effect:{conditions:["CAST_BURST"]}}).stat.Char(t.stat.ENERGY_RECHARGE).Values(.3,.35,.4,.45,.5).Build()})]});function e1(e,a,n){return Math.min(e*Math.max(0,a-1),a1[n-1])}var a1=[.8,.9,1,1.1,1.2],lo=f.Factory({Name:"WavebreakerFin",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_45,Substat:t.stat.ATK_PERCENT,Effects:[Ye("WavebreakerFin1")]}),oo=f.Factory({Name:"KitainCrossSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"KitainCrossSpear1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.06,.075,.09,.105,.12).Build()})]}),co=f.Factory({Name:"DragonspineSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.PHYSICAL_DMG,Effects:[xe("DragonspineSpear1","HIT_DragonspineSpear")]}),Eo=f.Factory({Name:"LithicSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[lr("LithicSpear1")]}),To=f.Factory({Name:"CrescentPike",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"CrescentPike1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_CrescentPike",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.2,.25,.3,.35,.4]}).Build()})]}),_o=f.Factory({Name:"Halberd",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"Halberd1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_Halberd",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.6,2,2.4,2.8,3.2]}).Build()})]}),Ao=f.Factory({Name:"DragonsBane",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"DragonsBane1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.PYRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),So=f.Factory({Name:"SacrificialSword",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),uo=f.Factory({Name:"ElegyForTheEnd",Type:t.weapon.BOW,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"ElegyForTheEnd1",ApplySelf:!0,MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,75,90,105,120).Build()}),Ve({Name:"ElegyForTheEnd2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100,125,150,175,200).Next().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),ho=f.Factory({Name:"StaffOfHoma",Type:t.weapon.POLEARM,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"StaffOfHoma1",ApplySelf:!0,MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Next().observe.Target(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ATK_FLAT).Values(.008,.01,.012,.014,.016).Map((e,a)=>a.GetCharacter().Get(t.stat.HP)*e).Next().observe.Target(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ATK_FLAT).Where({target:{hp:{leq:.5}}}).Values(.01,.012,.014,.016,.018).Map((e,a)=>a.GetCharacter().Get(t.stat.HP)*e).Build()})]}),Lo=f.Factory({Name:"FavoniusLance",Type:t.weapon.POLEARM,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),No=f.Factory({Name:"WhiteTassel",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"WhiteTassel1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),fo=f.Factory({Name:"BlackTassel",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"BlackTassel1",MaxRank:5,Conditions:["NO_SLIMES","SLIMES"],MaxConditions:1,OnApply:new r.Builder().Where({effect:{conditions:["SLIMES"]}}).stat.Char(t.stat.ALL_DMG).Values(.4,.5,.6,.7,.8).Build()})]}),mo=f.Factory({Name:"PrototypeStarglitter",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"PrototypeStarglitter1",MaxStacks:2,MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.08,.1,.12,.14,.16).Stacks().Next().Build()})]}),Mo=f.Factory({Name:"BlackcliffPole",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[zt("BlackcliffPole1")]}),Co=f.Factory({Name:"Deathmatch",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"Deathmatch1",MaxRank:5,MaxConditions:1,Conditions:["ENEMY_1","ENEMY_2"],OnApply:new r.Builder().Where({effect:{conditions:["ENEMY_2"]}}).stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["ENEMY_1"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.24,.3,.36,.42,.48).Build()})]}),po=f.Factory({Name:"SkywardBlade",Stars:5,Type:t.weapon.SWORD,Substat:t.stat.ENERGY_RECHARGE,Scaling:o.WeaponScaling.TYPE_46,Effects:[r.Factory({Name:"SkywardBlade1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.04,.05,.06,.07,.08).Next().instance.Basic({Name:"HIT_SkywardBlade",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.2,.25,.3,.35,.4]}).Build()})]}),Go=f.Factory({Name:"SkywardHarp",Type:t.weapon.BOW,Stars:5,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"SkywardHarp1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.CRIT_DMG).Values(.2,.25,.3,.35,.4).Next().instance.Basic({Name:"HIT_SkywardHarp",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.25]}).Build()})]}),go=f.Factory({Name:"FavoniusSword",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Ro=f.Factory({Name:"FavoniusWarbow",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Io=f.Factory({Name:"TheWidsith",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"TheWidsith1",MaxRank:5,Conditions:["RECITATIVE","ARIA","INTERLUDE"],MaxConditions:1,OnApply:new r.Builder().Where({effect:{conditions:["RECITATIVE"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.6,.75,.9,1.05,1.2).Next().Where({effect:{conditions:["ARIA"]}}).stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.48,.6,.72,.84,.96).Next().Where({effect:{conditions:["INTERLUDE"]}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(240,300,360,420,480).Build()})]}),Oo=Object.values(ji).sort((e,a)=>e.Type===a.Type?e.Stars===a.Stars?e.Name.localeCompare(a.Name):e.Stars-a.Stars:e.Type-a.Type),$t={};for(const e of Oo)$t[e.Type]||($t[e.Type]=[]),$t[e.Type].push(e);var ke=new Q(e=>e.Name);ke.AddList(Oo);function Do(){return ke.Get()}function n1(e){return ke.Find(e)}function s1(e){return $t[e]||[]}var Xt={};O(Xt,{FindByName:()=>r1,GetList:()=>i1});var _t=new Q(e=>e.Name);for(const e of Wi())e.Effects.forEach(a=>_t.Add(a));for(const e of Do())e.Effects.forEach(a=>_t.Add(a));for(const e of Xs())e.Piece2.forEach(a=>_t.Add(a)),e.Piece4.forEach(a=>_t.Add(a));for(const e of jn())_t.Add(e);function i1(){return _t.Get()}function r1(e){return _t.Find(e)}var It={};O(It,{ArtifactStore:()=>c1,FilterArtifacts:()=>Ue,PartyFrom:()=>l1});function l1(e){const a=new d.Party;for(const n in e.characters){const s=Tt.FindByName(n);if(!s)throw new Error(`Character not found: ${n}`);const i=s();a.Add(i);const l=e.characters[n],E=Object.keys(l.weapon)[0];if(E){const _=nt.FindByName(E);if(!_)throw new Error(`Weapon not found: ${n}`);i.SetWeapon(_)}l.artifacts&&Object.keys(l.artifacts).length>0&&i.SetArtifacts(new Et.Artbox(i))}return d.ImportParty(e,a),a}function Ue(e,a,n){const s=a.map(i=>o1(i));return n&&s.push({filter(i){return!(n.pieces&&!n.pieces.includes(i.piece)||n.only&&n.only==="locked"!==!!i.locked)}}),_a.Filter({values:e,mode:"every",filters:s})}function o1(e){const a=e.pieces||t.piece.Values(),n=e.subsMode||"some";return{for(s){return a.includes(s.piece)},filter(s){if(e.main&&!e.main.includes(s.mainstat))return!1;if(e.subs){const i=s.substats.map(E=>E.stat);if(!e.subs[n](E=>i.includes(E)))return!1}return!(Number.isFinite(e.stars)&&s.stars<(e.stars||0)||Number.isFinite(e.level)&&s.level<(e.level||0))}}}var c1=class{constructor(e){this.onChange=e,this.list=[],this.filtered=[]}Update(){this.onChange()}All(){return this.list}Clear(){this.list.splice(0,this.list.length),this.filtered.splice(0,this.filtered.length),this.onChange()}Add(e,a="push"){const n=I.Export(e);this.list[a](n),this.filtered=[...this.list],this.onChange()}AddExported(e,a="push"){this.list[a](e),this.filtered=[...this.list],this.onChange()}Filter(e,a){const{values:n}=Ue(this.list,e,a);return this.filtered=n,n}Get(){return this.filtered}Replace(e,a){const n=this.list.indexOf(e);return n===-1?!1:(this.list.splice(n,1,a),this.onChange(),!0)}RemoveMultiple(e,a){const{indexes:n}=Ue(this.list,e,a),s=[];return this.list.forEach((i,l)=>{n.includes(l)||s.push(i)}),this.list=s,this.onChange(),s.length}Remove(e){const a=this.list.indexOf(e);return a===-1?!1:(this.list.splice(a,1),this.onChange(),!0)}};function w(e){const a=e.endsWith("%");a&&(e=e.slice(0,e.length-1));let n=parseFloat(e);if(!Number.isFinite(n))throw new Error(`Invalid number format: "${e}"`);return a&&(n/=100),n}function aN(e){return e}var E1=()=>({show:{description:"Shows the rolls of the character artifacts",arguments:[],compile({Value:e,Log:a}){return function(){const i=e.GetChar().GetArtifacts();if(!i){a.Error("Current character has no artifacts");return}a.Log(`
`+i.GetArtifacts().map(l=>T.ArtifactRolls(l)).join(`
`))}}},tier:{description:"Sets the rolls tier to equip.`",example:"artifact rolls tier avg",arguments:["0 | 1 | 2 | 3 | avg = 4"],compile({Value:e,Log:a},[n]){let s,i;return n==="avg"?(s=4,i="AVERAGE"):(s=Math.max(0,Math.min(4,Math.floor(w(n)))),i=s+""),function(){e.Config.substats.tier=s,a.Logf("Rolls tier set to %s",i)}}},equip:{description:"Equips the given rolls to the artifacts.Arguments in the form `[stat] [rolls] [stat] [rolls] ...`.",example:"artifact rolls equip crit_rate 10 crit_dmg 12 elemental_mastery 3",compile({Value:e,Log:a},n){const s=[];for(let i=0;i<n.length;i+=2){const l=n[i].toUpperCase(),E=t.stat.Get(l),_=t.stat.Name(E),A=n[i+1];if(!A)throw a.Throwf("Missing # of rolls for stat %s",_);const S=Math.max(0,Math.floor(w(A)));s.push([E,S])}return function(){const l=e.GetChar().GetArtifacts();if(!l)throw a.Throw("Current character has no artifacts");l.EquipRolls({substats:s,tier:e.Config.substats.tier})?e.Config.substats.tier===4?a.Logf("Equipped rolls of tier %s","AVERAGE"):a.Logf("Equipped rolls of tier %d",e.Config.substats.tier):a.Error("Rolls could not be equipped")}}}}),T1=()=>({list:{description:"Lists the registered artifact sets",arguments:[],compile({Log:e}){const a=new T.Table(T.labels.SET,T.labels.STARS),n=J.GetList();return n.forEach(s=>a.AddRow(s.Name,s.Stars)),function(){e.Logf("Total artifact sets: %d",n.length),e.Log(`
`+a.String())}}},add:{description:"Adds a build of 5 artifacts to the current character",arguments:[],compile({Value:e,Log:a}){return function(){const s=e.GetChar();s.GetArtifacts()?a.Warn("Artifacts not created. Character already has artifacts"):(s.SetArtifacts(new Et.Artbox(s)),a.Log("Artifacts created"))}}},fill:{description:"Adds 4 empty substats to all artifacts in the current character",arguments:[],compile({Value:e,Log:a}){return function(){const i=e.GetChar().GetArtifacts();i?(i.GetArtifacts().forEach(l=>l.FillSubstats()),a.Log("All artifacts filled")):a.Error("Character has no artifacts")}}},main:{description:"Sets the mainstats of the character artifacts.",example:"artifact main atk_percent pyro_dmg crit_rate",arguments:["sands","goblet","circlet"],compile({Value:e,Log:a},[n,s,i]){const l=t.stat.Get(n.toUpperCase()),E=t.stat.Get(s.toUpperCase()),_=t.stat.Get(i.toUpperCase());return function(){const u=e.GetChar().GetArtifacts();if(!u){a.Error("Current character has no artifacts");return}u.Get(2).SetMainstat(l),u.Get(3).SetMainstat(E),u.Get(4).SetMainstat(_);const h=u.GetArtifacts().map(N=>t.stat.Name(N.GetMainstat()));a.Logf("Artifact mainstats set to %s",h.join(", "))}}},level:{description:"Sets the level of all the artifacts of the current character.",example:"artifact level 20",arguments:["level"],compile({Value:e,Log:a},[n]){const s=w(n);return function(){const E=e.GetChar().GetArtifacts();if(!E){a.Error("Current character has no artifacts");return}E.GetArtifacts().forEach(A=>A.SetLevel(s));const _=E.GetArtifacts().map(A=>A.GetLevel());a.Logf("Artifact levels set to %s",_.join(", "))}}},stars:{description:"Sets the stars of all the artifacts of the current character.",example:"artifact stars 5",arguments:["stars"],compile({Value:e,Log:a},[n]){const s=w(n);return function(){const E=e.GetChar().GetArtifacts();if(!E){a.Error("Current character has no artifacts");return}E.GetArtifacts().forEach(A=>A.SetStars(s));const _=E.GetArtifacts().map(A=>A.GetStars());a.Logf("Artifact stars set to %s",_.join(", "))}}},remove:{description:"Removes all artifacts from the current character",arguments:[],compile({Value:e,Log:a}){return function(){e.GetChar().SetArtifacts(void 0),a.Log("Artifacts removed")}}},show:{description:"Shows the artifacts of the current character",arguments:[],compile({Value:e,Log:a}){return function(){const i=e.GetChar().GetArtifacts();if(!i){a.Error("Current character has no artifacts");return}a.Log(`
`+T.Artifact(...i.GetArtifacts()))}}},rolls:{description:"Control the artifact rolls in the current character",children:E1()},sets:{description:"Changes the artifact sets. Arguments in one of the following forms:\n- `artifact sets [name]`: 2-piece effect of the given set\n- `artifact sets [nameA] [nameB]`: 2-piece effect of the given sets, or the 4-piece effect if they're both the same.\n- `artifact sets [name] [# of pieces]`: the given set with 2-piece or 4-piece effects.\n\nrun without arguments to remove all the sets.",example:`artifact sets CrimsonWitchOfFlames 4 // 4-piece set
artifact sets CrimsonWitchOfFlames WanderersTroupe // 2 + 2 piece set`,compile({Value:e,Log:a},n){if(n.length===0)return function(){const A=e.GetChar().GetArtifacts();if(!A)throw a.Throw("Current character has no artifacts");A.GetArtifacts().forEach(S=>S.SetSet(void 0)),a.Log("Removed all artifact sets")};n.length===1&&n.push("2");let s,i;const l=J.FindByName(n[0]);if(!l)throw a.Throwf("Set %s not found",n[0]);if(s=l.Name,n[1]==="2")i=void 0;else if(n[1]==="4")i=s;else{const E=J.FindByName(n[1]);if(!E)throw a.Throwf("Set %s not found",n[1]);i=E.Name}return function(){const A=e.GetChar().GetArtifacts();if(!A)throw a.Throw("Current character has no artifacts");A.Get(0).SetSet(s),A.Get(1).SetSet(s),A.Get(2).SetSet(i),A.Get(3).SetSet(i),a.Logf("Artifact sets set to %s",A.GetActiveSets().join(", "))}}}}),_1=()=>{const e={};return t.piece.Values().forEach(a=>e[t.piece.Name(a).toLowerCase()]={description:"Controls the artifact "+t.piece.Name(a),children:A1(a)()}),e},A1=e=>()=>({main:{description:"Sets the mainstat of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" main "+t.stat.Name(t.PieceToMainstats(e)[0]),arguments:["mainstat"],compile({Value:a,Log:n},[s]){const i=t.stat.Get(s.toUpperCase());return function(){const _=a.GetChar().GetArtifacts();if(!_){n.Error("Current character has no artifacts");return}_.Get(e).SetMainstat(i),n.Logf("%s mainstat set to %s",t.piece.Name(e),_.Get(e).GetMainstat())}}},set:{description:"Sets the set name of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" set WanderersTroupe",arguments:["set"],compile({Value:a,Log:n},[s]){return function(){const E=a.GetChar().GetArtifacts();if(!E){n.Error("Current character has no artifacts");return}E.Get(e).SetSet(s),n.Logf("%s set changed to %s",t.piece.Name(e),E.Get(e).GetSet())}}},level:{description:"Sets the level of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" level 16",arguments:["level"],compile({Value:a,Log:n},[s]){const i=w(s);return function(){const _=a.GetChar().GetArtifacts();if(!_){n.Error("Current character has no artifacts");return}_.Get(e).SetLevel(i),n.Logf("%s level set to %d",t.piece.Name(e),_.Get(e).GetLevel())}}},stars:{description:"Sets the stars of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" stars 4",arguments:["stars"],compile({Value:a,Log:n},[s]){const i=w(s);return function(){const _=a.GetChar().GetArtifacts();if(!_){n.Error("Current character has no artifacts");return}_.Get(e).SetStars(i),n.Logf("%s stars set to %d",t.piece.Name(e),_.Get(e).GetStars())}}},show:{description:"Shows the "+t.piece.Name(e),arguments:[],compile({Value:a,Log:n}){return function(){const l=a.GetChar().GetArtifacts();if(!l){n.Error("Current character has no artifacts");return}n.Log(`
`+T.Artifact(l.Get(e)))}}},rolls:{description:"Shows the rolls of the "+t.piece.Name(e),arguments:[],compile({Value:a,Log:n}){return function(){const l=a.GetChar().GetArtifacts();if(!l){n.Error("Current character has no artifacts");return}const E=l.Get(e);n.Log(T.ArtifactRolls(E))}}},sub:{description:"Control the substats of the "+t.piece.Name(e),children:{clear:{description:"Set all substats to 0",arguments:[],compile({Value:a,Log:n}){return function(){const l=a.GetChar().GetArtifacts();if(!l){n.Error("Current character has no artifacts");return}l.Get(e).ClearSubstats(),n.Log("Substats cleared")}}},add:{description:"Adds a new substat to the artifact.",example:t.piece.Name(e).toLowerCase()+" sub add crit_rate 7.8%",arguments:["stat","value"],compile({Value:a,Log:n},[s,i]){const l=t.stat.Get(s.toUpperCase()),E=w(i);return function(){const S=a.GetChar().GetArtifacts();if(!S){n.Error("Current character has no artifacts");return}S.Get(e).AddSubstat(l,E)?n.Log("Substat added"):n.Warn("Substat not added")}}},set:{description:"Changes a substat. Substat index starts from zero.",example:t.piece.Name(e).toLowerCase()+" sub set 2 crit_rate 7.8%",arguments:["index","stat","value"],compile({Value:a,Log:n},[s,i,l]){const E=w(s),_=t.stat.Get(i.toUpperCase()),A=w(l);return function(){const h=a.GetChar().GetArtifacts();if(!h){n.Error("Current character has no artifacts");return}const N=h.Get(e);if(E>=N.SubstatsLength()){n.Errorf("Substat index out of range [0-%d]",N.SubstatsLength()-1);return}N.SetSubstat(E,_),N.SetSubstatValue(E,A),n.Logf("Substat %d changed",E)}}}}},downgrade:{description:"Converts a 5-star artifact to a 4-star artifact, reducing the value of substats.",arguments:[],compile({Value:a,Log:n}){return function(){const l=a.GetChar().GetArtifacts();if(!l){n.Error("Current character has no artifacts");return}const E=l.Get(e);I.transform.Downgrade(E),n.Log("Artifact downgraded")}}}}),S1=()=>({list:{description:"Lists the stats of the current character",arguments:[],compile({Value:e,Log:a}){return function(){const s=e.GetChar().GetCharacter(),i=new T.Table(T.labels.STAT,T.labels.VALUE);i.DecimalPlaces=4;for(const l of t.stat.Values())i.AddRow(t.stat.Name(l),s.Get(l));a.Log(`
`+i.String())}}},get:{description:"Gets the value of stats in the current character",example:"character stat get crit_rate crit_dmg",compile({Value:e,Log:a},n){const s=n.map(i=>t.stat.Get(i.toUpperCase()));return function(){const l=e.GetChar().GetCharacter(),E=new T.Table(T.labels.STAT,T.labels.VALUE);E.DecimalPlaces=4;for(const _ of s)E.AddRow(t.stat.Name(_),l.Get(_));a.Log(`
`+E.String())}}},set:{description:"Sets the value of a stat in the current character",example:"character stat set atk_percent 45%",arguments:["stat","value"],compile({Value:e,Log:a},[n,s]){const i=t.stat.Get(n.toUpperCase()),l=w(s);return function(){const _=e.GetChar(),A=_.GetCharacter();if(i===t.stat.HP_CURRENT||i===t.stat.ENERGY_CURRENT)A.Set(i,l);else{const S=A.Get(i);_.AddModifier(A.CreateModifier(i,l-S))}a.Logf("Character stat %s set to %.4f",t.stat.Name(i),l)}}},add:{description:"Adds to the value of a stat in the current character",example:"character stat add atk_percent 10%",arguments:["stat","value"],compile({Value:e,Log:a},[n,s]){const i=t.stat.Get(n.toUpperCase()),l=w(s);return function(){const _=e.GetChar(),A=_.GetCharacter();_.AddModifier(A.CreateModifier(i,l)),a.Logf("Modified %s + %.4f = %.4f",t.stat.Name(i),l,A.Get(i))}}},mods:{description:"Lists the stats added to the character with `stat add [...]`",arguments:[],compile({Value:e,Log:a}){return function(){const s=e.GetChar(),i=new T.Table(T.labels.STAT,T.labels.VALUE);i.DecimalPlaces=4,s.GetModifiers().forEach(l=>i.AddRow(t.stat.Name(l.GetProp()),l.GetValue())),a.Log(`
`+i.String())}}},clear:{description:"Removes the stat modifiers created by `stat add [...]`",arguments:[],compile({Value:e,Log:a}){return function(){e.GetChar().ClearModifiers(),a.Log("Cleared modifiers")}}}}),u1=()=>({add:{description:"Adds a new character.",example:"character add hutao",arguments:["name"],compile(e,[a]){const{Value:n,Log:s}=e,i=Tt.FindByName(a);if(!i)throw s.Throwf("Character not found: %s",a);return function(){if(n.Party.FindMember(a)){s.Errorf("Cannot add character %s because it is already added",i.Name);return}const _=i();n.Party.Add(_),s.Logf("Character %s added to the party",_.GetCharacter().Options.Name),e.Compile(["character","set",i.Name],{line:s.Line})()}}},remove:{description:"Removes a character from the party",example:"character remove Hutao",arguments:["name"],compile(e,[a]){const{Value:n,Log:s}=e;return function(){const l=n.Party.FindMember(a);if(!l){s.Errorf("Cannot remove character %s because it is not added",a);return}n.Party.Remove(l)?(l.GetEffects().forEach(E=>E.Disable().UnapplyAll()),n.GetChar()===l&&e.Compile(["character","unset"],{line:s.Line})(),s.Logf("Character %s removed",l.GetCharacter().Options.Name)):s.Logf("Cannot remove character %s",l.GetCharacter().Options.Name)}}},set:{description:"Sets the current character",example:"character set Hutao",arguments:["name"],compile({Value:e,Log:a},[n]){return function(){const i=e.Party.FindMember(n);if(!i){a.Errorf("Cannot set character %s because it is not added",n);return}e.SetChar(i),a.Logf("Character %s set as current",i.GetCharacter().Options.Name)}}},unset:{description:"Unsets the current character",arguments:[],compile({Value:e,Log:a}){return function(){e.SetChar(void 0),a.Log("Character unset. There is no current character selected")}}},level:{description:"Sets the level of the current character",example:`character level 70
character level 80+ // level 80 ascended`,arguments:["level"],compile({Value:e,Log:a},[n]){let s=n;const i=n.endsWith("+");i&&(s=n.slice(0,s.length-1));const l=w(s),E=i?6:0;return function(){const A=e.GetChar().GetCharacter();A.SetLevel(l),A.SetAscension(E),a.Logf("Character level set to %d%s",A.GetLevel(),A.IsAscended()?"+":"")}}},talent:{description:"Sets the talent levels of the current character",example:"character talent 9 5 7",arguments:["normal","skill","burst"],compile({Value:e,Log:a},n){const[s,i,l]=n.map(E=>w(E));return function(){const _=e.GetChar().GetCharacter();_.Set(t.stat.NORMAL_ATTACK_LEVEL,s),_.Set(t.stat.ELEMENTAL_SKILL_LEVEL,i),_.Set(t.stat.ELEMENTAL_BURST_LEVEL,l),a.Logf("Character Normal Attack level set to %d",s),a.Logf("Character Elemental Skill level set to %d",i),a.Logf("Character Elemental Burst level set to %d",l)}}},list:{description:"Lists all the registered characters",arguments:[],compile({Log:e}){const a=new T.Table(T.labels.CHARACTER,T.labels.ELEMENT,T.labels.WEAPON,T.labels.STARS,T.labels.REGION),n=Tt.GetList();n.forEach(i=>a.AddRow(i.Name,t.stat.Name(i.Element),t.weapon.Name(i.Weapon),i.Stars,t.region.Name(i.Region)));const s=a.String();return function(){e.Logf("Total characters: %d",n.length),e.Log(`
`+s)}}},show:{description:"Shows the characters in the party",arguments:[],compile({Value:e,Log:a}){return function(){a.Log(`
`+T.Character(...e.Party.GetMembers()))}}},damage:{description:"Shows the current character's damage instances",arguments:[],compile({Value:e,Log:a}){return function(){const s=e.GetChar();a.Log(`
`+T.Instance(...s.GetInstances()))}}},stat:{description:"Controls character stats directly",children:S1()}}),h1=()=>({all:{description:"List all effects in the party",arguments:[],compile({Value:e,Log:a}){return function(){a.Log(`
`+T.Effect(...e.Party.GetAllEffects()))}}},list:{description:"Lists the effects of the current character",arguments:[],compile({Value:e,Log:a}){return function(){const i=[...e.GetChar().GetEffects(),...e.Party.GetResonances()];a.Log(`
`+T.Effect(...i))}}},applied:{description:"Lists all the effects in the party that are applied to the current character.",arguments:[],compile({Value:e,Log:a}){return function(){const s=e.GetChar(),i=e.Party.GetAppliedEffects(s);a.Log(`
`+T.Effect(...i))}}},set:{description:"Sets the current effect",example:"effect set RaidenE",arguments:["name"],compile({Value:e,Log:a},[n]){return function(){let l=e.GetChar().FindEffect(n);if(l||(l=e.Party.GetResonances().find(E=>E.Options.Name.toLowerCase()===n.toLowerCase())),!l){a.Errorf("Cannot find effect %s",n);return}e.SetEffect(l),a.Logf("Effect set to %s",l.Options.Name)}}},unset:{description:"Unsets the current effect",arguments:[],compile({Value:e,Log:a}){return function(){e.SetEffect(void 0),a.Log("Current effect unset")}}},show:{description:"Shows details about the current effect",arguments:[],compile({Value:e,Log:a}){return function(){const s=e.GetEffect();a.Log(`
`+T.EffectDetail(s))}}},enable:{description:"Enables the current effect",arguments:[],compile({Value:e,Log:a}){return function(){const s=e.GetEffect();s.Enable(),a.Logf("Effect %s enabled",s.Options.Name)}}},disable:{description:"Disables the current effect",arguments:[],compile({Value:e,Log:a}){return function(){const s=e.GetEffect();s.Disable(),a.Logf("Effect %s disabled",s.Options.Name)}}},apply:{description:"Applies the current effect to the given characters, or all",example:`effect apply HuTao
effect apply HuTao Xingqiu
effect apply all`,compile({Value:e,Log:a},n){return function(){const i=e.GetEffect();if(n[0]==="all"){for(const l of e.Party.GetMembers())i.Apply(l);a.Logf("Effect %s applied to all members",i.Options.Name);return}for(const l of n){const E=e.Party.FindMember(l);if(!E){a.Errorf("Cannot find target %s",l);return}i.Apply(E)?a.Logf("Effect %s applied to target %s",i.Options.Name,E.GetCharacter().Options.Name):a.Warnf("Effect %s NOT applied to target %s",i.Options.Name,E.GetCharacter().Options.Name)}}}},unapply:{description:"Unapplies the current effect from the given characters, or all",example:`effect apply HuTao
effect unapply HuTao Xingqiu
effect unapply all`,compile({Value:e,Log:a},n){return function(){const i=e.GetEffect();if(n[0]==="all"){for(const l of e.Party.GetMembers())i.Unapply(l);a.Logf("Effect %s unapplied from all members",i.Options.Name);return}for(const l of n){const E=e.Party.FindMember(l);if(!E){a.Errorf("Cannot find target %s",l);return}i.Unapply(E)?a.Logf("Effect %s unapplied from target %s",i.Options.Name,E.GetCharacter().Options.Name):a.Warnf("Effect %s NOT unapplied from target %s",i.Options.Name,E.GetCharacter().Options.Name)}}}},lock:{description:`Locks the effect to prevent being modified by character stat changes.

This will disable all the effect observers for the provided character.

Note that enabling the effect again will re-activate all the observers again.`,example:`effect set HuTaoE
effect enable
effect lock HuTao
character level 1
// this code will lock the HP to ATK conversion of Hu Tao to prevent it from changing`,arguments:["character"],compile({Value:e,Log:a},[n]){return function(){const i=e.GetEffect(),l=e.Party.FindMember(n);if(!l){a.Errorf("Cannot find character %s in the party",n);return}i.Lock(l),a.Logf("Effect %s locked for character %s. Note that enabling the effect again will re-activate all the observers again.",i.Options.Name,l.GetCharacter().Options.Name)}}},stacks:{description:"Sets the current effect's stacks",example:"effect stacks 9",arguments:["stacks"],compile({Value:e,Log:a},[n]){const s=w(n);return function(){const l=e.GetEffect();l.SetStacks(s),a.Logf("Effect stacks set to %f",l.GetStacks())}}},condition:{description:"Sets the current effect's condition (s)",example:`effect condition near
effect condition far
effect condition // this removes all conditions`,compile({Value:e,Log:a},n){return function(){const i=e.GetEffect();i.SetConditions(...n);const l=i.GetConditions();a.Logf("Effect conditions set to ["+"%s".repeat(l.length)+"]",...l)}}},aura:{description:"Sets the current effect's applied aura (s), or all",example:`effect aura frozen
effect aura hydro electro
effect aura // this removes all auras
effect aura all // this applies all auras`,compile({Value:e,Log:a},n){return function(){const i=e.GetEffect(),l=n.length>0&&n[0].match(/all/i)?t.aura.Values().filter(_=>_!==t.aura.NONE):n.map(_=>t.aura.Get(_.toUpperCase()));i.SetAuras(...l);const E=i.GetAuras().map(_=>t.aura.Name(_));a.Logf("Effect auras set to ["+"%s".repeat(E.length)+"]",...E)}}},details:{description:"Shows the registered modifiers of the current effect",arguments:[],compile({Value:e,Log:a}){return function(){const s=e.GetEffect();a.Log(`
`+s.Register())}}}}),L1=()=>({show:{description:"Shows all the enemies",arguments:[],compile({Value:e,Log:a}){return function(){const i=e.Party.GetMembers().map(l=>l.GetCharacter().GetEnemy());a.Logf(`
`+T.Enemy(...i))}}},level:{description:"Sets the level of all enemies",example:"enemy level 100",arguments:["level"],compile({Value:e,Log:a},[n]){const s=w(n);return function(){e.Party.GetMembers().forEach(l=>l.GetCharacter().GetEnemy().SetLevel(s)),a.Logf("All enemy levels changed to %d",s)}}},aura:{description:"Sets enemies applied aura (s), or all",example:`enemy aura frozen
enemy aura hydro electro
enemy aura // this removes all auras
enemy aura all // this applies all auras`,compile({Value:e,Log:a},n){const s=n.length>0&&n[0].match(/all/i)?t.aura.Values().filter(i=>i!==t.aura.NONE):n.map(i=>t.aura.Get(i.toUpperCase()));return function(){e.Party.GetMembers().forEach(l=>l.GetCharacter().GetEnemy().SetAuras(...s)),a.Logf("All enemy auras changed to %s",s.map(l=>t.aura.Name(l)).join(", "))}}}}),N1="https://enka.network";function vo(e){return Ct(this,null,function*(){try{return yield(yield fetch(N1+"/u/"+e+"/__data.json")).json()}catch(a){console.error("[ENKA ERROR]",a)}})}var f1={EQUIP_BRACER:t.piece.FLOWER,EQUIP_NECKLACE:t.piece.PLUME,EQUIP_SHOES:t.piece.SANDS,EQUIP_RING:t.piece.GOBLET,EQUIP_DRESS:t.piece.CIRCLET},m1={20848859:"BlackcliffSlasher",37147251:"SolarPearl",160493219:"DarkIronSword",197755235:"VortexVanquisher",231836963:"PrimordialJadeCutter",310247243:"KagurasVerity",313300315:"SapwoodBlade",342097547:"CinnabarSpindle",346510395:"LuxuriousSeaLord",411685275:"CompoundBow",452357939:"Moonpiercer",479076483:"CoolSteel",481755219:"BlackcliffPole",540938627:"Predator",578575283:"CrescentPike",618786571:"Halberd",623534363:"FavoniusCodex",650049651:"WindblumeOde",656120259:"SharpshootersOath",680510411:"Whiteblind",688991243:"CalamityQueller",693354267:"MemoryOfDust",716252627:"LithicSpear",735056795:"FavoniusGreatsword",807607555:"SkywardAtlas",828711395:"AmosBow",850802171:"WhiteIronGreatsword",877751435:"RoyalGreatsword",902184579:"ForestRegalia",902264035:"AquilaFavonia",930640955:"TheBell",944332883:"SummitShaper",1012170803:"KagotsurubeIsshin",1021898539:"Slingshot",1072884907:"MappaMare",1075647299:"SongOfBrokenPines",1089950259:"SkywardPride",1154009435:"PrototypeStarglitter",1163263227:"TheWidsith",1240067179:"FavoniusWarbow",1321135667:"LionsRoar",1348687251:"HuntersPath",1388004931:"SkyriderSword",1390797107:"WhiteTassel",1406746947:"OtherworldlyStory",1437658243:"SerpentSpine",1455107995:"LostPrayer",1470442731:"MissiveWindspear",1479961579:"FerrousShadow",1600275315:"HaranGeppakuFutsu",1608953539:"HarbingerOfDawn",1675686363:"SacrificialGreatsword",1773425155:"SwordOfDescension",1860795787:"MouunsMoon",1890163363:"EverlastingMoonglow",1901973075:"PolarStar",1990641987:"SacrificialSword",1990820123:"AmenomaKageuchi",1991707099:"PrototypeRancour",1997709467:"JadeSpear",2006422931:"LithicBlade",2195665683:"SacrificialFragments",2267978875:"FruitofFulfillment",2279290283:"MagicGuide",2324146259:"HakushinRing",2359799475:"Akuoumaru",2375993851:"RoyalLongsword",2400012995:"SacrificalBow",2417717595:"AlleyHunter",2425414923:"FadingTwilight",2474354867:"FavoniusSword",2491797315:"KitainCrossSpear",2521338131:"PrototypeAmber",2539208459:"OathswornEye",2556914683:"TheStringless",2587614459:"Frostbearer",2614170427:"SkyriderGreatsword",2664629131:"DragonsBane",2749853923:"FesteringDesire",2753539619:"SnowTombedStarsilver",2792766467:"TheUnforged",2832648187:"RoyalBow",2918525947:"ThunderingPulse",2935286715:"RoyalSpear",2947140987:"TheAlleyFlash",2949448555:"FreedomSworn",2963220587:"EmeraldOrb",3063191787:"EndOfTheLine",3073454867:"MakhairaAquamarine",3090373787:"WineAndSong",3097441915:"DebateClub",3112679155:"ElegyForTheEnd",3156385731:"EyeOfPerception",3169209451:"Rust",3176599083:"KingsSquire",3235324891:"StaffOfHoma",3273999011:"BlackcliffAgate",3378007475:"BlackcliffLongsword",3421967235:"FilletBlade",3439749859:"TheViridescentHunt",3443142923:"DragonspineSpear",3447737235:"BlackcliffWarbow",3456986819:"DodocoTales",3500935003:"ThrillingTalesOfDragonSlayers",3587621259:"TheFlute",3625393819:"PrototypeCrescent",3673792067:"TravelersHandySword",3684723963:"Rainslasher",3717849275:"EngulfingLightning",3719372715:"TwinNephrite",3722933411:"PrototypeArchaic",3755004051:"FavoniusLance",3796905611:"TheBlackSword",3827789435:"RoyalGrimoire",3914951691:"RedhornStonethresher",3933622347:"SkywardHarp",3949653579:"MitternachtsWaltz",3975746731:"RavenBow",3995710363:"WolfsGravestone",4049410651:"Deathmatch",4055003299:"SkywardBlade",4090429643:"BloodtaintedGreatsword",4103022435:"IronSting",4103766499:"BlackTassel",4122509083:"WavebreakersFin",4124851547:"MistsplitterReforged",4158505619:"SkywardSpine",4186179883:"Hamayumi",4193089947:"KatsuragikiriNagamasa",4230231107:"AquaSimulacra",4238339131:"StaffOfTheScarletSands",4267718859:"RecurveBow"},M1={83115355:"MaidenBeloved",147298547:"WanderersTroupe",156294403:"HeartOfDepth",855894507:"Berserker",862591315:"PaleFlame",933076627:"BlizzardStrayer",1186209435:"Gambler",1212345779:"GladiatorsFinale",1337666507:"TenacityOfTheMillelith",1438974835:"RetracingBolide",1524173875:"CrimsonWitchOfFlames",1541919827:"BloodstainedChivalry",1558036915:"VermillionHereafter",1562601179:"ViridescentVenerer",1632377563:"Lavawalker",1675079283:"DeepwoodMemories",1751039235:"NoblesseOblige",1756609915:"OceanHuedClam",1873342283:"Thundersoother",2040573235:"ArchaicPetra",2276480763:"EmblemOfSeveredFate",2364208851:"ResolutionOfSojourner",2512309395:"ThunderingFury",2546254811:"HuskOfOpulentDreams",2764598579:"TheExile",2890909531:"MartialArtist",3535784755:"BraveHeart",3618167299:"Scholar",3626268211:"EchoesOfAnOffering",3890292467:"Instructor",4082302819:"DefendersWill",4144069251:"ShimenawasReminiscence",4145306051:"GildedDreams"},yo={FIGHT_PROP_BASE_ATTACK:t.stat.ATK_BASE,FIGHT_PROP_HP:t.stat.HP_FLAT,FIGHT_PROP_ATTACK:t.stat.ATK_FLAT,FIGHT_PROP_DEFENSE:t.stat.DEF_FLAT,FIGHT_PROP_HP_PERCENT:t.stat.HP_PERCENT,FIGHT_PROP_ATTACK_PERCENT:t.stat.ATK_PERCENT,FIGHT_PROP_DEFENSE_PERCENT:t.stat.DEF_PERCENT,FIGHT_PROP_CRITICAL:t.stat.CRIT_RATE,FIGHT_PROP_CRITICAL_HURT:t.stat.CRIT_DMG,FIGHT_PROP_CHARGE_EFFICIENCY:t.stat.ENERGY_RECHARGE,FIGHT_PROP_HEAL_ADD:t.stat.HEALING_BONUS,FIGHT_PROP_ELEMENT_MASTERY:t.stat.ELEMENTAL_MASTERY,FIGHT_PROP_PHYSICAL_ADD_HURT:t.stat.PHYSICAL_DMG,FIGHT_PROP_FIRE_ADD_HURT:t.stat.PYRO_DMG,FIGHT_PROP_ELEC_ADD_HURT:t.stat.ELECTRO_DMG,FIGHT_PROP_WATER_ADD_HURT:t.stat.HYDRO_DMG,FIGHT_PROP_WIND_ADD_HURT:t.stat.ANEMO_DMG,FIGHT_PROP_ICE_ADD_HURT:t.stat.CRYO_DMG,FIGHT_PROP_ROCK_ADD_HURT:t.stat.GEO_DMG,FIGHT_PROP_GRASS_ADD_HURT:t.stat.DENDRO_DMG},C1={10000002:"Ayaka",10000003:"Jean",10000006:"Lisa",10000014:"Barbara",10000015:"Kaeya",10000016:"Diluc",10000020:"Razor",10000021:"Amber",10000022:"Venti",10000023:"Xiangling",10000024:"Beidou",10000025:"Xingqiu",10000026:"Xiao",10000027:"Ningguang",10000029:"Klee",10000030:"Zhongli",10000031:"Fischl",10000032:"Bennett",10000033:"Tartaglia",10000034:"Noelle",10000035:"Qiqi",10000036:"Chongyun",10000037:"Ganyu",10000038:"Albedo",10000039:"Diona",10000041:"Mona",10000042:"Keqing",10000043:"Sucrose",10000044:"Xinyan",10000045:"Rosaria",10000046:"HuTao",10000047:"Kazuha",10000048:"Yanfei",10000049:"Yoimiya",10000050:"Thoma",10000051:"Eula",10000052:"Raiden",10000053:"Sayu",10000054:"Kokomi",10000055:"Gorou",10000056:"Sara",10000057:"Itto",10000058:"Yae Miko",10000059:"Heizou",10000060:"Yelan",10000062:"Aloy",10000063:"Shenhe",10000064:"YunJin",10000065:"Kuki",10000066:"Ayato",10000067:"Collei",10000068:"Dori",10000069:"Tighnari",10000070:"Nilou",10000071:"Cyno",10000072:"Candace",10000073:"Nahida",10000074:"Layla",10000075:"Wanderer",10000076:"Faruzan"};function Ho(e){const a=[];for(const n of e.avatarInfoList){const s=C1[n.avatarId];if(!s){console.error(`[ENKA ERROR] Cannot find character by avatarId ${n.avatarId}`);continue}const i=Tt.FindByName(s);if(!i){console.error(`[ENKA ERROR] Cannot find character by name ${s}`);continue}const l=parseInt(n.propMap[4001].val)||1,E=parseInt(n.propMap[1002].val)||1,_=Object.values(n.skillLevelMap),A=i(),S=new Et.Artbox(A);A.SetArtifacts(S);const u=A.GetCharacter();u.SetLevel(l),u.SetAscension(E),u.Set(t.stat.NORMAL_ATTACK_LEVEL,_[0]),u.Set(t.stat.ELEMENTAL_SKILL_LEVEL,_[1]),u.Set(t.stat.ELEMENTAL_BURST_LEVEL,_[2]);const h=n.equipList.filter(L=>L.flat.itemType==="ITEM_RELIQUARY"),N=n.equipList.filter(L=>L.flat.itemType==="ITEM_WEAPON");for(const L of h){const{reliquary:m,flat:C}=L;if(!m)continue;const{level:G}=m;if(!C.equipType){console.error("Cannot get artifact piece");continue}const M=f1[C.equipType];if(C.rankLevel<4){console.error("[ENKA ERROR] Cannot set 3-star artifacts");continue}const p=S.Get(M);if(p.SetStars(C.rankLevel),p.SetLevel(G-1),!C.reliquaryMainstat){console.error("[ENKA ERROR] Cannot get artifact mainstat");continue}p.SetMainstat(yo[C.reliquaryMainstat.mainPropId]);const g=C.reliquarySubstats;if(!g){console.error("[ENKA ERROR] Cannot get artifact substats");continue}for(const R of g){const y=yo[R.appendPropId];let H=R.statValue;t.FlatStats.includes(y)||(H/=100),p.AddSubstat(y,H)}const D=L.flat.setNameTextMapHash;if(D){const R=M1[D];p.SetSet(R)}}S.GetArtifacts().forEach(L=>L.FillSubstats());for(const L of N){const m=m1[L.flat.nameTextMapHash];if(!m){console.error("[ENKA ERROR] Cannot find weapon by key "+L.flat.nameTextMapHash);continue}const C=nt.FindByName(m);if(!C){console.error("[ENKA ERROR] Cannot find weapon by name "+m);continue}A.SetWeapon(C);const G=A.GetWeapon();if(!G){console.error("[ENKA ERROR] Cannot equip weapon by name "+C.Name);continue}if(!L.weapon)continue;const{level:M,promoteLevel:p,affixMap:g}=L.weapon;G.SetLevel(M),G.SetAscension(p);const D=Object.values(g).reduce((R,y)=>Math.max(R,y),0)+1;G.SetRank(D)}a.push(A)}return a}function Po(e){return Ct(this,null,function*(){const a=yield vo(e);if(!a)throw new Error("[ENKA ERROR] Cannot fetch data from Enka.Network");return Ho(a)})}var p1=()=>{let e=[];return{uid:{description:"Imports characters from a player UID using Enka.Network service",example:"enka uid 609609619",arguments:["UID"],compile({Log:a},[n]){return function(){a.Log("Importing from Enka.Network service. Please wait..."),Po(n).then(i=>{e=i;const l=new T.Table(T.labels.CHARACTER,T.labels.LEVEL);for(const E of e){const _=E.GetCharacter();l.AddRow(_.Options.Name,_.GetLevel())}a.Log(`
Imported characters:
`+l.String()),a.Logf("Imported %d characters from Enka.Network",i.length),a.Log("Run `enka load <characters...>` to load an imported character to the current party")}).catch(i=>a.Error(String(i).valueOf()))}}},load:{description:"Loads characters imported from Enka.Network to the current party",example:"enka load hutao xingqiu yelan zhongli",compile(a,n){const{Value:s,Log:i}=a;return function(){const E=[];for(const _ of n){const A=e.find(S=>S.GetCharacter().Options.Name.toLowerCase()===_);if(!A){i.Errorf('Character "%s" not found in Enka',_);continue}s.Party.Add(A),E.push(A)}i.Logf("Added %d characters to the party",E.length),E.length>0&&a.Compile(["character","set",E[0].GetCharacter().Options.Name],{line:i.Line})()}}}}},G1=()=>({clear:{description:"Clears all the rotation actions",arguments:[],compile({Value:e,Log:a}){return function(){e.Rotation.Clear(),a.Log("Rotation cleared")}}},run:{description:"Runs the rotation",arguments:[],compile({Value:e,Log:a}){return function(){a.Warn("Running rotation..."),e.Rotation.SetCharacters(...e.Party.GetMembers());const s=e.Rotation.Run();a.Logf("Rotation damage: %d",s)}}},log:{description:"Controls rotation logs",children:{enable:{description:"Enables the rotation logs",arguments:[],compile({Value:e,Log:a}){return function(){e.Rotation.Log=a,a.Log("Rotation log enabled")}}},disable:{description:"Disables the rotation logs",arguments:[],compile({Value:e,Log:a}){return function(){e.Rotation.Log=void 0,a.Log("Rotation log disabled")}}}}},summary:{description:"Prints a summary of the last rotation run",arguments:[],compile({Value:e,Log:a}){return function(){a.Log(`
`+T.Rotation(e.Rotation.GetSummary()))}}},hit:{description:'Adds a hit to the rotation. Arguments in the form:\n	`rotation hit [character_name] [hit_name] [extra...]`.\n\nWhere `[extra...]` can be one or more of the following:\n	- a multiplier in the form `*3`, `*0.5`, etc.\n	- `aura=x` to set the aura uptime, where `0 <= x <= 1`.\n	- `reaction=x` to set the reaction uptime, where `0 <= x <= aura`.\n\nIf no values provided for `aura` or `reaction`, they will be set to 1 by default.\n\nIf `reaction` is greater than `aura`, it will be set to the value of `aura`.\n\nDO NOT include the prefix "hit_" for the hit name, it will be automatically added.',example:`rotation hit Hutao Charged *9 // 9 charged attacks from Hu Tao
rotation hit Hutao N1 aura=90% reaction=40% // hutao normal attack 1 with 90% aura and 40% reaction uptime`,arguments:["charname","hitname","extra..."],compile({Value:e,Log:a},[n,s,...i]){s="HIT_"+s;let l=1,E=1,_=1;return i.forEach(A=>{const S=A.match(d1);if(S){const h=w(S[1]);l*=h;return}const u=A.match(g1);if(u){const h=u[1].toLowerCase(),N=w(u[2]);h==="aura"?E=N:h==="reaction"&&(_=N)}}),function(){e.Rotation.AddHit(n,s,l,_,E,a.Line),a.Logf("Added hit %s (%s) to rotation with multiplier=%.2f, aura=%.2f, reaction=%.2f",s,n,l,_,E)}}},do:{description:"Saves a command to be executed as a rotation action.",example:"rotation do effect stacks 9",compile(e,a){const{Value:n,Log:s}=e,i=e.Compile(a,{line:s.Line});return function(){n.Rotation.AddFn(i,s.Line),s.Logf("Added action to rotation: `%s`",a.join(" "))}}},duration:{description:"Sets the rotation duration, in seconds.",example:"rotation duration 22 // 22 seconds",compile({Value:e,Log:a},[n]){const s=w(n);return function(){e.Rotation.Duration=s,a.Logf("Rotation duration set to %.2f seconds.",s)}}}}),d1=/^\*([0-9]+(?:\.[0-9]+)?%?)$/i,g1=/^(reaction|aura)=([0-9]+(?:\.[0-9]+)?%?)$/i,Bo=()=>({substats:{tier:4}}),R1=class{constructor(){this.Party=new d.Party,this.Rotation=new jt.Rotation,this.Config=Bo()}Reset(){this.Party=new d.Party,this.Rotation=new jt.Rotation,this.Character=void 0,this.Effect=void 0,this.Config=Bo(),this.State=void 0}GetEffect(){if(!this.Effect)throw new Error("Effect not set");return this.Effect}SetEffect(e){this.Effect=e}GetChar(){if(!this.Character)throw new Error("Character not set");return this.Character}SetChar(e){if(e&&!this.Party.GetMembers().includes(e))throw new Error("Cannot set scenario character: character not in party");this.Character=e}},I1=()=>({save:{description:"Saves the current party state.",arguments:[],compile({Value:e,Log:a}){return function(){e.State=d.ExportParty(e.Party),a.Log("State saved")}}},load:{description:"Loads a previously saved party state.",arguments:[],compile(e){const{Value:a,Log:n}=e;return function(){if(!a.State){n.Error("No state saved");return}a.Party=It.PartyFrom(a.State);const i=a.Party.GetMembers()[0],l=i?i.GetCharacter().Options.Name:void 0;e.Compile(["character","unset"],{line:n.Line})(),e.Compile(["effect","unset"],{line:n.Line})(),l&&e.Compile(["character","set",l],{line:n.Line})(),n.Log("Party loaded from saved state")}}},clear:{description:"Removes the saved state",arguments:[],compile({Value:e,Log:a}){return function(){e.State=void 0,a.Log("State cleared")}}},b64:{description:"Exports/imports party state as base64 strings",children:{export:{description:"Exports party state as a base64 string.",arguments:[],compile({Value:e,Log:a}){return function(){if(!e.State){a.Error("No state saved");return}const s=btoa(JSON.stringify(e.State));a.Log(s)}}},import:{description:"Imports party state from a base64 string.",arguments:["base64-string"],compile(e,[a]){const{Value:n,Log:s}=e,i=JSON.parse(atob(a));return function(){n.State=i,e.Compile(["state","load"],{line:s.Line})()}}}}}}),O1=()=>({list:{description:"List all registered weapons",arguments:[],compile({Log:e}){const a=Tt.Bennett(),n=nt.GetList(),s=new T.Table(T.labels.NAME,T.labels.WEAPON,t.stat.Name(t.stat.ATK_BASE),T.labels.STAT,T.labels.VALUE,T.labels.STARS);for(const l of n){const E=l(a);E.SetLevel(90),s.AddRow(l.Name,t.weapon.Name(l.Type),E.GetAtkBase(),t.stat.Name(E.GetSubstat()),E.GetSubstatValue(),l.Stars)}s.DecimalPlaces=4;const i=s.String();return function(){e.Logf("Total weapons: %d",n.length),e.Log(`
`+i)}}},set:{description:"Sets the weapon of the current character",example:"weapon set StaffOfHoma",arguments:["name"],compile({Value:e,Log:a},[n]){const s=nt.FindByName(n);if(!s)throw a.Throwf("Cannot find weapon %s",n);return function(){e.GetChar().SetWeapon(s),a.Logf("Weapon set to %s",s.Name)}}},level:{description:"Sets the level of the current character's weapon",example:`weapon level 70
weapon level 80+ //level 80 ascended`,arguments:["level"],compile({Value:e,Log:a},[n]){let s=n;const i=n.endsWith("+");i&&(s=n.slice(0,s.length-1));const l=w(s),E=i?6:0;return function(){const A=e.GetChar().GetWeapon();if(!A){a.Error("Character weapon is not set");return}A.SetLevel(l),A.SetAscension(E),A.SetAscension(0),a.Logf("Weapon level set to %d%s",A.GetLevel(),A.IsAscended()?"+":"")}}},rank:{description:"Sets the rank of the current character's weapon",example:"weapon rank 5",arguments:["rank"],compile({Value:e,Log:a},[n]){const s=w(n);return function(){const l=e.GetChar().GetWeapon();if(!l){a.Error("Character weapon is not set");return}l.SetRank(s),a.Logf("Weapon rank set to %d",l.GetRank())}}},remove:{description:"Removes the character weapon",arguments:[],compile({Value:e,Log:a}){return function(){e.GetChar().SetWeapon(void 0),a.Log("Weapon removed")}}}}),We=class{constructor(){this.Scenario=new R1,this.Program=new Pn(this.Scenario),this.Program.Set(st(z({character:{description:"Controls characters in the party",children:u1()},weapon:{description:"Controls weapons in the party",children:O1()},effect:{description:"Controls effects in the party",children:h1()},artifact:{description:"Controls all the artifacts",children:T1()}},_1()),{enemy:{description:"Controls all enemies in the party.",children:L1()},rotation:{description:"Controls the rotation",children:G1()},reset:{description:"Resets the scenario to its initial state",arguments:[],compile({Value:e,Log:a}){return function(){e.Reset(),a.Warnf("Command `reset` executed.")}}},state:{description:"Functions to save/load the party state",children:I1()},enka:{description:"Imports characters from Enka.Network service",children:p1()}}))}},bo={};O(bo,{BackendWorker:()=>k1,Generate:()=>wo,Optimizer:()=>W1,RotationDamage:()=>U1,SetGenerator:()=>y1,VirtualWorker:()=>Ko});var D1=0,Ko=class{constructor(e){this.poster=e,this.listenersByPath=new Map,this.pathsByListener=new Map,this.errorListeners=[]}SetPoster(e){this.poster=e}SetKiller(e){this.killer=e}Kill(){if(!this.killer)throw new Error("No killer function is defined for this worker");this.killer()}Post(e,a){const n=(++D1).toString(36);return this.poster(e,n,a),n}Recieve(e,a,n){return Ct(this,null,function*(){const s=this.listenersByPath.get(e);if(!s){console.error("WORKER PATH NOT FOUND: ",e);return}for(const i of[...s])yield i(a,n)})}Error(e){return Ct(this,null,function*(){for(const a of[...this.errorListeners])yield a(e)})}AddErrorListener(e){if(this.errorListeners.includes(e))throw new Error("Cannot add the same listener twice");return this.errorListeners.push(e),e}RemoveErrorListener(e){const a=this.errorListeners.indexOf(e);return a===-1?!1:(this.errorListeners.splice(a,1),!0)}AddListener(e,a){if(this.pathsByListener.has(a))throw new Error("Cannot add the same listener twice");this.pathsByListener.set(a,e);let n=this.listenersByPath.get(e);return n||(n=[],this.listenersByPath.set(e,n)),n.push(a),a}RemoveListener(e){const a=this.pathsByListener.get(e);if(!a)return!1;const n=this.listenersByPath.get(a);if(!n)return!1;const s=n.indexOf(e);return s===-1?!1:(n.splice(s,1),!0)}};function*v1(e,a){let n=[];for(const s of a)n.push(s),n.length>=e&&(yield n,n=[]);n.length>0&&(yield n)}var je=void 0;function y1(e){je=e}function wo(){if(!je)throw new Error("No backend worker generator is defined");return je()}var qe=class{constructor(e){this.actions=e,this.listeners=[]}Post(e,a){const n=this.worker;if(!n)throw new Error("Worker not set for this action");n.Post(e,a)}SetWorker(e){this.worker&&this.RemoveWorker();for(const a in this.actions){const n=this.actions[a];e.AddListener(a,n),this.listeners.push(n)}this.worker=e}RemoveWorker(){if(!!this.worker)for(const e of this.listeners)this.worker.RemoveListener(e)}},ze=class{constructor(){this.worker=wo()}Kill(){this.worker.Kill()}},Yo={};O(Yo,{Filter:()=>Qe});function Qe(e,...a){return a.every(n=>H1(e,n))}function H1(e,a){const n=e.Get(a.stat);return a.operator==="<="?n<=a.value:n>=a.value}var mt=class{constructor(){this.total=0}SetConfig(e){this.config=e}SetTarget(e){this.target=e}SetParty(e){this.party=e}SetRotation(e){this.rotation=e}Init(e){this.config=e,this.runner=new We;const a=this.runner.Scenario;e.Party&&(a.Party=It.PartyFrom(e.Party),this.party=a.Party),e.Cmd&&(this.runner.Program.CompileString(e.Cmd)(),this.rotation=a.Rotation,this.rotation.Log=void 0),e.Target&&(this.runner.Program.Compile(["character","set",e.Target])(),this.target=a.Character),this.init(e)}setTotal(e){this.total=e}GetTotal(){return this.total}GetConfig(){if(!this.config)throw new Error("Configuration not set for this optimizer. Try to run `.Init()` first");return this.config}GetParty(){if(!this.party)throw new Error("Party not set for this optimizer. Try to run `.Init()` first");return this.party}GetTarget(){if(!this.target)throw new Error("Target character not set for this optimizer. Try to run `.Init()` first");return this.target}GetRotation(){if(!this.rotation)throw new Error("Rotation not set for this optimizer. Try to run `.Init()` first");return this.rotation}GetRunner(){if(!this.runner)throw new Error("Runner not set for this optimizer. Try to run `.Init()` first");return this.runner}Run(){if(!this.rotation)throw new Error("Rotation not set for this optimizer. Try to run `.Init()` first");const e=d.ExportParty(this.GetParty());this.rotation.SetCharacters(...this.GetParty().GetMembers());const a=this.rotation.Run();return d.ImportParty(e,this.GetParty()),a}Optimize(){for(const e of this.Generate())this.Insert(this.Evaluate(e));return this.Get()}getConstants(){const e={};return this.target&&(e.target_name=this.target.GetCharacter().Options.Name,e.target_element=t.stat.Name(this.target.GetCharacter().Options.Element),e.target_element_aura=t.aura.Name(t.DmgToAura(this.target.GetCharacter().Options.Element))),this.party&&this.party.GetMembers().forEach((n,s)=>{const i=n.GetCharacter(),l="member_"+s;e[l+"_name"]=i.Options.Name,e[l+"_element"]=t.stat.Name(i.Options.Element),e[l+"_element_aura"]=t.aura.Name(t.DmgToAura(i.Options.Element))}),e}},Fo=5,Zt=class extends mt{constructor(){super(...arguments),this.queue=new ct,this.initDamage=0}init(e){if(e.substats.length>Fo)throw new Error(`Cannot optimize more than ${Fo} substats at once. Requested ${e.substats.length} substats instead`);const a=this.GetTarget(),n=(()=>{const E=a.GetArtifacts();if(!E){const _=new Et.Artbox(a);return a.SetArtifacts(_),_}return E})();this.initDamage=this.Run();for(const E of n.GetArtifacts())E.SetStars(5),E.ClearSubstats();const s=e.substats.map(({stat:E})=>E),i=e.substats.map(({min:E})=>E),l=e.substats.map(({max:E})=>E);this.modifiers=s.map(E=>a.GetCharacter().CreateModifier(E,0)),this.generator=Zn(s.length,e.total,i,l)}*Generate(){if(!this.generator)throw new Error("No generator has been initialized");yield*this.generator}Evaluate(e){const{tier:a,filter:n}=this.GetConfig(),s=this.GetTarget();if(!this.modifiers)throw new Error("Optimizer initialized incorrectly (no modifiers created)");const i=this.modifiers;e.forEach((A,S)=>i[S].SetValue(A*o.GetSubstatValue(5,i[S].GetProp(),a)));const l=[];i.forEach(A=>{const S=A.GetProp();l.push(s.GetCharacter().Get(S))});const E=[s.GetCharacter().Get(t.stat.ATK),s.GetCharacter().Get(t.stat.DEF),s.GetCharacter().Get(t.stat.HP)];if(n&&!Qe(s.GetCharacter(),...n))return{rolls:e,stats:l,damage:-1,relative:0,basic:E};const _=this.Run();return{rolls:e,stats:l,damage:_,relative:_/this.initDamage,basic:E}}Insert(e){e.damage>=0&&this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=this.GetConfig(),n=a.substats.map(({stat:i})=>t.stat.Name(i)),s=new k(t.stat.Name(t.stat.ATK),t.stat.Name(t.stat.DEF),t.stat.Name(t.stat.HP),...n,T.labels.DAMAGE,T.labels.RELATIVE);for(const i of e){const l=[];i.stats.forEach((_,A)=>{const u=t.FlatStats.includes(a.substats[A].stat)?V(_,0):V(_*100,2)+"%";l.push(u+` (${i.rolls[A]})`)});const E=i.basic.map(_=>V(_,0));s.AddRow(...E,...l,V(i.damage,0),V(i.relative*100,2)+"%")}return s}EquipCmd(e){const a=this.GetConfig();let n=`artifact add
artifact fill
artifact stars 5
artifact rolls tier `+a.tier+`
`;return n+="artifact rolls equip "+e.rolls.map((s,i)=>({rolls:s,stat:a.substats[i].stat})).reduce((s,i)=>s+t.stat.Name(i.stat)+" "+i.rolls+" ",""),n}},Vo={};O(Vo,{SubstatsOptimizer:()=>Zt,defaultConfig:()=>P1});var P1=()=>({total:25,tier:o.SubstatTier.ROLL_AVG,substats:[{stat:t.stat.CRIT_RATE,min:0,max:10},{stat:t.stat.CRIT_DMG,min:0,max:12},{stat:t.stat.ATK_PERCENT,min:0,max:12},{stat:t.stat.ELEMENTAL_MASTERY,min:0,max:12}]}),xo={[t.piece.FLOWER]:t.PieceToMainstats(t.piece.FLOWER),[t.piece.PLUME]:t.PieceToMainstats(t.piece.PLUME),[t.piece.SANDS]:t.PieceToMainstats(t.piece.SANDS),[t.piece.GOBLET]:t.PieceToMainstats(t.piece.GOBLET),[t.piece.CIRCLET]:t.PieceToMainstats(t.piece.CIRCLET)},ko=class extends mt{constructor(){super(...arguments),this.results=new ct,this.initDamage=0,this.allStats=xo}init(e){if(e.mainstats)for(const s of t.piece.Values()){let i=e.mainstats[s];!i||(i=i.filter(l=>xo[s].includes(l)),i.length!==0&&(this.allStats[s]=i))}const a=Object.values(this.allStats).map(s=>s.length).reduce((s,i)=>s*i,1);this.setTotal(a);const n=this.GetTarget();this.state=d.Export(n),this.initDamage=this.Run(),e.substats&&(this.subsOptimizer=new Zt,this.subsOptimizer.SetParty(this.GetParty()),this.subsOptimizer.SetTarget(this.GetTarget()),this.subsOptimizer.SetRotation(this.GetRotation()),this.subsOptimizer.Init(z({},e.substats)),this.subsCombinations=Array.from(this.subsOptimizer.Generate()),this.state=d.Export(n))}*Generate(){for(const e of this.allStats[t.piece.FLOWER])for(const a of this.allStats[t.piece.PLUME])for(const n of this.allStats[t.piece.SANDS])for(const s of this.allStats[t.piece.GOBLET])for(const i of this.allStats[t.piece.CIRCLET])yield[e,a,n,s,i]}Evaluate(e){const a=this.GetTarget(),n=a.GetArtifacts();if(!n)throw new Error("Target character has no artifacts to be optimized");for(let i=0;i<e.length;i++)n.Get(i).SetMainstat(e[i]);const s={damage:-1,mainstats:e,relative:0};if(this.subsOptimizer&&this.subsCombinations){const i=this.subsOptimizer;this.subsCombinations.forEach(_=>i.Insert(i.Evaluate(_)));const E=i.Get()[0];E&&(s.damage=E.damage,s.substats=E)}else s.damage=this.Run();return s.relative=s.damage/this.initDamage,this.state&&d.Import(this.state,a),s}Insert(e){e.damage>=0&&this.results.Push(e,e.damage)}Get(){return this.results.Extract()}Format(e){const a=this.GetConfig(),n=[t.piece.Name(t.piece.SANDS),t.piece.Name(t.piece.GOBLET),t.piece.Name(t.piece.CIRCLET)];if(a.substats){n.push(t.stat.Name(t.stat.ATK),t.stat.Name(t.stat.DEF),t.stat.Name(t.stat.HP));const i=a.substats.substats.map(l=>t.stat.Name(l.stat));n.push(...i)}n.push(T.labels.DAMAGE,T.labels.RELATIVE);const s=new k(...n);for(const i of e){const l=i.mainstats.slice(2).map(E=>t.stat.Name(E));if(a.substats&&i.substats){const E=a.substats,_=i.substats,A=[];_.stats.forEach((u,h)=>{const L=t.FlatStats.includes(E.substats[h].stat)?V(u,0):V(u*100,2)+"%";A.push(L+` (${_.rolls[h]})`)});const S=_.basic.map(u=>V(u,0));l.push(...S,...A)}l.push(V(i.damage,0),V(i.relative*100,2)+"%"),s.AddRow(...l)}return s}EquipCmd(e){const a=this.GetConfig();let n=`artifact add
artifact fill
`;for(const s of[t.piece.SANDS,t.piece.GOBLET,t.piece.CIRCLET]){const i=t.piece.Name(s).toLowerCase(),l=t.stat.Name(e.mainstats[s]);n+=i+" main "+l+`
`}if(e.substats&&a.substats){const s=new Zt;s.SetConfig(a.substats),n+=s.EquipCmd(e.substats)}return n}},$e=Array.from(new Set([...t.Substats,...t.Elements,t.stat.HEALING_BONUS]).values()),Uo=class extends mt{constructor(){super(...arguments),this.modifiers={},this.queue=new ct}init(){const e=this.GetTarget();$e.forEach(a=>this.modifiers[a]=e.GetCharacter().CreateModifier(a,0)),this.setTotal($e.length)}*Generate(){for(const e of $e)yield e}Evaluate(e){const a=this.GetConfig(),n=o.GetSubstatValue(5,e,a.tier);if(!this.modifiers)throw new Error("No modifiers has been initialized. Try to run `.Init()` first.");const s=this.modifiers[e];s.SetValue(0);const i=this.Run();s.SetValue(n);const l=this.Run();return s.SetValue(0),{stat:e,damage:l,benefit:l/i-1}}Insert(e){this.queue.Push(e,e.benefit)}Get(){return this.queue.Extract()}Format(e){const a=this.GetConfig(),n=new T.Table(T.labels.STAT,T.labels.VALUE,T.labels.DAMAGE,T.labels.BENEFIT);for(const{stat:s,damage:i,benefit:l}of e){const E=t.FlatStats.includes(s)?V(o.GetSubstatValue(5,s,a.tier),0):V(o.GetSubstatValue(5,s,a.tier)*100,2);n.AddRow(t.stat.Name(s),E,V(i,2),V(l*100,4)+"%")}return n}};function*Wo(...e){e.length===0&&(yield[]);function*a(n,s){for(const i of e[n]){const l=[...s,i];n===e.length-1?yield l:yield*a(n+1,l)}}yield*a(0,[])}function jo(e,a){const n=e.map(l=>{const E=a==null?void 0:a.get(l.Name.toLowerCase());if(E)return[E];{const _=[...l.Conditions||[""]],A=new Set([0]);return A.add(l.MaxStacks||0),A.add(Math.floor((l.MaxStacks||0)/2)),Array.from(Wo(_,Array.from(A))).map(([u,h])=>["effect condition "+u+`
effect stacks `+h])}});n.length===0&&n.push([]);const s=Array.from(Wo(...n)),i=[];for(const l of s){const E={};l.forEach((_,A)=>{E[e[A].Name]=_}),i.push(E)}return i}var Jt=J.GetList(),qo=class extends mt{constructor(){super(...arguments),this.cases=new Map,this.combinations=[],this.constants={},this.initDamage=0,this.queue=new ct}init(e){this.Combinate(e),this.setTotal(this.combinations.length),this.constants=this.getConstants(),this.initDamage=this.Run();const n=this.GetTarget().GetArtifacts();if(!n)throw new Error("Target character has no artifacts to be optimized");this.initState=n.GetArtifacts().map(s=>I.Export(s))}Combinate(e){e.ConfigCmd&&(this.cases=xt(e.ConfigCmd)),this.combinations=[];for(let a=0;a<Jt.length;a++)for(let n=a;n<Jt.length;n++){const s=[Jt[a],Jt[n]].sort((i,l)=>i.Stars-l.Stars);this.combinations.push(...this.createRows(s[0],s[1]))}}createRows(e,a){const n=(()=>e===a?[...e.Piece2,...e.Piece4]:[...e.Piece2,...a.Piece2])(),s=jo(n,this.cases),i=[];for(const l of s){const E={sets:[e.Name,a.Name],cmds:l};i.push(E)}return i}*Generate(){for(const e of this.combinations)yield e}Evaluate(e){const a=this.GetRunner(),s=this.GetTarget().GetArtifacts();if(!s)throw new Error("Target character has no artifacts to be optimized");const[i,l]=e.sets,E=J.FindByName(i),_=J.FindByName(l);s.Get(0).SetSet(i),s.Get(1).SetSet(i),s.Get(2).SetSet(l),s.Get(3).SetSet(l);const A=new Set;E&&E.Stars===4&&(A.add(0),A.add(1)),_&&_.Stars===4&&(A.add(2),A.add(3));for(const h of A)I.transform.Downgrade(s.Get(h));const S={sets:[i,l],states:[],damage:0,relative:0};for(const h of s.GetEffects()){const N=h.Options.Name;a.Scenario.Effect=h;const L=e.cmds[N];if(!L)continue;let m="";for(const C of L){const G=a.Program.CompileString(C,{constants:this.constants});G(),m+=G.String()+`
`}S.states.push({state:r.Export(h),cmd:"effect set "+N+`
`+m,effect:N})}const u=this.Run();if(S.damage=u,S.relative=u/this.initDamage,this.initState&&A.size>0){const h=this.initState;s.GetArtifacts().forEach((N,L)=>I.Import(h[L],N))}return S}Insert(e){this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=new T.Table(T.labels.SET,T.labels.SET,T.labels.STACKS,T.labels.CONDITION,T.labels.DAMAGE,T.labels.RELATIVE);for(const n of e){let[s,i]=n.sets;s===i?(s+=" (2)",i+=" (4)"):(s+=" (2)",i+=" (2)");const l=n.states.map(({state:_,effect:A})=>{const S=Xt.FindByName(A);return S&&(S.MaxStacks||0)>0?_.stacks+"":""}).filter(_=>!!_).join(", "),E=n.states.map(({state:_})=>[..._.conditions]).reduce((_,A)=>(A.forEach(S=>_.push(S)),_),[]).filter(_=>!!_).join(", ");a.AddRow(s,i,l,E,n.damage,V(n.relative*100,2)+"%")}return a}EquipCmd(e){let a=`artifact add
artifact sets `+e.sets.join(" ")+`
`;const[n,s]=e.sets,i=J.FindByName(n),l=J.FindByName(s),E=new Set;i&&i.Stars===4&&(E.add("flower"),E.add("plume")),l&&l.Stars===4&&(E.add("sands"),E.add("goblet"));for(const _ of E)a+=_+` downgrade
`;for(const{cmd:_}of e.states)a+=_+`

`;return a+="effect unset",a}},zo=class extends mt{constructor(){super(...arguments),this.cases=new Map,this.combinations=[],this.constants={},this.initDamage=0,this.queue=new ct}init(e){this.Combinate(e),this.setTotal(this.combinations.length),this.constants=this.getConstants(),this.initDamage=this.Run()}Combinate(e){var a;e.ConfigCmd&&(this.cases=xt(e.ConfigCmd));const n=(()=>e.All?nt.GetList():nt.GetByType(this.GetTarget().GetCharacter().Options.Weapon||0))();this.combinations=[];for(const s of n){const i=((a=e.Ranks)==null?void 0:a[s.Stars])||[1];if(s.Effects.length===0){for(const E of i)this.combinations.push({weapon:s.Name,cmds:{},cmd:`weapon level 90
weapon rank `+E});continue}const l=jo(s.Effects,this.cases);for(const E of l)for(const _ of i){const A={weapon:s.Name,cmds:E,cmd:`weapon level 90
weapon rank `+_};this.combinations.push(A)}}}*Generate(){for(const e of this.combinations)yield e}Evaluate(e){var a;const n=this.GetRunner(),s=this.GetTarget();n.Scenario.Character=s,(a=s.GetWeapon())==null||a.Unequip();const i=nt.FindByName(e.weapon);if(!i)throw new Error("Cannot find weapon: "+e.weapon);s.SetWeapon(i);const l=s.GetWeapon();if(!l)throw new Error("Cannot equip the weapon: "+e.weapon);const E=n.Program.CompileString(e.cmd,{constants:this.constants});E();const _={weapon:l.Options.Name,states:[],damage:0,relative:0,cmd:E.String(),rank:l.GetRank()};for(const S of l.GetEffects()){const u=S.Options.Name;n.Scenario.Effect=S;const h=e.cmds[u];if(!h)continue;let N="";for(const L of h){const m=n.Program.CompileString(L,{constants:this.constants});m(),N+=m.String()+`
`}_.states.push({state:r.Export(S),cmd:"effect set "+u+`
`+N,effect:u})}const A=this.Run();return _.damage=A,_.relative=A/this.initDamage,_}Insert(e){this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=new k(T.labels.WEAPON,T.labels.STACKS,T.labels.CONDITION,T.labels.DAMAGE,T.labels.RELATIVE);for(const n of e){const s=n.states.map(({state:l,effect:E})=>{const _=Xt.FindByName(E);return _&&(_.MaxStacks||0)>0?l.stacks+"":""}).filter(l=>!!l).join(", "),i=n.states.map(({state:l})=>[...l.conditions]).reduce((l,E)=>(E.forEach(_=>l.push(_)),l),[]).filter(l=>!!l).join(", ");a.AddRow(n.weapon+` (R${n.rank})`,s,i,n.damage,V(n.relative*100,2)+"%")}return a}EquipCmd(e){let a="weapon set "+e.weapon+`
`+e.cmd+`
`;for(const{cmd:n}of e.states)a+=n+`

`;return a+="effect unset",a}};function B1(e,a){if(e.allowSetNumber){const n=e.allowSetNumber;if(a.length===0&&!n.includes(0)||!a.map(([,i])=>i).some(i=>n.includes(i)))return!1}if(e.allowOnly){const n=e.allowOnly.map(i=>i.toLowerCase());if(!a.map(i=>i[0].toLowerCase()).every(i=>n.includes(i)))return!1}return!0}var b1=[...t.Mainstats,...t.Substats],Qo=class extends mt{constructor(){super(...arguments),this.compiled=new Map,this.groups=[],this.mods=new Map,this.initDamage=0,this.initSets=[],this.queue=new ct(5),this.prevSets="",this.equipCmd=""}init(e){var a,n;e.artifacts=[...e.artifacts];const s=this.GetRunner().Program,i=xt(e.ConfigCmd||"");for(const[E,_]of i){const A="effect set "+E+`
`+_.join(`
`)+`
effect unset`,S=s.CompileString(A,{constants:this.getConstants()});this.compiled.set(E,S)}for(const E of t.piece.Values())this.groups[E]=[];if(e.artifacts.forEach((E,_)=>this.groups[E.piece].push([_,E])),this.target){this.initDamage=this.Run();let E=(a=this.target.GetArtifacts())==null?void 0:a.GetArtifacts();E||(this.target.SetArtifacts(new Et.Artbox(this.target)),E=(n=this.target.GetArtifacts())==null?void 0:n.GetArtifacts());const _=[];E&&E.forEach(A=>{this.groups[A.GetPiece()].length>0&&A.Disable(),_[A.GetPiece()]=A.GetSet()}),this.initSets=_;for(const A of b1)this.mods.set(A,this.target.GetCharacter().CreateModifier(A,0))}for(const E of t.piece.Values())this.groups[E].length||this.groups[E].push([-1,void 0]);let l=1;for(const E of Object.values(this.groups))E.sort((_,A)=>{var S,u;return(((S=_[1])==null?void 0:S.set)||"").localeCompare(((u=A[1])==null?void 0:u.set)||"")}),l*=E.length;this.setTotal(l)}*Generate(){for(let e=0;e<this.groups[t.piece.FLOWER].length;e++)for(let a=0;a<this.groups[t.piece.PLUME].length;a++)for(let n=0;n<this.groups[t.piece.SANDS].length;n++)for(let s=0;s<this.groups[t.piece.GOBLET].length;s++)for(let i=0;i<this.groups[t.piece.CIRCLET].length;i++)yield this.Combinate([e,a,n,s,i])}Combinate(e){const a=this.GetConfig(),n=t.piece.Values().map(S=>this.groups[S][e[S]]),s=n.map(([,S])=>S),i=n.map(([S])=>S),l=[...this.initSets];for(const S of s)!S||(l[S.piece]=S.set);const[E,_]=Zs(l);if(!B1(a,E))return;const A=[];for(const S of s){if(!S)continue;const u=S,h=o.GetMainstatValue(u.stars,u.mainstat,u.level),N=A.find(L=>L.stat===u.mainstat);N?N.value+=h:A.push({stat:u.mainstat,value:h});for(const{stat:L,value:m}of u.substats){const C=A.find(G=>G.stat===L);C?C.value+=m:A.push({stat:L,value:m})}}return{indexes:i,sets:_,stats:A}}configSets(e,a){const n=a.join(";");if(n!==this.prevSets){this.equipCmd="",e.Get(0).SetSet(a[0]),e.Get(1).SetSet(a[0]),e.Get(2).SetSet(a[1]),e.Get(3).SetSet(a[1]),e.Get(4).SetSet(void 0);for(const s of e.GetEffects()){const i=this.compiled.get(s.Options.Name.toLowerCase());i&&(i(),this.equipCmd+=i.toString()+`
`)}this.prevSets=n}}Evaluate(e){if(!e)return;const a=this.GetTarget(),n=a.GetArtifacts(),{filter:s}=this.GetConfig();if(!n)throw new Error("Target has no artifacts to be optimized. Try to run `.Init()` first");for(const{stat:E,value:_}of e.stats){const A=this.mods.get(E);if(!A)throw new Error("Modifier not initialized for stat "+E+". Try to run `.Init()` first");A.SetValue(_)}if(this.configSets(n,e.sets),s&&!Qe(a.GetCharacter(),...s))return;const i=this.Run(),l=i/this.initDamage;for(const{stat:E}of e.stats){const _=this.mods.get(E);if(!_)throw new Error("Modifier not initialized for stat "+E+". Try to run `.Init()` first");_.SetValue(0)}return{indexes:e.indexes,sets:e.sets,cmd:this.equipCmd,damage:i,relative:l}}Insert(e){e&&e.damage>0&&this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(){throw new Error("Method not implemented.")}GetArtifacts({indexes:e}){const{artifacts:a}=this.GetConfig();return e.filter(n=>n>=0).map(n=>a[n])}},$o={SubstatsOptimizer:Zt,MainstatOptimizer:ko,NextRollOptimizer:Uo,SetOptimizer:qo,WeaponOptimizer:zo,ArtifactsOptimizer:Qo};function nN(e){return e}var K1=class extends ze{Init(e){return new Promise((a,n)=>{const s=this.worker.Post("backend:optimizer/run/child/init",e),i=this.worker.AddListener("frontend:optimizer/run/child/init",(E,{id:_})=>{_===s&&(a(),this.worker.RemoveListener(i))}),l=this.worker.AddErrorListener(E=>{this.worker.RemoveErrorListener(l),n(E)})})}Send(e){return new Promise((a,n)=>{const s=this.worker.Post("backend:optimizer/run/child/run",e),i=this.worker.AddListener("frontend:optimizer/run/child/run",(E,{id:_,result:A})=>{_===s&&(a(A),this.worker.RemoveListener(i))}),l=this.worker.AddErrorListener(E=>{this.worker.RemoveErrorListener(l),n(E)})})}},w1=class extends qe{constructor(){super({["backend:optimizer/run"]:(e,a)=>this.Run(e,a)})}Run(e,a){return Ct(this,null,function*(){b.Global.SaveLogs=!1,b.Global.Out=()=>{};const n=new $o[a.tool];n.Init(a.config);const s=n.GetTotal();this.Post("frontend:optimizer/run",{id:"progress:"+e,result:[],progress:0,total:s});const i=a.chunk;console.log(`[WORKER] Spawning ${a.children} child workers`);const l=Y1(a.children);yield Promise.all(l.map(S=>S.Init(st(z({},a),{rows:[]}))));const E=v1(i*l.length,n.Generate());let _=0;for(const S of E){const h=(yield Promise.all(l.map((N,L)=>{const m=S.slice(L*i,(L+1)*i);return N.Send(st(z({},a),{rows:m}))}))).reduce((N,L)=>(L.forEach(m=>N.push(m)),N),[]);for(const N of h)n.Insert(N);_+=S.length,this.Post("frontend:optimizer/run",{id:"progress:"+e,result:[],progress:_,total:s})}const A=n.Get();l.forEach(S=>S.Kill()),this.Post("frontend:optimizer/run",{id:e,result:A})})}};function Y1(e){return Array.from(Array(e)).fill(0).map(()=>new K1)}var F1=class extends qe{constructor(){super({["backend:optimizer/run/child/init"]:(e,a)=>this.Init(e,a),["backend:optimizer/run/child/run"]:(e,a)=>this.Run(e,a)})}Init(e,a){b.Global.SaveLogs=!1,b.Global.Out=()=>{},(this.optimizer=new $o[a.tool]).Init(a.config),console.log("[CHILD WORKER] Child worker initialized"),this.Post("frontend:optimizer/run/child/init",{id:e})}Run(e,a){if(!this.optimizer)throw new Error("[CHILD WORKER] Optimizer not set in the child worker");for(const s of a.rows)this.optimizer.Insert(this.optimizer.Evaluate(s));const n=this.optimizer.Get();this.Post("frontend:optimizer/run/child/run",{id:e,result:n})}},V1=class extends qe{constructor(){super({["backend:rotation-damage/run"]:(e,a)=>this.Run(e,a)})}Run(e,a){const n=new We;b.Global.Out=()=>{};const s=It.PartyFrom(a.party);n.Scenario.Party=s;try{n.Program.CompileString(a.command)();const i=n.Scenario.Rotation;n.Program.Compile(["rotation","log","enable"])(),n.Program.Compile(["rotation","run"])();const l=i.GetSummary(),E=i.GetDetails();this.Post("frontend:rotation-damage/run",{result:{summary:l,details:E,log:b.Global.String()},id:e})}catch{this.Post("frontend:rotation-damage/run",{result:{log:b.Global.String()},id:e})}}},x1=[V1,w1,F1];function k1(e){const a=new Ko(e);for(const n of x1)new n().SetWorker(a);return a}var U1=class extends ze{Run(e,a){const n=d.ExportParty(e);return new Promise((s,i)=>{const l=this.worker.Post("backend:rotation-damage/run",{party:n,command:a}),E=this.worker.AddListener("frontend:rotation-damage/run",(A,{result:S,id:u})=>{u===l&&(s(S),this.worker.RemoveListener(E))}),_=this.worker.AddErrorListener(A=>{this.worker.RemoveErrorListener(_),i(A)})})}},W1=class extends ze{constructor(){super(...arguments),this.Children=1,this.Chunk=100,this.OnProgress=()=>{}}Run(e,a){return console.log("[CLIENT] Running optimizer worker for tool: "+e),new Promise((n,s)=>{const i=this.worker.Post("backend:optimizer/run",{tool:e,config:a,children:this.Children,chunk:this.Chunk}),l=this.worker.AddListener("frontend:optimizer/run",(_,{id:A,result:S,progress:u,total:h})=>{if(A!==i){A==="progress:"+i&&Number.isFinite(u)&&Number.isFinite(h)&&this.OnProgress(u||0,h||0);return}n(S),this.worker.RemoveListener(l)}),E=this.worker.AddErrorListener(_=>{this.worker.RemoveErrorListener(E),s(_)})})}},Xo={};O(Xo,{artifacts:()=>ac,filter:()=>Yo,mainstat:()=>Zo,nextroll:()=>Jo,set:()=>tc,substats:()=>Vo,weapon:()=>ec});var Zo={};O(Zo,{MainstatOptimizer:()=>ko,defaultConfig:()=>j1});var j1=()=>({}),Jo={};O(Jo,{NextRollOptimizer:()=>Uo,defaultConfig:()=>q1});var q1=()=>({tier:o.SubstatTier.ROLL_AVG}),tc={};O(tc,{SetOptimizer:()=>qo,defaultConfig:()=>z1});var z1=()=>({ConfigCmd:`
/*
IMPORTANT: Remember to mark the "Shielded" checkbox in the character attributes
if you want to optimize Retracing Bolide with its 4-piece set effect enabled.

Note that the effect configurations in this section will override the configurations you do
in the application, but will be overrided by configurations done in the rotation code.
*/

case 
NoblesseOblige4
TenacityOfTheMillelith4
DeepwoodMemories4
ArchaicPetra4
ViridescentVenerer4
Instructor4:
  // by default, these party effects will be applied to the entire party.
  effect apply all
  /* 
  you can apply the effect to the member you want, for example:

  effect apply Xiangling

  If you don't want the effect to be applied to the target, then unapply
  from it:

  effect unapply $target_name
  */
  
case 
ArchaicPetra4 
ViridescentVenerer4:
  // by default, Petra and VV effects will have applied the aura corresponding to the target's element,
  // you can change it to the aura (s) you want, or all.
  effect aura $target_element_aura
  // the constant $target_element_aura is predefined by the optimizer, 
  // you can read more about it in the documentation.
  
case OceanHuedClam4:
  // stacks refer to accumulated healing so by default will be 0.
  // set this to the corresponding value if you're optimizing a character
  // with healing capabilities.
  effect stacks 0  
  
/* 
you can add more custom configurations here. Something like, for example:

case CrimsonWitchOfFlames4:
  effect stacks 1

to optimize Crimson with 1 stacks.
*/  
`.trim()}),ec={};O(ec,{WeaponOptimizer:()=>zo,defaultConfig:()=>Q1});var Q1=()=>({Ranks:{3:[5],4:[1,5],5:[1]},ConfigCmd:`
/*
IMPORTANT: Remember to mark the "Shielded" checkbox in the 
character attributes if you want to optimize weapons from
Golden Majesty series (Memory of Dust, Summit Shaper, etc.).
*/
case
WolfsGravestone2
ElegyForTheEnd2
FreedomSworn2
SongOfBrokenPines2
ThousandFloatingDreams2
KeyOfKhajNisut2
HakushinRing1
MakhairaAquamarine1
WanderingEvenstar1
XiphosMoonlight1:
  /*
  These weapon effects will be applied to the entire party
  by default. You can write your own configurations to apply
  to specific characters.
  */
  effect apply all

case KeyOfKhajNisut2:
  effect stacks 3

case
ThrillingTalesOfDragonSlayers1
ForestRegalia1
SapwoodBlade1:
  /*
  By default, these weapon effects will be applied ONLY to the
  first character in the party.
  */
  effect unapply all
  effect apply $member_0_name
`.trim()}),ac={};O(ac,{ArtifactsOptimizer:()=>Qo,defaultConfig:()=>$1});var $1=()=>({artifacts:[],allowSetNumber:[2,4],ConfigCmd:`
/*
You will have to configure all set effects here. This optimizer won't 
automatically set any stacks or conditions to the effects.

Also remember to mark the "Shielded" checkbox in the character attributes
if you want to optimize Retracing Bolide with its 4-piece set effect enabled.

Note that the effect configurations in this section will override the configurations 
you do in the application, but will be overrided by configurations done in the 
rotation code.
*/

case 
NoblesseOblige4
TenacityOfTheMillelith4
DeepwoodMemories4
ArchaicPetra4
ViridescentVenerer4
Instructor4:
  // by default, these party effects will be applied to the entire party.
  effect apply all
  /* 
  you can apply the effect to the member you want, for example:

  effect apply Xiangling

  If you don't want the effect to be applied to the target, then unapply
  from it:

  effect unapply $target_name
  */
  
case 
ArchaicPetra4 
ViridescentVenerer4:
  // by default, Petra and VV effects will have applied the aura corresponding to 
  // the target's element, you can change it to the aura (s) you want, or all.
  effect aura $target_element_aura
  // the constant $target_element_aura is predefined by the optimizer, 
  // you can read more about it in the documentation.
  
case OceanHuedClam4:
  // stacks refer to accumulated healing so by default will be 0.
  // set this to the corresponding value if you're optimizing a character
  // with healing capabilities.
  effect stacks 0

case CrimsonWitchOfFlames4:
  effect stacks 1 // optimize CW4 with 1 stacks

case PaleFlame4:
  effect stacks 2

case
HuskOfOpulentDreams4
FlowerOfParadiseLost4
VermillionHereafter4:
  effect stacks 4
    `.trim()}),nc={};O(nc,{enka:()=>sc,good:()=>ic});var sc={};O(sc,{FetchEnka:()=>vo,GetEnka:()=>Po,ParseEnka:()=>Ho});var ic={};O(ic,{Parse:()=>Z1,ParseArtifact:()=>lc});var X1={flower:t.piece.FLOWER,plume:t.piece.PLUME,sands:t.piece.SANDS,goblet:t.piece.GOBLET,circlet:t.piece.CIRCLET},rc={hp:t.stat.HP_FLAT,hp_:t.stat.HP_PERCENT,atk:t.stat.ATK_FLAT,atk_:t.stat.ATK_PERCENT,def:t.stat.DEF_FLAT,def_:t.stat.DEF_PERCENT,eleMas:t.stat.ELEMENTAL_MASTERY,enerRech_:t.stat.ENERGY_RECHARGE,heal_:t.stat.HEALING_BONUS,critRate_:t.stat.CRIT_RATE,critDMG_:t.stat.CRIT_DMG,physical_dmg_:t.stat.PHYSICAL_DMG,anemo_dmg_:t.stat.ANEMO_DMG,geo_dmg_:t.stat.GEO_DMG,electro_dmg_:t.stat.ELECTRO_DMG,hydro_dmg_:t.stat.HYDRO_DMG,pyro_dmg_:t.stat.PYRO_DMG,cryo_dmg_:t.stat.CRYO_DMG,dendro_dmg_:t.stat.DENDRO_DMG};function lc(e){const a=X1[e.slotKey];t.piece.Name(a);const n=new I.Artifact(a),s=J.FindByName(e.setKey);s?n.SetSet(s.Name):(console.warn(`Could not find artifacts set "${e.setKey}"`),n.SetSet(e.setKey)),n.SetStars(e.rarity),n.SetLevel(e.level);const i=rc[e.mainStatKey];t.stat.Name(i),n.SetMainstat(i);for(const{key:l,value:E}of e.substats){const _=rc[l];t.stat.Name(_);let A=E;if(t.FlatStats.includes(_)||(A/=100),!Number.isFinite(A)||A<0)throw new Error(`Invalid substat value: ${A}`);n.AddSubstat(_,A)}return n}function Z1(e){return(e.artifacts||[]).map(n=>lc(n))}var oc={};O(oc,{ReadOnly:()=>nE});const te=self,Xe=ma.worker.BackendWorker((e,a,n)=>te.postMessage({path:e,id:a,data:n}));Xe.SetKiller(()=>te.terminate()),te.addEventListener("message",async({data:e})=>{try{await Xe.Recieve(e.path,e.id,e.data)}catch(a){console.error("[CHILD WORKER ERROR]",a),Xe.Error(a),te.postMessage({error:a})}})})();
