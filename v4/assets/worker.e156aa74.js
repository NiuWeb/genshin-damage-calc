(function(){"use strict";var Ut={};(function(e){(function(){var a={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function s(_){return r(c(_),arguments)}function n(_,u){return s.apply(null,[_].concat(u||[]))}function r(_,u){var A=1,S=_.length,h,m="",f,N,L,C,d,M,R,O;for(f=0;f<S;f++)if(typeof _[f]=="string")m+=_[f];else if(typeof _[f]=="object"){if(L=_[f],L.keys)for(h=u[A],N=0;N<L.keys.length;N++){if(h==null)throw new Error(s('[sprintf] Cannot access property "%s" of undefined value "%s"',L.keys[N],L.keys[N-1]));h=h[L.keys[N]]}else L.param_no?h=u[L.param_no]:h=u[A++];if(a.not_type.test(L.type)&&a.not_primitive.test(L.type)&&h instanceof Function&&(h=h()),a.numeric_arg.test(L.type)&&typeof h!="number"&&isNaN(h))throw new TypeError(s("[sprintf] expecting number but found %T",h));switch(a.number.test(L.type)&&(R=h>=0),L.type){case"b":h=parseInt(h,10).toString(2);break;case"c":h=String.fromCharCode(parseInt(h,10));break;case"d":case"i":h=parseInt(h,10);break;case"j":h=JSON.stringify(h,null,L.width?parseInt(L.width):0);break;case"e":h=L.precision?parseFloat(h).toExponential(L.precision):parseFloat(h).toExponential();break;case"f":h=L.precision?parseFloat(h).toFixed(L.precision):parseFloat(h);break;case"g":h=L.precision?String(Number(h.toPrecision(L.precision))):parseFloat(h);break;case"o":h=(parseInt(h,10)>>>0).toString(8);break;case"s":h=String(h),h=L.precision?h.substring(0,L.precision):h;break;case"t":h=String(!!h),h=L.precision?h.substring(0,L.precision):h;break;case"T":h=Object.prototype.toString.call(h).slice(8,-1).toLowerCase(),h=L.precision?h.substring(0,L.precision):h;break;case"u":h=parseInt(h,10)>>>0;break;case"v":h=h.valueOf(),h=L.precision?h.substring(0,L.precision):h;break;case"x":h=(parseInt(h,10)>>>0).toString(16);break;case"X":h=(parseInt(h,10)>>>0).toString(16).toUpperCase();break}a.json.test(L.type)?m+=h:(a.number.test(L.type)&&(!R||L.sign)?(O=R?"+":"-",h=h.toString().replace(a.sign,"")):O="",d=L.pad_char?L.pad_char==="0"?"0":L.pad_char.charAt(1):" ",M=L.width-(O+h).length,C=L.width&&M>0?d.repeat(M):"",m+=L.align?O+h+C:d==="0"?O+C+h:C+O+h)}return m}var i=Object.create(null);function c(_){if(i[_])return i[_];for(var u=_,A,S=[],h=0;u;){if((A=a.text.exec(u))!==null)S.push(A[0]);else if((A=a.modulo.exec(u))!==null)S.push("%");else if((A=a.placeholder.exec(u))!==null){if(A[2]){h|=1;var m=[],f=A[2],N=[];if((N=a.key.exec(f))!==null)for(m.push(N[1]);(f=f.substring(N[0].length))!=="";)if((N=a.key_access.exec(f))!==null)m.push(N[1]);else if((N=a.index_access.exec(f))!==null)m.push(N[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");A[2]=m}else h|=2;if(h===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");S.push({placeholder:A[0],param_no:A[1],keys:A[2],sign:A[3],pad_char:A[4],align:A[5],width:A[6],precision:A[7],type:A[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");u=u.substring(A[0].length)}return i[_]=S}e.sprintf=s,e.vsprintf=n,typeof window<"u"&&(window.sprintf=s,window.vsprintf=n)})()})(Ut);var ga=Object.defineProperty,Ga=Object.getOwnPropertySymbols,wE=Object.prototype.hasOwnProperty,BE=Object.prototype.propertyIsEnumerable,Ra=(e,a,s)=>a in e?ga(e,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[a]=s,Wt=(e,a)=>{for(var s in a||(a={}))wE.call(a,s)&&Ra(e,s,a[s]);if(Ga)for(var s of Ga(a))BE.call(a,s)&&Ra(e,s,a[s]);return e},bE=(e,a)=>{for(var s in a)ga(e,s,{get:a[s],enumerable:!0})},H={};bE(H,{ERR_DIVISION_BY_ZERO:()=>ZE,ERR_EXPR_NODE_NOT_FOUND:()=>XE,ERR_EXPR_NODE_NO_VALUE:()=>JE,ERR_FUNCTION_ARGUMENT:()=>qE,ERR_FUNCTION_ARGUMENT_COUNT:()=>Ia,ERR_FUNCTION_CONTEXT:()=>UE,ERR_FUNCTION_INVALID_OPTIONAL:()=>Oa,ERR_FUNCTION_UNKNOWN:()=>VE,ERR_LIST_EXPECTED_COMMA:()=>zE,ERR_LIST_UNEXPECTED_COMMA:()=>jE,ERR_MATH:()=>tT,ERR_OPERATOR_UNEXPECTED_LEFT:()=>FE,ERR_OPERATOR_UNEXPECTED_RIGHT:()=>kE,ERR_PARENTHESES_CLOSE:()=>$E,ERR_PARENTHESES_OPEN:()=>QE,ERR_TOKEN_NUMBER_PARSE:()=>YE,ERR_VARIABLE_CONTEXT:()=>WE,ERR_VARIABLE_UNKNOWN:()=>xE,LocationError:()=>KE});function KE(e,a){return new Error(`${e} at position ${a[0]}:${a[1]}`)}var YE=e=>"invalid number: "+e,FE=e=>"unexpected value at the left of operator: "+e,kE=e=>"unexpected value at the right of operator: "+e,VE=e=>"unknown function: "+e,Ia=(e,a,s)=>`function ${e} expected ${a} arguments, got ${s}`,xE=e=>"unknown variable: "+e,Oa=e=>"invalid optional argument definition for function "+e,UE="cannot parse a function without context",WE="cannot parse a variable without context",jE="unexpected comma",zE="expected comma",qE="invalid function argument",$E="unexpected closing parenthesis",QE="unclosed opening parenthesis",XE="expression node not found",JE="expression node did not return a value",ZE="division by zero",tT="math error",me=[[{name:"!",left:!1,right:!0,evaluate:({values:[e]})=>e?0:1}],[{name:"^",left:!0,right:!0,evaluate:({values:[e,a],location:s})=>{const n=Math.pow(e,a);if(!Number.isFinite(n))throw H.LocationError(H.ERR_MATH,s);return n}}],[{name:"*",left:!0,right:!0,evaluate:({values:[e,a]})=>e*a},{name:"/",left:!0,right:!0,evaluate:({values:[e,a],location:s})=>{if(a===0)throw H.LocationError(H.ERR_DIVISION_BY_ZERO,s);return e/a}},{name:"%",left:!0,right:!0,evaluate:({values:[e,a],location:s})=>{if(a===0)throw H.LocationError(H.ERR_DIVISION_BY_ZERO,s);return e%a}}],[{name:"+",left:!0,addLeft:!0,right:!0,addRight:!0,evaluate:({values:[e,a]})=>e+a},{name:"-",left:!0,addLeft:!0,right:!0,addRight:!0,evaluate:({values:[e,a]})=>e-a}],[{name:"<",left:!0,right:!0,evaluate:({values:[e,a]})=>e<a?1:0},{name:">",left:!0,right:!0,evaluate:({values:[e,a]})=>e>a?1:0},{name:"<=",left:!0,right:!0,evaluate:({values:[e,a]})=>e<=a?1:0},{name:">=",left:!0,right:!0,evaluate:({values:[e,a]})=>e>=a?1:0},{name:"=",left:!0,right:!0,evaluate:({values:[e,a]})=>e===a?1:0}],[{name:"&&",left:!0,right:!0,evaluate:({values:[e,a]})=>e&&a?1:0},{name:"||",left:!0,right:!0,evaluate:({values:[e,a]})=>e||a?1:0}]],eT=(()=>{const e=new Map;for(const a of me)for(const s of a)e.set(s.name,s);return e})();function aT(e){const a=e.map(s=>s.name.replace(/(.)/g,"\\$1")).join("|");return new RegExp(`(?:${a})`,"ig")}var sT=aT(me.flat()),nT=[[2,/[0-9]+(?:\.[0-9]+)?e(?:\+|-)?[0-9]+(?:\.[0-9]+)?/ig],[0,/[a-z$_](?:[a-z0-9$_]*(?:\.[a-z0-9$_]+)?)*/ig],[1,/[0-9]+(?:\.[0-9]+)?/ig],[5,/\(/ig],[6,/\)/ig],[4,/,/ig],[3,sT]],St=class{constructor(e){this.ranges=[],this.input=e,this.parse()}getLocation(e){let a=1;for(;a<this.ranges.length&&e>this.ranges[a-1][1];)a++;const s=e-this.ranges[a-1][0]+1;return[a,s]}getIndex([e,a]){if(e<1)throw new RangeError(`Line number must be greater than 0, got ${e}`);if(a<1)throw new RangeError(`Column number must be greater than 0, got ${a}`);if(e>this.ranges.length)throw new RangeError(`Line number must be equal or less than ${this.ranges.length}, got ${e}`);e--,a--;const s=this.ranges[e][0]+a;if(s>this.ranges[e][1])throw new RangeError(`Column number must be less than ${this.ranges[e][1]}, got ${a}`);return s}getLineRange(e){if(e<1)throw new RangeError(`Line number must be greater than 0, got ${e}`);if(e>this.ranges.length)throw new RangeError(`Line number must be less than ${this.ranges.length}, got ${e}`);return this.ranges[e-1]}getLineLength(e){const a=this.getLineRange(e);return a[1]-a[0]}get lines(){return this.ranges.length}update(e){this.input=e,this.parse()}parse(){this.ranges=[];const e=this.input.split(/(\r?\n)/);let a=0;for(let s=0;s<e.length;s++){if(s%2===1||a>=this.input.length)continue;let n=a+e[s].length-1;s<e.length-1&&(n+=e[s+1].length),this.ranges.push([a,n]),a=n+1}}static matchAll(e,a){const s=[],n=new St(e);for(const r of e.matchAll(a)){const i=r.index;if(typeof i!="number")continue;const c=i+r[0].length-1,_=n.getLocation(i),u=n.getLocation(c);s.push({match:r,location:{start:_,end:u}})}return s}static sortByLocation(e,a){return e.sort((s,n)=>{const r=a(s),i=a(n);return r[0]<i[0]?-1:r[0]>i[0]?1:r[1]<i[1]?-1:r[1]>i[1]?1:0})}};function rT([e,a],s){return[St.matchAll(s,a).map(({match:i,location:c})=>{const _={type:e,location:c,value:i[0]};return typeof i.index=="number"&&(s=s.slice(0,i.index)+" ".repeat(i[0].length)+s.slice(i.index+i[0].length)),_}),s]}function iT(e){const a=[];for(const s of nT){const[n,r]=rT(s,e);e=r;for(const i of n)a.push(i)}return St.sortByLocation(a,s=>s.location.start),a}var lT=class{constructor(e){if(this._functions=e.functions||{},this._variables=e.variables||{},this.ignoreCase=e.ignoreCase||!1,this.ignoreCase){const a={};for(const n in this._functions)a[n.toLowerCase()]=this._functions[n];this._functions=a;const s={};for(const n in this._variables)s[n.toLowerCase()]=this._variables[n];this._variables=s}}get functions(){return this._functions}get variables(){return this._variables}getFn(e){return this.ignoreCase&&(e=e.toLowerCase()),this._functions[e]}getVar(e){return this.ignoreCase&&(e=e.toLowerCase()),this._variables[e]}setVar(e,a){this.ignoreCase&&(e=e.toLowerCase()),this._variables[e]=a}},Da=(e=>(e[e.SINGLE=0]="SINGLE",e[e.NUMBER=1]="NUMBER",e[e.FUNCTION=2]="FUNCTION",e[e.GROUP=3]="GROUP",e))(Da||{});function oT(e){va(e.children),Ha(e.children),ya(e.children)}function va(e){for(const a of e)if(a.type===3&&a.children.length===1){const s=a.children[0];a.type=s.type,a.token=s.token,a.children=s.children}}function ya(e){if(e.length===0)return;if(fe(e[0]))throw H.LocationError(H.ERR_LIST_UNEXPECTED_COMMA,e[0].token.location.start);let a=!1;for(let s=1;s<e.length;s++){const n=fe(e[s]);if(a===n)throw H.LocationError(H.ERR_LIST_EXPECTED_COMMA,e[s].token.location.start);a=n}for(let s=0;s<e.length;s++)fe(e[s])&&(e.splice(s,1),s--)}function fe(e){return e.type===0&&e.token.type===4}function Ha(e){for(const a of me)cT(a,e)}function cT(e,a){for(let s=0;s<a.length;s++){const n=a[s];if(n.type===0&&n.token.type===3)for(const r of e){if(r.name!==n.token.value)continue;let i=s-1,c=s+1,_=a[i],u=a[c];if(r.left&&!Pa(_))if(r.addLeft)_=wa(n.token.location),i=s;else throw H.LocationError(H.ERR_OPERATOR_UNEXPECTED_LEFT(r.name),n.token.location.start);if(r.right&&!Pa(u))if(r.addRight)u=wa(n.token.location),c=s;else throw H.LocationError(H.ERR_OPERATOR_UNEXPECTED_RIGHT(r.name),n.token.location.start);const A={type:2,token:n.token,children:[_,u].filter(S=>!!S)};a.splice(i,c-i+1,A),s=i}}}function Pa(e){return!!e&&(e.type===2||e.type===1||e.type===0&&e.token.type===0)}function wa(e){return{type:1,children:[],evaluate(){return 0},token:{type:1,value:"0",location:e}}}function ET(e){const a=[];for(let s=0;s<e.length;s++){const n=e[s];if(n.token.value==="(")a.push(s);else if(n.token.value===")"){if(a.length===0)throw H.LocationError(H.ERR_PARENTHESES_CLOSE,n.token.location.start);const r=a.pop();let i=r;const c=e[r],_=e.slice(r+1,s),u={type:3,token:c.token,children:_};r>0&&e[r-1].type===0&&e[r-1].token.type===0&&(u.type=2,u.token=e[r-1].token,i=r-1),oT(u),e.splice(i,s-i+1,u),s=i}}if(a.length>0)throw H.LocationError(H.ERR_PARENTHESES_OPEN,e[a[0]].token.location.start);return e}function TT(e){const a=[];for(const s of e){const n=s.type===1||s.type===2,r={type:n?1:0,token:s,children:[]};if(n){const i=parseFloat(s.value);if(!Number.isFinite(i))throw H.LocationError(H.ERR_TOKEN_NUMBER_PARSE(s.value),s.location.start);r.evaluate=()=>i}a.push(r)}return a}function _T(e,a){if(!e.arguments)return;let s=0,n=0;for(let r=0;r<e.arguments.length;r++)if(e.arguments[r]==="..."){if(r!==e.arguments.length-1)throw new Error(Oa(e.name));n=1/0}else s++,n++;if(a<s||a>n)throw new Error(Ia(e.name,`${s}:${n}`,a))}function Ba(e,a){for(const s of e.children)Ba(s,a);if(e.type===2){if(e.evaluate)return;let s;if(e.token.type===3)s=eT.get(e.token.value);else{if(!a)throw H.LocationError(H.ERR_FUNCTION_CONTEXT,e.token.location.start);s=a.getFn(e.token.value)}if(!s)throw H.LocationError(H.ERR_FUNCTION_UNKNOWN(e.token.value),e.token.location.start);const n=e.children.map(_=>_.evaluate),r=s.arguments;if(typeof r=="number"&&n.length!==r)throw H.LocationError(H.ERR_FUNCTION_ARGUMENT_COUNT(e.token.value,r,n.length),e.token.location.start);try{_T(s,n.length)}catch(_){throw _ instanceof Error?H.LocationError(_.message,e.token.location.start):_}const i=e.token.location.start,c=e.children;e.evaluate=()=>{const _=e.children.map((u,A)=>{var S;const h=(S=s.arguments)==null?void 0:S[A];if(h&&typeof h!="string"&&h.expression)return 0;if(!u.evaluate)throw H.LocationError(H.ERR_FUNCTION_ARGUMENT,u.token.location.start);return u.evaluate()});return s.evaluate({values:_,expressions:c,location:i})}}else e.type===0&&e.token.type===0&&(e.evaluate=()=>{if(!a)throw H.LocationError(H.ERR_VARIABLE_CONTEXT,e.token.location.start);const s=a.getVar(e.token.value);if(s===void 0)throw H.LocationError(H.ERR_VARIABLE_UNKNOWN(e.token.value),e.token.location.start);return s})}function ba(e){let a="";return e.forEach((s,n)=>a+=Ka(s,0,n)+`
`),a}function Ka(e,a,s){const n=e.token.location,r=`[${s}]`,i=" ".repeat(r.length);let c=`${r} Node ${Da[e.type]} `;c+=`(${Ya(n.start)} - ${Ya(n.end)}):
`,c+=`${i} Token: ${e.token.value}
`,e.evaluate?c+=`${i} Evaluated value: ${e.evaluate()}
`:c+=`${i} No evaluated value
`,c+=`${i} Children: ${e.children.length}
`,e.children.forEach((u,A)=>c+=Ka(u,a+1,A)+`
`);let _=c.split(`
`);return _=_.map(u=>"  ".repeat(a)+u),c=_.join(`
`),c}function Ya(e){return`${e[0]}:${e[1]}`}var uT=class{constructor(e,a){this.nodes=e,this.context=a}get length(){return this.nodes.length}node(e){return this.nodes[e]}location(e){return this.nodes[e].token.location.start}evaluateAll(){const e=[];for(let a=0;a<this.length;a++)e.push(this.evaluate(a));return e}evaluate(e){var a;const s=this.nodes[e];if(!s)throw new Error(H.ERR_EXPR_NODE_NOT_FOUND);const n=(a=s.evaluate)==null?void 0:a.call(s);if(n===void 0)throw new Error(H.ERR_EXPR_NODE_NO_VALUE);return n}toString(e){if(typeof e=="number"){const a=this.nodes[e];if(a===void 0)throw new Error(H.ERR_EXPR_NODE_NOT_FOUND);return ba([a])}return ba(this.nodes)}},AT={variables:{PI:Math.PI,E:Math.E},functions:{abs:{name:"abs",description:"Calculate the absolute value of a number.",arguments:[{name:"value",description:"The value to get the absolute value of"}],evaluate({values:[e]}){return Math.abs(e)}},sqrt:{name:"sqrt",description:"Calculate the square root of a number.",arguments:[{name:"value",description:"The value to calculate the square root of"}],evaluate({values:[e]}){return Math.sqrt(e)}},pow:{name:"pow",description:"Calculate the power of a number raised to an exponent.",arguments:[{name:"base",description:"The base value"},{name:"exponent",description:"The exponent value"}],evaluate({values:[e,a]}){return Math.pow(e,a)}},floor:{name:"floor",description:"Round a number down to the nearest integer.",arguments:[{name:"value",description:"The value to round down"}],evaluate({values:[e]}){return Math.floor(e)}},ceil:{name:"ceil",description:"Round a number up to the nearest integer.",arguments:[{name:"value",description:"The value to round up"}],evaluate({values:[e]}){return Math.ceil(e)}},sin:{name:"sin",description:"Calculate the sine of an angle in radians.",arguments:[{name:"angle",description:"The angle in radians"}],evaluate({values:[e]}){return Math.sin(e)}},cos:{name:"cos",description:"Calculate the cosine of an angle in radians.",arguments:[{name:"angle",description:"The angle in radians"}],evaluate({values:[e]}){return Math.cos(e)}},tan:{name:"tan",description:"Calculate the tangent of an angle in radians.",arguments:[{name:"angle",description:"The angle in radians"}],evaluate({values:[e]}){return Math.tan(e)}},log:{name:"log",description:"Calculate the logarithm of a number with a specified base.",arguments:[{name:"value",description:"The value to take the logarithm of"},{name:"base",description:"The base of the logarithm (optional, default: e)"}],evaluate({values:[e,a=Math.E]}){return Math.log(e)/Math.log(a)}},min:{name:"min",description:"Find the minimum value from a list of numbers.",arguments:[{name:"values",description:"An array of values to find the minimum of"}],evaluate({values:e}){return Math.min(...e)}},max:{name:"max",description:"Find the maximum value from a list of numbers.",arguments:[{name:"values",description:"An array of values to find the maximum of"}],evaluate({values:e}){return Math.max(...e)}},clamp:{name:"clamp",description:"Clamp a number within a specified range.",arguments:[{name:"value",description:"The value to clamp"},{name:"minValue",description:"The minimum value"},{name:"maxValue",description:"The maximum value"}],evaluate({values:[e,a,s]}){return Math.min(Math.max(e,a),s)}},exp:{name:"exp",description:"Calculate the exponential value of a number.",arguments:[{name:"value",description:"The exponent value"}],evaluate({values:[e]}){return Math.exp(e)}}}},ST={functions:{now:{name:"now",description:"Get the current timestamp.",arguments:[],evaluate(){return Date.now()}},year:{name:"year",description:"Get the year from a given timestamp.",arguments:[{name:"timestamp",description:"The timestamp"}],evaluate({values:[e]}){return new Date(e).getFullYear()}},month:{name:"month",description:"Get the month (0-11) from a given timestamp.",arguments:[{name:"timestamp",description:"The timestamp"}],evaluate({values:[e]}){return new Date(e).getMonth()}},day:{name:"day",description:"Get the day of the week (0-6) from a given timestamp.",arguments:[{name:"timestamp",description:"The timestamp"}],evaluate({values:[e]}){return new Date(e).getDay()}},years:{name:"years",description:"Add a specified number of years to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numYears",description:"The number of years to add"}],evaluate({values:[e,a]}){const s=new Date(e);return s.setFullYear(s.getFullYear()+a),s.getTime()}},months:{name:"months",description:"Add a specified number of months to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numMonths",description:"The number of months to add"}],evaluate({values:[e,a]}){const s=new Date(e);return s.setMonth(s.getMonth()+a),s.getTime()}},days:{name:"days",description:"Add a specified number of days to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numDays",description:"The number of days to add"}],evaluate({values:[e,a]}){const s=new Date(e);return s.setDate(s.getDate()+a),s.getTime()}},hours:{name:"hours",description:"Add hours to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numHours",description:"The number of hours to add"}],evaluate({values:[e,a]}){const s=new Date(e);return s.setTime(s.getTime()+a*60*60*1e3),s.getTime()}},minutes:{name:"minutes",description:"Add minutes to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numMinutes",description:"The number of minutes to add"}],evaluate({values:[e,a]}){const s=new Date(e);return s.setTime(s.getTime()+a*60*1e3),s.getTime()}},seconds:{name:"seconds",description:"Add seconds to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numSeconds",description:"The number of seconds to add"}],evaluate({values:[e,a]}){const s=new Date(e);return s.setTime(s.getTime()+a*1e3),s.getTime()}},milliseconds:{name:"milliseconds",description:"Add milliseconds to a timestamp.",arguments:[{name:"timestamp",description:"The timestamp"},{name:"numMilliseconds",description:"The number of milliseconds to add"}],evaluate({values:[e,a]}){const s=new Date(e);return s.setTime(s.getTime()+a),s.getTime()}},date:{name:"date",description:"Create a timestamp from date values",arguments:[{name:"year",description:"The year"},{name:"month",description:"The month (0-11)"},{name:"day",description:"The day of the month"}],evaluate({values:[e,a,s]}){return new Date(e,a,s).getTime()}},datetime:{name:"datetime",description:"Create a timestamp from date and time values",arguments:[{name:"year",description:"The year"},{name:"month",description:"The month (0-11)"},{name:"day",description:"The day of the month"},{name:"hour",description:"The hour"},{name:"minute",description:"The minute"},{name:"second",description:"The second"}],evaluate({values:[e,a,s,n,r,i]}){return new Date(e,a,s,n,r,i).getTime()}}}},hT={variables:{true:1,false:0},functions:{if:{name:"if",description:"Conditional statement. Returns 'valueIfTrue' if 'condition' is true, otherwise returns 'valueIfFalse'.",arguments:[{name:"condition",description:"The condition to evaluate"},{name:"valueIfTrue",description:"The value to return if 'condition' is true"},{name:"valueIfFalse",description:"The value to return if 'condition' is false"}],evaluate({values:[e,a,s]}){return e>0?a:s}},and:{name:"and",description:"Logical AND operation between multiple values",arguments:["..."],evaluate({values:e}){return e.every(a=>a>0)?1:0}},or:{name:"or",description:"Logical OR operation between multiple values",arguments:["..."],evaluate({values:e}){return e.some(a=>a>0)?1:0}},xor:{name:"xor",description:"Logical XOR operation between multiple values",arguments:["..."],evaluate({values:e}){return e.filter(a=>a>0).length%2?1:0}},not:{name:"not",description:"Logical NOT operation. Returns 1 if 'value' is false, otherwise returns 0.",arguments:[{name:"value",description:"The value to negate"}],evaluate({values:[e]}){return e>0?0:1}},switch:{name:"switch",description:"Switch statement. Returns the value of the first 'case' whose 'condition' is true, otherwise returns 'default'. The syntax is `switch(value, case1, result1, case2, result2, ..., [default])`. Note that if there are an even number of arguments, the last argument is used as the default value. If no default provided, defaults to 0.",arguments:[{name:"value",description:"The value to compare against the 'case' values"},"..."],evaluate({values:[e,...a]}){const s=a.length%2===1?a.pop():0;for(let n=0;n<a.length;n+=2)if(e===a[n])return a[n+1];return s}}}},mT={math:AT,date:ST,logic:hT};function fT(...e){return LT(e.map(a=>typeof a=="string"?mT[a]:a))}function wN(e){return e}function LT(e){const a={functions:{},variables:{}};return e.reduce((s,n)=>({functions:Wt(Wt({},s.functions),n.functions),variables:Wt(Wt({},s.variables),n.variables)}),a)}var Mt=class{constructor(e){this.context=new lT(e||{})}setVar(e,a){this.context.setVar(e,a)}getVar(e){return this.context.getVar(e)}parse(e){const a=iT(e),s=ET(TT(a));va(s),Ha(s),ya(s);for(const n of s)Ba(n,this.context);return new uT(s,this.context)}};Mt.Contexts=fT;function jt(e){const a=/"[^"]+"|[^\s]+/g,s=e.matchAll(a);return Array.from(s).map(n=>{const r=n[0];return r.startsWith('"')&&r.endsWith('"')?r.slice(1,-1):r})}var pT=class{constructor(e,a){this.template=e,this.docs=a,this.positional=[],this.named=[],this.anyNamed=!1,this.min=0,this.max=0,this.parseTemplate()}reset(){this.positional=[],this.named=[],this.min=0,this.max=0}parseTemplate(){var e;const a=jt(this.template.trim()),s=/^\[([^\]]*)\]$/;let n;for(let r of a){const i=r.match(s),c=!!i;c&&(r=i[1]);const _=r.split("="),u=_.length===1,A=_.shift(),S=_.join("=");if(!A)throw new Error(`Invalid argument name: ${r}`);if(A.endsWith("...")){if(!u)throw new Error(`Named arguments cannot have suffix '...': ${A}`);this.max=1/0}!u&&c&&A.endsWith("*")&&(this.anyNamed=!0);let h=A;u||(h+="="+S),c&&(h="["+h+"]");const m={label:h,name:A,positional:u,optional:c,description:(e=this.docs)==null?void 0:e[A]};if(m.positional){if(n){if(n.optional&&!m.optional)throw new Error(`Optional arguments must be at the end of the positional list: ${n.name}`);if(n.name.endsWith("..."))throw new Error(`'...' argument must be at the end of the list: ${n.name}`)}n=m,this.positional.push(m),!m.optional&&!m.name.endsWith("...")&&this.min++,this.max++}else this.named.push(m)}}toString(){let e="";for(const a of this.positional)e+=a.label+" ";for(const a of this.named)e+=a.label+" ";return e.trim()}setTemplate(e){this.reset(),this.template=e,this.parseTemplate()}setDocs(e){this.docs=e;for(const a of this.positional)a.description=e[a.name];for(const a of this.named)a.description=e[a.name]}parse(e){const a=this._parse(jt(e.trim()));return this._validate(a),a}parseList(e){const a=this._parse(e);return this._validate(a),a}_parse(e){const a=[],s={};for(const n of e)if(n.includes("=")){const[r,i]=n.split("=");s[r]=i}else a.push(n);return{values:a,named:s,parts:e}}_validate(e){if(e.values.length<this.min)throw new Error(`Expected at least ${this.min} positional arguments, got ${e.values.length}`);if(e.values.length>this.max)throw new Error(`Expected at most ${this.max} positional arguments, got ${e.values.length}`);if(this.anyNamed)return;const a=this.named.map(n=>n.name),s=Object.keys(e.named);for(const n of s)if(!a.includes(n))throw new Error(`Unexpected named argument: ${n}`);for(const n of a)if(!this.named.find(i=>i.name===n).optional&&!s.includes(n))throw new Error(`Expected named argument: ${n}`)}get argMin(){return this.min}get argMax(){return this.max}get namedArgs(){return this.named}},Fa=class{constructor(){this._log=[],this._line=1,this.save=!0,this.out=console.log}addLog(e){this.save&&this._log.push(e),this.out(`[${e.type} at line ${e.line}] ${e.message}`)}setLine(e){typeof e=="number"?this._line=e:this._line=e[0]}get line(){return this._line}log(e){this.addLog({type:"log",message:e,line:this._line})}logf(e,...a){this.log(Ut.sprintf(e,...a))}warn(e){this.addLog({type:"warn",message:e,line:this._line})}warnf(e,...a){this.warn(Ut.sprintf(e,...a))}error(e){this.addLog({type:"error",message:e,line:this._line})}errorf(e,...a){this.error(Ut.sprintf(e,...a))}clear(){this._log=[]}toString(){return this._log.map(e=>`[${e.type} at line ${e.line}] ${e.message}`).join(`
`)}},V=Fa;V.Global=new Fa;var zt=class{constructor(e,a){this.context=e,this.commands=a,this.logger=V.Global}findCommand(e){var a;if(!this.commands[e[0]])return[void 0,e,[]];let s=this.commands[e[0]],n=1;for(;s&&n<e.length&&((a=s.children)!=null&&a[e[n]]);)s=s.children[e[n]],n++;return[s,e.slice(n),e.slice(0,n)]}compile(e){const[a,s]=this.findCommand(e);if(!a)throw new Error(`command not found: ${e.join(" ")}`);const n=a.compile;if(!n)throw new Error(`command not implemented: ${e.join(" ")}`);const i=new pT(a.arguments||"",a.docs).parseList(s);return Object.assign(n(i,this),{String:()=>e.join(" ")})}},NT=class{constructor(e){this.program=e}markdown(e){return typeof e=="string"&&(e=jt(e),(e.length===0||e.length===1&&e[0]==="")&&(e=void 0)),this.doc(e,!0)}text(e){return typeof e=="string"&&(e=jt(e),e.length===1&&e[0]===""&&(e=void 0)),this.doc(e,!1)}allCommands(){const e=[];function a(s,n=[]){if(s.children)for(const r in s.children)a(s.children[r],[...n,r]);else e.push(n.join(" "))}for(const s in this.program.commands)a(this.program.commands[s],[s]);return e}doc(e,a=!1){if(!e){let s="";for(const n in this.program.commands)s+=this.command([n],a)+`

`;return s}return this.command(e,a)}command(e,a=!0){const[s,,n]=this.program.findCommand(e),r=n.join(" ");if(!s)return`Command not found: \`${e.join(" ")}\``;let i="";a&&(i+="## "),i+="command `"+r+`\`

`,i+=s.description||"",i+=`

`,a&&(i+="### "),i+=`Syntax:

`,a&&(i+="```\n"),i+=r+" "+(s.arguments||"").trim()+`
`,a&&(i+="```\n"),i+=`
`,a&&(i+="### "),i+=`Arguments:

`;let c=0;for(const _ in s.docs)i+="- `"+_+"`: "+s.docs[_]+`
`,c++;if(c===0&&(i+=`No arguments
`),s.example){a&&(i+="### "),i+=`Examples:

`;const _=typeof s.example=="string"?[s.example]:s.example;for(const u of _)a&&(i+="```\n"),i+=u+`
`,a&&(i+="```\n")}if(s.children){a&&(i+="### "),i+=`Subcommands:

`;for(const _ in s.children)i+="- `"+r+" "+_+"`\n";i+=`
`}return i}},ka=/\$([a-z_][a-z0-9_]*)/ig,dT=/(?:\/\/|#).*$/gm,CT=/\/\*[\s\S]*?\*\//gm,MT=/\{([^}]*)\}/ig,gT=/"([^"]*)"/ig,GT=/(([a-z_][a-z0-9_]*)="[^"]*")/ig,RT=/([^\s]+)/ig;function Le(e){return e=e.replace(dT,""),e=e.replace(CT,a=>a.replace(/[^\n]/g," ")),e}function IT(e,a,s){if(!a)throw new Error(`expected constant name after "const" at ${e.start}`);if(!a.value.match(ka))throw new Error(`constant name must be a valid identifier at ${a.start}`);if(a.value==="const")throw new Error(`constant name cannot be "const" at ${a.start}`);if(a.type!=="part")throw new Error(`constant name cannot be an expression at ${a.start}`);if(!s)throw new Error(`expected constant value after constant name at ${a.end}`);if(a.start[0]!==e.start[0])throw new Error(`constant name must be on the same line as "const" at ${a.start}`);if(s.start[0]!==a.start[0])throw new Error(`constant value must be on the same line as constant name at ${s.start}`)}var Va=class{constructor(){this.input="",this.table=new St(""),this._tokens=[]}parse(e){return this.input=Le(e.toLowerCase()),this.table=new St(this.input),this._tokens=[],this.validateBrackets(),this.scan(MT,"expression"),this.scan(GT,"part"),this.scan(gT,"part"),this.scan(RT,"part"),St.sortByLocation(this._tokens,a=>a.start),this._parse()}get tokens(){return this._tokens}validateBrackets(){let e=!1;for(let a=0;a<this.input.length;a++){const s=this.input[a],n=this.table.getLocation(a);if(s==="{"){if(e)throw new Error(`cannot open block at ${n} because another block is already open`);e=!0}else if(s==="}"){if(!e)throw new Error(`cannot close block at ${n} because no block is open`);e=!1}}}scan(e,a){const s=this.input.matchAll(e);for(const n of s){const r=n.index;if(r===void 0)continue;const i=r+n[0].length,c=this.table.getLocation(r),_=this.table.getLocation(i),u=n[1];this.input=this.input.slice(0,r)+" ".repeat(n[0].length)+this.input.slice(i),this._tokens.push({type:a,value:u,start:c,end:_})}}_parse(){const e=[];let a=0,s=0,n=[];function r(i){var c,_,u;if(((c=n[n.length-1])==null?void 0:c.value)==="\\")n.pop();else if(n.length>0){const A=[...n],S=((_=A[0])==null?void 0:_.start)||i.start,h=((u=A[A.length-1])==null?void 0:u.end)||i.end;e.push({type:"instruction",values:A,start:S,end:h}),n=[]}}for(let i=0;i<this._tokens.length;i++){const c=this._tokens[i];if(c.type==="part"&&c.value==="const"){if(c.start[0]===a)throw new Error(`constants must be declared on their own line at ${c.start}`);const _=this._tokens[i+1],u=this._tokens[i+2];IT(c,_,u),e.push({type:"constant",values:[_,u],start:c.start,end:u.end}),i+=2}else c.start[0]!==s&&r(c),n.push(c);a=c.start[0],s=c.end[0]}return this.tokens.length>0&&r(this._tokens[this._tokens.length-1]),St.sortByLocation(e,i=>i.start),e}},xa=class{constructor(e){this.program=e,this.exprParser=new Mt(Mt.Contexts("math","logic")),this.langParser=new Va,this.constants=new Map,this.catch=!0}setProgram(e){this.program=e}compileString(e,a={}){try{const s=this.preprocess(e);return this.compile(s,a)}catch(s){if(s instanceof Error?this.program.logger.error(s.message):this.program.logger.error(String(s).valueOf()),!this.catch)throw s;return Object.assign(()=>[],{String:()=>"/* error */"})}}compile(e,a={}){const s=this.program.logger,n=[],r=Math.max(1,Math.floor(a.line||1));for(const i of e)try{s.setLine(i.start),s.setLine(s.line+r-1);const c=this.program.compile(i.values),_=()=>{try{return c()}catch(u){if(u instanceof Error?(s.error(u.message),u.message=`Error at ${i.start}: ${u.message}`):s.error(String(u).valueOf()),!this.catch)throw u;return}};n.push(_)}catch(c){if(c instanceof Error?(s.error(c.message),c.message=`Error at ${i.start}: ${c.message}`):s.error(String(c).valueOf()),!this.catch)throw c}return Object.assign(()=>n.map(i=>i()),{String:()=>e.map(i=>i.values.join(" ")).join(`
`)})}preprocess(e){const a=this.langParser.parse(e),s=[];for(const n of a)if(n.type==="constant"){const r=n.values[0],i=n.values[1],c=r.value;if(this.constants.has(c))throw new Error(`cannot redefine constant "${c}" at ${r.start}`);if(i.type==="expression"){const _=this.evaluateExpression(i);this.constants.set(c,_.toString())}else this.constants.set(c,i.value)}else{for(const i of n.values)i.type==="expression"&&(i.value=this.evaluateExpression(i).toString());for(let i=1;i<n.values.length;i++){const c=n.values[i-1],_=n.values[i];c.end[0]===_.start[0]&&c.end[1]===_.start[1]&&(c.value+=_.value,c.end=_.end,n.values.splice(i,1),i--)}const r=n.values.map(i=>this.replaceConstants(i.value));s.push({start:n.start,end:n.end,values:r})}return s}replaceConstants(e,a=!1){return e.replace(ka,(s,n)=>{const r=this.constants.get(s)||this.constants.get(n);if(r===void 0)throw new Error(`constant "${s}" not found`);if(a){let i=parseFloat(r);return r.endsWith("%")&&(i/=100),Number.isFinite(i)?i.toString():s}return r})}evaluateExpression(e){let a=e.value;a=this.replaceConstants(a,!0),a=`
`.repeat(e.start[0]-1)+" ".repeat(e.start[1]-1)+a;const n=this.exprParser.parse(a).evaluateAll();return n.length===0?0:n[n.length-1]}},OT=Object.freeze({__proto__:null,Compiler:xa,ExprParser:Mt,LangParser:Va,Logger:V,Program:zt,ProgramDocs:NT,RemoveComments:Le}),pe=function(e,a){return pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(s[r]=n[r])},pe(e,a)};function Ua(e,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");pe(e,a);function s(){this.constructor=e}e.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}function Wa(e,a){var s=typeof Symbol=="function"&&e[Symbol.iterator];if(!s)return e;var n=s.call(e),r,i=[],c;try{for(;(a===void 0||a-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(_){c={error:_}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(c)throw c.error}}return i}function ja(e,a,s){if(s||arguments.length===2)for(var n=0,r=a.length,i;n<r;n++)(i||!(n in a))&&(i||(i=Array.prototype.slice.call(a,0,n)),i[n]=a[n]);return e.concat(i||Array.prototype.slice.call(a))}var za=function(){function e(){this.t=0}return Object.defineProperty(e.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),e.prototype.size=function(){return this.t},e.prototype.empty=function(){return this.t===0},e}();(function(e){Ua(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a})(za);var qa=function(e){Ua(a,e);function a(s,n,r){s===void 0&&(s=[]),n===void 0&&(n=function(A,S){return A>S?-1:A<S?1:0}),r===void 0&&(r=!0);var i=e.call(this)||this;if(i.i=n,Array.isArray(s))i.u=r?ja([],Wa(s),!1):s;else{i.u=[];var c=i;s.forEach(function(A){c.u.push(A)})}i.t=i.u.length;for(var _=i.t>>1,u=i.t-1>>1;u>=0;--u)i.o(u,_);return i}return a.prototype.h=function(s){for(var n=this.u[s];s>0;){var r=s-1>>1,i=this.u[r];if(this.i(i,n)<=0)break;this.u[s]=i,s=r}this.u[s]=n},a.prototype.o=function(s,n){for(var r=this.u[s];s<n;){var i=s<<1|1,c=i+1,_=this.u[i];if(c<this.t&&this.i(_,this.u[c])>0&&(i=c,_=this.u[c]),this.i(_,r)>=0)break;this.u[s]=_,s=i}this.u[s]=r},a.prototype.clear=function(){this.t=0,this.u.length=0},a.prototype.push=function(s){this.u.push(s),this.h(this.t),this.t+=1},a.prototype.pop=function(){if(this.t!==0){var s=this.u[0],n=this.u.pop();return this.t-=1,this.t&&(this.u[0]=n,this.o(0,this.t>>1)),s}},a.prototype.top=function(){return this.u[0]},a.prototype.find=function(s){return this.u.indexOf(s)>=0},a.prototype.remove=function(s){var n=this.u.indexOf(s);return n<0?!1:(n===0?this.pop():n===this.t-1?(this.u.pop(),this.t-=1):(this.u.splice(n,1,this.u.pop()),this.t-=1,this.h(n),this.o(n,this.t>>1)),!0)},a.prototype.updateItem=function(s){var n=this.u.indexOf(s);return n<0?!1:(this.h(n),this.o(n,this.t>>1),!0)},a.prototype.toArray=function(){return ja([],Wa(this.u),!1)},a}(za),DT=Object.defineProperty,vT=(e,a)=>{for(var s in a)DT(e,s,{get:a[s],enumerable:!0})},$a={};vT($a,{Filter:()=>HT,ReduceSearchItem:()=>qt,Search:()=>yT});function qt(e){const a=[];if(e===void 0)return a;if(Array.isArray(e))for(const s of e){const n=qt(s);for(const r of n)a.push(r)}else a.push(e);return a}function yT(e){const a=qt(e.search),s={values:[],indexes:[],results:[]},n=e.mode||"some";for(let r=0;r<e.values.length;r++){const i=qt(e.map(e.values[r]));a[n](_=>i.some(u=>typeof _!=typeof u?!1:(e.ignoreCase&&(typeof _=="string"&&(_=_.toLowerCase()),typeof u=="string"&&(u=u.toLowerCase())),e.exact||typeof _=="number"?_===u:typeof u=="string"?u.includes(_):!1)))&&(s.values.push(e.values[r]),s.indexes.push(r),s.results.push({value:e.values[r],index:r}))}return s}function HT(e){const a={values:[],indexes:[],results:[]};return e.values.forEach((s,n)=>{e.filters[e.mode||"some"](i=>i.for?i.for(s)?i.filter(s):!0:i.filter(s))&&(a.values.push(s),a.indexes.push(n),a.results.push({value:s,index:n}))}),a}var Qa={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.stringSimilarity=void 0;var a=function(s,n,r,i){if(r===void 0&&(r=2),i===void 0&&(i=!1),i||(s=s.toLowerCase(),n=n.toLowerCase()),s.length<r||n.length<r)return 0;for(var c=new Map,_=0;_<s.length-(r-1);_++){var u=s.substr(_,r);c.set(u,c.has(u)?c.get(u)+1:1)}for(var A=0,S=0;S<n.length-(r-1);S++){var h=n.substr(S,r),m=c.has(h)?c.get(h):0;m>0&&(c.set(h,m-1),A++)}return A*2/(s.length+n.length-(r-1)*2)};e.stringSimilarity=a,e.default=e.stringSimilarity})(Qa);var PT=Object.create,$t=Object.defineProperty,wT=Object.defineProperties,BT=Object.getOwnPropertyDescriptor,bT=Object.getOwnPropertyDescriptors,Xa=Object.getOwnPropertyNames,Ja=Object.getOwnPropertySymbols,KT=Object.getPrototypeOf,Za=Object.prototype.hasOwnProperty,YT=Object.prototype.propertyIsEnumerable,g=Math.pow,ts=(e,a,s)=>a in e?$t(e,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[a]=s,k=(e,a)=>{for(var s in a||(a={}))Za.call(a,s)&&ts(e,s,a[s]);if(Ja)for(var s of Ja(a))YT.call(a,s)&&ts(e,s,a[s]);return e},lt=(e,a)=>wT(e,bT(a)),x=(e,a)=>function(){return a||(0,e[Xa(e)[0]])((a={exports:{}}).exports,a),a.exports},D=(e,a)=>{for(var s in a)$t(e,s,{get:a[s],enumerable:!0})},FT=(e,a,s,n)=>{if(a&&typeof a=="object"||typeof a=="function")for(let r of Xa(a))!Za.call(e,r)&&r!==s&&$t(e,r,{get:()=>a[r],enumerable:!(n=BT(a,r))||n.enumerable});return e},kT=(e,a,s)=>(s=e!=null?PT(KT(e)):{},FT(a||!e||!e.__esModule?$t(s,"default",{value:e,enumerable:!0}):s,e)),gt=(e,a,s)=>new Promise((n,r)=>{var i=u=>{try{_(s.next(u))}catch(A){r(A)}},c=u=>{try{_(s.throw(u))}catch(A){r(A)}},_=u=>u.done?n(u.value):Promise.resolve(u.value).then(i,c);_((s=s.apply(e,a)).next())}),es=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/Solution.js"(e,a){function s(n,r,i,c){this.feasible=i,this.evaluation=r,this.bounded=c,this._tableau=n}a.exports=s,s.prototype.generateSolutionSet=function(){for(var n={},r=this._tableau,i=r.varIndexByRow,c=r.variablesPerIndex,_=r.matrix,u=r.rhsColumn,A=r.height-1,S=Math.round(1/r.precision),h=1;h<=A;h+=1){var m=i[h],f=c[m];if(!(f===void 0||f.isSlack===!0)){var N=_[h][u];n[f.id]=Math.round((Number.EPSILON+N)*S)/S}}return n}}}),VT=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/MilpSolution.js"(e,a){var s=es();function n(r,i,c,_,u){s.call(this,r,i,c,_),this.iter=u}a.exports=n,n.prototype=Object.create(s.prototype),n.constructor=n}}),ot=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/Tableau.js"(e,a){var s=es(),n=VT();function r(c){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=c||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}a.exports=r,r.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()};function i(c,_){this.priority=c,this.reducedCosts=new Array(_);for(var u=0;u<_;u+=1)this.reducedCosts[u]=0}i.prototype.copy=function(){var c=new i(this.priority,this.reducedCosts.length);return c.reducedCosts=this.reducedCosts.slice(),c},r.prototype.setOptionalObjective=function(c,_,u){var A=this.objectivesByPriority[c];if(A===void 0){var S=Math.max(this.width,_+1);A=new i(c,S),this.objectivesByPriority[c]=A,this.optionalObjectives.push(A),this.optionalObjectives.sort(function(h,m){return h.priority-m.priority})}A.reducedCosts[_]=u},r.prototype.initialize=function(c,_,u,A){this.variables=u,this.unrestrictedVars=A,this.width=c,this.height=_;for(var S=new Array(c),h=0;h<c;h++)S[h]=0;this.matrix=new Array(_);for(var m=0;m<_;m++)this.matrix[m]=S.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=c+_-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},r.prototype._resetMatrix=function(){var c=this.model.variables,_=this.model.constraints,u=c.length,A=_.length,S,h,m=this.matrix[0],f=this.model.isMinimization===!0?-1:1;for(S=0;S<u;S+=1){var N=c[S],L=N.priority,C=f*N.cost;L===0?m[S+1]=C:this.setOptionalObjective(L,S+1,C),h=c[S].index,this.rowByVarIndex[h]=-1,this.colByVarIndex[h]=S+1,this.varIndexByCol[S+1]=h}for(var d=1,M=0;M<A;M+=1){var R=_[M],O=R.index;this.rowByVarIndex[O]=d,this.colByVarIndex[O]=-1,this.varIndexByRow[d]=O;var y,P,B,j=R.terms,X=j.length,at=this.matrix[d++];if(R.isUpperBound){for(y=0;y<X;y+=1)P=j[y],B=this.colByVarIndex[P.variable.index],at[B]=P.coefficient;at[0]=R.rhs}else{for(y=0;y<X;y+=1)P=j[y],B=this.colByVarIndex[P.variable.index],at[B]=-P.coefficient;at[0]=-R.rhs}}},r.prototype.setModel=function(c){this.model=c;var _=c.nVariables+1,u=c.nConstraints+1;return this.initialize(_,u,c.variables,c.unrestrictedVariables),this._resetMatrix(),this},r.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var c=this.lastElementIndex;return this.lastElementIndex+=1,c},r.prototype.density=function(){for(var c=0,_=this.matrix,u=0;u<this.height;u++)for(var A=_[u],S=0;S<this.width;S++)A[S]!==0&&(c+=1);return c/(this.height*this.width)},r.prototype.setEvaluation=function(){var c=Math.round(1/this.precision),_=this.matrix[this.costRowIndex][this.rhsColumn],u=Math.round((Number.EPSILON+_)*c)/c;this.evaluation=u,this.simplexIters===0&&(this.bestPossibleEval=u)},r.prototype.getSolution=function(){var c=this.model.isMinimization===!0?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new n(this,c,this.feasible,this.bounded,this.branchAndCutIterations):new s(this,c,this.feasible,this.bounded)}}}),xT=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/simplex.js"(){var e=ot();e.prototype.simplex=function(){return this.bounded=!0,this.phase1(),this.feasible===!0&&this.phase2(),this},e.prototype.phase1=function(){for(var s=this.model.checkForCycles,n=[],r=this.matrix,i=this.rhsColumn,c=this.width-1,_=this.height-1,u,A=0;;){for(var S=0,h=-this.precision,m=1;m<=_;m++){u=this.unrestrictedVars[this.varIndexByRow[m]]===!0;var f=r[m][i];f<h&&(h=f,S=m)}if(S===0)return this.feasible=!0,A;for(var N=0,L=-1/0,C=r[0],d=r[S],M=1;M<=c;M++){var R=d[M];if(u=this.unrestrictedVars[this.varIndexByCol[M]]===!0,u||R<-this.precision){var O=-C[M]/R;L<O&&(L=O,N=M)}}if(N===0)return this.feasible=!1,A;if(s){n.push([this.varIndexByRow[S],this.varIndexByCol[N]]);var y=this.checkForCycles(n);if(y.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+y[0]),this.model.messages.push("Length :"+y[1]),this.feasible=!1,A}this.pivot(S,N),A+=1}},e.prototype.phase2=function(){for(var s=this.model.checkForCycles,n=[],r=this.matrix,i=this.rhsColumn,c=this.width-1,_=this.height-1,u=this.precision,A=this.optionalObjectives.length,S=null,h=0,m,f;;){var N=r[this.costRowIndex];A>0&&(S=[]);for(var L=0,C=u,d=!1,M=1;M<=c;M++){if(m=N[M],f=this.unrestrictedVars[this.varIndexByCol[M]]===!0,A>0&&-u<m&&m<u){S.push(M);continue}if(f&&m<0){-m>C&&(C=-m,L=M,d=!0);continue}m>C&&(C=m,L=M,d=!1)}if(A>0)for(var R=0;L===0&&S.length>0&&R<A;){var O=[],y=this.optionalObjectives[R].reducedCosts;C=u;for(var P=0;P<S.length;P++){if(M=S[P],m=y[M],f=this.unrestrictedVars[this.varIndexByCol[M]]===!0,-u<m&&m<u){O.push(M);continue}if(f&&m<0){-m>C&&(C=-m,L=M,d=!0);continue}m>C&&(C=m,L=M,d=!1)}S=O,R+=1}if(L===0)return this.setEvaluation(),this.simplexIters+=1,h;var B=0,j=1/0;this.varIndexByRow;for(var X=1;X<=_;X++){var at=r[X],Et=at[i],Z=at[L];if(!(-u<Z&&Z<u)){if(Z>0&&u>Et&&Et>-u){j=0,B=X;break}var dt=d?-Et/Z:Et/Z;dt>u&&j>dt&&(j=dt,B=X)}}if(j===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[L],h;if(s){n.push([this.varIndexByRow[B],this.varIndexByCol[L]]);var Ct=this.checkForCycles(n);if(Ct.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+Ct[0]),this.model.messages.push("Length :"+Ct[1]),this.feasible=!1,h}this.pivot(B,L,!0),h+=1}};var a=[];e.prototype.pivot=function(s,n){var r=this.matrix,i=r[s][n],c=this.height-1,_=this.width-1,u=this.varIndexByRow[s],A=this.varIndexByCol[n];this.varIndexByRow[s]=A,this.varIndexByCol[n]=u,this.rowByVarIndex[A]=s,this.rowByVarIndex[u]=-1,this.colByVarIndex[A]=-1,this.colByVarIndex[u]=n;for(var S=r[s],h=0,m=0;m<=_;m++)S[m]>=-1e-16&&S[m]<=1e-16?S[m]=0:(S[m]/=i,a[h]=m,h+=1);S[n]=1/i;var f,N,L;this.precision;for(var C=0;C<=c;C++)if(C!==s&&!(r[C][n]>=-1e-16&&r[C][n]<=1e-16)){var d=r[C];if(f=d[n],f>=-1e-16&&f<=1e-16)f!==0&&(d[n]=0);else{for(N=0;N<h;N++)m=a[N],L=S[m],L>=-1e-16&&L<=1e-16?L!==0&&(S[m]=0):d[m]=d[m]-f*L;d[n]=-f/i}}var M=this.optionalObjectives.length;if(M>0)for(var R=0;R<M;R+=1){var O=this.optionalObjectives[R].reducedCosts;if(f=O[n],f!==0){for(N=0;N<h;N++)m=a[N],L=S[m],L!==0&&(O[m]=O[m]-f*L);O[n]=-f/i}}},e.prototype.checkForCycles=function(s){for(var n=0;n<s.length-1;n++)for(var r=n+1;r<s.length;r++){var i=s[n],c=s[r];if(i[0]===c[0]&&i[1]===c[1]){if(r-n>s.length-r)break;for(var _=!0,u=1;u<r-n;u++){var A=s[n+u],S=s[r+u];if(A[0]!==S[0]||A[1]!==S[1]){_=!1;break}}if(_)return[n,r-n]}}return[]}}}),Ne=x({"node_modules/@bygdle/javascript-lp-solver/src/expressions.js"(e,a){function s(A,S,h,m){this.id=A,this.cost=S,this.index=h,this.value=0,this.priority=m}function n(A,S,h,m){s.call(this,A,S,h,m)}n.prototype.isInteger=!0;function r(A,S){s.call(this,A,0,S,0)}r.prototype.isSlack=!0;function i(A,S){this.variable=A,this.coefficient=S}function c(A,S,h){return h===0||h==="required"?null:(S=S||1,h=h||1,A.isMinimization===!1&&(S=-S),A.addVariable(S,"r"+A.relaxationIndex++,!1,!1,h))}function _(A,S,h,m){this.slack=new r("s"+h,h),this.index=h,this.model=m,this.rhs=A,this.isUpperBound=S,this.terms=[],this.termsByVarIndex={},this.relaxation=null}_.prototype.addTerm=function(A,S){var h=S.index,m=this.termsByVarIndex[h];if(m===void 0)m=new i(S,A),this.termsByVarIndex[h]=m,this.terms.push(m),this.isUpperBound===!0&&(A=-A),this.model.updateConstraintCoefficient(this,S,A);else{var f=m.coefficient+A;this.setVariableCoefficient(f,S)}return this},_.prototype.removeTerm=function(A){return this},_.prototype.setRightHandSide=function(A){if(A!==this.rhs){var S=A-this.rhs;this.isUpperBound===!0&&(S=-S),this.rhs=A,this.model.updateRightHandSide(this,S)}return this},_.prototype.setVariableCoefficient=function(A,S){var h=S.index;if(h===-1){console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.");return}var m=this.termsByVarIndex[h];if(m===void 0)this.addTerm(A,S);else if(A!==m.coefficient){var f=A-m.coefficient;this.isUpperBound===!0&&(f=-f),m.coefficient=A,this.model.updateConstraintCoefficient(this,S,f)}return this},_.prototype.relax=function(A,S){this.relaxation=c(this.model,A,S),this._relax(this.relaxation)},_.prototype._relax=function(A){A!==null&&(this.isUpperBound?this.setVariableCoefficient(-1,A):this.setVariableCoefficient(1,A))};function u(A,S){this.upperBound=A,this.lowerBound=S,this.model=A.model,this.rhs=A.rhs,this.relaxation=null}u.prototype.isEquality=!0,u.prototype.addTerm=function(A,S){return this.upperBound.addTerm(A,S),this.lowerBound.addTerm(A,S),this},u.prototype.removeTerm=function(A){return this.upperBound.removeTerm(A),this.lowerBound.removeTerm(A),this},u.prototype.setRightHandSide=function(A){this.upperBound.setRightHandSide(A),this.lowerBound.setRightHandSide(A),this.rhs=A},u.prototype.relax=function(A,S){this.relaxation=c(this.model,A,S),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)},a.exports={Constraint:_,Variable:s,IntegerVariable:n,SlackVariable:r,Equality:u,Term:i}}}),UT=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/cuttingStrategies.js"(){var e=ot(),a=Ne().SlackVariable;e.prototype.addCutConstraints=function(s){for(var n=s.length,r=this.height,i=r+n,c=r;c<i;c+=1)this.matrix[c]===void 0&&(this.matrix[c]=this.matrix[c-1].slice());this.height=i,this.nVars=this.width+this.height-2;for(var _,u=this.width-1,A=0;A<n;A+=1){var S=s[A],h=r+A,m=S.type==="min"?-1:1,f=S.varIndex,N=this.rowByVarIndex[f],L=this.matrix[h];if(N===-1){for(L[this.rhsColumn]=m*S.value,_=1;_<=u;_+=1)L[_]=0;L[this.colByVarIndex[f]]=m}else{var C=this.matrix[N],d=C[this.rhsColumn];for(L[this.rhsColumn]=m*(S.value-d),_=1;_<=u;_+=1)L[_]=-m*C[_]}var M=this.getNewElementIndex();this.varIndexByRow[h]=M,this.rowByVarIndex[M]=h,this.colByVarIndex[M]=-1,this.variablesPerIndex[M]=new a("s"+M,M),this.nVars+=1}},e.prototype._addLowerBoundMIRCut=function(s){if(s===this.costRowIndex)return!1;this.model;var n=this.matrix,r=this.variablesPerIndex[this.varIndexByRow[s]];if(!r.isInteger)return!1;var i=n[s][this.rhsColumn],c=i-Math.floor(i);if(c<this.precision||1-this.precision<c)return!1;var _=this.height;n[_]=n[_-1].slice(),this.height+=1,this.nVars+=1;var u=this.getNewElementIndex();this.varIndexByRow[_]=u,this.rowByVarIndex[u]=_,this.colByVarIndex[u]=-1,this.variablesPerIndex[u]=new a("s"+u,u),n[_][this.rhsColumn]=Math.floor(i);for(var A=1;A<this.varIndexByCol.length;A+=1){var S=this.variablesPerIndex[this.varIndexByCol[A]];if(!S.isInteger)n[_][A]=Math.min(0,n[s][A]/(1-c));else{var h=n[s][A],m=Math.floor(h)+Math.max(0,h-Math.floor(h)-c)/(1-c);n[_][A]=m}}for(var f=0;f<this.width;f+=1)n[_][f]-=n[s][f];return!0},e.prototype._addUpperBoundMIRCut=function(s){if(s===this.costRowIndex)return!1;this.model;var n=this.matrix,r=this.variablesPerIndex[this.varIndexByRow[s]];if(!r.isInteger)return!1;var i=n[s][this.rhsColumn],c=i-Math.floor(i);if(c<this.precision||1-this.precision<c)return!1;var _=this.height;n[_]=n[_-1].slice(),this.height+=1,this.nVars+=1;var u=this.getNewElementIndex();this.varIndexByRow[_]=u,this.rowByVarIndex[u]=_,this.colByVarIndex[u]=-1,this.variablesPerIndex[u]=new a("s"+u,u),n[_][this.rhsColumn]=-c;for(var A=1;A<this.varIndexByCol.length;A+=1){var S=this.variablesPerIndex[this.varIndexByCol[A]],h=n[s][A],m=h-Math.floor(h);S.isInteger?m<=c?n[_][A]=-m:n[_][A]=-(1-m)*c/m:h>=0?n[_][A]=-h:n[_][A]=h*c/(1-c)}return!0},e.prototype.applyMIRCuts=function(){}}}),WT=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/dynamicModification.js"(){var e=ot();e.prototype._putInBase=function(a){var s=this.rowByVarIndex[a];if(s===-1){for(var n=this.colByVarIndex[a],r=1;r<this.height;r+=1){var i=this.matrix[r][n];if(i<-this.precision||this.precision<i){s=r;break}}this.pivot(s,n)}return s},e.prototype._takeOutOfBase=function(a){var s=this.colByVarIndex[a];if(s===-1){for(var n=this.rowByVarIndex[a],r=this.matrix[n],i=1;i<this.height;i+=1){var c=r[i];if(c<-this.precision||this.precision<c){s=i;break}}this.pivot(n,s)}return s},e.prototype.updateVariableValues=function(){for(var a=this.variables.length,s=Math.round(1/this.precision),n=0;n<a;n+=1){var r=this.variables[n],i=r.index,c=this.rowByVarIndex[i];if(c===-1)r.value=0;else{var _=this.matrix[c][this.rhsColumn];r.value=Math.round((_+Number.EPSILON)*s)/s}}},e.prototype.updateRightHandSide=function(a,s){var n=this.height-1,r=this.rowByVarIndex[a.index];if(r===-1){for(var i=this.colByVarIndex[a.index],c=0;c<=n;c+=1){var _=this.matrix[c];_[this.rhsColumn]-=s*_[i]}var u=this.optionalObjectives.length;if(u>0)for(var A=0;A<u;A+=1){var S=this.optionalObjectives[A].reducedCosts;S[this.rhsColumn]-=s*S[i]}}else this.matrix[r][this.rhsColumn]-=s},e.prototype.updateConstraintCoefficient=function(a,s,n){if(a.index===s.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var r=this._putInBase(a.index),i=this.colByVarIndex[s.index];if(i===-1)for(var c=this.rowByVarIndex[s.index],_=0;_<this.width;_+=1)this.matrix[r][_]+=n*this.matrix[c][_];else this.matrix[r][i]-=n},e.prototype.updateCost=function(a,s){var n=a.index,r=this.width-1,i=this.colByVarIndex[n];if(i===-1){var c=this.matrix[this.rowByVarIndex[n]],_;if(a.priority===0){var u=this.matrix[0];for(_=0;_<=r;_+=1)u[_]+=s*c[_]}else{var A=this.objectivesByPriority[a.priority].reducedCosts;for(_=0;_<=r;_+=1)A[_]+=s*c[_]}}else this.matrix[0][i]-=s},e.prototype.addConstraint=function(a){var s=a.isUpperBound?1:-1,n=this.height,r=this.matrix[n];r===void 0&&(r=this.matrix[0].slice(),this.matrix[n]=r);for(var i=this.width-1,c=0;c<=i;c+=1)r[c]=0;r[this.rhsColumn]=s*a.rhs;for(var _=a.terms,u=_.length,A=0;A<u;A+=1){var S=_[A],h=S.coefficient,m=S.variable.index,f=this.rowByVarIndex[m];if(f===-1)r[this.colByVarIndex[m]]+=s*h;else{var N=this.matrix[f];for(N[this.rhsColumn],c=0;c<=i;c+=1)r[c]-=s*h*N[c]}}var L=a.index;this.varIndexByRow[n]=L,this.rowByVarIndex[L]=n,this.colByVarIndex[L]=-1,this.height+=1},e.prototype.removeConstraint=function(a){var s=a.index,n=this.height-1,r=this._putInBase(s),i=this.matrix[n];this.matrix[n]=this.matrix[r],this.matrix[r]=i,this.varIndexByRow[r]=this.varIndexByRow[n],this.varIndexByRow[n]=-1,this.rowByVarIndex[s]=-1,this.availableIndexes[this.availableIndexes.length]=s,a.slack.index=-1,this.height-=1},e.prototype.addVariable=function(a){var s=this.height-1,n=this.width,r=this.model.isMinimization===!0?-a.cost:a.cost,i=a.priority,c=this.optionalObjectives.length;if(c>0)for(var _=0;_<c;_+=1)this.optionalObjectives[_].reducedCosts[n]=0;i===0?this.matrix[0][n]=r:(this.setOptionalObjective(i,n,r),this.matrix[0][n]=0);for(var u=1;u<=s;u+=1)this.matrix[u][n]=0;var A=a.index;this.varIndexByCol[n]=A,this.rowByVarIndex[A]=-1,this.colByVarIndex[A]=n,this.width+=1},e.prototype.removeVariable=function(a){var s=a.index,n=this._takeOutOfBase(s),r=this.width-1;if(n!==r){for(var i=this.height-1,c=0;c<=i;c+=1){var _=this.matrix[c];_[n]=_[r]}var u=this.optionalObjectives.length;if(u>0)for(var A=0;A<u;A+=1){var S=this.optionalObjectives[A].reducedCosts;S[n]=S[r]}var h=this.varIndexByCol[r];this.varIndexByCol[n]=h,this.colByVarIndex[h]=n}this.varIndexByCol[r]=-1,this.colByVarIndex[s]=-1,this.availableIndexes[this.availableIndexes.length]=s,a.index=-1,this.width-=1}}}),jT=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/log.js"(){var e=ot();e.prototype.log=function(a,s){console.log("****",a,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var n=5,r="",i=[" "],c,_,u,A,S,h,m,f,N,L,C;for(_=1;_<this.width;_+=1)S=this.varIndexByCol[_],A=this.variablesPerIndex[S],A===void 0?h="c"+S:h=A.id,m=h.length,f=" ",N="	",m>5?f+=" ":N+="	",i[_]=f,r+=N+h;console.log(r);var d,M=this.matrix[this.costRowIndex],R="	";for(c=1;c<this.width;c+=1)d="	",R+=d,R+=i[c],R+=M[c].toFixed(n);for(d="	",R+=d+i[0]+M[0].toFixed(n),console.log(R+"	Z"),u=1;u<this.height;u+=1){for(L=this.matrix[u],C="	",_=1;_<this.width;_+=1)d="	",C+=d+i[_]+L[_].toFixed(n);d="	",C+=d+i[0]+L[0].toFixed(n),S=this.varIndexByRow[u],A=this.variablesPerIndex[S],A===void 0?h="c"+S:h=A.id,console.log(C+"	"+h)}console.log("");var O=this.optionalObjectives.length;if(O>0){console.log("    Optional objectives:");for(var y=0;y<O;y+=1){var P=this.optionalObjectives[y].reducedCosts,B="";for(c=1;c<this.width;c+=1)d=P[c]<0?"":" ",B+=d,B+=i[c],B+=P[c].toFixed(n);d=P[0]<0?"":" ",B+=d+i[0]+P[0].toFixed(n),console.log(B+" z"+y)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this}}}),zT=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/backup.js"(){var e=ot();e.prototype.copy=function(){var a=new e(this.precision);a.width=this.width,a.height=this.height,a.nVars=this.nVars,a.model=this.model,a.variables=this.variables,a.variablesPerIndex=this.variablesPerIndex,a.unrestrictedVars=this.unrestrictedVars,a.lastElementIndex=this.lastElementIndex,a.varIndexByRow=this.varIndexByRow.slice(),a.varIndexByCol=this.varIndexByCol.slice(),a.rowByVarIndex=this.rowByVarIndex.slice(),a.colByVarIndex=this.colByVarIndex.slice(),a.availableIndexes=this.availableIndexes.slice();for(var s=[],n=0;n<this.optionalObjectives.length;n++)s[n]=this.optionalObjectives[n].copy();a.optionalObjectives=s;for(var r=this.matrix,i=new Array(this.height),c=0;c<this.height;c++)i[c]=r[c].slice();return a.matrix=i,a},e.prototype.save=function(){this.savedState=this.copy()},e.prototype.restore=function(){if(this.savedState!==null){var a=this.savedState,s=a.matrix;this.nVars=a.nVars,this.model=a.model,this.variables=a.variables,this.variablesPerIndex=a.variablesPerIndex,this.unrestrictedVars=a.unrestrictedVars,this.lastElementIndex=a.lastElementIndex,this.width=a.width,this.height=a.height;var n,r;for(n=0;n<this.height;n+=1){var i=s[n],c=this.matrix[n];for(r=0;r<this.width;r+=1)c[r]=i[r]}var _=a.varIndexByRow;for(r=0;r<this.height;r+=1)this.varIndexByRow[r]=_[r];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var u=a.varIndexByCol;for(n=0;n<this.width;n+=1)this.varIndexByCol[n]=u[n];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var A=a.rowByVarIndex,S=a.colByVarIndex,h=0;h<this.nVars;h+=1)this.rowByVarIndex[h]=A[h],this.colByVarIndex[h]=S[h];if(a.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var m=0;m<a.optionalObjectives.length;m++){var f=a.optionalObjectives[m].copy();this.optionalObjectives[m]=f,this.optionalObjectivePerPriority[f.priority]=f}}}}}}),qT=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/branchingStrategies.js"(){var e=ot();function a(s,n){this.index=s,this.value=n}e.prototype.getMostFractionalVar=function(){for(var s=0,n=null,r=null,i=this.model.integerVariables,c=i.length,_=0;_<c;_++){var u=i[_].index,A=this.rowByVarIndex[u];if(A!==-1){var S=this.matrix[A][this.rhsColumn],h=Math.abs(S-Math.round(S));s<h&&(s=h,n=u,r=S)}}return new a(n,r)},e.prototype.getFractionalVarWithLowestCost=function(){for(var s=1/0,n=null,r=null,i=this.model.integerVariables,c=i.length,_=0;_<c;_++){var u=i[_],A=u.index,S=this.rowByVarIndex[A];if(S!==-1){var h=this.matrix[S][this.rhsColumn];if(Math.abs(h-Math.round(h))>this.precision){var m=u.cost;s>m&&(s=m,n=A,r=h)}}}return new a(n,r)}}}),$T=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/integerProperties.js"(){var e=ot();e.prototype.countIntegerValues=function(){for(var a=0,s=1;s<this.height;s+=1)if(this.variablesPerIndex[this.varIndexByRow[s]].isInteger){var n=this.matrix[s][this.rhsColumn];n=n-Math.floor(n),n<this.precision&&-n<this.precision&&(a+=1)}return a},e.prototype.isIntegral=function(){for(var a=this.model.integerVariables,s=a.length,n=0;n<s;n++){var r=this.rowByVarIndex[a[n].index];if(r!==-1){var i=this.matrix[r][this.rhsColumn];if(Math.abs(i-Math.round(i))>this.precision)return!1}}return!0},e.prototype.computeFractionalVolume=function(a){for(var s=-1,n=1;n<this.height;n+=1)if(this.variablesPerIndex[this.varIndexByRow[n]].isInteger){var r=this.matrix[n][this.rhsColumn];r=Math.abs(r);var i=Math.min(r-Math.floor(r),Math.floor(r+1));if(i<this.precision){if(!a)return 0}else s===-1?s=r:s*=r}return s===-1?0:s}}}),QT=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/index.js"(e,a){xT(),UT(),WT(),jT(),zT(),qT(),$T(),a.exports=ot()}}),as=x({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/branchAndCut.js"(){var e=ot();function a(r,i,c){this.type=r,this.varIndex=i,this.value=c}function s(r,i){this.relaxedEvaluation=r,this.cuts=i}function n(r,i){return i.relaxedEvaluation-r.relaxedEvaluation}e.prototype.applyCuts=function(r){if(this.restore(),this.addCutConstraints(r),this.simplex(),this.model.useMIRCuts)for(var i=!0;i;){var c=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex();var _=this.computeFractionalVolume(!0);_>=.9*c&&(i=!1)}},e.prototype.branchAndCut=function(){var r=[],i=0,c=this.model.tolerance,_=!0,u=1e99;this.model.timeout&&(u=Date.now()+this.model.timeout);for(var A=1/0,S=null,h=[],m=0;m<this.optionalObjectives.length;m+=1)h.push(1/0);var f=new s(-1/0,[]),N;for(r.push(f);r.length>0&&_===!0&&Date.now()<u;)if(this.model.isMinimization?N=this.bestPossibleEval*(1+c):N=this.bestPossibleEval*(1-c),c>0&&A<N&&(_=!1),f=r.pop(),!(f.relaxedEvaluation>A)){var L=f.cuts;if(this.applyCuts(L),i++,this.feasible!==!1){var C=this.evaluation;if(!(C>A)){if(C===A){for(var d=!0,M=0;M<this.optionalObjectives.length&&!(this.optionalObjectives[M].reducedCosts[0]>h[M]);M+=1)if(this.optionalObjectives[M].reducedCosts[0]<h[M]){d=!1;break}if(d)continue}if(this.isIntegral()===!0){if(this.__isIntegral=!0,i===1){this.branchAndCutIterations=i;return}S=f,A=C;for(var R=0;R<this.optionalObjectives.length;R+=1)h[R]=this.optionalObjectives[R].reducedCosts[0];if(this.model.keep_solutions){var O=this.model.tableau.getSolution(),y=O.generateSolutionSet();y.result=O.evaluation,this.model.solutions||(this.model.solutions=[]),this.model.solutions.push(y)}}else{i===1&&this.save();for(var P=this.getMostFractionalVar(),B=P.index,j=[],X=[],at=L.length,Et=0;Et<at;Et+=1){var Z=L[Et];Z.varIndex===B?Z.type==="min"?X.push(Z):j.push(Z):(j.push(Z),X.push(Z))}var dt=Math.ceil(P.value),Ct=Math.floor(P.value),pa=new a("min",B,dt);j.push(pa);var Na=new a("max",B,Ct);X.push(Na),r.push(new s(C,j)),r.push(new s(C,X)),r.sort(n)}}}}S!==null&&this.applyCuts(S.cuts),this.branchAndCutIterations=i}}}),XT=x({"node_modules/@bygdle/javascript-lp-solver/src/Model.js"(e,a){var s=ot();as();var n=Ne(),r=n.Constraint,i=n.Equality,c=n.Variable,_=n.IntegerVariable;n.Term;function u(A,S){this.tableau=new s(A),this.name=S,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}a.exports=u,u.prototype.minimize=function(){return this.isMinimization=!0,this},u.prototype.maximize=function(){return this.isMinimization=!1,this},u.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var A=this.lastElementIndex;return this.lastElementIndex+=1,A},u.prototype._addConstraint=function(A){var S=A.slack;this.tableau.variablesPerIndex[S.index]=S,this.constraints.push(A),this.nConstraints+=1,this.tableauInitialized===!0&&this.tableau.addConstraint(A)},u.prototype.smallerThan=function(A){var S=new r(A,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(S),S},u.prototype.greaterThan=function(A){var S=new r(A,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(S),S},u.prototype.equal=function(A){var S=new r(A,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(S);var h=new r(A,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(h),new i(S,h)},u.prototype.addVariable=function(A,S,h,m,f){if(typeof f=="string")switch(f){case"required":f=0;break;case"strong":f=1;break;case"medium":f=2;break;case"weak":f=3;break;default:f=0;break}var N=this.tableau.getNewElementIndex();S==null&&(S="v"+N),A==null&&(A=0),f==null&&(f=0);var L;return h?(L=new _(S,A,N,f),this.integerVariables.push(L)):L=new c(S,A,N,f),this.variables.push(L),this.tableau.variablesPerIndex[N]=L,m&&(this.unrestrictedVariables[N]=!0),this.nVariables+=1,this.tableauInitialized===!0&&this.tableau.addVariable(L),L},u.prototype._removeConstraint=function(A){var S=this.constraints.indexOf(A);if(S===-1){console.warn("[Model.removeConstraint] Constraint not present in model");return}this.constraints.splice(S,1),this.nConstraints-=1,this.tableauInitialized===!0&&this.tableau.removeConstraint(A),A.relaxation&&this.removeVariable(A.relaxation)},u.prototype.removeConstraint=function(A){return A.isEquality?(this._removeConstraint(A.upperBound),this._removeConstraint(A.lowerBound)):this._removeConstraint(A),this},u.prototype.removeVariable=function(A){var S=this.variables.indexOf(A);if(S===-1){console.warn("[Model.removeVariable] Variable not present in model");return}return this.variables.splice(S,1),this.tableauInitialized===!0&&this.tableau.removeVariable(A),this},u.prototype.updateRightHandSide=function(A,S){return this.tableauInitialized===!0&&this.tableau.updateRightHandSide(A,S),this},u.prototype.updateConstraintCoefficient=function(A,S,h){return this.tableauInitialized===!0&&this.tableau.updateConstraintCoefficient(A,S,h),this},u.prototype.setCost=function(A,S){var h=A-S.cost;return this.isMinimization===!1&&(h=-h),S.cost=A,this.tableau.updateCost(S,h),this},u.prototype.loadJson=function(A){this.isMinimization=A.opType!=="max";for(var S=A.variables,h=A.constraints,m={},f={},N=Object.keys(h),L=N.length,C=0;C<L;C+=1){var d=N[C],M=h[d],R=M.equal,O=M.weight,y=M.priority,P=O!==void 0||y!==void 0,B,j;if(R===void 0){var X=M.min;X!==void 0&&(B=this.greaterThan(X),m[d]=B,P&&B.relax(O,y));var at=M.max;at!==void 0&&(j=this.smallerThan(at),f[d]=j,P&&j.relax(O,y))}else{B=this.greaterThan(R),m[d]=B,j=this.smallerThan(R),f[d]=j;var Et=new i(B,j);P&&Et.relax(O,y)}}var Z=Object.keys(S),dt=Z.length;this.tolerance=A.tolerance||0,A.timeout&&(this.timeout=A.timeout),A.options&&(A.options.timeout&&(this.timeout=A.options.timeout),this.tolerance===0&&(this.tolerance=A.options.tolerance||0),A.options.useMIRCuts&&(this.useMIRCuts=A.options.useMIRCuts),typeof A.options.exitOnCycles>"u"?this.checkForCycles=!0:this.checkForCycles=A.options.exitOnCycles,A.options.keep_solutions?this.keep_solutions=A.options.keep_solutions:this.keep_solutions=!1);for(var Ct=A.ints||{},pa=A.binaries||{},Na=A.unrestricted||{},OE=A.optimize,da=0;da<dt;da+=1){var xt=Z[da],Ca=S[xt],yN=Ca[OE]||0,DE=!!pa[xt],HN=!!Ct[xt]||DE,PN=!!Na[xt],Ma=this.addVariable(yN,xt,HN,PN);DE&&this.smallerThan(1).addTerm(1,Ma);var vE=Object.keys(Ca);for(C=0;C<vE.length;C+=1){var he=vE[C];if(he!==OE){var yE=Ca[he],HE=m[he];HE!==void 0&&HE.addTerm(yE,Ma);var PE=f[he];PE!==void 0&&PE.addTerm(yE,Ma)}}}return this},u.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},u.prototype.solve=function(){return this.tableauInitialized===!1&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},u.prototype.isFeasible=function(){return this.tableau.feasible},u.prototype.save=function(){return this.tableau.save()},u.prototype.restore=function(){return this.tableau.restore()},u.prototype.activateMIRCuts=function(A){this.useMIRCuts=A},u.prototype.debug=function(A){this.checkForCycles=A},u.prototype.log=function(A){return this.tableau.log(A)}}}),JT=x({"node_modules/@bygdle/javascript-lp-solver/src/Validation.js"(e){e.CleanObjectiveAttributes=function(a){var s,n,r;if(typeof a.optimize=="string")if(a.constraints[a.optimize]){s=Math.random();for(n in a.variables)a.variables[n][a.optimize]&&(a.variables[n][s]=a.variables[n][a.optimize]);return a.constraints[s]=a.constraints[a.optimize],delete a.constraints[a.optimize],a}else return a;else{for(r in a.optimize)if(a.constraints[r])if(a.constraints[r]==="equal")delete a.optimize[r];else{s=Math.random();for(n in a.variables)a.variables[n][r]&&(a.variables[n][s]=a.variables[n][r]);a.constraints[s]=a.constraints[r],delete a.constraints[r]}return a}}}}),de=x({"node_modules/@bygdle/javascript-lp-solver/src/External/lpsolve/Reformat.js"(e,a){function s(r){var i={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},c={opType:"",optimize:"_obj",constraints:{},variables:{}},_={">=":"min","<=":"max","=":"equal"},u="",A=null,S="",h="",m="",f=0;typeof r=="string"&&(r=r.split(`
`));for(var N=0;N<r.length;N++)if(m="__"+N,u=r[N],A=null,i.is_objective.test(u))c.opType=u.match(/(max|min)/gi)[0],A=u.match(i.parse_lhs).map(function(d){return d.replace(/\s+/,"")}).slice(1),A.forEach(function(d){S=d.match(i.get_num),S===null?d.substr(0,1)==="-"?S=-1:S=1:S=S[0],S=parseFloat(S),h=d.match(i.get_word)[0].replace(/\;$/,""),c.variables[h]=c.variables[h]||{},c.variables[h]._obj=S});else if(i.is_int.test(u))A=u.match(i.parse_int).slice(1),c.ints=c.ints||{},A.forEach(function(d){d=d.replace(";",""),c.ints[d]=1});else if(i.is_bin.test(u))A=u.match(i.parse_bin).slice(1),c.binaries=c.binaries||{},A.forEach(function(d){d=d.replace(";",""),c.binaries[d]=1});else if(i.is_constraint.test(u)){var L=u.indexOf(":"),C=L===-1?u:u.slice(L+1);A=C.match(i.parse_lhs).map(function(d){return d.replace(/\s+/,"")}),A.forEach(function(d){S=d.match(i.get_num),S===null?d.substr(0,1)==="-"?S=-1:S=1:S=S[0],S=parseFloat(S),h=d.match(i.get_word)[0],c.variables[h]=c.variables[h]||{},c.variables[h][m]=S}),f=parseFloat(u.match(i.parse_rhs)[0]),u=_[u.match(i.parse_dir)[0]],c.constraints[m]=c.constraints[m]||{},c.constraints[m][u]=f}else i.is_unrestricted.test(u)&&(A=u.match(i.parse_int).slice(1),c.unrestricted=c.unrestricted||{},A.forEach(function(d){d=d.replace(";",""),c.unrestricted[d]=1}));return c}function n(r){if(!r)throw new Error("Solver requires a model to operate on");var i="",c={max:"<=",min:">=",equal:"="},_=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(r.opType){i+=r.opType+":";for(var u in r.variables)r.variables[u][u]=r.variables[u][u]?r.variables[u][u]:1,r.variables[u][r.optimize]&&(i+=" "+r.variables[u][r.optimize]+" "+u.replace(_,"_"))}else i+="max:";i+=`;

`;for(var A in r.constraints)for(var S in r.constraints[A])if(typeof c[S]<"u"){for(var h in r.variables)typeof r.variables[h][A]<"u"&&(i+=" "+r.variables[h][A]+" "+h.replace(_,"_"));i+=" "+c[S]+" "+r.constraints[A][S],i+=`;
`}if(r.ints){i+=`

`;for(var m in r.ints)i+="int "+m.replace(_,"_")+`;
`}if(r.unrestricted){i+=`

`;for(var f in r.unrestricted)i+="unrestricted "+f.replace(_,"_")+`;
`}return i}a.exports=function(r){return r.length?s(r):n(r)}}}),ZT=x({"node_modules/@bygdle/javascript-lp-solver/src/External/lpsolve/main.js"(e){e.reformat=de(),e.solve=function(a){return new Promise(function(s,n){typeof window<"u"&&n("Function Not Available in Browser"),de()(a),a.external||n("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),a.external.binPath||n("No Executable | Binary path provided in arguments as 'binPath'"),a.external.args||n("No arguments array for cli | bash provided on 'args' attribute"),a.external.tempName||n("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on")})}}}),t_=x({"node_modules/@bygdle/javascript-lp-solver/src/External/main.js"(e,a){a.exports={lpsolve:ZT()}}}),ss=x({"node_modules/@bygdle/javascript-lp-solver/src/Polyopt.js"(e,a){a.exports=function(s,n){var r=n.optimize,i=JSON.parse(JSON.stringify(n.optimize)),c=Object.keys(n.optimize),_,u=0,A={},S="",h={},m=[],f,N,L,C;for(delete n.optimize,f=0;f<c.length;f++)i[c[f]]=0;for(f=0;f<c.length;f++){n.optimize=c[f],n.opType=r[c[f]],_=s.Solve(n,void 0,void 0,!0);for(C in c)if(!n.variables[c[C]]){_[c[C]]=_[c[C]]?_[c[C]]:0;for(L in n.variables)n.variables[L][c[C]]&&_[L]&&(_[c[C]]+=_[L]*n.variables[L][c[C]])}for(S="base",N=0;N<c.length;N++)_[c[N]]?S+="-"+(_[c[N]]*1e3|0)/1e3:S+="-0";if(!A[S]){for(A[S]=1,u++,N=0;N<c.length;N++)_[c[N]]&&(i[c[N]]+=_[c[N]]);delete _.feasible,delete _.result,m.push(_)}}for(f=0;f<c.length;f++)n.constraints[c[f]]={equal:i[c[f]]/u};n.optimize="cheater-"+Math.random(),n.opType="max";for(f in n.variables)n.variables[f].cheater=1;for(f in m)for(L in m[f])h[L]=h[L]||{min:1e99,max:-1e99};for(f in h)for(L in m)m[L][f]?(m[L][f]>h[f].max&&(h[f].max=m[L][f]),m[L][f]<h[f].min&&(h[f].min=m[L][f])):(m[L][f]=0,h[f].min=0);return _=s.Solve(n,void 0,void 0,!0),{midpoint:_,vertices:m,ranges:h}}}}),e_=x({"node_modules/@bygdle/javascript-lp-solver/src/main.js"(e,a){var s=QT(),n=XT(),r=as(),i=Ne(),c=JT(),_=i.Constraint,u=i.Variable,A=i.Numeral,S=i.Term,h=t_(),m=function(){this.Model=n,this.branchAndCut=r,this.Constraint=_,this.Variable=u,this.Numeral=A,this.Term=S,this.Tableau=s,this.lastSolvedModel=null,this.External=h,this.ReformatLP=de(),this.MultiObjective=function(f){return ss()(this,f)}};m.prototype.Solve=function(f,N,L,C){if(C)for(var d in c)f=c[d](f);if(!f)throw new Error("Solver requires a model to operate on");if(typeof f.optimize=="object"&&Object.keys(f.optimize>1))return ss()(this,f);if(f.external){var M=Object.keys(h);if(M=JSON.stringify(M),!f.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+M);if(!h[f.external.solver])throw new Error("No support (yet) for "+f.external.solver+". Please use one of these instead:"+M);return h[f.external.solver].solve(f)}else{f instanceof n||(f=new n(N).loadJson(f));var R=f.solve();if(R.solutionSet=R.generateSolutionSet(),L)return R;var O={};return O.feasible=R.feasible,O.result=R.evaluation,O.bounded=R.bounded,R._tableau.__isIntegral&&(O.isIntegral=!0),Object.keys(R.solutionSet).forEach(function(y){R.solutionSet[y]!==0&&(O[y]=R.solutionSet[y])}),O}},typeof define=="function"?define([],function(){return new m}):typeof window=="object"?window.solver=new m:typeof self=="object"&&(self.solver=new m),a.exports=new m}}),Qt={};D(Qt,{Runner:()=>ia,api:()=>ME,artbox:()=>Lt,artifact:()=>I,character:()=>ns,characters:()=>pt,charbox:()=>G,cmd:()=>OT,effect:()=>l,effects:()=>Ee,enemy:()=>rs,food:()=>Ot,foods:()=>Bt,formula:()=>Ss,instance:()=>Xs,optimizer:()=>hE,resonances:()=>tn,rotation:()=>ie,scaling:()=>o,sets:()=>tt,stats:()=>t,store:()=>Yt,strings:()=>T,subject:()=>Es,utils:()=>Kc,weapon:()=>p,weapons:()=>et,worker:()=>xc});var ns={};D(ns,{Character:()=>Be,Export:()=>$s,Import:()=>Qs});var rs={};D(rs,{Enemy:()=>Ts,EnemyConnector:()=>_s,EnemyEvent:()=>ht,Export:()=>De,Import:()=>Jt});var t={};D(t,{AuraToDmg:()=>Ie,DmgToAtkFlat:()=>ge,DmgToAtkPercent:()=>Ce,DmgToAura:()=>n_,DmgToCritDmg:()=>Re,DmgToCritRate:()=>Ge,DmgToFlatDmg:()=>Me,DmgToRes:()=>Xt,Elements:()=>Gt,FlatStats:()=>os,Mainstats:()=>a_,PieceToMainstats:()=>Oe,Substats:()=>vt,Swirlable:()=>s_,TrToDmg:()=>cs,aura:()=>z,piece:()=>st,region:()=>ls,stat:()=>E,weapon:()=>is});function ct(...e){const a={},s={};let n=0;for(const r of e)a[r]=n,s[n]=r,n++;return lt(k({},a),{Get(r){const i=a[r];if(i===void 0)throw new Error(`Stat not found: ${r}`);return i},Name(r){const i=s[r];if(i===void 0)throw new Error(`Stat not found: ${r}`);return i},Has(r){return Object.keys(a).includes(r)},Values(){return Object.values(a)},Length(){return e.length}})}var E=ct("NONE","SHIELDED","ATK","ATK_BASE","ATK_PERCENT","ATK_FLAT","HP_CURRENT","HP","HP_BASE","HP_PERCENT","HP_FLAT","DEF","DEF_BASE","DEF_PERCENT","DEF_FLAT","ENERGY_CURRENT","ELEMENTAL_MASTERY","ENERGY_RECHARGE","HEALING_BONUS","CRIT_RATE","EXTRA_CRIT_RATE","CRIT_DMG","ALL_DMG","DEFIGNORED","DEFREDUCTION","DMG_FLAT","PYRO_DMG","CRYO_DMG","HYDRO_DMG","ELECTRO_DMG","ANEMO_DMG","GEO_DMG","DENDRO_DMG","PHYSICAL_DMG","PYRO_DMG_FLAT","CRYO_DMG_FLAT","HYDRO_DMG_FLAT","ELECTRO_DMG_FLAT","ANEMO_DMG_FLAT","GEO_DMG_FLAT","DENDRO_DMG_FLAT","PHYSICAL_DMG_FLAT","MELT_DMG","VAPORIZE_DMG","SWIRL_DMG","OVERLOAD_DMG","ELECTROCHARGE_DMG","SUPERCONDUCT_DMG","SHATTER_DMG","AGGRAVATE_DMG","SPREAD_DMG","BLOOM_DMG","HYPERBLOOM_DMG","BURGEON_DMG","BURNING_DMG","NORMAL_ATTACK_DMG","CHARGED_ATTACK_DMG","AIMED_SHOT_DMG","CHARGED_AIMED_SHOT_DMG","PLUNGE_ATTACK_DMG","ELEMENTAL_SKILL_DMG","ELEMENTAL_BURST_DMG","NORMAL_ATTACK_DMG_FLAT","CHARGED_ATTACK_DMG_FLAT","AIMED_SHOT_DMG_FLAT","CHARGED_AIMED_SHOT_DMG_FLAT","PLUNGE_ATTACK_DMG_FLAT","ELEMENTAL_SKILL_DMG_FLAT","ELEMENTAL_BURST_DMG_FLAT","NORMAL_ATTACK_LEVEL","ELEMENTAL_SKILL_LEVEL","ELEMENTAL_BURST_LEVEL","NORMAL_ATTACK_LEVEL_UP","ELEMENTAL_SKILL_LEVEL_UP","ELEMENTAL_BURST_LEVEL_UP","NORMAL_ATTACK_ATK_PERCENT","CHARGED_ATTACK_ATK_PERCENT","PLUNGE_ATTACK_ATK_PERCENT","AIMED_SHOT_ATK_PERCENT","CHARGED_AIMED_SHOT_ATK_PERCENT","ELEMENTAL_SKILL_ATK_PERCENT","ELEMENTAL_BURST_ATK_PERCENT","PYRO_ATK_PERCENT","CRYO_ATK_PERCENT","ELECTRO_ATK_PERCENT","HYDRO_ATK_PERCENT","GEO_ATK_PERCENT","ANEMO_ATK_PERCENT","DENDRO_ATK_PERCENT","PHYSICAL_ATK_PERCENT","NORMAL_ATTACK_ATK_FLAT","CHARGED_ATTACK_ATK_FLAT","PLUNGE_ATTACK_ATK_FLAT","AIMED_SHOT_ATK_FLAT","CHARGED_AIMED_SHOT_ATK_FLAT","ELEMENTAL_SKILL_ATK_FLAT","ELEMENTAL_BURST_ATK_FLAT","PYRO_ATK_FLAT","CRYO_ATK_FLAT","ELECTRO_ATK_FLAT","HYDRO_ATK_FLAT","GEO_ATK_FLAT","ANEMO_ATK_FLAT","DENDRO_ATK_FLAT","PHYSICAL_ATK_FLAT","NORMAL_ATTACK_CRIT_RATE","CHARGED_ATTACK_CRIT_RATE","PLUNGE_ATTACK_CRIT_RATE","AIMED_SHOT_CRIT_RATE","CHARGED_AIMED_SHOT_CRIT_RATE","ELEMENTAL_SKILL_CRIT_RATE","ELEMENTAL_BURST_CRIT_RATE","PYRO_CRIT_RATE","CRYO_CRIT_RATE","ELECTRO_CRIT_RATE","HYDRO_CRIT_RATE","GEO_CRIT_RATE","ANEMO_CRIT_RATE","DENDRO_CRIT_RATE","PHYSICAL_CRIT_RATE","NORMAL_ATTACK_CRIT_DMG","CHARGED_ATTACK_CRIT_DMG","PLUNGE_ATTACK_CRIT_DMG","AIMED_SHOT_CRIT_DMG","CHARGED_AIMED_SHOT_CRIT_DMG","ELEMENTAL_SKILL_CRIT_DMG","ELEMENTAL_BURST_CRIT_DMG","PYRO_CRIT_DMG","CRYO_CRIT_DMG","ELECTRO_CRIT_DMG","HYDRO_CRIT_DMG","GEO_CRIT_DMG","ANEMO_CRIT_DMG","DENDRO_CRIT_DMG","PHYSICAL_CRIT_DMG","LEVEL","ASCENSION","PYRO_RES","CRYO_RES","ELECTRO_RES","HYDRO_RES","GEO_RES","ANEMO_RES","DENDRO_RES","PHYSICAL_RES"),z=ct("NONE","PYRO","CRYO","HYDRO","ELECTRO","DENDRO","FROZEN","QUICKEN"),is=ct("SWORD","CLAYMORE","POLEARM","CATALYST","BOW"),st=ct("FLOWER","PLUME","SANDS","GOBLET","CIRCLET"),ls=ct("NONE","MONDSTADT","LIYUE","INAZUMA","SUMERU","FONTAINE","NATLAN","SNEZHNAYA","KHAENRIAH"),Gt=[E.PYRO_DMG,E.CRYO_DMG,E.HYDRO_DMG,E.ELECTRO_DMG,E.ANEMO_DMG,E.GEO_DMG,E.DENDRO_DMG,E.PHYSICAL_DMG],a_=[E.HP_FLAT,E.ATK_FLAT,E.ATK_PERCENT,E.HP_PERCENT,E.DEF_PERCENT,E.ENERGY_RECHARGE,E.ELEMENTAL_MASTERY,E.PYRO_DMG,E.CRYO_DMG,E.HYDRO_DMG,E.ELECTRO_DMG,E.ANEMO_DMG,E.GEO_DMG,E.DENDRO_DMG,E.PHYSICAL_DMG,E.CRIT_RATE,E.CRIT_DMG,E.HEALING_BONUS],vt=[E.DEF_FLAT,E.HP_FLAT,E.ATK_FLAT,E.ATK_PERCENT,E.HP_PERCENT,E.DEF_PERCENT,E.ENERGY_RECHARGE,E.ELEMENTAL_MASTERY,E.CRIT_RATE,E.CRIT_DMG],os=[E.SHIELDED,E.DEF,E.DEF_BASE,E.DEF_FLAT,E.HP,E.HP_BASE,E.HP_FLAT,E.ATK,E.ATK_BASE,E.ATK_FLAT,E.ELEMENTAL_MASTERY,E.DMG_FLAT,E.LEVEL,E.ASCENSION,E.NORMAL_ATTACK_LEVEL,E.ELEMENTAL_SKILL_LEVEL,E.ELEMENTAL_BURST_LEVEL,E.NORMAL_ATTACK_LEVEL_UP,E.ELEMENTAL_SKILL_LEVEL_UP,E.ELEMENTAL_BURST_LEVEL_UP,E.NORMAL_ATTACK_ATK_FLAT,E.CHARGED_ATTACK_ATK_FLAT,E.PLUNGE_ATTACK_ATK_FLAT,E.AIMED_SHOT_ATK_FLAT,E.CHARGED_AIMED_SHOT_ATK_FLAT,E.ELEMENTAL_SKILL_ATK_FLAT,E.ELEMENTAL_BURST_ATK_FLAT,E.PYRO_ATK_FLAT,E.CRYO_ATK_FLAT,E.ELECTRO_ATK_FLAT,E.HYDRO_ATK_FLAT,E.GEO_ATK_FLAT,E.ANEMO_ATK_FLAT,E.DENDRO_ATK_FLAT,E.PHYSICAL_DMG_FLAT,E.NORMAL_ATTACK_DMG_FLAT,E.CHARGED_ATTACK_DMG_FLAT,E.PLUNGE_ATTACK_DMG_FLAT,E.AIMED_SHOT_DMG_FLAT,E.CHARGED_AIMED_SHOT_DMG_FLAT,E.ELEMENTAL_SKILL_DMG_FLAT,E.ELEMENTAL_BURST_DMG_FLAT,E.PYRO_DMG_FLAT,E.CRYO_DMG_FLAT,E.ELECTRO_DMG_FLAT,E.HYDRO_DMG_FLAT,E.GEO_DMG_FLAT,E.ANEMO_DMG_FLAT,E.DENDRO_DMG_FLAT,E.PHYSICAL_DMG_FLAT],s_=[z.CRYO,z.PYRO,z.HYDRO,z.ELECTRO,z.FROZEN];function Ce(e){switch(e){case E.PYRO_DMG:return E.PYRO_ATK_PERCENT;case E.HYDRO_DMG:return E.HYDRO_ATK_PERCENT;case E.CRYO_DMG:return E.CRYO_ATK_PERCENT;case E.ELECTRO_DMG:return E.ELECTRO_ATK_PERCENT;case E.ANEMO_DMG:return E.ANEMO_ATK_PERCENT;case E.GEO_DMG:return E.GEO_ATK_PERCENT;case E.DENDRO_DMG:return E.DENDRO_ATK_PERCENT;case E.PHYSICAL_DMG:return E.PHYSICAL_ATK_PERCENT;case E.NORMAL_ATTACK_DMG:return E.NORMAL_ATTACK_ATK_PERCENT;case E.CHARGED_ATTACK_DMG:return E.CHARGED_ATTACK_ATK_PERCENT;case E.AIMED_SHOT_DMG:return E.AIMED_SHOT_ATK_PERCENT;case E.CHARGED_AIMED_SHOT_DMG:return E.CHARGED_AIMED_SHOT_ATK_PERCENT;case E.PLUNGE_ATTACK_DMG:return E.PLUNGE_ATTACK_ATK_PERCENT;case E.ELEMENTAL_SKILL_DMG:return E.ELEMENTAL_SKILL_ATK_PERCENT;case E.ELEMENTAL_BURST_DMG:return E.ELEMENTAL_BURST_ATK_PERCENT}return E.NONE}function Me(e){switch(e){case E.PYRO_DMG:return E.PYRO_DMG_FLAT;case E.HYDRO_DMG:return E.HYDRO_DMG_FLAT;case E.CRYO_DMG:return E.CRYO_DMG_FLAT;case E.ELECTRO_DMG:return E.ELECTRO_DMG_FLAT;case E.ANEMO_DMG:return E.ANEMO_DMG_FLAT;case E.GEO_DMG:return E.GEO_DMG_FLAT;case E.DENDRO_DMG:return E.DENDRO_DMG_FLAT;case E.PHYSICAL_DMG:return E.PHYSICAL_DMG_FLAT;case E.NORMAL_ATTACK_DMG:return E.NORMAL_ATTACK_DMG_FLAT;case E.CHARGED_ATTACK_DMG:return E.CHARGED_ATTACK_DMG_FLAT;case E.AIMED_SHOT_DMG:return E.AIMED_SHOT_DMG_FLAT;case E.CHARGED_AIMED_SHOT_DMG:return E.CHARGED_AIMED_SHOT_DMG_FLAT;case E.PLUNGE_ATTACK_DMG:return E.PLUNGE_ATTACK_DMG_FLAT;case E.ELEMENTAL_SKILL_DMG:return E.ELEMENTAL_SKILL_DMG_FLAT;case E.ELEMENTAL_BURST_DMG:return E.ELEMENTAL_BURST_DMG_FLAT}return E.NONE}function ge(e){switch(e){case E.PYRO_DMG:return E.PYRO_ATK_FLAT;case E.HYDRO_DMG:return E.HYDRO_ATK_FLAT;case E.CRYO_DMG:return E.CRYO_ATK_FLAT;case E.ELECTRO_DMG:return E.ELECTRO_ATK_FLAT;case E.ANEMO_DMG:return E.ANEMO_ATK_FLAT;case E.GEO_DMG:return E.GEO_ATK_FLAT;case E.DENDRO_DMG:return E.DENDRO_ATK_FLAT;case E.PHYSICAL_DMG:return E.PHYSICAL_ATK_FLAT;case E.NORMAL_ATTACK_DMG:return E.NORMAL_ATTACK_ATK_FLAT;case E.CHARGED_ATTACK_DMG:return E.CHARGED_ATTACK_ATK_FLAT;case E.AIMED_SHOT_DMG:return E.AIMED_SHOT_ATK_FLAT;case E.CHARGED_AIMED_SHOT_DMG:return E.CHARGED_AIMED_SHOT_ATK_FLAT;case E.PLUNGE_ATTACK_DMG:return E.PLUNGE_ATTACK_ATK_FLAT;case E.ELEMENTAL_SKILL_DMG:return E.ELEMENTAL_SKILL_ATK_FLAT;case E.ELEMENTAL_BURST_DMG:return E.ELEMENTAL_BURST_ATK_FLAT}return E.NONE}function Ge(e){switch(e){case E.PYRO_DMG:return E.PYRO_CRIT_RATE;case E.HYDRO_DMG:return E.HYDRO_CRIT_RATE;case E.CRYO_DMG:return E.CRYO_CRIT_RATE;case E.ELECTRO_DMG:return E.ELECTRO_CRIT_RATE;case E.ANEMO_DMG:return E.ANEMO_CRIT_RATE;case E.GEO_DMG:return E.GEO_CRIT_RATE;case E.DENDRO_DMG:return E.DENDRO_CRIT_RATE;case E.PHYSICAL_DMG:return E.PHYSICAL_CRIT_RATE;case E.NORMAL_ATTACK_DMG:return E.NORMAL_ATTACK_CRIT_RATE;case E.CHARGED_ATTACK_DMG:return E.CHARGED_ATTACK_CRIT_RATE;case E.AIMED_SHOT_DMG:return E.AIMED_SHOT_CRIT_RATE;case E.CHARGED_AIMED_SHOT_DMG:return E.CHARGED_AIMED_SHOT_CRIT_RATE;case E.PLUNGE_ATTACK_DMG:return E.PLUNGE_ATTACK_CRIT_RATE;case E.ELEMENTAL_SKILL_DMG:return E.ELEMENTAL_SKILL_CRIT_RATE;case E.ELEMENTAL_BURST_DMG:return E.ELEMENTAL_BURST_CRIT_RATE}return E.NONE}function Re(e){switch(e){case E.PYRO_DMG:return E.PYRO_CRIT_DMG;case E.HYDRO_DMG:return E.HYDRO_CRIT_DMG;case E.CRYO_DMG:return E.CRYO_CRIT_DMG;case E.ELECTRO_DMG:return E.ELECTRO_CRIT_DMG;case E.ANEMO_DMG:return E.ANEMO_CRIT_DMG;case E.GEO_DMG:return E.GEO_CRIT_DMG;case E.DENDRO_DMG:return E.DENDRO_CRIT_DMG;case E.PHYSICAL_DMG:return E.PHYSICAL_CRIT_DMG;case E.NORMAL_ATTACK_DMG:return E.NORMAL_ATTACK_CRIT_DMG;case E.CHARGED_ATTACK_DMG:return E.CHARGED_ATTACK_CRIT_DMG;case E.AIMED_SHOT_DMG:return E.AIMED_SHOT_CRIT_DMG;case E.CHARGED_AIMED_SHOT_DMG:return E.CHARGED_AIMED_SHOT_CRIT_DMG;case E.PLUNGE_ATTACK_DMG:return E.PLUNGE_ATTACK_CRIT_DMG;case E.ELEMENTAL_SKILL_DMG:return E.ELEMENTAL_SKILL_CRIT_DMG;case E.ELEMENTAL_BURST_DMG:return E.ELEMENTAL_BURST_CRIT_DMG}return E.NONE}function Xt(e){switch(e){case E.PYRO_DMG:return E.PYRO_RES;case E.HYDRO_DMG:return E.HYDRO_RES;case E.CRYO_DMG:return E.CRYO_RES;case E.ELECTRO_DMG:return E.ELECTRO_RES;case E.ANEMO_DMG:return E.ANEMO_RES;case E.GEO_DMG:return E.GEO_RES;case E.DENDRO_DMG:return E.DENDRO_RES;case E.PHYSICAL_DMG:return E.PHYSICAL_RES}return E.NONE}function Ie(e){switch(e){case z.PYRO:return E.PYRO_DMG;case z.HYDRO:return E.HYDRO_DMG;case z.CRYO:return E.CRYO_DMG;case z.FROZEN:return E.CRYO_DMG;case z.ELECTRO:return E.ELECTRO_DMG;case z.DENDRO:return E.DENDRO_DMG;case z.QUICKEN:return E.DENDRO_DMG}return E.NONE}function n_(e){switch(e){case E.PYRO_DMG:return z.PYRO;case E.HYDRO_DMG:return z.HYDRO;case E.CRYO_DMG:return z.CRYO;case E.ELECTRO_DMG:return z.ELECTRO;case E.DENDRO_DMG:return z.DENDRO}return E.NONE}function cs(e){switch(e){case E.OVERLOAD_DMG:return E.PYRO_DMG;case E.ELECTROCHARGE_DMG:return E.ELECTRO_DMG;case E.SUPERCONDUCT_DMG:return E.CRYO_DMG;case E.SHATTER_DMG:return E.PHYSICAL_DMG;case E.BURNING_DMG:return E.PYRO_DMG;case E.BURGEON_DMG:return E.DENDRO_DMG;case E.BLOOM_DMG:return E.DENDRO_DMG;case E.HYPERBLOOM_DMG:return E.DENDRO_DMG}return E.NONE}function Oe(e){switch(e){case st.FLOWER:return[E.HP_FLAT];case st.PLUME:return[E.ATK_FLAT];case st.SANDS:return[E.ATK_PERCENT,E.HP_PERCENT,E.DEF_PERCENT,E.ENERGY_RECHARGE,E.ELEMENTAL_MASTERY];case st.GOBLET:return[E.ATK_PERCENT,E.HP_PERCENT,E.DEF_PERCENT,E.ELEMENTAL_MASTERY,...Gt];case st.CIRCLET:return[E.ATK_PERCENT,E.HP_PERCENT,E.DEF_PERCENT,E.ELEMENTAL_MASTERY,E.CRIT_RATE,E.CRIT_DMG,E.HEALING_BONUS]}return[]}var Es={};D(Es,{Subject:()=>_t});var _t=class{constructor(e,a){this.Title=a,this.props=new Float64Array(e),this.observers=Array.from(Array(e)).fill(0).map(()=>[])}Length(){return this.props.length}Get(e){const a=this.props[e];if(a===void 0)throw new Error(`Subject property out of bounds: ${e}`);return a}Set(e,a,s){return this.props[e]=a,this.Notify(e,s)}Notify(e,a){for(const s of this.observers[e])s.Enabled()&&s.Notify(a);return this}CreateObserver(e,a){let s=!0;const n={prop:e,Enabled(){return s},Enable(){return s=!0,n},Disable(){return s=!1,n},Remove:()=>this.RemoveObserver(n),Notify(r){return a(r),n}};return this.observers[e].push(n),n}RemoveObserver(e){const a=this.observers[e.prop].indexOf(e);return a===-1?!1:(this.observers[e.prop].splice(a,1),!0)}CreateModifier(e,a){let s=!1;const n={Title:this.Title,Enabled(){return s},Enable:()=>(s||(this.Set(e,this.Get(e)+a,n),s=!0),n),Disable:()=>(s&&(this.Set(e,this.Get(e)-a,n),s=!1),n),GetProp(){return e},GetValue(){return a},SetProp(r){const i=s;return n.Disable(),e=r,i&&n.Enable(),n},SetValue(r){const i=s;return n.Disable(),a=r,i&&n.Enable(),n}};return n.Enable(),n}},ht=ct("CHANGE_AURA","CHANGE_BASE_RES"),Ts=class{constructor(e){this.name=e,this.Event=new _t(ht.Length(),"ENEMY_EVENT"),this.Subject=new _t(E.Length(),"ENEMY_STATS"),this.auras=[],this.baseMods=Gt.map(a=>this.Subject.CreateModifier(Xt(a),.1)),this.SetLevel(90)}GetLevel(){return this.Subject.Get(E.LEVEL)}SetLevel(e){return this.Subject.Set(E.LEVEL,e),this}Affected(e){for(const a of this.auras)if(Ie(a)===e)return!0;return!1}HasAura(e){return this.auras.includes(e)}SetAuras(...e){return this.auras=e,this.Event.Notify(ht.CHANGE_AURA),this}GetAuras(){return this.auras}GetBaseRes(e){const a=this.baseMods.find(s=>s.GetProp()===e);if(!a)throw new Error(`Cannot find the given RES: ${e}`);return a.GetValue()}SetBaseRes(e,a){const s=this.baseMods.find(n=>n.GetProp()===e);if(!s)throw new Error(`Cannot find the given RES: ${e}`);return s.SetValue(a),this.Event.Notify(ht.CHANGE_BASE_RES),this}};function De(e){const a={level:e.GetLevel(),auras:e.GetAuras(),modifiers:[]};for(const s of Gt){const n=Xt(s),r=e.GetBaseRes(n);a.modifiers.push({stat:n,value:r})}return a}function Jt(e,a){a.SetLevel(e.level),a.SetAuras(...e.auras);for(const{stat:s,value:n}of e.modifiers)a.SetBaseRes(s,n)}var _s=class{constructor(...e){this.members=new Set,this.observers=new Map,this.updating=!1,e.forEach(a=>this.Add(a))}onChange(e){if(this.updating)return;const a=this.state=De(e);this.updating=!0;for(const s of this.members)s!==e&&Jt(a,s);this.updating=!1}Add(e){if(this.members.has(e))return!1;const a=this.members.size===0;this.members.add(e),!a&&this.state&&Jt(this.state,e);const s=()=>this.onChange(e);return this.observers.set(e,[e.Subject.CreateObserver(E.LEVEL,s),e.Event.CreateObserver(ht.CHANGE_AURA,s),e.Event.CreateObserver(ht.CHANGE_BASE_RES,s)]),!0}Remove(e){this.members.delete(e);const a=this.observers.get(e);!a||(a.forEach(s=>s.Remove()),this.observers.delete(e))}},yt=[20,40,50,60,70,80,90];function Zt(e){e<0?e=0:e>90&&(e=90);for(let a=0;a<yt.length;a++){const s=yt[a];if(e<=s)return a}return 0}function Rt(e){e<0?e=0:e>90&&(e=90);for(let a=0;a<yt.length;a++){const s=yt[a];if(e===s){let n=a+1;return n>6&&(n=6),n}else if(e<=s)return a}return 0}function us(e){return e<0?e=0:e>6&&(e=6),yt[e]}var As={[E.PYRO_DMG]:3,[E.CRYO_DMG]:2,[E.ELECTRO_DMG]:1};function r_(e){return[...e].sort((s,n)=>{const r=s.Max?1/0:As[s.Element]||0;return(n.Max?1/0:As[n.Element]||0)-r}).filter(s=>s.Enabled)[0]}var Ss={};D(Ss,{AmpBonus:()=>Ys,AmpType:()=>xs,CritAvg:()=>Bs,CritType:()=>Vs,Damage:()=>zs,DamageOptions:()=>js,DamageStats:()=>Ws,Def:()=>Ks,QuickenBonus:()=>we,QuickenType:()=>Us,Res:()=>bs,Rotation:()=>qs,TotalStat:()=>wt,TrBase:()=>te,TrBonus:()=>Fs,TrMultiplier:()=>ks});var o={};D(o,{ASCENSION_MULTIPLIER:()=>Ls,AddCharacterScaling:()=>ds,AddTalentScaling:()=>Ms,BONUS_ASCENSION_MULTIPLIER:()=>ve,BONUS_STAT_4:()=>ps,BONUS_STAT_5:()=>Ns,CHARACTER_ATTRIBUTE_4:()=>ms,CHARACTER_ATTRIBUTE_5:()=>fs,GetMainstatValue:()=>Ps,GetMaxRolls:()=>__,GetSubstatMax:()=>Pe,GetSubstatMaxRolls:()=>He,GetSubstatValue:()=>nt,GetWeaponAtkBase:()=>ys,GetWeaponSubstat:()=>Hs,SubstatTier:()=>ws,TRANSFORMATIVE:()=>hs,TalentScaling:()=>Cs,WEAPON_ATK_BASE:()=>Gs,WEAPON_ATK_BASE_ASCENSION_3:()=>Rs,WEAPON_ATK_BASE_ASCENSION_4:()=>Is,WEAPON_ATK_BASE_ASCENSION_5:()=>Os,WEAPON_SUBSTAT_INITIAL:()=>vs,WEAPON_SUBSTAT_SCALING:()=>Ds,WeaponScaling:()=>gs});function i_(e){return e}var hs=[8.5828025,9.267524,9.952427,10.6374515,11.3227,12.3248065,13.3203215,14.4342935,15.6838395,17.0716715,18.6005,20.33,22.223334,24.2817595,26.87424,29.5409485,32.2100235,34.8622275,37.5615685,40.2923875,43.056014,45.851871,48.622314,51.406322,54.2047815,56.600847,59.051453,61.489659,64.863665,68.146455,71.335425,74.5145145,77.7084935,80.9127475,84.5531565,88.2590385,92.0363705,95.854759,99.778454,103.691021,107.69945,112.0828335,116.75108,121.6752865,128.0315335,134.2717465,140.7630375,147.506824,154.533594,161.8007985,168.378771,175.265156,182.2413525,189.3095905,199.3002085,208.199127,217.193498,226.4755255,236.3031085,246.442445,256.7842715,269.551599,282.7552815,296.2693765,312.2217135,325.735074,339.748415,353.89703,368.335711,382.8201155,397.3867015,412.3386985,425.5788905,438.871045,457.1145615,473.373376,489.705693,505.611511,522.395873,538.721834,554.99877,571.4883075,588.1847415,605.0921965,626.9178295,644.4764005,662.742046,681.728464,702.5486885,723.426729,744.1077735,764.2222835,790.1839555,815.423764,855.5988925,890.2269705,923.6614045,955.7371545,986.432171,1015.035904],ms=[1,1.083,1.165,1.248,1.33,1.413,1.495,1.578,1.661,1.743,1.826,1.908,1.991,2.073,2.156,2.239,2.321,2.404,2.486,2.569,2.651,2.734,2.817,2.899,2.982,3.064,3.147,3.229,3.312,3.394,3.477,3.56,3.642,3.725,3.807,3.89,3.972,4.055,4.138,4.22,4.303,4.385,4.468,4.55,4.633,4.716,4.798,4.881,4.963,5.046,5.128,5.211,5.294,5.376,5.459,5.541,5.624,5.706,5.789,5.872,5.954,6.037,6.119,6.202,6.284,6.367,6.45,6.532,6.615,6.697,6.78,6.862,6.945,7.028,7.11,7.193,7.275,7.358,7.44,7.523,7.606,7.688,7.771,7.853,7.936,8.018,8.101,8.183,8.266,8.349],fs=[1,1.083,1.166,1.25,1.333,1.417,1.5,1.584,1.668,1.751,1.835,1.919,2.003,2.088,2.172,2.256,2.341,2.425,2.51,2.594,2.679,2.764,2.849,2.934,3.019,3.105,3.19,3.275,3.361,3.446,3.532,3.618,3.704,3.789,3.875,3.962,4.048,4.134,4.22,4.307,4.393,4.48,4.567,4.653,4.74,4.827,4.914,5.001,5.089,5.176,5.263,5.351,5.438,5.526,5.614,5.702,5.79,5.878,5.966,6.054,6.142,6.23,6.319,6.407,6.496,6.585,6.673,6.762,6.851,6.94,7.029,7.119,7.208,7.297,7.387,7.476,7.566,7.656,7.746,7.836,7.926,8.016,8.106,8.196,8.286,8.377,8.467,8.558,8.649,8.739],Ls=[38/182,65/182,101/182,128/182,155/182,1],ve=[0,1,2,2,3,4],ps={[E.ATK_PERCENT]:.06,[E.HP_PERCENT]:.06,[E.DEF_PERCENT]:.075,[E.PHYSICAL_DMG]:.075,[E.ENERGY_RECHARGE]:.067,[E.ELEMENTAL_MASTERY]:24,[E.PYRO_DMG]:.06,[E.CRYO_DMG]:.06,[E.HYDRO_DMG]:.06,[E.ELECTRO_DMG]:.06,[E.ANEMO_DMG]:.06,[E.GEO_DMG]:.06,[E.DENDRO_DMG]:.06,[E.PHYSICAL_DMG]:.06},Ns={[E.ATK_PERCENT]:.072,[E.HP_PERCENT]:.072,[E.PHYSICAL_DMG]:0,[E.ENERGY_RECHARGE]:.08,[E.ELEMENTAL_MASTERY]:28.8,[E.HEALING_BONUS]:.055,[E.CRIT_RATE]:.048,[E.CRIT_DMG]:.096,[E.PYRO_DMG]:.072,[E.CRYO_DMG]:.072,[E.HYDRO_DMG]:.072,[E.ELECTRO_DMG]:.072,[E.ANEMO_DMG]:.072,[E.GEO_DMG]:.072,[E.DENDRO_DMG]:.072,[E.PHYSICAL_DMG]:.072};function ds(e,a){const s=e.CreateModifier(E.ATK_BASE,0),n=e.CreateModifier(E.DEF_BASE,0),r=e.CreateModifier(E.HP_BASE,0),i=e.CreateModifier(a.StatBonus,0);a.Scaling||(e.Options.Stars===4?a.Scaling=ms:a.Scaling=fs);const c=a.Scaling,_=()=>{s.SetValue(ye(c,a.AtkBase[0],a.AtkBase[1],e.GetLevel(),e.GetAscension())),n.SetValue(ye(c,a.DefBase[0],a.DefBase[1],e.GetLevel(),e.GetAscension())),r.SetValue(ye(c,a.HpBase[0],a.HpBase[1],e.GetLevel(),e.GetAscension())),i.SetValue(c_(e.Options.Stars,a.StatBonus,e.GetAscension()))};return _(),e.CreateObserver(E.LEVEL,_),e.CreateObserver(E.ASCENSION,_),e}function l_(e,a){return e[a-1]}function o_(e){const a=e-1;return a<0?0:Ls[a]}function ye(e,a,s,n,r){return a*l_(e,n)+s*o_(r)}function c_(e,a,s){const n=s-1;return n<0?0:e===4?ps[a]*ve[n]:Ns[a]*ve[n]}var Cs={NONE:Array.from(Array(15)).fill(1),PHYSICAL_1:[1,1.081,1.163,1.279,1.36,1.453,1.581,1.709,1.837,1.977,2.116,2.256,2.395,2.535,2.674],PHYSICAL_1A:[1,1.081,1.163,1.279,1.36,1.453,1.581,1.709,1.837,1.977,2.137,2.325,2.513,2.701,2.906],PHYSICAL_2:[1,1.068,1.136,1.227,1.295,1.375,1.477,1.58,1.682,1.784,1.886,1.989,2.091,2.193,2.295],ELEMENTAL_1:[1,1.075,1.15,1.25,1.325,1.4,1.5,1.6,1.7,1.8,1.9,2,2.125,2.25,2.375],ELEMENTAL_1A:[1,1.075,1.15,1.25,1.325,1.4,1.5,1.6,1.7,1.8,1.904,2.04,2.176,2.312,2.448],ELEMENTAL_2:[1,1.06,1.12,1.198,1.257,1.317,1.395,1.473,1.551,1.629,1.707,1.784,1.862,1.94,2.018],FLAT_1:[1,1.1,1.208,1.325,1.45,1.583,1.725,1.875,2.033,2.2,2.375,2.559,2.75,2.95,3.159]};function Ms(e,a){const s=[],n=e.Base.CreateMv(a.Stat,0),r=()=>{let c=e.Get(a.Talent);c<1?c=1:c>15&&(c=15),n.Value=a.Initial*a.Scaling[c-1]};r();const i=e.Character;switch(s.push(i.CreateObserver(a.Talent,r)),a.Talent){case E.NORMAL_ATTACK_LEVEL:s.push(i.CreateObserver(E.NORMAL_ATTACK_LEVEL_UP,r));break;case E.ELEMENTAL_SKILL_LEVEL:s.push(i.CreateObserver(E.ELEMENTAL_SKILL_LEVEL_UP,r));break;case E.ELEMENTAL_BURST_LEVEL:s.push(i.CreateObserver(E.ELEMENTAL_BURST_LEVEL_UP,r));break}return s}var gs=(e=>(e[e.TYPE_38=0]="TYPE_38",e[e.TYPE_39=1]="TYPE_39",e[e.TYPE_40=2]="TYPE_40",e[e.TYPE_39b=3]="TYPE_39b",e[e.TYPE_41=4]="TYPE_41",e[e.TYPE_42=5]="TYPE_42",e[e.TYPE_44=6]="TYPE_44",e[e.TYPE_45=7]="TYPE_45",e[e.TYPE_44b=8]="TYPE_44b",e[e.TYPE_46=9]="TYPE_46",e[e.TYPE_48=10]="TYPE_48",e[e.TYPE_49=11]="TYPE_49",e))(gs||{}),Gs={[0]:[37.6075,40.13116315789474,42.65482631578948,45.17848947368421,47.70215263157895,50.225815789473685,52.749478947368424,55.27314210526316,57.79680526315789,60.32046842105264,62.84413157894737,65.36779473684211,67.89145789473685,70.41512105263158,72.93878421052631,75.46244736842105,77.9861105263158,80.50977368421053,83.03343684210526,85.5571,87.86808,90.17906,92.49004000000001,94.80102000000001,97.11200000000001,99.42298000000001,101.73396,104.04494,106.35592,108.6669,110.97788,113.28886,115.59984,117.91082,120.2218,122.53278,124.84376,127.15474,129.46572,131.7767,133.97050000000002,136.1643,138.3581,140.5519,142.7457,144.9395,147.1333,149.3271,151.52089999999998,153.7147,155.86208,158.00946,160.15684,162.30422,164.45159999999998,166.59898,168.74636,170.89374,173.04112,175.1885,177.28829000000002,179.38808,181.48787,183.58766,185.68745,187.78724,189.88702999999998,191.98682,194.08661,196.1864,198.26233,200.33826,202.41419,204.49012,206.56605,208.64198,210.71791,212.79384,214.86977,216.9457,218.98907,221.03243999999998,223.07581,225.11918,227.16255,229.20592,231.24929,233.29266,235.33603,237.3794],[1]:[38.7413,41.636700000000005,44.5321,47.4275,50.322900000000004,53.2183,56.1137,59.009100000000004,61.9045,64.79990000000001,67.6953,70.5907,73.4861,76.3815,79.27690000000001,82.1723,85.0677,87.9631,90.85849999999999,93.7539,96.5549,99.3559,102.15690000000001,104.9579,107.7589,110.5599,113.3609,116.1619,118.96289999999999,121.7639,124.5649,127.3659,130.1669,132.9679,135.7689,138.5699,141.3709,144.1719,146.97289999999998,149.7739,152.50678,155.23966,157.97254,160.70542,163.4383,166.17118,168.90406,171.63694,174.36982,177.1027,179.81459,182.52648,185.23837,187.95026,190.66215,193.37403999999998,196.08593,198.79782,201.50970999999998,204.2216,206.90025,209.5789,212.25755,214.9362,217.61485,220.2935,222.97215,225.6508,228.32945,231.0081,233.68512,236.36214,239.03916,241.71618,244.3932,247.07022,249.74724,252.42426,255.10128,257.7783,260.42983,263.08136,265.73289,268.38442000000003,271.03595,273.68748,276.33901000000003,278.99054,281.64207000000005,284.2936],[2]:[39.8751,43.142757894736846,46.41041578947369,49.67807368421053,52.945731578947374,56.21338947368422,59.48104736842105,62.748705263157895,66.01636315789474,69.28402105263157,72.55167894736843,75.81933684210526,79.0869947368421,82.35465263157894,85.62231052631579,88.88996842105263,92.15762631578947,95.42528421052631,98.69294210526316,101.9606,105.248305,108.53601,111.82371499999999,115.11142,118.399125,121.68683,124.974535,128.26224,131.549945,134.83765,138.125355,141.41306,144.700765,147.98847,151.276175,154.56387999999998,157.851585,161.13929,164.426995,167.7147,170.99041,174.26612,177.54183,180.81754,184.09325,187.36896000000002,190.64467,193.92038,197.19609,200.4718,203.74953,207.02726,210.30499,213.58272,216.86045000000001,220.13818,223.41591,226.69364,229.97137,233.2491,236.51284,239.77658,243.04032,246.30406,249.5678,252.83154000000002,256.09528,259.35902,262.62276,265.8865,269.15626000000003,272.42602,275.69578,278.96554,282.2353,285.50506,288.77482,292.04458,295.31433999999996,298.5841,301.84785,305.1116,308.37534999999997,311.6391,314.90285,318.1666,321.43035000000003,324.6941,327.95785,331.2216],[3]:[38.7413,41.636700000000005,44.5321,47.4275,50.322900000000004,53.2183,56.1137,59.009100000000004,61.9045,64.79990000000001,67.6953,70.5907,73.4861,76.3815,79.27690000000001,82.1723,85.0677,87.9631,90.85849999999999,93.7539,96.5549,99.3559,102.15690000000001,104.9579,107.7589,110.5599,113.3609,116.1619,118.96289999999999,121.7639,124.5649,127.3659,130.1669,132.9679,135.7689,138.5699,141.3709,144.1719,146.97289999999998,149.7739,152.52678,155.27966,158.03253999999998,160.78542,163.5383,166.29118,169.04406,171.79693999999998,174.54981999999998,177.3027,180.01459,182.72647999999998,185.43837,188.15026,190.86214999999999,193.57404,196.28593,198.99782000000002,201.70971,204.4216,207.11025,209.7989,212.48755,215.1762,217.86485,220.55349999999999,223.24215,225.9308,228.61945,231.3081,233.99512,236.68214,239.36916,242.05617999999998,244.7432,247.43022,250.11723999999998,252.80425999999997,255.49128,258.1783,260.83983,263.50136,266.16289,268.82442,271.48595,274.14748000000003,276.80901,279.47054,282.13207,284.7936],[4]:[41.0671,44.129842105263165,47.19258421052632,50.255326315789475,53.31806842105264,56.3808105263158,59.44355263157895,62.50629473684211,65.56903684210528,68.63177894736843,71.69452105263159,74.75726315789476,77.8200052631579,80.88274736842106,83.94548947368422,87.00823157894737,90.07097368421054,93.13371578947368,96.19645789473685,99.2592,102.18523,105.11126,108.03729000000001,110.96332000000001,113.88935000000001,116.81538,119.74141,122.66744,125.59347,128.5195,131.44553,134.37156,137.29759,140.22361999999998,143.14965,146.07568,149.00171,151.92774,154.85377,157.7798,160.65627999999998,163.53276,166.40924,169.28572,172.16219999999998,175.03868,177.91516000000001,180.79164,183.66812,186.5446,189.38234,192.22008,195.05782,197.89556,200.73329999999999,203.57103999999998,206.40878,209.24652,212.08426,214.922,217.7351,220.5482,223.3613,226.1744,228.9875,231.8006,234.6137,237.4268,240.2399,243.053,245.86377,248.67454,251.48531,254.29608000000002,257.10685,259.91762,262.72839,265.53916000000004,268.34993000000003,271.1607,273.94095000000004,276.7212,279.50145,282.2817,285.06195,287.8422,290.62244999999996,293.4027,296.18295,298.9632],[5]:[42.401,45.90243157894737,49.40386315789474,52.90529473684211,56.40672631578948,59.908157894736846,63.40958947368421,66.91102105263158,70.41245263157894,73.91388421052632,77.41531578947368,80.91674736842106,84.41817894736842,87.91961052631578,91.42104210526315,94.92247368421053,98.42390526315789,101.92533684210525,105.42676842105263,108.9282,112.42840000000001,115.9286,119.4288,122.929,126.42920000000001,129.9294,133.4296,136.9298,140.43,143.9302,147.4304,150.9306,154.4308,157.93099999999998,161.4312,164.9314,168.4316,171.9318,175.432,178.9322,182.44453,185.95686,189.46919,192.98152,196.49385,200.00618,203.51851,207.03083999999998,210.54317,214.0555,217.55782,221.06014,224.56246,228.06477999999998,231.56709999999998,235.06941999999998,238.57174,242.07406,245.57638,249.0787,252.57677999999999,256.07486,259.57294,263.07102,266.5691,270.06718,273.56526,277.06334000000004,280.56142,284.0595,287.57182,291.08414,294.59646000000004,298.10878,301.6211,305.13342,308.64574,312.15806000000003,315.67038,319.1827,322.68503,326.18736,329.68969000000004,333.19202,336.69435,340.19668,343.69901000000004,347.20134,350.70367,354.206],[6]:[43.7349,47.67334210526316,51.61178421052632,55.55022631578947,59.48866842105264,63.42711052631579,67.36555263157895,71.30399473684211,75.24243684210526,79.18087894736843,83.11932105263159,87.05776315789474,90.99620526315789,94.93464736842105,98.87308947368422,102.81153157894738,106.74997368421053,110.68841578947368,114.62685789473684,118.5653,122.64139499999999,126.71749,130.793585,134.86968,138.945775,143.02187,147.097965,151.17406,155.250155,159.32625000000002,163.402345,167.47844,171.554535,175.63063,179.706725,183.78282000000002,187.858915,191.93501,196.011105,200.0872,204.23452,208.38183999999998,212.52916,216.67648,220.8238,224.97111999999998,229.11844,233.26576,237.41307999999998,241.5604,245.72395999999998,249.88752,254.05108,258.21464000000003,262.3782,266.54176,270.70532000000003,274.86888,279.03244,283.196,287.38581000000005,291.57562,295.76543000000004,299.95524,304.14505,308.33486000000005,312.52467,316.71448000000004,320.90429,325.0941,329.30702,333.51994,337.73286,341.94578,346.1587,350.37162,354.58454,358.79746,363.01038,367.2233,371.43934,375.65538,379.87142,384.08745999999996,388.3035,392.51954,396.73557999999997,400.95162,405.16765999999996,409.3837],[7]:[45.0687,49.44510526315789,53.82151052631579,58.19791578947368,62.574321052631575,66.95072631578947,71.32713157894736,75.70353684210527,80.07994210526316,84.45634736842105,88.83275263157896,93.20915789473685,97.58556315789474,101.96196842105263,106.33837368421052,110.71477894736842,115.09118421052631,119.4675894736842,123.84399473684209,128.2204,132.87149000000002,137.52258,142.17367000000002,146.82476,151.47585,156.12694,160.77803,165.42912,170.08021,174.7313,179.38239,184.03348,188.68457,193.33566000000002,197.98675,202.63783999999998,207.28893,211.94002,216.59111000000001,221.2422,226.02498,230.80776,235.59054,240.37332,245.15609999999998,249.93887999999998,254.72165999999999,259.50444,264.28722,269.07,273.89686,278.72372,283.55057999999997,288.37744,293.2043,298.03116,302.85802,307.68487999999996,312.51174,317.3386,322.21052,327.08243999999996,331.95436,336.82628,341.6982,346.57012,351.44203999999996,356.31396,361.18588,366.0578,370.97578,375.89376,380.81174,385.72972,390.6477,395.56568,400.48366,405.40164,410.31962,415.2376,420.17714,425.11668,430.05622,434.99575999999996,439.9353,444.87484,449.81437999999997,454.75392,459.69345999999996,464.633],[8]:[44.3358,47.80099473684211,51.26618947368421,54.731384210526315,58.196578947368415,61.66177368421052,65.12696842105262,68.59216315789473,72.05735789473684,75.52255263157895,78.98774736842105,82.45294210526315,85.91813684210526,89.38333157894735,92.84852631578946,96.31372105263156,99.77891578947367,103.24411052631578,106.70930526315789,110.1745,113.601655,117.02881,120.45596499999999,123.88311999999999,127.31027499999999,130.73743,134.164585,137.59174,141.018895,144.44605,147.87320499999998,151.30036,154.72751499999998,158.15467,161.581825,165.00898,168.436135,171.86329,175.290445,178.7176,182.17136,185.62512,189.07888,192.53264000000001,195.9864,199.44016,202.89392,206.34768,209.80144,213.2552,216.74556,220.23592,223.72628,227.21664,230.707,234.19736,237.68772,241.17808000000002,244.66844,248.1588,251.6835,255.2082,258.73290000000003,262.2576,265.7823,269.307,272.8317,276.3564,279.8811,283.4058,286.97039,290.53498,294.09956999999997,297.66416,301.22875,304.79334,308.35793,311.92251999999996,315.48711,319.0517,322.66951,326.28731999999997,329.90513,333.52294,337.14075,340.75856,344.37637,347.99418000000003,351.61199,355.2298],[9]:[45.9364,49.92561578947368,53.914831578947364,57.90404736842105,61.89326315789474,65.88247894736841,69.8716947368421,73.86091052631579,77.85012631578947,81.83934210526316,85.82855789473683,89.81777368421052,93.80698947368421,97.79620526315789,101.78542105263158,105.77463684210525,109.76385263157894,113.75306842105263,117.74228421052632,121.7315,125.849695,129.96789,134.086085,138.20428,142.322475,146.44067,150.558865,154.67706,158.795255,162.91345,167.031645,171.14984,175.268035,179.38623,183.50442500000003,187.62262,191.740815,195.85901,199.97720500000003,204.0954,208.30777,212.52014,216.73251000000002,220.94488,225.15725,229.36962,233.58199,237.79435999999998,242.00673,246.2191,250.51037,254.80164,259.09291,263.38418,267.67545,271.96672,276.25799,280.54926,284.84053,289.1318,293.47739,297.82298,302.16857,306.51416,310.85974999999996,315.20534,319.55093,323.89652,328.24210999999997,332.5877,337.00219,341.41668,345.83117,350.24566,354.66015,359.07464,363.48913,367.90362,372.31811,376.7326,381.2068,385.681,390.1552,394.6294,399.10360000000003,403.5778,408.052,412.5262,417.0004,421.4746],[10]:[47.537,52.05051052631579,56.564021052631574,61.077531578947365,65.59104210526316,70.10455263157894,74.61806315789474,79.13157368421052,83.6450842105263,88.1585947368421,92.6721052631579,97.18561578947367,101.69912631578947,106.21263684210527,110.72614736842104,115.23965789473684,119.75316842105264,124.2666789473684,128.7801894736842,133.2937,138.10207,142.91044,147.71881,152.52718,157.33555,162.14391999999998,166.95229,171.76066,176.56903,181.3774,186.18577,190.99414,195.80250999999998,200.61088,205.41924999999998,210.22762,215.03598999999997,219.84436,224.65273,229.4611,234.43822,239.41534,244.39246,249.36957999999998,254.3467,259.32382,264.30094,269.27806,274.25518,279.2323,284.31925,289.4062,294.49315,299.5801,304.66705,309.754,314.84095,319.9279,325.01485,330.1018,335.27383000000003,340.44586000000004,345.61789,350.78992,355.96195,361.13398,366.30601,371.47803999999996,376.65006999999997,381.8221,387.07493999999997,392.32777999999996,397.58062,402.83346,408.0863,413.33914,418.59198,423.84482,429.09766,434.3505,439.6889,445.0273,450.3657,455.70410000000004,461.0425,466.3809,471.71930000000003,477.0577,482.39610000000005,487.7345],[11]:[49.1377,54.17819473684211,59.218689473684215,64.25918421052631,69.29967894736842,74.34017368421053,79.38066842105263,84.42116315789474,89.46165789473685,94.50215263157895,99.54264736842106,104.58314210526316,109.62363684210527,114.66413157894738,119.70462631578948,124.74512105263159,129.7856157894737,134.8261105263158,139.8666052631579,144.9071,150.40315,155.8992,161.39525,166.8913,172.38735000000003,177.8834,183.37945000000002,188.87550000000002,194.37155,199.8676,205.36365,210.8597,216.35575,221.85180000000003,227.34785,232.84390000000002,238.33995,243.836,249.33205,254.8281,260.56738,266.30666,272.04594,277.78522,283.5245,289.26378,295.00306,300.74233999999996,306.48161999999996,312.2209,318.10776999999996,323.99464,329.88151,335.76838,341.65525,347.54212,353.42899,359.31586,365.20273000000003,371.0896,377.07949,383.06938,389.05927,395.04916000000003,401.03905,407.02894000000003,413.01883,419.00872,424.99861,430.9885,437.09139999999996,443.1943,449.2972,455.4001,461.503,467.6059,473.7088,479.8117,485.9146,492.0175,498.21376999999995,504.41004,510.60631,516.80258,522.99885,529.19512,535.39139,541.5876599999999,547.7839299999999,553.9802]},Rs=19.5,Is=25.9,Os=31.1,Ds=[1,1.040341234845879,1.0806824696917579,1.1210237045376368,1.1613649393835157,1.2017061742293946,1.2420474090752736,1.2823886439211527,1.3227298787670316,1.3630711136129106,1.4034123484587895,1.4437535833046684,1.4840948181505473,1.5244360529964263,1.5647772878423054,1.6051185226881843,1.6454597575340633,1.6858009923799422,1.7261422272258211,1.7664834620717,1.806904148964199,1.847324835856698,1.887745522749197,1.928166209641696,1.968586896534195,2.009007583426694,2.049428270319193,2.089848957211692,2.130269644104191,2.17069033099669,2.211111017889189,2.251531704781688,2.291952391674187,2.332373078566686,2.372793765459185,2.413214452351684,2.453635139244183,2.494055826136682,2.534476513029181,2.57489719992168,2.615292358123214,2.655687516324748,2.696082674526282,2.7364778327278163,2.77687299092935,2.817268149130884,2.8576633073324182,2.898058465533952,2.9384536237354864,2.97884878193702,3.0192357768865152,3.0596227718360103,3.1000097667855053,3.1403967617350004,3.1807837566844954,3.22117075163399,3.261557746583485,3.30194474153298,3.342331736482475,3.38271873143197,3.423020746682514,3.463322761933058,3.503624777183602,3.543926792434146,3.58422880768469,3.624530822935234,3.664832838185778,3.705134853436322,3.745436868686866,3.78573888393741,3.82613895285716,3.86653902177691,3.90693909069666,3.94733915961641,3.98773922853616,4.02813929745591,4.06853936637566,4.10893943529541,4.14933950421516,4.18973957313491,4.230135108674366,4.270530644213822,4.310926179753277,4.351321715292734,4.3917172508321904,4.432112786371646,4.472508321911102,4.512903857450558,4.553299392990015,4.59369492852947],vs={[0]:{[E.ATK_PERCENT]:.10213,[E.HP_PERCENT]:.10213,[E.DEF_PERCENT]:.12747,[E.ELEMENTAL_MASTERY]:40.8,[E.ENERGY_RECHARGE]:.11333,[E.CRIT_RATE]:.068,[E.CRIT_DMG]:.136,[E.PHYSICAL_DMG]:.12747},[1]:{[E.ATK_PERCENT]:.0766,[E.HP_PERCENT]:.0766,[E.DEF_PERCENT]:.0956,[E.ELEMENTAL_MASTERY]:30.6,[E.ENERGY_RECHARGE]:.085,[E.CRIT_RATE]:.051,[E.CRIT_DMG]:.102,[E.PHYSICAL_DMG]:.0956},[3]:{[E.ATK_PERCENT]:.0766,[E.HP_PERCENT]:.0766,[E.DEF_PERCENT]:.0956,[E.ELEMENTAL_MASTERY]:30.6,[E.ENERGY_RECHARGE]:.085,[E.CRIT_RATE]:.051,[E.CRIT_DMG]:.102,[E.PHYSICAL_DMG]:.0956},[2]:{[E.ATK_PERCENT]:.05107,[E.HP_PERCENT]:.05107,[E.DEF_PERCENT]:.06373,[E.ELEMENTAL_MASTERY]:20.4,[E.ENERGY_RECHARGE]:.05667,[E.CRIT_RATE]:.034,[E.CRIT_DMG]:.068,[E.PHYSICAL_DMG]:.06373},[4]:{[E.ATK_PERCENT]:.12,[E.HP_PERCENT]:.12,[E.DEF_PERCENT]:.15013,[E.ELEMENTAL_MASTERY]:48,[E.ENERGY_RECHARGE]:.13333,[E.CRIT_RATE]:.08,[E.CRIT_DMG]:.16,[E.PHYSICAL_DMG]:.15013},[5]:{[E.ATK_PERCENT]:.09,[E.HP_PERCENT]:.09,[E.DEF_PERCENT]:.1126,[E.ELEMENTAL_MASTERY]:36,[E.ENERGY_RECHARGE]:.1,[E.CRIT_RATE]:.06,[E.CRIT_DMG]:.12,[E.PHYSICAL_DMG]:.1126},[6]:{[E.ATK_PERCENT]:.06,[E.HP_PERCENT]:.06,[E.DEF_PERCENT]:.0751,[E.ELEMENTAL_MASTERY]:24,[E.ENERGY_RECHARGE]:.0667,[E.CRIT_RATE]:.04,[E.CRIT_DMG]:.08,[E.PHYSICAL_DMG]:.0751},[8]:{[E.ATK_PERCENT]:.144,[E.HP_PERCENT]:.144,[E.DEF_PERCENT]:.18,[E.ELEMENTAL_MASTERY]:57.6,[E.ENERGY_RECHARGE]:.16,[E.CRIT_RATE]:.096,[E.CRIT_DMG]:.192,[E.PHYSICAL_DMG]:.18},[7]:{[E.ATK_PERCENT]:.03,[E.HP_PERCENT]:.03,[E.DEF_PERCENT]:.03753,[E.ELEMENTAL_MASTERY]:12,[E.ENERGY_RECHARGE]:.03333,[E.CRIT_RATE]:.02,[E.CRIT_DMG]:.04,[E.PHYSICAL_DMG]:.03753},[9]:{[E.ATK_PERCENT]:.108,[E.HP_PERCENT]:.108,[E.DEF_PERCENT]:.135,[E.ELEMENTAL_MASTERY]:43.2,[E.ENERGY_RECHARGE]:.12,[E.CRIT_RATE]:.072,[E.CRIT_DMG]:.144,[E.PHYSICAL_DMG]:.135},[10]:{[E.ATK_PERCENT]:.072,[E.HP_PERCENT]:.072,[E.DEF_PERCENT]:.09,[E.ELEMENTAL_MASTERY]:28.8,[E.ENERGY_RECHARGE]:.08,[E.CRIT_RATE]:.048,[E.CRIT_DMG]:.096,[E.PHYSICAL_DMG]:.09},[11]:{[E.ATK_PERCENT]:.036,[E.HP_PERCENT]:.036,[E.DEF_PERCENT]:.045,[E.ELEMENTAL_MASTERY]:14.4,[E.ENERGY_RECHARGE]:.04,[E.CRIT_RATE]:.024,[E.CRIT_DMG]:.048,[E.PHYSICAL_DMG]:.045}};function ys(e,a,s,n){if(s<1||s>90)throw new Error("Weapon level must be between 1 and 90");if(n<0||n>6)throw new Error("Weapon ascension must be between 0 and 6");let r;if(e===5)r=Os;else if(e===4)r=Is;else if(e===3)r=Rs;else throw new Error("Weapon stars must be 3, 4 or 5.");return Gs[a][s-1]+r*n}function Hs(e,a,s){const n=Ds[a-1];return(vs[e][s]||0)*n}function Ps(e,a,s){return e===5?E_[a][s]:T_[a][s]}var E_={[E.HP_FLAT]:[717,920,1123,1326,1530,1733,1936,2139,2342,2545,2749,2952,3155,3358,3561,3764,3967,4171,4374,4577,4780],[E.HP_PERCENT]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.ATK_FLAT]:[47,60,73,86,100,113,126,139,152,166,179,192,205,219,232,245,258,272,285,298,311],[E.ATK_PERCENT]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.DEF_PERCENT]:[.087,.112,.137,.162,.186,.211,.236,.261,.286,.31,.335,.36,.385,.409,.434,.459,.484,.508,.533,.558,.583],[E.CRIT_RATE]:[.047,.06,.073,.086,.099,.113,.126,.139,.152,.166,.179,.192,.205,.218,.232,.245,.258,.271,.284,.298,.311],[E.CRIT_DMG]:[.093,.12,.146,.173,.199,.225,.252,.278,.305,.331,.357,.384,.41,.437,.463,.49,.516,.542,.569,.595,.622],[E.ENERGY_RECHARGE]:[.078,.1,.122,.144,.166,.188,.21,.232,.254,.276,.298,.32,.342,.364,.386,.408,.43,.452,.474,.496,.518],[E.HEALING_BONUS]:[.054,.069,.084,.1,.115,.13,.145,.161,.176,.191,.206,.221,.237,.252,.267,.282,.298,.313,.328,.343,.359],[E.ELEMENTAL_MASTERY]:[28,35.9,43.8,51.8,59.7,67.6,75.5,83.5,91.4,99.3,107.2,115.2,123.1,131,138.9,146.9,154.8,162.7,170.6,178.6,186.5],[E.ANEMO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.GEO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.CRYO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.PYRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.HYDRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.ELECTRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.DENDRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[E.PHYSICAL_DMG]:[.087,.112,.137,.162,.186,.211,.236,.261,.286,.31,.335,.36,.385,.409,.434,.459,.484,.508,.533,.558,.583]},T_={[E.HP_FLAT]:[645,828,1011,1194,1377,1559,1742,1925,2108,2291,2474,2657,2839,3022,3205,3388,3571],[E.HP_PERCENT]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.ATK_FLAT]:[42,54,66,78,90,102,113,125,137,149,161,173,185,197,209,221,232],[E.ATK_PERCENT]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.DEF_PERCENT]:[.079,.101,.123,.146,.168,.19,.212,.235,.257,.279,.302,.324,.346,.368,.391,.413,.435],[E.CRIT_RATE]:[.042,.054,.066,.078,.09,.101,.113,.125,.137,.149,.161,.173,.185,.197,.208,.22,.232],[E.CRIT_DMG]:[.084,.108,.131,.155,.179,.203,.227,.25,.274,.298,.322,.345,.369,.393,.417,.441,.464],[E.ENERGY_RECHARGE]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387],[E.HEALING_BONUS]:[.048,.062,.076,.09,.103,.117,.131,.144,.158,.172,.186,.199,.213,.227,.24,.254,.268],[E.ELEMENTAL_MASTERY]:[25.2,32.3,39.4,46.6,53.7,60.8,68,75.1,82.2,89.4,96.5,103.6,110.8,117.9,125,132.2,139.3],[E.ANEMO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.CRYO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.ELECTRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.GEO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.HYDRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.PYRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.DENDRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[E.PHYSICAL_DMG]:[.079,.101,.123,.146,.168,.19,.212,.235,.257,.279,.302,.324,.346,.368,.391,.413,.435]},ws=(e=>(e[e.ROLL_1=0]="ROLL_1",e[e.ROLL_2=1]="ROLL_2",e[e.ROLL_3=2]="ROLL_3",e[e.ROLL_4=3]="ROLL_4",e[e.ROLL_AVG=4]="ROLL_AVG",e[e.ROLL_MIN=0]="ROLL_MIN",e[e.ROLL_MAX=3]="ROLL_MAX",e))(ws||{});function nt(e,a,s){return e===4?s===4?(Pt[a][0]+Pt[a][1]+Pt[a][2]+Pt[a][3])/4:Pt[a][s]:e===5?s===4?(Ht[a][0]+Ht[a][1]+Ht[a][2]+Ht[a][3])/4:Ht[a][s]:0}function He(e){return e===4?4:e===5?6:0}function __(e){return e===4?7:e===5?9:0}function Pe(e,a){return He(e)*nt(e,a,3)}var Ht={[E.HP_FLAT]:[209.13,239,268.88,298.75],[E.HP_PERCENT]:[.0408,.0466,.0525,.0583],[E.ATK_FLAT]:[13.62,15.56,17.51,19.45],[E.ATK_PERCENT]:[.0408,.0466,.0525,.0583],[E.PYRO_DMG]:[.0408,.0466,.0525,.0583],[E.CRYO_DMG]:[.0408,.0466,.0525,.0583],[E.HYDRO_DMG]:[.0408,.0466,.0525,.0583],[E.ELECTRO_DMG]:[.0408,.0466,.0525,.0583],[E.ANEMO_DMG]:[.0408,.0466,.0525,.0583],[E.GEO_DMG]:[.0408,.0466,.0525,.0583],[E.DENDRO_DMG]:[.0408,.0466,.0525,.0583],[E.PHYSICAL_DMG]:[.051,.0583,.0656,.0729],[E.HEALING_BONUS]:[.03143,.03589799019607843,.040443014705882345,.044911004901960774],[E.DEF_FLAT]:[16.2,18.52,20.83,23.15],[E.DEF_PERCENT]:[.051,.0583,.0656,.0729],[E.CRIT_RATE]:[.0272,.0311,.035,.0389],[E.CRIT_DMG]:[.0544,.0622,.0699,.0777],[E.ENERGY_RECHARGE]:[.0453,.0518,.0583,.0648],[E.ELEMENTAL_MASTERY]:[16.32,18.65,20.98,23.31]},Pt={[E.HP_FLAT]:[167.3,191.2,215.1,239],[E.HP_PERCENT]:[.0326,.0373,.042,.0466],[E.ATK_FLAT]:[10.89,12.45,14,15.56],[E.ATK_PERCENT]:[.0326,.0373,.042,.0466],[E.PYRO_DMG]:[.0326,.0373,.042,.0466],[E.CRYO_DMG]:[.0326,.0373,.042,.0466],[E.HYDRO_DMG]:[.0326,.0373,.042,.0466],[E.ELECTRO_DMG]:[.0326,.0373,.042,.0466],[E.ANEMO_DMG]:[.0326,.0373,.042,.0466],[E.GEO_DMG]:[.0326,.0373,.042,.0466],[E.DENDRO_DMG]:[.0326,.0373,.042,.0466],[E.PHYSICAL_DMG]:[.0408,.0466,.0525,.0583],[E.HEALING_BONUS]:[.0251,.02866813725490196,.032297794117647056,.035865931372549016],[E.DEF_FLAT]:[12.96,14.82,16.67,18.52],[E.DEF_PERCENT]:[.0408,.0466,.0525,.0583],[E.CRIT_RATE]:[.0218,.0249,.028,.0311],[E.CRIT_DMG]:[.0435,.0497,.056,.0622],[E.ENERGY_RECHARGE]:[.0363,.0414,.0466,.0518],[E.ELEMENTAL_MASTERY]:[13.06,14.92,16.79,18.65]};function wt(e,a,s){return e*(1+a)+s}function Bs(e,a){return e>1?e=1:e<0&&(e=0),1+e*a}function bs(e){return e<0?1-e/2:e<.75?1-e:1/(4*e+1)}function Ks(e,a,s,n){return(e+100)/((1-s)*(1-n)*(a+100)+e+100)}function Ys(e){return 2.78*e/(e+1400)}function Fs(e){return 16*e/(e+2e3)}function we(e){return 5*e/(e+1200)}function te(e){return hs[e-1]}function ks(e){switch(e){case E.BURGEON_DMG:return 6;case E.HYPERBLOOM_DMG:return 6;case E.OVERLOAD_DMG:return 4;case E.BLOOM_DMG:return 4;case E.SHATTER_DMG:return 3;case E.ELECTROCHARGE_DMG:return 2.4;case E.SWIRL_DMG:return 1.2;case E.SUPERCONDUCT_DMG:return 1;case E.BURNING_DMG:return .5;case E.AGGRAVATE_DMG:return 2.3;case E.SPREAD_DMG:return 2.5}return 0}var Vs=(e=>(e[e.NO_CRIT=0]="NO_CRIT",e[e.CRIT=1]="CRIT",e[e.CRIT_AVG=2]="CRIT_AVG",e))(Vs||{}),xs=(e=>(e[e.AMP_STRONG=2]="AMP_STRONG",e[e.AMP_WEAK=1.5]="AMP_WEAK",e[e.AMP_NONE=0]="AMP_NONE",e))(xs||{}),Us=(e=>(e[e.QUICKEN_STRONG=2.5]="QUICKEN_STRONG",e[e.QUICKEN_WEAK=2.3]="QUICKEN_WEAK",e[e.QUICKEN_NONE=0]="QUICKEN_NONE",e))(Us||{});function Ws(e){return k({Char:0,Enemy:0,Base:0,Dmg:0,Critrate:0,Critdmg:0,Em:0,Res:0,Ignored:0,Reduced:0,Quicken:0,Amp:0,Tr:0},e)}function js(e){return k({Base:!1,Def:!1,Res:!1,Dmg:!1,Crit:0,Quicken:0,Tr:0,Amp:0},e)}function zs(e,a){let s=0;a.Base&&(s=e.Base);const n=ks(a.Tr);return s+=n*te(e.Char),n===0&&a.Quicken>0&&(s+=a.Quicken*te(e.Char)*(1+we(e.Em)+e.Quicken)),a.Dmg&&(s*=1+e.Dmg),n>0&&(s*=1+Fs(e.Em)+e.Tr,a.Quicken>0&&(s+=a.Quicken*te(e.Char)*(1+we(e.Em)+e.Quicken))),a.Crit===1?s*=1+e.Critdmg:a.Crit===2&&(s*=Bs(e.Critrate,e.Critdmg)),a.Def&&(s*=Ks(e.Char,e.Enemy,e.Ignored,e.Reduced)),a.Res&&(s*=bs(e.Res)),a.Amp>0&&(s*=a.Amp*(1+Ys(e.Em)+e.Amp)),s}function qs(e,a,s,n,r,i){const c=r;let _=0;r>0&&(_=i/r);let u=e*(1-c)*(1-_);return u+=a*(1-c)*_,u+=s*c*(1-_),u+=n*c*_,u}function u_(e,a){switch(a){case E.ATK:return wt(e.Get(E.ATK_BASE),e.Get(E.ATK_PERCENT),e.Get(E.ATK_FLAT));case E.HP:return wt(e.Get(E.HP_BASE),e.Get(E.HP_PERCENT),e.Get(E.HP_FLAT));case E.DEF:return wt(e.Get(E.DEF_BASE),e.Get(E.DEF_PERCENT),e.Get(E.DEF_FLAT));case E.NORMAL_ATTACK_LEVEL:return e.Get(E.NORMAL_ATTACK_LEVEL)+e.Get(E.NORMAL_ATTACK_LEVEL_UP);case E.ELEMENTAL_SKILL_LEVEL:return e.Get(E.ELEMENTAL_SKILL_LEVEL)+e.Get(E.ELEMENTAL_SKILL_LEVEL_UP);case E.ELEMENTAL_BURST_LEVEL:return e.Get(E.ELEMENTAL_BURST_LEVEL)+e.Get(E.ELEMENTAL_BURST_LEVEL_UP);case E.CHARGED_AIMED_SHOT_DMG:return e.Get(E.CHARGED_AIMED_SHOT_DMG)+e.Get(E.CHARGED_ATTACK_DMG)+e.Get(E.AIMED_SHOT_DMG);case E.CHARGED_AIMED_SHOT_ATK_FLAT:return e.Get(E.CHARGED_AIMED_SHOT_ATK_FLAT)+e.Get(E.CHARGED_ATTACK_ATK_FLAT)+e.Get(E.AIMED_SHOT_ATK_FLAT);case E.CHARGED_AIMED_SHOT_ATK_PERCENT:return e.Get(E.CHARGED_AIMED_SHOT_ATK_PERCENT)+e.Get(E.CHARGED_ATTACK_ATK_PERCENT)+e.Get(E.AIMED_SHOT_ATK_PERCENT);case E.CHARGED_AIMED_SHOT_CRIT_DMG:return e.Get(E.CHARGED_AIMED_SHOT_CRIT_DMG)+e.Get(E.CHARGED_ATTACK_CRIT_DMG)+e.Get(E.AIMED_SHOT_CRIT_DMG);case E.CHARGED_AIMED_SHOT_CRIT_RATE:return e.Get(E.CHARGED_AIMED_SHOT_CRIT_RATE)+e.Get(E.CHARGED_ATTACK_CRIT_RATE)+e.Get(E.AIMED_SHOT_CRIT_RATE);case E.CHARGED_AIMED_SHOT_DMG_FLAT:return e.Get(E.CHARGED_AIMED_SHOT_DMG_FLAT)+e.Get(E.CHARGED_ATTACK_DMG_FLAT)+e.Get(E.AIMED_SHOT_DMG_FLAT);default:return e.Get(a)}}function A_(e,a,s){let n,r,i,c;switch(a){case E.ATK:throw new Error("Cannot set Total ATK directly.");case E.HP:throw new Error("Cannot set Total HP directly.");case E.DEF:throw new Error("Cannot set Total DEF directly");case E.NORMAL_ATTACK_LEVEL:s=Math.max(1,Math.floor(s)),e.Set(E.NORMAL_ATTACK_LEVEL,s-e.Get(E.NORMAL_ATTACK_LEVEL_UP));break;case E.ELEMENTAL_SKILL_LEVEL:s=Math.max(1,Math.floor(s)),e.Set(E.ELEMENTAL_SKILL_LEVEL,s-e.Get(E.ELEMENTAL_SKILL_LEVEL_UP));break;case E.ELEMENTAL_BURST_LEVEL:s=Math.max(1,Math.floor(s)),e.Set(E.ELEMENTAL_BURST_LEVEL,s-e.Get(E.ELEMENTAL_BURST_LEVEL_UP));break;case E.LEVEL:s>90?s=90:s<1&&(s=1),s=Math.floor(s),r=Zt(s),i=Rt(s),c=e.Get(E.ASCENSION),c<r?c=r:c>i&&(c=i),e.Set(E.ASCENSION,c),e.Set(E.LEVEL,s);break;case E.ASCENSION:n=e.Get(E.LEVEL),r=Zt(n),i=Rt(n),c=Math.floor(s),c<r?c=r:c>i&&(c=i),e.Set(E.ASCENSION,c);break;default:e.Set(a,s);break}}var Be=class{constructor(e){if(this.Subject=new _t(E.Length(),"CHARACTER_STATS"),this.infusions=[],this.MapCritRate=a=>a,e.Stars!==4&&e.Stars!==5)throw new Error("Character stars must be 4 or 5.");this.Options=e,this.Subject.Set(E.LEVEL,1),this.Subject.Set(E.ASCENSION,0),this.Subject.Set(E.ENERGY_RECHARGE,1),this.Subject.Set(E.CRIT_RATE,.05),this.Subject.Set(E.CRIT_DMG,.5),this.Subject.Set(E.NORMAL_ATTACK_LEVEL,1),this.Subject.Set(E.ELEMENTAL_SKILL_LEVEL,1),this.Subject.Set(E.ELEMENTAL_BURST_LEVEL,1),this.Subject.Set(E.HP_CURRENT,1),this.Subject.Set(E.ENERGY_CURRENT,1),this.enemy=new Ts(e.Name)}GetEnemy(){return this.enemy}IsShielded(){return this.Subject.Get(E.SHIELDED)===1}SetShield(e){return this.Subject.Set(E.SHIELDED,e===!0?1:0),this}GetLevel(){return this.Subject.Get(E.LEVEL)}SetLevel(e){return this.Set(E.LEVEL,e)}GetAscension(){return this.Subject.Get(E.ASCENSION)}SetAscension(e){return this.Set(E.ASCENSION,e)}IsAscended(){return this.GetAscension()===Rt(this.GetLevel())}Set(e,a){return A_(this.Subject,e,a),this}CreateModifier(e,a){return this.Subject.CreateModifier(e,a)}CreateObserver(e,a){return this.Subject.CreateObserver(e,a)}Get(e){return u_(this.Subject,e)}AddInfusion(e,a){const s={Enabled:!0,Element:e,Max:a,Remove:()=>this.RemoveInfusion(s)};return this.infusions.push(s),s}RemoveInfusion(e){const a=this.infusions.indexOf(e);return a===-1?!1:(this.infusions.splice(a,1),!0)}GetInfusion(){return r_(this.infusions)}};function $s(e){return{level:e.GetLevel(),ascension:e.GetAscension(),hp:e.Get(E.HP_CURRENT),energy:e.Get(E.ENERGY_CURRENT),shielded:e.Get(E.SHIELDED)===1,talents:[e.Get(E.NORMAL_ATTACK_LEVEL),e.Get(E.ELEMENTAL_SKILL_LEVEL),e.Get(E.ELEMENTAL_BURST_LEVEL)],enemy:De(e.GetEnemy())}}function Qs(e,a){a.SetLevel(e.level),a.SetAscension(e.ascension),a.Set(E.NORMAL_ATTACK_LEVEL,e.talents[0]),a.Set(E.ELEMENTAL_SKILL_LEVEL,e.talents[1]),a.Set(E.ELEMENTAL_BURST_LEVEL,e.talents[2]),a.Set(E.HP_CURRENT,e.hp),a.Set(E.ENERGY_CURRENT,e.energy),a.Set(E.SHIELDED,e.shielded?1:0),Jt(e.enemy,a.GetEnemy())}var G={};D(G,{Charbox:()=>ee,CharboxEvent:()=>ut,Export:()=>kn,ExportParty:()=>xn,Factory:()=>m_,Import:()=>Vn,ImportParty:()=>je,Party:()=>H_});var ut=ct("CHANGE_PARTY"),Q=class{constructor(e){this.getName=e,this.list=[],this.map=new Map}AddList(e){for(const a of e)this.Add(a)}Add(e){const a=this.getName(e).toLowerCase();return this.map.has(a)?!1:(this.list.push(e),this.map.set(a,e),!0)}Has(e){return this.map.has(this.getName(e).toLowerCase())}Remove(e){const a=this.getName(e).toLowerCase(),s=this.list.indexOf(e);return s>=0&&this.list.splice(s,1),this.map.delete(a)}Clear(){this.list.splice(0,this.list.length),this.map.clear()}Find(e){return this.map.get(e.toLowerCase())}Get(){return this.list}},ee=class{constructor(e){this.character=e,this.normals=new Q(a=>a.Options.Name),this.skills=new Q(a=>a.Options.Name),this.bursts=new Q(a=>a.Options.Name),this.tr=new Q(a=>a.Options.Name),this.extra=new Q(a=>a.Options.Name),this.effects=new Q(a=>a.Options.Name),this.modifiers=[],this.Event=new _t(ut.Length(),"CHARBOX_EVENT")}static create(e){const a=new ee(e.character);return a.normals.AddList(e.normals),a.skills.AddList(e.skills),a.bursts.AddList(e.bursts),a.tr.AddList(e.tr),a.extra.AddList(e.extra),a.effects.AddList(e.effects),a}GetParty(){return this.party}SetParty(e){this.party=e}GetWeapon(){return this.weapon}SetWeapon(e){return this.weapon&&this.weapon.Unequip(),e?this.weapon=e(this):this.weapon=void 0,this}GetCharacter(){return this.character}GetNormals(){return this.normals.Get()}FindNormal(e){return this.normals.Find(e)}AddNormal(e){return this.normals.Add(e)}RemoveNormal(e){return this.normals.Remove(e)}GetSkills(){return this.skills.Get()}FindSkill(e){return this.skills.Find(e)}AddSkill(e){return this.skills.Add(e)}RemoveSkill(e){return this.skills.Remove(e)}GetBursts(){return this.bursts.Get()}FindBurst(e){return this.bursts.Find(e)}AddBurst(e){return this.bursts.Add(e)}RemoveBurst(e){return this.bursts.Remove(e)}GetTr(){return this.tr.Get()}FindTr(e){return this.tr.Find(e)}GetExtra(){return this.extra.Get()}FindExtra(e){return this.extra.Find(e)}AddExtra(e){return this.extra.Add(e)}RemoveExtra(e){return this.extra.Remove(e)}AddInstance(e,a){switch(e){case"Extra":return this.AddExtra(a);case"Normal":return this.AddNormal(a);case"Skill":return this.AddSkill(a);case"Burst":return this.AddBurst(a)}}RemoveInstance(e,a){switch(e){case"Extra":return this.RemoveExtra(a);case"Normal":return this.RemoveNormal(a);case"Skill":return this.RemoveSkill(a);case"Burst":return this.RemoveBurst(a)}}GetInstances(){return[...this.normals.Get(),...this.skills.Get(),...this.bursts.Get(),...this.tr.Get(),...this.extra.Get()]}FindInstance(e){for(const a of[this.normals,this.skills,this.bursts,this.tr,this.extra]){const s=a.Find(e);if(s)return s}}GetEffects(){var e,a;return[...((e=this.weapon)==null?void 0:e.GetEffects())||[],...((a=this.artifacts)==null?void 0:a.GetEffects())||[],...this.effects.Get()]}GetGroupedEffects(){const e=[],{weapon:a,artifacts:s,party:n}=this;a&&e.push(["WEAPON",a.GetEffects()]),s&&e.push(["ARTIFACTS",s.GetEffects()]);const r=[],i=[],c=new Set(this.effects.Get());for(const _ of c){const u=_.Options.Name;if(u.match(/C\d+$/))r.push(_);else if(u.match(/A\d+$/))i.push(_);else continue;c.delete(_)}return e.push(["TALENTS",Array.from(c)]),e.push(["PASSIVES",i]),e.push(["CONSTELLATIONS",r]),n&&e.push(["RESONANCES",n.GetResonances()]),e}FindEffect(e){let a=this.effects.Find(e);if(a||this.weapon&&(a=this.weapon.FindEffect(e),a)||this.artifacts&&(a=this.artifacts.FindEffect(e),a))return a}AddEffect(e){return this.effects.Add(e)}GetArtifacts(){return this.artifacts}SetArtifacts(e){return this.artifacts&&this.artifacts.Remove(),this.artifacts=e,this}AddModifier(e){return this.modifiers.unshift(e),this}RemoveModifier(e){const a=this.modifiers.indexOf(e);return a>=0&&(e.Disable(),this.modifiers.splice(a,1)),this}GetModifiers(){return this.modifiers}ClearModifiers(){return this.modifiers.forEach(e=>e.Disable()),this.modifiers.splice(0,this.modifiers.length),this}},Xs={};D(Xs,{BaseDamage:()=>Js,Instance:()=>Ke,Normal:()=>Ye,NormalTalent:()=>It,Transformative:()=>K});var Js=class{constructor(e){this.instance=e,this.motions=[],this.multipliers=[]}CreateMv(e,a){const s={Enabled:!0,Stat:e,Value:a};return this.motions.push(s),s}AddMv(e){return this.motions.includes(e)?!1:(this.motions.push(e),!0)}RemoveMv(e){const a=this.motions.indexOf(e);return a===-1?!1:(this.motions.splice(a,1),!0)}GetMvs(){return this.motions}CreateMultiplier(e){const a={Enabled:!0,Value:e};return this.multipliers.push(a),a}AddMultiplier(e){return this.multipliers.includes(e)?!1:(this.multipliers.push(e),!0)}RemoveMultiplier(e){const a=this.multipliers.indexOf(e);return a===-1?!1:(this.multipliers.splice(a,1),!0)}GetMultipliers(){return this.multipliers}Compute(){let e=0;for(const a of this.motions)a.Enabled&&(e+=this.instance.Get(a.Stat)*a.Value);for(const a of this.multipliers)a.Enabled&&Math.abs(a.Value)>1e-6&&(e*=a.Value);return e}};function S_(e,a){return e===E.HYDRO_DMG&&a.Affected(E.PYRO_DMG)?[E.VAPORIZE_DMG,2]:e===E.PYRO_DMG&&a.Affected(E.CRYO_DMG)?[E.MELT_DMG,2]:e===E.PYRO_DMG&&a.Affected(E.HYDRO_DMG)?[E.VAPORIZE_DMG,1.5]:e===E.CRYO_DMG&&a.Affected(E.PYRO_DMG)?[E.MELT_DMG,1.5]:[E.NONE,0]}function h_(e,a){return a.HasAura(z.QUICKEN)?e===E.ELECTRO_DMG?[E.AGGRAVATE_DMG,2.3]:e===E.DENDRO_DMG?[E.SPREAD_DMG,2.5]:[E.NONE,0]:[E.NONE,0]}function Zs(e,a,s){const n=e.GetElement(),r=e.Options.Talent,i=e.Character.GetEnemy(),[c,_]=h_(n,i),[u,A]=S_(n,i),S=Ws({Char:e.Character.Get(E.LEVEL),Enemy:i.Subject.Get(E.LEVEL),Base:e.Base.Compute()+e.Get(E.DMG_FLAT),Dmg:e.Get(n)+e.Get(r)+e.Get(E.ALL_DMG),Critrate:Math.max(0,Math.min(1,e.Get(E.CRIT_RATE))),Critdmg:e.Get(E.CRIT_DMG),Em:e.Get(E.ELEMENTAL_MASTERY),Res:i.Subject.Get(Xt(n)),Ignored:e.Get(E.DEFIGNORED)+i.Subject.Get(E.DEFIGNORED),Reduced:e.Get(E.DEFREDUCTION)+i.Subject.Get(E.DEFREDUCTION),Quicken:e.Get(c),Amp:e.Get(u),Tr:e.Get(e.Options.Tr)}),h=js({Base:e.Options.Base,Def:e.Options.Def,Res:e.Options.Res,Dmg:e.Options.Dmg,Crit:s,Quicken:_,Tr:e.Options.Tr,Amp:A});return a||(S.Quicken=0,S.Amp=0,h.Quicken=0,h.Amp=0),e.Options.Amp||(h.Amp=0),e.Options.Quicken||(h.Quicken=0),e.Options.Crit||(h.Crit=0),{stats:S,options:h}}function be(e,a,s){const{stats:n,options:r}=Zs(e,a,s);return zs(n,r)}var F=E,Ke=class{constructor(e,a){this.Character=e,this.Options=a,this.Base=new Js(this),this.fixed=new Uint8Array(E.Length()),this.Subject=new _t(E.Length(),"INSTANCE_"+this.Options.Name)}GetElement(){if(this.Options.Override){if(this.Options.OverrideElement!==E.NONE)return this.Options.OverrideElement;if(this.Options.Infusion){const e=this.Character.GetInfusion();if(e)return e.Element}}return this.Options.Element}Fix(e){return this.fixed[e]=1,this}Unfix(e){return this.fixed[e]=0,this}Get(e){if(e===F.ATK){const a=this.GetElement(),s=Ce(a),n=ge(a),r=this.Options.Talent,i=Ce(r),c=ge(r),_=this.Get(F.ATK_BASE);let u=this.Get(F.ATK_PERCENT),A=this.Get(F.ATK_FLAT);return s!==F.NONE&&(u+=this.Get(s)),i!==F.NONE&&(u+=this.Get(i)),n!==F.NONE&&(A+=this.Get(n)),c!==F.NONE&&(A+=this.Get(c)),wt(_,u,A)}else if(e===F.CRIT_RATE){const a=this.GetElement(),s=this.Options.Talent,n=Ge(a),r=Ge(s);let i=0;return i+=this.Subject.Get(F.CRIT_RATE),i+=this.Subject.Get(F.EXTRA_CRIT_RATE),this.fixed[F.CRIT_RATE]||(i+=this.Character.Get(F.CRIT_RATE)),this.fixed[F.EXTRA_CRIT_RATE]||(i+=this.Character.Get(F.EXTRA_CRIT_RATE)),i+=this.Get(n)+this.Get(r),this.Character.MapCritRate(i)}else if(e===F.CRIT_DMG){const a=this.GetElement(),s=this.Options.Talent,n=Re(a),r=Re(s);let i=this.Subject.Get(F.CRIT_DMG);return this.fixed[F.CRIT_DMG]||(i+=this.Character.Get(F.CRIT_DMG)),i+=this.Get(n)+this.Get(r),i}else if(e===F.DMG_FLAT){const a=this.GetElement(),s=this.Options.Talent,n=Me(a),r=Me(s);let i=this.Subject.Get(F.DMG_FLAT);return this.fixed[F.DMG_FLAT]||(i+=this.Character.Get(F.DMG_FLAT)),i+=this.Get(n)+this.Get(r),i}else return this.fixed[e]?this.Subject.Get(e):this.Character.Get(e)+this.Subject.Get(e)}DmgNoCrit(e){return be(this,e,0)}DmgCrit(e){return be(this,e,1)}DmgAvg(e){return be(this,e,2)}Params(e,a){return Zs(this,e,a)}};function Ye(e,a){return new Ke(a,{Name:e,Element:E.PHYSICAL_DMG,Talent:E.NONE,Override:!0,OverrideElement:E.NONE,Infusion:!1,Base:!0,Def:!0,Res:!0,Dmg:!0,Crit:!0,Quicken:!0,Amp:!0,Tr:E.NONE})}function K(e,a,s){const n=new Ke(s,{Name:"HIT_"+E.Name(e).replace(/_DMG/g,""),Element:E.PHYSICAL_DMG,Talent:E.NONE,Override:!1,OverrideElement:E.NONE,Infusion:!1,Base:!1,Def:!1,Res:!0,Dmg:!1,Crit:!0,Quicken:!1,Amp:!1,Tr:e});if(n.Fix(E.CRIT_RATE),n.Fix(E.CRIT_DMG),e===E.SWIRL_DMG){if(!a)throw new Error("Swirl transformative damage must have an element");n.Options.Quicken=!0,n.Options.Amp=!0,n.Options.Name="HIT_"+(E.Name(e)+"_"+E.Name(a)).replace(/_DMG/g,""),n.Options.Element=a}else n.Options.Element=cs(e);return n}function It(e,a){const s=Ye(a.Name,e),n=[];if(s.Options.Talent=a.Talent,s.Options.Element=a.Element,a.Scaling)for(const r of a.Scaling)n.push(...Ms(s,r));return[s,n]}function m_(e){return Object.assign(function(){const s=new Be(e);ds(s,e);const n=ee.create({character:s,normals:e.Normals.map(r=>It(s,Fe(r,E.NORMAL_ATTACK_LEVEL))[0]),skills:e.Skills.map(r=>It(s,Fe(r,E.ELEMENTAL_SKILL_LEVEL))[0]),bursts:e.Bursts.map(r=>It(s,Fe(r,E.ELEMENTAL_BURST_LEVEL))[0]),tr:f_(s),extra:e.Extra.map(r=>It(s,lt(k({},r),{Scaling:void 0}))[0]),effects:[]});return n.GetNormals().forEach(r=>r.Options.Infusion=!0),e.Effects.forEach(r=>{const i=r(n);i.Apply(n),n.AddEffect(i)}),n},e)}function Fe(e,a){var s;return lt(k({},e),{Scaling:(s=e.Scaling)==null?void 0:s.map(n=>lt(k({},n),{Talent:a}))})}function f_(e){const a=e.Options.Element,s=[];switch(a){case E.PYRO_DMG:s.push(K(E.OVERLOAD_DMG,void 0,e)),s.push(K(E.BURGEON_DMG,void 0,e)),s.push(K(E.BURNING_DMG,void 0,e));break;case E.HYDRO_DMG:s.push(K(E.ELECTROCHARGE_DMG,void 0,e)),s.push(K(E.BLOOM_DMG,void 0,e));break;case E.CRYO_DMG:s.push(K(E.SUPERCONDUCT_DMG,void 0,e));break;case E.ELECTRO_DMG:s.push(K(E.SUPERCONDUCT_DMG,void 0,e)),s.push(K(E.ELECTROCHARGE_DMG,void 0,e)),s.push(K(E.OVERLOAD_DMG,void 0,e)),s.push(K(E.HYPERBLOOM_DMG,void 0,e));break;case E.DENDRO_DMG:s.push(K(E.BLOOM_DMG,void 0,e));break;case E.GEO_DMG:s.push(K(E.SHATTER_DMG,void 0,e));break;case E.ANEMO_DMG:s.push(K(E.SWIRL_DMG,E.PYRO_DMG,e)),s.push(K(E.SWIRL_DMG,E.HYDRO_DMG,e)),s.push(K(E.SWIRL_DMG,E.CRYO_DMG,e)),s.push(K(E.SWIRL_DMG,E.ELECTRO_DMG,e)),s.push(K(E.SUPERCONDUCT_DMG,void 0,e)),s.push(K(E.ELECTROCHARGE_DMG,void 0,e)),s.push(K(E.OVERLOAD_DMG,void 0,e)),s.push(K(E.HYPERBLOOM_DMG,void 0,e)),s.push(K(E.BLOOM_DMG,void 0,e)),s.push(K(E.BURGEON_DMG,void 0,e));break}return a!==E.GEO_DMG&&e.Options.Weapon===is.CLAYMORE&&s.push(K(E.SHATTER_DMG,void 0,e)),s}var tn={};D(tn,{Cryo:()=>cn,Dendro:()=>Tn,FindByElement:()=>Sn,Geo:()=>En,GetList:()=>An,Hydro:()=>on,Pyro:()=>ln});var l={};D(l,{Builder:()=>ft,Effect:()=>an,EffectEvent:()=>$,Export:()=>Ve,Factory:()=>mt,Import:()=>xe});function b(e,a){let s=e.toFixed(a);return s=s.replace(/\.([0-9]*)([1-9])0+$/,".$1$2"),s=s.replace(/\.0+$/,""),s}function en(e){switch(e.type){case 0:return N_(e.object);case 1:return d_(e.object);case 2:return C_(e.object);case 3:return p_(e.object);case 4:return L_(e.object)}}function L_(e){return"Damage instance: "+e.Options.Name}function p_(e){return`Infusion (${e.Enabled?"Enabled":"Disabled"}): `+ke(e.Element)}function N_(e){const a=e.Enabled()?"Enabled":"Disabled";return`Modifier (${e.Title}) (${a}): `+ke(e.GetProp())+" += "+b(e.GetValue(),4)}function d_(e){let s=`Multiplier (${e.object.Enabled?"Enabled":"Disabled"}): `+b(e.object.Value,4)+`
`;s+=`	For instances:
`;for(const n of e.instances)s+="		"+n.Options.Name+`
`;return s}function C_(e){let s=`MV (${e.object.Enabled?"Enabled":"Disabled"}): `+b(e.object.Value,4)+"*"+ke(e.object.Stat)+`
`;s+=`	For instances:
`;for(const n of e.instances)s+="		"+n.Options.Name+`
`;return s}function ke(e){try{return E.Name(e)}catch{return"unknown stat"}}var M_=class{constructor(){this.modifiers=new Set,this.observers=new Set,this.infusions=new Set,this.multipliers=new Set,this.mtins=new Set,this.mvs=new Set,this.mvins=new Set,this.instances=new Set,this.queryPool=[],this.queryGroups=new Map,this.nextQuery={}}GetModifiers(){return Array.from(this.modifiers)}Modifier(e){return this.modifiers.add(e),this.queryPool.push({type:0,object:e}),e}Observer(e){return this.observers.add(e),e}Infusion(e){return this.infusions.add(e),this.queryPool.push({type:3,object:e}),e}Multiplier(e,...a){return this.multipliers.add(e),a.forEach(s=>{s.Base.AddMultiplier(e),this.mtins.add(s)}),this.queryPool.push({type:1,object:{instances:a,object:e}}),e}Mv(e,...a){return this.mvs.add(e),a.forEach(s=>{s.Base.AddMv(e),this.mvins.add(s)}),this.queryPool.push({type:2,object:{instances:a,object:e}}),e}Instance(e,a,s){const n=[e,a,s];return this.instances.add(n),this.queryPool.push({type:4,object:s}),n}Enable(){return this.observers.forEach(e=>e.Enable().Notify()),this.modifiers.forEach(e=>e.Enable()),this.infusions.forEach(e=>e.Enabled=!0),this.mvs.forEach(e=>e.Enabled=!0),this.multipliers.forEach(e=>e.Enabled=!0),this.instances.forEach(([e,a,s])=>e.AddInstance(a,s)),this}DisableObs(){return this.observers.forEach(e=>e.Notify().Disable()),this}Disable(){return this.modifiers.forEach(e=>e.Disable()),this.DisableObs(),this.infusions.forEach(e=>e.Enabled=!1),this.mvs.forEach(e=>e.Enabled=!1),this.multipliers.forEach(e=>e.Enabled=!1),this.instances.forEach(([e,a,s])=>e.RemoveInstance(a,s)),this}Remove(){return this.Disable(),this.observers.forEach(e=>e.Remove()),this.infusions.forEach(e=>e.Remove()),this.mvins.forEach(e=>this.mvs.forEach(a=>e.Base.RemoveMv(a))),this.mtins.forEach(e=>this.multipliers.forEach(a=>e.Base.RemoveMultiplier(a))),this.instances.forEach(([e,a,s])=>e.RemoveInstance(a,s)),this}RemoveObserver(e){return e.Remove(),this.observers.delete(e),this}StartQuery(e){this.nextQuery=e}EndQuery(){this.queryGroups.set(this.nextQuery,[...this.queryPool]),this.queryPool=[]}String(){let e="";for(const[a,s]of this.queryGroups){e+="QUERY: "+JSON.stringify(a)+`
`;for(const n of s)e+=en(n)+`
`;e+="=".repeat(32)+`
`}this.queryGroups.size===0&&(e+="=".repeat(32)+`
`);for(const a of this.queryPool)e+=en(a)+`
`;return e}},$=ct("ENABLE","DISABLE","CHANGE_RANK","CHANGE_TARGET","CHANGE_STACKS","CHANGE_AURAS","CHANGE_CONDITIONS");function At(...e){const a=[],s=[];let n=0;e.forEach((i,c)=>{a[c]=i.split(`
`),a[c].forEach(_=>{_.length>(s[c]||0)&&(s[c]=_.length)}),a[c].length>n&&(n=a[c].length)});const r=[];return a.forEach((i,c)=>{for(let _=0;_<n;_++){let u;for(_<i.length?u=i[_]:u="";u.length<s[c];)u+=" ";r[_]===void 0&&(r[_]=""),r[_]+=u}}),r.join(`
`)}var an=class{constructor(e,a){this.Options=e,this.Owner=a,this.targets=new Set,this.register=new Map,this.onUnapply=new Map,this.enabled=!1,this.rank=1,this.stacks=0,this.conditions=new Set,this.auras=new Set,this.Event=new _t($.Length(),"EFFECT_EVENT")}CreateObserver(e,a){return this.Event.CreateObserver(e,a)}Enabled(){return this.enabled}Enable(){this.enabled=!0;for(const[,e]of this.register)e.Enable();return this.Event.Notify($.ENABLE),this}Disable(){this.enabled=!1;for(const[,e]of this.register)e.Disable();return this.Event.Notify($.DISABLE),this}GetTargets(){return Array.from(this.targets.values())}Lock(e){const a=this.register.get(e);return a?(a.DisableObs(),this):(V.Global.warnf("Cannot lock effect %s for target %s because its not applied.",this.Options.Name,e.GetCharacter().Options.Name),this)}ApplyMultiple(e){const a=new Set(e);if(!this.Options.ApplyOther){const n=a.has(this.Owner),r=a.size;a.clear(),n&&(a.add(this.Owner),r>1&&V.Global.warnf('Effect "%s" can only be applied to its owner: "%s"',this.Options.Name,this.Owner.GetCharacter().Options.Name))}if(this.Options.ApplySelf||(a.delete(this.Owner),V.Global.warnf('Effect "%s" CANNOT be applied to its owner: "%s"',this.Options.Name,this.Owner.GetCharacter().Options.Name)),this.Options.MaxTargets>0){let n=0;for(let r=0;r<e.length&&a.size>this.Options.MaxTargets;r++)a.delete(e[r]),n++;n>0&&V.Global.warnf('Effect "%s" maximum targets is %d.',this.Options.Name,this.Options.MaxTargets)}this.UnapplyAll();let s=0;for(const n of a)this.Apply(n)&&s++;return s}Apply(e){if(!this.Options.StackSelf){const n=e.GetParty();if(n&&n.GetAppliedEffects(e).find(i=>i.Options.Name===this.Options.Name))return V.Global.warnf('Cannot apply effect "%s" to target "%s". Another instance of this effect is already applied to the target',this.Options.Name,e.GetCharacter().Options.Name),!1}if(!this.Options.ApplySelf&&e===this.Owner)return V.Global.warnf('Cannot apply effect "%s" to target "%s". Effect CANNOT be applied to its owner: "%s"',this.Options.Name,e.GetCharacter().Options.Name,this.Owner.GetCharacter().Options.Name),!1;if(!this.Options.ApplyOther&&e!==this.Owner)return V.Global.warnf('Cannot apply effect "%s" to target "%s". Effect can only be applied to its owner: "%s"',this.Options.Name,e.GetCharacter().Options.Name,this.Owner.GetCharacter().Options.Name),!1;if(this.Options.MaxTargets>0&&this.targets.size>=this.Options.MaxTargets)return V.Global.warnf('Cannot apply effect "%s" to target "%s". Effect is applied to its maximum number of targets: %d',this.Options.Name,e.GetCharacter().Options.Name,this.Options.MaxTargets),!1;if(this.targets.has(e))return V.Global.warnf('Cannot apply effect "%s" to target "%s". Effect is applied to this target',this.Options.Name,e.GetCharacter().Options.Name),!1;this.targets.add(e);const a=new M_;this.register.set(e,a);const s=this.Options.OnApply(e,this,a);return this.onUnapply.set(e,s),this.Enabled()?a.Enable():a.Disable(),this.Event.Notify($.CHANGE_TARGET),!0}Unapply(e){var a,s;return this.targets.has(e)?(this.targets.delete(e),(a=this.register.get(e))==null||a.Remove(),this.register.delete(e),(s=this.onUnapply.get(e))==null||s(),this.onUnapply.delete(e),this.Event.Notify($.CHANGE_TARGET),!0):!1}UnapplyAll(){return this.targets.forEach(e=>this.Unapply(e)),this}GetRank(){return this.rank}GetStacks(){return this.stacks}SetRank(e){return e=Math.floor(e),e>this.Options.MaxRank&&(e=this.Options.MaxRank),e<1&&(e=1),this.rank=e,this.Event.Notify($.CHANGE_RANK),this}SetStacks(e){return e>this.Options.MaxStacks&&(e=this.Options.MaxStacks),e<0&&(e=0),this.stacks=e,this.Event.Notify($.CHANGE_STACKS),this}HasCondition(e){return this.conditions.has(e.toUpperCase())}SetConditions(...e){this.conditions.clear();for(let a of e)a=a.toUpperCase(),this.Options.Conditions.includes(a)&&this.conditions.size<this.Options.MaxConditions&&this.conditions.add(a);return this.Event.Notify($.CHANGE_CONDITIONS),this}GetConditions(){return Array.from(this.conditions)}HasAura(e){return this.auras.has(e)}SetAuras(...e){const a=this.Options.ValidAuras;this.auras.clear();for(const s of e)this.auras.size<this.Options.MaxAuras&&(a.length===0||a.length>0&&a.includes(s))&&this.auras.add(s);return this.Event.Notify($.CHANGE_AURAS),this}GetAuras(){return Array.from(this.auras)}Affected(e){for(const a of this.auras)if(Ie(a)===e)return!0;return!1}TargetRegister(e){const a=this.register.get(e);if(!!a)return a.String()}Register(){const e=this.GetTargets().map(s=>s.GetCharacter().Options.Name+`
`+this.TargetRegister(s)||""),a=[];for(let s=0;s<e.length;s++)a[2*s]=e[s],a[2*s+1]=" ".repeat(4);return At(...a)}};function mt(e){const a=k({ApplySelf:!0,ApplyOther:!1,StackSelf:!1,MaxTargets:0,Conditions:[],MaxConditions:0,MaxAuras:0,ValidAuras:[],MaxRank:1,MaxStacks:0},e);return a.Conditions=a.Conditions.map(s=>s.toUpperCase()),Object.assign(function(n){return new an(a,n)},lt(k({},e),{Options:e}))}function sn(e,a){return!(Number.isFinite(a.g)&&!(e>(a.g||0))||Number.isFinite(a.geq)&&!(e>=(a.geq||0))||Number.isFinite(a.l)&&!(e<(a.l||0))||Number.isFinite(a.leq)&&!(e<=(a.leq||0)))}function nn(e,a,s){if(s.name){if(typeof s.name=="string"){if(e.Options.Name.toLowerCase()!==s.name.toLowerCase())return!1}else if(!e.Options.Name.match(s.name))return!1}if(e.GetAscension()<(s.ascension||0)||s.weapon&&s.weapon.length>0&&!s.weapon.some(c=>e.Options.Weapon===c))return!1;const n=e.Get(E.HP_CURRENT),r=e.Get(E.ENERGY_CURRENT);return!(s.hp&&!sn(n,s.hp)||s.energy&&!sn(r,s.energy)||s.shielded!==void 0&&e.IsShielded()!==s.shielded||s.isOwner!==void 0&&e===a!==s.isOwner)}function rn(e,a){return!(a.affected&&a.affected.length>0&&e.Affected&&!a.affected.some(n=>{var r;return(r=e.Affected)==null?void 0:r.call(e,n)})||a.aura&&a.aura.length>0&&!a.aura.some(n=>e.HasAura(n)))}function g_(e,a,s,n){return!(e.target&&!nn(s,a,e.target)||e.owner&&!nn(a,a,e.owner)||e.enemy&&!rn(s.GetEnemy(),e.enemy)||e.effect&&(!rn(n,e.effect)||e.effect.conditions&&e.effect.conditions.length>0&&!e.effect.conditions.some(i=>n.HasCondition(i))))}function G_(e,a,s,n){if(typeof e=="function")return e(s,a,n);{let r=g_(e,a.GetCharacter(),s.GetCharacter(),n);return e.not&&(r=!r),r}}var R_=class{constructor(e){this.builder=e,this.target=[],this.owner=[],this.party=!1}Target(...e){return this.target=e,this.builder}Owner(...e){return this.owner=e,this.builder}Party(e){return this.party=e,this.builder}getTarget(){return this.target}getOwner(){return this.owner}getParty(){return this.party}},ae=class{constructor(e){this.builder=e}Next(){return this.builder.Next()}Build(){return this.builder.Build()}Where(e){return this.builder.Where(e),this}};function se(e,a){const s=[];for(const n of a)typeof n=="string"?e.filter(i=>i.Options.Name.toLowerCase()===n.toLowerCase()).forEach(i=>s.push(i)):typeof n=="function"?e.filter(i=>n(i)).forEach(i=>s.push(i)):e.filter(i=>i.Options.Name.match(n)).forEach(i=>s.push(i));return s}var I_=class extends ae{constructor(){super(...arguments),this.instances=[],this.mods=new Map,this.stat=[],this.target=0,this.usestacks=!1,this.values=[]}MapStat(e){return this.mapStatFn=e,this}Char(...e){return this.stat=e,this.target=0,this}Enemy(...e){return this.stat=e,this.target=1,this}Instance(...e){return this.instances=e,this.target=2,this}Values(...e){return this.usestacks=!1,this.values=e.map(a=>[a]),this}Stacks(...e){return this.usestacks=!0,e.length>0&&(this.values=e),this}Rank(e){return this.rankFn=e,this}Map(e){return this.mapFn=e,this}onBuild(e,a,s){const n=[];this.mapStatFn&&(this.stat=this.mapStatFn(e,a,s));const r=this.target===2?se(e.GetInstances(),this.instances):[];switch(this.target){case 0:for(const i of this.stat)n.push(s.Modifier(e.GetCharacter().CreateModifier(i,0)));break;case 1:for(const i of this.stat)n.push(s.Modifier(e.GetCharacter().GetEnemy().Subject.CreateModifier(i,0)));break;case 2:for(const i of this.stat)for(const c of r)n.push(s.Modifier(c.Subject.CreateModifier(i,0)));break;default:throw new Error("Cannot create the modifier. Unknown target "+String(this.target).valueOf())}this.mods.set(e,n)}onEnable(e,a,s){const n=this.mods.get(e);if(!n)return;if(this.values.length===0){n.forEach(_=>_.SetValue(0));return}let r;this.rankFn?r=this.rankFn(e,a,s):r=a.GetRank(),r>this.values.length&&(r=this.values.length);const i=this.values[r-1];let c=O_(this.usestacks,i,a.GetStacks());this.mapFn&&(c=this.mapFn(c,e,a,s));for(const _ of n)_.GetValue()!==c&&_.SetValue(c)}onDisable(e){const a=this.mods.get(e);!a||a.forEach(s=>s.SetValue(0))}};function O_(e,a,s){if(e){const n=a.length;return n===1?a[0]*s:n>1?(s>n-1&&(s=n-1),a[s]):0}else return a[0]}var D_=class extends ae{constructor(){super(...arguments),this.infusions=new Map,this.element=E.NONE,this.max=!1}Set(e,a){return this.element=e,this.max=a,this}onBuild(e,a,s){if(this.element!==E.NONE){const n=s.Infusion(e.GetCharacter().AddInfusion(this.element,this.max));this.infusions.set(e,n)}}onEnable(e,a){const s=this.infusions.get(e);s&&(s.Enabled=a.Enabled())}onDisable(e){const a=this.infusions.get(e);a&&(a.Enabled=!1)}},v_=class extends ae{constructor(){super(...arguments),this.mvs=new Map,this.mults=new Map,this.type="mv",this.stat=E.NONE,this.value=0,this.instances=[]}Mv(e,a,...s){return this.stat=e,this.value=a,this.instances=s,this.type="mv",this}Multiplier(e,...a){return this.value=e,this.type="mult",this.instances=a,this}Map(e){return this.mapFn=e,this}onBuild(e,a,s){const n=se(e.GetInstances(),this.instances);if(this.type==="mv"&&this.stat!==E.NONE&&this.value>0){const r=s.Mv({Enabled:!1,Stat:this.stat,Value:this.value},...n);this.mvs.set(e,r)}else if(this.type==="mult"&&this.value>0){const r=s.Multiplier({Enabled:!1,Value:this.value},...n);this.mults.set(e,r)}}onEnable(e,a,s){let n=this.mvs.get(e),r=this.mults.get(e);!n&&!r&&(this.onBuild(e,a,s),n=this.mvs.get(e),r=this.mults.get(e)),n&&(this.mapFn?n.Value=this.mapFn(this.value,e,a,s):n.Value=this.value),r&&(this.mapFn?r.Value=this.mapFn(this.value,e,a,s):r.Value=this.value)}onDisable(e){const a=this.mvs.get(e),s=this.mults.get(e);a&&(a.Value=0),s&&(s.Value=1)}},y_=class extends ae{constructor(){super(...arguments),this.store=new Map,this.location="Extra"}Location(e){return this.location=e,this}Options(e){return this.options=e,this}Basic(e){return this.builder.instance.Options({Name:e.Name,Element:e.Element,Talent:e.Talent||E.NONE,Scaling:[{Initial:0,Stat:E.NONE,Talent:E.NONE,Scaling:Cs.NONE}]}).Next().mv.Mv(e.Stat,e.Values[0],e.Name).Map((a,s,n)=>{const r=Math.max(1,Math.min(e.Values.length,n.GetRank()))-1;return e.Values[r]}),this}onBuild(e,a,s){if(!this.options)return;const n=It(e.GetCharacter(),this.options);n[1].forEach(r=>s.Observer(r)),s.Instance(e,this.location,n[0]),this.store.set(e,n)}onEnable(e){const a=this.store.get(e);!a||(a[1].forEach(s=>s.Notify()),e.AddInstance(this.location,a[0]))}onDisable(e){const a=this.store.get(e);!a||e.RemoveInstance(this.location,a[0])}},ft=class{constructor(){this.query={},this.container=[this],this.observe=new R_(this),this.stat=new I_(this),this.infusion=new D_(this),this.mv=new v_(this),this.instance=new y_(this),this.parts=[this.stat,this.infusion,this.mv,this.instance]}innerBuild(...[e,a,s]){s.StartQuery(this.query);const n=this.parts;n.forEach(_=>_.onBuild(e,a,s));const r=()=>n.forEach(_=>_.onEnable(e,a,s)),i=()=>n.forEach(_=>_.onDisable(e,a,s)),c=()=>{a.Enabled()&&G_(this.query,a.Owner,e,a)?r():i()};c();for(const _ of this.observe.getTarget())s.Observer(e.GetCharacter().CreateObserver(_,c));for(const _ of this.observe.getOwner())s.Observer(a.Owner.GetCharacter().CreateObserver(_,c));return this.observe.getParty()&&s.Observer(e.Event.CreateObserver(ut.CHANGE_PARTY,c)),s.EndQuery(),c}Build(){return(...[e,a,s])=>{const n=this.container.map(u=>u.innerBuild(e,a,s)),r=()=>n.forEach(u=>u());r();const i=e.GetCharacter(),c=a.Owner.GetCharacter(),_=i.GetEnemy();for(const u of[$.CHANGE_RANK,$.CHANGE_STACKS,$.CHANGE_CONDITIONS,$.CHANGE_AURAS,$.ENABLE,$.DISABLE])s.Observer(a.CreateObserver(u,r));for(const u of[E.LEVEL,E.ASCENSION,E.HP_CURRENT,E.ENERGY_CURRENT,E.SHIELDED])s.Observer(i.CreateObserver(u,r)),s.Observer(c.CreateObserver(u,r));return s.Observer(_.Event.CreateObserver(ht.CHANGE_AURA,r)),r}}Next(){const e=new ft;return e.container=this.container,this.container.push(e),e}Where(e){return this.query=e,this}};function Ve(e){return{enabled:e.Enabled(),rank:e.GetRank(),stacks:e.GetStacks(),auras:e.GetAuras(),conditions:e.GetConditions()}}function xe(e,a){e.enabled?a.Enable():a.Disable(),a.SetRank(e.rank),a.SetStacks(e.stacks),a.SetAuras(...e.auras),a.SetConditions(...e.conditions)}var ln=[mt({Name:"ResonancePyro",ApplyOther:!0,OnApply:new ft().stat.Char(E.ATK_PERCENT).Values(.25).Build()})],on=[mt({Name:"ResonanceHydro",ApplyOther:!0,OnApply:new ft().stat.Char(E.HP_PERCENT).Values(.25).Build()})],cn=[mt({Name:"ResonanceCryo",ApplyOther:!0,OnApply:new ft().stat.Char(E.EXTRA_CRIT_RATE).Where({enemy:{affected:[E.CRYO_DMG]}}).Values(.15).Build()})],En=[mt({Name:"ResonanceGeo",ApplyOther:!0,OnApply:new ft().stat.Enemy(E.GEO_RES).Values(-.15).Next().Where({target:{shielded:!0}}).stat.Char(E.ALL_DMG).Values(.15).Build()})],Tn=[mt({Name:"ResonanceDendro",ApplyOther:!0,Conditions:["BURNING","QUICKEN","BLOOM","AGGRAVATE","SPREAD","HYPERBLOOM","BURGEON"],MaxConditions:7,OnApply:new ft().stat.Char(E.ELEMENTAL_MASTERY).Values(50).Next().stat.Char(E.ELEMENTAL_MASTERY).Values(30).Where({effect:{conditions:["BURNING","QUICKEN","BLOOM"]}}).Next().stat.Char(E.ELEMENTAL_MASTERY).Values(20).Where({effect:{conditions:["AGGRAVATE","SPREAD","HYPERBLOOM","BURGEON"]}}).Build()})],_n={[E.PYRO_DMG]:ln,[E.HYDRO_DMG]:on,[E.CRYO_DMG]:cn,[E.GEO_DMG]:En,[E.DENDRO_DMG]:Tn},un=[];for(const e of Object.values(_n))e.forEach(a=>un.push(a));function An(){return un}function Sn(e){return _n[e]}var Ot={};D(Ot,{Factory:()=>fn,Food:()=>mn,FoodType:()=>hn,Foodbox:()=>Ln});var hn=(e=>(e[e.OFFENSIVE=0]="OFFENSIVE",e[e.DEFENSIVE=1]="DEFENSIVE",e[e.STAMINA=2]="STAMINA",e[e.ELEMENTAL=3]="ELEMENTAL",e))(hn||{}),mn=class{constructor(e,a){this.Options=e,this.Effect=a,this.Name=e.Name,this.Type=e.Type,this.Stars=e.Stars}GetRank(){return this.Effect.GetRank()}SetRank(e){e=Math.max(1,Math.min(3,e)),this.Effect.SetRank(e)}Unapply(){this.Effect.Disable(),this.Effect.UnapplyAll()}};function fn(e){const a=e.Effects,s=mt({Name:e.Name,ApplyOther:!0,MaxRank:3,OnApply(n,r,i){const c=a.map(([u])=>i.Modifier(n.GetCharacter().CreateModifier(u,0))),_=()=>{const u=r.GetRank();for(let A=0;A<a.length;A++){const[,S,h]=a[A],m=S+(h-S)*(u-1)/2;c[A].SetValue(m)}};return _(),i.Observer(r.Event.CreateObserver($.CHANGE_RANK,_)),i.Observer(n.Event.CreateObserver(ut.CHANGE_PARTY,()=>{const u=n.GetParty();if(!u)return;const A=r.GetTargets(),S=u.GetMembers();for(const h of S)A.includes(h)||r.Apply(h)})),()=>0}});return Object.assign(function(r){const i=s(r);i.Enable(),i.Apply(r);const c=r.GetParty();if(c)for(const _ of c.GetMembers())_!==r&&i.Apply(_);return new mn(e,i)},lt(k({},e),{Options:e}))}var Ln=class{constructor(e){this.target=e,this.byName=new Q(a=>a.Name),this.byType=new Map}Add(e){const a=this.byType.get(e.Type);a&&(a.Unapply(),this.Remove(a.Name));const s=e(this.target);return this.byName.Add(s),this.byType.set(e.Type,s),s}Remove(e){const a=this.byName.Find(e);!a||(this.byName.Remove(a),this.byType.delete(a.Type),a.Unapply())}Clear(){for(const e of this.byName.Get())e.Unapply();this.byName.Clear(),this.byType.clear()}Get(e){return this.byName.Find(e)}GetByType(e){return this.byType.get(e)}GetAll(){return this.byName.Get()}},H_=class{constructor(...e){this.members=new Q(a=>a.GetCharacter().Options.Name),this.resonances=[],this.enemies=new _s,this.handler=new ee(new Be({Name:"__party__",Region:ls.NONE,Stars:4,Element:0,Weapon:0,BurstCost:0})),this.handler.SetParty(this),this.foods=new Ln(this.handler),e.forEach(a=>this.Add(a))}GetAppliedEffects(e){return this.GetAllEffects().filter(a=>a.GetTargets().includes(e))}GetResonances(){return this.resonances}GetAllEffects(){const e=[];return this.members.Get().forEach(a=>a.GetEffects().forEach(s=>e.push(s))),this.resonances.forEach(a=>e.push(a)),e}FindEffects(e){return e=e.toLowerCase(),this.GetAllEffects().filter(a=>a.Options.Name.toLowerCase()===e)}Add(e){if(this.members.Get().length>=4||this.members.Has(e))return!1;const a=e.GetParty();return a&&a.Remove(e),e.SetParty(this),this.members.Add(e),this.updateResonances(),this.members.Get().forEach(s=>s.Event.Notify(ut.CHANGE_PARTY)),this.enemies.Add(e.GetCharacter().GetEnemy()),!0}Remove(e){return this.members.Remove(e),e.SetParty(void 0),this.updateResonances(),this.members.Get().forEach(a=>a.Event.Notify(ut.CHANGE_PARTY)),e.Event.Notify(ut.CHANGE_PARTY),this.enemies.Remove(e.GetCharacter().GetEnemy()),!0}GetMembers(){return this.members.Get()}FindMember(e){return this.members.Find(e)}GetFoods(){return this.foods}updateResonances(){if(this.resonances.forEach(n=>n.Disable().UnapplyAll()),this.resonances=[],this.members.Get().length<4)return;const e={};Gt.forEach(n=>e[n]=0),this.members.Get().forEach(n=>e[n.GetCharacter().Options.Element]++);const a=[];Gt.forEach(n=>{e[n]>=2&&a.push(n)}),a.map(n=>Sn(n)).filter(n=>!!n).forEach(n=>n==null?void 0:n.forEach(r=>{const i=r(this.handler);i.Enable(),this.members.Get().forEach(c=>i.Apply(c)),this.resonances.push(i)}))}},p={};D(p,{Export:()=>Nn,Factory:()=>P_,Import:()=>dn,Weapon:()=>pn});var pn=class{constructor(e,a){this.Options=e,this.effects=new Q(s=>s.Options.Name),this.level=1,this.ascension=0,this.rank=1,this.effects.AddList(a)}Equip(e){return this.target&&this.Unequip(),this.target=e,this.effects.Get().forEach(a=>a.Enable().Apply(e)),this.atkMod=e.GetCharacter().CreateModifier(E.ATK_BASE,0),this.subMod=e.GetCharacter().CreateModifier(this.Options.Substat,0),this.setMods(),this}Unequip(){var e,a;return this.effects.Get().forEach(s=>s.Disable().UnapplyAll()),(e=this.atkMod)==null||e.Disable(),(a=this.subMod)==null||a.Disable(),this.atkMod=void 0,this.subMod=void 0,this.target=void 0,this}GetLevel(){return this.level}GetAscension(){return this.ascension}IsAscended(){return this.GetAscension()===Rt(this.level)}GetRank(){return this.rank}GetSubstat(){return this.Options.Substat}GetAtkBase(){return ys(this.Options.Stars,this.Options.Scaling,this.level,this.ascension)}GetSubstatValue(){return Hs(this.Options.Scaling,this.level,this.Options.Substat)}GetEffects(){return this.effects.Get()}FindEffect(e){return this.effects.Find(e)}SetLevel(e){e=Math.max(1,Math.min(90,Math.floor(e)));const a=Zt(e),s=Rt(e);let n=this.ascension;return n<a?n=a:n>s&&(n=s),this.ascension=n,this.level=e,this.setMods(),this}SetAscension(e){const a=Zt(this.level),s=Rt(this.level);let n=e;return n<a?n=a:n>s&&(n=s),this.ascension=Math.floor(n),this.setMods(),this}SetRank(e){return e=Math.max(1,Math.min(5,Math.floor(e))),this.rank=e,this.effects.Get().forEach(a=>a.SetRank(e)),this}setMods(){var e,a;const s=this.GetAtkBase(),n=this.GetSubstatValue();(e=this.atkMod)==null||e.SetValue(s),(a=this.subMod)==null||a.SetValue(n)}};function P_(e){return Object.assign(function(s){const n=e.Effects.map(r=>r(s).Enable());return new pn(e,n).Equip(s)},e)}function Nn(e){return{level:e.GetLevel(),ascension:e.GetAscension(),rank:e.GetRank()}}function dn(e,a){a.SetLevel(e.level),a.SetAscension(e.ascension),a.SetRank(e.rank)}var I={};D(I,{Artifact:()=>Dn,Export:()=>vn,Import:()=>yn,Set:()=>w_,rolls:()=>wn,transform:()=>Hn});function w_(e){return e}var q=ct("CHANGE_LEVEL","CHANGE_PIECE","CHANGE_STARS","CHANGE_SET","CHANGE_MAINSTAT","CHANGE_SUBSTAT"),Cn={};D(Cn,{CountRolls:()=>In,FormatRolls:()=>On});function Mn(e,a,s,n){const r=a;function*i(c,_,u,A){let S=0;if(u===e-1)S=r-A;else if(u===e){A===r&&(yield c);return}s[u]>S&&(S=s[u]);let h=_;n[u]<h&&(h=n[u]);const m=_-S;for(let f=S;f<=h;f++){const N=[...c,f];yield*i(N,m,u+1,A+f)}}return i([],r,0,0)}var rt=class{constructor(e){this.queue=new qa([],(a,s)=>s.priority-a.priority,!1),e?(this.mirror=new qa([],(a,s)=>a.priority-s.priority,!1),this.maxSize=e):this.maxSize=1/0}Length(){return this.queue.length}Top(){const e=this.queue.top();if(!e)throw new Error("Priority queue is empty");return[e.item,e.priority]}Push(e,a){const s={item:e,priority:a};if(this.queue.push(s),this.mirror&&(this.mirror.push(s),this.queue.length>this.maxSize)){const n=this.mirror.pop();n&&this.queue.remove(n)}}Pop(){const e=this.queue.pop();if(!e)throw new Error("Priority queue is empty");return[e.item,e.priority]}Extract(){const e=[];for(;this.queue.length>0;)e.push(this.Pop()[0]);return e}};function gn(e){const a=[];for(const[s,n]of e.substats){if(s===0)continue;const r=B_(e.stars,s,n);a.push([s,r])}return a}function B_(e,a,s){if(s===0)return[];const n=[];for(let c=0;c<4;c++)n.push(nt(e,a,c));const r=new rt;Gn.forEach(c=>{const _=c.map((A,S)=>A*n[S]).reduce((A,S)=>A+S,0),u=Math.floor(100*(Math.abs(_-s)/s));r.Push(c,-u)});const[i]=r.Pop();return i||[]}var b_=6,Gn=[];for(let e=0;e<=b_;e++)for(const a of Mn(4,e,[0,0,0,0],[6,6,6,6]))Gn.push(a);var K_=kT(e_()),Dt=class{constructor(e){this.variables=e,this.ConstraintPrefix="_c_",this.ObjectivePrefix="_obj_",this._ints=[],this.objective={},this.constraints=[]}Ints(e){this._ints=e}Objective(e){return this.objective=e,e}Constraint(e,a){return this.constraints.push({left:e,right:a}),e}Format(){const e={},a={},s={};this.variables.forEach(n=>{const r=this.objective[n]||0;e[n]={[this.ObjectivePrefix]:r}}),this.constraints.forEach((n,r)=>{const i=this.ConstraintPrefix+r;a[i]={max:n.right},this.variables.forEach(c=>{const _=n.left[c];Number.isFinite(_)&&(e[c][i]=_)})});for(const n of this._ints)s[n]=!0;return{variables:e,constraints:a,ints:s}}Solve(e){const a=(0,K_.Solve)(k({optimize:this.ObjectivePrefix,opType:e},this.Format()));for(const s of this.variables)a[s]||(a[s]=0);return a}toString(){return this.String()}String(){let e=this.variables.map(s=>"var "+s+(this._ints.includes(s)?" integer":"")+";").join(`
`);const a=this.Matrix();e+=`

maximize z: `+this.strExpr(a.c)+`;

`;for(let s=0;s<a.A.length;s++)e+="subject to c"+s+": "+this.strExpr(a.A[s])+" <= "+a.b[s]+`;
`;return e}Matrix(){const e={c:[],A:[],b:[]};this.putIndex(e.c,this.objective);for(const{left:a,right:s}of this.constraints){e.b.push(s);const n=Array.from(Array(this.variables.length)).fill(0);this.putIndex(n,a),e.A.push(n)}return e}putIndex(e,a){for(const s in a){const n=a[s],r=this.variables.indexOf(s);r!==-1&&(e[r]=n)}}strExpr(e){return this.variables.map((a,s)=>e[s]===0?"":e[s]+"*"+a).filter(a=>a!=="").join(" + ").replace(/\+\s*-/g,"-")}static Vars(e,a){const s={};return e.forEach((n,r)=>{const i=a(n,r);if(!i)return;const[c,_]=i;!Number.isFinite(_)||(s[c]=_)}),s}};function Ue(e,a,s){return e+"_"+a+"_"+s}function Rn(e){const{level:a,stars:s}=e;if(a<0||a>20)throw new Error("Level must be between 0 and 20");if(s!==4&&s!==5)throw new Error("Stars must be 4 or 5");if(e.substats.length>4)throw new Error("Stats must be less or equal than 4");for(;e.substats.length<4;)e.substats.push([0,0]);const n=Math.floor(e.level/4),r=e.stars-2+n,i=r+1,c=e.substats.map(([d])=>d),_=e.substats.map(([,d])=>d),u=e.substats.map(([d])=>os.includes(d)?.5:.001),A=He(e.stars),S=[];for(let d=0;d<4;d++)for(let M=0;M<4;M++)S.push(Ue("R",d,M));const h=new Dt(S);h.Ints(S);const m=h.Objective({});for(const d of S)m[d]=1;const f=h.Constraint({},i),N=h.Constraint({},-r);for(let d=0;d<4;d++){const M=h.Constraint({},A),R=h.Constraint({},_[d]+u[d]),O=h.Constraint({},-_[d]+u[d]);for(let y=0;y<4;y++){const P=Ue("R",d,y);M[P]=1,f[P]=1,N[P]=-1,R[P]=nt(s,c[d],y),O[P]=-R[P]}}const L=h.Solve("min");if(!L.feasible)throw new Error("[LP] Cannot find a feasible solution");const C=[];for(let d=0;d<4;d++){if(c[d]===0)continue;const M=[c[d],[]];for(let R=0;R<4;R++){const O=Ue("R",d,R),y=L[O]||0;M[1].push(y)}C.push(M)}return C}function In(e,a="auto"){switch(a){case"auto":try{return Rn(e)}catch{return gn(e)}case"lp":return Rn(e);case"brute":return gn(e)}}function On(e,a){const s=[];for(const[n,r]of a){const i=[];for(let c=0;c<4;c++){const _=nt(e,n,c);for(let u=0;u<r[c];u++)i.push(_)}s.push([n,i])}return s}var Y_=0,Dn=class{constructor(e){this.piece=e,this.Locked=!1,this.Id=Y_++,this.Event=new _t(q.Length(),"ARTIFACT_EVENT"),this.enabled=!0,this.stars=4,this.level=0,this.substats=[],this.modifiers=[],this.observers=[],this.mainstat=Oe(e)[0]}GetPiece(){return this.piece}GetLevel(){return this.level}SetLevel(e){return this.stars===4?e=Math.min(16,e):this.stars===5&&(e=Math.min(20,e)),e<0&&(e=0),this.level=Math.floor(e),this.Event.Notify(q.CHANGE_LEVEL),this.Event.Notify(q.CHANGE_MAINSTAT),this}GetStars(){return this.stars}SetStars(e){if(e===4)this.GetLevel()>16&&this.SetLevel(16);else if(e===5)this.GetLevel()>20&&this.SetLevel(20);else throw new Error("Artifact stars must be 4 or 5");return this.stars=e,this.Event.Notify(q.CHANGE_STARS),this.Event.Notify(q.CHANGE_MAINSTAT),this}GetMainstat(){return this.mainstat}SetMainstat(e){if(Oe(this.piece).includes(e)){const s=this.substats.findIndex(i=>i.Stat===e),n=vt.filter(i=>!this.substats.find((c,_)=>_!==s&&c.Stat===i)),r=n.includes(this.mainstat)?this.mainstat:n[0];this.mainstat=e,s!==-1&&r&&this.SetSubstat(s,r),this.Event.Notify(q.CHANGE_MAINSTAT)}return this}GetMainstatValue(){return this.enabled?Ps(this.stars,this.mainstat,this.level):0}GetSet(){return this.set}SetSet(e){return this.set=e,this.Event.Notify(q.CHANGE_SET),this}SubstatsLength(){return this.substats.length}AddSubstat(e,a){if(this.substats.length===4||!vt.includes(e)||[this.mainstat,...this.substats.map(r=>r.Stat)].includes(e))return!1;const n=Pe(this.stars,e);return a=Math.max(0,Math.min(n,a)),this.substats.push({Stat:e,Value:a}),this.Event.Notify(q.CHANGE_SUBSTAT),!0}GetSubstat(e){return this.substats[e].Stat}SetSubstat(e,a){if(this.mainstat===a||!vt.includes(a))return!1;const s=this.substats.findIndex((i,c)=>c!==e&&i.Stat===a),n=nt(this.stars,this.substats[e].Stat,1),r=nt(this.stars,a,1);return s>-1&&(this.substats[s].Stat=this.substats[e].Stat,this.substats[s].Value*=n/r),this.substats[e].Stat=a,this.substats[e].Value*=r/n,this.Event.Notify(q.CHANGE_SUBSTAT),!0}GetSubstatValue(e){return this.enabled?this.substats[e].Value:0}SetSubstatValue(e,a){const s=Pe(this.stars,this.substats[e].Stat);return a=Math.max(0,Math.min(s,a)),this.substats[e].Value=a,this.Event.Notify(q.CHANGE_SUBSTAT),this}ClearSubstats(){return this.substats.forEach(e=>e.Value=0),this.Event.Notify(q.CHANGE_SUBSTAT),this}FillSubstats(){const e=vt.filter(a=>a!==this.GetMainstat());for(let a=0;a<e.length;a++)this.AddSubstat(e[a],0);return this}FindSubstat(e){return this.substats.findIndex(a=>a.Stat===e)}Enable(){return this.enabled=!0,this.Event.Notify(q.CHANGE_MAINSTAT),this.Event.Notify(q.CHANGE_SUBSTAT),this}Disable(){return this.enabled=!1,this.Event.Notify(q.CHANGE_MAINSTAT),this.Event.Notify(q.CHANGE_SUBSTAT),this}Enabled(){return this.enabled}Unequip(){return this.character=void 0,this.modifiers.forEach(e=>e.Disable()),this.observers.forEach(e=>e.Remove()),this.modifiers=[],this.observers=[],this}Equip(e){this.character&&this.Unequip(),this.character=e;const a=e.CreateModifier(this.mainstat,this.GetMainstatValue()),s=this.Event.CreateObserver(q.CHANGE_MAINSTAT,()=>{a.SetProp(this.mainstat),a.SetValue(this.GetMainstatValue())}),n=[];for(let i=0;i<4;i++)n.push(e.CreateModifier(E.ATK_FLAT,0));const r=this.Event.CreateObserver(q.CHANGE_SUBSTAT,()=>{for(let i=0;i<4;i++)i<this.SubstatsLength()?(n[i].SetProp(this.GetSubstat(i)),n[i].SetValue(this.GetSubstatValue(i))):n[i].SetValue(0)});return r.Notify(),this.modifiers=[a,...n],this.observers=[s,r],this}Rolls(e="auto"){const a=this.substats.map(n=>[n.Stat,n.Value]);return In({level:this.GetLevel(),stars:this.GetStars(),substats:a},e)}FormatRolls(){return On(this.GetStars(),this.Rolls())}};function vn(e){const a={locked:e.Locked,piece:e.GetPiece(),stars:e.GetStars(),level:e.GetLevel(),set:e.GetSet(),mainstat:e.GetMainstat(),substats:[]};for(let s=0;s<e.SubstatsLength();s++)a.substats.push({stat:e.GetSubstat(s),value:e.GetSubstatValue(s)});return a}function yn(e,a){if(e.piece!==a.GetPiece())throw new Error(`Cannot import artifacts with incompatible pieces ${st.Name(e.piece)} -> ${st.Name(a.GetPiece())}`);a.Locked=!!e.locked,a.SetStars(e.stars),a.SetLevel(e.level),a.SetSet(e.set),a.SetMainstat(e.mainstat),e.substats.forEach(({stat:s,value:n},r)=>{if(!Number.isFinite(n)||n<0)throw new Error(`Invalid substat ${r} value: ${n}`);r<a.SubstatsLength()?(a.SetSubstat(r,s),a.SetSubstatValue(r,n)):a.AddSubstat(s,n)})}var Hn={};D(Hn,{Downgrade:()=>F_,Scale:()=>Pn});function F_(e){e.GetStars()!==4&&(Pn(e,4),e.SetStars(4))}function Pn(e,a){const s=e.GetStars();for(let n=0;n<e.SubstatsLength();n++){const r=e.GetSubstat(n),i=e.GetSubstatValue(n),c=nt(s,r,0),_=nt(a,r,0),u=i*_/c;e.SetSubstatValue(n,u)}}var wn={};D(wn,{count:()=>Cn,equip:()=>Bn});var Bn={};D(Bn,{EquipRolls:()=>bn});function it(e,a,s,n){return e+"_"+a+"_"+s+"_"+n}function k_(e){const a=e.substats.length;for(let m=0;m<5-a;m++)e.substats.push([E.NONE,0]);const s=[E.HP_FLAT,E.ATK_FLAT,...e.mainstats],n=e.substats.map(([m])=>m),r=e.substats.map(([,m])=>m),i=n.length;function c(m,f){return n[m]!==s[f]}const _=[],u=new Dt(_),A=u.Objective({});for(let m=0;m<5;m++)for(let f=0;f<i;f++)for(let N=0;N<6;N++)_.push(it("S",f,m,N)),A[it("S",f,m,N)]=N+1,u.Constraint({[it("S",f,m,N)]:1},1);u.Ints(_);for(let m=0;m<5;m++){const f=u.Constraint({},9);for(let N=0;N<i;N++){const L=u.Constraint({},6),C=u.Constraint({[it("S",N,m,0)]:-5},0);for(let d=0;d<6;d++)L[it("S",N,m,d)]=1,f[it("S",N,m,d)]=1,c(N,m)||u.Constraint({[it("S",N,m,d)]:1},0);for(let d=1;d<6;d++)C[it("S",N,m,d)]=1}for(let N=0;N<6;N++){const L=u.Constraint({},4);for(let C=0;C<i;C++)L[it("S",C,m,N)]=1}}for(let m=0;m<i;m++){const f=u.Constraint({},-r[m]);for(let N=0;N<5;N++)for(let L=0;L<6;L++)f[it("S",m,N,L)]=-1}const S=u.Solve("min");if(!S.feasible)throw new Error("[LP] Cannot find a feasible solution");const h=[];for(let m=0;m<5;m++){const f=[];for(let N=0;N<i;N++){let L=0;for(let C=0;C<6;C++)L+=S[it("S",N,m,C)]||0;L>0&&f.push([n[N],L])}h.push(f)}return h}function bn(e){const a=k_(e);for(const s of a)for(const n of s){const r=nt(e.stars,n[0],e.tier);n[1]*=r}return a}var Bt={};D(Bt,{FindByName:()=>Fn,GetByType:()=>U_,GetList:()=>x_});var V_=[{Name:"SakuraShrimpCrackers",Type:1,Effects:[[E.HP_PERCENT,.2,.25]],Stars:3},{Name:"PileEmUp",Type:0,Effects:[[E.CRIT_RATE,.1,.2]],Stars:3},{Name:"AdeptusTemptation",Type:0,Effects:[[E.ATK_FLAT,260,372],[E.CRIT_RATE,.08,.12]],Stars:5},{Name:"AdventurersBreakfastSandwich",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"AlmondTofu",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"Baklava",Type:0,Effects:[[E.CRIT_RATE,.1,.2]],Stars:3},{Name:"BerryMintBurst",Type:0,Effects:[[E.CRIT_RATE,.16,.16]],Stars:2},{Name:"Biryani",Type:1,Effects:[[E.DEF_FLAT,215,308],[E.HEALING_BONUS,.06,.1]],Stars:4},{Name:"BountifulYear",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"BraisedMeat",Type:0,Effects:[[E.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"ButterChicken",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"ButterCrab",Type:1,Effects:[[E.DEF_FLAT,215,308],[E.HEALING_BONUS,.06,.1]],Stars:4},{Name:"CallaLilySeafoodSoup",Type:1,Effects:[[E.DEF_FLAT,165,235]],Stars:3},{Name:"CandiedAjilenakhNut",Type:1,Effects:[[E.DEF_FLAT,165,235]],Stars:3},{Name:"ChickenTofuPudding",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"ColdCutPlatter",Type:0,Effects:[[E.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"ComeandGetIt",Type:0,Effects:[[E.CRIT_RATE,.1,.2]],Stars:3},{Name:"CrabRoeKourayaki",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"CrocodileJerky",Type:0,Effects:[[E.ATK_FLAT,114,114]],Stars:2},{Name:"CuredPorkDryHotpot",Type:0,Effects:[[E.CRIT_RATE,.1,.2]],Stars:3},{Name:"DragonBeardNoodles",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"FishermansToast",Type:1,Effects:[[E.DEF_FLAT,88,126]],Stars:2},{Name:"FlamingEssentialOil",Type:3,Effects:[[E.PYRO_DMG,.25,.25]],Stars:3},{Name:"ForestEssentialOil",Type:3,Effects:[[E.DENDRO_DMG,.25,.25]],Stars:3},{Name:"FragrantMashedPotatoes",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"FriedRadishBalls",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"FrostingEssentialOil",Type:3,Effects:[[E.CRYO_DMG,.25,.25]],Stars:3},{Name:"FruitsoftheFestival",Type:1,Effects:[[E.HEALING_BONUS,.15,.2]],Stars:3},{Name:"GoldenCrab",Type:1,Effects:[[E.DEF_FLAT,215,308],[E.HEALING_BONUS,.06,.1]],Stars:4},{Name:"GoldenFriedChicken",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"GushingEssentialOil",Type:3,Effects:[[E.ANEMO_DMG,.25,.25]],Stars:3},{Name:"ImportedPoultry",Type:0,Effects:[[E.CRIT_RATE,.1,.2]],Stars:3},{Name:"JadeParcels",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"JewelrySoup",Type:1,Effects:[[E.DEF_FLAT,88,126]],Stars:2},{Name:"JueyunChiliChicken",Type:0,Effects:[[E.CRIT_RATE,.06,.12]],Stars:2},{Name:"JueyunGuoba",Type:0,Effects:[[E.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"KatsuSandwich",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"LanternRiteSpecialComeandGetIt",Type:0,Effects:[[E.CRIT_RATE,.2,.2]],Stars:3},{Name:"LanternRiteSpecialFriedRadishBalls",Type:0,Effects:[[E.ATK_FLAT,95,95]],Stars:2},{Name:"LanternRiteSpecialJewelrySoup",Type:1,Effects:[[E.DEF_FLAT,126,126]],Stars:2},{Name:"LotusFlowerCrisp",Type:1,Effects:[[E.DEF_FLAT,165,235]],Stars:3},{Name:"MasalaCheeseBalls",Type:0,Effects:[[E.CRIT_RATE,.06,.12]],Stars:2},{Name:"MeatLoversMushroomPizza",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"MintSalad",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"MoonPie",Type:1,Effects:[[E.DEF_FLAT,165,235]],Stars:4},{Name:"MoreandMore",Type:0,Effects:[[E.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"MushroomHodgepodge",Type:1,Effects:[[E.DEF_FLAT,88,126]],Stars:2},{Name:"QingceStirFry",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"RadishandFishStew",Type:0,Effects:[[E.CRIT_RATE,.06,.12]],Stars:2},{Name:"RiceCakeSoup",Type:1,Effects:[[E.DEF_FLAT,165,235]],Stars:3},{Name:"SashimiPlatter",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"SatisfyingSalad",Type:0,Effects:[[E.CRIT_RATE,.06,.12]],Stars:2},{Name:"SautedMatsutake",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"ShawarmaWrap",Type:0,Effects:[[E.ATK_FLAT,66,95]],Stars:2},{Name:"ShockingEssentialOil",Type:3,Effects:[[E.ELECTRO_DMG,.25,.25]],Stars:3},{Name:"StoneHarborDelicacies",Type:0,Effects:[[E.CRIT_RATE,.06,.12]],Stars:2},{Name:"StreamingEssentialOil",Type:3,Effects:[[E.HYDRO_DMG,.25,.25]],Stars:3},{Name:"SunsetBerryTea",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"TandooriRoastChicken",Type:0,Effects:[[E.ATK_FLAT,224,320],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"TianshuMeat",Type:0,Effects:[[E.PHYSICAL_DMG,.25,.45],[E.CRIT_RATE,.06,.1]],Stars:4},{Name:"TriFlavoredSkewer",Type:0,Effects:[[E.ATK_FLAT,160,228]],Stars:3},{Name:"UnagiChazuke",Type:1,Effects:[[E.HEALING_BONUS,.15,.2]],Stars:3},{Name:"UnmovingEssentialOil",Type:3,Effects:[[E.GEO_DMG,.25,.25]],Stars:3},{Name:"Wakatakeni",Type:1,Effects:[[E.DEF_FLAT,88,126]],Stars:2},{Name:"WolfhookJuice",Type:0,Effects:[[E.ATK_FLAT,114,114]],Stars:2},{Name:"OnceUponaTimeinMondstadt",Type:0,Effects:[[E.CRIT_RATE,.2,.2],[E.CRIT_DMG,.2,.2]],Stars:3},{Name:"SweetDream",Type:0,Effects:[[E.ATK_FLAT,114,114]],Stars:2},{Name:"APrizeCatch",Type:1,Effects:[[E.DEF_FLAT,282,282]],Stars:3},{Name:"DerWeisheitLetzterSchlussLife",Type:0,Effects:[[E.CRIT_RATE,.16,.16]],Stars:2},{Name:"DieHeiligeSinfonie",Type:0,Effects:[[E.PHYSICAL_DMG,.55,.55]],Stars:3},{Name:"FishFlavoredToast",Type:1,Effects:[[E.DEF_FLAT,151,151]],Stars:2},{Name:"ForestWatchersChoice",Type:1,Effects:[[E.DEF_FLAT,151,151]],Stars:2},{Name:"Halvamazd",Type:1,Effects:[[E.DEF_FLAT,282,282]],Stars:3},{Name:"HeartstringNoodles",Type:0,Effects:[[E.ATK_FLAT,274,274]],Stars:3},{Name:"NoTomorrow",Type:0,Effects:[[E.CRIT_RATE,.2,.2],[E.CRIT_DMG,.2,.2]],Stars:3},{Name:"QingceHouseholdDish",Type:0,Effects:[[E.ATK_FLAT,274,274]],Stars:3},{Name:"RockinRiffinChicken",Type:0,Effects:[[E.CRIT_RATE,.16,.16]],Stars:2},{Name:"ShimiChazuke",Type:1,Effects:[[E.HEALING_BONUS,.25,.25]],Stars:3},{Name:"ShowMetheMora",Type:0,Effects:[[E.ATK_FLAT,274,274]],Stars:3},{Name:"TheOnlyTruth",Type:0,Effects:[[E.ATK_FLAT,114,114]],Stars:2}],We=[...V_].sort((e,a)=>e.Stars===a.Stars?e.Name.localeCompare(a.Name):a.Stars-e.Stars).map(e=>fn(e)),Kn=new Q(e=>e.Name);Kn.AddList(We);var ne=new Map,Yn;for(const e of We)ne.has(e.Type)||ne.set(e.Type,[]),(Yn=ne.get(e.Type))==null||Yn.push(e);function x_(){return We}function Fn(e){return Kn.Find(e)}function U_(e){return ne.get(e)||[]}function kn(e){const a={},s={},n={};for(const _ of e.GetEffects())s[_.Options.Name]=Ve(_);const r=e.GetWeapon();r&&(a[r.Options.Name]=Nn(r));const i=e.GetArtifacts();i&&st.Values().forEach(_=>n[_]=vn(i.Get(_)));const c=e.GetModifiers().map(_=>({stat:_.GetProp(),value:_.GetValue()}));return{character:$s(e.GetCharacter()),weapon:a,effects:s,artifacts:n,modifiers:c}}function Vn(e,a){const s=a.GetWeapon();if(s){const r=e.weapon[s.Options.Name];r&&dn(r,s)}const n=a.GetArtifacts();n&&st.Values().forEach(r=>{const i=e.artifacts[r];i&&yn(i,n.Get(r))});for(const r of a.GetEffects()){const i=e.effects[r.Options.Name];!i||xe(i,r)}a.ClearModifiers();for(const{stat:r,value:i}of e.modifiers)a.AddModifier(a.GetCharacter().CreateModifier(r,i));Qs(e.character,a.GetCharacter())}function xn(e){const a={};for(const i of e.GetMembers())a[i.GetCharacter().Options.Name]=kn(i);const s={};for(const i of e.GetResonances())s[i.Options.Name]=Ve(i);const n={};for(const i of e.GetAllEffects()){const c=i.Owner.GetCharacter().Options.Name;n[c]||(n[c]={}),n[c][i.Options.Name]=i.GetTargets().map(_=>_.GetCharacter().Options.Name)}const r=e.GetFoods().GetAll().map(i=>[i.Name,i.GetRank()]);return{characters:a,resonances:s,targets:n,foods:r}}function je(e,a){const s=a.GetMembers();for(const n of s){const r=e.characters[n.GetCharacter().Options.Name];r&&Vn(r,n)}for(const n of a.GetResonances()){const r=e.resonances[n.Options.Name];r&&xe(r,n)}for(const n of a.GetAllEffects()){const r=n.Owner.GetCharacter().Options.Name,i=n.Options.Name,c=e.targets[r];if(!c)continue;const _=c[i];if(!_)continue;const u=[];for(const A of s)_.includes(A.GetCharacter().Options.Name)&&u.push(A);n.ApplyMultiple(u)}if(a.GetFoods().Clear(),e.foods)for(const[n,r]of e.foods){const i=Fn(n);if(!i)continue;a.GetFoods().Add(i).SetRank(r)}}var Lt={};D(Lt,{Artbox:()=>q_});var tt={};D(tt,{ArchaicPetra:()=>Rr,Berserker:()=>Ir,BlizzardStrayer:()=>Or,BloodstainedChivalry:()=>Ar,BraveHeart:()=>Sr,CrimsonWitchOfFlames:()=>dr,DeepwoodMemories:()=>Gr,DefenderWill:()=>hr,DesertPavilionChronicle:()=>Qn,EchoesOfAnOffering:()=>mr,EmblemOfSeveredFate:()=>pr,FindByName:()=>re,FlowerOfParadiseLost:()=>$n,Gambler:()=>ur,GetList:()=>Dr,GildedDreams:()=>_r,GladiatorsFinale:()=>Cr,GoldenTroupe:()=>jn,HeartOfDepth:()=>Tr,HuskOfOpulentDreams:()=>Er,Instructor:()=>Lr,Lavawalker:()=>cr,MaidenBeloved:()=>or,MarechausseeHunter:()=>Wn,MartialArtist:()=>lr,NoblesseOblige:()=>fr,NymphsDream:()=>qn,OceanHuedClam:()=>ir,PaleFlame:()=>rr,ResolutionOfSojourner:()=>nr,RetracingBolide:()=>sr,Scholar:()=>ar,ShimenawasReminiscence:()=>Mr,TenacityOfTheMillelith:()=>er,TheExile:()=>tr,ThunderingFury:()=>Zn,Thundersoother:()=>Jn,VermillionHereafter:()=>Xn,ViridescentVenerer:()=>gr,VourukashasGlow:()=>zn,WanderersTroupe:()=>Nr});var Un={};D(Un,{ArchaicPetra:()=>Rr,Berserker:()=>Ir,BlizzardStrayer:()=>Or,BloodstainedChivalry:()=>Ar,BraveHeart:()=>Sr,CrimsonWitchOfFlames:()=>dr,DeepwoodMemories:()=>Gr,DefenderWill:()=>hr,DesertPavilionChronicle:()=>Qn,EchoesOfAnOffering:()=>mr,EmblemOfSeveredFate:()=>pr,FlowerOfParadiseLost:()=>$n,Gambler:()=>ur,GildedDreams:()=>_r,GladiatorsFinale:()=>Cr,GoldenTroupe:()=>jn,HeartOfDepth:()=>Tr,HuskOfOpulentDreams:()=>Er,Instructor:()=>Lr,Lavawalker:()=>cr,MaidenBeloved:()=>or,MarechausseeHunter:()=>Wn,MartialArtist:()=>lr,NoblesseOblige:()=>fr,NymphsDream:()=>qn,OceanHuedClam:()=>ir,PaleFlame:()=>rr,ResolutionOfSojourner:()=>nr,RetracingBolide:()=>sr,Scholar:()=>ar,ShimenawasReminiscence:()=>Mr,TenacityOfTheMillelith:()=>er,TheExile:()=>tr,ThunderingFury:()=>Zn,Thundersoother:()=>Jn,VermillionHereafter:()=>Xn,ViridescentVenerer:()=>gr,VourukashasGlow:()=>zn,WanderersTroupe:()=>Nr});var Wn=I.Set({Name:"MarechausseeHunter",Stars:5,Piece2:[l.Factory({Name:"MarechausseeHunter2",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"MarechausseeHunter4",MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.12).Stacks().Build()})]}),jn=I.Set({Name:"GoldenTroupe",Stars:5,Piece2:[l.Factory({Name:"GoldenTroupe2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.2).Build()})],Piece4:[l.Factory({Name:"GoldenTroupe4",MaxConditions:1,Conditions:["OFF_FIELD","ON_FIELD"],OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.25).Next().Where({effect:{conditions:["OFF_FIELD"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.25).Build()})]}),zn=I.Set({Name:"VourukashasGlow",Stars:5,Piece2:[l.Factory({Name:"VourukashasGlow2",OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2).Build()})],Piece4:[l.Factory({Name:"VourukashasGlow4",MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.1).Next().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.1).Next().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.08).Stacks().Next().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.08).Stacks().Next().Build()})]}),qn=I.Set({Name:"NymphsDream",Stars:5,Piece2:[l.Factory({Name:"NymphsDream2",OnApply:new l.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"NymphsDream4",MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Stacks([0,.07,.16,.25]).Next().stat.Char(t.stat.HYDRO_DMG).Stacks([0,.04,.09,.15]).Build()})]}),$n=I.Set({Name:"FlowerOfParadiseLost",Stars:5,Piece2:[l.Factory({Name:"FlowerOfParadiseLost2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[l.Factory({Name:"FlowerOfParadiseLost4",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.BLOOM_DMG,t.stat.HYPERBLOOM_DMG,t.stat.BURGEON_DMG).Values(.4).Next().stat.Char(t.stat.BLOOM_DMG,t.stat.HYPERBLOOM_DMG,t.stat.BURGEON_DMG).Values(.4*.25).Stacks().Next().Build()})]}),Qn=I.Set({Name:"DesertPavilionChronicle",Stars:5,Piece2:[l.Factory({Name:"DesertPavilionChronicle2",OnApply:new l.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"DesertPavilionChronicle4",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.4).Build()})]}),Xn=I.Set({Name:"VermillionHereafter",Stars:5,Piece2:[l.Factory({Name:"VermillionHereafter2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"VermillionHereafter4",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.08).Next().stat.Char(t.stat.ATK_PERCENT).Values(.1).Stacks().Build()})]}),Jn=I.Set({Name:"Thundersoother",Stars:5,Piece2:[],Piece4:[l.Factory({Name:"Thundersoother4",OnApply:new l.Builder().Where({enemy:{affected:[t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.35).Build()})]}),Zn=I.Set({Name:"ThunderingFury",Stars:5,Piece2:[l.Factory({Name:"ThunderingFury2",OnApply:new l.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"ThunderingFury4",OnApply:new l.Builder().stat.Char(t.stat.OVERLOAD_DMG,t.stat.ELECTROCHARGE_DMG,t.stat.SUPERCONDUCT_DMG,t.stat.HYPERBLOOM_DMG).Values(.4).Next().stat.Char(t.stat.AGGRAVATE_DMG).Values(.2).Build()})]}),tr=I.Set({Name:"TheExile",Stars:4,Piece2:[l.Factory({Name:"TheExile2",OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[]}),er=I.Set({Name:"TenacityOfTheMillelith",Stars:5,Piece2:[l.Factory({Name:"TenacityOfTheMillelith2",OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2).Build()})],Piece4:[l.Factory({Name:"TenacityOfTheMillelith4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()})]}),ar=I.Set({Name:"Scholar",Stars:4,Piece2:[l.Factory({Name:"Scholar2",OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[]}),sr=I.Set({Name:"RetracingBolide",Stars:5,Piece2:[],Piece4:[l.Factory({Name:"RetracingBolide4",OnApply:new l.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.4).Build()})]}),nr=I.Set({Name:"ResolutionOfSojourner",Stars:4,Piece2:[l.Factory({Name:"ResolutionOfSojourner2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"ResolutionOfSojourner4",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_RATE).Values(.3).Build()})]}),rr=I.Set({Name:"PaleFlame",Stars:5,Piece2:[l.Factory({Name:"PaleFlame2",OnApply:new l.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.25).Build()})],Piece4:[l.Factory({Name:"PaleFlame4",MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.09).Stacks().Next().stat.Char(t.stat.PHYSICAL_DMG).Stacks([0,0,.25]).Build()})]}),ir=I.Set({Name:"OceanHuedClam",Stars:5,Piece2:[l.Factory({Name:"OceanHuedClam2",OnApply:new l.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.15).Build()})],Piece4:[l.Factory({Name:"OceanHuedClam4",MaxStacks:3e4,OnApply(e,a,s){const[,,n]=s.Instance(e,"Extra",Ye("HIT_OceanHuedClam",e.GetCharacter()));n.Options.Def=!1,n.Options.Crit=!1,n.Options.Dmg=!1;const r=s.Modifier(n.Subject.CreateModifier(t.stat.DMG_FLAT,0));function i(){const c=a.GetStacks()*.9;r.SetValue(c)}return i(),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_STACKS,i)),()=>0}})]}),lr=I.Set({Name:"MartialArtist",Stars:4,Piece2:[l.Factory({Name:"MartialArtist2",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"MartialArtist4",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.25).Build()})]}),or=I.Set({Name:"MaidenBeloved",Stars:5,Piece2:[l.Factory({Name:"MaidenBeloved2",OnApply:new l.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.15).Build()})],Piece4:[]}),cr=I.Set({Name:"Lavawalker",Stars:5,Piece2:[],Piece4:[l.Factory({Name:"Lavawalker4",OnApply:new l.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.35).Build()})]}),Er=I.Set({Name:"HuskOfOpulentDreams",Stars:5,Piece2:[l.Factory({Name:"HuskOfOpulentDreams2",OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Build()})],Piece4:[l.Factory({Name:"HuskOfOpulentDreams4",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT,t.stat.GEO_DMG).Values(.06).Stacks().Build()})]}),Tr=I.Set({Name:"HeartOfDepth",Stars:5,Piece2:[l.Factory({Name:"HeartOfDepth2",OnApply:new l.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"HeartOfDepth4",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.3).Build()})]}),_r=I.Set({Name:"GildedDreams",Stars:5,Piece2:[l.Factory({Name:"GildedDreams2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[l.Factory({Name:"GildedDreams4",OnApply(e,a,s){const n=e.GetCharacter(),r=n.Options.Element,i=s.Modifier(n.CreateModifier(t.stat.ELEMENTAL_MASTERY,0)),c=s.Modifier(n.CreateModifier(t.stat.ATK_PERCENT,0));function _(){const u=e.GetParty();if(!u){i.SetValue(0),c.SetValue(0);return}let A=0,S=0;for(const h of u.GetMembers())h!==e&&(h.GetCharacter().Options.Element===r?A++:S++);A=Math.min(3,A),S=Math.min(3,S),c.SetValue(.14*A),i.SetValue(50*S)}return _(),s.Observer(e.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,_)),()=>0}})]}),ur=I.Set({Name:"Gambler",Stars:4,Piece2:[l.Factory({Name:"Gambler2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.2).Build()})],Piece4:[]}),Ar=I.Set({Name:"BloodstainedChivalry",Stars:5,Piece2:[l.Factory({Name:"BloodstainedChivalry2",OnApply:new l.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.25).Build()})],Piece4:[l.Factory({Name:"BloodstainedChivalry4",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.5).Build()})]}),Sr=I.Set({Name:"BraveHeart",Stars:4,Piece2:[l.Factory({Name:"BraveHeart2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"BraveHeart4",OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.3).Build()})]}),hr=I.Set({Name:"DefendersWill",Stars:4,Piece2:[l.Factory({Name:"DefendersWill2",OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Build()})],Piece4:[]}),mr=I.Set({Name:"EchoesOfAnOffering",Stars:5,Piece2:[l.Factory({Name:"EchoesOfAnOffering2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"EchoesOfAnOffering4",Conditions:["AVERAGE","MAXIMUM"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["MAXIMUM"]}}).mv.Mv(t.stat.ATK,.7,e=>e.Options.Talent===t.stat.NORMAL_ATTACK_DMG).Next().Where({effect:{conditions:["AVERAGE"]}}).mv.Mv(t.stat.ATK,.7*.502,e=>e.Options.Talent===t.stat.NORMAL_ATTACK_DMG).Build()})]}),fr=I.Set({Name:"NoblesseOblige",Stars:5,Piece2:[l.Factory({Name:"NoblesseOblige2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.2).Build()})],Piece4:[l.Factory({Name:"NoblesseOblige4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()})]}),Lr=I.Set({Name:"Instructor",Stars:4,Piece2:[l.Factory({Name:"Instructor2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[l.Factory({Name:"Instructor4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(120).Build()})]}),pr=I.Set({Name:"EmblemOfSeveredFate",Stars:5,Piece2:[l.Factory({Name:"EmblemOfSeveredFate2",OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[l.Factory({Name:"EmblemOfSeveredFate4",OnApply:new l.Builder().observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.25).Map((e,a)=>Math.max(0,Math.min(.75,e*a.GetCharacter().Get(t.stat.ENERGY_RECHARGE)))).Build()})]}),Nr=I.Set({Name:"WanderersTroupe",Stars:5,Piece2:[l.Factory({Name:"WanderersTroupe2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[l.Factory({Name:"WanderersTroupe4",OnApply:new l.Builder().stat.Where({target:{weapon:[t.weapon.BOW,t.weapon.CATALYST]}}).Char(t.stat.CHARGED_ATTACK_DMG).Values(.35).Build()})]}),dr=I.Set({Name:"CrimsonWitchOfFlames",Stars:5,Piece2:[l.Factory({Name:"CrimsonWitchOfFlames2",OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"CrimsonWitchOfFlames4",MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.VAPORIZE_DMG,t.stat.MELT_DMG).Values(.15).Next().stat.Char(t.stat.OVERLOAD_DMG,t.stat.BURGEON_DMG,t.stat.BURNING_DMG).Values(.4).Next().stat.Char(t.stat.PYRO_DMG).Values(.075).Stacks().Build()})]}),Cr=I.Set({Name:"GladiatorsFinale",Stars:5,Piece2:[l.Factory({Name:"GladiatorsFinale2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"GladiatorsFinale4",OnApply:new l.Builder().Where({target:{weapon:[t.weapon.CLAYMORE,t.weapon.SWORD,t.weapon.POLEARM]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.35).Build()})]}),Mr=I.Set({Name:"ShimenawasReminiscence",Stars:5,Piece2:[l.Factory({Name:"ShimenawasReminiscence2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[l.Factory({Name:"ShimenawasReminiscence4",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.5).Build()})]}),gr=I.Set({Name:"ViridescentVenerer",Stars:5,Piece2:[l.Factory({Name:"ViridescentVenerer2",OnApply:new l.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"ViridescentVenerer4_1",OnApply:new l.Builder().stat.Char(t.stat.SWIRL_DMG).Values(.6).Build()}),l.Factory({Name:"ViridescentVenerer4",ApplyOther:!0,ValidAuras:t.Swirlable,MaxAuras:5,OnApply(e,a,s){const n=e.GetCharacter().GetEnemy(),r=j_.map(c=>s.Modifier(n.Subject.CreateModifier(c,0)));function i(){if(a.Owner.GetCharacter().Options.Element!==t.stat.ANEMO_DMG)return;const c=a.GetAuras().map(_=>t.DmgToRes(t.AuraToDmg(_)));for(const _ of r)c.includes(_.GetProp())?_.SetValue(W_):_.SetValue(0)}return i(),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,i)),()=>0}})]}),W_=-.4,j_=t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG).map(e=>t.DmgToRes(e)),Gr=I.Set({Name:"DeepwoodMemories",Stars:5,Piece2:[l.Factory({Name:"DeepwoodMemories2",OnApply:new l.Builder().stat.Char(t.stat.DENDRO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"DeepwoodMemories4",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.DENDRO_RES).Values(-.3).Build()})]}),Rr=I.Set({Name:"ArchaicPetra",Stars:5,Piece2:[l.Factory({Name:"ArchaicPetra2",OnApply:new l.Builder().stat.Char(t.stat.GEO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"ArchaicPetra4",MaxAuras:1,ApplyOther:!0,ValidAuras:t.Swirlable,OnApply(e,a,s){const n=e.GetCharacter(),r=t.Elements.filter(c=>c!==t.stat.PHYSICAL_DMG).map(c=>s.Modifier(n.CreateModifier(c,0)));function i(){const c=a.GetAuras().map(_=>t.AuraToDmg(_));for(const _ of r)c.includes(_.GetProp())?_.SetValue(.4):_.SetValue(0)}return s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,i)),()=>0}})]}),Ir=I.Set({Name:"Berserker",Stars:4,Piece2:[l.Factory({Name:"Berserker2",OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.12).Build()})],Piece4:[l.Factory({Name:"Berserker4",OnApply:new l.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.CRIT_RATE).Values(.24).Build()})]}),Or=I.Set({Name:"BlizzardStrayer",Stars:5,Piece2:[l.Factory({Name:"BlizzardStrayer2",OnApply:new l.Builder().stat.Char(t.stat.CRYO_DMG).Values(.15).Build()})],Piece4:[l.Factory({Name:"BlizzardStrayer4",OnApply:new l.Builder().Where({enemy:{affected:[t.stat.CRYO_DMG]}}).stat.Char(t.stat.EXTRA_CRIT_RATE).Values(.2).Next().Where({enemy:{aura:[t.aura.FROZEN]}}).stat.Char(t.stat.EXTRA_CRIT_RATE).Values(.2).Next().Build()})]}),z_=Object.values(Un).sort((e,a)=>e.Stars===a.Stars?e.Name.localeCompare(a.Name):e.Stars-a.Stars),ze=new Q(e=>e.Name);ze.AddList(z_);function Dr(){return ze.Get()}function re(e){return ze.Find(e)}function qe(e){const a=[];for(const r of e){if(!r)continue;const i=a.find(c=>c[0].toLowerCase()===r.toLowerCase());i?i[1]++:a.push([r.toLowerCase(),1])}const s=[],n=[];for(const r of a)r[1]>=4?(s.push([r[0],4]),n.push(r[0]),n.push(r[0])):r[1]>=2&&(s.push([r[0],2]),n.push(r[0]));return[s,n]}var q_=class{constructor(e){this.target=e,this.effects=new Q(a=>a.Options.Name),this.sets=[],this.artifacts=st.Values().map(a=>{const s=new Dn(a).Equip(e.GetCharacter());return s.Event.CreateObserver(q.CHANGE_SET,()=>this.onChangeSet()),s})}GetArtifacts(){return this.artifacts}GetActiveSets(){return this.sets}onChangeSet(){const[e,a]=qe(this.artifacts.map(s=>s.GetSet()||""));this.effects.Get().forEach(s=>s.Disable().UnapplyAll()),this.effects.Clear(),this.sets=a;for(const[s,n]of e){if(!s)continue;const r=re(s);!r||(n>=2&&r.Piece2.map(i=>{const c=i(this.target).Enable();return c.Apply(this.target),c}).forEach(i=>this.effects.Add(i)),n>=4&&r.Piece4.map(i=>{const c=i(this.target).Enable();return c.Apply(this.target),c}).forEach(i=>this.effects.Add(i)))}}UnequipAll(){return this.artifacts.forEach(e=>e.Unequip()),this}EquipAll(){return this.artifacts.forEach(e=>e.Equip(this.target.GetCharacter())),this}GetEffects(){return this.effects.Get()}FindEffect(e){return this.effects.Find(e)}Get(e){return this.artifacts[e]}Remove(){this.UnequipAll(),this.effects.Get().forEach(e=>e.Disable().UnapplyAll())}EquipRolls(e){try{const a=bn(k({stars:5,mainstats:[this.artifacts[2].GetMainstat(),this.artifacts[3].GetMainstat(),this.artifacts[4].GetMainstat()]},e));return this.artifacts.forEach((s,n)=>{const r=a[n];s.ClearSubstats(),r.forEach(([i,c],_)=>{s.SubstatsLength()<=_?s.AddSubstat(i,c):(s.SetSubstat(_,i),s.SetSubstatValue(_,c))})}),!0}catch(a){return console.error("[EQUIP SUBSTATS]",a),!1}}RollSummary(){const e=vr(),a=[],s={};for(const n of this.artifacts){const r=n.Rolls();for(const[i,c]of r){s[i]===void 0&&(s[i]=a.length,a.push([i,vr()]));const[,_]=a[s[i]];for(let u=0;u<4;u++)_[u]+=c[u]||0,e[u]+=c[u]||0,_[4]+=c[u]||0,e[4]+=c[u]||0}for(let i=0;i<n.SubstatsLength();i++){const c=n.GetSubstat(i),_=n.GetSubstatValue(i),u=Math.round(_/nt(n.GetStars(),c,4));e[5]+=u,a[s[c]][1][5]+=u}}return{result:a,total:e}}},vr=()=>[0,0,0,0,0,0],ie={};D(ie,{Rotation:()=>$_});var $_=class{constructor(){this.characters=new Q(e=>e.GetCharacter().Options.Name),this.actions=[],this.damage=0,this.Duration=NaN,this.details=[]}SetCharacters(...e){return this.characters.Clear(),this.characters.AddList(e),this}Run(){let e=-1;return this.Log&&(e=this.Log.line),this.damage=0,this.details=[],this.actions.forEach(a=>this.runAction(a)),this.Log&&this.Log.setLine(e),this.damage}AddFn(e,a){return this.actions.push({fn:e,line:a}),this}AddHit(e,a,s,n,r,i){return r=Math.max(0,Math.min(1,r)),n=Math.max(0,Math.min(r,n)),this.actions.push({hit:{charname:e,hitname:a,multiplier:s,aura:r,reaction:n},line:i}),this}Clear(){return this.actions=[],this}GetDetails(){const e={};return this.details.forEach((a,s)=>{e[a.charname]||(e[a.charname]=[]),e[a.charname][s]=a}),e}GetSummary(){const e={damage:this.damage,dps:this.damage/this.Duration,duration:this.Duration,characters:{}};for(const a of this.characters.Get())e.characters[a.GetCharacter().Options.Name]={relative:0,damage:0,dps:0,elements:{},talents:{},instances:{}};for(const{charname:a,hitname:s,talent:n,element:r,damage:i}of this.details){const c=e.characters[a];c.damage+=i,c.elements[r]||(c.elements[r]={damage:0,relative:0}),c.elements[r].damage+=i,c.talents[n]||(c.talents[n]={damage:0,relative:0}),c.talents[n].damage+=i,c.instances[s]||(c.instances[s]={damage:0,relative:0}),c.instances[s].damage+=i}for(const a in e.characters){const s=e.characters[a];s.dps=s.damage/this.Duration,s.relative=s.damage/this.damage;for(const n in s.instances)s.instances[n].relative=s.instances[n].damage/s.damage;for(const n in s.talents)s.talents[n].relative=s.talents[n].damage/s.damage;for(const n in s.elements)s.elements[n].relative=s.elements[n].damage/s.damage}return e}getCharacter(e){const a=this.characters.Find(e);return a||this.Log&&this.Log.errorf("Character not found: %s",e),a}getInstance(e,a){const s=this.getCharacter(e);if(!s)return;const n=s.FindInstance(a);return n||this.Log&&this.Log.errorf("Instance %s not found in character %s",a,e),n}addDamage(e){this.damage+=e.damage,this.Log&&this.details.push(e)}runAction(e){if(e.line&&this.Log&&this.Log.setLine(e.line),e.fn){e.fn();return}if(!e.hit)return;const{hit:a}=e,s=this.getCharacter(a.charname);if(!s)return;const n=this.getInstance(a.charname,a.hitname);if(!n)return;const r=s.GetCharacter().Options.Name,i=n.Options.Name,c=s.GetCharacter().GetEnemy(),_=c.GetAuras(),u=n.DmgAvg(!0),A=n.DmgAvg(!1);c.SetAuras();const S=n.DmgAvg(!1),h=S;c.SetAuras(..._);const m=qs(S,h,A,u,a.aura,a.reaction),f=a.multiplier*m;this.addDamage({charname:r,hitname:i,talent:n.Options.Talent,element:n.GetElement(),damage:f,single_damage:m,multiplier:a.multiplier,auras:_,noaura_noreaction:S,noaura_yesreaction:h,yesaura_noreaction:A,yesaura_yesreaction:u,aura:a.aura,reaction:a.reaction}),this.Log&&this.Log.logf("%s hit %s did (%.2f * %.2f) = %.2f damage",r,i,a.multiplier,m,f)}},pt={};D(pt,{Albedo:()=>fi,Alhaitham:()=>mi,Amber:()=>hi,Ayaka:()=>ii,Ayato:()=>ri,Beidou:()=>Li,Bennett:()=>gi,Chongyun:()=>Ai,Collei:()=>ui,Cyno:()=>_i,Dehya:()=>br,Diluc:()=>Ti,Eula:()=>Ei,Faruzan:()=>Kr,FindByName:()=>jp,Fischl:()=>Gi,Furina:()=>Pr,Ganyu:()=>ci,GetList:()=>Di,Gorou:()=>oi,HuTao:()=>Ni,Itto:()=>Si,Jean:()=>li,Kazuha:()=>Ri,Keqing:()=>ni,Klee:()=>si,Kokomi:()=>Jr,Mika:()=>Br,Mona:()=>ai,Nahida:()=>Oi,Neuvillette:()=>wr,Nilou:()=>Fr,Ningguang:()=>ei,Noelle:()=>ti,Raiden:()=>Mi,Rosaria:()=>Zr,Sara:()=>Ii,Shenhe:()=>Xr,Sucrose:()=>Qr,Tartaglia:()=>$r,Venti:()=>qr,Wanderer:()=>zr,Xiangling:()=>jr,Xiao:()=>Wr,Xingqiu:()=>pi,Yae:()=>Ur,Yanfei:()=>xr,Yelan:()=>di,Yoimiya:()=>Vr,Yunjin:()=>kr,Zhongli:()=>Ci});var yr={};D(yr,{Albedo:()=>fi,Alhaitham:()=>mi,Amber:()=>hi,Ayaka:()=>ii,Ayato:()=>ri,Beidou:()=>Li,Bennett:()=>gi,Chongyun:()=>Ai,Collei:()=>ui,Cyno:()=>_i,Dehya:()=>br,Diluc:()=>Ti,Eula:()=>Ei,Faruzan:()=>Kr,Fischl:()=>Gi,Furina:()=>Pr,Ganyu:()=>ci,Gorou:()=>oi,HuTao:()=>Ni,Itto:()=>Si,Jean:()=>li,Kazuha:()=>Ri,Keqing:()=>ni,Klee:()=>si,Kokomi:()=>Jr,Mika:()=>Br,Mona:()=>ai,Nahida:()=>Oi,Neuvillette:()=>wr,Nilou:()=>Fr,Ningguang:()=>ei,Noelle:()=>ti,Raiden:()=>Mi,Rosaria:()=>Zr,Sara:()=>Ii,Shenhe:()=>Xr,Sucrose:()=>Qr,Tartaglia:()=>$r,Venti:()=>qr,Wanderer:()=>zr,Xiangling:()=>jr,Xiao:()=>Wr,Xingqiu:()=>pi,Yae:()=>Ur,Yanfei:()=>xr,Yelan:()=>di,Yoimiya:()=>Vr,Yunjin:()=>kr,Zhongli:()=>Ci});var T={};D(T,{ArrObjTable:()=>iu,Artifact:()=>au,ArtifactRolls:()=>nu,Character:()=>J_,Effect:()=>tu,EffectDetail:()=>eu,Enemy:()=>lu,Food:()=>Tu,Horizontal:()=>At,Instance:()=>X_,ObjArrTable:()=>ru,Rotation:()=>cu,Table:()=>Y,hits:()=>Q_,labels:()=>v});var Y=class{constructor(...e){this.DecimalPlaces=2,this.HeaderLine=!0,this.rows=[e],this.n_cols=e.length}AddRow(...e){for(;e.length<this.n_cols;)e.push("");return this.rows.push(e),this}GetHeaders(){return this.rows[0]}GetRows(){return this.rows.slice(1)}toString(){return this.String()}String(){const e=this.n_cols,a=this.rows.length,s=[],n=[];for(let i=0;i<e;i++){let c=0;for(let _=0;_<a;_++){const u=this.rows[_][i];let A;typeof u=="number"?A=u.toFixed(this.DecimalPlaces):A=(u==null?void 0:u.toString())||"",A.length>c&&(c=A.length),s[_*e+i]=A}n[i]=c}for(let i=0;i<e;i++)for(let c=0;c<a;c++){const _=n[i];for(;s[c*e+i].length<_;)s[c*e+i]+=" "}let r="";for(let i=0;i<a;i++){for(let c=0;c<e;c++)r+=s[i*e+c]+" | ";if(this.HeaderLine&&i===0){r+=`
`;const c=r.length;for(let _=0;_<c;_++)r+="-"}r+=`
`}return r}RemoveColumn(e){for(const a of this.rows)a.splice(e,1);return this.n_cols--,this}RemoveColumns(...e){e.sort((a,s)=>s-a);for(const a of e)this.RemoveColumn(a);return this}RemoveEmptyColumns(){const e=this.n_cols;for(let a=e-1;a>=0;a--){let s=!0;for(let n=1;n<this.rows.length;n++)if(this.rows[n][a]){s=!1;break}s&&this.RemoveColumn(a)}return this}};function Hr(...e){const a={};return e.forEach(s=>{if(typeof s=="string")a[s]=s;else for(const n in s)a[n]=n}),a}var Q_=Hr("HIT_N1","HIT_N1_1","HIT_N1_2","HIT_N1_3","HIT_N1_4","HIT_N2","HIT_N2_1","HIT_N2_2","HIT_N2_3","HIT_N2_4","HIT_N3","HIT_N3_1","HIT_N3_2","HIT_N3_3","HIT_N3_4","HIT_N4","HIT_N4_1","HIT_N4_2","HIT_N4_3","HIT_N4_4","HIT_N5","HIT_N5_1","HIT_N5_2","HIT_N5_3","HIT_N5_4","HIT_N6","HIT_N6_1","HIT_N6_2","HIT_N6_3","HIT_N6_4","HIT_CHARGED","HIT_CHARGED_1","HIT_CHARGED_2","HIT_CHARGED_3","HIT_CHARGED_4","HIT_CHARGED_SPIN","HIT_CHARGED_FINAL","HIT_PLUNGE","HIT_PLUNGE_LOW","HIT_PLUNGE_HIGH","HIT_AIMED_NORMAL","HIT_AIMED_CHARGED","HIT_E","HIT_E_PRESS","HIT_E_HOLD","HIT_E_DOT","HIT_E_1","HIT_E_1_1","HIT_E_1_2","HIT_E_2","HIT_E_2_1","HIT_E_2_2","HIT_E_3","HIT_E_3_1","HIT_E_3_2","HIT_E_4","HIT_E_EXPLOSION","HIT_Q","HIT_Q_EXPLOSION","HIT_Q_DOT","HIT_Q_1","HIT_Q_2","HIT_Q_3","HIT_WEAPON_HIT","HIT_WEAPON_HIT_N1","HIT_WEAPON_HIT_N2","HIT_WEAPON_HIT_N3","HIT_WEAPON_HIT_N4","HIT_WEAPON_HIT_N5","HIT_WEAPON_HIT_N6","HIT_OVERLOAD","HIT_SHATTER","HIT_SUPERCONDUCT","HIT_ELECTROCHARGE","HIT_SWIRL_PYRO","HIT_SWIRL_HYDRO","HIT_SWIRL_CRYO","HIT_SWIRL_ELECTRO","HIT_BLOOM","HIT_HYPERBLOOM","HIT_BURNING","HIT_BURGEON"),v=Hr("REGION","NONE","NAME","MV","STAT","HIT","ELEMENT","TALENT","VALUE","NO_CRIT","CRIT","AVG","STAT_BASE","STAT_FLAT","STAT_PERCENT","STAT_TOTAL","SET","PIECE","LEVEL","BONUS","STARS","CHARACTER","ASCENDED","CURRENT","WEAPON","ARTIFACT","EFFECT","ENABLED","STACKS","AURA","TARGET","CONDITION","DAMAGE","MIN","MAX","HIT","OWNER","RELATIVE","BENEFIT","ROTATION_DAMAGE","DPS");function X_(...e){const a=new Y(v.HIT,v.ELEMENT,v.TALENT,v.NO_CRIT,v.CRIT,v.AVG);return e.forEach(s=>a.AddRow(s.Options.Name,t.stat.Name(s.GetElement()),t.stat.Name(s.Options.Talent),s.DmgNoCrit(!0),s.DmgCrit(!0),s.DmgAvg(!0))),a.String()}function J_(...e){const a=[];for(let s=0;s<e.length;s++)a[2*s]=Z_(e[s]),a[2*s+1]=" ".repeat(4);return At(...a)}function Z_(e){var a;const s=e.GetCharacter();let n;s.IsAscended()?n="+":n="";let r=`(${s.Options.Stars}*) ${s.Options.Name} ${s.GetLevel()}${n}`;r+=` (${s.Get(t.stat.NORMAL_ATTACK_LEVEL)}/${s.Get(t.stat.ELEMENTAL_SKILL_LEVEL)}/${s.Get(t.stat.ELEMENTAL_BURST_LEVEL)})
`;const i=e.GetWeapon();i?(i.IsAscended()?n="+":n="",r+=`(${i.Options.Stars}*) ${i.Options.Name} ${i.GetLevel()}${n} (R${i.GetRank()})
`):r+=`(No weapon)
`;const c=(a=e.GetArtifacts())==null?void 0:a.GetActiveSets();if(c&&c.length>0){const A=c.map(S=>{var h;return(h=re(S))==null?void 0:h.Name});A[0]===A[1]?r+=A[0]+` (4)
`:A.forEach(S=>{S&&S!==""&&(r+=S+` (2)
`)})}const _=new Y(v.STAT,v.VALUE);_.DecimalPlaces=4,_.AddRow(t.stat.Name(t.stat.ATK),s.Get(t.stat.ATK)),_.AddRow(t.stat.Name(t.stat.DEF),s.Get(t.stat.DEF)),_.AddRow(t.stat.Name(t.stat.HP),s.Get(t.stat.HP)),_.AddRow(t.stat.Name(t.stat.CRIT_RATE),s.Get(t.stat.CRIT_RATE)),_.AddRow(t.stat.Name(t.stat.CRIT_DMG),s.Get(t.stat.CRIT_DMG)),_.AddRow(t.stat.Name(t.stat.ENERGY_RECHARGE),s.Get(t.stat.ENERGY_RECHARGE)),_.AddRow(t.stat.Name(t.stat.ELEMENTAL_MASTERY),s.Get(t.stat.ELEMENTAL_MASTERY));const u=s.Options.Element;return _.AddRow(t.stat.Name(u),s.Get(u)),r+=_.String(),r}function tu(...e){const a=new Y(v.NAME,v.ENABLED,v.STACKS,v.OWNER,v.TARGET);for(const s of e){const n=s.GetTargets().map(r=>r.GetCharacter().Options.Name);a.AddRow(s.Options.Name,s.Enabled(),s.GetStacks(),s.Owner.GetCharacter().Options.Name,n.join(", "))}return a.String()}function eu(e){let a=e.Options.Name+`
`;const s=new Y(v.OWNER,v.ENABLED,v.STACKS);s.AddRow(e.Owner.GetCharacter().Options.Name,e.Enabled(),e.GetStacks()+"/"+e.Options.MaxStacks),a+=s.String()+`
`;const n=new Y(v.TARGET);for(const c of e.GetTargets())n.AddRow(c.GetCharacter().Options.Name);const r=new Y(v.CONDITION);for(const c of e.Options.Conditions)r.AddRow(c+" ("+e.HasCondition(c)+")");const i=new Y(v.AURA);for(const c of t.aura.Values())e.HasAura(c)&&i.AddRow(t.aura.Name(c));return a+=At(n.String(),r.String(),i.String()),a}function au(...e){const a=[];for(let s=0;s<e.length;s++)a[2*s]=su(e[s]),a[2*s+1]=" ".repeat(4);return At(...a)}function su(e){let a=`(${e.GetStars()}*) ${t.piece.Name(e.GetPiece())} (+${e.GetLevel()})
`;const s=e.GetSet();if(s){const r=re(s);r?a+=v.SET+": "+r.Name+`
`:a+=v.SET+": "+v.NONE+`
`}else a+=v.SET+": "+v.NONE+`
`;const n=new Y(v.STAT,v.VALUE);n.DecimalPlaces=4,n.AddRow(t.stat.Name(e.GetMainstat()),e.GetMainstatValue());for(let r=0;r<e.SubstatsLength();r++)n.AddRow(t.stat.Name(e.GetSubstat(r)),e.GetSubstatValue(r));return a+=n.String(),a}function nu(e){const a=e.FormatRolls(),s=new Y(v.STAT,"","","","","","");return a.forEach(([n,r])=>s.AddRow(t.stat.Name(n),...r)),s.DecimalPlaces=4,`${t.piece.Name(e.GetPiece())}
`+s}function ru(e){const a=Object.keys(e),s=new Y(...a),n=Math.max(...a.map(r=>e[r].length));for(let r=0;r<n;r++){const i=[];for(const c of a)r<e[c].length?i.push(e[c][r]):i.push(void 0);s.AddRow(...i)}return s}function iu(e){const a=[];for(const n of e){const r=Object.keys(n);for(const i of r)a.includes(i)||a.push(i)}const s=new Y(...a);for(const n of e)s.AddRow(...a.map(r=>n[r]));return s}function lu(...e){const a=[];for(let s=0;s<e.length;s++)a[2*s]=ou(e[s]),a[2*s+1]=" ".repeat(4);return At(...a)}function ou(e){const a=new Y(v.STAT,v.STAT_BASE,v.STAT_TOTAL);a.AddRow(v.LEVEL,"",e.GetLevel());for(const n of t.Elements){const r=t.DmgToRes(n);a.AddRow(t.stat.Name(r),e.GetBaseRes(r),e.Subject.Get(r))}const s=new Y(v.AURA);for(const n of t.aura.Values())e.HasAura(n)&&s.AddRow(t.aura.Name(n));return a.DecimalPlaces=4,e.name+`
`+At(a.String(),s.String())}function cu(e){const a=Object.keys(e.characters).map(n=>n+`
`+Eu(n,e.characters[n])),s=[];for(let n=0;n<a.length;n++)s[2*n]=a[n],s[2*n+1]=" ".repeat(4);return`${v.ROTATION_DAMAGE}: ${e.damage.toFixed(2)}

${v.DPS}: ${e.dps.toFixed(2)}

`+At(...s)}function Eu(e,a){const s=new Y(v.NAME,v.DAMAGE,v.RELATIVE);s.AddRow(e,a.damage,le(a.relative));for(const n in a.elements){const r=parseInt(n);s.AddRow(t.stat.Name(r),a.elements[n].damage,le(a.elements[n].relative))}for(const n in a.talents){const r=parseInt(n);s.AddRow(t.stat.Name(r),a.talents[n].damage,le(a.talents[n].relative))}for(const n in a.instances)s.AddRow(n,a.instances[n].damage,le(a.instances[n].relative));return s.toString()}var le=e=>e*100;function Tu(...e){const a=new Y("NAME","STARS","TYPE","EFFECTS");for(const s of e){const n=(()=>{if(s instanceof Ot.Food){const r=s.GetRank();return s.Options.Effects.map(([i,c,_])=>{const u=c+(_-c)*(r-1)/2;return`${t.stat.Name(i)}: ${u}`}).join(", ")}else return s.Effects.map(([r,i,c])=>`${t.stat.Name(r)}: ${i}-${c}`).join(", ")})();a.AddRow(s.Name,s.Stars,s.Type,n)}return a.String()}var _u=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4839}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4373}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5512}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.733}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7422}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]},{Name:"HIT_ARKHE",Element:t.stat.HYDRO_DMG,Talent:t.stat.NONE,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.0946}]}],uu=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0786}]},{Name:T.hits.HIT_E_1,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0596}]},{Name:T.hits.HIT_E_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0323}]},{Name:T.hits.HIT_E_3,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0829}]}],Au=l.Factory({Name:"FurinaE",OnApply(e,a,s){const n=Su(e,a,s),r=[],i=()=>{for(const u of r)s.RemoveObserver(u);let c=[];const _=e.GetParty();_&&(c=_.GetMembers());for(const u of c){if(u===e)continue;const A=s.Observer(u.GetCharacter().CreateObserver(t.stat.HP_CURRENT,n));r.push(A)}};return s.Observer(e.Event.CreateObserver(ut.CHANGE_PARTY,i)),i(),()=>0}}),Su=new l.Builder().observe.Party(!0).observe.Target(t.stat.HP_CURRENT).mv.Multiplier(1,/E_\d/).Map((e,a)=>{let s=[];const n=a.GetParty();n?s=n.GetMembers():s=[a];let r=0;for(const i of s)i.GetCharacter().Get(t.stat.HP_CURRENT)>.5&&r++;return r=Math.min(r,4),1+r/10}).Build(),hu=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1141}]}],mu=l.Factory({Name:"FurinaQ",MaxStacks:400,ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ALL_DMG).Values(1).Stacks().Map((e,a,s)=>{let r=.05+.02*s.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL);return r=r*e/100,r}).Build()}),fu=l.Factory({Name:"FurinaA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.HP,t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ALL_DMG).Instance(/E_\d/).Values(.7/100).Map((e,a)=>Math.min(.28,e*a.GetCharacter().Get(t.stat.HP)/1e3)).Build()}),Lu=l.Factory({Name:"FurinaC2",MaxStacks:400,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.35/100).Stacks().Build()}),pu=l.Factory({Name:"FurinaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Nu=l.Factory({Name:"FurinaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),du=l.Factory({Name:"FurinaC6",Conditions:["ARKHE_PNEUMA"],MaxConditions:1,OnApply:new l.Builder().infusion.Set(t.stat.HYDRO_DMG,!0).Next().mv.Mv(t.stat.HP,.18,/N\d|Charged|Plunge/i).Next().Where({effect:{conditions:["ARKHE_PNEUMA"]}}).mv.Mv(t.stat.HP,.25,/N\d|Charged|Plunge/i).Build()}),Pr=G.Factory({Name:"Furina",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.SWORD,StatBonus:t.stat.CRIT_RATE,BurstCost:60,Region:t.region.FONTAINE,Normals:_u,Skills:uu,Bursts:hu,Extra:[],Effects:[Au,mu,fu,Lu,pu,Nu,du],HpBase:[1191.65,4893.5590820312],AtkBase:[18.9924,77.987365722656],DefBase:[54.146148681641,222.35850524902]}),Cu=[{Name:T.hits.HIT_N1,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5458}]},{Name:T.hits.HIT_N2,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4625}]},{Name:T.hits.HIT_N3,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.7234}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.368}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.HP,Scaling:o.TalentScaling.PHYSICAL_1,Initial:.0732}]},{Name:T.hits.HIT_CHARGED+"_C6",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.HP,Scaling:o.TalentScaling.NONE,Initial:.1}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],Mu=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1286}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.208}]}],gu=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.2226}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0911}]}],Gu=l.Factory({Name:"NeuvilletteA1",MaxStacks:3,OnApply:new l.Builder().Where({target:{ascension:1}}).mv.Multiplier(1,"HIT_CHARGED_2","HIT_CHARGED_C6").Map((e,a,s)=>[0,1.1,1.25,1.6][s.GetStacks()]).Build()}),Ru=l.Factory({Name:"NeuvilletteA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.HP_CURRENT).stat.Char(t.stat.HYDRO_DMG).Values(1).Map((e,a)=>Math.min(.3,.6*Math.max(0,a.GetCharacter().Get(t.stat.HP_CURRENT)-.3))).Build()}),Iu=l.Factory({Name:"NeuvilletteC2",OnApply(e,a,s){const n=e.FindEffect("NeuvilletteA1");if(!n)throw new Error("NeuvilletteC2: Could not find NeuvilletteA1");const r=e.FindInstance("HIT_CHARGED_2"),i=e.FindInstance("HIT_CHARGED_C6");if(!r)throw new Error("NeuvilletteC2: Could not find HIT_CHARGED_2");if(!i)throw new Error("NeuvilletteC2: Could not find HIT_CHARGED_C6");const c=s.Modifier(r.Subject.CreateModifier(t.stat.CRIT_DMG,0)),_=s.Modifier(i.Subject.CreateModifier(t.stat.CRIT_DMG,0)),u=()=>{if(e.GetCharacter().GetAscension()<1){c.SetValue(0),_.SetValue(0);return}const A=n.GetStacks();c.SetValue(.14*A),_.SetValue(.14*A)};return u(),s.Observer(n.CreateObserver(l.EffectEvent.CHANGE_STACKS,u)),s.Observer(e.GetCharacter().CreateObserver(t.stat.LEVEL,u)),s.Observer(e.GetCharacter().CreateObserver(t.stat.ASCENSION,u)),()=>0}}),Ou=l.Factory({Name:"NeuvilletteC3",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_LEVEL_UP).Values(3).Build()}),Du=l.Factory({Name:"NeuvilletteC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),wr=G.Factory({Name:"Neuvillette",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.CATALYST,StatBonus:t.stat.CRIT_DMG,BurstCost:70,Region:t.region.FONTAINE,HpBase:[1143.984,4697.8169],AtkBase:[16.218,66.595],DefBase:[44.8725,184.275],Normals:Cu,Skills:Mu,Bursts:gu,Extra:[],Effects:[Gu,Ru,Iu,Ou,Du]}),vu=l.Factory({Name:"MikaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),yu=l.Factory({Name:"MikaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Hu=l.Factory({Name:"MikaC6",ApplyOther:!0,MaxTargets:1,OnApply:new l.Builder().stat.Char(t.stat.PHYSICAL_CRIT_DMG).Values(.6).Build()}),Pu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4326}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.415}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.545}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2761}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7087}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1275}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],wu=l.Factory({Name:"MikaA1",MaxStacks:4,ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.PHYSICAL_DMG).Values(.1).Stacks().Build()}),Bu=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.252}]}],Br=G.Factory({Name:"Mika",Element:t.stat.CRYO_DMG,Stars:4,Weapon:t.weapon.POLEARM,StatBonus:t.stat.HP_PERCENT,BurstCost:70,Region:t.region.MONDSTADT,HpBase:[1048.5597,3751.7275],AtkBase:[18.6984,66.90411],DefBase:[59.800125,213.96375],Normals:Pu,Skills:Bu,Bursts:[],Extra:[],Effects:[wu,vu,yu,Hu]}),bu=[{Name:T.hits.HIT_N1+"_Q",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.987},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0169}]},{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.393},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.0239}]}],Ku=l.Factory({Name:"DehyaC1",OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2).Next().mv.Mv(t.stat.HP,.036,e=>e.Options.Talent===t.stat.ELEMENTAL_SKILL_DMG).Next().mv.Mv(t.stat.HP,.06,e=>e.Options.Talent===t.stat.ELEMENTAL_BURST_DMG).Build()}),Yu=l.Factory({Name:"DehyaC2",OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Instance("HIT_E_DOT").Values(.5).Build()}),Fu=l.Factory({Name:"DehyaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),ku=l.Factory({Name:"DehyaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Vu=l.Factory({Name:"DehyaC6",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.1).Next().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_DMG).Values(.15).Stacks().Build()}),xu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6212}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6171}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7663}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9529}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5633}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0182}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],Uu=[{Name:T.hits.HIT_E_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1288}]},{Name:T.hits.HIT_E_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.328}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.602},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0103}]}],br=G.Factory({Name:"Dehya",Stars:5,Element:t.stat.PYRO_DMG,Weapon:t.weapon.CLAYMORE,StatBonus:t.stat.HP_PERCENT,Region:t.region.SUMERU,BurstCost:70,HpBase:[1220.2496,5011.0044],AtkBase:[20.6682,84.8686],DefBase:[48.88111,200.7369],Normals:xu,Skills:Uu,Bursts:bu,Extra:[],Effects:[Ku,Yu,Fu,ku,Vu]}),Wu=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.776}]}],ju=l.Factory({Name:"FaruzanQ",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.ANEMO_RES).Values(-.3).Next().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ANEMO_DMG).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(e=>e*.18).Build()}),zu=l.Factory({Name:"FaruzanC3",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),qu=l.Factory({Name:"FaruzanC5",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),$u=l.Factory({Name:"FaruzanC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ANEMO_CRIT_DMG).Values(.4).Build()}),Qu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4473}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4219}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5316}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7062}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],Xu=l.Factory({Name:"FaruzanA4",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:4}}).observe.Owner(t.stat.ATK_BASE).stat.Char(t.stat.ANEMO_DMG_FLAT).Values(.32).Map((e,a,s)=>s.Owner.GetCharacter().Get(t.stat.ATK_BASE)*e).Build()}),Ju=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.488}]},{Name:T.hits.HIT_E_2,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.08}]}],Kr=G.Factory({Name:"Faruzan",Stars:4,Element:t.stat.ANEMO_DMG,Weapon:t.weapon.BOW,StatBonus:t.stat.ATK_PERCENT,BurstCost:80,Region:t.region.SUMERU,HpBase:[802.3761,2870.8872],AtkBase:[16.4724,58.939335],DefBase:[52.647,188.37],Normals:Qu,Skills:Ju,Bursts:Wu,Extra:[],Effects:[ju,Xu,zu,qu,$u]}),Zu=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1843}]},{Name:T.hits.HIT_Q_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.2253}]}],tA=l.Factory({Name:"NilouC1",OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Instance("HIT_E_3_1").Values(.65).Build()}),eA=l.Factory({Name:"NilouC2",ApplyOther:!0,Conditions:["BLOOM"],MaxConditions:1,OnApply:new l.Builder().Where({owner:{ascension:1}}).stat.Enemy(t.stat.HYDRO_RES).Values(-.35).Next().Where({owner:{ascension:1},effect:{conditions:["BLOOM"]}}).stat.Enemy(t.stat.DENDRO_RES).Values(-.35).Build()}),aA=l.Factory({Name:"NilouC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),sA=l.Factory({Name:"NilouC4",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.5).Build()}),nA=l.Factory({Name:"NilouC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),rA=l.Factory({Name:"NilouC6",OnApply:new l.Builder().observe.Target(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.Char(t.stat.CRIT_RATE).Values(.6/100).Map((e,a)=>Math.max(0,Math.min(.3,e*a.GetCharacter().Get(t.stat.HP)/1e3))).Next().observe.Target(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.Char(t.stat.CRIT_DMG).Values(1.2/100).Map((e,a)=>Math.max(0,Math.min(.6,e*a.GetCharacter().Get(t.stat.HP)/1e3))).Build()}),iA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5031}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4544}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7035}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5022}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5444}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}];function Yr(e){const a=e.GetParty();if(!a)return!1;let s=!1,n=!1;for(const r of a.GetMembers()){const i=r.GetCharacter().Options.Element;if(i===t.stat.DENDRO_DMG)s=!0;else if(i===t.stat.HYDRO_DMG)n=!0;else return!1}return s&&n}var lA=l.Factory({Name:"NilouA1",ApplyOther:!0,OnApply:new l.Builder().Where((e,a)=>a.GetCharacter().GetAscension()<1?!1:Yr(e)).observe.Party(!0).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100).Build()}),oA=l.Factory({Name:"NilouA4",ApplyOther:!0,OnApply:new l.Builder().Where((e,a)=>a.GetCharacter().GetAscension()<4?!1:Yr(e)).observe.Party(!0).observe.Owner(t.stat.HP_FLAT,t.stat.HP_BASE,t.stat.HP_PERCENT).stat.Char(t.stat.BLOOM_DMG).Values(.09).Map((e,a,s)=>Math.max(0,Math.min(4,(s.Owner.GetCharacter().Get(t.stat.HP)-3e4)*e/1e3))).Build()}),cA=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0334}]},{Name:T.hits.HIT_E_1+"_1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0455}]},{Name:T.hits.HIT_E_1+"_2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0326}]},{Name:T.hits.HIT_E_2+"_1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0514}]},{Name:T.hits.HIT_E_2+"_2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0396}]},{Name:T.hits.HIT_E_3+"_1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0717}]},{Name:T.hits.HIT_E_3+"_2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0506}]}],Fr=G.Factory({Name:"Nilou",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.SWORD,StatBonus:t.stat.HP_PERCENT,Region:t.region.SUMERU,BurstCost:70,HpBase:[1182.1168,4854.4106],AtkBase:[17.8752,73.39987],DefBase:[56.71884,232.9236],Normals:iA,Skills:cA,Bursts:Zu,Extra:[],Effects:[lA,oA,tA,eA,aA,sA,nA,rA]}),$e=new Set,Qe=[.025,.05,.075,.115];function EA(e){const a=e.FindEffect("YunjinA4");if(!a||!a.Enabled()||e.GetCharacter().GetAscension()<4)return 0;const s=e.GetParty();if(!s)return Qe[0];$e.clear();for(const r of s.GetMembers()){const i=r.GetCharacter().Options.Element;$e.add(i)}const n=Math.max(1,Math.min(Qe.length,$e.size));return Qe[n-1]}var TA=l.Factory({Name:"YunjinA4",OnApply(e,a,s){const n=e.FindEffect("YunjinQ");if(!n)throw new Error("Yunjin Burst effect not found");const r=n;function i(){r.Enabled()&&(r.Disable(),r.Enable())}return i(),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,i)),s.Observer(a.CreateObserver(l.EffectEvent.DISABLE,i)),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_TARGET,i)),()=>0}}),_A=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.44}]}],uA=l.Factory({Name:"YunjinQ",ApplyOther:!0,OnApply:new l.Builder().observe.Party(!0).observe.Owner(t.stat.DEF_PERCENT,t.stat.DEF_BASE,t.stat.DEF_FLAT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a,s)=>(.3216*e+EA(s.Owner))*s.Owner.GetCharacter().Get(t.stat.DEF)).Build()}),AA=l.Factory({Name:"YunjinC2",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.15).Build()}),SA=l.Factory({Name:"YunjinC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),hA=l.Factory({Name:"YunjinC4",OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.2).Build()}),mA=l.Factory({Name:"YunjinC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),fA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4051}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4025}]},{Name:T.hits.HIT_N3_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2296}]},{Name:T.hits.HIT_N3_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2752}]},{Name:T.hits.HIT_N4_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2399}]},{Name:T.hits.HIT_N4_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2881}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6734}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2169}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],LA=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.4912}]},{Name:T.hits.HIT_E_1,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.6096}]},{Name:T.hits.HIT_E_2,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.728}]}],kr=G.Factory({Name:"Yunjin",Stars:4,Weapon:t.weapon.POLEARM,Element:t.stat.GEO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Region:t.region.LIYUE,BurstCost:60,HpBase:[893.5552,3197.1245],AtkBase:[16.0272,57.34638],DefBase:[61.5741,220.311],Normals:fA,Skills:LA,Bursts:_A,Extra:[],Effects:[uA,TA,AA,SA,hA,mA]}),pA=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.272}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.22}]}],NA=l.Factory({Name:"YoimiyaC1",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()}),dA=l.Factory({Name:"YoimiyaC2",OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Values(.25).Build()}),CA=l.Factory({Name:"YoimiyaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),MA=l.Factory({Name:"YoimiyaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),gA=l.Factory({Name:"YoimiyaC6",OnApply:new l.Builder().instance.Location("Normal").Options({Name:"HIT_C6",Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Talent:t.stat.NORMAL_ATTACK_LEVEL,Initial:.164*.6}]}).Build()}),GA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3564}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6838}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8889}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4642}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0586}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_KindlingArrow",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.164}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],RA=l.Factory({Name:"YoimiyaA1",MaxStacks:10,OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.PYRO_DMG).Values(.02).Stacks().Build()}),IA=l.Factory({Name:"YoimiyaA4",ApplyOther:!0,ApplySelf:!1,OnApply(e,a,s){const n=e.GetCharacter(),r=a.Owner.GetCharacter(),i=a.Owner.FindEffect("YoimiyaA1");if(!i)throw new Error("Cannot find Yoimiya A1");const c=s.Modifier(n.CreateModifier(t.stat.ATK_PERCENT,0)),_=()=>{if(r.GetAscension()<4){c.SetValue(0);return}c.SetValue(.1+.01*i.GetStacks())};return _(),s.Observer(r.CreateObserver(t.stat.LEVEL,_)),s.Observer(r.CreateObserver(t.stat.ASCENSION,_)),s.Observer(i.CreateObserver(l.EffectEvent.CHANGE_STACKS,_)),()=>0}}),OA=l.Factory({Name:"YoimiyaE",OnApply:new l.Builder().infusion.Set(t.stat.PYRO_DMG,!0).Next().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.3791,/hit_n\d/i).Map((e,a)=>1+e*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),Vr=G.Factory({Name:"Yoimiya",Stars:5,Weapon:t.weapon.BOW,Element:t.stat.PYRO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.INAZUMA,BurstCost:60,HpBase:[791.2556,3249.3232],AtkBase:[25.137,103.21857],DefBase:[47.864,196.56],Normals:GA,Skills:[],Bursts:pA,Extra:[],Effects:[OA,RA,IA,NA,dA,CA,MA,gA]}),DA=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.824}]}],vA=l.Factory({Name:"YanfeiQ",OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(...o.TalentScaling.ELEMENTAL_2).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(e=>.334*e).Build()}),yA=l.Factory({Name:"YanfeiC2",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_RATE).Values(.2).Build()}),HA=l.Factory({Name:"YanfeiC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),PA=l.Factory({Name:"YanfeiC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),wA=[{Name:T.hits.HIT_N1,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5834}]},{Name:T.hits.HIT_N2,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5213}]},{Name:T.hits.HIT_N3,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.7601}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_2,Initial:.9823}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],BA=l.Factory({Name:"YanfeiA1",OnApply(e,a,s){const n=e.GetCharacter(),r=e.FindEffect("YanfeiSeal");if(!r)throw new Error("Cannot find Yanfei Scarlet Seals");const i=s.Modifier(n.CreateModifier(t.stat.PYRO_DMG,0)),c=()=>{if(n.GetAscension()<1){i.SetValue(0);return}i.SetValue(r.GetStacks()*.05)};return c(),s.Observer(r.CreateObserver(l.EffectEvent.CHANGE_STACKS,c)),s.Observer(n.CreateObserver(t.stat.LEVEL,c)),s.Observer(n.CreateObserver(t.stat.ASCENSION,c)),()=>0}}),bA=l.Factory({Name:"YanfeiA4",OnApply:new l.Builder().Where({target:{ascension:4}}).instance.Location("Normal").Options({Name:"HIT_A4",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Initial:.8,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),KA=l.Factory({Name:"YanfeiSeal",MaxStacks:4,OnApply:new l.Builder().observe.Target(t.stat.NORMAL_ATTACK_LEVEL,t.stat.NORMAL_ATTACK_LEVEL_UP).mv.Mv(t.stat.ATK,.1733,"HIT_CHARGED").Map((e,a,s)=>e*s.GetStacks()*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.NORMAL_ATTACK_LEVEL)-1]).Build()}),YA=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.696}]}],xr=G.Factory({Name:"Yanfei",Stars:4,Element:t.stat.PYRO_DMG,StatBonus:t.stat.PYRO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.LIYUE,BurstCost:80,HpBase:[784.14026,2805.64],AtkBase:[20.12304,72.001564],DefBase:[49.2135,176.085],Normals:wA,Skills:YA,Bursts:DA,Extra:[],Effects:[KA,vA,BA,bA,yA,HA,PA]}),FA=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.6}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.3382}]}],kA=l.Factory({Name:"YaeC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),VA=l.Factory({Name:"YaeC4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.2).Build()}),xA=l.Factory({Name:"YaeC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),UA=l.Factory({Name:"YaeC6",OnApply:new l.Builder().stat.Char(t.stat.DEFIGNORED).Instance(/HIT_E_\d/i).Values(.6).Build()}),WA=[{Name:T.hits.HIT_N1,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3966}]},{Name:T.hits.HIT_N2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3852}]},{Name:T.hits.HIT_N3,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5689}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4289}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],jA=l.Factory({Name:"YaeA4",OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({target:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.15/100).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()}),zA=[{Name:T.hits.HIT_E_1,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6067}]},{Name:T.hits.HIT_E_2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7584}]},{Name:T.hits.HIT_E_3,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.948}]},{Name:T.hits.HIT_E_4,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.185}]}],Ur=G.Factory({Name:"Yae",Stars:5,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_RATE,Weapon:t.weapon.CATALYST,Region:t.region.INAZUMA,BurstCost:90,HpBase:[807.46204,3315.8757],AtkBase:[26.4404,108.57064],DefBase:[44.2742,181.818],Normals:WA,Skills:zA,Bursts:FA,Extra:[],Effects:[jA,kA,VA,xA,UA]}),qA=l.Factory({Name:"XiaoQ",OnApply:new l.Builder().infusion.Set(t.stat.ANEMO_DMG,!0).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(...o.TalentScaling.ELEMENTAL_2).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(e=>.5845*e).Build()}),$A=l.Factory({Name:"XiaoC2",OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.25).Build()}),QA=l.Factory({Name:"XiaoC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),XA=l.Factory({Name:"XiaoC4",OnApply:new l.Builder().Where({target:{hp:{leq:.5}}}).stat.Char(t.stat.DEF_PERCENT).Values(1).Build()}),JA=l.Factory({Name:"XiaoC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),ZA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.2754}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.5694}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6855}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.3766}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.7154}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.9583}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.2109}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],tS=l.Factory({Name:"XiaoA1",MaxStacks:5,OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.ALL_DMG).Values(.05).Stacks().Build()}),eS=l.Factory({Name:"XiaoA4",MaxStacks:3,OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.15).Stacks().Build()}),aS=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.528}]}],Wr=G.Factory({Name:"Xiao",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.CRIT_RATE,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,BurstCost:70,HpBase:[991.4528,4071.4412],AtkBase:[27.1852,111.628975],DefBase:[62.2232,255.528],Normals:ZA,Skills:aS,Bursts:[],Extra:[],Effects:[qA,tS,eS,$A,QA,XA,JA]}),sS=[{Name:T.hits.HIT_Q_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]},{Name:T.hits.HIT_Q_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_Q_3,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.096}]},{Name:"HIT_PYRONADO",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.12}]}],nS=l.Factory({Name:"XianglingC1",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.PYRO_RES).Values(-.15).Build()}),rS=l.Factory({Name:"XianglingC2",OnApply:new l.Builder().instance.Options({Name:"HIT_C2",Element:t.stat.PYRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.75,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),iS=l.Factory({Name:"XianglingC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),lS=l.Factory({Name:"XianglingC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),oS=l.Factory({Name:"XianglingC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Build()}),cS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4205}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4214}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2606}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.141}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7104}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.2169}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],ES=l.Factory({Name:"XianglingA4",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.ATK_PERCENT).Values(.1).Build()}),TS=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1128}]}],jr=G.Factory({Name:"Xiangling",Stars:4,Element:t.stat.PYRO_DMG,StatBonus:t.stat.ELEMENTAL_MASTERY,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,BurstCost:80,HpBase:[911.791,3262.3718],AtkBase:[18.87648,67.54129],DefBase:[56.0805,200.655],Normals:cS,Skills:TS,Bursts:sS,Extra:[],Effects:[ES,nS,rS,iS,lS,oS]}),_S=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.472}]}],uS=l.Factory({Name:"WandererC1",OnApply(e,a,s){if(!e.FindEffect("WandererA4"))throw new Error("Cannot find Wanderer A4");let r;const i=()=>{const c=e.FindInstance("HIT_A4");!c||r||(r=s.Mv({Stat:t.stat.ATK,Value:.25,Enabled:!0},c))};return i(),s.Observer(e.GetCharacter().CreateObserver(t.stat.LEVEL,i)),s.Observer(e.GetCharacter().CreateObserver(t.stat.ASCENSION,i)),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,i)),s.Observer(a.CreateObserver(l.EffectEvent.DISABLE,i)),()=>0}}),AS=l.Factory({Name:"WandererC2",MaxStacks:120,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.04).Stacks().Map(e=>Math.min(2,e)).Build()}),SS=l.Factory({Name:"WandererC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),hS=l.Factory({Name:"WandererC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),mS=[{Name:T.hits.HIT_N1,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6871}]},{Name:T.hits.HIT_N2,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6502}]},{Name:T.hits.HIT_N3,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4764}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.3208}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]},{Name:T.hits.HIT_N1+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6871*.4}]},{Name:T.hits.HIT_N2+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6502*.4}]},{Name:T.hits.HIT_N3+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4764*.4}]}],fS=l.Factory({Name:"WandererA1",MaxAuras:1,ValidAuras:t.Swirlable,OnApply:new l.Builder().Where({target:{ascension:1},effect:{affected:[t.stat.PYRO_DMG]}}).stat.Char(t.stat.ATK_PERCENT).Values(.3).Next().Where({target:{ascension:1},effect:{affected:[t.stat.CRYO_DMG]}}).stat.Char(t.stat.CRIT_RATE).Values(.2).Build()}),LS=l.Factory({Name:"WandererA4",OnApply:new l.Builder().Where({target:{ascension:4}}).instance.Options({Name:"HIT_A4",Element:t.stat.ANEMO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.35,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),pS=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.952}]}],NS=l.Factory({Name:"WandererE",OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.3298,/hit_n\d/i).Map((e,a)=>1+e*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.2639,/hit_charged/i).Map((e,a)=>1+e*o.TalentScaling.ELEMENTAL_2[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),zr=G.Factory({Name:"Wanderer",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.SUMERU,BurstCost:60,HpBase:[791.2556,3249.3232],AtkBase:[25.5094,104.747734],DefBase:[47.2657,194.103],Normals:mS,Skills:pS,Bursts:_S,Extra:[],Effects:[NS,fS,LS,uS,AS,SS,hS]}),dS=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.376}]}],CS=l.Factory({Name:"VentiQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,s){MS(e,a,s);function n(){const r=e.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!r)return;const i=a.GetAuras()[0];!i||(r.Options.Element=t.AuraToDmg(i))}return n(),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,n)),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,n)),()=>0}}),MS=new l.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.188,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),gS=l.Factory({Name:"VentiC1",OnApply:new l.Builder().instance.Location("Normal").Options({Name:"HIT_C1",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:.4386*.33}]}).Next().instance.Location("Normal").Options({Name:"HIT_CHARGED_C1",Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:1.24*.33}]}).Next().Build()}),GS=l.Factory({Name:"VentiC2",ApplyOther:!0,Conditions:["AIRBORNE","NO_AIRBORNE"],MaxConditions:1,OnApply:new l.Builder().stat.Enemy(t.stat.ANEMO_RES,t.stat.PHYSICAL_RES).Values(-.12).Next().Where({effect:{conditions:["AIRBORNE"]}}).stat.Enemy(t.stat.ANEMO_RES,t.stat.PHYSICAL_RES).Values(-.12).Build()}),RS=l.Factory({Name:"VentiC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),IS=l.Factory({Name:"VentiC4",OnApply:new l.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.25).Build()}),OS=l.Factory({Name:"VentiC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),DS=l.Factory({Name:"VentiC6",ApplyOther:!0,OnApply(e,a,s){const n=e.GetCharacter().GetEnemy(),r=a.Owner.FindEffect("VentiQ");if(!r)throw new Error("Venti Q not found");s.Modifier(n.Subject.CreateModifier(t.stat.ANEMO_RES,-.2));const i=s.Modifier(n.Subject.CreateModifier(t.stat.ANEMO_RES,0)),c=()=>{const _=r.GetAuras();if(!_.length||_[0]===t.aura.NONE)i.SetValue(0);else{const u=t.DmgToRes(t.AuraToDmg(_[0]));i.SetValue(-.2),i.SetProp(u)}};return c(),s.Observer(r.CreateObserver(l.EffectEvent.CHANGE_AURAS,c)),()=>0}}),vS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2038}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4438}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5237}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2606}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5065}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7095}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],yS=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.76}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.8}]}],qr=G.Factory({Name:"Venti",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Weapon:t.weapon.BOW,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[819.8552,3366.7688],AtkBase:[20.482,84.10402],DefBase:[52.0521,213.759],Normals:vS,Skills:yS,Bursts:dS,Extra:[],Effects:[CS,gS,GS,RS,IS,OS,DS]}),HS=[{Name:T.hits.HIT_Q+"_MELEE",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.64}]},{Name:T.hits.HIT_Q+"_RANGED",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.784}]},{Name:"HIT_RiptideBlast",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2}]}],PS=l.Factory({Name:"TartagliaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),wS=l.Factory({Name:"TartagliaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),BS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4128}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4627}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5538}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5702}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6089}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7276}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_RiptideFlash",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.124}]},{Name:"HIT_RiptideBurst",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.62}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],bS=l.Factory({Name:"TartagliaA0",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_LEVEL_UP).Values(1).Build()}),KS=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]},{Name:T.hits.HIT_N1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3887}]},{Name:T.hits.HIT_N2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4162}]},{Name:T.hits.HIT_N3+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5633}]},{Name:T.hits.HIT_N4+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5994}]},{Name:T.hits.HIT_N5+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.553}]},{Name:T.hits.HIT_N6_1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3543}]},{Name:T.hits.HIT_N6_2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3767}]},{Name:T.hits.HIT_CHARGED_1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.602}]},{Name:T.hits.HIT_CHARGED_2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7198}]},{Name:"HIT_RiptideSlash",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.602}]}],$r=G.Factory({Name:"Tartaglia",Stars:5,Weapon:t.weapon.BOW,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.HYDRO_DMG,Region:t.region.SNEZHNAYA,BurstCost:60,HpBase:[1020.0524,4188.8867],AtkBase:[23.4612,96.33733],DefBase:[63.4198,260.442],Normals:BS,Skills:KS,Bursts:HS,Extra:[],Effects:[bS,PS,wS]}),YS=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.48}]}],FS=l.Factory({Name:"SucroseQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,s){kS(e,a,s);function n(){const r=e.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!r)return;const i=a.GetAuras()[0];!i||(r.Options.Element=t.AuraToDmg(i))}return n(),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,n)),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,n)),()=>0}}),kS=new l.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.44,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),VS=l.Factory({Name:"SucroseC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),xS=l.Factory({Name:"SucroseC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),US=l.Factory({Name:"SucroseC6",ApplyOther:!0,OnApply(e,a,s){const n=a.Owner.FindEffect("SucroseQ"),r=e.GetCharacter();if(!n)throw new Error("Cannot find Sucrose Q");const i=s.Modifier(r.CreateModifier(t.stat.PYRO_DMG,0)),c=()=>{const _=n.GetAuras();(!_.length||_[0]===t.aura.NONE)&&i.SetValue(0);const u=t.AuraToDmg(_[0]);i.SetProp(u),i.SetValue(.2)};return c(),s.Observer(n.CreateObserver(l.EffectEvent.CHANGE_AURAS,c)),()=>0}}),WS=[{Name:T.hits.HIT_N1,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3346}]},{Name:T.hits.HIT_N2,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3062}]},{Name:T.hits.HIT_N3,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3845}]},{Name:T.hits.HIT_N4,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4792}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.2016}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],jS=l.Factory({Name:"SucroseA1",ApplySelf:!1,ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(50).Build()}),zS=l.Factory({Name:"SucroseA4",ApplySelf:!1,ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_MASTERY).Where({owner:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(.2).Map((e,a,s)=>e*s.Owner.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()}),qS=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.112}]}],Qr=G.Factory({Name:"Sucrose",Stars:4,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ANEMO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.MONDSTADT,BurstCost:80,HpBase:[775.02234,2773.016],AtkBase:[14.2464,50.97456],DefBase:[58.94175,210.8925],Normals:WS,Skills:qS,Bursts:YS,Extra:[],Effects:[FS,jS,zS,VS,xS,US]}),$S=l.Factory({Name:"ShenheA1",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.CRYO_DMG).Values(.15).Build()}),QS=l.Factory({Name:"ShenheA4",ApplyOther:!0,Conditions:["PRESS","HOLD"],MaxConditions:1,OnApply:new l.Builder().Where({owner:{ascension:4},effect:{conditions:["PRESS"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.15).Next().Where({owner:{ascension:4},effect:{conditions:["HOLD"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.15).Build()}),XS=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.008}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3312}]}],JS=l.Factory({Name:"ShenheQ",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Enemy(t.stat.CRYO_RES,t.stat.PHYSICAL_RES).Values(-.06,-.07,-.08,-.09,-.1,-.11,-.12,-.13,-.14,-.15).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),ZS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4326}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4025}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5332}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2632}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6562}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1067}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],t0=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.392}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.888}]}],e0=l.Factory({Name:"ShenheE",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP,t.stat.ATK_PERCENT,t.stat.ATK_BASE,t.stat.ATK_FLAT).stat.Char(t.stat.CRYO_DMG_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a,s)=>.4566*e*s.Owner.GetCharacter().Get(t.stat.ATK)).Build()}),a0=l.Factory({Name:"ShenheC2",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.CRYO_CRIT_DMG).Values(.15).Build()}),s0=l.Factory({Name:"ShenheC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),n0=l.Factory({Name:"ShenheC4",MaxStacks:50,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.05).Stacks().Build()}),r0=l.Factory({Name:"ShenheC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Xr=G.Factory({Name:"Shenhe",Stars:5,Element:t.stat.CRYO_DMG,Weapon:t.weapon.POLEARM,StatBonus:t.stat.ATK_PERCENT,Region:t.region.LIYUE,BurstCost:80,HpBase:[1011.47253,4153.653],AtkBase:[23.6474,97.10191],DefBase:[64.6164,265.356],Normals:ZS,Skills:t0,Bursts:XS,Extra:[],Effects:[e0,JS,$S,QS,a0,s0,n0,r0]}),i0=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1042}]}],l0=l.Factory({Name:"KokomiQ",OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.0484,/HIT_N\d/i).Map((e,a)=>e*o.TalentScaling.ELEMENTAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.0678,/charged/i).Map((e,a)=>e*o.TalentScaling.ELEMENTAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.071,/HIT_E$/i).Map((e,a)=>e*o.TalentScaling.ELEMENTAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Build()}),o0=l.Factory({Name:"KokomiC1",OnApply:new l.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.HYDRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.HP,Initial:.3,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Build()}),c0=l.Factory({Name:"KokomiC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),E0=l.Factory({Name:"KokomiC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),T0=l.Factory({Name:"KokomiC6",OnApply:new l.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.4).Build()}),_0=[{Name:T.hits.HIT_N1,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6838}]},{Name:T.hits.HIT_N2,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6154}]},{Name:T.hits.HIT_N3,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.9431}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4832}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],u0=l.Factory({Name:"KokomiA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.HEALING_BONUS).Values(.25).Next().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Values(-1).Next().Build()}),A0=l.Factory({Name:"KokomiA4",OnApply(e,a,s){const n=e.GetCharacter(),r=e.FindEffect("KokomiQ");if(!r)throw new Error("Kokomi Q effect not found");const i=se(e.GetNormals(),[/HIT_N\d/i]),c=se(e.GetNormals(),[/charged/i]),_=s.Mv({Stat:t.stat.HP,Value:0,Enabled:!0},...i),u=s.Mv({Stat:t.stat.HP,Value:0,Enabled:!0},...c),A=()=>{(!r.Enabled()||n.GetAscension()<4)&&(_.Value=0,u.Value=0);const S=n.Get(t.stat.HEALING_BONUS);_.Value=u.Value=.15*S};return A(),s.Observer(n.CreateObserver(t.stat.HEALING_BONUS,A)),s.Observer(r.CreateObserver(l.EffectEvent.ENABLE,A)),s.Observer(r.CreateObserver(l.EffectEvent.DISABLE,A)),()=>0}}),S0=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.0919}]}],Jr=G.Factory({Name:"Kokomi",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.HYDRO_DMG,Region:t.region.INAZUMA,BurstCost:70,HpBase:[1048.652,4306.332],AtkBase:[18.2476,74.92904],DefBase:[51.15465,210.0735],Normals:_0,Skills:S0,Bursts:i0,Extra:[],Effects:[l0,u0,A0,o0,c0,E0,T0]}),h0=[{Name:T.hits.HIT_Q_1,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.04}]},{Name:T.hits.HIT_Q_2,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.52}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]}],m0=l.Factory({Name:"RosariaC1",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.1).Build()}),f0=l.Factory({Name:"RosariaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),L0=l.Factory({Name:"RosariaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),p0=l.Factory({Name:"RosariaC6",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.PHYSICAL_RES).Values(-.2).Build()}),N0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5246}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.516}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3182}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6966}]},{Name:T.hits.HIT_N5_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4162}]},{Name:T.hits.HIT_N5_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.43}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.3674}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],d0=l.Factory({Name:"RosariaA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Values(.12).Build()}),C0=l.Factory({Name:"RosariaA4",ApplySelf:!1,ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.CRIT_RATE).Where({owner:{ascension:4}}).stat.Char(t.stat.CRIT_RATE).Values(.15).Map((e,a,s)=>Math.max(0,Math.min(1,e*s.Owner.GetCharacter().Get(t.stat.CRIT_RATE)))).Build()}),M0=[{Name:T.hits.HIT_E_1,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.584}]},{Name:T.hits.HIT_E_2,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.36}]}],Zr=G.Factory({Name:"Rosaria",Stars:4,Weapon:t.weapon.POLEARM,Element:t.stat.CRYO_DMG,Region:t.region.MONDSTADT,StatBonus:t.stat.ATK_PERCENT,BurstCost:60,HpBase:[1030.3239,3686.4802],AtkBase:[20.12304,72.001564],DefBase:[59.514,212.94],Normals:N0,Skills:M0,Bursts:h0,Extra:[],Effects:[d0,C0,m0,f0,L0,p0]}),g0=[{Name:T.hits.HIT_Q_1,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672}]},{Name:T.hits.HIT_Q_2,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.928}]}],G0=l.Factory({Name:"NoelleQ",OnApply:new l.Builder().infusion.Set(t.stat.GEO_DMG,!0).Next().observe.Target(t.stat.DEF_FLAT,t.stat.DEF_PERCENT,t.stat.DEF_FLAT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(.4,.43,.46,.5,.53,.56,.6,.64,.68,.72,.76,.8,.85,.9,.95).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a)=>e*a.GetCharacter().Get(t.stat.DEF)).Build()}),R0=l.Factory({Name:"NoelleC2",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()}),I0=l.Factory({Name:"NoelleC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),O0=l.Factory({Name:"NoelleC4",OnApply:new l.Builder().instance.Location("Skill").Options({Name:"HIT_C4",Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:4}]}).Build()}),D0=l.Factory({Name:"NoelleC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),v0=l.Factory({Name:"NoelleC6",OnApply(e,a,s){const n=e.GetCharacter(),r=e.FindEffect("NoelleQ");if(!r)throw new Error("Noelle Q effect not found");const i=s.Modifier(n.CreateModifier(t.stat.ATK_FLAT,0)),c=()=>{r.Enabled()?i.SetValue(.5*n.Get(t.stat.DEF)):i.SetValue(0)};return c(),s.Observer(n.CreateObserver(t.stat.DEF_FLAT,c)),s.Observer(n.CreateObserver(t.stat.DEF_PERCENT,c)),s.Observer(n.CreateObserver(t.stat.DEF_BASE,c)),s.Observer(r.CreateObserver(l.EffectEvent.ENABLE,c)),s.Observer(r.CreateObserver(l.EffectEvent.DISABLE,c)),()=>0}}),y0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7912}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7336}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8626}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1343}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5074}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9047}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],H0=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:1.2}]}],ti=G.Factory({Name:"Noelle",Stars:4,Element:t.stat.GEO_DMG,StatBonus:t.stat.DEF_PERCENT,BurstCost:60,Region:t.region.MONDSTADT,Weapon:t.weapon.CLAYMORE,HpBase:[1012.088,3621.2327],AtkBase:[16.0272,57.34638],DefBase:[66.95325,239.5575],Normals:y0,Skills:H0,Bursts:g0,Extra:[],Effects:[G0,R0,I0,O0,D0,v0]}),P0=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.8696}]}],w0=l.Factory({Name:"NingguangC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),B0=l.Factory({Name:"NingguangC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),b0=[{Name:T.hits.HIT_N1,Element:t.stat.GEO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.28}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.7408}]},{Name:"HIT_Jade",Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.496}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],K0=l.Factory({Name:"NingguangA4",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.GEO_DMG).Values(.12).Build()}),Y0=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.304}]}],ei=G.Factory({Name:"Ningguang",Stars:4,Element:t.stat.GEO_DMG,StatBonus:t.stat.GEO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.LIYUE,BurstCost:40,HpBase:[820.6119,2936.1348],AtkBase:[17.808,63.7182],DefBase:[48.069,171.99],Normals:b0,Skills:Y0,Bursts:P0,Extra:[],Effects:[K0,w0,B0]}),F0=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.424}]}],k0=l.Factory({Name:"MonaQ",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ALL_DMG).Values(.4,.42,.44,.46,.48,.5,.52,.54,.56,.58,.6).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),V0=l.Factory({Name:"MonaC1",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELECTROCHARGE_DMG,t.stat.VAPORIZE_DMG).Values(.15).Next().stat.Char(t.stat.ALL_DMG).Instance("HIT_SWIRL_HYDRO").Values(.15).Build()}),x0=l.Factory({Name:"MonaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),U0=l.Factory({Name:"MonaC4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.15).Build()}),W0=l.Factory({Name:"MonaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),j0=l.Factory({Name:"MonaC6",MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.6).Stacks().Build()}),z0=[{Name:T.hits.HIT_N1,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.376}]},{Name:T.hits.HIT_N2,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.36}]},{Name:T.hits.HIT_N3,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.448}]},{Name:T.hits.HIT_N4,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5616}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.4972}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],q0=l.Factory({Name:"MonaA1",OnApply:new l.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_SKILL_LEVEL,Stat:t.stat.ATK,Initial:1.328*.5}]}).Build()}),$0=l.Factory({Name:"MonaA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.HYDRO_DMG).Values(.2).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ENERGY_RECHARGE)).Build()}),Q0=[{Name:T.hits.HIT_E_DOT,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.32}]},{Name:T.hits.HIT_E_EXPLOSION,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.328}]}],ai=G.Factory({Name:"Mona",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[810.322,3327.62],AtkBase:[22.344,91.74984],DefBase:[50.8555,208.845],Normals:z0,Skills:Q0,Bursts:F0,Extra:[],Effects:[k0,q0,$0,V0,x0,U0,W0,j0]}),X0=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4264}]}],J0=l.Factory({Name:"KleeC1",OnApply:new l.Builder().instance.Location("Burst").Options({Name:"HIT_C1",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:.4264*1.2}]}).Build()}),Z0=l.Factory({Name:"KleeC2",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.DEFREDUCTION).Values(.23).Build()}),th=l.Factory({Name:"KleeC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),eh=l.Factory({Name:"KleeC4",OnApply:new l.Builder().instance.Location("Burst").Options({Name:"HIT_C4",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:5.55}]}).Build()}),ah=l.Factory({Name:"KleeC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),sh=l.Factory({Name:"KleeC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Build()}),nh=[{Name:T.hits.HIT_N1,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.7216}]},{Name:T.hits.HIT_N2,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.624}]},{Name:T.hits.HIT_N3,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.8992}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.5736}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],rh=l.Factory({Name:"KleeA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.5).Build()}),ih=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.952}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.328}]}],si=G.Factory({Name:"Klee",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.PYRO_DMG,StatBonus:t.stat.PYRO_DMG,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[800.7888,3288.4717],AtkBase:[24.206,99.39566],DefBase:[47.864,196.56],Normals:nh,Skills:ih,Bursts:X0,Extra:[],Effects:[rh,J0,Z0,th,eh,ah,sh]}),lh=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.24}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.888}]}],oh=l.Factory({Name:"KeqingC1",OnApply:new l.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.5,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),ch=l.Factory({Name:"KeqingC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Eh=l.Factory({Name:"KeqingC4",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.25).Build()}),Th=l.Factory({Name:"KeqingC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),_h=l.Factory({Name:"KeqingC6",OnApply:new l.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.06).Build()}),uh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4102}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4102}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5444}]},{Name:T.hits.HIT_N4_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3148}]},{Name:T.hits.HIT_N4_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.344}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6699}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.768}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.86}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Ah=l.Factory({Name:"KeqingA1",OnApply:new l.Builder().Where({target:{ascension:1}}).infusion.Set(t.stat.ELECTRO_DMG,!1).Build()}),Sh=l.Factory({Name:"KeqingA4",OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.CRIT_RATE,t.stat.ENERGY_RECHARGE).Values(.15).Build()}),hh=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.504}]},{Name:T.hits.HIT_E+"_SLASH",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.68}]},{Name:T.hits.HIT_E+"_SLASH_2",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]}],ni=G.Factory({Name:"Keqing",Stars:5,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_DMG,Weapon:t.weapon.SWORD,Region:t.region.LIYUE,BurstCost:40,HpBase:[1020.0524,4188.8867],AtkBase:[25.137,103.21857],DefBase:[62.2232,255.528],Normals:uh,Skills:hh,Bursts:lh,Extra:[],Effects:[Ah,Sh,oh,ch,Eh,Th,_h]}),mh=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6646}]}],fh=l.Factory({Name:"AyatoQ",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.11,.12,.13,.14,.15,.16,.17,.18,.19,.2).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),Lh=l.Factory({Name:"AyatoC1",OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Instance(/HIT_N\d_E/i).Values(.4).Build()}),ph=l.Factory({Name:"AyatoC2",OnApply(e,a,s){const n=e.FindEffect("AyatoE");if(!n)throw new Error("Cannot find Ayato Skill");const r=s.Modifier(e.GetCharacter().CreateModifier(t.stat.HP_PERCENT,0)),i=function(){n.GetStacks()>=3?r.SetValue(.5):r.SetValue(0)};return i(),s.Observer(n.CreateObserver(l.EffectEvent.CHANGE_STACKS,i)),()=>0}}),Nh=l.Factory({Name:"AyatoC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),dh=l.Factory({Name:"AyatoC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Ch=l.Factory({Name:"AyatoC6",OnApply:new l.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:4.5}]}).Build()}),Mh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4496}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4716}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5861}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2945}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.756}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2953}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],gh=[{Name:T.hits.HIT_N1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5289}]},{Name:T.hits.HIT_N2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5891}]},{Name:T.hits.HIT_N3+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6493}]},{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0148}]}],Gh=l.Factory({Name:"AyatoE",MaxStacks:5,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Mv(t.stat.HP,.56/100,/HIT_N\d_E/i).Map((e,a,s)=>e*s.GetStacks()*o.TalentScaling.PHYSICAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),ri=G.Factory({Name:"Ayato",Stars:5,Weapon:t.weapon.SWORD,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.CRIT_DMG,Region:t.region.INAZUMA,BurstCost:80,HpBase:[1067.7184,4384.629],AtkBase:[23.275,95.57275],DefBase:[59.83,245.7],Normals:Mh,Skills:gh,Bursts:mh,Extra:[],Effects:[Gh,fh,Lh,ph,Nh,dh,Ch]}),Rh=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.123}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.6845}]}],Ih=l.Factory({Name:"AyakaC2",OnApply:new l.Builder().instance.Location("Burst").Options({Name:"HIT_C2",Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:1.123}]}).Build()}),Oh=l.Factory({Name:"AyakaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Dh=l.Factory({Name:"AyakaC4",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.DEFREDUCTION).Values(.3).Build()}),vh=l.Factory({Name:"AyakaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),yh=l.Factory({Name:"AyakaC6",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(2.98).Build()}),Hh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4573}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4868}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6262}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2265}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7818}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5513}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Ph=l.Factory({Name:"AyakaSprint",OnApply:new l.Builder().infusion.Set(t.stat.CRYO_DMG,!1).Build()}),wh=l.Factory({Name:"AyakaA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.3).Build()}),Bh=l.Factory({Name:"AyakaA4",OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.CRYO_DMG).Values(.18).Build()}),bh=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.392}]}],ii=G.Factory({Name:"Ayaka",Stars:5,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,Weapon:t.weapon.SWORD,Region:t.region.INAZUMA,BurstCost:80,HpBase:[1000.986,4110.59],AtkBase:[26.6266,109.33523],DefBase:[61.0266,250.614],Normals:Hh,Skills:bh,Bursts:Rh,Extra:[],Effects:[Ph,wh,Bh,Ih,Oh,Dh,vh,yh]}),Kh=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.248}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.784}]}],Yh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4833}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4558}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6029}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6588}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7921}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.6202}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Fh=l.Factory({Name:"JeanC1",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.4).Build()}),kh=l.Factory({Name:"JeanC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Vh=l.Factory({Name:"JeanC4",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.ANEMO_RES).Values(-.4).Build()}),xh=l.Factory({Name:"JeanC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Uh=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.92}]}],li=G.Factory({Name:"Jean",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.HEALING_BONUS,Weapon:t.weapon.SWORD,Region:t.region.MONDSTADT,BurstCost:80,HpBase:[1143.984,4697.817],AtkBase:[18.62,76.4582],DefBase:[59.83,245.7],Normals:Yh,Skills:Uh,Bursts:Kh,Extra:[],Effects:[Fh,kh,Vh,xh]}),Wh=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:.9822}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:.613}]}];function Xe(e){const a=e.GetParty();if(!a)return e.GetCharacter().Options.Element===t.stat.GEO_DMG?1:0;let s=0;for(const n of a.GetMembers())n.GetCharacter().Options.Element===t.stat.GEO_DMG&&s++;return s}var jh=l.Factory({Name:"GorouC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),zh=l.Factory({Name:"GorouC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),qh=l.Factory({Name:"GorouC6",ApplyOther:!0,OnApply:new l.Builder().observe.Party(!0).stat.Char(t.stat.GEO_CRIT_DMG).Values(.1,.2,.4).Rank(e=>Xe(e)).Build()}),$h=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3775}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3715}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4945}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.59}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],Qh=l.Factory({Name:"GorouA1",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.DEF_PERCENT).Values(.25).Build()}),Xh=l.Factory({Name:"GorouA4",OnApply:new l.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,1.56,"HIT_E").Next().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,.156,"HIT_Q","HIT_Q_DOT").Next().Build()}),Jh=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.072}]}],Zh=l.Factory({Name:"GorouE",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).observe.Party(!0).stat.Char(t.stat.DEF_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a)=>206.16*e*(Xe(a)>=1?1:0)).Next().observe.Party(!0).stat.Char(t.stat.GEO_DMG).Values(.15).Map((e,a)=>e*(Xe(a)>=3?1:0)).Build()}),oi=G.Factory({Name:"Gorou",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.GEO_DMG,StatBonus:t.stat.GEO_DMG,BurstCost:80,Region:t.region.INAZUMA,HpBase:[802.3761,2870.8872],AtkBase:[15.31488,54.797653],DefBase:[54.36375,194.5125],Normals:$h,Skills:Jh,Bursts:Wh,Extra:[],Effects:[Zh,Qh,Xh,jh,zh,qh]}),tm=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7027}]}],em=l.Factory({Name:"GanyuC1",ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.CRYO_RES).Values(-.15).Build()}),am=l.Factory({Name:"GanyuC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),sm=l.Factory({Name:"GanyuC4",ApplyOther:!0,MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.05).Stacks().Build()}),nm=l.Factory({Name:"GanyuC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),rm=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3173}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.356}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4549}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4549}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4825}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5762}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_Frostflake",Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.28}]},{Name:"HIT_FrostflakeBloom",Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.176}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],im=l.Factory({Name:"GanyuA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Instance(/Frostflake/i).Values(.2).Build()}),lm=l.Factory({Name:"GanyuA4",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.CRYO_DMG).Values(.2).Build()}),om=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]}],ci=G.Factory({Name:"Ganyu",Stars:5,Weapon:t.weapon.BOW,Region:t.region.LIYUE,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:60,HpBase:[762.656,3131.878],AtkBase:[26.068,107.04148],DefBase:[49.0606,201.474],Normals:rm,Skills:om,Bursts:tm,Extra:[],Effects:[im,lm,em,am,sm,nm]}),cm=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.456}]},{Name:"HIT_LightfallSword",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:3.6705}]}],Em=l.Factory({Name:"EulaQ",MaxStacks:30,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.7499,"HIT_LightfallSword").Map((e,a,s)=>{const n=Math.max(1,Math.min(15,a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)));return s.GetStacks()*e*o.TalentScaling.PHYSICAL_1A[n-1]}).Build()}),Tm=l.Factory({Name:"EulaC1",OnApply:new l.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.3).Build()}),_m=l.Factory({Name:"EulaC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),um=l.Factory({Name:"EulaC4",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.25).Build()}),Am=l.Factory({Name:"EulaC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Sm=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8973}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.9355}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.568}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1264}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7183}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.688}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.244}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.8629}]}],hm=l.Factory({Name:"EulaA1",OnApply:new l.Builder().Where({target:{ascension:1}}).instance.Location("Burst").Options({Name:"HIT_A1",Talent:t.stat.ELEMENTAL_BURST_DMG,Element:t.stat.PHYSICAL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:3.6705*.5}]}).Build()}),mm=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.464}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.456}]},{Name:"HIT_Icewhirl",Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]}],fm=l.Factory({Name:"EulaE_1",MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Stacks().Build()}),Lm=l.Factory({Name:"EulaE_2",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Enemy(t.stat.CRYO_RES,t.stat.PHYSICAL_RES).Values(-.16,-.17,-.18,-.19,-.2,-.21,-.22,-.23,-.24,-.25).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Build()}),Ei=G.Factory({Name:"Eula",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:80,Region:t.region.MONDSTADT,HpBase:[1029.5856,4228.035],AtkBase:[26.6266,109.33523],DefBase:[58.45391,240.0489],Normals:Sm,Skills:mm,Bursts:cm,Extra:[],Effects:[fm,Lm,Em,hm,Tm,_m,um,Am]}),pm=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.04}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.04}]}],Nm=l.Factory({Name:"DilucQ",OnApply:new l.Builder().infusion.Set(t.stat.PYRO_DMG,!1).Build()}),dm=l.Factory({Name:"DilucC1",OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.15).Build()}),Cm=l.Factory({Name:"DilucC2",MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.1).Stacks().Build()}),Mm=l.Factory({Name:"DilucC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),gm=l.Factory({Name:"DilucC4",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.4).Build()}),Gm=l.Factory({Name:"DilucC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Rm=l.Factory({Name:"DilucC6",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.3).Build()}),Im=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.897}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8763}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.9881}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.3399}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.688}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.247}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8951}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.7897}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.2355}]}],Om=l.Factory({Name:"DilucA4",OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.PYRO_DMG).Values(.2).Build()}),Dm=[{Name:T.hits.HIT_E_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.944}]},{Name:T.hits.HIT_E_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.976}]},{Name:T.hits.HIT_E_3,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.288}]}],Ti=G.Factory({Name:"Diluc",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.PYRO_DMG,StatBonus:t.stat.CRIT_RATE,BurstCost:40,Region:t.region.MONDSTADT,HpBase:[1010.5192,4149.7383],AtkBase:[26.068,107.04148],DefBase:[61.0266,250.614],Normals:Im,Skills:Dm,Bursts:pm,Extra:[],Effects:[Nm,Om,dm,Cm,Mm,gm,Gm,Rm]}),vm=[{Name:T.hits.HIT_N1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7828}]},{Name:T.hits.HIT_N2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8247}]},{Name:T.hits.HIT_N3+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0463}]},{Name:T.hits.HIT_N4+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5169}]},{Name:T.hits.HIT_N5+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.3084}]},{Name:T.hits.HIT_CHARGED+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0105}]},{Name:T.hits.HIT_PLUNGE+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],ym=l.Factory({Name:"CynoQ",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100).Build()}),Hm=l.Factory({Name:"CynoC2",MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.1).Stacks().Build()}),Pm=l.Factory({Name:"CynoC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),wm=l.Factory({Name:"CynoC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Bm=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4926}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4792}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2931}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7589}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2238}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],bm=l.Factory({Name:"CynoA1",OnApply:new l.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Initial:.35,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Next().Where({target:{ascension:1}}).stat.Char(t.stat.ALL_DMG).Instance("HIT_E","HIT_E_2").Values(.35).Build()}),Km=new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.DMG_FLAT).Instance(/N\d_Q$/i).Values(1.5).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build(),Ym=l.Factory({Name:"CynoA4",OnApply(e,a,s){Km(e,a,s);const n=e.GetCharacter(),r=e.FindEffect("CynoA1");let i;if(!r)throw new Error("Cannot find Cyno A1");function c(){if(!i){const _=e.FindInstance("HIT_A1");if(!_)return;i=s.Modifier(_.Subject.CreateModifier(t.stat.DMG_FLAT,0))}!i||(n.GetAscension()>=4?i.SetValue(2.5*n.Get(t.stat.ELEMENTAL_MASTERY)):i.SetValue(0))}c();for(const _ of l.EffectEvent.Values())s.Observer(r.CreateObserver(_,c));return s.Observer(n.CreateObserver(t.stat.ELEMENTAL_MASTERY,c)),s.Observer(n.CreateObserver(t.stat.LEVEL,c)),s.Observer(n.CreateObserver(t.stat.ASCENSION,c)),()=>0}}),Fm=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.568}]}],_i=G.Factory({Name:"Cyno",Stars:5,Weapon:t.weapon.POLEARM,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:80,Region:t.region.SUMERU,HpBase:[972.3864,3993.1443],AtkBase:[24.7646,101.68941],DefBase:[66.88994,274.6926],Normals:Bm,Skills:Fm,Bursts:vm,Extra:[],Effects:[ym,bm,Ym,Hm,Pm,wm]}),km=[{Name:T.hits.HIT_Q,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.0182}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4325}]}],Vm=l.Factory({Name:"ColleiC1",OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()}),xm=l.Factory({Name:"ColleiC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Um=l.Factory({Name:"ColleiC4",ApplyOther:!0,ApplySelf:!1,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60).Build()}),Wm=l.Factory({Name:"ColleiC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),jm=l.Factory({Name:"ColleiC6",OnApply:new l.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Initial:2}]}).Build()}),zm=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.436}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4266}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5409}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6803}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.DENDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],qm=l.Factory({Name:"ColleiA1",OnApply:new l.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Initial:.4}]}).Build()}),$m=[{Name:T.hits.HIT_E,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.512}]}],ui=G.Factory({Name:"Collei",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.DENDRO_DMG,StatBonus:t.stat.ATK_PERCENT,BurstCost:60,Region:t.region.SUMERU,HpBase:[820.6119,2936.1348],AtkBase:[16.73952,59.895107],DefBase:[50.358,180.18],Normals:zm,Skills:$m,Bursts:km,Extra:[],Effects:[qm,Vm,xm,Um,Wm,jm]}),Qm=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.424}]}],Xm=l.Factory({Name:"ChongyunC1",OnApply:new l.Builder().instance.Basic({Name:"HIT_C1",Element:t.stat.CRYO_DMG,Stat:t.stat.ATK,Values:[.5]}).Build()}),Jm=l.Factory({Name:"ChongyunC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Zm=l.Factory({Name:"ChongyunC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),tf=l.Factory({Name:"ChongyunC6",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.15).Build()}),ef=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6312}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8032}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0122}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5629}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0178}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],af=l.Factory({Name:"ChongyunA4",ApplyOther:!0,OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Enemy(t.stat.CRYO_RES).Values(-.1).Build()}),sf=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.7204}]}],nf=l.Factory({Name:"ChongyunE",ApplyOther:!0,OnApply:new l.Builder().infusion.Set(t.stat.CRYO_DMG,!1).Build()}),Ai=G.Factory({Name:"Chongyun",Stars:4,Element:t.stat.CRYO_DMG,Weapon:t.weapon.CLAYMORE,StatBonus:t.stat.ATK_PERCENT,BurstCost:40,Region:t.region.LIYUE,HpBase:[920.90894,3294.9956],AtkBase:[18.6984,66.90411],DefBase:[54.36375,194.5125],Normals:ef,Skills:sf,Bursts:Qm,Extra:[],Effects:[nf,af,Xm,Jm,Zm,tf]}),rf=l.Factory({Name:"IttoQ",OnApply:new l.Builder().observe.Target(t.stat.DEF_FLAT,t.stat.DEF_BASE,t.stat.DEF_PERCENT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a)=>.576*e*a.GetCharacter().Get(t.stat.DEF)).Next().infusion.Set(t.stat.GEO_DMG,!0).Build()}),lf=l.Factory({Name:"IttoC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),of=l.Factory({Name:"IttoC4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT,t.stat.ATK_PERCENT).Values(.2).Build()}),cf=l.Factory({Name:"IttoC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Ef=l.Factory({Name:"IttoC6",OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_DMG).Values(.7).Build()}),Tf=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7923}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7637}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9164}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1722}]},{Name:"HIT_KesagiriSlash",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9116}]},{Name:"HIT_KesagiriFinal",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.9092}]},{Name:"HIT_SaichimonjiSlash",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9047}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],_f=l.Factory({Name:"IttoA4",OnApply:new l.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,.35,/Kesagiri/i).Build()}),uf=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.072}]}],Si=G.Factory({Name:"Itto",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.GEO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.INAZUMA,BurstCost:70,HpBase:[1000.986,4110.59],AtkBase:[17.689,72.63529],DefBase:[74.66784,306.6336],Normals:Tf,Skills:uf,Bursts:[],Extra:[],Effects:[rf,_f,lf,of,cf,Ef]}),Af=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.2808}]}],Sf=l.Factory({Name:"AmberC1",OnApply:new l.Builder().instance.Location("Normal").Options({Name:"HIT_C1",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:1.24*.2}]}).Build()}),hf=l.Factory({Name:"AmberC2",OnApply:new l.Builder().mv.Mv(t.stat.ATK,2,/hit_e/i).Build()}),mf=l.Factory({Name:"AmberC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),ff=l.Factory({Name:"AmberC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Lf=l.Factory({Name:"AmberC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()}),pf=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3612}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3612}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4644}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5934}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],Nf=l.Factory({Name:"AmberA1",OnApply:new l.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.1).Build()}),df=l.Factory({Name:"AmberA4",OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()}),Cf=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.232}]}],hi=G.Factory({Name:"Amber",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.PYRO_DMG,StatBonus:t.stat.ATK_PERCENT,BurstCost:40,Region:t.region.MONDSTADT,HpBase:[793.2582,2838.2634],AtkBase:[18.6984,66.90411],DefBase:[50.358,180.18],Normals:pf,Skills:Cf,Bursts:Af,Extra:[],Effects:[Nf,df,Sf,hf,mf,ff,Lf]}),Mf=l.Factory({Name:"AlhaithamA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.1/100).Map((e,a)=>Math.min(1,e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY))).Build()}),gf=[{Name:T.hits.HIT_Q,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:.9728}]}],Gf=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4953}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5075}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3418}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6677}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8385}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5526}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Rf=[{Name:T.hits.HIT_E,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.936},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.5488}]},{Name:T.hits.HIT_E_DOT+"_1",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344}]},{Name:T.hits.HIT_E_DOT+"_2",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672*2},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344*2}]},{Name:T.hits.HIT_E_DOT+"_3",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672*3},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344*3}]}],If=l.Factory({Name:"AlhaithamE",OnApply:new l.Builder().infusion.Set(t.stat.DENDRO_DMG,!0).Build()}),Of=l.Factory({Name:"AlhaithamC2",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(50).Stacks().Build()}),Df=l.Factory({Name:"AlhaithamC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),vf=l.Factory({Name:"AlhaithamC4",MaxStacks:3,ApplyOther:!0,OnApply:new l.Builder().Where({target:{isOwner:!0}}).stat.Char(t.stat.DENDRO_DMG).Values(.1).Stacks().Next().Where({target:{isOwner:!1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(30).Stacks().Build()}),yf=l.Factory({Name:"AlhaithamC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Hf=l.Factory({Name:"AlhaithamC6",OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.1).Next().stat.Char(t.stat.CRIT_DMG).Values(.7).Build()}),mi=G.Factory({Name:"Alhaitham",Stars:5,Weapon:t.weapon.SWORD,Element:t.stat.DENDRO_DMG,StatBonus:t.stat.DENDRO_DMG,Region:t.region.SUMERU,BurstCost:70,AtkBase:[24.3922,100.16024],DefBase:[60.84711,249.8769],HpBase:[1039.1188,4267.1836],Normals:Gf,Skills:Rf,Bursts:gf,Extra:[],Effects:[If,Mf,Of,Df,vf,yf,Hf]}),Pf=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.672}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]}],wf=l.Factory({Name:"AlbedoC2",MaxStacks:4,OnApply:new l.Builder().mv.Mv(t.stat.DEF,.3,/HIT_Q/i).Map((e,a,s)=>e*s.GetStacks()).Build()}),Bf=l.Factory({Name:"AlbedoC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),bf=l.Factory({Name:"AlbedoC4",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.PLUNGE_ATTACK_DMG).Values(.3).Build()}),Kf=l.Factory({Name:"AlbedoC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Yf=l.Factory({Name:"AlbedoC6",ApplyOther:!0,OnApply:new l.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.ALL_DMG).Values(.17).Build()}),Ff=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3674}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3674}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4745}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4975}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6207}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.602}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],kf=l.Factory({Name:"AlbedoA1",OnApply(e,a,s){const n=e.GetCharacter(),r=e.FindSkill(T.hits.HIT_E_DOT);if(!r)throw new Error("Cannot find Albedo Skill");const i=s.Modifier(r.Subject.CreateModifier(t.stat.ALL_DMG,0));function c(){n.GetAscension()>=1?i.SetValue(.25):i.SetValue(0)}return c(),s.Observer(n.CreateObserver(t.stat.LEVEL,c)),s.Observer(n.CreateObserver(t.stat.ASCENSION,c)),()=>0}}),Vf=l.Factory({Name:"AlbedoA4",ApplyOther:!0,OnApply:new l.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(125).Build()}),xf=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:1.336}]}],fi=G.Factory({Name:"Albedo",Element:t.stat.GEO_DMG,Stars:5,Weapon:t.weapon.SWORD,StatBonus:t.stat.GEO_DMG,Region:t.region.MONDSTADT,AtkBase:[19.551,80.28111],DefBase:[68.2062,280.098],HpBase:[1029.5856,4228.035],BurstCost:40,Normals:Ff,Skills:xf,Bursts:Pf,Extra:[],Effects:[kf,Vf,wf,Bf,bf,Kf,Yf]}),Uf=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]}],Wf=l.Factory({Name:"BeidouC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),jf=l.Factory({Name:"BeidouC4",ApplySelf:!0,OnApply:new l.Builder().instance.Options({Name:"HIT_C4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.2,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Build()}),zf=l.Factory({Name:"BeidouC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),qf=l.Factory({Name:"BeidouC6",ApplySelf:!0,ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.ELECTRO_RES).Values(-.15).Build()}),$f=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7112}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7086}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8832}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8652}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1214}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5624}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.0182}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],Qf=l.Factory({Name:"BeidouA4",OnApply:new l.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()}),Xf=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216}]}],Jf=l.Factory({Name:"BeidouE",MaxStacks:2,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Mv(t.stat.ATK,.96,T.hits.HIT_E).Map((e,a,s)=>{const n=s.GetStacks(),r=a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1,i=o.TalentScaling.ELEMENTAL_1[r];return e*i*n}).Build()}),Li=G.Factory({Name:"Beidou",Stars:4,Weapon:t.weapon.CLAYMORE,Element:t.stat.ELECTRO_DMG,Region:t.region.LIYUE,StatBonus:t.stat.ELECTRO_DMG,AtkBase:[18.87648,67.54129],DefBase:[54.36375,194.5125],HpBase:[1094.1492,3914.8462],BurstCost:80,Normals:$f,Skills:Xf,Bursts:Uf,Extra:[],Effects:[Jf,Qf,Wf,jf,zf,qf]}),Zf=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.5427}]}],tL=l.Factory({Name:"XingqiuC2",ApplySelf:!0,ApplyOther:!0,OnApply:new l.Builder().stat.Enemy(t.stat.HYDRO_RES).Values(-.15).Build()}),eL=l.Factory({Name:"XingqiuC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),aL=l.Factory({Name:"XingqiuC4",ApplySelf:!0,OnApply:new l.Builder().mv.Multiplier(1.5,/^HIT_E_/i).Build()}),sL=l.Factory({Name:"XingqiuC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),nL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4661}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4764}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2855}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5599}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3586}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5616}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],rL=l.Factory({Name:"XingqiuA4",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.HYDRO_DMG).Where({owner:{ascension:4}}).Values(.2).Build()}),iL=[{Name:T.hits.HIT_E_1,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.68}]},{Name:T.hits.HIT_E_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.912}]}],pi=G.Factory({Name:"Xingqiu",Stars:4,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.SWORD,Region:t.region.LIYUE,HpBase:[857.08356,3066.6296],AtkBase:[16.9176,60.53229],DefBase:[63.51975,227.2725],StatBonus:t.stat.ATK_PERCENT,Normals:nL,Skills:iL,Bursts:Zf,Extra:[],Effects:[rL,tL,eL,aL,sL],BurstCost:80}),lL=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_2,Stat:t.stat.ATK,Initial:3.0327}]}],oL=l.Factory({Name:"HuTaoQ",OnApply:new l.Builder().mv.Where({target:{hp:{leq:.5}}}).Multiplier(3.7909/3.0327,"HIT_Q").Build()}),cL=l.Factory({Name:"HuTaoC2",ApplySelf:!0,OnApply:new l.Builder().mv.Mv(t.stat.HP,.1,"HIT_E").Build()}),EL=l.Factory({Name:"HuTaoC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),TL=l.Factory({Name:"HuTaoC4",ApplySelf:!1,ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.12).Build()}),_L=l.Factory({Name:"HuTaoC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),uL=l.Factory({Name:"HuTaoC6",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(1).Build()}),AL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.4689}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.4825}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6105}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6564}]},{Name:T.hits.HIT_N5_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.3327}]},{Name:T.hits.HIT_N5_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.352}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.8596}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.3596}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6542}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.3081}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.6339}]}],SL=l.Factory({Name:"HuTaoA1",ApplySelf:!1,ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Where({owner:{ascension:1}}).Values(.12).Build()}),hL=l.Factory({Name:"HuTaoA4",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Where({owner:{ascension:4,hp:{leq:.5}}}).Values(.33).Build()}),mL=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.64}]}],fL=l.Factory({Name:"HuTaoE",ApplySelf:!0,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP,t.stat.ATK_BASE,t.stat.HP_BASE,t.stat.HP_FLAT,t.stat.HP_PERCENT).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_2).Rank(e=>e.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a)=>{const s=a.GetCharacter(),n=.0384*e*s.Get(t.stat.HP),r=s.Get(t.stat.ATK_BASE)*4;return Math.max(0,Math.min(r,n))}).Next().infusion.Set(t.stat.PYRO_DMG,!0).Build()}),Ni=G.Factory({Name:"HuTao",Element:t.stat.PYRO_DMG,Region:t.region.LIYUE,Stars:5,Weapon:t.weapon.POLEARM,HpBase:[1210.7164,4971.856],AtkBase:[8.2859,34.0239],DefBase:[68.2062,280.098],StatBonus:t.stat.CRIT_DMG,Normals:AL,Skills:mL,Bursts:lL,Extra:[],Effects:[fL,oL,SL,hL,cL,EL,TL,_L,uL],BurstCost:60}),LL=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0731}]},{Name:T.hits.HIT_Q+"_THROW",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0487}]}],pL=l.Factory({Name:"YelanC2",OnApply:new l.Builder().instance.Options({Name:"HIT_C2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.14,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build()}),NL=l.Factory({Name:"YelanC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),dL=l.Factory({Name:"YelanC4",MaxStacks:4,ApplySelf:!0,ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.1).Stacks().Build()}),CL=l.Factory({Name:"YelanC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),ML=l.Factory({Name:"YelanC6",OnApply:new l.Builder().instance.Options({Name:"HIT_C6",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:1.56*.1158,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),gL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4068}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3904}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.516}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3251}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_BREAKTHROUGH_BARB",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1158}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],GL=l.Factory({Name:"YelanA1",ApplySelf:!0,OnApply:new l.Builder().observe.Party(!0).stat.Char(t.stat.HP_PERCENT).Where({owner:{ascension:1}}).Values(.06,.12,.18,.3).Rank(e=>{const a=e.GetParty();if(!a)return 1;const s=a.GetMembers(),n=new Map;for(const i of s)n.set(i.GetCharacter().Options.Element,!0);let r=0;for(const i of n.values())i&&r++;return r}).Build()}),RL=l.Factory({Name:"YelanA4",ApplySelf:!0,ApplyOther:!0,MaxTargets:1,MaxStacks:15,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Where({owner:{ascension:4}}).Values(.01).Next().stat.Char(t.stat.ALL_DMG).Where({owner:{ascension:4}}).Values(.035).Stacks().Map(e=>Math.min(.5,e)).Build()}),IL=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.2261}]}],di=G.Factory({Name:"Yelan",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.BOW,Region:t.region.LIYUE,BurstCost:70,HpBase:[1124.9176,4619.52],AtkBase:[18.9924,77.987366],DefBase:[42.65879,175.1841],StatBonus:t.stat.CRIT_RATE,Normals:gL,Skills:IL,Bursts:LL,Extra:[],Effects:[GL,RL,pL,NL,dL,CL,ML]}),OL=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:[1,1.108,1.216,1.351,1.473,1.595,1.757,1.919,2.081,2.243,2.405,2.568,2.703,2.838,2.973],Stat:t.stat.ATK,Initial:4.0108}]}],DL=l.Factory({Name:"ZhongliC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),vL=l.Factory({Name:"ZhongliC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),yL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3077}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3115}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3858}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4294}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.1075}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.545}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1103}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],HL=l.Factory({Name:"ZhongliA4",ApplySelf:!0,OnApply:new l.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.0139,/HIT_(N(\d)|CHARGED|PLUNGE)/).Next().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.019,/HIT_E/).Next().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.33,/HIT_Q/).Build()}),PL=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.16}]},{Name:T.hits.HIT_E+"_RESONANCE",Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.32}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.8}]}],wL=l.Factory({Name:"ZhongliE",ApplySelf:!0,ApplyOther:!0,OnApply:(e,a,s)=>{const n=t.Elements;for(const r of n){const i=t.DmgToRes(r);s.Modifier(e.GetCharacter().GetEnemy().Subject.CreateModifier(i,-.2))}return()=>0}}),Ci=G.Factory({Name:"Zhongli",Stars:5,Element:t.stat.GEO_DMG,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,HpBase:[1143.984,4697.817],AtkBase:[19.551,80.2811],DefBase:[57.4368,235.872],StatBonus:t.stat.GEO_DMG,BurstCost:40,Normals:yL,Skills:PL,Bursts:OL,Extra:[],Effects:[wL,HL,DL,vL]}),BL=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.008}]},{Name:T.hits.HIT_N1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4447}]},{Name:T.hits.HIT_N2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4396}]},{Name:T.hits.HIT_N3+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.5382}]},{Name:T.hits.HIT_N4+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3089}]},{Name:T.hits.HIT_N5+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7394}]},{Name:T.hits.HIT_CHARGED_1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.616}]},{Name:T.hits.HIT_CHARGED_2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7436}]},{Name:T.hits.HIT_PLUNGE+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],bL=l.Factory({Name:"RaidenQ",MaxStacks:60,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.0389,T.hits.HIT_Q).Map((e,a,s)=>s.GetStacks()*e*o.TalentScaling.ELEMENTAL_1[Math.max(0,Math.min(o.TalentScaling.ELEMENTAL_1.length-1,a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1))]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.0073,/_.+_Q$/).Map((e,a,s)=>s.GetStacks()*e*o.TalentScaling.ELEMENTAL_1[Math.max(0,Math.min(o.TalentScaling.ELEMENTAL_1.length-1,a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1))]).Build()}),KL=l.Factory({Name:"RaidenC2",OnApply:new l.Builder().stat.Char(t.stat.DEFIGNORED).Values(.6).Build()}),YL=l.Factory({Name:"RaidenC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),FL=l.Factory({Name:"RaidenC4",ApplyOther:!0,ApplySelf:!1,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.3).Build()}),kL=l.Factory({Name:"RaidenC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),VL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3965}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3973}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4988}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2898}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6545}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9959}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],xL=l.Factory({Name:"RaidenA4",OnApply:new l.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ELECTRO_DMG).Values(.4).Map((e,a)=>e*Math.max(0,a.GetCharacter().Get(t.stat.ENERGY_RECHARGE)-1)).Build()}),UL=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.172}]},{Name:T.hits.HIT_E+"_COORDINATED",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.42}]}],WL=l.Factory({Name:"RaidenE",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.0022,.0023,.0024,.0025,.0026,.0027,.0028,.0029,.003).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a)=>e*a.GetCharacter().Options.BurstCost).Build()}),Mi=G.Factory({Name:"Raiden",Stars:5,Weapon:t.weapon.POLEARM,Region:t.region.INAZUMA,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,BurstCost:90,AtkBase:[26.2542,107.80606],DefBase:[61.44541,252.3339],HpBase:[1004.79926,4126.249],Normals:VL,Skills:UL,Bursts:BL,Extra:[],Effects:[WL,bL,xL,KL,YL,FL,kL]}),jL=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.328}]}],zL=l.Factory({Name:"BennettQ",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ATK_BASE,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((e,a,s)=>{const n=s.Owner.FindEffect("BennettC1");return(.56*e+(n&&n.Enabled()?.2:0))*s.Owner.GetCharacter().Get(t.stat.ATK_BASE)}).Build()}),qL=l.Factory({Name:"BennettC1",OnApply(e,a,s){const n=e.FindEffect("BennettQ");if(!n)throw new Error("Bennett Burst effect not found");const r=n;function i(){r.Enabled()&&(r.Disable(),r.Enable())}return i(),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,i)),s.Observer(a.CreateObserver(l.EffectEvent.DISABLE,i)),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_TARGET,i)),()=>0}}),$L=l.Factory({Name:"BennettC2",OnApply:new l.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.ENERGY_RECHARGE).Values(.3).Build()}),QL=l.Factory({Name:"BennettC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),XL=l.Factory({Name:"BennettC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),JL=l.Factory({Name:"BennettC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Next().Where({target:{weapon:[t.weapon.CLAYMORE,t.weapon.SWORD,t.weapon.POLEARM]}}).infusion.Set(t.stat.PYRO_DMG,!1).Build()}),ZL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4455}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4274}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5461}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5968}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.719}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.559}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6072}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],tp=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.376}]},{Name:T.hits.HIT_E_1_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]},{Name:T.hits.HIT_E_1_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.92}]},{Name:T.hits.HIT_E_2_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_E_2_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]},{Name:T.hits.HIT_E_EXPLOSION,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]},{Name:"HIT_C4",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.92*1.35}]}],gi=G.Factory({Name:"Bennett",Stars:4,Weapon:t.weapon.SWORD,Element:t.stat.PYRO_DMG,Region:t.region.MONDSTADT,StatBonus:t.stat.ENERGY_RECHARGE,BurstCost:60,HpBase:[1039.4418,3719.104],AtkBase:[16.0272,57.34638],DefBase:[64.66425,231.3675],Normals:ZL,Skills:tp,Bursts:jL,Effects:[zL,qL,$L,QL,XL,JL],Extra:[]}),ep=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.08}]}],ap=l.Factory({Name:"FischlC1",OnApply:new l.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.22,Talent:t.stat.NONE}]}).Build()}),sp=l.Factory({Name:"FischlC2",OnApply:new l.Builder().mv.Mv(t.stat.ATK,2,/HIT_E$/).Build()}),np=l.Factory({Name:"FischlC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),rp=l.Factory({Name:"FischlC4",OnApply:new l.Builder().instance.Options({Name:"HIT_C4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:2.22,Talent:t.stat.NONE}]}).Build()}),ip=l.Factory({Name:"FischlC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),lp=l.Factory({Name:"FischlC6",OnApply:new l.Builder().instance.Options({Name:"HIT_C6",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.3,Talent:t.stat.NONE}]}).Build()}),op=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4412}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4678}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5814}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5771}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7207}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],cp=l.Factory({Name:"FischlA1",OnApply:new l.Builder().Where({target:{ascension:1}}).instance.Options({Name:"HIT_A1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24*1.527,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),Ep=l.Factory({Name:"FischlA4",OnApply:new l.Builder().Where({target:{ascension:4}}).instance.Options({Name:"HIT_A4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.8,Talent:t.stat.NONE}]}).Build()}),Tp=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1544}]},{Name:"HIT_OZ",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.888}]}],Gi=G.Factory({Name:"Fischl",Stars:4,Element:t.stat.ELECTRO_DMG,Region:t.region.MONDSTADT,Weapon:t.weapon.BOW,StatBonus:t.stat.ATK_PERCENT,AtkBase:[20.4792,73.27593],HpBase:[770.4634,2756.704],DefBase:[49.78575,178.1325],BurstCost:60,Normals:op,Skills:Tp,Bursts:ep,Extra:[],Effects:[cp,Ep,ap,sp,np,rp,ip,lp]}),_p=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.624}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2}]}],up=l.Factory({Name:"KazuhaQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,s){Ap(e,a,s);function n(){const r=e.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!r)return;const i=a.GetAuras()[0];!i||(r.Options.Element=t.AuraToDmg(i))}return n(),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,n)),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,n)),()=>0}}),Ap=new l.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.36,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),Sp=l.Factory({Name:"KazuhaC2",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(200).Build()}),hp=l.Factory({Name:"KazuhaC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),mp=l.Factory({Name:"KazuhaC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),fp=l.Factory({Name:"KazuhaC6",OnApply:new l.Builder().infusion.Set(t.stat.ANEMO_DMG,!1).Build()}),Lp=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4498}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4524}]},{Name:T.hits.HIT_N3_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.258}]},{Name:T.hits.HIT_N3_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3096}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6072}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2537}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.43}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7465}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],pp=l.Factory({Name:"KazuhaA1",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(e,a,s){Np(e,a,s);function n(){const r=e.FindNormal("HIT_A1");if(!r)return;const i=a.GetAuras()[0];!i||(r.Options.Element=t.AuraToDmg(i))}return n(),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,n)),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,n)),()=>0}}),Np=new l.Builder().Where({target:{ascension:1}}).instance.Location("Normal").Options({Name:"HIT_A1",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:2,Talent:t.stat.NONE}]}).Build(),dp=l.Factory({Name:"KazuhaA4",ApplyOther:!0,MaxAuras:1/0,ValidAuras:t.Swirlable,OnApply(e,a,s){const n=a.Owner.GetCharacter(),r=e.GetCharacter(),i=t.Elements.filter(_=>_!==t.stat.PHYSICAL_DMG).map(_=>s.Modifier(r.CreateModifier(_,0)));function c(){const _=a.GetAuras().map(u=>t.AuraToDmg(u));for(const u of i)_.includes(u.GetProp())&&n.GetAscension()>=4?u.SetValue(.04/100*n.Get(t.stat.ELEMENTAL_MASTERY)):u.SetValue(0)}return c(),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_AURAS,c)),s.Observer(n.CreateObserver(t.stat.ELEMENTAL_MASTERY,c)),s.Observer(n.CreateObserver(t.stat.LEVEL,c)),s.Observer(n.CreateObserver(t.stat.ASCENSION,c)),()=>0}}),Cp=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.92}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.608}]}],Mp=l.Factory({Name:"KazuhaE",OnApply:new l.Builder().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Next().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE_LOW+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Next().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE_HIGH+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),Ri=G.Factory({Name:"Kazuha",Stars:5,Weapon:t.weapon.SWORD,Region:t.region.INAZUMA,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ELEMENTAL_MASTERY,BurstCost:60,HpBase:[1039.1188,4267.1836],AtkBase:[23.0888,94.80817],DefBase:[62.8215,257.985],Normals:Lp,Skills:Cp,Bursts:_p,Extra:[],Effects:[Mp,up,pp,dp,Sp,hp,mp,fp]}),gp=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.096}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3412}]}],Gp=l.Factory({Name:"SaraC2",OnApply:new l.Builder().instance.Location("Skill").Options({Name:"HIT_C2",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2576*.3,Talent:t.stat.ELEMENTAL_SKILL_LEVEL}]}).Build()}),Rp=l.Factory({Name:"SaraC3",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Ip=l.Factory({Name:"SaraC5",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Op=l.Factory({Name:"SaraC6",ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ELECTRO_CRIT_DMG).Values(.6).Build()}),Dp=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3689}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.387}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.485}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.504}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.585}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],vp=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2576}]}],yp=l.Factory({Name:"SaraE",ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.ATK_BASE,t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((e,a)=>a.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((e,a,s)=>.4296*e*s.Owner.GetCharacter().Get(t.stat.ATK_BASE)).Build()}),Ii=G.Factory({Name:"Sara",Stars:4,Weapon:t.weapon.BOW,Region:t.region.INAZUMA,Element:t.stat.ELECTRO_DMG,BurstCost:80,HpBase:[802.3761,2870.8872],AtkBase:[16.38336,58.620743],DefBase:[52.647,188.37],StatBonus:t.stat.ATK_PERCENT,Normals:Dp,Skills:vp,Bursts:gp,Extra:[],Effects:[yp,Gp,Rp,Ip,Op]}),Hp=[{Name:T.hits.HIT_N1,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.403}]},{Name:T.hits.HIT_N2,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3697}]},{Name:T.hits.HIT_N3,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4587}]},{Name:T.hits.HIT_N4,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5841}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.DENDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.32}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],Pp=l.Factory({Name:"NahidaA1",ApplyOther:!0,MaxTargets:1,OnApply(e,a,s){const n=e.GetCharacter(),r=a.Owner.GetCharacter(),i=s.Modifier(n.CreateModifier(t.stat.ELEMENTAL_MASTERY,0));let c=[];const _=[];function u(S){if(S===i)return;if(r.Get(t.stat.ASCENSION)<1){i.SetValue(0);return}let h=0,m=n;for(const N of c){const L=N.Get(t.stat.ELEMENTAL_MASTERY);L>h&&(h=L,m=N)}m===n&&(h-=i.GetValue());const f=Math.min(250,Math.max(0,.25*h));i.SetValue(f)}function A(){_.forEach(h=>h.Remove());const S=e.GetParty();if(!S)c=[n];else{c=[];for(const h of S.GetMembers())c.push(h.GetCharacter())}for(const h of c)_.push(s.Observer(h.CreateObserver(t.stat.ELEMENTAL_MASTERY,u)));u()}return A(),s.Observer(e.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,A)),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,A)),s.Observer(a.CreateObserver(l.EffectEvent.DISABLE,A)),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_CONDITIONS,A)),s.Observer(r.CreateObserver(t.stat.LEVEL,u)),s.Observer(r.CreateObserver(t.stat.ASCENSION,u)),()=>0}}),wp=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.984}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.032},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:2.064}]}],Bp=l.Factory({Name:"NahidaA4",OnApply(e,a,s){const n=e.GetCharacter(),r=e.FindSkill(T.hits.HIT_E_DOT);if(!r)throw new Error("Cannot find Nahida Skill");const i=s.Modifier(r.Subject.CreateModifier(t.stat.ALL_DMG,0)),c=s.Modifier(r.Subject.CreateModifier(t.stat.CRIT_RATE,0));let _,u;function A(){if(n.GetAscension()<4){i.SetValue(0),c.SetValue(0),_&&_.SetValue(0),u&&u.SetValue(0);return}const S=e.FindSkill("HIT_C6");S&&(_||(_=s.Modifier(S.Subject.CreateModifier(t.stat.ALL_DMG,0))),u||(u=s.Modifier(S.Subject.CreateModifier(t.stat.CRIT_RATE,0))));const h=Math.max(0,n.Get(t.stat.ELEMENTAL_MASTERY)-200),m=Math.min(.24,h*.03/100),f=Math.min(.8,h*.1/100);i.SetValue(f),c.SetValue(m),_&&_.SetValue(f),u&&u.SetValue(m)}return A(),s.Observer(n.CreateObserver(t.stat.ELEMENTAL_MASTERY,A)),s.Observer(n.CreateObserver(t.stat.LEVEL,A)),s.Observer(n.CreateObserver(t.stat.ASCENSION,A)),()=>0}}),bp=l.Factory({Name:"NahidaQ",OnApply(e,a,s){const n=e.FindSkill(T.hits.HIT_E_DOT);if(!n)throw new Error("Cannot find Nahida Skill");const r=s.Modifier(n.Subject.CreateModifier(t.stat.ALL_DMG,0));let i;function c(){const _=e.GetParty();if(!_){r.SetValue(0),i&&i.SetValue(0);return}const u=e.FindSkill("HIT_C6");u&&!i&&(i=s.Modifier(u.Subject.CreateModifier(t.stat.ALL_DMG,0)));const A=e.FindEffect("NahidaC1");let h=A&&A.Enabled()&&A.GetTargets().includes(e)?1:0;for(const N of _.GetMembers())N.GetCharacter().Options.Element===t.stat.PYRO_DMG&&h++;let m=0;h>=1&&(m=.1488),h>=2&&(m=.2232);const f=m*o.TalentScaling.ELEMENTAL_1[e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1];r.SetValue(f),i&&i.SetValue(f)}return c(),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,c)),s.Observer(a.CreateObserver(l.EffectEvent.DISABLE,c)),s.Observer(e.GetCharacter().CreateObserver(t.stat.ELEMENTAL_BURST_LEVEL,c)),s.Observer(e.GetCharacter().CreateObserver(t.stat.ELEMENTAL_BURST_LEVEL_UP,c)),s.Observer(e.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,c)),()=>0}}),Kp=l.Factory({Name:"NahidaC1",OnApply(e,a,s){const n=e.FindEffect("NahidaQ");if(!n)throw new Error("Nahida Burst effect not found");const r=n;function i(){r.Enabled()&&(r.Disable(),r.Enable())}return i(),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,i)),s.Observer(a.CreateObserver(l.EffectEvent.DISABLE,i)),s.Observer(a.CreateObserver(l.EffectEvent.CHANGE_TARGET,i)),()=>0}}),Yp=l.Factory({Name:"NahidaC2",ApplyOther:!0,MaxAuras:1,ValidAuras:[t.aura.QUICKEN],OnApply(e,a,s){Fp(e,a,s);const r=["BURGEON","BLOOM","HYPERBLOOM","BURNING"].map(i=>e.FindTr("HIT_"+i));for(const i of r)!i||(s.Modifier(i.Subject.CreateModifier(t.stat.CRIT_RATE,.2)),s.Modifier(i.Subject.CreateModifier(t.stat.CRIT_DMG,1)));return()=>0}}),Fp=new l.Builder().Where({effect:{aura:[t.aura.QUICKEN]}}).stat.Enemy(t.stat.DEFREDUCTION).Values(.3).Build(),kp=l.Factory({Name:"NahidaC3",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Vp=l.Factory({Name:"NahidaC4",MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Stacks([0,100,120,140,160]).Build()}),xp=l.Factory({Name:"NahidaC5",ApplySelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Up=l.Factory({Name:"NahidaC6",OnApply(e,a,s){Wp(e,a,s);function n(){const r=e.FindEffect("NahidaQ"),i=e.FindEffect("NahidaA4");r&&r.Enabled()&&(r.Disable(),r.Enable()),i&&i.Enabled()&&(i.Disable(),i.Enable())}return n(),s.Observer(a.CreateObserver(l.EffectEvent.ENABLE,n)),s.Observer(a.CreateObserver(l.EffectEvent.DISABLE,n)),()=>0}}),Wp=new l.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Talent:t.stat.NONE,Initial:2},{Scaling:o.TalentScaling.NONE,Stat:t.stat.ELEMENTAL_MASTERY,Talent:t.stat.NONE,Initial:4}]}).Build(),Oi=G.Factory({Name:"Nahida",Stars:5,Element:t.stat.DENDRO_DMG,Region:t.region.SUMERU,Weapon:t.weapon.CATALYST,StatBonus:t.stat.ELEMENTAL_MASTERY,BurstCost:50,HpBase:[806.5087,3311.961],AtkBase:[23.275,95.57275],DefBase:[49.0606,201.474],Normals:Hp,Skills:wp,Bursts:[],Extra:[],Effects:[bp,Pp,Bp,Kp,Yp,kp,Vp,xp,Up]}),Je=new Q(e=>e.Name);Je.AddList(Object.values(yr).sort((e,a)=>e.Name.localeCompare(a.Name)));function Di(){return Je.Get()}function jp(e){return Je.Find(e)}var et={};D(et,{Akuoumaru:()=>Zi,AlleyHunter:()=>po,AmberBead:()=>Zo,AmenomaKageuchi:()=>Vl,AmosBow:()=>To,AquaSimulacra:()=>co,AquilaFavonia:()=>Bl,BalladOfTheFjords:()=>Ui,BeaconOfTheReedSea:()=>Qi,BlackTassel:()=>gc,BlackcliffAgate:()=>zo,BlackcliffLongsword:()=>jl,BlackcliffPole:()=>Rc,BlackcliffSlasher:()=>sl,BlackcliffWarbow:()=>ji,BloodtaintedGreatsword:()=>nl,CalamityQueller:()=>ic,CinnabarSpindle:()=>kl,CompoundBow:()=>Co,CoolSteel:()=>io,CrescentPike:()=>mc,DarkIronSword:()=>ao,Deathmatch:()=>Ic,DebateClub:()=>rl,DodocoTales:()=>Uo,DragonsBane:()=>Lc,DragonspineSpear:()=>Sc,ElegyForTheEnd:()=>Nc,EmeraldOrb:()=>ec,EndOfTheLine:()=>_o,EngulfingLightning:()=>_c,EverlastingMoonglow:()=>bo,EyeOfPerception:()=>jo,FadingTwilight:()=>Lo,FavoniusCodex:()=>Jo,FavoniusGreatsword:()=>il,FavoniusLance:()=>Cc,FavoniusSword:()=>vc,FavoniusWarbow:()=>yc,FerrousShadow:()=>ll,FesteringDesire:()=>xl,FilletBlade:()=>so,FinaleOfTheDeep:()=>bi,FindByName:()=>s1,FleuveCendreFerryman:()=>Ki,FlowingPurity:()=>Bi,ForestRegalia:()=>El,FreedomSworn:()=>Ol,Frostbearer:()=>Wo,FruitOfFulfillment:()=>ko,GetByType:()=>n1,GetList:()=>wc,HakushinRing:()=>xo,Halberd:()=>fc,Hamayumi:()=>ho,HaranGeppakuFutsu:()=>yl,HarbingerOfDawn:()=>ro,HuntersPath:()=>lo,IbisPiercer:()=>zi,IronSting:()=>zl,JadeCutter:()=>Pl,JadeSpear:()=>lc,JadefallSplendor:()=>qi,KagotsurubeIsshin:()=>Fl,KagurasVerity:()=>Bo,KatsuragikiriNagamasa:()=>Tl,KeyOfKhajNisut:()=>vl,KingsSquire:()=>uo,KitainCrossSpear:()=>Ac,LightOfFoliarIncision:()=>Dl,LionsRoar:()=>$l,LithicBlade:()=>ul,LithicSpear:()=>hc,LostPrayer:()=>Yo,LuxuriousSeaLord:()=>ol,MagicGuide:()=>nc,MailedFlower:()=>$i,MakhairaAquamarine:()=>al,MappaMare:()=>qo,MemoryOfDust:()=>Ko,Messenger:()=>Io,MissiveWindspear:()=>Ec,MistsplitterReforged:()=>Hl,MitternachtsWaltz:()=>fo,Moonpiercer:()=>Tc,MouunsMoon:()=>Ao,OathswornEye:()=>Vo,OtherworldlyStory:()=>ac,PolarStar:()=>Eo,Predator:()=>So,PrototypeAmber:()=>$o,PrototypeArchaic:()=>Sl,PrototypeCrescent:()=>Mo,PrototypeRancour:()=>ql,PrototypeStarglitter:()=>Gc,Rainslasher:()=>hl,RavenBow:()=>yo,RecurveBow:()=>Do,RedhornStonethresher:()=>ml,RightfulReward:()=>Pi,RoyalBow:()=>Zl,RoyalGreatsword:()=>fl,RoyalGrimoire:()=>Xl,RoyalLongsword:()=>to,RoyalSpear:()=>Jl,Rust:()=>go,SacrificialBow:()=>Go,SacrificialFragments:()=>Xo,SacrificialGreatsword:()=>Ll,SacrificialJade:()=>ki,SacrificialSword:()=>pc,SapwoodBlade:()=>Yl,ScionOfTheBlazingSun:()=>Vi,SerpentSpine:()=>Il,SharpshootersOath:()=>vo,SkyriderGreatsword:()=>pl,SkyriderSword:()=>eo,SkywardAtlas:()=>Fo,SkywardBlade:()=>Oc,SkywardHarp:()=>Dc,SkywardPride:()=>Nl,SkywardSpine:()=>cc,Slingshot:()=>Oo,SnowTombedStarsilver:()=>dl,SolarPearl:()=>Qo,SongOfBrokenPines:()=>Al,SongOfStillness:()=>wi,SplendorOfTranquilWaters:()=>yi,StaffOfHoma:()=>dc,StaffOfTheScarletSands:()=>rc,SummitShaper:()=>wl,SwordOfDescension:()=>Ul,TalkingStick:()=>xi,TheAlleyFlash:()=>Wl,TheBell:()=>Cl,TheBlackSword:()=>Xi,TheCatch:()=>Ji,TheFirstGreatMagic:()=>Wi,TheFlute:()=>Ql,TheStringless:()=>Ro,TheUnforged:()=>Ml,TheViridescentHunt:()=>No,TheWidsith:()=>Hc,ThousandFloatingDreams:()=>Po,ThrillingTalesOfDragonSlayers:()=>sc,ThunderingPulse:()=>oo,TidalShadow:()=>Yi,TomeOfTheEternalFlow:()=>Hi,ToukabouShigure:()=>bl,TravelersHandySword:()=>no,TulaytullahsRemembrance:()=>Ho,TwinNephrite:()=>tc,VortexVanquisher:()=>oc,WanderingEvenstar:()=>wo,WavebreakerFin:()=>uc,WhiteIronGreatsword:()=>Gl,WhiteTassel:()=>Mc,Whiteblind:()=>gl,WindblumeOde:()=>mo,WineAndSong:()=>tl,WolfFang:()=>Fi,WolfsGravestone:()=>Rl,XiphosMoonlight:()=>Kl});var vi={};D(vi,{Akuoumaru:()=>Zi,AlleyHunter:()=>po,AmberBead:()=>Zo,AmenomaKageuchi:()=>Vl,AmosBow:()=>To,AquaSimulacra:()=>co,AquilaFavonia:()=>Bl,BalladOfTheFjords:()=>Ui,BeaconOfTheReedSea:()=>Qi,BlackTassel:()=>gc,BlackcliffAgate:()=>zo,BlackcliffLongsword:()=>jl,BlackcliffPole:()=>Rc,BlackcliffSlasher:()=>sl,BlackcliffWarbow:()=>ji,BloodtaintedGreatsword:()=>nl,CalamityQueller:()=>ic,CinnabarSpindle:()=>kl,CompoundBow:()=>Co,CoolSteel:()=>io,CrescentPike:()=>mc,DarkIronSword:()=>ao,Deathmatch:()=>Ic,DebateClub:()=>rl,DodocoTales:()=>Uo,DragonsBane:()=>Lc,DragonspineSpear:()=>Sc,ElegyForTheEnd:()=>Nc,EmeraldOrb:()=>ec,EndOfTheLine:()=>_o,EngulfingLightning:()=>_c,EverlastingMoonglow:()=>bo,EyeOfPerception:()=>jo,FadingTwilight:()=>Lo,FavoniusCodex:()=>Jo,FavoniusGreatsword:()=>il,FavoniusLance:()=>Cc,FavoniusSword:()=>vc,FavoniusWarbow:()=>yc,FerrousShadow:()=>ll,FesteringDesire:()=>xl,FilletBlade:()=>so,FinaleOfTheDeep:()=>bi,FleuveCendreFerryman:()=>Ki,FlowingPurity:()=>Bi,ForestRegalia:()=>El,FreedomSworn:()=>Ol,Frostbearer:()=>Wo,FruitOfFulfillment:()=>ko,HakushinRing:()=>xo,Halberd:()=>fc,Hamayumi:()=>ho,HaranGeppakuFutsu:()=>yl,HarbingerOfDawn:()=>ro,HuntersPath:()=>lo,IbisPiercer:()=>zi,IronSting:()=>zl,JadeCutter:()=>Pl,JadeSpear:()=>lc,JadefallSplendor:()=>qi,KagotsurubeIsshin:()=>Fl,KagurasVerity:()=>Bo,KatsuragikiriNagamasa:()=>Tl,KeyOfKhajNisut:()=>vl,KingsSquire:()=>uo,KitainCrossSpear:()=>Ac,LightOfFoliarIncision:()=>Dl,LionsRoar:()=>$l,LithicBlade:()=>ul,LithicSpear:()=>hc,LostPrayer:()=>Yo,LuxuriousSeaLord:()=>ol,MagicGuide:()=>nc,MailedFlower:()=>$i,MakhairaAquamarine:()=>al,MappaMare:()=>qo,MemoryOfDust:()=>Ko,Messenger:()=>Io,MissiveWindspear:()=>Ec,MistsplitterReforged:()=>Hl,MitternachtsWaltz:()=>fo,Moonpiercer:()=>Tc,MouunsMoon:()=>Ao,OathswornEye:()=>Vo,OtherworldlyStory:()=>ac,PolarStar:()=>Eo,Predator:()=>So,PrototypeAmber:()=>$o,PrototypeArchaic:()=>Sl,PrototypeCrescent:()=>Mo,PrototypeRancour:()=>ql,PrototypeStarglitter:()=>Gc,Rainslasher:()=>hl,RavenBow:()=>yo,RecurveBow:()=>Do,RedhornStonethresher:()=>ml,RightfulReward:()=>Pi,RoyalBow:()=>Zl,RoyalGreatsword:()=>fl,RoyalGrimoire:()=>Xl,RoyalLongsword:()=>to,RoyalSpear:()=>Jl,Rust:()=>go,SacrificialBow:()=>Go,SacrificialFragments:()=>Xo,SacrificialGreatsword:()=>Ll,SacrificialJade:()=>ki,SacrificialSword:()=>pc,SapwoodBlade:()=>Yl,ScionOfTheBlazingSun:()=>Vi,SerpentSpine:()=>Il,SharpshootersOath:()=>vo,SkyriderGreatsword:()=>pl,SkyriderSword:()=>eo,SkywardAtlas:()=>Fo,SkywardBlade:()=>Oc,SkywardHarp:()=>Dc,SkywardPride:()=>Nl,SkywardSpine:()=>cc,Slingshot:()=>Oo,SnowTombedStarsilver:()=>dl,SolarPearl:()=>Qo,SongOfBrokenPines:()=>Al,SongOfStillness:()=>wi,SplendorOfTranquilWaters:()=>yi,StaffOfHoma:()=>dc,StaffOfTheScarletSands:()=>rc,SummitShaper:()=>wl,SwordOfDescension:()=>Ul,TalkingStick:()=>xi,TheAlleyFlash:()=>Wl,TheBell:()=>Cl,TheBlackSword:()=>Xi,TheCatch:()=>Ji,TheFirstGreatMagic:()=>Wi,TheFlute:()=>Ql,TheStringless:()=>Ro,TheUnforged:()=>Ml,TheViridescentHunt:()=>No,TheWidsith:()=>Hc,ThousandFloatingDreams:()=>Po,ThrillingTalesOfDragonSlayers:()=>sc,ThunderingPulse:()=>oo,TidalShadow:()=>Yi,TomeOfTheEternalFlow:()=>Hi,ToukabouShigure:()=>bl,TravelersHandySword:()=>no,TulaytullahsRemembrance:()=>Ho,TwinNephrite:()=>tc,VortexVanquisher:()=>oc,WanderingEvenstar:()=>wo,WavebreakerFin:()=>uc,WhiteIronGreatsword:()=>Gl,WhiteTassel:()=>Mc,Whiteblind:()=>gl,WindblumeOde:()=>mo,WineAndSong:()=>tl,WolfFang:()=>Fi,WolfsGravestone:()=>Rl,XiphosMoonlight:()=>Kl});var yi=p.Factory({Name:"SplendorOfTranquilWaters",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"SplendorOfTranquilWaters1",MaxStacks:3,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.08,.1,.12,.14,.16).Stacks().Build()}),l.Factory({Name:"SplendorOfTranquilWaters2",MaxStacks:2,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.14,.175,.21,.245,.28).Stacks().Build()})]}),Hi=p.Factory({Name:"TomeOfTheEternalFlow",Stars:5,Type:t.weapon.CATALYST,Substat:t.stat.CRIT_DMG,Scaling:o.WeaponScaling.TYPE_44b,Effects:[l.Factory({Name:"TomeOfTheEternalFlow1",MaxStacks:3,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.14,.18,.22,.26,.3).Stacks().Build()})]}),Pi=p.Factory({Name:"RightfulReward",Stars:4,Type:t.weapon.POLEARM,Substat:t.stat.HP_PERCENT,Scaling:o.WeaponScaling.TYPE_44,Effects:[]}),wi=p.Factory({Name:"SongOfStillness",Stars:4,Type:t.weapon.BOW,Substat:t.stat.ATK_PERCENT,Scaling:o.WeaponScaling.TYPE_42,Effects:[l.Factory({Name:"SongOfStillness1",MaxRank:5,MaxConditions:1,Conditions:["HEALED"],OnApply:new l.Builder().Where({effect:{conditions:["HEALED"]}}).stat.Char(t.stat.ALL_DMG).Values(.16,.2,.24,.28,.32).Build()})]}),Bi=p.Factory({Name:"FlowingPurity",Stars:4,Type:t.weapon.CATALYST,Substat:t.stat.ATK_PERCENT,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"FlowingPurity1",MaxRank:5,MaxConditions:1,MaxStacks:6e3,Conditions:["CAST_SKILL"],OnApply:new l.Builder().Where({effect:{conditions:["CAST_SKILL"]}}).stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.08,.1,.12,.14,.16).Next().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(...[.02,.025,.03,.035,.04].map(e=>e/1e3)).Stacks().Build()})]}),bi=p.Factory({Name:"FinaleOfTheDeep",Stars:4,Type:t.weapon.SWORD,Substat:t.stat.ATK_PERCENT,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"FinaleOfTheDeep1",MaxRank:5,MaxStacks:100,MaxConditions:1,Conditions:["CAST_SKILL"],OnApply:new l.Builder().Where({effect:{conditions:["CAST_SKILL"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Next().observe.Target(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ATK_FLAT).Values(.024,.03,.036,.042,.048).Map((e,a,s)=>{let n=e*s.GetStacks()/100*.25*a.GetCharacter().Get(t.stat.HP);return n=Math.min(n,150/.024*e),n}).Build()})]}),Ki=p.Factory({Name:"FleuveCendreFerryman",Stars:4,Type:t.weapon.SWORD,Substat:t.stat.ENERGY_RECHARGE,Scaling:o.WeaponScaling.TYPE_42,Effects:[l.Factory({Name:"FleuveCendreFerryman1",MaxRank:5,Conditions:["CAST_SKILL"],MaxConditions:1,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_CRIT_RATE).Values(.08,.1,.12,.14,.16).Next().Where({effect:{conditions:["CAST_SKILL"]}}).stat.Char(t.stat.ENERGY_RECHARGE).Values(.16,.2,.24,.28,.32).Build()})]}),Yi=p.Factory({Name:"TidalShadow",Stars:4,Type:t.weapon.CLAYMORE,Substat:t.stat.ATK_PERCENT,Scaling:o.WeaponScaling.TYPE_42,Effects:[l.Factory({Name:"TidalShadow1",MaxRank:5,Conditions:["HEALED"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["HEALED"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.24,.3,.36,.42,.48).Build()})]}),Fi=p.Factory({Name:"WolfFang",Stars:4,Type:t.weapon.SWORD,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_42,Effects:[l.Factory({Name:"WolfFang1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.16,.2,.24,.28,.32).Build()}),l.Factory({Name:"WolfFang2",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_CRIT_RATE).Values(.02,.025,.03,.035,.04).Stacks().Build()}),l.Factory({Name:"WolfFang3",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.02,.025,.03,.035,.04).Stacks().Build()})]}),ki=p.Factory({Name:"SacrificialJade",Stars:4,Type:t.weapon.CATALYST,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_42,Effects:[l.Factory({Name:"SacrificialJade1",MaxRank:5,Conditions:["OFF_FIELD"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["OFF_FIELD"]}}).stat.Char(t.stat.HP_PERCENT).Values(.32,.4,.48,.56,.64).Next().Where({effect:{conditions:["OFF_FIELD"]}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(40,50,60,70,80).Build()})]}),Vi=p.Factory({Name:"ScionOfTheBlazingSun",Stars:4,Type:t.weapon.BOW,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"ScionOfTheBlazingSun1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_ScionOfTheBlazingSun",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.6,.75,.9,1.05,1.2]}).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.28,.35,.42,.49,.56).Build()})]}),xi=p.Factory({Name:"TalkingStick",Stars:4,Type:t.weapon.CLAYMORE,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"TalkingStick1",MaxRank:5,MaxAuras:2,ValidAuras:[t.aura.PYRO,t.aura.HYDRO],OnApply:new l.Builder().Where({effect:{aura:[t.aura.PYRO]}}).stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Next().Where({effect:{aura:[t.aura.HYDRO]}}).stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Build()})]}),Ui=p.Factory({Name:"BalladOfTheFjords",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"BalladOfTheFjords1",MaxRank:5,OnApply:new l.Builder().observe.Party(!0).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(120,150,180,210,240).Map((e,a)=>{const s=a.GetParty();if(!s)return 0;const n=new Set;for(const r of s.GetMembers())n.add(r.GetCharacter().Options.Element);return n.size>=3?e:0}).Build()})]}),Wi=p.Factory({Name:"TheFirstGreatMagic",Type:t.weapon.BOW,Stars:5,Substat:t.stat.CRIT_DMG,Scaling:o.WeaponScaling.TYPE_46,Effects:[l.Factory({Name:"TheFirstGreatMagic1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().observe.Party(!0).stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Map((e,a)=>{let s=1;const n=a.GetCharacter().Options.Element,r=a.GetParty();if(r)for(const i of r.GetMembers())i!==a&&i.GetCharacter().Options.Element===n&&s++;return s=Math.min(s,3),e*s}).Build()})]}),bt=e=>l.Factory({Name:e,MaxRank:5,MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Stacks().Build()}),ji=p.Factory({Name:"BlackcliffWarbow",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.CRIT_DMG,Effects:[bt("BlackcliffWarbow1")]}),zi=p.Factory({Name:"IbisPiercer",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"IbisPiercer1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(40,50,60,70,80).Stacks().Build()})]}),qi=p.Factory({Name:"JadefallSplendor",Type:t.weapon.CATALYST,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"JadefallSplendor1",MaxRank:5,OnApply:new l.Builder().observe.Owner(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.MapStat(e=>[e.GetCharacter().Options.Element]).Values(.3,.5,.7,.9,1.1).Map((e,a,s)=>Math.min([.12,.2,.28,.36,.44][s.GetRank()-1],e/100*a.GetCharacter().Get(t.stat.HP)/1e3)).Build()})]}),$i=p.Factory({Name:"MailedFlower",Stars:4,Type:t.weapon.CLAYMORE,Substat:t.stat.ELEMENTAL_MASTERY,Scaling:o.WeaponScaling.TYPE_44,Effects:[l.Factory({Name:"MailedFlower1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(48,60,72,84,96).Build()})]}),Qi=p.Factory({Name:"BeaconOfTheReedSea",Stars:5,Type:t.weapon.CLAYMORE,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_46,Effects:[l.Factory({Name:"BeaconOfTheReedSea1",MaxRank:5,Conditions:["HIT_SKILL","DMG_TAKEN"],MaxConditions:2,OnApply:new l.Builder().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["DMG_TAKEN"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().Where({target:{shielded:!1}}).stat.Char(t.stat.HP_PERCENT).Values(.32,.4,.48,.56,.64).Build()})]}),Xi=p.Factory({Name:"TheBlackSword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"TheBlackSword1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),Ji=p.Factory({Name:"TheCatch",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"TheCatch1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.06,.075,.09,.105,.12).Build()})]}),Ze=e=>l.Factory({Name:e,MaxRank:5,OnApply(a,s,n){const r=a.GetCharacter(),i=n.Modifier(r.CreateModifier(t.stat.ELEMENTAL_BURST_DMG,0));function c(){let _=[r];const u=a.GetParty();u&&(_=u.GetMembers().map(h=>h.GetCharacter()));let A=0;for(const h of _)A+=h.Options.BurstCost;const S=Math.min(qp[s.GetRank()-1],zp[s.GetRank()-1]*A);i.SetValue(S)}return n.Observer(s.Event.CreateObserver(l.EffectEvent.CHANGE_RANK,c)),n.Observer(a.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,c)),()=>0}}),zp=[.12/100,.15/100,.18/100,.21/100,.24/100],qp=[.4,.5,.6,.7,.8],Zi=p.Factory({Name:"Akuoumaru",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Ze("Akuoumaru1")]}),tl=p.Factory({Name:"WineAndSong",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"WineAndSong1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),el=(e,a,s)=>l.Factory({Name:e,ApplyOther:!0,StackSelf:!0,MaxRank:5,OnApply(n,r,i){const c=r.Owner.GetCharacter(),_=n.GetCharacter(),u=i.Modifier(_.CreateModifier(a,0));function A(){const S=c.Get(t.stat.ELEMENTAL_MASTERY);let h=s[r.GetRank()-1]*S;c!==_&&(h*=.3),u.SetValue(h)}return A(),i.Observer(c.CreateObserver(t.stat.ELEMENTAL_MASTERY,A)),()=>0}}),al=p.Factory({Name:"MakhairaAquamarine",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[el("MakhairaAquamarine1",t.stat.ATK_FLAT,[.24,.3,.36,.42,.48])]}),sl=p.Factory({Name:"BlackcliffSlasher",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[bt("BlackcliffSlasher1")]}),nl=p.Factory({Name:"BloodtaintedGreatsword",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"BloodtaintedGreatsword1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),rl=p.Factory({Name:"DebateClub",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"DebateClub1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_DebateClub",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.6,.75,.9,1.05,1.2]}).Build()})]}),il=p.Factory({Name:"FavoniusGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),ll=p.Factory({Name:"FerrousShadow",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"FerrousShadow1",MaxRank:5,OnApply:new l.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.3,.35,.4,.45,.5).Build()})]}),ol=p.Factory({Name:"LuxuriousSeaLord",Type:t.weapon.CLAYMORE,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"LuxuriousSeaLord1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.12,.15,.18,.21,.24).Next().instance.Basic({Name:"HIT_LuxuriousSeaLord",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),cl=e=>l.Factory({Name:e,MaxRank:5,ApplyOther:!0,MaxTargets:1,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,75,90,105,120).Build()}),El=p.Factory({Name:"ForestRegalia",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[cl("ForestRegalia1")]}),Tl=p.Factory({Name:"KatsuragikiriNagamasa",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"KatsuragikiriNagamasa1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.06,.075,.09,.105,.12).Build()})]}),_l=e=>l.Factory({Name:e,MaxRank:5,OnApply(a,s,n){const r=a.GetCharacter(),i=n.Modifier(r.CreateModifier(t.stat.CRIT_RATE,0)),c=n.Modifier(r.CreateModifier(t.stat.ATK_PERCENT,0));function _(){let u=[r];const A=a.GetParty();A&&(u=A.GetMembers().map(f=>f.GetCharacter()));const S=Math.min(4,u.filter(f=>f.Options.Region===t.region.LIYUE).length),h=$p[s.GetRank()-1]*S,m=Qp[s.GetRank()-1]*S;i.SetValue(h),c.SetValue(m)}return _(),n.Observer(s.CreateObserver(l.EffectEvent.CHANGE_RANK,_)),n.Observer(a.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,_)),()=>0}}),$p=[.03,.04,.05,.06,.07],Qp=[.07,.08,.09,.1,.11],ul=p.Factory({Name:"LithicBlade",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[_l("LithicBlade1")]}),ta=new Map;function Xp(e){const a=ta.get(e);if(!a){const s=new Set;return ta.set(e,s),s}return a}var ea=({Name:e,OnApply:a})=>l.Factory({Name:e,MaxRank:5,ApplyOther:!0,OnApply(s,n,r){a(s,n,r);const i=r.GetModifiers(),c=Xp(s);i.forEach(u=>c.add(u));function _(){for(const u of i)Array.from(c).some(S=>S!==u&&S.GetProp()===u.GetProp()&&S.Enabled()&&S.GetValue()!==0)&&(u.SetValue(0),u.Disable())}_();for(const u of l.EffectEvent.Values())r.Observer(n.CreateObserver(u,_));return()=>{i.forEach(u=>c.delete(u)),c.size===0&&ta.delete(s)}}}),Al=p.Factory({Name:"SongOfBrokenPines",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_49,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"SongOfBrokenPines1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()}),ea({Name:"SongOfBrokenPines2",OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),Sl=p.Factory({Name:"PrototypeArchaic",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"PrototypeArchaic1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_PrototypeArchaic",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,3,3.6,4.2,4.8]}).Build()})]}),hl=p.Factory({Name:"Rainslasher",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"Rainslasher1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),ml=p.Factory({Name:"RedhornStonethresher",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"RedhornStonethresher1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.28,.35,.42,.49,.56).Next().observe.Target(t.stat.DEF,t.stat.DEF_PERCENT,t.stat.DEF_FLAT).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(.4,.5,.6,.7,.8).Map((e,a)=>e*a.GetCharacter().Get(t.stat.DEF)).Build()})]}),Kt=e=>l.Factory({Name:e,MaxRank:5,OnApply(a,s,n){const r=a.GetCharacter();function i(c=!0){if(!c)r.MapCritRate=_=>_;else{const _=s.GetRank();r.MapCritRate=u=>Jp(_,u)}}return i(!0),n.Observer(s.CreateObserver(l.EffectEvent.ENABLE,()=>i(!0))),n.Observer(s.CreateObserver(l.EffectEvent.CHANGE_RANK,()=>i(!0))),n.Observer(s.CreateObserver(l.EffectEvent.DISABLE,()=>i(!1))),()=>i(!1)}});function Jp(e,a){const s=Math.max,n=.08+.02*(e-1);return a<0?((5*n+a)*s(0,a)-(5*n*a-5*n+g(a,2)-a)*s(0,n+a)+(5*g(n,2)*a-5*g(n,2)+6*n*g(a,2)-11*n*a+5*n+g(a,3)-2*g(a,2)+a)*s(0,2*n+a)-(10*g(n,3)*a-10*g(n,3)+17*g(n,2)*g(a,2)-32*g(n,2)*a+15*g(n,2)+8*n*g(a,3)-21*n*g(a,2)+18*n*a-5*n+g(a,4)-3*g(a,3)+3*g(a,2)-a)*s(0,3*n+a)+(30*g(n,4)*a-30*g(n,4)+61*g(n,3)*g(a,2)-116*g(n,3)*a+55*g(n,3)+41*g(n,2)*g(a,3)-112*g(n,2)*g(a,2)+101*g(n,2)*a-30*g(n,2)+11*n*g(a,4)-38*n*g(a,3)+48*n*g(a,2)-26*n*a+5*n+g(a,5)-4*g(a,4)+6*g(a,3)-4*g(a,2)+a)*s(0,4*n+a)-(24*g(n,4)*a-24*g(n,4)+50*g(n,3)*g(a,2)-100*g(n,3)*a+50*g(n,3)+35*g(n,2)*g(a,3)-105*g(n,2)*g(a,2)+105*g(n,2)*a-35*g(n,2)+10*n*g(a,4)-40*n*g(a,3)+60*n*g(a,2)-40*n*a+10*n+g(a,5)-5*g(a,4)+10*g(a,3)-10*g(a,2)+5*a-1)*s(0,5*n+a))/(6*g(n,4)*a-6*g(n,4)+11*g(n,3)*g(a,2)-26*g(n,3)*a+15*g(n,3)+6*g(n,2)*g(a,3)-24*g(n,2)*g(a,2)+33*g(n,2)*a-15*g(n,2)+n*g(a,4)-6*n*g(a,3)+15*n*g(a,2)-20*n*a+15*n+1):(5*n+a)/(6*g(n,4)*a-6*g(n,4)+11*g(n,3)*g(a,2)-26*g(n,3)*a+15*g(n,3)+6*g(n,2)*g(a,3)-24*g(n,2)*g(a,2)+33*g(n,2)*a-15*g(n,2)+n*g(a,4)-6*n*g(a,3)+15*n*g(a,2)-20*n*a+15*n+1)}var fl=p.Factory({Name:"RoyalGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Kt("RoyalGreatsword1")]}),Ll=p.Factory({Name:"SacrificialGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),pl=p.Factory({Name:"SkyriderGreatsword",Type:t.weapon.CLAYMORE,Stars:3,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"SkyriderGreatsword1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.06,.07,.08,.09,.1).Build()})]}),Nl=p.Factory({Name:"SkywardPride",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"SkywardPride1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.08,.1,.12,.14,.16).Next().instance.Basic({Name:"HIT_SkywardPride",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.8,1,1.2,1.4,1.6]}).Build()})]}),aa=(e,a)=>l.Factory({Name:e,MaxRank:5,OnApply:new l.Builder().instance.Options({Name:a,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NONE,Scaling:[{Initial:0,Stat:t.stat.NONE,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Next().Where({not:!0,enemy:{affected:[t.stat.CRYO_DMG]}}).mv.Mv(t.stat.ATK,.8,a).Map((s,n,r)=>[.8,.95,1.1,1.25,1.4][r.GetRank()-1]).Next().Where({enemy:{affected:[t.stat.CRYO_DMG]}}).mv.Mv(t.stat.ATK,2,a).Map((s,n,r)=>[2,2.4,2.8,3.2,3.6][r.GetRank()-1]).Build()}),dl=p.Factory({Name:"SnowTombedStarsilver",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[aa("SnowTombedStarsilver1","HIT_SnowTombedStarsilver")]}),Cl=p.Factory({Name:"TheBell",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"TheBell1",MaxRank:5,OnApply:new l.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),oe=e=>l.Factory({Name:e,MaxRank:5,MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Next().Where({target:{shielded:!0}}).stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()}),Ml=p.Factory({Name:"TheUnforged",Type:t.weapon.CLAYMORE,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[oe("TheUnforged1")]}),gl=p.Factory({Name:"Whiteblind",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.DEF_PERCENT,Effects:[l.Factory({Name:"Whiteblind1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),Gl=p.Factory({Name:"WhiteIronGreatsword",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.DEF_PERCENT,Effects:[]}),Rl=p.Factory({Name:"WolfsGravestone",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"WolfsGravestone1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()}),l.Factory({Name:"WolfsGravestone2",MaxRank:5,ApplyOther:!0,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.4,.5,.6,.7,.8).Build()})]}),Il=p.Factory({Name:"SerpentSpine",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"SerpentSpine1",MaxRank:5,MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.06,.07,.08,.09,.1).Stacks().Build()})]}),Ol=p.Factory({Name:"FreedomSworn",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"FreedomSworn1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.1,.125,.15,.175,.2).Build()}),ea({Name:"FreedomSworn2",OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),Dl=p.Factory({Name:"LightOfFoliarIncision",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"LightOfFoliarIncision1",MaxRank:5,Conditions:["HIT_NORMAL"],MaxConditions:1,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.04,.05,.06,.07,.08).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT,t.stat.ELEMENTAL_SKILL_DMG_FLAT).Values(1.2,1.5,1.8,2.1,2.4).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()})]}),vl=p.Factory({Name:"KeyOfKhajNisut",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"KeyOfKhajNisut1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Build()}),l.Factory({Name:"KeyOfKhajNisut2",MaxRank:5,MaxStacks:3,ApplyOther:!0,OnApply:new l.Builder().observe.Owner(t.stat.HP,t.stat.HP_PERCENT,t.stat.HP_FLAT).Where({target:{isOwner:!0}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(.12,.15,.18,.21,.24).Stacks().Map((e,a)=>e*a.GetCharacter().Get(t.stat.HP)/100).Next().observe.Owner(t.stat.HP,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ELEMENTAL_MASTERY).Stacks([0,0,0,.2],[0,0,0,.25],[0,0,0,.3],[0,0,0,.35],[0,0,0,.4]).Map((e,a,{Owner:s})=>e*s.GetCharacter().Get(t.stat.HP)/100).Build()})]}),yl=p.Factory({Name:"HaranGeppakuFutsu",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"HaranGeppakuFutsu1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Stacks().Build()})]}),Hl=p.Factory({Name:"MistsplitterReforged",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"MistsplitterReforged1",MaxRank:5,MaxStacks:3,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char().MapStat(e=>[e.GetCharacter().Options.Element]).Stacks([0,.08,.16,.28],[0,.1,.2,.35],[0,.12,.24,.42],[0,.14,.28,.49],[0,.16,.32,.56]).Build()})]}),Pl=p.Factory({Name:"JadeCutter",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"JadeCutter1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Next().observe.Target(t.stat.HP_PERCENT,t.stat.HP_FLAT,t.stat.HP_BASE).stat.Char(t.stat.ATK_FLAT).Values(.012,.015,.018,.021,.024).Map((e,a)=>e*a.GetCharacter().Get(t.stat.HP)).Build()})]}),wl=p.Factory({Name:"SummitShaper",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[oe("SummitShaper1")]}),Bl=p.Factory({Name:"AquilaFavonia",Type:t.weapon.SWORD,Stars:5,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"AquilaFavonia1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().instance.Basic({Name:"HIT_AquilaFavonia",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2,2.3,2.6,2.9,3.2]}).Build()})]}),bl=p.Factory({Name:"ToukabouShigure",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"ToukabouShigure1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.16,.2,.24,.28,.32).Build()})]}),Kl=p.Factory({Name:"XiphosMoonlight",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[el("XiphosMoonlight1",t.stat.ENERGY_RECHARGE,[.036/100,.045/100,.054/100,.063/100,.072/100])]}),Yl=p.Factory({Name:"SapwoodBlade",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[cl("SapwoodBlade1")]}),Fl=p.Factory({Name:"KagotsurubeIsshin",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"KagotsurubeIsshin1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_KagotsurubeIsshin",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.8]}).Next().stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()})]}),kl=p.Factory({Name:"CinnabarSpindle",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.DEF_PERCENT,Effects:[l.Factory({Name:"CinnabarSpindle1",MaxRank:5,OnApply:new l.Builder().mv.Mv(t.stat.DEF,.4,e=>e.Options.Talent===t.stat.ELEMENTAL_SKILL_DMG).Map((e,a,s)=>[.4,.5,.6,.7,.8][s.GetRank()-1]).Build()})]}),Vl=p.Factory({Name:"AmenomaKageuchi",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[]}),xl=p.Factory({Name:"FesteringDesire",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"FesteringDesire1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ELEMENTAL_SKILL_CRIT_RATE).Values(.06,.075,.09,.105,.12).Build()})]}),Ul=p.Factory({Name:"SwordOfDescension",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39b,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"SwordOfDescension1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_SwordOfDescension",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2]}).Next().Where({target:{name:/traveler/i}}).stat.Char(t.stat.ATK_FLAT).Values(66).Build()})]}),Wl=p.Factory({Name:"TheAlleyFlash",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"TheAlleyFlash1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),jl=p.Factory({Name:"BlackcliffLongsword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.CRIT_DMG,Effects:[bt("BlackcliffLongsword1")]}),zl=p.Factory({Name:"IronSting",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"IronSting1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),ql=p.Factory({Name:"PrototypeRancour",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"PrototypeRancour1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()})]}),$l=p.Factory({Name:"LionsRoar",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"LionsRoar1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),Ql=p.Factory({Name:"TheFlute",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"TheFlute1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_TheFlute",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),Xl=p.Factory({Name:"RoyalGrimoire",Type:t.weapon.CATALYST,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Kt("RoyalGrimoire1")]}),Jl=p.Factory({Name:"RoyalSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Kt("RoyalSpear1")]}),Zl=p.Factory({Name:"RoyalBow",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Kt("RoyalBow1")]}),to=p.Factory({Name:"RoyalLongsword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Kt("RoyalLongsword1")]}),eo=p.Factory({Name:"SkyriderSword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"SkyriderSword1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Build()})]}),ao=p.Factory({Name:"DarkIronSword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"DarkIronSword1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),so=p.Factory({Name:"FilletBlade",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"FilletBlade1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_FilletBlade",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,2.8,3.2,3.6,4]}).Build()})]}),no=p.Factory({Name:"TravelersHandySword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.DEF_PERCENT,Effects:[]}),ro=p.Factory({Name:"HarbingerOfDawn",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"HarbingerOfDawn1",MaxRank:5,OnApply:new l.Builder().Where({target:{hp:{geq:.9}}}).stat.Char(t.stat.CRIT_RATE).Values(.14,.175,.21,.245,.28).Build()})]}),io=p.Factory({Name:"CoolSteel",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"CoolSteel1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.CRYO_DMG,t.stat.HYDRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),lo=p.Factory({Name:"HuntersPath",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"HuntersPath1",MaxRank:5,Conditions:["HIT_CHARGED"],MaxConditions:1,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({effect:{conditions:["HIT_CHARGED"]}}).stat.Char(t.stat.CHARGED_ATTACK_DMG_FLAT).Values(1.6,2,2.4,2.8,3.2).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()})]}),oo=p.Factory({Name:"ThunderingPulse",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"ThunderingPulse1",MaxRank:5,MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG).Stacks([0,.12,.24,.4],[0,.15,.3,.5],[0,.18,.36,.6],[0,.21,.42,.7],[0,.24,.48,.8]).Build()})]}),co=p.Factory({Name:"AquaSimulacra",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"AquaSimulacra1",MaxRank:5,Conditions:["FAR","NEAR"],MaxConditions:1,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["NEAR"]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),Eo=p.Factory({Name:"PolarStar",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"PolarStar1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Stacks([0,.1,.2,.3,.48],[0,.125,.25,.375,.6],[0,.15,.3,.45,.72],[0,.175,.35,.525,.84],[0,.2,.4,.6,.96]).Build()})]}),To=p.Factory({Name:"AmosBow",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"AmosBow1",MaxRank:5,MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),_o=p.Factory({Name:"EndOfTheLine",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"EndOfTheLine1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_EndOfTheLine",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.8,1,1.2,1.4,1.6]}).Build()})]}),uo=p.Factory({Name:"KingsSquire",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"KingsSquire1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,80,100,120,140).Next().instance.Basic({Name:"HIT_KingsSquire",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.2,1.4,1.6,1.8]}).Build()})]}),Ao=p.Factory({Name:"MouunsMoon",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Ze("MouunsMoon1")]}),So=p.Factory({Name:"Predator",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"Predator1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.1).Stacks().Next().Where({target:{name:"Aloy"}}).stat.Char(t.stat.ATK_FLAT).Values(66).Build()})]}),ho=p.Factory({Name:"Hamayumi",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"Hamayumi1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().Where({target:{energy:{geq:1}}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().Where({target:{energy:{geq:1}}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().Build()})]}),mo=p.Factory({Name:"WindblumeOde",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"WindblumeOde1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()})]}),fo=p.Factory({Name:"MitternachtsWaltz",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"MitternachtsWaltz1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_SKILL"],MaxConditions:2,OnApply:new l.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),Lo=p.Factory({Name:"FadingTwilight",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"FadingTwilight1",MaxRank:5,MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Stacks([0,.06,.1,.14],[0,.075,.125,.175],[0,.09,.15,.21],[0,.105,.175,.245],[0,.12,.2,.28]).Build()})]}),po=p.Factory({Name:"AlleyHunter",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"AlleyHunter1",MaxRank:5,MaxStacks:10,OnApply:new l.Builder().stat.Char(t.stat.ALL_DMG).Values(.02,.025,.03,.035,.04).Stacks().Build()})]}),No=p.Factory({Name:"TheViridescentHunt",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"TheViridescentHunt1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_TheViridescentHunt",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.4,.5,.6,.7,.8]}).Build()})]}),Co=p.Factory({Name:"CompoundBow",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"CompoundBow1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()})]}),Mo=p.Factory({Name:"PrototypeCrescent",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"PrototypeCrescent1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.36,.45,.54,.63,.72).Build()})]}),go=p.Factory({Name:"Rust",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"Rust1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.4,.5,.6,.7,.8).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(-.1).Build()})]}),Go=p.Factory({Name:"SacrificialBow",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Ro=p.Factory({Name:"TheStringless",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"TheStringless1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),Io=p.Factory({Name:"Messenger",Type:t.weapon.BOW,Stars:3,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"Messenger1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_Messenger",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),Oo=p.Factory({Name:"Slingshot",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"Slingshot1",MaxRank:5,Conditions:["FAR","NEAR"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["FAR"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.36,.42,.48,.54,.6).Next().Where({effect:{conditions:["NEAR"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(-.1).Build()})]}),Do=p.Factory({Name:"RecurveBow",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.HP_PERCENT,Effects:[]}),vo=p.Factory({Name:"SharpshootersOath",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"SharpshootersOath1",Conditions:["WEAK_SPOT"],MaxConditions:1,MaxRank:5,OnApply:new l.Builder().Where({effect:{conditions:["WEAK_SPOT"]}}).stat.Char(t.stat.AIMED_SHOT_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),yo=p.Factory({Name:"RavenBow",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"RavenBow1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),Ho=p.Factory({Name:"TulaytullahsRemembrance",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"TulaytullahsRemembrance1",MaxRank:5,MaxStacks:10,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.048,.06,.072,.084,.096).Stacks().Build()})]}),Po=p.Factory({Name:"ThousandFloatingDreams",Type:t.weapon.CATALYST,Stars:5,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"ThousandFloatingDreams1",MaxRank:5,OnApply(e,a,s){const n=e.GetCharacter(),r=s.Modifier(n.CreateModifier(t.stat.ELEMENTAL_MASTERY,0)),i=[s.Modifier(n.CreateModifier(n.Options.Element,0)),s.Modifier(n.CreateModifier(n.Options.Element,0)),s.Modifier(n.CreateModifier(n.Options.Element,0))];function c(){i.forEach(h=>h.SetValue(0));let _=[n];const u=e.GetParty();u&&(_=u.GetMembers().map(h=>h.GetCharacter()));let A=0,S=0;for(const h of _)if(h!==n)if(h.Options.Element===n.Options.Element)A++;else{const m=i[S++];if(!m)continue;m.SetProp(h.Options.Element),m.SetValue(t1[a.GetRank()-1])}A=Math.min(3,A),r.SetValue(Zp[a.GetRank()-1]*A)}return c(),s.Observer(e.Event.CreateObserver(G.CharboxEvent.CHANGE_PARTY,c)),s.Observer(a.Event.CreateObserver(l.EffectEvent.CHANGE_RANK,c)),()=>0}}),l.Factory({Name:"ThousandFloatingDreams2",MaxRank:5,ApplyOther:!0,ApplySelf:!1,StackSelf:!0,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(40,42,44,46,48).Build()})]}),Zp=[32,40,48,56,64],t1=[.1,.14,.18,.22,.26],wo=p.Factory({Name:"WanderingEvenstar",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"WanderingEvenstar1",StackSelf:!0,ApplyOther:!0,MaxRank:5,OnApply:new l.Builder().observe.Owner(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.24,.3,.36,.42,.48).Map((e,a,s)=>e*s.Owner.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)*(a===s.Owner?1:.3)).Build()})]}),Bo=p.Factory({Name:"KagurasVerity",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"KagurasVerity1",MaxRank:5,MaxStacks:3,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.12,.15,.18,.21,.24).Stacks().Next().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Stacks([0,0,0,.12],[0,0,0,.15],[0,0,0,.18],[0,0,0,.21],[0,0,0,.24]).Build()})]}),bo=p.Factory({Name:"EverlastingMoonglow",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"EverlastingMoonglow1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.1,.125,.15,.175,.2).Next().observe.Target(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(.01,.015,.02,.025,.03).Map((e,a)=>e*a.GetCharacter().Get(t.stat.HP)).Build()})]}),Ko=p.Factory({Name:"MemoryOfDust",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[oe("MemoryOfDust1")]}),Yo=p.Factory({Name:"LostPrayer",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"LostPrayer1",MaxRank:5,MaxStacks:4,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),Fo=p.Factory({Name:"SkywardAtlas",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"SkywardAtlas1",MaxRank:5,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().instance.Basic({Name:"HIT_SkywardAtlas",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.6,2,2.4,4.8,3.2]}).Build()})]}),ko=p.Factory({Name:"FruitOfFulfillment",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"FruitOfFulfillment1",MaxRank:5,MaxStacks:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(24,27,30,33,36).Stacks().Next().stat.Char(t.stat.ATK_PERCENT).Values(-.05).Stacks().Build()})]}),Vo=p.Factory({Name:"OathswornEye",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"OathswornEye1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.24,.3,.36,.42,.48).Build()})]}),xo=p.Factory({Name:"HakushinRing",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"HakushinRing1",ApplyOther:!0,MaxRank:5,OnApply:new l.Builder().stat.Char().MapStat(e=>[e.GetCharacter().Options.Element]).Values(.1,.125,.15,.175,.2).Build()})]}),Uo=p.Factory({Name:"DodocoTales",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"DodocoTales1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_CHARGED"],MaxConditions:2,OnApply:new l.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["HIT_CHARGED"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.08,.1,.12,.14,.16).Next().Build()})]}),Wo=p.Factory({Name:"Frostbearer",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[aa("Frostbearer1","HIT_Frostbearer")]}),jo=p.Factory({Name:"EyeOfPerception",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"EyeOfPerception1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_EyeOfPerception",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,2.7,3,3.3,3.6]}).Build()})]}),zo=p.Factory({Name:"BlackcliffAgate",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[bt("BlackcliffAgate1")]}),qo=p.Factory({Name:"MappaMare",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"MappaMare1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),$o=p.Factory({Name:"PrototypeAmber",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.HP_PERCENT,Effects:[]}),Qo=p.Factory({Name:"SolarPearl",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"SolarPearl1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_SKILL"],MaxConditions:2,OnApply:new l.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Next().Build()})]}),Xo=p.Factory({Name:"SacrificialFragments",Type:t.weapon.CATALYST,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[]}),Jo=p.Factory({Name:"FavoniusCodex",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Zo=p.Factory({Name:"AmberBead",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"AmberBead1",MaxRank:5,MaxStacks:2,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),tc=p.Factory({Name:"TwinNephrite",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"TwinNephrite1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.14,.16,.18,.2).Build()})]}),ec=p.Factory({Name:"EmeraldOrb",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"EmeraldOrb1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),ac=p.Factory({Name:"OtherworldlyStory",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),sc=p.Factory({Name:"ThrillingTalesOfDragonSlayers",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"ThrillingTalesOfDragonSlayers1",MaxRank:5,ApplySelf:!1,ApplyOther:!0,MaxTargets:1,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.24,.3,.36,.42,.48).Build()})]}),nc=p.Factory({Name:"MagicGuide",Type:t.weapon.CATALYST,Stars:3,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"MagicGuide1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),rc=p.Factory({Name:"StaffOfTheScarletSands",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"StaffOfTheScarletSands1",MaxRank:5,MaxStacks:3,OnApply:new l.Builder().observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.52,.65,.78,.91,1.04).Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.28,.35,.42,.49,.56).Stacks().Map((e,a)=>e*a.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Next().Build()})]}),ic=p.Factory({Name:"CalamityQueller",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_49,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"CalamityQueller1",MaxRank:5,MaxStacks:6,Conditions:["ON_FIELD","OFF_FIELD"],MaxConditions:1,OnApply:new l.Builder().stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ATK_PERCENT).Values(.032,.04,.048,.056,.064).Stacks().Next().Where({effect:{conditions:["OFF_FIELD"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.032,.04,.048,.056,.064).Stacks().Next().Build()})]}),lc=p.Factory({Name:"JadeSpear",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"JadeSpear1",MaxRank:5,MaxStacks:7,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.032,.039,.046,.053,.06).Stacks().Next().stat.Char(t.stat.ALL_DMG).Stacks([0,0,0,0,0,0,0,.12],[0,0,0,0,0,0,0,.15],[0,0,0,0,0,0,0,.18],[0,0,0,0,0,0,0,.21],[0,0,0,0,0,0,0,.24]).Build()})]}),oc=p.Factory({Name:"VortexVanquisher",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[oe("VortexVanquisher1")]}),cc=p.Factory({Name:"SkywardSpine",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"SkywardSpine1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.08,.1,.12,.14,.16).Next().instance.Basic({Name:"HIT_SkywardSpine",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.4,.55,.7,.85,1]}).Build()})]}),Ec=p.Factory({Name:"MissiveWindspear",Type:t.weapon.POLEARM,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"MissiveWindspear1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(48,60,72,84,96).Build()})]}),Tc=p.Factory({Name:"Moonpiercer",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"Moonpiercer1",ApplyOther:!0,MaxTargets:1,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()})]}),_c=p.Factory({Name:"EngulfingLightning",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"EngulfingLightning1",MaxRank:5,Conditions:["CAST_BURST","NO_BURST"],MaxConditions:1,OnApply:new l.Builder().observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ATK_PERCENT).Values(.28,.35,.42,.49,.56).Map((e,a,s)=>e1(e,a.GetCharacter().Get(t.stat.ENERGY_RECHARGE),s.GetRank())).Next().Where({effect:{conditions:["CAST_BURST"]}}).stat.Char(t.stat.ENERGY_RECHARGE).Values(.3,.35,.4,.45,.5).Build()})]});function e1(e,a,s){return Math.min(e*Math.max(0,a-1),a1[s-1])}var a1=[.8,.9,1,1.1,1.2],uc=p.Factory({Name:"WavebreakerFin",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_45,Substat:t.stat.ATK_PERCENT,Effects:[Ze("WavebreakerFin1")]}),Ac=p.Factory({Name:"KitainCrossSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"KitainCrossSpear1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.06,.075,.09,.105,.12).Build()})]}),Sc=p.Factory({Name:"DragonspineSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.PHYSICAL_DMG,Effects:[aa("DragonspineSpear1","HIT_DragonspineSpear")]}),hc=p.Factory({Name:"LithicSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[_l("LithicSpear1")]}),mc=p.Factory({Name:"CrescentPike",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[l.Factory({Name:"CrescentPike1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_CrescentPike",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.2,.25,.3,.35,.4]}).Build()})]}),fc=p.Factory({Name:"Halberd",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ATK_PERCENT,Effects:[l.Factory({Name:"Halberd1",MaxRank:5,OnApply:new l.Builder().instance.Basic({Name:"HIT_Halberd",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.6,2,2.4,2.8,3.2]}).Build()})]}),Lc=p.Factory({Name:"DragonsBane",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[l.Factory({Name:"DragonsBane1",MaxRank:5,OnApply:new l.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.PYRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),pc=p.Factory({Name:"SacrificialSword",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Nc=p.Factory({Name:"ElegyForTheEnd",Type:t.weapon.BOW,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"ElegyForTheEnd1",ApplySelf:!0,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,75,90,105,120).Build()}),ea({Name:"ElegyForTheEnd2",OnApply:new l.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100,125,150,175,200).Next().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),dc=p.Factory({Name:"StaffOfHoma",Type:t.weapon.POLEARM,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"StaffOfHoma1",ApplySelf:!0,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Next().observe.Target(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ATK_FLAT).Values(.008,.01,.012,.014,.016).Map((e,a)=>a.GetCharacter().Get(t.stat.HP)*e).Next().observe.Target(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ATK_FLAT).Where({target:{hp:{leq:.5}}}).Values(.01,.012,.014,.016,.018).Map((e,a)=>a.GetCharacter().Get(t.stat.HP)*e).Build()})]}),Cc=p.Factory({Name:"FavoniusLance",Type:t.weapon.POLEARM,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Mc=p.Factory({Name:"WhiteTassel",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"WhiteTassel1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),gc=p.Factory({Name:"BlackTassel",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.HP_PERCENT,Effects:[l.Factory({Name:"BlackTassel1",MaxRank:5,Conditions:["NO_SLIMES","SLIMES"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["SLIMES"]}}).stat.Char(t.stat.ALL_DMG).Values(.4,.5,.6,.7,.8).Build()})]}),Gc=p.Factory({Name:"PrototypeStarglitter",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[l.Factory({Name:"PrototypeStarglitter1",MaxStacks:2,MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.08,.1,.12,.14,.16).Stacks().Next().Build()})]}),Rc=p.Factory({Name:"BlackcliffPole",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[bt("BlackcliffPole1")]}),Ic=p.Factory({Name:"Deathmatch",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"Deathmatch1",MaxRank:5,MaxConditions:1,Conditions:["ENEMY_1","ENEMY_2"],OnApply:new l.Builder().Where({effect:{conditions:["ENEMY_2"]}}).stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["ENEMY_1"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.24,.3,.36,.42,.48).Build()})]}),Oc=p.Factory({Name:"SkywardBlade",Stars:5,Type:t.weapon.SWORD,Substat:t.stat.ENERGY_RECHARGE,Scaling:o.WeaponScaling.TYPE_46,Effects:[l.Factory({Name:"SkywardBlade1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.CRIT_RATE).Values(.04,.05,.06,.07,.08).Next().instance.Basic({Name:"HIT_SkywardBlade",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.2,.25,.3,.35,.4]}).Build()})]}),Dc=p.Factory({Name:"SkywardHarp",Type:t.weapon.BOW,Stars:5,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[l.Factory({Name:"SkywardHarp1",MaxRank:5,OnApply:new l.Builder().stat.Char(t.stat.CRIT_DMG).Values(.2,.25,.3,.35,.4).Next().instance.Basic({Name:"HIT_SkywardHarp",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.25]}).Build()})]}),vc=p.Factory({Name:"FavoniusSword",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),yc=p.Factory({Name:"FavoniusWarbow",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Hc=p.Factory({Name:"TheWidsith",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[l.Factory({Name:"TheWidsith1",MaxRank:5,Conditions:["RECITATIVE","ARIA","INTERLUDE"],MaxConditions:1,OnApply:new l.Builder().Where({effect:{conditions:["RECITATIVE"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.6,.75,.9,1.05,1.2).Next().Where({effect:{conditions:["ARIA"]}}).stat.Char(...t.Elements.filter(e=>e!==t.stat.PHYSICAL_DMG)).Values(.48,.6,.72,.84,.96).Next().Where({effect:{conditions:["INTERLUDE"]}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(240,300,360,420,480).Build()})]}),Pc=Object.values(vi).sort((e,a)=>e.Type===a.Type?e.Stars===a.Stars?e.Name.localeCompare(a.Name):e.Stars-a.Stars:e.Type-a.Type),ce={};for(const e of Pc)ce[e.Type]||(ce[e.Type]=[]),ce[e.Type].push(e);var sa=new Q(e=>e.Name);sa.AddList(Pc);function wc(){return sa.Get()}function s1(e){return sa.Find(e)}function n1(e){return ce[e]||[]}var Ee={};D(Ee,{FindByName:()=>i1,GetList:()=>r1});var Nt=new Q(e=>e.Name);for(const e of Di())e.Effects.forEach(a=>Nt.Add(a));for(const e of wc())e.Effects.forEach(a=>Nt.Add(a));for(const e of Dr())e.Piece2.forEach(a=>Nt.Add(a)),e.Piece4.forEach(a=>Nt.Add(a));for(const e of An())Nt.Add(e);function r1(){return Nt.Get()}function i1(e){return Nt.Find(e)}var Yt={};D(Yt,{ArtifactStore:()=>c1,CopyCharbox:()=>A1,FilterArtifacts:()=>na,PartyFrom:()=>l1});function l1(e){const a=new G.Party;for(const s in e.characters){const n=pt.FindByName(s);if(!n)throw new Error(`Character not found: ${s}`);const r=n();a.Add(r);const i=e.characters[s],c=Object.keys(i.weapon)[0];if(c){const _=et.FindByName(c);if(!_)throw new Error(`Weapon not found: ${s}`);r.SetWeapon(_)}i.artifacts&&Object.keys(i.artifacts).length>0&&r.SetArtifacts(new Lt.Artbox(r))}return G.ImportParty(e,a),a}function na(e,a,s){const n=a.map(r=>o1(r));return s&&n.push({filter(r){return!(s.pieces&&!s.pieces.includes(r.piece)||s.only&&s.only==="locked"!==!!r.locked)}}),$a.Filter({values:e,mode:"every",filters:n})}function o1(e){const a=e.pieces||t.piece.Values(),s=e.subsMode||"some";return{for(n){return a.includes(n.piece)},filter(n){if(e.main&&!e.main.includes(n.mainstat))return!1;if(e.subs){const r=n.substats.map(c=>c.stat);if(!e.subs[s](c=>r.includes(c)))return!1}return!(Number.isFinite(e.stars)&&n.stars<(e.stars||0)||Number.isFinite(e.level)&&n.level<(e.level||0))}}}var c1=class{constructor(e){this.onChange=e,this.list=[],this.filtered=[]}Update(){this.onChange()}All(){return this.list}Clear(){this.list.splice(0,this.list.length),this.filtered.splice(0,this.filtered.length),this.onChange()}Add(e,a="push"){const s=I.Export(e);this.list[a](s),this.filtered=[...this.list],this.onChange()}AddExported(e,a="push"){this.list[a](e),this.filtered=[...this.list],this.onChange()}Filter(e,a){const{values:s}=na(this.list,e,a);return this.filtered=s,s}Get(){return this.filtered}Replace(e,a){const s=this.list.indexOf(e);return s===-1?!1:(this.list.splice(s,1,a),this.onChange(),!0)}RemoveMultiple(e,a){const{indexes:s}=na(this.list,e,a),n=[];return this.list.forEach((r,i)=>{s.includes(i)||n.push(r)}),this.list=n,this.onChange(),n.length}Remove(e){const a=this.list.indexOf(e);return a===-1?!1:(this.list.splice(a,1),this.onChange(),!0)}};function E1(e,a){const s=e.GetArtifacts();let n=a.GetArtifacts();if(!s){a.SetArtifacts(void 0);return}n||(n=new Lt.Artbox(a),a.SetArtifacts(n));const r=n,i=s.GetActiveSets(),c=r.GetActiveSets(),_=(()=>{const u=new Map;return s.GetEffects().forEach(A=>{const S=A.GetTargets().map(h=>h===e?a:h);u.set(A.Options.Name,S)}),u})();r.GetArtifacts().forEach((u,A)=>{const S=s.Get(A);I.Import(I.Export(S),u)}),i.every(u=>c.includes(u))&&r.GetEffects().forEach(u=>{const A=_.get(u.Options.Name);A&&u.ApplyMultiple(A)})}var T1=[[t.stat.NORMAL_ATTACK_LEVEL,t.stat.NORMAL_ATTACK_LEVEL_UP],[t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP],[t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP]];function _1(e,a){const s=e.GetCharacter(),n=a.GetCharacter();for(const[r,i]of T1){const c=s.Get(r)-s.Get(i),_=n.Get(i);n.Set(r,c+_)}}function u1(e,a){const s=e.GetWeapon(),n=a.GetWeapon();if(!s){a.SetWeapon(void 0);return}if(!n||n.Options.Name!==s.Options.Name){const i=et.FindByName(s.Options.Name);if(!i)throw new Error(`Weapon not found: ${s.Options.Name}`);a.SetWeapon(i)}const r=a.GetWeapon();if(!r)throw new Error("Target has no weapon");p.Import(p.Export(s),r)}function A1(e,a){a.GetCharacter().SetLevel(e.GetCharacter().GetLevel()),a.GetCharacter().SetAscension(e.GetCharacter().GetAscension()),_1(e,a),u1(e,a),E1(e,a)}var ra=class extends xa{constructor(e){super(e);const a=Mt.Contexts("math","logic",{functions:{pick:{name:"pick",arguments:[{name:"index",description:"integer index of the item to pick, starting at 1"},"..."],evaluate({values:[n,...r]}){return r[n-1]}},var:{name:"var",arguments:[{name:"name",description:"name of the variable to set",expression:!0},{name:"value",description:"value to set the variable to"}],evaluate:({values:[,n],expressions:[r]})=>{const i=r.token.value;return s.setVar(i,n),n}},add:{name:"add",arguments:[{name:"variable",description:"name of the variable to add to",expression:!0},{name:"value",description:"value to add to the variable"}],evaluate:({values:[,n],expressions:[r]})=>{const i=r.token.value,c=s.getVar(i);if(c===void 0)throw new Error(`Variable ${i} is not defined`);const _=c+n;return s.setVar(i,_),_}},multiply:{name:"multiply",arguments:[{name:"variable",description:"name of the variable to multiply",expression:!0},{name:"value",description:"value to multiply the variable by"}],evaluate:({values:[,n],expressions:[r]})=>{const i=r.token.value,c=s.getVar(i);if(c===void 0)throw new Error(`Variable ${i} is not defined`);const _=c*n;return s.setVar(i,_),_}}}}),s=new Mt(a);this.exprParser=s}};function w(e){if(typeof e=="number")return e;const a=e.endsWith("%");a&&(e=e.slice(0,e.length-1));let s=parseFloat(e);if(!Number.isFinite(s))throw new Error(`Invalid number format: "${e}"`);return a&&(s/=100),s}function BN(e){return e}var S1=()=>({show:{name:"show",description:"Shows the rolls of the character artifacts",compile(e,{context:a,logger:s}){return function(){const i=a.GetChar().GetArtifacts();if(!i){s.error("Current character has no artifacts");return}s.log(`
`+i.GetArtifacts().map(c=>T.ArtifactRolls(c)).join(`
`))}}},tier:{name:"tier",arguments:"tier",description:"Sets the rolls tier to equip.`",example:"artifact rolls tier 3",docs:{tier:"a number from 0 to 4, where 0 is the lowest tier and 3 is the highest tier.Also, the number 4 or the word `avg` can be used to set the tier to the average."},compile({values:[e]},{context:a,logger:s}){let n,r;return e==="avg"?(n=4,r="AVERAGE"):(n=Math.max(0,Math.min(4,Math.floor(w(e)))),r=n+""),function(){a.Config.substats.tier=n,s.logf("Rolls tier set to %s",r)}}},equip:{name:"equip",arguments:"stat rolls more...",description:"Equips the given rolls to the artifacts.Arguments in the form `[stat] [rolls] [stat] [rolls] ...`.",example:"artifact rolls equip crit_rate 10 crit_dmg 12 elemental_mastery 3",compile({values:e},{context:a,logger:s}){const n=[];for(let r=0;r<e.length;r+=2){const i=e[r].toUpperCase(),c=t.stat.Get(i),_=t.stat.Name(c),u=e[r+1];if(!u)throw new Error("Missing # of rolls for stat "+_);const A=Math.max(0,Math.floor(w(u)));n.push([c,A])}return function(){const i=a.GetChar().GetArtifacts();if(!i)throw new Error("Current character has no artifacts");i.EquipRolls({substats:n,tier:a.Config.substats.tier})?a.Config.substats.tier===4?s.logf("Equipped rolls of tier %s","AVERAGE"):s.logf("Equipped rolls of tier %d",a.Config.substats.tier):s.error("Rolls could not be equipped")}}}}),h1=()=>({list:{name:"list",description:"Lists the registered artifact sets",compile(e,{logger:a}){const s=new T.Table(T.labels.SET,T.labels.STARS),n=tt.GetList();return n.forEach(r=>s.AddRow(r.Name,r.Stars)),function(){a.logf("Total artifact sets: %d",n.length),a.log(`
`+s.String())}}},add:{name:"add",description:"Adds a build of 5 artifacts to the current character",compile(e,{context:a,logger:s}){return function(){const r=a.GetChar();r.GetArtifacts()?s.warn("Artifacts not created. Character already has artifacts"):(r.SetArtifacts(new Lt.Artbox(r)),s.log("Artifacts created"))}}},fill:{name:"fill",description:"Adds 4 empty substats to all artifacts in the current character",compile(e,{context:a,logger:s}){return function(){const i=a.GetChar().GetArtifacts();i?(i.GetArtifacts().forEach(c=>c.FillSubstats()),s.log("All artifacts filled")):s.error("Character has no artifacts")}}},main:{name:"main",description:"Sets the mainstats of the character artifacts.",arguments:"sands goblet circlet",example:"artifact main atk_percent pyro_dmg crit_rate",compile({values:[e,a,s]},{context:n,logger:r}){const i=t.stat.Get(e.toUpperCase()),c=t.stat.Get(a.toUpperCase()),_=t.stat.Get(s.toUpperCase());return function(){const S=n.GetChar().GetArtifacts();if(!S){r.error("Current character has no artifacts");return}S.Get(2).SetMainstat(i),S.Get(3).SetMainstat(c),S.Get(4).SetMainstat(_);const h=S.GetArtifacts().map(m=>t.stat.Name(m.GetMainstat()));r.logf("Artifact mainstats set to %s",h.join(", "))}}},level:{name:"level",description:"Sets the level of all the artifacts of the current character.",example:"artifact level 20",arguments:"level",compile({values:[e]},{context:a,logger:s}){const n=w(e);return function(){const c=a.GetChar().GetArtifacts();if(!c){s.error("Current character has no artifacts");return}c.GetArtifacts().forEach(u=>u.SetLevel(n));const _=c.GetArtifacts().map(u=>u.GetLevel());s.logf("Artifact levels set to %s",_.join(", "))}}},stars:{name:"stars",description:"Sets the stars of all the artifacts of the current character.",example:"artifact stars 5",arguments:"stars",compile({values:[e]},{context:a,logger:s}){const n=w(e);return function(){const c=a.GetChar().GetArtifacts();if(!c){s.error("Current character has no artifacts");return}c.GetArtifacts().forEach(u=>u.SetStars(n));const _=c.GetArtifacts().map(u=>u.GetStars());s.logf("Artifact stars set to %s",_.join(", "))}}},remove:{name:"remove",description:"Removes all artifacts from the current character",compile(e,{context:a,logger:s}){return function(){a.GetChar().SetArtifacts(void 0),s.log("Artifacts removed")}}},show:{name:"show",description:"Shows the artifacts of the current character",compile(e,{context:a,logger:s}){return function(){const i=a.GetChar().GetArtifacts();if(!i){s.error("Current character has no artifacts");return}s.log(`
`+T.Artifact(...i.GetArtifacts()))}}},rolls:{name:"rolls",description:"Control the artifact rolls in the current character",children:S1()},sets:{name:"sets",arguments:"firstName [otherNameOrPieces]",docs:{firstName:"the name of the first set",otherNameOrPieces:"the name of the second set, or the number of pieces of the first set (2 or 4)"},description:"Changes the artifact sets. Arguments in one of the following forms:\n- `artifact sets [firstName]`: 2-piece effect of the given set\n- `artifact sets [firstName] [otherName]`: 2-piece effect of the given sets, or the 4-piece effect if they're both the same.\n- `artifact sets [firstName] [Pieces]`: the given set with 2-piece or 4-piece effects.\n\nrun without arguments to remove all the sets.",example:`artifact sets CrimsonWitchOfFlames 4 // 4-piece set
artifact sets CrimsonWitchOfFlames WanderersTroupe // 2 + 2 piece set`,compile({values:e},{context:a,logger:s}){if(e.length===0)return function(){const u=a.GetChar().GetArtifacts();if(!u)throw new Error("Current character has no artifacts");u.GetArtifacts().forEach(A=>A.SetSet(void 0)),s.log("Removed all artifact sets")};e.length===1&&e.push("2");let n,r;const i=tt.FindByName(e[0]);if(!i)throw new Error("Set "+e[0]+" not found");if(n=i.Name,e[1]==="2")r=void 0;else if(e[1]==="4")r=n;else{const c=tt.FindByName(e[1]);if(!c)throw new Error("Set "+e[1]+" not found");r=c.Name}return function(){const u=a.GetChar().GetArtifacts();if(!u)throw new Error("Current character has no artifacts");u.Get(0).SetSet(n),u.Get(1).SetSet(n),u.Get(2).SetSet(r),u.Get(3).SetSet(r),s.logf("Artifact sets set to %s",u.GetActiveSets().join(", "))}}}}),m1=()=>{const e={};return t.piece.Values().forEach(a=>{const s=t.piece.Name(a).toLowerCase();e[s]={name:s,description:"Controls the artifact "+t.piece.Name(a),children:f1(a)()}}),e},f1=e=>()=>({main:{name:"main",description:"Sets the mainstat of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" main "+t.stat.Name(t.PieceToMainstats(e)[0]),arguments:"mainstat",compile({values:[a]},{context:s,logger:n}){const r=t.stat.Get(a.toUpperCase());return function(){const _=s.GetChar().GetArtifacts();if(!_){n.error("Current character has no artifacts");return}_.Get(e).SetMainstat(r),n.logf("%s mainstat set to %s",t.piece.Name(e),_.Get(e).GetMainstat())}}},set:{name:"set",description:"Sets the set name of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" set WanderersTroupe",arguments:"set",compile({values:[a]},{context:s,logger:n}){return function(){const c=s.GetChar().GetArtifacts();if(!c){n.error("Current character has no artifacts");return}c.Get(e).SetSet(a),n.logf("%s set changed to %s",t.piece.Name(e),c.Get(e).GetSet())}}},level:{name:"level",description:"Sets the level of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" level 16",arguments:"level",compile({values:[a]},{context:s,logger:n}){const r=w(a);return function(){const _=s.GetChar().GetArtifacts();if(!_){n.error("Current character has no artifacts");return}_.Get(e).SetLevel(r),n.logf("%s level set to %d",t.piece.Name(e),_.Get(e).GetLevel())}}},stars:{name:"stars",description:"Sets the stars of the "+t.piece.Name(e),example:t.piece.Name(e).toLowerCase()+" stars 4",arguments:"stars",compile({values:[a]},{context:s,logger:n}){const r=w(a);return function(){const _=s.GetChar().GetArtifacts();if(!_){n.error("Current character has no artifacts");return}_.Get(e).SetStars(r),n.logf("%s stars set to %d",t.piece.Name(e),_.Get(e).GetStars())}}},show:{name:"show",description:"Shows the "+t.piece.Name(e),compile(a,{context:s,logger:n}){return function(){const c=s.GetChar().GetArtifacts();if(!c){n.error("Current character has no artifacts");return}n.log(`
`+T.Artifact(c.Get(e)))}}},rolls:{name:"rolls",description:"Shows the rolls of the "+t.piece.Name(e),compile(a,{context:s,logger:n}){return function(){const c=s.GetChar().GetArtifacts();if(!c){n.error("Current character has no artifacts");return}const _=c.Get(e);n.log(T.ArtifactRolls(_))}}},sub:{name:"sub",description:"Control the substats of the "+t.piece.Name(e),children:{clear:{name:"clear",description:"Set all substats to 0",compile(a,{context:s,logger:n}){return function(){const c=s.GetChar().GetArtifacts();if(!c){n.error("Current character has no artifacts");return}c.Get(e).ClearSubstats(),n.log("Substats cleared")}}},add:{name:"add",description:"Adds a new substat to the artifact.",example:t.piece.Name(e).toLowerCase()+" sub add crit_rate 7.8%",arguments:"stat value",compile({values:[a,s]},{context:n,logger:r}){const i=t.stat.Get(a.toUpperCase()),c=w(s);return function(){const A=n.GetChar().GetArtifacts();if(!A){r.error("Current character has no artifacts");return}A.Get(e).AddSubstat(i,c)?r.log("Substat added"):r.warn("Substat not added")}}},set:{name:"set",description:"Changes a substat. Substat index starts from zero.",example:t.piece.Name(e).toLowerCase()+" sub set 2 crit_rate 7.8%",arguments:"index stat value",compile({values:[a,s,n]},{context:r,logger:i}){const c=w(a),_=t.stat.Get(s.toUpperCase()),u=w(n);return function(){const h=r.GetChar().GetArtifacts();if(!h){i.error("Current character has no artifacts");return}const m=h.Get(e);if(c>=m.SubstatsLength()){i.errorf("Substat index out of range [0-%d]",m.SubstatsLength()-1);return}m.SetSubstat(c,_),m.SetSubstatValue(c,u),i.logf("Substat %d changed",c)}}}}},downgrade:{name:"downgrade",description:"Converts a 5-star artifact to a 4-star artifact, reducing the value of substats.",compile(a,{context:s,logger:n}){return function(){const c=s.GetChar().GetArtifacts();if(!c){n.error("Current character has no artifacts");return}const _=c.Get(e);I.transform.Downgrade(_),n.log("Artifact downgraded")}}}}),L1=()=>({list:{name:"list",description:"Lists the stats of the current character",compile(e,{context:a,logger:s}){return function(){const r=a.GetChar().GetCharacter(),i=new T.Table(T.labels.STAT,T.labels.VALUE);i.DecimalPlaces=4;for(const c of t.stat.Values())i.AddRow(t.stat.Name(c),r.Get(c));s.log(`
`+i.String())}}},get:{name:"get",description:"Gets the value of stats in the current character",example:"character stat get crit_rate crit_dmg",arguments:"stats...",compile({values:e},{context:a,logger:s}){const n=e.map(r=>t.stat.Get(r.toUpperCase()));return function(){const i=a.GetChar().GetCharacter(),c=new T.Table(T.labels.STAT,T.labels.VALUE);c.DecimalPlaces=4;for(const _ of n)c.AddRow(t.stat.Name(_),i.Get(_));s.log(`
`+c.String())}}},set:{name:"set",description:"Sets the value of a stat in the current character",example:"character stat set atk_percent 45%",arguments:"stat value",compile({values:[e,a]},{context:s,logger:n}){const r=t.stat.Get(e.toUpperCase()),i=w(a);return function(){const _=s.GetChar(),u=_.GetCharacter();if(r===t.stat.HP_CURRENT||r===t.stat.ENERGY_CURRENT)u.Set(r,i);else{const A=u.Get(r);_.AddModifier(u.CreateModifier(r,i-A))}n.logf("Character stat %s set to %.4f",t.stat.Name(r),i)}}},add:{name:"add",description:"Adds to the value of a stat in the current character",example:"character stat add atk_percent 10%",arguments:"stat value",compile({values:[e,a]},{context:s,logger:n}){const r=t.stat.Get(e.toUpperCase()),i=w(a);return function(){const _=s.GetChar(),u=_.GetCharacter();_.AddModifier(u.CreateModifier(r,i)),n.logf("Modified %s + %.4f = %.4f",t.stat.Name(r),i,u.Get(r))}}},mods:{name:"mods",description:"Lists the stats added to the character with `stat add [...]`",compile(e,{context:a,logger:s}){return function(){const r=a.GetChar(),i=new T.Table(T.labels.STAT,T.labels.VALUE);i.DecimalPlaces=4,r.GetModifiers().forEach(c=>i.AddRow(t.stat.Name(c.GetProp()),c.GetValue())),s.log(`
`+i.String())}}},clear:{name:"clear",description:"Removes the stat modifiers created by `stat add [...]`",compile(e,{context:a,logger:s}){return function(){a.GetChar().ClearModifiers(),s.log("Cleared modifiers")}}}}),p1=()=>({add:{name:"add",description:"Adds a new character.",example:"character add hutao",arguments:"name",compile({values:[e]},{context:a,logger:s}){const n=pt.FindByName(e);if(!n)throw new Error("Character not found: "+e);return function(){if(a.Party.FindMember(e)){s.errorf("Cannot add character %s because it is already added",n.Name);return}const c=n();a.Party.Add(c),s.logf("Character %s added to the party",c.GetCharacter().Options.Name),a.GetCompiler().compileString(`character set ${n.Name}`,{line:s.line})()}}},remove:{name:"remove",description:"Removes a character from the party",example:"character remove Hutao",arguments:"name",compile({values:[e]},{context:a,logger:s}){return function(){const r=a.Party.FindMember(e);if(!r){s.errorf("Cannot remove character %s because it is not added",e);return}a.Party.Remove(r)?(r.GetEffects().forEach(i=>i.Disable().UnapplyAll()),a.GetChar()===r&&a.GetCompiler().compileString("character unset",{line:s.line})(),s.logf("Character %s removed",r.GetCharacter().Options.Name)):s.errorf("Cannot remove character %s",r.GetCharacter().Options.Name)}}},set:{name:"set",description:"Sets the current character",example:"character set Hutao",arguments:"name",compile({values:[e]},{context:a,logger:s}){return function(){const r=a.Party.FindMember(e);if(!r){s.errorf("Cannot set character %s because it is not added",e);return}a.SetChar(r),s.logf("Character %s set as current",r.GetCharacter().Options.Name)}}},unset:{name:"unset",description:"Unsets the current character",compile(e,{context:a,logger:s}){return function(){a.SetChar(void 0),s.log("Character unset. There is no current character selected")}}},level:{name:"level",description:"Sets the level of the current character",example:`character level 70
character level 80+ // level 80 ascended`,arguments:"level",compile({values:[e]},{context:a,logger:s}){let n=e;const r=e.endsWith("+");r&&(n=e.slice(0,n.length-1));const i=w(n),c=r?6:0;return function(){const u=a.GetChar().GetCharacter();u.SetLevel(i),u.SetAscension(c),s.logf("Character level set to %d%s",u.GetLevel(),u.IsAscended()?"+":"")}}},talent:{name:"talent",description:"Sets the talent levels of the current character",example:"character talent 9 5 7",arguments:"normal skill burst",compile({values:e},{context:a,logger:s}){const[n,r,i]=e.map(c=>w(c));return function(){const _=a.GetChar().GetCharacter();_.Set(t.stat.NORMAL_ATTACK_LEVEL,n),_.Set(t.stat.ELEMENTAL_SKILL_LEVEL,r),_.Set(t.stat.ELEMENTAL_BURST_LEVEL,i),s.logf("Character Normal Attack level set to %d",n),s.logf("Character Elemental Skill level set to %d",r),s.logf("Character Elemental Burst level set to %d",i)}}},list:{name:"list",description:"Lists all the registered characters",compile(e,{logger:a}){const s=new T.Table(T.labels.CHARACTER,T.labels.ELEMENT,T.labels.WEAPON,T.labels.STARS,T.labels.REGION),n=pt.GetList();n.forEach(i=>s.AddRow(i.Name,t.stat.Name(i.Element),t.weapon.Name(i.Weapon),i.Stars,t.region.Name(i.Region)));const r=s.String();return function(){a.logf("Total characters: %d",n.length),a.log(`
`+r)}}},show:{name:"show",description:"Shows the characters in the party",compile(e,{context:a,logger:s}){return function(){s.log(`
`+T.Character(...a.Party.GetMembers()))}}},damage:{name:"damage",description:"Shows the current character's damage instances",compile(e,{context:a,logger:s}){return function(){const r=a.GetChar();s.log(`
`+T.Instance(...r.GetInstances()))}}},stat:{name:"stat",description:"Controls character stats directly",children:L1()}});function U(e,a){return e.split(";").map(s=>s.split(",").map(r=>N1(r)).flat().map(a))}function N1(e){const a=e.split(":");if(a.length===1)return[e];if(a.length===2){const[s,n]=a.map(r=>{const i=parseInt(r);if(!Number.isFinite(i))throw new Error("Invalid range");return i});return Array.from({length:n-s+1},(r,i)=>i+s+"")}else if(a.length===3){const[s,n,r]=a.map(i=>{const c=parseInt(i);if(!Number.isFinite(c))throw new Error("Invalid range");return c});return Array.from({length:Math.floor((n-s)/r)+1},(i,c)=>c*r+s+"")}else throw new Error("Invalid range")}var d1=()=>({config:{name:"config",description:"shortcut for all effect configurations (stacks, condition, aura, etc.) in one command",arguments:"owner effect [enable=1|0] [stacks=] [condition=] [aura=] [target=] [target_add=] [lock=]",docs:{owner:"the owner of the effect",effect:"the effect name",enable:"enable (1) or disable (0) the effect. If not provided, the effect will not be changed",stacks:"the effect stacks. If not provided, the effect will not be changed",condition:"the effect condition or conditions, separated by commas. If not provided, the effect will not be changed",aura:"the effect aura or auras, separated by commas. If not provided, the effect will not be changed",target:"the effect target or targets, separated by commas. Also accepts `all`. If not provided, the effect will not be changed",target_add:"Similar to `target`, but adds the targets instead of replacing them",lock:"If provided, the effect will be locked to prevent being modified by character stat changes. Read more about this in the `effect lock` command."},example:"effect config Yelan YelanQ stacks=9 target=Hutao",compile({values:[e,a],named:s},{context:n,logger:r}){return function(){const c=n.Party.FindMember(e);if(!c){r.errorf("Cannot find owner %s",e);return}const _=c.FindEffect(a);if(!_){r.errorf("Cannot find effect %s",a);return}const u=_.Options.Name;if(s.enable!==void 0&&(s.enable==="1"?(_.Enable(),r.logf("Effect %s enabled",u)):(_.Disable(),r.logf("Effect %s disabled",u))),s.stacks!==void 0){const A=w(s.stacks);_.SetStacks(A),r.logf("Effect %s stacks set to %d",u,_.GetStacks())}if(s.condition!==void 0){const A=U(s.condition,h=>h)[0];_.SetConditions(...A);const S=_.GetConditions();r.logf("Effect %s conditions set to ["+"%s".repeat(S.length)+"]",u,...S)}if(s.aura!==void 0){const A=U(s.aura,m=>m)[0],S=A.length>0&&A[0].match(/all/i)?t.aura.Values().filter(m=>m!==t.aura.NONE):A.map(m=>t.aura.Get(m.toUpperCase()));_.SetAuras(...S);const h=_.GetAuras().map(m=>t.aura.Name(m));r.logf("Effect %s auras set to ["+"%s".repeat(h.length)+"]",u,...h)}if(s.target!==void 0){const A=U(s.target,S=>S)[0];if(A[0]==="all"){for(const S of n.Party.GetMembers())_.Apply(S);r.logf("Effect %s applied to all members",u);return}_.UnapplyAll();for(const S of A){const h=n.Party.FindMember(S);if(!h){r.errorf("Cannot find target %s",S);return}_.Apply(h)?r.logf("Effect %s applied to target %s",u,h.GetCharacter().Options.Name):r.warnf("Effect %s NOT applied to target %s",u,h.GetCharacter().Options.Name)}}if(s.target_add!==void 0){const A=U(s.target_add,S=>S)[0];if(A[0]==="all"){for(const S of n.Party.GetMembers())_.Apply(S);r.logf("Effect %s applied to all members",u);return}for(const S of A){const h=n.Party.FindMember(S);if(!h){r.errorf("Cannot find target %s",S);return}_.Apply(h)?r.logf("Effect %s applied to target %s",u,h.GetCharacter().Options.Name):r.warnf("Effect %s NOT applied to target %s",u,h.GetCharacter().Options.Name)}}if(s.lock!==void 0){const A=U(s.lock,S=>S)[0];if(A[0]==="all"){for(const S of n.Party.GetMembers())_.Lock(S);r.logf("Effect %s locked for all members",u);return}for(const S of A){const h=n.Party.FindMember(S);if(!h){r.errorf("Cannot find target %s",S);return}_.Lock(h),r.logf("Effect %s locked for target %s",u,h.GetCharacter().Options.Name)}}}}},all:{name:"all",description:"List all effects in the party",compile(e,{context:a,logger:s}){return function(){s.log(`
`+T.Effect(...a.Party.GetAllEffects()))}}},list:{name:"list",description:"Lists the effects of the current character",compile(e,{context:a,logger:s}){return function(){const i=[...a.GetChar().GetEffects(),...a.Party.GetResonances()];s.log(`
`+T.Effect(...i))}}},applied:{name:"applied",description:"Lists all the effects in the party that are applied to the current character.",compile(e,{context:a,logger:s}){return function(){const r=a.GetChar(),i=a.Party.GetAppliedEffects(r);s.log(`
`+T.Effect(...i))}}},set:{name:"set",description:"Sets the current effect",example:"effect set RaidenE",arguments:"name",compile({values:[e]},{context:a,logger:s}){return function(){let i=a.GetChar().FindEffect(e);if(i||(i=a.Party.GetResonances().find(c=>c.Options.Name.toLowerCase()===e.toLowerCase())),!i){s.errorf("Cannot find effect %s",e);return}a.SetEffect(i),s.logf("Effect set to %s",i.Options.Name)}}},unset:{name:"unset",description:"Unsets the current effect",compile(e,{context:a,logger:s}){return function(){a.SetEffect(void 0),s.log("Current effect unset")}}},show:{name:"show",description:"Shows details about the current effect",compile(e,{context:a,logger:s}){return function(){const r=a.GetEffect();s.log(`
`+T.EffectDetail(r))}}},enable:{name:"enable",description:"Enables the current effect",compile(e,{context:a,logger:s}){return function(){const r=a.GetEffect();r.Enable(),s.logf("Effect %s enabled",r.Options.Name)}}},disable:{name:"disable",description:"Disables the current effect",compile(e,{context:a,logger:s}){return function(){const r=a.GetEffect();r.Disable(),s.logf("Effect %s disabled",r.Options.Name)}}},apply:{name:"apply",arguments:"characters...",description:"Applies the current effect to the given characters, or all",example:`effect apply HuTao
effect apply HuTao Xingqiu
effect apply all`,compile({values:e},{context:a,logger:s}){return function(){const r=a.GetEffect();if(e[0]==="all"){for(const i of a.Party.GetMembers())r.Apply(i);s.logf("Effect %s applied to all members",r.Options.Name);return}for(const i of e){const c=a.Party.FindMember(i);if(!c){s.errorf("Cannot find target %s",i);return}r.Apply(c)?s.logf("Effect %s applied to target %s",r.Options.Name,c.GetCharacter().Options.Name):s.warnf("Effect %s NOT applied to target %s",r.Options.Name,c.GetCharacter().Options.Name)}}}},unapply:{name:"unapply",arguments:"characters...",description:"Unapplies the current effect from the given characters, or all",example:`effect apply HuTao
effect unapply HuTao Xingqiu
effect unapply all`,compile({values:e},{context:a,logger:s}){return function(){const r=a.GetEffect();if(e[0]==="all"){for(const i of a.Party.GetMembers())r.Unapply(i);s.logf("Effect %s unapplied from all members",r.Options.Name);return}for(const i of e){const c=a.Party.FindMember(i);if(!c){s.errorf("Cannot find target %s",i);return}r.Unapply(c)?s.logf("Effect %s unapplied from target %s",r.Options.Name,c.GetCharacter().Options.Name):s.warnf("Effect %s NOT unapplied from target %s",r.Options.Name,c.GetCharacter().Options.Name)}}}},lock:{name:"lock",arguments:"characters",description:`Locks the effect to prevent being modified by character stat changes.

This will disable all the effect observers for the provided character.

Note that enabling the effect again will re-activate all the observers again.`,example:`effect set HuTaoE
effect enable
effect lock HuTao
character level 1
// this code will lock the HP to ATK conversion of Hu Tao to prevent it from changing`,compile({values:[e]},{context:a,logger:s}){return function(){const r=a.GetEffect(),i=a.Party.FindMember(e);if(!i){s.errorf("Cannot find character %s in the party",e);return}r.Lock(i),s.logf("Effect %s locked for character %s. Note that enabling the effect again will re-activate all the observers again.",r.Options.Name,i.GetCharacter().Options.Name)}}},stacks:{name:"stacks",description:"Sets the current effect's stacks",example:"effect stacks 9",arguments:"stacks",compile({values:[e]},{context:a,logger:s}){const n=w(e);return function(){const i=a.GetEffect();i.SetStacks(n),s.logf("Effect stacks set to %f",i.GetStacks())}}},condition:{name:"condition",arguments:"conditions...",description:"Sets the current effect's condition (s)",example:`effect condition near
effect condition far
effect condition // this removes all conditions`,compile({values:e},{context:a,logger:s}){return function(){const r=a.GetEffect();r.SetConditions(...e);const i=r.GetConditions();s.logf("Effect conditions set to ["+"%s".repeat(i.length)+"]",...i)}}},aura:{name:"aura",arguments:"auras...",description:"Sets the current effect's applied aura (s), or all",example:`effect aura frozen
effect aura hydro electro
effect aura // this removes all auras
effect aura all // this applies all auras`,compile({values:e},{context:a,logger:s}){return function(){const r=a.GetEffect(),i=e.length>0&&e[0].match(/all/i)?t.aura.Values().filter(_=>_!==t.aura.NONE):e.map(_=>t.aura.Get(_.toUpperCase()));r.SetAuras(...i);const c=r.GetAuras().map(_=>t.aura.Name(_));s.logf("Effect auras set to ["+"%s".repeat(c.length)+"]",...c)}}},details:{name:"details",description:"Shows the registered modifiers of the current effect",compile(e,{context:a,logger:s}){return function(){const r=a.GetEffect();s.log(`
`+r.Register())}}}}),C1=()=>({show:{name:"show",description:"Shows all the enemies",compile(e,{context:a,logger:s}){return function(){const i=a.Party.GetMembers().map(c=>c.GetCharacter().GetEnemy());s.logf(`
`+T.Enemy(...i))}}},level:{name:"level",description:"Sets the level of all enemies",example:"enemy level 100",arguments:"level",compile({values:[e]},{context:a,logger:s}){const n=w(e);return function(){a.Party.GetMembers().forEach(i=>i.GetCharacter().GetEnemy().SetLevel(n)),s.logf("All enemy levels changed to %d",n)}}},aura:{name:"aura",arguments:"auras...",description:"Sets enemies applied aura (s), or all",example:`enemy aura frozen
enemy aura hydro electro
enemy aura // this removes all auras
enemy aura all // this applies all auras`,compile({values:e},{context:a,logger:s}){const n=e.length>0&&e[0].match(/all/i)?t.aura.Values().filter(r=>r!==t.aura.NONE):e.map(r=>t.aura.Get(r.toUpperCase()));return function(){a.Party.GetMembers().forEach(i=>i.GetCharacter().GetEnemy().SetAuras(...n)),s.logf("All enemy auras changed to %s",n.map(i=>t.aura.Name(i)).join(", "))}}}}),M1="https://enka.network";function Bc(e){return gt(this,null,function*(){try{return yield(yield fetch(bc(e))).json()}catch(a){console.error("[ENKA ERROR]",a)}})}function bc(e){return M1+"/api/uid/"+e}var Kc={};D(Kc,{ReadOnly:()=>i_});var g1={EQUIP_BRACER:t.piece.FLOWER,EQUIP_NECKLACE:t.piece.PLUME,EQUIP_SHOES:t.piece.SANDS,EQUIP_RING:t.piece.GOBLET,EQUIP_DRESS:t.piece.CIRCLET},G1={20848859:"BlackcliffSlasher",37147251:"SolarPearl",160493219:"DarkIronSword",197755235:"VortexVanquisher",231836963:"JadeCutter",310247243:"KagurasVerity",313300315:"SapwoodBlade",342097547:"CinnabarSpindle",346510395:"LuxuriousSeaLord",411685275:"CompoundBow",452357939:"Moonpiercer",479076483:"CoolSteel",481755219:"BlackcliffPole",540938627:"Predator",578575283:"CrescentPike",618786571:"Halberd",623534363:"FavoniusCodex",650049651:"WindblumeOde",656120259:"SharpshootersOath",680510411:"Whiteblind",688991243:"CalamityQueller",693354267:"MemoryOfDust",716252627:"LithicSpear",735056795:"FavoniusGreatsword",807607555:"SkywardAtlas",828711395:"AmosBow",850802171:"WhiteIronGreatsword",877751435:"RoyalGreatsword",902184579:"ForestRegalia",902264035:"AquilaFavonia",930640955:"TheBell",944332883:"SummitShaper",1012170803:"KagotsurubeIsshin",1021898539:"Slingshot",1072884907:"MappaMare",1075647299:"SongOfBrokenPines",1089950259:"SkywardPride",1154009435:"PrototypeStarglitter",1163263227:"TheWidsith",1148024603:"TheCatch",1240067179:"FavoniusWarbow",1321135667:"LionsRoar",1348687251:"HuntersPath",1388004931:"SkyriderSword",1390797107:"WhiteTassel",1406746947:"OtherworldlyStory",1437658243:"SerpentSpine",1455107995:"LostPrayer",1470442731:"MissiveWindspear",1479961579:"FerrousShadow",1600275315:"HaranGeppakuFutsu",1608953539:"HarbingerOfDawn",1675686363:"SacrificialGreatsword",1773425155:"SwordOfDescension",1860795787:"MouunsMoon",1890163363:"EverlastingMoonglow",1901973075:"PolarStar",1990641987:"SacrificialSword",1990820123:"AmenomaKageuchi",1991707099:"PrototypeRancour",1997709467:"JadeSpear",2006422931:"LithicBlade",2195665683:"SacrificialFragments",2267978875:"FruitOfFulfillment",2279290283:"MagicGuide",2324146259:"HakushinRing",2359799475:"Akuoumaru",2375993851:"RoyalLongsword",2400012995:"SacrificialBow",2417717595:"AlleyHunter",2425414923:"FadingTwilight",2474354867:"FavoniusSword",2491797315:"KitainCrossSpear",2521338131:"PrototypeAmber",2539208459:"OathswornEye",2556914683:"TheStringless",2587614459:"Frostbearer",2614170427:"SkyriderGreatsword",2664629131:"DragonsBane",2749853923:"FesteringDesire",2753539619:"SnowTombedStarsilver",2792766467:"TheUnforged",2832648187:"RoyalBow",2918525947:"ThunderingPulse",2935286715:"RoyalSpear",2947140987:"TheAlleyFlash",2949448555:"FreedomSworn",2963220587:"EmeraldOrb",3063191787:"EndOfTheLine",3073454867:"MakhairaAquamarine",3090373787:"WineAndSong",3097441915:"DebateClub",3112679155:"ElegyForTheEnd",3156385731:"EyeOfPerception",3169209451:"Rust",3176599083:"KingsSquire",3235324891:"StaffOfHoma",3273999011:"BlackcliffAgate",3378007475:"BlackcliffLongsword",3421967235:"FilletBlade",3439749859:"TheViridescentHunt",3443142923:"DragonspineSpear",3447737235:"BlackcliffWarbow",3456986819:"DodocoTales",3500935003:"ThrillingTalesOfDragonSlayers",3587621259:"TheFlute",3625393819:"PrototypeCrescent",3673792067:"TravelersHandySword",3684723963:"Rainslasher",3717849275:"EngulfingLightning",3719372715:"TwinNephrite",3722933411:"PrototypeArchaic",3755004051:"FavoniusLance",3796905611:"TheBlackSword",3827789435:"RoyalGrimoire",3914951691:"RedhornStonethresher",3933622347:"SkywardHarp",3949653579:"MitternachtsWaltz",3975746731:"RavenBow",3995710363:"WolfsGravestone",4049410651:"Deathmatch",4055003299:"SkywardBlade",4090429643:"BloodtaintedGreatsword",4103022435:"IronSting",4103766499:"BlackTassel",4122509083:"WavebreakerFin",4124851547:"MistsplitterReforged",4158505619:"SkywardSpine",4186179883:"Hamayumi",4193089947:"KatsuragikiriNagamasa",4230231107:"AquaSimulacra",4238339131:"StaffOfTheScarletSands",4267718859:"RecurveBow",302691299:"AmberBead",2834063555:"BeaconOfTheReedSea",316078811:"IbisPiercer",4007372867:"JadefallSplendor",454086795:"KeyOfKhajNisut",275622963:"LightOfFoliarIncision",1200948859:"MailedFlower",4139294531:"Messenger",1201790667:"ThousandFloatingDreams",2448629019:"ToukabouShigure",359484419:"TulaytullahsRemembrance",426363739:"WanderingEvenstar",143051931:"XiphosMoonlight",449192923:"BalladOfTheFjords",800766043:"FinaleOfTheDeep",1921306659:"FleuveCendreFerryman",2432865507:"FlowingPurity",4158971171:"RightfulReward",2275710883:"SacrificialJade",2958179435:"ScionOfTheBlazingSun",2600875323:"SongOfStillness",3459616011:"TalkingStick",2988480723:"TheFirstGreatMagic",2077869763:"TidalShadow",2265792579:"WolfFang",4176923379:"TomeOfTheEternalFlow",1473399443:"SplendorOfTranquilWaters"},R1={83115355:"MaidenBeloved",147298547:"WanderersTroupe",156294403:"HeartOfDepth",855894507:"Berserker",862591315:"PaleFlame",933076627:"BlizzardStrayer",1186209435:"Gambler",1212345779:"GladiatorsFinale",1337666507:"TenacityOfTheMillelith",1438974835:"RetracingBolide",1524173875:"CrimsonWitchOfFlames",1541919827:"BloodstainedChivalry",1558036915:"VermillionHereafter",1562601179:"ViridescentVenerer",1632377563:"Lavawalker",1675079283:"DeepwoodMemories",1751039235:"NoblesseOblige",1756609915:"OceanHuedClam",1873342283:"Thundersoother",2040573235:"ArchaicPetra",2276480763:"EmblemOfSeveredFate",2364208851:"ResolutionOfSojourner",2512309395:"ThunderingFury",2546254811:"HuskOfOpulentDreams",2764598579:"TheExile",2890909531:"MartialArtist",3535784755:"BraveHeart",3618167299:"Scholar",3626268211:"EchoesOfAnOffering",3890292467:"Instructor",4082302819:"DefendersWill",4144069251:"ShimenawasReminiscence",4145306051:"GildedDreams",3094139291:"FlowerOfParadiseLost",2538235187:"DesertPavilionChronicle",1925210475:"NymphsDream",235897163:"VourukashasGlow",3410220315:"GoldenTroupe",1249831867:"MarechausseeHunter"},Yc={FIGHT_PROP_BASE_ATTACK:t.stat.ATK_BASE,FIGHT_PROP_HP:t.stat.HP_FLAT,FIGHT_PROP_ATTACK:t.stat.ATK_FLAT,FIGHT_PROP_DEFENSE:t.stat.DEF_FLAT,FIGHT_PROP_HP_PERCENT:t.stat.HP_PERCENT,FIGHT_PROP_ATTACK_PERCENT:t.stat.ATK_PERCENT,FIGHT_PROP_DEFENSE_PERCENT:t.stat.DEF_PERCENT,FIGHT_PROP_CRITICAL:t.stat.CRIT_RATE,FIGHT_PROP_CRITICAL_HURT:t.stat.CRIT_DMG,FIGHT_PROP_CHARGE_EFFICIENCY:t.stat.ENERGY_RECHARGE,FIGHT_PROP_HEAL_ADD:t.stat.HEALING_BONUS,FIGHT_PROP_ELEMENT_MASTERY:t.stat.ELEMENTAL_MASTERY,FIGHT_PROP_PHYSICAL_ADD_HURT:t.stat.PHYSICAL_DMG,FIGHT_PROP_FIRE_ADD_HURT:t.stat.PYRO_DMG,FIGHT_PROP_ELEC_ADD_HURT:t.stat.ELECTRO_DMG,FIGHT_PROP_WATER_ADD_HURT:t.stat.HYDRO_DMG,FIGHT_PROP_WIND_ADD_HURT:t.stat.ANEMO_DMG,FIGHT_PROP_ICE_ADD_HURT:t.stat.CRYO_DMG,FIGHT_PROP_ROCK_ADD_HURT:t.stat.GEO_DMG,FIGHT_PROP_GRASS_ADD_HURT:t.stat.DENDRO_DMG},I1={10000002:"Ayaka",10000003:"Jean",10000006:"Lisa",10000014:"Barbara",10000015:"Kaeya",10000016:"Diluc",10000020:"Razor",10000021:"Amber",10000022:"Venti",10000023:"Xiangling",10000024:"Beidou",10000025:"Xingqiu",10000026:"Xiao",10000027:"Ningguang",10000029:"Klee",10000030:"Zhongli",10000031:"Fischl",10000032:"Bennett",10000033:"Tartaglia",10000034:"Noelle",10000035:"Qiqi",10000036:"Chongyun",10000037:"Ganyu",10000038:"Albedo",10000039:"Diona",10000041:"Mona",10000042:"Keqing",10000043:"Sucrose",10000044:"Xinyan",10000045:"Rosaria",10000046:"HuTao",10000047:"Kazuha",10000048:"Yanfei",10000049:"Yoimiya",10000050:"Thoma",10000051:"Eula",10000052:"Raiden",10000053:"Sayu",10000054:"Kokomi",10000055:"Gorou",10000056:"Sara",10000057:"Itto",10000058:"Yae",10000059:"Heizou",10000060:"Yelan",10000062:"Aloy",10000063:"Shenhe",10000064:"Yunjin",10000065:"Kuki",10000066:"Ayato",10000067:"Collei",10000068:"Dori",10000069:"Tighnari",10000070:"Nilou",10000071:"Cyno",10000079:"Dehya",10000072:"Candace",10000073:"Nahida",10000074:"Layla",10000075:"Wanderer",10000076:"Faruzan",10000078:"Alhaitham",10000080:"Mika",10000087:"Neuvillette",10000089:"Furina"};function Fc(e){const a=[];for(const s of e.avatarInfoList){const n=I1[s.avatarId];if(!n){console.error(`[ENKA ERROR] Cannot find character by avatarId ${s.avatarId}`);continue}const r=pt.FindByName(n);if(!r){console.error(`[ENKA ERROR] Cannot find character by name ${n}`);continue}const i=parseInt(s.propMap[4001].val)||1,c=parseInt(s.propMap[1002].val)||1,_=Object.values(s.skillLevelMap),u=r(),A=new Lt.Artbox(u);u.SetArtifacts(A);const S=u.GetCharacter();S.SetLevel(i),S.SetAscension(c),S.Set(t.stat.NORMAL_ATTACK_LEVEL,_[0]),S.Set(t.stat.ELEMENTAL_SKILL_LEVEL,_[1]),S.Set(t.stat.ELEMENTAL_BURST_LEVEL,_[2]);const h=s.equipList.filter(f=>f.flat.itemType==="ITEM_RELIQUARY"),m=s.equipList.filter(f=>f.flat.itemType==="ITEM_WEAPON");for(const f of h){const{reliquary:N,flat:L}=f;if(!N)continue;const{level:C}=N;if(!L.equipType){console.error("Cannot get artifact piece");continue}const d=g1[L.equipType];if(L.rankLevel<4){console.error("[ENKA ERROR] Cannot set 3-star artifacts");continue}const M=A.Get(d);if(M.SetStars(L.rankLevel),M.SetLevel(C-1),!L.reliquaryMainstat){console.error("[ENKA ERROR] Cannot get artifact mainstat");continue}M.SetMainstat(Yc[L.reliquaryMainstat.mainPropId]);const R=L.reliquarySubstats;if(!R){console.error("[ENKA ERROR] Cannot get artifact substats");continue}for(const y of R){const P=Yc[y.appendPropId];let B=y.statValue;t.FlatStats.includes(P)||(B/=100),M.AddSubstat(P,B)}const O=f.flat.setNameTextMapHash;if(O){const y=parseInt(O),P=R1[y];M.SetSet(P)}}A.GetArtifacts().forEach(f=>f.FillSubstats());for(const f of m){const N=parseInt(f.flat.nameTextMapHash),L=G1[N];if(!L){console.error("[ENKA ERROR] Cannot find weapon by key "+f.flat.nameTextMapHash);continue}const C=et.FindByName(L);if(!C){console.error("[ENKA ERROR] Cannot find weapon by name "+L);continue}u.SetWeapon(C);const d=u.GetWeapon();if(!d){console.error("[ENKA ERROR] Cannot equip weapon by name "+C.Name);continue}if(!f.weapon)continue;const{level:M,promoteLevel:R,affixMap:O}=f.weapon;d.SetLevel(M),d.SetAscension(R);const y=Object.values(O).reduce((P,B)=>Math.max(P,B),0)+1;d.SetRank(y)}a.push(u)}return a}function kc(e){return gt(this,null,function*(){const a=yield Bc(e);if(!a)throw new Error("[ENKA ERROR] Cannot fetch data from Enka.Network");return Fc(a)})}var O1=()=>{let e=[];return{uid:{name:"uid",description:"Imports characters from a player UID using Enka.Network service",example:"enka uid 609609619",arguments:"UID",compile({values:[a]},{logger:s}){return function(){s.log("Importing from Enka.Network service. Please wait..."),kc(a).then(r=>{e=r;const i=new T.Table(T.labels.CHARACTER,T.labels.LEVEL);for(const c of e){const _=c.GetCharacter();i.AddRow(_.Options.Name,_.GetLevel())}s.log(`
Imported characters:
`+i.String()),s.logf("Imported %d characters from Enka.Network",r.length),s.log("Run `enka load <characters...>` to load an imported character to the current party")}).catch(r=>s.error(String(r).valueOf()))}}},load:{name:"load",arguments:"characters...",description:"Loads characters imported from Enka.Network to the current party",example:"enka load hutao xingqiu yelan zhongli",compile({values:a},{context:s,logger:n}){return function(){const i=[];for(const c of a){const _=e.find(u=>u.GetCharacter().Options.Name.toLowerCase()===c);if(!_){n.errorf('Character "%s" not found in Enka',c);continue}s.Party.Add(_),i.push(_)}n.logf("Added %d characters to the party",i.length),i.length>0&&s.GetCompiler().compileString("character set "+i[0].GetCharacter().Options.Name,{line:n.line})()}}}}},D1=()=>({list:{name:"list",description:"Lists all the registered foods",compile(e,{logger:a}){const s=Bt.GetList(),n=T.Food(...s);return function(){a.log(`
`+n)}}},add:{name:"add",arguments:"name rank",description:"Adds a food to the party. Rank is the food quality (1 = suspicious, 2 = normal, 3 = delicious)",example:"food add adeptustemptation 3",compile({values:[e,a]},{context:s,logger:n}){const r=Bt.FindByName(e),i=Math.floor(w(a));if(!r)throw new Error("Cannot find food: "+e);return function(){s.Party.GetFoods().Add(r).SetRank(i),n.logf("Food %s added",r.Name)}}},remove:{name:"remove",description:"Removes a food from the party",arguments:"name",example:"food remove adeptustemptation",compile({values:[e]},{context:a,logger:s}){return function(){a.Party.GetFoods().Remove(e),s.logf("Food %s removed",e)}}},show:{name:"show",description:"Shows the currently added foods",compile(e,{context:a,logger:s}){return function(){const r=a.Party.GetFoods().GetAll();s.log(`
`+T.Food(...r))}}},clear:{name:"clear",description:"Clears all the foods from the party",compile(e,{context:a,logger:s}){return function(){a.Party.GetFoods().Clear(),s.log("Cleared all foods")}}}}),v1=()=>({clear:{name:"clear",description:"Clears all the rotation actions",compile(e,{context:a,logger:s}){return function(){a.Rotation.Clear(),s.log("Rotation cleared")}}},run:{name:"run",description:"Runs the rotation",compile(e,{context:a,logger:s}){return function(){s.warn("Running rotation..."),a.Rotation.SetCharacters(...a.Party.GetMembers());const r=a.Rotation.Run();s.logf("Rotation damage: %d",r)}}},log:{name:"log",description:"Controls rotation logs",children:{enable:{name:"enable",description:"Enables the rotation logs",compile(e,{context:a,logger:s}){return function(){a.Rotation.Log=s,s.log("Rotation log enabled")}}},disable:{name:"disable",description:"Disables the rotation logs",compile(e,{context:a,logger:s}){return function(){a.Rotation.Log=void 0,s.log("Rotation log disabled")}}}}},summary:{name:"summary",description:"Prints a summary of the last rotation run",compile(e,{context:a,logger:s}){return function(){s.log(`
`+T.Rotation(a.Rotation.GetSummary()))}}},hit:{name:"hit",arguments:"charname hitname [aura=] [reaction=] multipliers...",description:"Adds a hit to the rotation.",example:`rotation hit Hutao Charged *9 // 9 charged attacks from Hu Tao
rotation hit Hutao N1 aura=90% reaction=40% // hutao normal attack 1 with 90% aura and 40% reaction uptime`,docs:{charname:"the name of the character",hitname:"the name of the hit, without the prefix `hit_`",aura:"the aura uptime, where `0 <= x <= 1`",reaction:"the reaction uptime, where `0 <= x <= aura`",multipliers:"a multiplier in the form `*3`, `*0.5`, etc."},compile({values:[e,a,...s],named:n},{context:r,logger:i}){var c,_;a="HIT_"+a;let u=1;const A=w((c=n.aura)!=null?c:1),S=w((_=n.reaction)!=null?_:1);s.forEach(m=>{const f=m.match(y1);if(!f)return;const N=w(f[1]);u*=N});const h=i.line;return function(){r.Rotation.AddHit(e,a,u,S,A,h),i.logf("Added hit %s (%s) to rotation with multiplier=%.2f, aura=%.2f, reaction=%.2f",a,e,u,S,A)}}},do:{name:"do",arguments:"[*=] commands...",docs:{commands:"a list of commands to be executed as a rotation action"},description:"Saves a command to be executed as a rotation action.",example:"rotation do effect stacks 9",compile({parts:e},{context:a,logger:s}){const n=s.line,r=a.GetCompiler().compileString(e.join(" "),{line:n});return function(){a.Rotation.AddFn(r,n),s.logf("Added action to rotation: `%s`",e.join(" "))}}},duration:{name:"duration",arguments:"duration",description:"Sets the rotation duration, in seconds.",example:"rotation duration 22 // 22 seconds",compile({values:[e]},{context:a,logger:s}){const n=w(e);return function(){a.Rotation.Duration=n,s.logf("Rotation duration set to %.2f seconds.",n)}}}}),y1=/^\*([0-9]+(?:\.[0-9]+)?%?)$/i,Vc=()=>({substats:{tier:4}}),H1=class{constructor(){this.Party=new G.Party,this.Rotation=new ie.Rotation,this.Config=Vc()}Reset(){this.Party=new G.Party,this.Rotation=new ie.Rotation,this.Character=void 0,this.Effect=void 0,this.Config=Vc(),this.State=void 0}GetEffect(){if(!this.Effect)throw new Error("Effect not set");return this.Effect}SetEffect(e){this.Effect=e}GetChar(){if(!this.Character)throw new Error("Character not set");return this.Character}SetChar(e){if(e&&!this.Party.GetMembers().includes(e))throw new Error("Cannot set scenario character: character not in party");this.Character=e}SetCompiler(e){this.compiler=e}GetCompiler(){if(!this.compiler)throw new Error("Scenario compiler not set");return this.compiler}},P1=()=>({set:{name:"set",description:"Sets the value of a stat for a character or characters",arguments:"character stat value [exclude=]",docs:{character:"name of the character to set the stat for. Can be a comma-separated list of names., or the keyword 'all' to set the stat for all characters",stat:"name of the stat to set",value:"value to set the stat to. Can be a percentage like 10% or 0.1",exclude:"name of the characters to exclude from the set. Can be a comma-separated list of names."},compile({values:[e,a,s],named:{exclude:n}},{context:r,logger:i}){const c=t.stat.Get(a.toUpperCase()),_=w(s),u=e==="all",A=U(e,m=>m)[0];if(n==="all")throw new Error("exclude cannot be 'all'");const S=U(n||"",m=>m)[0];console.log(n,S);const h=A.filter(m=>!S.includes(m));return function(){const f=r.Party,L=(f?f.GetMembers():[r.GetChar()]).filter(d=>{const M=d.GetCharacter().Options.Name.toLowerCase();return u?!S.includes(M):h.includes(M)}),C=L.map(d=>d.GetCharacter().Options.Name);for(const d of L){const M=d.GetCharacter();if(c===t.stat.HP_CURRENT||c===t.stat.ENERGY_CURRENT)M.Set(c,_);else{const R=M.Get(c);d.AddModifier(M.CreateModifier(c,_-R))}}i.logf("Set stat %s=%.2f for %s",t.stat.Name(c),_,C.join(", "))}}},add:{name:"add",description:"Adds to the value of a stat for a character or characters",arguments:"character stat value [exclude=]",docs:{character:"name of the character to add the stat to. Can be a comma-separated list of names., or the keyword 'all' to add the stat to all characters",stat:"name of the stat to add",value:"value to add to the stat. Can be a percentage like 10% or 0.1",exclude:"name of the characters to exclude from the add. Can be a comma-separated list of names."},compile({values:[e,a,s],named:{exclude:n}},{context:r,logger:i}){const c=t.stat.Get(a.toUpperCase()),_=w(s),u=e==="all",A=U(e,m=>m)[0];if(n==="all")throw new Error("exclude cannot be 'all'");const S=U(n||"",m=>m)[0];console.log(n,S);const h=A.filter(m=>!S.includes(m));return function(){const f=r.GetChar().GetParty(),L=(f?f.GetMembers():[r.GetChar()]).filter(d=>{const M=d.GetCharacter().Options.Name.toLowerCase();return u?!S.includes(M):h.includes(M)}),C=L.map(d=>d.GetCharacter().Options.Name);for(const d of L){const M=d.GetCharacter();d.AddModifier(M.CreateModifier(c,_))}i.logf("Added stat %s+=%.2f for %s",t.stat.Name(c),_,C.join(", "))}}}}),w1=()=>({save:{name:"save",description:"Saves the current party state.",compile(e,{context:a,logger:s}){return function(){a.State=G.ExportParty(a.Party),s.log("State saved")}}},load:{name:"load",description:"Loads a previously saved party state.",compile(e,{context:a,logger:s}){return function(){if(!a.State){s.error("No state saved");return}a.Party=Yt.PartyFrom(a.State);const r=a.Party.GetMembers()[0],i=r?r.GetCharacter().Options.Name:void 0,c=s.line,_=a.GetCompiler();_.compileString("character unset",{line:c})(),_.compileString("effect unset",{line:c})(),i&&_.compileString("character set "+i,{line:c})(),s.log("Party loaded from saved state")}}},clear:{name:"clear",description:"Removes the saved state",compile(e,{context:a,logger:s}){return function(){a.State=void 0,s.log("State cleared")}}},b64:{name:"b64",description:"Exports/imports party state as base64 strings",children:{export:{name:"export",description:"Exports party state as a base64 string.",compile(e,{context:a,logger:s}){return function(){if(!a.State){s.error("No state saved");return}const r=btoa(JSON.stringify(a.State));s.log(r)}}},import:{name:"import",description:"Imports party state from a base64 string.",arguments:"base64string",compile({values:[e]},{context:a,logger:s}){const n=JSON.parse(atob(e)),r=s.line;return function(){a.State=n,a.GetCompiler().compileString("state load",{line:r})()}}}}}}),B1=()=>({list:{name:"list",description:"List all registered weapons",compile(e,{logger:a}){const s=pt.Bennett(),n=et.GetList(),r=new T.Table(T.labels.NAME,T.labels.WEAPON,t.stat.Name(t.stat.ATK_BASE),T.labels.STAT,T.labels.VALUE,T.labels.STARS);for(const c of n){const _=c(s);_.SetLevel(90),r.AddRow(c.Name,t.weapon.Name(c.Type),_.GetAtkBase(),t.stat.Name(_.GetSubstat()),_.GetSubstatValue(),c.Stars)}r.DecimalPlaces=4;const i=r.String();return function(){a.logf("Total weapons: %d",n.length),a.log(`
`+i)}}},set:{name:"set",description:"Sets the weapon of the current character",example:"weapon set StaffOfHoma",arguments:"name",compile({values:[e]},{context:a,logger:s}){const n=et.FindByName(e);if(!n)throw new Error("Cannot find weapon: "+e);return function(){a.GetChar().SetWeapon(n),s.logf("Weapon set to %s",n.Name)}}},level:{name:"level",description:"Sets the level of the current character's weapon",example:`weapon level 70
weapon level 80+ //level 80 ascended`,arguments:"level",compile({values:[e]},{context:a,logger:s}){let n=e;const r=e.endsWith("+");r&&(n=e.slice(0,n.length-1));const i=w(n),c=r?6:0;return function(){const u=a.GetChar().GetWeapon();if(!u){s.error("Character weapon is not set");return}u.SetLevel(i),u.SetAscension(c),s.logf("Weapon level set to %d%s",u.GetLevel(),u.IsAscended()?"+":"")}}},rank:{name:"rank",description:"Sets the rank of the current character's weapon",example:"weapon rank 5",arguments:"rank",compile({values:[e]},{context:a,logger:s}){const n=w(e);return function(){const i=a.GetChar().GetWeapon();if(!i){s.error("Character weapon is not set");return}i.SetRank(n),s.logf("Weapon rank set to %d",i.GetRank())}}},remove:{name:"remove",description:"Removes the character weapon",compile(e,{context:a,logger:s}){return function(){a.GetChar().SetWeapon(void 0),s.log("Weapon removed")}}}}),ia=class extends ra{constructor(){const e=new H1,a=new zt(e,lt(k({character:{name:"character",description:"Controls characters in the party",children:p1()},stat:{name:"stat",description:"Shortcut for `character stat` subcommands",children:P1()},weapon:{name:"weapon",description:"Controls weapons in the party",children:B1()},effect:{name:"effect",description:"Controls effects in the party",children:d1()},artifact:{name:"artifact",description:"Controls all the artifacts",children:h1()}},m1()),{enemy:{name:"enemy",description:"Controls all enemies in the party.",children:C1()},food:{name:"food",description:"Controls food buffs",children:D1()},rotation:{name:"rotation",description:"Controls the rotation",children:v1()},reset:{name:"reset",description:"Resets the scenario to its initial state",compile(s,{context:n,logger:r}){return function(){n.Reset(),r.warnf("Command `reset` executed.")}}},state:{name:"state",description:"Functions to save/load the party state",children:w1()},enka:{name:"enka",description:"Imports characters from Enka.Network service",children:O1()},echo:{name:"echo",arguments:"[*=] any...",description:"Prints the arguments to the console",compile({parts:s},{logger:n}){const r=s.join(" "),i=n.line;return function(){const _=n.line;n.setLine(i),n.logf(r),n.setLine(_)}}},void:{name:"void",arguments:"[*=] any...",description:"Does nothing, can be used to include expression blocks without printing the result",example:"void { 1 + 1 }",compile(){return function(){}}}}));super(a),this.Scenario=e,this.Scenario.SetCompiler(this)}},xc={};D(xc,{BackendWorker:()=>SN,Generate:()=>Wc,Optimizer:()=>mN,RotationDamage:()=>hN,SetGenerator:()=>Y1,VirtualWorker:()=>Uc});var b1=0,Uc=class{constructor(e){this.poster=e,this.listenersByPath=new Map,this.pathsByListener=new Map,this.errorListeners=[]}SetPoster(e){this.poster=e}SetKiller(e){this.killer=e}Kill(){if(!this.killer)throw new Error("No killer function is defined for this worker");this.killer()}Post(e,a){const s=(++b1).toString(36);return this.poster(e,s,a),s}Recieve(e,a,s){return gt(this,null,function*(){const n=this.listenersByPath.get(e);if(!n){console.error("WORKER PATH NOT FOUND: ",e);return}for(const r of[...n])yield r(a,s)})}Error(e){return gt(this,null,function*(){for(const a of[...this.errorListeners])yield a(e)})}AddErrorListener(e){if(this.errorListeners.includes(e))throw new Error("Cannot add the same listener twice");return this.errorListeners.push(e),e}RemoveErrorListener(e){const a=this.errorListeners.indexOf(e);return a===-1?!1:(this.errorListeners.splice(a,1),!0)}AddListener(e,a){if(this.pathsByListener.has(a))throw new Error("Cannot add the same listener twice");this.pathsByListener.set(a,e);let s=this.listenersByPath.get(e);return s||(s=[],this.listenersByPath.set(e,s)),s.push(a),a}RemoveListener(e){const a=this.pathsByListener.get(e);if(!a)return!1;const s=this.listenersByPath.get(a);if(!s)return!1;const n=s.indexOf(e);return n===-1?!1:(s.splice(n,1),!0)}};function*K1(e,a){let s=[];for(const n of a)s.push(n),s.length>=e&&(yield s,s=[]);s.length>0&&(yield s)}var la=void 0;function Y1(e){la=e}function Wc(){if(!la)throw new Error("No backend worker generator is defined");return la()}var oa=class{constructor(e){this.actions=e,this.listeners=[]}Post(e,a){const s=this.worker;if(!s)throw new Error("Worker not set for this action");s.Post(e,a)}SetWorker(e){this.worker&&this.RemoveWorker();for(const a in this.actions){const s=this.actions[a];e.AddListener(a,s),this.listeners.push(s)}this.worker=e}RemoveWorker(){if(!!this.worker)for(const e of this.listeners)this.worker.RemoveListener(e)}},ca=class{constructor(){this.worker=Wc()}Kill(){this.worker.Kill()}},jc={};D(jc,{Filter:()=>Ea});function Ea(e,...a){return a.every(s=>F1(e,s))}function F1(e,a){const s=e.Get(a.stat);return a.operator==="<="?s<=a.value:s>=a.value}function zc(e){const a={},s=[t.stat.LEVEL,t.stat.ASCENSION,t.stat.HP_CURRENT,t.stat.ENERGY_CURRENT,t.stat.NORMAL_ATTACK_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL];for(const n of e.GetMembers()){const r=n.GetCharacter(),c=r.Options.Name.toLowerCase()+"_";for(const _ of s){const u=c+t.stat.Name(_).toLowerCase();a[u]=r.Get(_).toString()}}return a}var Tt=class{constructor(){this.MAX_CHUNK_SIZE=1/0,this.MAX_CHILDREN=1/0,this.TRANSFORM=!1,this.total=0}SetConfig(e){this.config=e}SetTarget(e){this.target=e}SetParty(e){this.party=e}SetRotation(e){this.rotation=e}Init(e){this.config=e,this.runner=new ia;const a=this.runner.Scenario;e.Party&&(a.Party=Yt.PartyFrom(e.Party),this.party=a.Party),e.Cmd&&(this.runner.compileString(e.Cmd)(),this.rotation=a.Rotation,this.rotation.Log=void 0),e.Target&&(this.runner.compileString("character set "+e.Target)(),this.target=a.Character),this.init(e)}setTotal(e){this.total=e}GetTotal(){return this.total}GetConfig(){if(!this.config)throw new Error("Configuration not set for this optimizer. Try to run `.Init()` first");return this.config}GetParty(){if(!this.party)throw new Error("Party not set for this optimizer. Try to run `.Init()` first");return this.party}GetTarget(){if(!this.target)throw new Error("Target character not set for this optimizer. Try to run `.Init()` first");return this.target}GetRotation(){if(!this.rotation)throw new Error("Rotation not set for this optimizer. Try to run `.Init()` first");return this.rotation}GetRunner(){if(!this.runner)throw new Error("Runner not set for this optimizer. Try to run `.Init()` first");return this.runner}Run(){if(!this.rotation)throw new Error("Rotation not set for this optimizer. Try to run `.Init()` first");const e=G.ExportParty(this.GetParty());this.rotation.SetCharacters(...this.GetParty().GetMembers());const a=this.rotation.Run();return G.ImportParty(e,this.GetParty()),a}Optimize(){for(const e of this.Generate())this.Insert(this.Evaluate(e));return this.Get()}Transform(e){throw new Error("Method not implemented.")}RecieveMessage(e){}getConstants(){const e={};if(this.target&&(e.target_name=this.target.GetCharacter().Options.Name,e.target_element=t.stat.Name(this.target.GetCharacter().Options.Element),e.target_element_aura=t.aura.Name(t.DmgToAura(this.target.GetCharacter().Options.Element))),this.party){this.party.GetMembers().forEach((n,r)=>{const i=n.GetCharacter(),c="member_"+r;e[c+"_name"]=i.Options.Name,e[c+"_element"]=t.stat.Name(i.Options.Element),e[c+"_element_aura"]=t.aura.Name(t.DmgToAura(i.Options.Element))});const s=zc(this.party);Object.assign(e,s)}return e}},qc=5,Ft=class extends Tt{constructor(){super(...arguments),this.queue=new rt,this.initDamage=0}init(e){if(e.substats.length>qc)throw new Error(`Cannot optimize more than ${qc} substats at once. Requested ${e.substats.length} substats instead`);const a=this.GetTarget(),s=(()=>{const c=a.GetArtifacts();if(!c)throw new Error("Cannot optimize substats without artifacts");return c})();this.initDamage=this.Run();for(const c of s.GetArtifacts())c.SetStars(5),c.ClearSubstats();const n=e.substats.map(({stat:c})=>c),r=e.substats.map(({min:c})=>c),i=e.substats.map(({max:c})=>c);this.modifiers=n.map(c=>a.GetCharacter().CreateModifier(c,0)),this.generator=Mn(n.length,e.total,r,i)}*Generate(){if(!this.generator)throw new Error("No generator has been initialized");yield*this.generator}Evaluate(e){const{tier:a,filter:s}=this.GetConfig(),n=this.GetTarget();if(!this.modifiers)throw new Error("Optimizer initialized incorrectly (no modifiers created)");const r=this.modifiers;e.forEach((A,S)=>r[S].SetValue(A*o.GetSubstatValue(5,r[S].GetProp(),a)));const i=[],c=[];r.forEach(A=>{const S=A.GetProp();i.push(n.GetCharacter().Get(S)),c.push(S)});const _=[n.GetCharacter().Get(t.stat.ATK),n.GetCharacter().Get(t.stat.DEF),n.GetCharacter().Get(t.stat.HP)];if(s&&!Ea(n.GetCharacter(),...s))return{rolls:e,stats:i,optimized:c,damage:-1,relative:0,basic:_};const u=this.Run();return{rolls:e,stats:i,optimized:c,damage:u,relative:u/this.initDamage,basic:_}}Insert(e){e.damage>=0&&this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=this.GetConfig(),s=a.substats.map(({stat:r})=>t.stat.Name(r)),n=new Y(t.stat.Name(t.stat.ATK),t.stat.Name(t.stat.DEF),t.stat.Name(t.stat.HP),...s,T.labels.DAMAGE,T.labels.RELATIVE);for(const r of e){const i=[];r.stats.forEach((_,u)=>{const S=t.FlatStats.includes(a.substats[u].stat)?b(_,0):b(_*100,2)+"%";i.push(S+` (${r.rolls[u]})`)});const c=r.basic.map(_=>b(_,0));n.AddRow(...c,...i,b(r.damage,0),b(r.relative*100,2)+"%")}return n}EquipCmd(e){const a=this.GetConfig();let s=`artifact add
artifact fill
artifact stars 5
artifact rolls tier `+a.tier+`
`;return s+="artifact rolls equip "+e.rolls.map((n,r)=>({rolls:n,stat:a.substats[r].stat})).reduce((n,r)=>n+t.stat.Name(r.stat)+" "+r.rolls+" ",""),s}Clear(){var e;(e=this.modifiers)==null||e.forEach(a=>a.Disable())}},$c={};D($c,{SubstatsOptimizer:()=>Ft,defaultConfig:()=>Ta});var Ta=()=>({total:25,tier:o.SubstatTier.ROLL_AVG,substats:[{stat:t.stat.CRIT_RATE,min:0,max:10},{stat:t.stat.CRIT_DMG,min:0,max:12},{stat:t.stat.ATK_PERCENT,min:0,max:12},{stat:t.stat.ELEMENTAL_MASTERY,min:0,max:12}]}),Qc={[t.piece.FLOWER]:t.PieceToMainstats(t.piece.FLOWER),[t.piece.PLUME]:t.PieceToMainstats(t.piece.PLUME),[t.piece.SANDS]:t.PieceToMainstats(t.piece.SANDS),[t.piece.GOBLET]:t.PieceToMainstats(t.piece.GOBLET),[t.piece.CIRCLET]:t.PieceToMainstats(t.piece.CIRCLET)},Xc=class extends Tt{constructor(){super(...arguments),this.results=new rt,this.initDamage=0,this.allStats=Qc}init(e){if(e.mainstats)for(const n of t.piece.Values()){let r=e.mainstats[n];!r||(r=r.filter(i=>Qc[n].includes(i)),r.length!==0&&(this.allStats[n]=r))}const a=Object.values(this.allStats).map(n=>n.length).reduce((n,r)=>n*r,1);this.setTotal(a);const s=this.GetTarget();this.state=G.Export(s),this.initDamage=this.Run(),e.substats&&(this.subsOptimizer=new Ft,this.subsOptimizer.SetParty(this.GetParty()),this.subsOptimizer.SetTarget(this.GetTarget()),this.subsOptimizer.SetRotation(this.GetRotation()),this.subsOptimizer.Init(k({},e.substats)),this.subsCombinations=Array.from(this.subsOptimizer.Generate()),this.state=G.Export(s))}*Generate(){for(const e of this.allStats[t.piece.FLOWER])for(const a of this.allStats[t.piece.PLUME])for(const s of this.allStats[t.piece.SANDS])for(const n of this.allStats[t.piece.GOBLET])for(const r of this.allStats[t.piece.CIRCLET])yield[e,a,s,n,r]}Evaluate(e){const a=this.GetTarget(),s=a.GetArtifacts();if(!s)throw new Error("Target character has no artifacts to be optimized");for(let r=0;r<e.length;r++)s.Get(r).SetMainstat(e[r]);const n={damage:-1,mainstats:e,relative:0};if(this.subsOptimizer&&this.subsCombinations){const r=this.subsOptimizer;this.subsCombinations.forEach(_=>r.Insert(r.Evaluate(_)));const c=r.Get()[0];c&&(n.damage=c.damage,n.substats=c)}else n.damage=this.Run();return n.relative=n.damage/this.initDamage,this.state&&G.Import(this.state,a),n}Insert(e){e.damage>=0&&this.results.Push(e,e.damage)}Get(){return this.results.Extract()}Format(e){const a=this.GetConfig(),s=[t.piece.Name(t.piece.SANDS),t.piece.Name(t.piece.GOBLET),t.piece.Name(t.piece.CIRCLET)];if(a.substats){s.push(t.stat.Name(t.stat.ATK),t.stat.Name(t.stat.DEF),t.stat.Name(t.stat.HP));const r=a.substats.substats.map(i=>t.stat.Name(i.stat));s.push(...r)}s.push(T.labels.DAMAGE,T.labels.RELATIVE);const n=new Y(...s);for(const r of e){const i=r.mainstats.slice(2).map(c=>t.stat.Name(c));if(a.substats&&r.substats){const c=a.substats,_=r.substats,u=[];_.stats.forEach((S,h)=>{const f=t.FlatStats.includes(c.substats[h].stat)?b(S,0):b(S*100,2)+"%";u.push(f+` (${_.rolls[h]})`)});const A=_.basic.map(S=>b(S,0));i.push(...A,...u)}i.push(b(r.damage,0),b(r.relative*100,2)+"%"),n.AddRow(...i)}return n}EquipCmd(e){const a=this.GetConfig();let s=`artifact add
artifact fill
`;for(const n of[t.piece.SANDS,t.piece.GOBLET,t.piece.CIRCLET]){const r=t.piece.Name(n).toLowerCase(),i=t.stat.Name(e.mainstats[n]);s+=r+" main "+i+`
`}if(e.substats&&a.substats){const n=new Ft;n.SetConfig(a.substats),s+=n.EquipCmd(e.substats)}return s}},_a=Array.from(new Set([...t.Substats,...t.Elements,t.stat.HEALING_BONUS]).values()),Jc=class extends Tt{constructor(){super(...arguments),this.modifiers={},this.queue=new rt}init(){const e=this.GetTarget();_a.forEach(a=>this.modifiers[a]=e.GetCharacter().CreateModifier(a,0)),this.setTotal(_a.length)}*Generate(){for(const e of _a)yield e}Evaluate(e){const a=this.GetConfig(),s=o.GetSubstatValue(5,e,a.tier);if(!this.modifiers)throw new Error("No modifiers has been initialized. Try to run `.Init()` first.");const n=this.modifiers[e];n.SetValue(0);const r=this.Run();n.SetValue(s);const i=this.Run();return n.SetValue(0),{stat:e,damage:i,benefit:i/r-1}}Insert(e){this.queue.Push(e,e.benefit)}Get(){return this.queue.Extract()}Format(e){const a=this.GetConfig(),s=new T.Table(T.labels.STAT,T.labels.VALUE,T.labels.DAMAGE,T.labels.BENEFIT);for(const{stat:n,damage:r,benefit:i}of e){const c=t.FlatStats.includes(n)?b(o.GetSubstatValue(5,n,a.tier),0):b(o.GetSubstatValue(5,n,a.tier)*100,2);s.AddRow(t.stat.Name(n),c,b(r,2),b(i*100,4)+"%")}return s}};function*kt(...e){e.length===0&&(yield[]);function*a(s,n){for(const r of e[s]){const i=[...n,r];s===e.length-1?yield i:yield*a(s+1,i)}}yield*a(0,[])}function Zc(e,a){const s=e.map(i=>{const c=a==null?void 0:a.get(i.Name.toLowerCase());if(c)return[c];{const _=[...i.Conditions||[""]],u=new Set([0]);return u.add(i.MaxStacks||0),u.add(Math.floor((i.MaxStacks||0)/2)),Array.from(kt(_,Array.from(u))).map(([S,h])=>["effect condition "+S+`
effect stacks `+h])}});s.length===0&&s.push([]);const n=Array.from(kt(...s)),r=[];for(const i of n){const c={};i.forEach((_,u)=>{c[e[u].Name]=_}),r.push(c)}return r}var k1=/case([^:]*):/g;function ua(e){e=Le(e);const a=new Map,s=Array.from(e.matchAll(k1));s.forEach((r,i)=>{var c;const _=r[0],u=r[1];if(!_||!u)return;const A=u.split(/\s|,|;/).map(f=>f.trim()).filter(f=>!!f),S=(r.index||0)+_.length,h=((c=s[i+1])==null?void 0:c.index)||e.length,m=e.slice(0,S).replace(/[^\n]/g,"")+e.slice(S,h).trim()+e.slice(h,e.length).replace(/[^\n]/g,"");for(let f of A){f=f.toLowerCase();let N=a.get(f);N||a.set(f,N=[]),N.push(m)}});const n=a.get("all");if(n)for(const r of a.values())r.unshift(...n);return a}var Te=tt.GetList(),tE=class extends Tt{constructor(){super(...arguments),this.cases=new Map,this.combinations=[],this.initDamage=0,this.queue=new rt}init(e){this.Combinate(e),this.setTotal(this.combinations.length);const a=this.getConstants(),s=this.GetRunner();for(const i in a)s.constants.set(i,a[i]);this.initDamage=this.Run();const r=this.GetTarget().GetArtifacts();if(!r)throw new Error("Target character has no artifacts to be optimized");this.initState=r.GetArtifacts().map(i=>I.Export(i))}Combinate(e){e.ConfigCmd&&(this.cases=ua(e.ConfigCmd)),this.combinations=[];for(let a=0;a<Te.length;a++)for(let s=a;s<Te.length;s++){const n=[Te[a],Te[s]].sort((r,i)=>r.Stars-i.Stars);this.combinations.push(...this.createRows(n[0],n[1]))}}createRows(e,a){const s=(()=>e===a?[...e.Piece2,...e.Piece4]:[...e.Piece2,...a.Piece2])(),n=Zc(s,this.cases),r=[];for(const i of n){const c={sets:[e.Name,a.Name],cmds:i};r.push(c)}return r}*Generate(){for(const e of this.combinations)yield e}Evaluate(e){const a=this.GetRunner(),n=this.GetTarget().GetArtifacts();if(!n)throw new Error("Target character has no artifacts to be optimized");const[r,i]=e.sets,c=tt.FindByName(r),_=tt.FindByName(i);n.Get(0).SetSet(r),n.Get(1).SetSet(r),n.Get(2).SetSet(i),n.Get(3).SetSet(i);const u=new Set;c&&c.Stars===4&&(u.add(0),u.add(1)),_&&_.Stars===4&&(u.add(2),u.add(3));for(const h of u)I.transform.Downgrade(n.Get(h));const A={sets:[r,i],states:[],damage:0,relative:0};for(const h of n.GetEffects()){const m=h.Options.Name;a.Scenario.Effect=h;const f=e.cmds[m];if(!f)continue;let N="";for(const L of f){const C=a.compileString(L);C(),N+=C.String()+`
`}A.states.push({state:l.Export(h),cmd:"effect set "+m+`
`+N,effect:m})}const S=this.Run();if(A.damage=S,A.relative=S/this.initDamage,this.initState&&u.size>0){const h=this.initState;n.GetArtifacts().forEach((m,f)=>I.Import(h[f],m))}return A}Insert(e){this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=new T.Table(T.labels.SET,T.labels.SET,T.labels.STACKS,T.labels.CONDITION,T.labels.DAMAGE,T.labels.RELATIVE);for(const s of e){let[n,r]=s.sets;n===r?(n+=" (2)",r+=" (4)"):(n+=" (2)",r+=" (2)");const i=s.states.map(({state:_,effect:u})=>{const A=Ee.FindByName(u);return A&&(A.MaxStacks||0)>0?_.stacks+"":""}).filter(_=>!!_).join(", "),c=s.states.map(({state:_})=>[..._.conditions]).reduce((_,u)=>(u.forEach(A=>_.push(A)),_),[]).filter(_=>!!_).join(", ");a.AddRow(n,r,i,c,s.damage,b(s.relative*100,2)+"%")}return a}EquipCmd(e){let a=`artifact add
artifact sets `+e.sets.join(" ")+`
`;const[s,n]=e.sets,r=tt.FindByName(s),i=tt.FindByName(n),c=new Set;r&&r.Stars===4&&(c.add("flower"),c.add("plume")),i&&i.Stars===4&&(c.add("sands"),c.add("goblet"));for(const _ of c)a+=_+` downgrade
`;for(const{cmd:_}of e.states)a+=_+`

`;return a+="effect unset",a}},eE=class extends Tt{constructor(){super(...arguments),this.cases=new Map,this.combinations=[],this.initDamage=0,this.queue=new rt}init(e){this.Combinate(e),this.setTotal(this.combinations.length);const a=this.getConstants(),s=this.GetRunner();for(const n in a)s.constants.set(n,a[n]);this.initDamage=this.Run()}Combinate(e){var a;e.ConfigCmd&&(this.cases=ua(e.ConfigCmd));const s=(()=>e.All?et.GetList():et.GetByType(this.GetTarget().GetCharacter().Options.Weapon||0))();this.combinations=[];for(const n of s){const r=((a=e.Ranks)==null?void 0:a[n.Stars])||[1];if(n.Effects.length===0){for(const c of r)this.combinations.push({weapon:n.Name,cmds:{},cmd:`weapon level 90
weapon rank `+c});continue}const i=Zc(n.Effects,this.cases);for(const c of i)for(const _ of r){const u={weapon:n.Name,cmds:c,cmd:`weapon level 90
weapon rank `+_};this.combinations.push(u)}}}*Generate(){for(const e of this.combinations)yield e}Evaluate(e){var a;const s=this.GetRunner(),n=this.GetTarget();s.Scenario.Character=n,(a=n.GetWeapon())==null||a.Unequip();const r=et.FindByName(e.weapon);if(!r)throw new Error("Cannot find weapon: "+e.weapon);n.SetWeapon(r);const i=n.GetWeapon();if(!i)throw new Error("Cannot equip the weapon: "+e.weapon);const c=s.compileString(e.cmd);c();const _={weapon:i.Options.Name,states:[],damage:0,relative:0,cmd:c.String(),rank:i.GetRank()};for(const A of i.GetEffects()){const S=A.Options.Name;s.Scenario.Effect=A;const h=e.cmds[S];if(!h)continue;let m="";for(const f of h){const N=s.compileString(f);N(),m+=N.String()+`
`}_.states.push({state:l.Export(A),cmd:"effect set "+S+`
`+m,effect:S})}const u=this.Run();return _.damage=u,_.relative=u/this.initDamage,_}Insert(e){this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=new Y(T.labels.WEAPON,T.labels.STACKS,T.labels.CONDITION,T.labels.DAMAGE,T.labels.RELATIVE);for(const s of e){const n=s.states.map(({state:i,effect:c})=>{const _=Ee.FindByName(c);return _&&(_.MaxStacks||0)>0?i.stacks+"":""}).filter(i=>!!i).join(", "),r=s.states.map(({state:i})=>[...i.conditions]).reduce((i,c)=>(c.forEach(_=>i.push(_)),i),[]).filter(i=>!!i).join(", ");a.AddRow(s.weapon+` (R${s.rank})`,n,r,s.damage,b(s.relative*100,2)+"%")}return a}EquipCmd(e){let a="weapon set "+e.weapon+`
`+e.cmd+`
`;for(const{cmd:s}of e.states)a+=s+`

`;return a+="effect unset",a}};function V1(e,a){if(e.allowSetNumber){const s=e.allowSetNumber;if(a.length===0&&!s.includes(0)||!a.map(([,r])=>r).some(r=>s.includes(r)))return!1}if(e.allowOnly){const s=e.allowOnly.map(r=>r.toLowerCase());if(!a.map(r=>r[0].toLowerCase()).every(r=>s.includes(r)))return!1}return!0}var x1=[...t.Mainstats,...t.Substats],aE=class extends Tt{constructor(){super(...arguments),this.compiled=new Map,this.groups=[],this.mods=new Map,this.initDamage=0,this.initSets=[],this.queue=new rt(5),this.prevSets="",this.equipCmd=""}init(e){var a,s;e.artifacts=[...e.artifacts];const n=ua(e.ConfigCmd||""),r=this.GetRunner(),i=this.getConstants();for(const _ in i)r.constants.set(_,i[_]);for(const[_,u]of n){const A="effect set "+_+`
`+u.join(`
`)+`
effect unset`,S=r.compileString(A);this.compiled.set(_,S)}for(const _ of t.piece.Values())this.groups[_]=[];if(e.artifacts.forEach((_,u)=>this.groups[_.piece].push([u,_])),this.target){this.initDamage=this.Run();let _=(a=this.target.GetArtifacts())==null?void 0:a.GetArtifacts();_||(this.target.SetArtifacts(new Lt.Artbox(this.target)),_=(s=this.target.GetArtifacts())==null?void 0:s.GetArtifacts());const u=[];_&&_.forEach(A=>{this.groups[A.GetPiece()].length>0&&A.Disable(),u[A.GetPiece()]=A.GetSet()}),this.initSets=u;for(const A of x1)this.mods.set(A,this.target.GetCharacter().CreateModifier(A,0))}for(const _ of t.piece.Values())this.groups[_].length||this.groups[_].push([-1,void 0]);let c=1;for(const _ of Object.values(this.groups))_.sort((u,A)=>{var S,h;return(((S=u[1])==null?void 0:S.set)||"").localeCompare(((h=A[1])==null?void 0:h.set)||"")}),c*=_.length;this.setTotal(c)}*Generate(){for(let e=0;e<this.groups[t.piece.FLOWER].length;e++)for(let a=0;a<this.groups[t.piece.PLUME].length;a++)for(let s=0;s<this.groups[t.piece.SANDS].length;s++)for(let n=0;n<this.groups[t.piece.GOBLET].length;n++)for(let r=0;r<this.groups[t.piece.CIRCLET].length;r++)yield this.Combinate([e,a,s,n,r])}Combinate(e){const a=this.GetConfig(),s=t.piece.Values().map(A=>this.groups[A][e[A]]),n=s.map(([,A])=>A),r=s.map(([A])=>A),i=[...this.initSets];for(const A of n)!A||(i[A.piece]=A.set);const[c,_]=qe(i);if(!V1(a,c))return;const u=[];for(const A of n){if(!A)continue;const S=A,h=o.GetMainstatValue(S.stars,S.mainstat,S.level),m=u.find(f=>f.stat===S.mainstat);m?m.value+=h:u.push({stat:S.mainstat,value:h});for(const{stat:f,value:N}of S.substats){const L=u.find(C=>C.stat===f);L?L.value+=N:u.push({stat:f,value:N})}}return{indexes:r,sets:_,stats:u}}configSets(e,a){const s=a.join(";");if(s!==this.prevSets){this.equipCmd="",e.Get(0).SetSet(a[0]),e.Get(1).SetSet(a[0]),e.Get(2).SetSet(a[1]),e.Get(3).SetSet(a[1]),e.Get(4).SetSet(void 0);for(const n of e.GetEffects()){const r=this.compiled.get(n.Options.Name.toLowerCase());r&&(r(),this.equipCmd+=r.toString()+`
`)}this.prevSets=s}}Evaluate(e){if(!e)return;const a=this.GetTarget(),s=a.GetArtifacts(),{filter:n}=this.GetConfig();if(!s)throw new Error("Target has no artifacts to be optimized. Try to run `.Init()` first");for(const{stat:c,value:_}of e.stats){const u=this.mods.get(c);if(!u)throw new Error("Modifier not initialized for stat "+c+". Try to run `.Init()` first");u.SetValue(_)}if(this.configSets(s,e.sets),n&&!Ea(a.GetCharacter(),...n))return;const r=this.Run(),i=r/this.initDamage;for(const{stat:c}of e.stats){const _=this.mods.get(c);if(!_)throw new Error("Modifier not initialized for stat "+c+". Try to run `.Init()` first");_.SetValue(0)}return{indexes:e.indexes,sets:e.sets,cmd:this.equipCmd,damage:r,relative:i}}Insert(e){e&&e.damage>0&&this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(){throw new Error("Method not implemented.")}GetArtifacts({indexes:e}){const{artifacts:a}=this.GetConfig();return e.filter(s=>s>=0).map(s=>a[s])}},sE={};D(sE,{FoodOptimizer:()=>nE});var nE=class extends Tt{constructor(){super(...arguments),this.initDamage=0,this.queue=new rt,this.groups=[]}init(){this.initDamage=this.Run();for(const e of[Ot.FoodType.OFFENSIVE,Ot.FoodType.ELEMENTAL,Ot.FoodType.DEFENSIVE]){const a=Bt.GetByType(e);this.groups.push(a.map(s=>s.Name))}this.setTotal(this.groups.reduce((e,a)=>e*a.length,1))}Generate(){return kt(...this.groups)}Evaluate(e){const a=this.GetRunner(),s=e.map(r=>"food add "+r+" 3").join(`
`);a.compileString(s)();const n=this.Run();return{foods:e,cmd:s,damage:n,relative:n/this.initDamage}}Insert(e){this.queue.Push(e,e.damage)}Get(){return this.queue.Extract()}Format(e){const a=new Y("FOOD_TYPE_0","FOOD_TYPE_3","FOOD_TYPE_1","DAMAGE","RELATIVE");for(const s of e)a.AddRow(...s.foods,b(s.damage,0),b(s.relative*100,2)+"%");return a}};function*rE(e){const a=Object.keys(e),s=a.map(r=>e[r]),n=kt(...s);for(const r of n){const i={};for(let c=0;c<a.length;c++){const _=a[c],u=r[c];i[_]=u}yield i}}function iE(e){let a=1;const s=Object.keys(e);for(const n of s)a*=e[n].length;return a}var _e=class{constructor(){this.weapons=[],this.artifacts=[]}addWeapon(e){this.weapons.push(e)}getWeapons(){return this.weapons.length>0?this.weapons:[{empty:[!0],name:[""],rank:[0]}]}addArtifacts(e){this.artifacts.push(e)}getArtifacts(){return this.artifacts.length>0?this.artifacts:[{empty:[!0],sands:[0],goblet:[0],circlet:[0]}]}*generate(){const e=kt(this.getWeapons(),this.getArtifacts());for(const a of e){const s=rE(a[0]);for(const n of s){const r=rE(a[1]);for(const i of r)yield{weapon:n,artifact:i}}}}get(){return{weapon:this.weapons,artifact:this.artifacts}}clear(){this.weapons=[],this.artifacts=[]}static*Generate(...e){const a=new _e;for(const s of e){for(const n of s.weapon)a.addWeapon(n);for(const n of s.artifact)a.addArtifacts(n);yield*a.generate(),a.clear()}}static Count(...e){let a=0;for(const s of e){const n=s.weapon.map(i=>iE(i)).reduce((i,c)=>i+c,0),r=s.artifact.map(i=>iE(i)).reduce((i,c)=>i+c,0);a+=n*r}return a}};function U1(e){let a="";return e.weapon.empty||(a+=W1(e.weapon)+`
`),e.artifact.empty||(a+=j1(e.artifact)),a}function W1(e){const a=et.FindByName(e.name);if(!a)throw new Error(`Weapon ${e.name} not found`);const s=[`weapon set ${e.name}`,`weapon rank ${e.rank}`,"weapon level 90"];for(const n of a.Effects)s.push("effect unset",`effect set ${n.Name}`),s.push(lE(e,n.ApplyOther)),s.push("effect unset");return s.join(`
`)}function j1(e){const a=["artifact add","artifact main "+[e.sands,e.goblet,e.circlet].map(s=>t.stat.Name(s)).join(" "),"artifact stars 5","artifact level 20"];if(e.set&&(a.push("artifact sets "+e.set.join(" ")),e.set[0]===e.set[1])){const s=tt.FindByName(e.set[0]);if(!s)throw new Error(`Set ${e.set[0]} not found`);for(const n of s.Piece4)a.push("effect unset",`effect set ${n.Name}`),a.push(lE(e,n.ApplyOther)),a.push("effect unset")}return a.join(`
`)}function lE(e,a){const s=[];return Number.isFinite(e.stacks)&&s.push(`effect stacks ${e.stacks}`),e.condition&&s.push(`effect condition ${e.condition.join(" ")}`),e.aura&&s.push(`effect aura ${e.aura.join(" ")}`),e.target&&a&&s.push("effect unapply all",`effect apply ${e.target.join(" ")}`),s.join(`
`)}function oE(e){const{list:a,query:s,count:n=1,threshold:r=.5,substring:i=!0}=e,c=new rt(n);for(const _ of a){if(i&&_.includes(s)){const A=_.length/s.length;c.Push(_,A);continue}const u=Qa.stringSimilarity(s,_);u>=r&&c.Push(_,u)}return c.Extract()}var J=new Map;t.stat.Values().forEach(e=>{const a=t.stat.Name(e).toLowerCase();J.set(a,e)}),J.set("hp",t.stat.HP_FLAT),J.set("hp%",t.stat.HP_PERCENT),J.set("atk",t.stat.ATK_FLAT),J.set("atk%",t.stat.ATK_PERCENT),J.set("def",t.stat.DEF_FLAT),J.set("def%",t.stat.DEF_PERCENT),J.set("er",t.stat.ENERGY_RECHARGE),J.set("em",t.stat.ELEMENTAL_MASTERY),J.set("cr",t.stat.CRIT_RATE),J.set("cd",t.stat.CRIT_DMG),J.set("cdmg",t.stat.CRIT_DMG),t.Elements.forEach(e=>{const a=t.stat.Name(e).toLowerCase().replace(/_?dmg/ig,"");J.set(a,e)}),Array.from(J.keys());function Vt(e){return J.get(e)}function cE(e){var a,s,n,r;const i=U((a=e.stacks)!=null?a:"0",A=>parseInt(A))[0],c=U((s=e.condition)!=null?s:"",A=>A),_=U((n=e.aura)!=null?n:"",A=>A),u=U((r=e.target)!=null?r:"",A=>A);return{stacks:i,condition:c,aura:_,target:u}}var z1=tt.GetList().map(e=>e.Name.toLowerCase());function q1(e){var a,s,n,r;const i=U((a=e.sands)!=null?a:"",S=>S)[0].map(S=>{const h=Vt(S);if(!h)throw new Error(`Main stat "${S}" not found`);return h}),c=U((s=e.goblet)!=null?s:"",S=>S)[0].map(S=>{const h=Vt(S);if(!h)throw new Error(`Main stat "${S}" not found`);return h}),_=U((n=e.circlet)!=null?n:"",S=>S)[0].map(S=>{const h=Vt(S);if(!h)throw new Error(`Main stat "${S}" not found`);return h}),u=k({sands:i,goblet:c,circlet:_},cE(e)),A=U((r=e.set)!=null?r:"",S=>S)[0].map(S=>X1(S));return e.set&&(u.set=A),u}var $1=/^([a-z]+)\+([a-z]+)$/i,Q1=/^([a-z]+)\*(4|2)$/i;function X1(e){let a=e.match($1);if(a){const[,s,n]=a;return[ue(s),ue(n)]}if(a=e.match(Q1),a){const[,s,n]=a,r=[];for(let i=0;i<parseInt(n)/2;i++)r.push(ue(s));return r}return[ue(e)]}function ue(e){const a=oE({list:z1,query:e,count:1,threshold:.2});if(a.length===0)throw new Error(`Set name "${e}" not found`);return a[0]}var J1=class{constructor(){this.Value=Ta(),this.Enabled=!1}Apply(e){return this.Enabled?e.substats=[k({},this.Value)]:delete e.substats,this.Enabled}DefaultRange(){const e=new Y(v.STAT,v.MIN,v.MAX);this.Value=Ta();for(const{stat:a,min:s,max:n}of this.Value.substats){const r=t.stat.Name(a);e.AddRow(r,s,n)}return`Total: ${this.Value.total}
Tier: ${this.Value.tier}
`+e.toString()}ParseRange(e){const a=new Y(v.STAT,v.MIN,v.MAX),s=[];for(const n in e){const r=U(e[n],A=>A)[0],i=Vt(n);if(!i)throw new Error(`Substat "${n}" not found`);let c=1/0,_=0;r.forEach(A=>{const S=w(A);S<c&&(c=S),S>_&&(_=S)}),s.push({stat:i,min:c,max:_});const u=t.stat.Name(i);a.AddRow(u,c,_)}return this.Value.substats=s,a+""}ParseMin(e){const a=new Y(v.STAT,v.MIN),s=[];for(const n in e){const r=U(e[n],_=>_)[0],i=Vt(n);if(!i)throw new Error(`Substat "${n}" not found`);if(r.length!==1)throw new Error(`Substat "${n}" min must be a single value`);const c=w(r[0]);s.push({stat:i,value:c,operator:">="}),a.AddRow(t.stat.Name(i),c)}return this.Value.filter=s,a}Cmd(){return{enable:{name:"enable",description:"Enables substat optimization. When enabled, substats currently in artifacts will be removed, and replaced with an optimal combination of substats based on the ranges defined.",compile:(e,{logger:a})=>()=>{a.log("Substat optimization enabled"),this.Enabled=!0}},disable:{name:"disable",description:"Disables substat optimization. When disabled, substats currently in artifacts will be kept.",compile:(e,{logger:a})=>()=>{this.Enabled=!1,a.log("Substat optimization disabled")}},total:{name:"total",description:"Sets the total substat rolls to optimize. Values must be between 0 and 45.",arguments:"total",example:"substats total 25 // optimize for 25 substat rolls",compile:({values:[e]},{logger:a})=>{const s=parseInt(e);if(isNaN(s)||s<0||s>45)throw new Error("Total must be between 0 and 45");return()=>{this.Value.total=s,a.log(`Substat optimization total set to ${s}`),this.Enabled=!0,a.log("Substat optimization enabled")}}},tier:{name:"tier",description:`Sets the tier of substat rolls to optimize. 
`,arguments:"tier",docs:{tier:"a number from 0 to 4, where 0 is the lowest tier and 3 is the highest tier.Also, the number 4 or the word `avg` can be used to set the tier to the average."},example:`substats tier 3 // optimize max-rolls
substats tier avg // optimize average rolls`,compile:({values:[e]},{logger:a})=>{let s,n;return e==="avg"||e==="4"?(s=4,n="AVERAGE"):(s=Math.max(0,Math.min(4,Math.floor(w(e)))),n=s+""),()=>{this.Value.tier=s,a.logf("Substat optimization tier set to %s",n),this.Enabled=!0,a.log("Substat optimization enabled")}}},range:{name:"range",arguments:"[stat*=min:max]",description:`Defines the range of substats to be used in optimization in the form:

\`range <stat>=<min>:<max> [stat2=<min>:<max> ...]\`

When executed, the substats optimization will be enabled.`,example:"substats range atk=2:12 cr=2:10 cd=2:12 em=2:12 // standard range",compile:({named:e},{logger:a})=>()=>{const s=this.ParseRange(e);a.log("Substat optimization ranges:"),a.log(`
`+s.toString()),this.Enabled=!0,a.log("Substat optimization enabled")}},min:{name:"min",arguments:"[stat*=min]",description:`Adds a minimum value for a substat in the form:

\`min <stat>=<min> [stat2=<min> ...]\`

When executed, the substats optimization will be enabled.`,compile:({named:e},{logger:a})=>()=>{const s=this.ParseMin(e);a.log("Substat optimization minimums:"),a.log(`
`+s.toString()),this.Enabled=!0,a.log("Substat optimization enabled")}},default:{name:"default",description:"Resets the substat ranges to the default values.",compile:(e,{logger:a})=>()=>{const s=this.DefaultRange();a.log(`Substat optimization ranges reset to default:
`+s),this.Enabled=!0,a.log("Substat optimization enabled")}}}}},Z1=class{constructor(e){const a=Number.isFinite(e)?et.GetByType(e):et.GetList();this.namesAll=a.map(s=>s.Name.toLowerCase()),this.names4=a.filter(s=>s.Stars===4).map(s=>s.Name.toLowerCase()),this.names5=a.filter(s=>s.Stars===5).map(s=>s.Name.toLowerCase())}Parse(e,a){var s;const n=this.parseName(e),r=U((s=a.rank)!=null?s:"1",i=>parseInt(i))[0];return k({name:n,rank:r},cE(a))}parseName(e){if(e==="all")return this.namesAll;if(e==="4*")return this.names4;if(e==="5*")return this.names5;const a=oE({list:this.namesAll,query:e,count:1,threshold:.4});if(a.length===0)throw new Error(`Weapon name "${e}" not found`);return a}},EE=class extends ra{constructor(e){super({}),this.combinator=new _e,this.groups=[],this.Substats=new J1,this.catch=!1;const a=new Z1(e),s=new zt(this.combinator,{add:{name:"add",description:"Saves the current combinations group and starts a new one.",compile:(n,{logger:r})=>()=>{this.groups.push(this.combinator.get()),this.combinator.clear(),r.log("Combination group saved")}},weapon:{name:"weapon",arguments:"name [rank=] [stacks=] [condition=] [aura=] [target=]",docs:{name:"The weapon name can be a partial or similar name, and can be `all`, `4*`, or `5*`.",rank:"Weapon rank, can be a list or range, e.g.:\n- `rank=1,2,3` will use ranks 1, 2, and 3.\n- `rank=1:3` will use ranks 1, 2, and 3.\n- `rank=1:5:2` will use ranks 1, 3, and 5.\n",stacks:"Weapon stacks, can be a list or range, e.g:\n- `stacks=0,1,2` will use stacks 0, 1, and 2.\n- `stacks=0:2` will use stacks 0, 1, and 2.\n- `stacks=0:7:2` will use stacks 0, 2, 4, and 6.\nIf the weapon has multiple effects, you can define stack ranges for each effect, e.g.:\n- `stacks=0:2;0:1` will use stacks 0, 1, and 2 for the first effect, and stacks 0 and 1 for the second effect.\n",condition:"Weapon condition, can be a list, e.g.:\n- `condition=on_field,of_field` will use the condition `on_field` and `of_field`.\nIf the weapon has multiple effects, you can define conditions for each effect, e.g.:\n- `condition=on_field,of_field;on_field` will use the condition `on_field` and `of_field` for the first effect,and `on_field` for the second effect.\n",aura:"Weapon aura, can be a list, e.g.:\n- `aura=pyro,hydro` will use the aura `pyro` and `hydro`.\nIf the weapon has multiple effects, you can define auras for each effect, e.g.:\n- `aura=pyro,hydro;pyro` will use the aura `pyro` and `hydro` for the first effect,and `pyro` for the second effect.\n",target:"Weapon targets, can be a list, e.g.:\n- `target=mona,keqing` will use the target `mona` and `keqing`.\nIf the weapon has multiple effects, you can define targets for each effect, e.g.:\n- `target=mona,keqing;mona` will use the target `mona` and `keqing` for the first effect,and `mona` for the second effect.\n"},description:"Adds weapons to be combined",example:`weapon all // all weapons
weapon 4* // all 4* weapons
weapon jadespear rank=1,5 stacks=0:7 // Jade Spear, rank 1 or 5, all stacks
weapon thrillingtales rank=5 target=mona // Thrilling Tales, rank 5, apply to Mona
`,compile:({values:[n],named:r},{logger:i})=>{const c=a.Parse(n,r);return()=>{var _,u,A,S,h,m,f;this.combinator.addWeapon(c),i.logf(`
Added weapons: %s
  Rank: %s
  Stacks: %s
  Condition: %s
  Aura: %s
  Target: %s
`,c.name.join(", "),c.rank.join(", "),(_=c.stacks)==null?void 0:_.join(", "),(A=(u=c.condition)==null?void 0:u.join(", "))!=null?A:"",(h=(S=c.aura)==null?void 0:S.join(", "))!=null?h:"",(f=(m=c.target)==null?void 0:m.join(", "))!=null?f:"")}}},artifact:{name:"artifact",arguments:"sands= goblet= circlet= [set=] [stacks=] [condition=] [aura=] [target=]",docs:{sands:"Main stats for sands, can be a short name",goblet:"Main stats for goblet, can be a short name",circlet:"Main stats for circlet, can be a short name",set:"Artifact sets, can be the exact name or a partial name, in the form:\n- `set=SetName*2` will use the set `SetName` with 2 pieces.\n- `set=SetName*4` will use the set `SetName` with 4 pieces.\n- `set=SetName+OtherSet` will use the 2+2 combination of `SetName` and `OtherSet`.\nYou can also include lists of sets to combine, e.g.:\n- `set=SetA+SetB,SetC*4` two combinations: 2+2 of `SetA` and `SetB`, and 4 of `SetC`.\n",stacks:"Artifact set stacks, can be a list or range, e.g:\n- `stacks=0,1,2` will use stacks 0, 1, and 2.\n- `stacks=0:2` will use stacks 0, 1, and 2.\n- `stacks=0:7:2` will use stacks 0, 2, 4, and 6.\nIf the set has multiple effects, you can define stack ranges for each effect, e.g.:\n- `stacks=0:2;0:1` will use stacks 0, 1, and 2 for the first effect, and stacks 0 and 1 for the second effect.\n",condition:"Artifact set condition, can be a list, e.g.:\n- `condition=on_field,of_field` will use the condition `on_field` and `of_field`.\nIf the set has multiple effects, you can define conditions for each effect, e.g.:\n- `condition=on_field,of_field;on_field` will use the condition `on_field` and `of_field` for the first effect,and `on_field` for the second effect.\n",aura:"Artifact set aura, can be a list, e.g.:\n- `aura=pyro,hydro` will use the aura `pyro` and `hydro`.\nIf the set has multiple effects, you can define auras for each effect, e.g.:\n- `aura=pyro,hydro;pyro` will use the aura `pyro` and `hydro` for the first effect,and `pyro` for the second effect.\n",target:"Artifact set targets, can be a list, e.g.:\n- `target=mona,keqing` will use the target `mona` and `keqing`.\nIf the set has multiple effects, you can define targets for each effect, e.g.:\n- `target=mona,keqing;mona` will use the target `mona` and `keqing` for the first effect,and `mona` for the second effect.\n"},description:"Adds artifacts to be combined",example:`// compare 4pc Crimson Witch and Emblem of Severed Fate,
// with ATK% vs EM sands, Pyro goblet, and CR vs CD circlet
artifact sands=atk%,em goblet=pyro circlet=cr,cd set=crimson*4,emblem*4`,compile:({named:n},{logger:r})=>{const i=q1(n);return()=>{var c,_,u,A,S,h,m;const f=k({},i),N=this.Substats.Apply(f);this.combinator.addArtifacts(f),r.logf(`
Added artifacts:
  Sands: %s
  Goblet: %s
  Circlet: %s
  Stacks: %s
  Condition: %s
  Aura: %s
  Target: %s
`,f.sands.map(L=>t.stat.Name(L)).join(", "),f.goblet.map(L=>t.stat.Name(L)).join(", "),f.circlet.map(L=>t.stat.Name(L)).join(", "),(c=f.stacks)==null?void 0:c.join(", "),(u=(_=f.condition)==null?void 0:_.join(", "))!=null?u:"",(S=(A=f.aura)==null?void 0:A.join(", "))!=null?S:"",(m=(h=f.target)==null?void 0:h.join(", "))!=null?m:""),N&&r.log("Applied substats optimization to artifacts")}}},substats:{name:"substats",description:"Configures substats to optimize for the next combination group. By default, substats are not optimized and current artifacts will be used.",children:this.Substats.Cmd()}});this.setProgram(s)}Groups(){return this.groups}};function tN(e){const a=new Set,s=new Map;for(const{substats:i}of e)if(!!(i!=null&&i.optimized))for(const c of i.optimized)a.add(c);const n=[...a].map((i,c)=>(s.set(i,c),t.stat.Name(i))),r=new Y("WEAPON","STACKS","CONDITION","AURA","SANDS","GOBLET","CIRCLET","SET","STACKS","CONDITION","AURA","ATK","DEF","HP",...n,"DAMAGE","RELATIVE");for(const{combination:i,substats:c,damage:_,relative:u}of e){const A={name:"",stacks:"",condition:"",aura:""},S={name:"",stacks:"",condition:"",aura:""};i.weapon.empty||(A.name=i.weapon.name+` (R${i.weapon.rank})`,Number.isFinite(i.weapon.stacks)&&(A.stacks=i.weapon.stacks===0?"":i.weapon.stacks+""),i.weapon.condition&&(A.condition=i.weapon.condition.join(", ")),i.weapon.aura&&(A.aura=i.weapon.aura.join(", ")));let h=Aa(3);if(!i.artifact.empty){if(h=[i.artifact.sands,i.artifact.goblet,i.artifact.circlet].map(L=>t.stat.Name(L)),i.artifact.set){const L=[];for(const d of i.artifact.set)L.push(d,d);const[C]=qe(L);S.name=C.map(([d,M])=>`${d} (${M})`).join(" + ")}Number.isFinite(i.artifact.stacks)&&(S.stacks=i.artifact.stacks===0?"":i.artifact.stacks+""),i.artifact.condition&&(S.condition=i.artifact.condition.join(", ")),i.artifact.aura&&(S.aura=i.artifact.aura.join(", "))}const m=Aa(3),f=Aa(n.length);c&&(c.optimized.forEach((N,L)=>{const C=s.get(N);if(C!==void 0){const d=c.stats[L],R=t.FlatStats.includes(N)?b(d,0):b(d*100,2)+"%";f[C]=R+` (${c.rolls[L]})`}}),c.basic.forEach((N,L)=>m[L]=b(N,0))),r.AddRow(A.name,A.stacks,A.condition,A.aura,...h,S.name,S.stacks,S.condition,S.aura,...m,...f,b(_,0),b(u*100,2)+"%")}return r.RemoveEmptyColumns(),r}function Aa(e,...a){const s=Array.from(Array(e)).fill(void 0);for(let n=0;n<e;n++)s[n]=a[n];return s}var Sa=class extends Tt{constructor(){super(...arguments),this.generator=void 0,this.initDamage=0,this.results=new rt}init(e){var a;const s=new EE((a=this.target)==null?void 0:a.GetCharacter().Options.Weapon);s.program.logger=new V,s.program.logger.out=()=>{};const n=this.getConstants();for(const r in n)s.constants.set(r,n[r]);s.compileString(e.ConfigCmd)(),this.generator=_e.Generate(...s.Groups()),this.setTotal(_e.Count(...s.Groups())),this.party&&(this.initState=xn(this.party),this.initDamage=this.Run()),oN()===1&&console.log(`[MAIN WORKER INIT LOG]
`+s.program.logger.toString())}*Generate(){yield*this.generator}Evaluate(e){const a=this.GetRunner(),s=this.GetTarget();a.Scenario.Character=s;let n=U1(e);a.compileString(n)();let i=0,c;if(e.artifact.substats){const u=new Ft;u.SetParty(this.GetParty()),u.SetTarget(this.GetTarget()),u.SetRotation(this.GetRotation()),u.Init(k({},e.artifact.substats));for(const A of u.Generate())u.Insert(u.Evaluate(A));if(c=u.Get()[0],!c){u.Clear(),je(this.initState,this.party);return}i=c.damage,n+=`
`+u.EquipCmd(c),u.Clear(),je(this.initState,this.party)}else i=this.Run();const _=i/this.initDamage;return{cmd:n,combination:e,substats:c,damage:i,relative:_}}Insert(e){!e||this.results.Push(e,e.damage)}Get(){return this.results.Extract()}Format(e){return Sa.Format(e)}static Format(e){const a=e.filter(s=>s!==void 0);return tN(a)}},W=ct("NORMAL_ATTACK_LEVEL","ELEMENTAL_SKILL_LEVEL","ELEMENTAL_BURST_LEVEL","CHARACTER_LEVEL","CHARACTER_ASCENSION","WEAPON_LEVEL","WEAPON_ASCENSION");function eN(e,a){const s=aN(a),n=e[s];if(!n)throw new Error(`Cost not found for ${s}`);return n}function aN(e){switch(e.type){case W.NORMAL_ATTACK_LEVEL:case W.ELEMENTAL_SKILL_LEVEL:case W.ELEMENTAL_BURST_LEVEL:return"talent_"+e.value;default:return W.Name(e.type).toLowerCase()+"_"+e.value}}var Ae={damage:{criteria:"max",fn(e,a){return a}},cost:{criteria:"min",fn(e){return e.cost}},efficiency:{criteria:"max",fn(e,a,s){return s/e.cost}}};function bN(e){return e}function sN(e,a,...s){var n;const r={};for(const i of s){const c=(n=e.upgrades[a])==null?void 0:n[i];if(!c)throw new Error(`Upgrade ${i} not found for ${a} stars`);try{r[i]=nN(e,c)}catch(_){throw new Error(`cannot calculate cost for upgrade ${i} at ${a} stars: 
${_}`)}}return r}function nN(e,a){const s=Object.keys(a),n=Object.keys(e.domains),r=new Dt(n);r.Objective(Dt.Vars(n,u=>[u,e.domains[u].cost]));for(const u of s)r.Constraint(Dt.Vars(n,A=>[A,-e.domains[A][u]]),-a[u]);const i=r.Solve("min");if(!i.feasible)throw new Error("cannot calculate cost because the problem is infeasible. Check that the required resources are obtainable from the given domains.");const c=i.result,_=Dt.Vars(n,u=>{const A=i[u];if(!!A)return[u,A]});return k({cost:c},_)}var rN=()=>({domains:{},upgrades:{5:{},4:{},3:{}}}),TE=class extends ra{constructor(){super({}),this.pool=rN(),this.stars=[5],this.pointer="domains",this.catch=!1,this.program=new zt(this.pool,{domain:{name:"domain",description:"Sets the current domain to add resources to.",arguments:"name",compile:({values:[e]},{logger:a})=>()=>{this.pool.domains[e]||(this.pool.domains[e]={}),this.pointer="domains",this.name=e,a.log(`Domain set to ${e}`)}},upgrade:{name:"upgrade",description:"Sets the current upgrade to add resources to,in the currently selected stars with the `stars` command.",arguments:"name",compile:({values:[e]},{logger:a})=>()=>{for(const s of this.stars)this.pool.upgrades[s][e]||(this.pool.upgrades[s][e]={});this.pointer="upgrades",this.name=e,a.log(`Upgrade set to ${e}`)}},stars:{name:"stars",description:"Sets the current stars to add upgrades to.",arguments:"stars...",compile:({values:e},{logger:a})=>{const s=e.map(w);return()=>{for(const n of s)this.pool.upgrades[n]||(this.pool.upgrades[n]={});this.stars=s,a.log(`Stars set to ${s}`)}}},cost:{name:"cost",description:"Sets the resin cost for the current domain.",arguments:"cost",compile:({values:[e]},{logger:a})=>{const s=w(e);return()=>{const n=this.getLists();for(const r of n)r.cost=s;a.log(`Resin cost set to ${s}`)}}},resource:{name:"resource",description:"Adds a resource to the current domain or upgrade.",arguments:"name value",compile:({values:[e,a]},{logger:s})=>{const n=w(a);return()=>{const r=this.getLists();for(const i of r)i[e]=n;s.log(`Resource ${n} set to ${e}`)}}}})}getLists(){if(!this.name)throw new Error("No domain or upgrade selected");if(this.pointer==="domains"){const a=this.pool.domains[this.name];if(!a)throw new Error(`No domain named ${this.name}`);return[a]}const e=[];for(const a of this.stars){const s=this.pool.upgrades[a][this.name];if(!s)throw new Error(`No upgrade named ${this.name}`);e.push(s)}return e}GetDomains(){return this.pool.domains}GetResources(){const e=new Set;for(const a of Object.values(this.pool.domains))for(const s of Object.keys(a))e.add(s);for(const a of Object.values(this.pool.upgrades))for(const s of Object.values(a))for(const n of Object.keys(s))e.add(n);return Array.from(e)}GetStars(){return Object.keys(this.pool.upgrades).map(w)}GetUpgrades(e){return this.pool.upgrades[e]}GetPool(){return this.pool}CalculateCost(){const e={};for(const a of Object.keys(this.pool.upgrades)){const s=w(a);e[s]=sN(this.GetPool(),s,...Object.keys(this.pool.upgrades[s]))}return e}};function iN(e){const a=e.GetCharacter(),s=e.GetWeapon(),n=a.Options.Name,r=_E(n,a);return s&&r.push(..._E(n,s,!1)),r.push(...lN(a)),r}function _E(e,a,s=!0){const n=a.GetLevel(),r=a.GetAscension(),i=us(r);return n<i?[{target:e,type:s?W.CHARACTER_LEVEL:W.WEAPON_LEVEL,stars:a.Options.Stars,value:i,visible:i}]:r<6?[{target:e,type:s?W.CHARACTER_ASCENSION:W.WEAPON_ASCENSION,stars:a.Options.Stars,value:r+1,visible:r+1}]:[]}var ha=[1,1,2,4,6,8,10];function lN(e){const a=e.GetAscension(),s=e.Get(t.stat.NORMAL_ATTACK_LEVEL_UP),n=e.Get(t.stat.ELEMENTAL_SKILL_LEVEL_UP),r=e.Get(t.stat.ELEMENTAL_BURST_LEVEL_UP),i=e.Get(t.stat.NORMAL_ATTACK_LEVEL)-s,c=e.Get(t.stat.ELEMENTAL_SKILL_LEVEL)-n,_=e.Get(t.stat.ELEMENTAL_BURST_LEVEL)-r,u=[];return i<ha[a]&&u.push({target:e.Options.Name,type:W.NORMAL_ATTACK_LEVEL,stars:e.Options.Stars,value:i+1,visible:i+1+s}),c<ha[a]&&u.push({target:e.Options.Name,type:W.ELEMENTAL_SKILL_LEVEL,stars:e.Options.Stars,value:c+1,visible:c+1+n}),_<ha[a]&&u.push({target:e.Options.Name,type:W.ELEMENTAL_BURST_LEVEL,stars:e.Options.Stars,value:_+1,visible:_+1+r}),u}function ma(e){let a="character set "+e.target+`
`;const s=W.Name(e.type),n=us(e.visible-1);switch(e.type){case W.NORMAL_ATTACK_LEVEL:case W.ELEMENTAL_SKILL_LEVEL:case W.ELEMENTAL_BURST_LEVEL:a+=`character stat set ${s} ${e.visible}
`;break;case W.CHARACTER_LEVEL:a+=`character level ${e.visible}
`;break;case W.CHARACTER_ASCENSION:a+=`character level ${n}+
`;break;case W.WEAPON_LEVEL:a+=`weapon level ${e.visible}
`;break;case W.WEAPON_ASCENSION:a+=`weapon level ${n}+
`;break}return a}var uE=class extends Tt{constructor(){super(...arguments),this.TRANSFORM=!0,this.MAX_CHUNK_SIZE=1,this.MAX_CHILDREN=1,this.queue=new rt,this.levelCount=0,this.initDamage=0,this.prevDamage=0,this.costs={},this.criteria=Ae.damage,this.result=[],this.SendMessage=()=>{if(this.queue.Length()<this.levelCount)return;const e=this.queue.Extract();this.result.push(e);const a=e[0];return a.selected=!0,{step:"upgrade",upgrade:a.upgrade,cmd:ma(a.upgrade),damage:a.damage}}}init(e){if(!e.costs){const a=new TE;a.compileString(e.resourceCmd)(),e.costs=a.CalculateCost()}this.prevDamage=this.initDamage=this.Run(),this.costs=e.costs,this.criteria=Ae[e.criteria]}getUpgrades(){const e=[],s=this.GetParty().GetMembers();for(const n of s){const r=iN(n);e.push(...r)}return e}RecieveMessage(e){if(!e||e.step!=="upgrade"||!e.damage)return;const a=ma(e.upgrade);this.GetRunner().compileString(a)(),this.prevDamage=e.damage}*Generate(){let e;do{e=this.getUpgrades(),this.levelCount=e.length;for(const a of e)yield{step:"evaluate",upgrade:a,cmd:ma(a)}}while(e.length>0)}Evaluate(e){const a=this.GetParty(),s=G.ExportParty(a);this.GetRunner().compileString(e.cmd)();const r=this.Run(),i=r/this.prevDamage-1;G.ImportParty(s,a);const c=eN(this.costs[e.upgrade.stars],e.upgrade),_={};for(const[u,A]of Object.entries(Ae))_[u]=A.fn(c,r,i);return lt(k({criteria:this.GetConfig().criteria},_),{cmd:e.cmd,costData:c,upgrade:e.upgrade,relative:r/this.initDamage,increase:i})}Insert(e){const a=e[this.GetConfig().criteria]*(this.criteria.criteria==="max"?1:-1);this.queue.Push(e,a)}Get(){return this.queue.Extract()}Transform(){return this.result.filter(e=>e.length>0&&e[0].increase>1e-6).map(e=>e.filter((a,s,n)=>a.increase<1e-6?!1:n.findIndex(i=>i.cmd===a.cmd)===s))}Format(){throw new Error("Method not implemented.")}static Curve(e){const a=[];let s=0;for(const[n]of e){const r=n.costData;s+=r.cost,a.push([s,n.damage])}return a}},AE={SubstatsOptimizer:Ft,MainstatOptimizer:Xc,NextRollOptimizer:Jc,SetOptimizer:tE,WeaponOptimizer:eE,ArtifactsOptimizer:aE,FoodOptimizer:nE,GeneralOptimizer:Sa,UpgradesOptimizer:uE};function KN(e){return e}var SE=0;function oN(){return SE}function fa(e){SE=e}var cN=class extends ca{Init(e){return new Promise((a,s)=>{const n=this.worker.Post("backend:optimizer/run/child/init",e),r=this.worker.AddListener("frontend:optimizer/run/child/init",(c,{id:_})=>{_===n&&(a(),this.worker.RemoveListener(r))}),i=this.worker.AddErrorListener(c=>{this.worker.RemoveErrorListener(i),s(c)})})}Send(e){return new Promise((a,s)=>{const n=this.worker.Post("backend:optimizer/run/child/run",e),r=this.worker.AddListener("frontend:optimizer/run/child/run",(c,{id:_,result:u})=>{_===n&&(a(u),this.worker.RemoveListener(r))}),i=this.worker.AddErrorListener(c=>{this.worker.RemoveErrorListener(i),s(c)})})}SendMessage(e){return new Promise((a,s)=>{const n=this.worker.Post("backend:optimizer/run/child/msg",e),r=this.worker.AddListener("frontend:optimizer/run/child/msg",(c,{id:_})=>{_===n&&(a(),this.worker.RemoveListener(r))}),i=this.worker.AddErrorListener(c=>{this.worker.RemoveErrorListener(i),s(c)})})}},EN=class extends oa{constructor(){super({["backend:optimizer/run"]:(e,a)=>this.Run(e,a)})}Run(e,a){return gt(this,null,function*(){fa(1),V.Global.save=!1,V.Global.out=()=>{};const s=new AE[a.tool];s.Init(a.config);const n=(()=>{const m=s.SendMessage;return m?()=>gt(this,null,function*(){const f=m();s.RecieveMessage(f),yield Promise.all(_.map(N=>N.SendMessage(f)))}):()=>{}})(),r=s.GetTotal();this.Post("frontend:optimizer/run",{id:"progress:"+e,result:[],progress:0,total:r});const i=Math.min(a.chunk,s.MAX_CHUNK_SIZE),c=Math.min(a.children,s.MAX_CHILDREN);console.log(`[WORKER] Spawning ${c} child workers`);const _=TN(c);yield Promise.all(_.map(m=>m.Init(lt(k({},a),{rows:[]}))));const u=K1(i*_.length,s.Generate());let A=0;for(const m of u){const N=(yield Promise.all(_.map((L,C)=>{const d=m.slice(C*i,(C+1)*i);return L.Send(lt(k({},a),{rows:d}))}))).reduce((L,C)=>(C.forEach(d=>L.push(d)),L),[]);for(const L of N)s.Insert(L);yield n(),A+=m.length,this.Post("frontend:optimizer/run",{id:"progress:"+e,result:[],progress:A,total:r})}const S=s.Get(),h=(()=>{if(s.TRANSFORM)return s.Transform(S)})();_.forEach(m=>m.Kill()),this.Post("frontend:optimizer/run",{id:e,result:S,transform:h})})}};function TN(e){return Array.from(Array(e)).fill(0).map(()=>new cN)}var _N=class extends oa{constructor(){super({["backend:optimizer/run/child/init"]:(e,a)=>this.Init(e,a),["backend:optimizer/run/child/run"]:(e,a)=>this.Run(e,a),["backend:optimizer/run/child/msg"]:(e,a)=>this.Msg(e,a)})}Init(e,a){fa(2),V.Global.save=!1,V.Global.out=()=>{},(this.optimizer=new AE[a.tool]).Init(a.config),console.log("[CHILD WORKER] Child worker initialized"),this.Post("frontend:optimizer/run/child/init",{id:e})}Run(e,a){if(!this.optimizer)throw new Error("[CHILD WORKER] Optimizer not set in the child worker");for(const n of a.rows)this.optimizer.Insert(this.optimizer.Evaluate(n));const s=this.optimizer.Get();this.Post("frontend:optimizer/run/child/run",{id:e,result:s})}Msg(e,a){if(fa(2),!this.optimizer)throw new Error("[CHILD WORKER] Optimizer not set in the child worker");this.optimizer.RecieveMessage(a),this.Post("frontend:optimizer/run/child/msg",{id:e})}},uN=class extends oa{constructor(){super({["backend:rotation-damage/run"]:(e,a)=>this.Run(e,a)})}Run(e,a){V.Global.out=()=>{},V.Global.save=!0;const s=Yt.PartyFrom(a.party),n=new ia;n.Scenario.Party=s;const r=zc(s);for(const i in r)n.constants.set(i,r[i]);try{n.compileString(a.command)();const i=n.Scenario.Rotation;n.compileString("rotation log enable")(),n.compileString("rotation run")();const c=i.GetSummary(),_=i.GetDetails();this.Post("frontend:rotation-damage/run",{result:{summary:c,details:_,log:V.Global.toString()},id:e})}catch(i){this.Post("frontend:rotation-damage/run",{result:{log:V.Global.toString()},id:e}),console.error(i)}}},AN=[uN,EN,_N];function SN(e){const a=new Uc(e);for(const s of AN)new s().SetWorker(a);return a}var hN=class extends ca{Run(e,a){const s=G.ExportParty(e);return new Promise((n,r)=>{const i=this.worker.Post("backend:rotation-damage/run",{party:s,command:a}),c=this.worker.AddListener("frontend:rotation-damage/run",(u,{result:A,id:S})=>{S===i&&(n(A),this.worker.RemoveListener(c))}),_=this.worker.AddErrorListener(u=>{this.worker.RemoveErrorListener(_),r(u)})})}},mN=class extends ca{constructor(){super(...arguments),this.Children=1,this.Chunk=100,this.OnProgress=()=>{}}Run(e,a){return console.log("[CLIENT] Running optimizer worker for tool: "+e),new Promise((s,n)=>{const r=this.worker.Post("backend:optimizer/run",{tool:e,config:a,children:this.Children,chunk:this.Chunk}),i=this.worker.AddListener("frontend:optimizer/run",(_,{id:u,result:A,transform:S,progress:h,total:m})=>{if(u!==r){u==="progress:"+r&&Number.isFinite(h)&&Number.isFinite(m)&&this.OnProgress(h||0,m||0);return}s({result:A,transform:S}),this.worker.RemoveListener(i)}),c=this.worker.AddErrorListener(_=>{this.worker.RemoveErrorListener(c),n(_)})})}},hE={};D(hE,{artifacts:()=>NE,filter:()=>jc,food:()=>sE,general:()=>dE,mainstat:()=>mE,nextroll:()=>fE,set:()=>LE,substats:()=>$c,upgrades:()=>CE,weapon:()=>pE});var mE={};D(mE,{MainstatOptimizer:()=>Xc,defaultConfig:()=>fN});var fN=()=>({}),fE={};D(fE,{NextRollOptimizer:()=>Jc,defaultConfig:()=>LN});var LN=()=>({tier:o.SubstatTier.ROLL_AVG}),LE={};D(LE,{SetOptimizer:()=>tE,defaultConfig:()=>pN});var pN=()=>({ConfigCmd:`
/*
IMPORTANT: Remember to mark the "Shielded" checkbox in the character attributes
if you want to optimize Retracing Bolide with its 4-piece set effect enabled.

Note that the effect configurations in this section will override the configurations you do
in the application, but will be overrided by configurations done in the rotation code.
*/

case 
NoblesseOblige4
TenacityOfTheMillelith4
DeepwoodMemories4
ArchaicPetra4
ViridescentVenerer4
Instructor4:
  // by default, these party effects will be applied to the entire party.
  effect apply all
  /* 
  you can apply the effect to the member you want, for example:

  effect apply Xiangling

  If you don't want the effect to be applied to the target, then unapply
  from it:

  effect unapply $target_name
  */
  
case 
ArchaicPetra4 
ViridescentVenerer4:
  // by default, Petra and VV effects will have applied the aura corresponding to the target's element,
  // you can change it to the aura (s) you want, or all.
  effect aura $target_element_aura
  // the constant $target_element_aura is predefined by the optimizer, 
  // you can read more about it in the documentation.
  
case OceanHuedClam4:
  // stacks refer to accumulated healing so by default will be 0.
  // set this to the corresponding value if you're optimizing a character
  // with healing capabilities.
  effect stacks 0  
  
/* 
you can add more custom configurations here. Something like, for example:

case CrimsonWitchOfFlames4:
  effect stacks 1

to optimize Crimson with 1 stacks.
*/  
`.trim()}),pE={};D(pE,{WeaponOptimizer:()=>eE,defaultConfig:()=>NN});var NN=()=>({Ranks:{3:[5],4:[1,5],5:[1]},ConfigCmd:`
/*
IMPORTANT: Remember to mark the "Shielded" checkbox in the 
character attributes if you want to optimize weapons from
Golden Majesty series (Memory of Dust, Summit Shaper, etc.).
*/
case
WolfsGravestone2
ElegyForTheEnd2
FreedomSworn2
SongOfBrokenPines2
ThousandFloatingDreams2
KeyOfKhajNisut2
HakushinRing1
MakhairaAquamarine1
WanderingEvenstar1
XiphosMoonlight1:
  /*
  These weapon effects will be applied to the entire party
  by default. You can write your own configurations to apply
  to specific characters.
  */
  effect apply all

case KeyOfKhajNisut2:
  effect stacks 3

case
ThrillingTalesOfDragonSlayers1
ForestRegalia1
SapwoodBlade1:
  /*
  By default, these weapon effects will be applied ONLY to the
  first character in the party.
  */
  effect unapply all
  effect apply $member_0_name
`.trim()}),NE={};D(NE,{ArtifactsOptimizer:()=>aE,defaultConfig:()=>dN});var dN=()=>({artifacts:[],allowSetNumber:[2,4],ConfigCmd:`
/*
You will have to configure all set effects here. This optimizer won't 
automatically set any stacks or conditions to the effects.

Also remember to mark the "Shielded" checkbox in the character attributes
if you want to optimize Retracing Bolide with its 4-piece set effect enabled.

Note that the effect configurations in this section will override the configurations 
you do in the application, but will be overrided by configurations done in the 
rotation code.
*/

case 
NoblesseOblige4
TenacityOfTheMillelith4
DeepwoodMemories4
ArchaicPetra4
ViridescentVenerer4
Instructor4:
  // by default, these party effects will be applied to the entire party.
  effect apply all
  /* 
  you can apply the effect to the member you want, for example:

  effect apply Xiangling

  If you don't want the effect to be applied to the target, then unapply
  from it:

  effect unapply $target_name
  */
  
case 
ArchaicPetra4 
ViridescentVenerer4:
  // by default, Petra and VV effects will have applied the aura corresponding to 
  // the target's element, you can change it to the aura (s) you want, or all.
  effect aura $target_element_aura
  // the constant $target_element_aura is predefined by the optimizer, 
  // you can read more about it in the documentation.
  
case OceanHuedClam4:
  // stacks refer to accumulated healing so by default will be 0.
  // set this to the corresponding value if you're optimizing a character
  // with healing capabilities.
  effect stacks 0

case CrimsonWitchOfFlames4:
  effect stacks 1 // optimize CW4 with 1 stacks

case PaleFlame4:
  effect stacks 2

case
HuskOfOpulentDreams4
FlowerOfParadiseLost4
VermillionHereafter4:
  effect stacks 4
    `.trim()}),dE={};D(dE,{CombinatorCmd:()=>EE,GeneralOptimizer:()=>Sa,defaultConfig:()=>CN});var CN=()=>({ConfigCmd:`# Uncomment the line below if you want to generate optimal substats
# using the default ranges of rolls:
    // substats default
# Also, you can define your own rolls range:
    // substats range atk%=0:12 cr=0:10 cd=0:12 em=0:12 er=0:12
# And you can define minimum values for substats:
    // substats min atk%=5 cr=3 cd=3 em=3 er=3
# And general rolls configuration:
    // substats tier 3   // use max rolls
    // substats tier avg // use average rolls
    // substats total 25 // optimize 25 rolls
# By default, the substats optimization is disabled., which means
# that it will be used the values defined in the artifacts.
# Any of the commands above will enable the substats optimization.


weapon 4* rank=1,5 # optimize all 4* weapons at rank 1 and 5
artifact \\
    sands=atk% \\
    goblet=atk% \\
    circlet=cr,cd # compare crit rate and crit damage circlets
add

weapon 5* rank=1 # optimize all 5* weapons at rank 1
artifact \\
    sands=atk% \\
    goblet=atk% \\
    circlet=cr,cd # compare crit rate and crit damage circlets
add

# You can also add specific weapons and configurations:
// weapon jadespear rank=3 stacks=1,3,5
// weapon alleyhunter rank=5 stacks=1:10

# Or specific combinations of artifact sets:
// artifact sands=atk% goblet=pyro,physical circlet=cr,cd set=gladiator*4
// artifact sands=atk% goblet=pyro,physical circlet=cr,cd set=gladiator+noblesse`}),CE={};D(CE,{Criteria:()=>Ae,ResourceCmd:()=>TE,Upgrade:()=>W,UpgradesOptimizer:()=>uE,defaultConfig:()=>GN});var MN=`
domain mora_ley_line
cost 20
resource mora 60000

domain exp_ley_line
cost 20
resource exp 122500

domain talent_domain
cost 20
resource mora 2375
resource talent_book 1.1311111111111112

domain weapon_domain
cost 20
resource mora 2375
resource weapon_ascension 0.6314814814814815

domain elite_boss
cost 40
resource mora 6000
resource elite 2.55
resource character_ascension 0.31807407407407406

domain weekly_boss
cost 60
resource mora 8100
resource character_ascension 0.07998148148148147
resource weekly 0.7966666666666667
`.trim(),gN=`
stars 4 5 // 4* and 5* characters
upgrade character_level_20
resource mora 24200
resource exp 120175

upgrade character_level_40
resource mora 115800
resource exp 578325

upgrade character_level_50
resource mora 116000
resource exp 579100

upgrade character_level_60
resource mora 171000
resource exp 854125

upgrade character_level_70
resource mora 239200
resource exp 1195925

upgrade character_level_80
resource mora 322400
resource exp 1611875

upgrade character_level_90
resource mora 684800
resource exp 3423125

upgrade character_ascension_1
resource mora 20000

upgrade character_ascension_2
resource mora 40000
resource elite 2

upgrade character_ascension_3
resource mora 60000
resource elite 4

upgrade character_ascension_4
resource mora 80000
resource elite 8

upgrade character_ascension_5
resource mora 100000
resource elite 12

upgrade character_ascension_6
resource mora 120000
resource elite 20

upgrade talent_2
resource mora 12500
resource talent_book 0.3333333333333333

upgrade talent_3
resource mora 17500
resource talent_book 0.6666666666666666

upgrade talent_4
resource mora 25000
resource talent_book 1.3333333333333333

upgrade talent_5
resource mora 30000
resource talent_book 2

upgrade talent_6
resource mora 37000
resource talent_book 3

upgrade talent_7
resource mora 120000
resource talent_book 4
resource weekly 1

upgrade talent_8
resource mora 260000
resource talent_book 6
resource weekly 1

upgrade talent_9
resource mora 450000
resource talent_book 12
resource weekly 2

upgrade talent_10
resource mora 700000
resource talent_book 16
resource weekly 2

stars 3 // 3* weapons
upgrade weapon_ascension_1
resource mora 5000
resource weapon_ascension 0.07407407407407407

upgrade weapon_ascension_2
resource mora 10000
resource weapon_ascension 0.2222222222222222

upgrade weapon_ascension_3
resource mora 15000
resource weapon_ascension 0.4444444444444444

upgrade weapon_ascension_4
resource mora 20000
resource weapon_ascension 0.6666666666666666

upgrade weapon_ascension_5
resource mora 25000
resource weapon_ascension 1.3333333333333333

upgrade weapon_ascension_6
resource mora 30000
resource weapon_ascension 3

upgrade weapon_level_20
resource mora 5360

upgrade weapon_level_40
resource mora 27400

upgrade weapon_level_50
resource mora 27640

upgrade weapon_level_60
resource mora 40820

upgrade weapon_level_70
resource mora 57180

upgrade weapon_level_80
resource mora 77020

upgrade weapon_level_90
resource mora 163460

stars 4 // 4* weapons
upgrade weapon_ascension_1
resource mora 5000
resource weapon_ascension 0.1111111111111111

upgrade weapon_ascension_2
resource mora 15000
resource weapon_ascension 0.3333333333333333

upgrade weapon_ascension_3
resource mora 20000
resource weapon_ascension 0.6666666666666666

upgrade weapon_ascension_4
resource mora 30000
resource weapon_ascension 1

upgrade weapon_ascension_5
resource mora 35000
resource weapon_ascension 2

upgrade weapon_ascension_6
resource mora 45000
resource weapon_ascension 4

upgrade weapon_level_20
resource mora 8120

upgrade weapon_level_40
resource mora 41520

upgrade weapon_level_50
resource mora 41880

upgrade weapon_level_60
resource mora 61840

upgrade weapon_level_70
resource mora 86640

upgrade weapon_level_80
resource mora 116720

upgrade weapon_level_90
resource mora 247640

stars 5 // 5* weapons
upgrade weapon_ascension_1
resource mora 10000
resource weapon_ascension 0.18518518518518517

upgrade weapon_ascension_2
resource mora 20000
resource weapon_ascension 0.5555555555555556

upgrade weapon_ascension_3
resource mora 30000
resource weapon_ascension 1

upgrade weapon_ascension_4
resource mora 45000
resource weapon_ascension 1.6666666666666665

upgrade weapon_ascension_5
resource mora 55000
resource weapon_ascension 3

upgrade weapon_ascension_6
resource mora 65000
resource weapon_ascension 6

upgrade weapon_level_20
resource mora 12160

upgrade weapon_level_40
resource mora 62280

upgrade weapon_level_50
resource mora 62840

upgrade weapon_level_60
resource mora 92800

upgrade weapon_level_70
resource mora 129920

upgrade weapon_level_80
resource mora 175040

upgrade weapon_level_90
resource mora 371480

`.trim(),GN=()=>({resourceCmd:RN+`
`+MN+`

`+IN+`
`+gN,criteria:"damage"}),RN=`
# Configures the resources obtained in each domain,
# and the resources required to adquire each upgrade.
# This data will be used to calculate the cost of each
# upgrade.
`.trim(),IN=`
# Configures the resources required by each upgrade.
# Levels, ascensions and talents require a certain
# amount of resources to be adquired, and so they
# have a cost associated with them.
# The cost will be calculated based on the resources
# configured here.
`,ME={};D(ME,{enka:()=>gE,good:()=>GE});var gE={};D(gE,{FetchEnka:()=>Bc,GetEnka:()=>kc,GetEnkaUrl:()=>bc,ParseEnka:()=>Fc});var GE={};D(GE,{Parse:()=>DN,ParseArtifact:()=>IE});var ON={flower:t.piece.FLOWER,plume:t.piece.PLUME,sands:t.piece.SANDS,goblet:t.piece.GOBLET,circlet:t.piece.CIRCLET},RE={hp:t.stat.HP_FLAT,hp_:t.stat.HP_PERCENT,atk:t.stat.ATK_FLAT,atk_:t.stat.ATK_PERCENT,def:t.stat.DEF_FLAT,def_:t.stat.DEF_PERCENT,eleMas:t.stat.ELEMENTAL_MASTERY,enerRech_:t.stat.ENERGY_RECHARGE,heal_:t.stat.HEALING_BONUS,critRate_:t.stat.CRIT_RATE,critDMG_:t.stat.CRIT_DMG,physical_dmg_:t.stat.PHYSICAL_DMG,anemo_dmg_:t.stat.ANEMO_DMG,geo_dmg_:t.stat.GEO_DMG,electro_dmg_:t.stat.ELECTRO_DMG,hydro_dmg_:t.stat.HYDRO_DMG,pyro_dmg_:t.stat.PYRO_DMG,cryo_dmg_:t.stat.CRYO_DMG,dendro_dmg_:t.stat.DENDRO_DMG};function IE(e){const a=ON[e.slotKey];t.piece.Name(a);const s=new I.Artifact(a),n=tt.FindByName(e.setKey);n?s.SetSet(n.Name):(console.warn(`Could not find artifacts set "${e.setKey}"`),s.SetSet(e.setKey)),s.SetStars(e.rarity),s.SetLevel(e.level);const r=RE[e.mainStatKey];t.stat.Name(r),s.SetMainstat(r);for(const{key:i,value:c}of e.substats){const _=RE[i];t.stat.Name(_);let u=c;if(t.FlatStats.includes(_)||(u/=100),!Number.isFinite(u)||u<0)throw new Error(`Invalid substat value: ${u}`);s.AddSubstat(_,u)}return s}function DN(e){return(e.artifacts||[]).map(s=>IE(s))}function vN(){return new Worker("/genshin-damage-calc/v4/assets/worker_child.13198b2d.js")}Qt.worker.SetGenerator(()=>{const e=new vN,a=new Qt.worker.VirtualWorker((s,n,r)=>e.postMessage({path:s,id:n,data:r}));return a.SetKiller(()=>e.terminate()),e.addEventListener("message",async({data:s})=>{if(s.error){await a.Error(s.error);return}a.Recieve(s.path,s.id,s.data)}),a});const Se=self,La=Qt.worker.BackendWorker((e,a,s)=>Se.postMessage({path:e,id:a,data:s}));La.SetKiller(()=>Se.terminate()),Se.addEventListener("message",async({data:e})=>{try{await La.Recieve(e.path,e.id,e.data)}catch(a){console.error("[WORKER ERROR]",a),La.Error(a),Se.postMessage({error:a})}})})();
