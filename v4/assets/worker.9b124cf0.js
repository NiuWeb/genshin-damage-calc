(function(){"use strict";var Ct={exports:{}},ea={exports:{}},ne;function Hc(){return ne||(ne=1,function(a){const e=typeof process<"u"&&{}.TERM_PROGRAM==="Hyper",s=typeof process<"u"&&process.platform==="win32",n=typeof process<"u"&&process.platform==="linux",i={ballotDisabled:"\u2612",ballotOff:"\u2610",ballotOn:"\u2611",bullet:"\u2022",bulletWhite:"\u25E6",fullBlock:"\u2588",heart:"\u2764",identicalTo:"\u2261",line:"\u2500",mark:"\u203B",middot:"\xB7",minus:"\uFF0D",multiplication:"\xD7",obelus:"\xF7",pencilDownRight:"\u270E",pencilRight:"\u270F",pencilUpRight:"\u2710",percent:"%",pilcrow2:"\u2761",pilcrow:"\xB6",plusMinus:"\xB1",question:"?",section:"\xA7",starsOff:"\u2606",starsOn:"\u2605",upDownArrow:"\u2195"},l=Object.assign({},i,{check:"\u221A",cross:"\xD7",ellipsisLarge:"...",ellipsis:"...",info:"i",questionSmall:"?",pointer:">",pointerSmall:"\xBB",radioOff:"( )",radioOn:"(*)",warning:"\u203C"}),E=Object.assign({},i,{ballotCross:"\u2718",check:"\u2714",cross:"\u2716",ellipsisLarge:"\u22EF",ellipsis:"\u2026",info:"\u2139",questionFull:"\uFF1F",questionSmall:"\uFE56",pointer:n?"\u25B8":"\u276F",pointerSmall:n?"\u2023":"\u203A",radioOff:"\u25EF",radioOn:"\u25C9",warning:"\u26A0"});a.exports=s&&!e?l:E,Reflect.defineProperty(a.exports,"common",{enumerable:!1,value:i}),Reflect.defineProperty(a.exports,"windows",{enumerable:!1,value:l}),Reflect.defineProperty(a.exports,"other",{enumerable:!1,value:E})}(ea)),ea.exports}const vc=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),Pc=/[\u001b\u009b][[\]#;?()]*(?:(?:(?:[^\W_]*;?[^\W_]*)\u0007)|(?:(?:[0-9]{1,4}(;[0-9]{0,4})*)?[~0-9=<>cf-nqrtyA-PRZ]))/g,Bc=()=>typeof process<"u"?{}.FORCE_COLOR!=="0":!1,ie=()=>{const a={enabled:Bc(),visible:!0,styles:{},keys:{}},e=l=>{let E=l.open=`\x1B[${l.codes[0]}m`,_=l.close=`\x1B[${l.codes[1]}m`,A=l.regex=new RegExp(`\\u001b\\[${l.codes[1]}m`,"g");return l.wrap=(S,u)=>{S.includes(_)&&(S=S.replace(A,_+E));let h=E+S+_;return u?h.replace(/\r*\n/g,`${_}$&${E}`):h},l},s=(l,E,_)=>typeof l=="function"?l(E):l.wrap(E,_),n=(l,E)=>{if(l===""||l==null)return"";if(a.enabled===!1)return l;if(a.visible===!1)return"";let _=""+l,A=_.includes(`
`),S=E.length;for(S>0&&E.includes("unstyle")&&(E=[...new Set(["unstyle",...E])].reverse());S-- >0;)_=s(a.styles[E[S]],_,A);return _},i=(l,E,_)=>{a.styles[l]=e({name:l,codes:E}),(a.keys[_]||(a.keys[_]=[])).push(l),Reflect.defineProperty(a,l,{configurable:!0,enumerable:!0,set(S){a.alias(l,S)},get(){let S=u=>n(u,S.stack);return Reflect.setPrototypeOf(S,a),S.stack=this.stack?this.stack.concat(l):[l],S}})};return i("reset",[0,0],"modifier"),i("bold",[1,22],"modifier"),i("dim",[2,22],"modifier"),i("italic",[3,23],"modifier"),i("underline",[4,24],"modifier"),i("inverse",[7,27],"modifier"),i("hidden",[8,28],"modifier"),i("strikethrough",[9,29],"modifier"),i("black",[30,39],"color"),i("red",[31,39],"color"),i("green",[32,39],"color"),i("yellow",[33,39],"color"),i("blue",[34,39],"color"),i("magenta",[35,39],"color"),i("cyan",[36,39],"color"),i("white",[37,39],"color"),i("gray",[90,39],"color"),i("grey",[90,39],"color"),i("bgBlack",[40,49],"bg"),i("bgRed",[41,49],"bg"),i("bgGreen",[42,49],"bg"),i("bgYellow",[43,49],"bg"),i("bgBlue",[44,49],"bg"),i("bgMagenta",[45,49],"bg"),i("bgCyan",[46,49],"bg"),i("bgWhite",[47,49],"bg"),i("blackBright",[90,39],"bright"),i("redBright",[91,39],"bright"),i("greenBright",[92,39],"bright"),i("yellowBright",[93,39],"bright"),i("blueBright",[94,39],"bright"),i("magentaBright",[95,39],"bright"),i("cyanBright",[96,39],"bright"),i("whiteBright",[97,39],"bright"),i("bgBlackBright",[100,49],"bgBright"),i("bgRedBright",[101,49],"bgBright"),i("bgGreenBright",[102,49],"bgBright"),i("bgYellowBright",[103,49],"bgBright"),i("bgBlueBright",[104,49],"bgBright"),i("bgMagentaBright",[105,49],"bgBright"),i("bgCyanBright",[106,49],"bgBright"),i("bgWhiteBright",[107,49],"bgBright"),a.ansiRegex=Pc,a.hasColor=a.hasAnsi=l=>(a.ansiRegex.lastIndex=0,typeof l=="string"&&l!==""&&a.ansiRegex.test(l)),a.alias=(l,E)=>{let _=typeof E=="string"?a[E]:E;if(typeof _!="function")throw new TypeError("Expected alias to be the name of an existing color (string) or a function");_.stack||(Reflect.defineProperty(_,"name",{value:l}),a.styles[l]=_,_.stack=[l]),Reflect.defineProperty(a,l,{configurable:!0,enumerable:!0,set(A){a.alias(l,A)},get(){let A=S=>n(S,A.stack);return Reflect.setPrototypeOf(A,a),A.stack=this.stack?this.stack.concat(_.stack):_.stack,A}})},a.theme=l=>{if(!vc(l))throw new TypeError("Expected theme to be an object");for(let E of Object.keys(l))a.alias(E,l[E]);return a},a.alias("unstyle",l=>typeof l=="string"&&l!==""?(a.ansiRegex.lastIndex=0,l.replace(a.ansiRegex,"")):""),a.alias("noop",l=>l),a.none=a.clear=a.noop,a.stripColor=a.unstyle,a.symbols=Hc(),a.define=i,a};Ct.exports=ie(),Ct.exports.create=ie;var sa=function(a,e){return sa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(s[i]=n[i])},sa(a,e)};function re(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");sa(a,e);function s(){this.constructor=a}a.prototype=e===null?Object.create(e):(s.prototype=e.prototype,new s)}function le(a,e){var s=typeof Symbol=="function"&&a[Symbol.iterator];if(!s)return a;var n=s.call(a),i,l=[],E;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)l.push(i.value)}catch(_){E={error:_}}finally{try{i&&!i.done&&(s=n.return)&&s.call(n)}finally{if(E)throw E.error}}return l}function oe(a,e,s){if(s||arguments.length===2)for(var n=0,i=e.length,l;n<i;n++)(l||!(n in e))&&(l||(l=Array.prototype.slice.call(e,0,n)),l[n]=e[n]);return a.concat(l||Array.prototype.slice.call(e))}var ce=function(){function a(){this.t=0}return Object.defineProperty(a.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),a.prototype.size=function(){return this.t},a.prototype.empty=function(){return this.t===0},a}();(function(a){re(e,a);function e(){return a!==null&&a.apply(this,arguments)||this}return e})(ce);var Ee=function(a){re(e,a);function e(s,n,i){s===void 0&&(s=[]),n===void 0&&(n=function(S,u){return S>u?-1:S<u?1:0}),i===void 0&&(i=!0);var l=a.call(this)||this;if(l.i=n,Array.isArray(s))l.u=i?oe([],le(s),!1):s;else{l.u=[];var E=l;s.forEach(function(S){E.u.push(S)})}l.t=l.u.length;for(var _=l.t>>1,A=l.t-1>>1;A>=0;--A)l.o(A,_);return l}return e.prototype.h=function(s){for(var n=this.u[s];s>0;){var i=s-1>>1,l=this.u[i];if(this.i(l,n)<=0)break;this.u[s]=l,s=i}this.u[s]=n},e.prototype.o=function(s,n){for(var i=this.u[s];s<n;){var l=s<<1|1,E=l+1,_=this.u[l];if(E<this.t&&this.i(_,this.u[E])>0&&(l=E,_=this.u[E]),this.i(_,i)>=0)break;this.u[s]=_,s=l}this.u[s]=i},e.prototype.clear=function(){this.t=0,this.u.length=0},e.prototype.push=function(s){this.u.push(s),this.h(this.t),this.t+=1},e.prototype.pop=function(){if(this.t!==0){var s=this.u[0],n=this.u.pop();return this.t-=1,this.t&&(this.u[0]=n,this.o(0,this.t>>1)),s}},e.prototype.top=function(){return this.u[0]},e.prototype.find=function(s){return this.u.indexOf(s)>=0},e.prototype.remove=function(s){var n=this.u.indexOf(s);return n<0?!1:(n===0?this.pop():n===this.t-1?(this.u.pop(),this.t-=1):(this.u.splice(n,1,this.u.pop()),this.t-=1,this.h(n),this.o(n,this.t>>1)),!0)},e.prototype.updateItem=function(s){var n=this.u.indexOf(s);return n<0?!1:(this.h(n),this.o(n,this.t>>1),!0)},e.prototype.toArray=function(){return oe([],le(this.u),!1)},e}(ce),Kc=Object.defineProperty,bc=(a,e)=>{for(var s in e)Kc(a,s,{get:e[s],enumerable:!0})},Te={};bc(Te,{Filter:()=>Yc,ReduceSearchItem:()=>Ht,Search:()=>wc});function Ht(a){const e=[];if(a===void 0)return e;if(Array.isArray(a))for(const s of a){const n=Ht(s);for(const i of n)e.push(i)}else e.push(a);return e}function wc(a){const e=Ht(a.search),s={values:[],indexes:[],results:[]},n=a.mode||"some";for(let i=0;i<a.values.length;i++){const l=Ht(a.map(a.values[i]));e[n](_=>l.some(A=>typeof _!=typeof A?!1:(a.ignoreCase&&(typeof _=="string"&&(_=_.toLowerCase()),typeof A=="string"&&(A=A.toLowerCase())),a.exact||typeof _=="number"?_===A:typeof A=="string"?A.includes(_):!1)))&&(s.values.push(a.values[i]),s.indexes.push(i),s.results.push({value:a.values[i],index:i}))}return s}function Yc(a){const e={values:[],indexes:[],results:[]};return a.values.forEach((s,n)=>{a.filters[a.mode||"some"](l=>l.for?l.for(s)?l.filter(s):!0:l.filter(s))&&(e.values.push(s),e.indexes.push(n),e.results.push({value:s,index:n}))}),e}var Fc=Object.create,vt=Object.defineProperty,Vc=Object.defineProperties,xc=Object.getOwnPropertyDescriptor,kc=Object.getOwnPropertyDescriptors,_e=Object.getOwnPropertyNames,Ae=Object.getOwnPropertySymbols,Uc=Object.getPrototypeOf,Se=Object.prototype.hasOwnProperty,Wc=Object.prototype.propertyIsEnumerable,jc=Math.pow,ue=(a,e,s)=>e in a?vt(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s,z=(a,e)=>{for(var s in e||(e={}))Se.call(e,s)&&ue(a,s,e[s]);if(Ae)for(var s of Ae(e))Wc.call(e,s)&&ue(a,s,e[s]);return a},et=(a,e)=>Vc(a,kc(e)),P=(a,e)=>function(){return e||(0,a[_e(a)[0]])((e={exports:{}}).exports,e),e.exports},R=(a,e)=>{for(var s in e)vt(a,s,{get:e[s],enumerable:!0})},zc=(a,e,s,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of _e(e))!Se.call(a,i)&&i!==s&&vt(a,i,{get:()=>e[i],enumerable:!(n=xc(e,i))||n.enumerable});return a},he=(a,e,s)=>(s=a!=null?Fc(Uc(a)):{},zc(e||!a||!a.__esModule?vt(s,"default",{value:a,enumerable:!0}):s,a)),pt=(a,e,s)=>new Promise((n,i)=>{var l=A=>{try{_(s.next(A))}catch(S){i(S)}},E=A=>{try{_(s.throw(A))}catch(S){i(S)}},_=A=>A.done?n(A.value):Promise.resolve(A.value).then(l,E);_((s=s.apply(a,e)).next())}),qc=P({"node_modules/boolean/build/lib/boolean.js"(a){Object.defineProperty(a,"__esModule",{value:!0}),a.boolean=void 0;var e=function(s){switch(Object.prototype.toString.call(s)){case"[object String]":return["true","t","yes","y","on","1"].includes(s.trim().toLowerCase());case"[object Number]":return s.valueOf()===1;case"[object Boolean]":return s.valueOf();default:return!1}};a.boolean=e}}),Qc=P({"node_modules/boolean/build/lib/isBooleanable.js"(a){Object.defineProperty(a,"__esModule",{value:!0}),a.isBooleanable=void 0;var e=function(s){switch(Object.prototype.toString.call(s)){case"[object String]":return["true","t","yes","y","on","1","false","f","no","n","off","0"].includes(s.trim().toLowerCase());case"[object Number]":return[0,1].includes(s.valueOf());case"[object Boolean]":return!0;default:return!1}};a.isBooleanable=e}}),$c=P({"node_modules/boolean/build/lib/index.js"(a){Object.defineProperty(a,"__esModule",{value:!0}),a.isBooleanable=a.boolean=void 0;var e=qc();Object.defineProperty(a,"boolean",{enumerable:!0,get:function(){return e.boolean}});var s=Qc();Object.defineProperty(a,"isBooleanable",{enumerable:!0,get:function(){return s.isBooleanable}})}}),Xc=P({"node_modules/fast-printf/dist/src/tokenize.js"(a){Object.defineProperty(a,"__esModule",{value:!0}),a.tokenize=void 0;var e=/(?:%(?<flag>([+0-]|-\+))?(?<width>\d+)?(?<position>\d+\$)?(?<precision>\.\d+)?(?<conversion>[%BCESb-iosux]))|(\\%)/g,s=n=>{let i;const l=[];let E=0,_=0,A=null;for(;(i=e.exec(n))!==null;){i.index>_&&(A={literal:n.slice(_,i.index),type:"literal"},l.push(A));const S=i[0];_=i.index+S.length,S==="\\%"||S==="%%"?A&&A.type==="literal"?A.literal+="%":(A={literal:"%",type:"literal"},l.push(A)):i.groups&&(A={conversion:i.groups.conversion,flag:i.groups.flag||null,placeholder:S,position:i.groups.position?Number.parseInt(i.groups.position,10)-1:E++,precision:i.groups.precision?Number.parseInt(i.groups.precision.slice(1),10):null,type:"placeholder",width:i.groups.width?Number.parseInt(i.groups.width,10):null},l.push(A))}return _<=n.length-1&&(A&&A.type==="literal"?A.literal+=n.slice(_):l.push({literal:n.slice(_),type:"literal"})),l};a.tokenize=s}}),Jc=P({"node_modules/fast-printf/dist/src/createPrintf.js"(a){Object.defineProperty(a,"__esModule",{value:!0}),a.createPrintf=void 0;var e=$c(),s=Xc(),n=(l,E)=>E.placeholder,i=l=>{var E;const _=(u,h,L)=>L==="-"?u.padEnd(h," "):L==="-+"?((Number(u)>=0?"+":"")+u).padEnd(h," "):L==="+"?((Number(u)>=0?"+":"")+u).padStart(h," "):L==="0"?u.padStart(h,"0"):u.padStart(h," "),A=(E=l==null?void 0:l.formatUnboundExpression)!==null&&E!==void 0?E:n,S={};return(u,...h)=>{let L=S[u];L||(L=S[u]=s.tokenize(u));let N="";for(const f of L)if(f.type==="literal")N+=f.literal;else{let M=h[f.position];if(M===void 0)N+=A(u,f,h);else if(f.conversion==="b")N+=e.boolean(M)?"true":"false";else if(f.conversion==="B")N+=e.boolean(M)?"TRUE":"FALSE";else if(f.conversion==="c")N+=M;else if(f.conversion==="C")N+=String(M).toUpperCase();else if(f.conversion==="i"||f.conversion==="d")M=String(Math.trunc(M)),f.width!==null&&(M=_(M,f.width,f.flag)),N+=M;else if(f.conversion==="e")N+=Number(M).toExponential();else if(f.conversion==="E")N+=Number(M).toExponential().toUpperCase();else if(f.conversion==="f")f.precision!==null&&(M=Number(M).toFixed(f.precision)),f.width!==null&&(M=_(String(M),f.width,f.flag)),N+=M;else if(f.conversion==="o")N+=(Number.parseInt(String(M),10)>>>0).toString(8);else if(f.conversion==="s")f.width!==null&&(M=_(String(M),f.width,f.flag)),N+=M;else if(f.conversion==="S")f.width!==null&&(M=_(String(M),f.width,f.flag)),N+=String(M).toUpperCase();else if(f.conversion==="u")N+=Number.parseInt(String(M),10)>>>0;else if(f.conversion==="x")M=(Number.parseInt(String(M),10)>>>0).toString(16),f.width!==null&&(M=_(String(M),f.width,f.flag)),N+=M;else throw new Error("Unknown format specifier.")}return N}};a.createPrintf=i}}),Zc=P({"node_modules/fast-printf/dist/src/printf.js"(a){Object.defineProperty(a,"__esModule",{value:!0}),a.printf=a.createPrintf=void 0;var e=Jc();Object.defineProperty(a,"createPrintf",{enumerable:!0,get:function(){return e.createPrintf}}),a.printf=e.createPrintf()}}),Le=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/Solution.js"(a,e){function s(n,i,l,E){this.feasible=l,this.evaluation=i,this.bounded=E,this._tableau=n}e.exports=s,s.prototype.generateSolutionSet=function(){for(var n={},i=this._tableau,l=i.varIndexByRow,E=i.variablesPerIndex,_=i.matrix,A=i.rhsColumn,S=i.height-1,u=Math.round(1/i.precision),h=1;h<=S;h+=1){var L=l[h],N=E[L];if(!(N===void 0||N.isSlack===!0)){var f=_[h][A];n[N.id]=Math.round((Number.EPSILON+f)*u)/u}}return n}}}),tE=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/MilpSolution.js"(a,e){var s=Le();function n(i,l,E,_,A){s.call(this,i,l,E,_),this.iter=A}e.exports=n,n.prototype=Object.create(s.prototype),n.constructor=n}}),tt=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/Tableau.js"(a,e){var s=Le(),n=tE();function i(E){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=E||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}e.exports=i,i.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()};function l(E,_){this.priority=E,this.reducedCosts=new Array(_);for(var A=0;A<_;A+=1)this.reducedCosts[A]=0}l.prototype.copy=function(){var E=new l(this.priority,this.reducedCosts.length);return E.reducedCosts=this.reducedCosts.slice(),E},i.prototype.setOptionalObjective=function(E,_,A){var S=this.objectivesByPriority[E];if(S===void 0){var u=Math.max(this.width,_+1);S=new l(E,u),this.objectivesByPriority[E]=S,this.optionalObjectives.push(S),this.optionalObjectives.sort(function(h,L){return h.priority-L.priority})}S.reducedCosts[_]=A},i.prototype.initialize=function(E,_,A,S){this.variables=A,this.unrestrictedVars=S,this.width=E,this.height=_;for(var u=new Array(E),h=0;h<E;h++)u[h]=0;this.matrix=new Array(_);for(var L=0;L<_;L++)this.matrix[L]=u.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=E+_-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},i.prototype._resetMatrix=function(){var E=this.model.variables,_=this.model.constraints,A=E.length,S=_.length,u,h,L=this.matrix[0],N=this.model.isMinimization===!0?-1:1;for(u=0;u<A;u+=1){var f=E[u],M=f.priority,p=N*f.cost;M===0?L[u+1]=p:this.setOptionalObjective(M,u+1,p),h=E[u].index,this.rowByVarIndex[h]=-1,this.colByVarIndex[h]=u+1,this.varIndexByCol[u+1]=h}for(var C=1,G=0;G<S;G+=1){var g=_[G],O=g.index;this.rowByVarIndex[O]=C,this.colByVarIndex[O]=-1,this.varIndexByRow[C]=O;var D,H,v,V=g.terms,j=V.length,Q=this.matrix[C++];if(g.isUpperBound){for(D=0;D<j;D+=1)H=V[D],v=this.colByVarIndex[H.variable.index],Q[v]=H.coefficient;Q[0]=g.rhs}else{for(D=0;D<j;D+=1)H=V[D],v=this.colByVarIndex[H.variable.index],Q[v]=-H.coefficient;Q[0]=-g.rhs}}},i.prototype.setModel=function(E){this.model=E;var _=E.nVariables+1,A=E.nConstraints+1;return this.initialize(_,A,E.variables,E.unrestrictedVariables),this._resetMatrix(),this},i.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var E=this.lastElementIndex;return this.lastElementIndex+=1,E},i.prototype.density=function(){for(var E=0,_=this.matrix,A=0;A<this.height;A++)for(var S=_[A],u=0;u<this.width;u++)S[u]!==0&&(E+=1);return E/(this.height*this.width)},i.prototype.setEvaluation=function(){var E=Math.round(1/this.precision),_=this.matrix[this.costRowIndex][this.rhsColumn],A=Math.round((Number.EPSILON+_)*E)/E;this.evaluation=A,this.simplexIters===0&&(this.bestPossibleEval=A)},i.prototype.getSolution=function(){var E=this.model.isMinimization===!0?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new n(this,E,this.feasible,this.bounded,this.branchAndCutIterations):new s(this,E,this.feasible,this.bounded)}}}),aE=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/simplex.js"(){var a=tt();a.prototype.simplex=function(){return this.bounded=!0,this.phase1(),this.feasible===!0&&this.phase2(),this},a.prototype.phase1=function(){for(var s=this.model.checkForCycles,n=[],i=this.matrix,l=this.rhsColumn,E=this.width-1,_=this.height-1,A,S=0;;){for(var u=0,h=-this.precision,L=1;L<=_;L++){A=this.unrestrictedVars[this.varIndexByRow[L]]===!0;var N=i[L][l];N<h&&(h=N,u=L)}if(u===0)return this.feasible=!0,S;for(var f=0,M=-1/0,p=i[0],C=i[u],G=1;G<=E;G++){var g=C[G];if(A=this.unrestrictedVars[this.varIndexByCol[G]]===!0,A||g<-this.precision){var O=-p[G]/g;M<O&&(M=O,f=G)}}if(f===0)return this.feasible=!1,S;if(s){n.push([this.varIndexByRow[u],this.varIndexByCol[f]]);var D=this.checkForCycles(n);if(D.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+D[0]),this.model.messages.push("Length :"+D[1]),this.feasible=!1,S}this.pivot(u,f),S+=1}},a.prototype.phase2=function(){for(var s=this.model.checkForCycles,n=[],i=this.matrix,l=this.rhsColumn,E=this.width-1,_=this.height-1,A=this.precision,S=this.optionalObjectives.length,u=null,h=0,L,N;;){var f=i[this.costRowIndex];S>0&&(u=[]);for(var M=0,p=A,C=!1,G=1;G<=E;G++){if(L=f[G],N=this.unrestrictedVars[this.varIndexByCol[G]]===!0,S>0&&-A<L&&L<A){u.push(G);continue}if(N&&L<0){-L>p&&(p=-L,M=G,C=!0);continue}L>p&&(p=L,M=G,C=!1)}if(S>0)for(var g=0;M===0&&u.length>0&&g<S;){var O=[],D=this.optionalObjectives[g].reducedCosts;p=A;for(var H=0;H<u.length;H++){if(G=u[H],L=D[G],N=this.unrestrictedVars[this.varIndexByCol[G]]===!0,-A<L&&L<A){O.push(G);continue}if(N&&L<0){-L>p&&(p=-L,M=G,C=!0);continue}L>p&&(p=L,M=G,C=!1)}u=O,g+=1}if(M===0)return this.setEvaluation(),this.simplexIters+=1,h;var v=0,V=1/0;this.varIndexByRow;for(var j=1;j<=_;j++){var Q=i[j],at=Q[l],q=Q[M];if(!(-A<q&&q<A)){if(q>0&&A>at&&at>-A){V=0,v=j;break}var ht=C?-at/q:at/q;ht>A&&V>ht&&(V=ht,v=j)}}if(V===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[M],h;if(s){n.push([this.varIndexByRow[v],this.varIndexByCol[M]]);var Lt=this.checkForCycles(n);if(Lt.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+Lt[0]),this.model.messages.push("Length :"+Lt[1]),this.feasible=!1,h}this.pivot(v,M,!0),h+=1}};var e=[];a.prototype.pivot=function(s,n){var i=this.matrix,l=i[s][n],E=this.height-1,_=this.width-1,A=this.varIndexByRow[s],S=this.varIndexByCol[n];this.varIndexByRow[s]=S,this.varIndexByCol[n]=A,this.rowByVarIndex[S]=s,this.rowByVarIndex[A]=-1,this.colByVarIndex[S]=-1,this.colByVarIndex[A]=n;for(var u=i[s],h=0,L=0;L<=_;L++)u[L]>=-1e-16&&u[L]<=1e-16?u[L]=0:(u[L]/=l,e[h]=L,h+=1);u[n]=1/l;var N,f,M;this.precision;for(var p=0;p<=E;p++)if(p!==s&&!(i[p][n]>=-1e-16&&i[p][n]<=1e-16)){var C=i[p];if(N=C[n],N>=-1e-16&&N<=1e-16)N!==0&&(C[n]=0);else{for(f=0;f<h;f++)L=e[f],M=u[L],M>=-1e-16&&M<=1e-16?M!==0&&(u[L]=0):C[L]=C[L]-N*M;C[n]=-N/l}}var G=this.optionalObjectives.length;if(G>0)for(var g=0;g<G;g+=1){var O=this.optionalObjectives[g].reducedCosts;if(N=O[n],N!==0){for(f=0;f<h;f++)L=e[f],M=u[L],M!==0&&(O[L]=O[L]-N*M);O[n]=-N/l}}},a.prototype.checkForCycles=function(s){for(var n=0;n<s.length-1;n++)for(var i=n+1;i<s.length;i++){var l=s[n],E=s[i];if(l[0]===E[0]&&l[1]===E[1]){if(i-n>s.length-i)break;for(var _=!0,A=1;A<i-n;A++){var S=s[n+A],u=s[i+A];if(S[0]!==u[0]||S[1]!==u[1]){_=!1;break}}if(_)return[n,i-n]}}return[]}}}),na=P({"node_modules/@bygdle/javascript-lp-solver/src/expressions.js"(a,e){function s(S,u,h,L){this.id=S,this.cost=u,this.index=h,this.value=0,this.priority=L}function n(S,u,h,L){s.call(this,S,u,h,L)}n.prototype.isInteger=!0;function i(S,u){s.call(this,S,0,u,0)}i.prototype.isSlack=!0;function l(S,u){this.variable=S,this.coefficient=u}function E(S,u,h){return h===0||h==="required"?null:(u=u||1,h=h||1,S.isMinimization===!1&&(u=-u),S.addVariable(u,"r"+S.relaxationIndex++,!1,!1,h))}function _(S,u,h,L){this.slack=new i("s"+h,h),this.index=h,this.model=L,this.rhs=S,this.isUpperBound=u,this.terms=[],this.termsByVarIndex={},this.relaxation=null}_.prototype.addTerm=function(S,u){var h=u.index,L=this.termsByVarIndex[h];if(L===void 0)L=new l(u,S),this.termsByVarIndex[h]=L,this.terms.push(L),this.isUpperBound===!0&&(S=-S),this.model.updateConstraintCoefficient(this,u,S);else{var N=L.coefficient+S;this.setVariableCoefficient(N,u)}return this},_.prototype.removeTerm=function(S){return this},_.prototype.setRightHandSide=function(S){if(S!==this.rhs){var u=S-this.rhs;this.isUpperBound===!0&&(u=-u),this.rhs=S,this.model.updateRightHandSide(this,u)}return this},_.prototype.setVariableCoefficient=function(S,u){var h=u.index;if(h===-1){console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.");return}var L=this.termsByVarIndex[h];if(L===void 0)this.addTerm(S,u);else if(S!==L.coefficient){var N=S-L.coefficient;this.isUpperBound===!0&&(N=-N),L.coefficient=S,this.model.updateConstraintCoefficient(this,u,N)}return this},_.prototype.relax=function(S,u){this.relaxation=E(this.model,S,u),this._relax(this.relaxation)},_.prototype._relax=function(S){S!==null&&(this.isUpperBound?this.setVariableCoefficient(-1,S):this.setVariableCoefficient(1,S))};function A(S,u){this.upperBound=S,this.lowerBound=u,this.model=S.model,this.rhs=S.rhs,this.relaxation=null}A.prototype.isEquality=!0,A.prototype.addTerm=function(S,u){return this.upperBound.addTerm(S,u),this.lowerBound.addTerm(S,u),this},A.prototype.removeTerm=function(S){return this.upperBound.removeTerm(S),this.lowerBound.removeTerm(S),this},A.prototype.setRightHandSide=function(S){this.upperBound.setRightHandSide(S),this.lowerBound.setRightHandSide(S),this.rhs=S},A.prototype.relax=function(S,u){this.relaxation=E(this.model,S,u),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)},e.exports={Constraint:_,Variable:s,IntegerVariable:n,SlackVariable:i,Equality:A,Term:l}}}),eE=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/cuttingStrategies.js"(){var a=tt(),e=na().SlackVariable;a.prototype.addCutConstraints=function(s){for(var n=s.length,i=this.height,l=i+n,E=i;E<l;E+=1)this.matrix[E]===void 0&&(this.matrix[E]=this.matrix[E-1].slice());this.height=l,this.nVars=this.width+this.height-2;for(var _,A=this.width-1,S=0;S<n;S+=1){var u=s[S],h=i+S,L=u.type==="min"?-1:1,N=u.varIndex,f=this.rowByVarIndex[N],M=this.matrix[h];if(f===-1){for(M[this.rhsColumn]=L*u.value,_=1;_<=A;_+=1)M[_]=0;M[this.colByVarIndex[N]]=L}else{var p=this.matrix[f],C=p[this.rhsColumn];for(M[this.rhsColumn]=L*(u.value-C),_=1;_<=A;_+=1)M[_]=-L*p[_]}var G=this.getNewElementIndex();this.varIndexByRow[h]=G,this.rowByVarIndex[G]=h,this.colByVarIndex[G]=-1,this.variablesPerIndex[G]=new e("s"+G,G),this.nVars+=1}},a.prototype._addLowerBoundMIRCut=function(s){if(s===this.costRowIndex)return!1;this.model;var n=this.matrix,i=this.variablesPerIndex[this.varIndexByRow[s]];if(!i.isInteger)return!1;var l=n[s][this.rhsColumn],E=l-Math.floor(l);if(E<this.precision||1-this.precision<E)return!1;var _=this.height;n[_]=n[_-1].slice(),this.height+=1,this.nVars+=1;var A=this.getNewElementIndex();this.varIndexByRow[_]=A,this.rowByVarIndex[A]=_,this.colByVarIndex[A]=-1,this.variablesPerIndex[A]=new e("s"+A,A),n[_][this.rhsColumn]=Math.floor(l);for(var S=1;S<this.varIndexByCol.length;S+=1){var u=this.variablesPerIndex[this.varIndexByCol[S]];if(!u.isInteger)n[_][S]=Math.min(0,n[s][S]/(1-E));else{var h=n[s][S],L=Math.floor(h)+Math.max(0,h-Math.floor(h)-E)/(1-E);n[_][S]=L}}for(var N=0;N<this.width;N+=1)n[_][N]-=n[s][N];return!0},a.prototype._addUpperBoundMIRCut=function(s){if(s===this.costRowIndex)return!1;this.model;var n=this.matrix,i=this.variablesPerIndex[this.varIndexByRow[s]];if(!i.isInteger)return!1;var l=n[s][this.rhsColumn],E=l-Math.floor(l);if(E<this.precision||1-this.precision<E)return!1;var _=this.height;n[_]=n[_-1].slice(),this.height+=1,this.nVars+=1;var A=this.getNewElementIndex();this.varIndexByRow[_]=A,this.rowByVarIndex[A]=_,this.colByVarIndex[A]=-1,this.variablesPerIndex[A]=new e("s"+A,A),n[_][this.rhsColumn]=-E;for(var S=1;S<this.varIndexByCol.length;S+=1){var u=this.variablesPerIndex[this.varIndexByCol[S]],h=n[s][S],L=h-Math.floor(h);u.isInteger?L<=E?n[_][S]=-L:n[_][S]=-(1-L)*E/L:h>=0?n[_][S]=-h:n[_][S]=h*E/(1-E)}return!0},a.prototype.applyMIRCuts=function(){}}}),sE=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/dynamicModification.js"(){var a=tt();a.prototype._putInBase=function(e){var s=this.rowByVarIndex[e];if(s===-1){for(var n=this.colByVarIndex[e],i=1;i<this.height;i+=1){var l=this.matrix[i][n];if(l<-this.precision||this.precision<l){s=i;break}}this.pivot(s,n)}return s},a.prototype._takeOutOfBase=function(e){var s=this.colByVarIndex[e];if(s===-1){for(var n=this.rowByVarIndex[e],i=this.matrix[n],l=1;l<this.height;l+=1){var E=i[l];if(E<-this.precision||this.precision<E){s=l;break}}this.pivot(n,s)}return s},a.prototype.updateVariableValues=function(){for(var e=this.variables.length,s=Math.round(1/this.precision),n=0;n<e;n+=1){var i=this.variables[n],l=i.index,E=this.rowByVarIndex[l];if(E===-1)i.value=0;else{var _=this.matrix[E][this.rhsColumn];i.value=Math.round((_+Number.EPSILON)*s)/s}}},a.prototype.updateRightHandSide=function(e,s){var n=this.height-1,i=this.rowByVarIndex[e.index];if(i===-1){for(var l=this.colByVarIndex[e.index],E=0;E<=n;E+=1){var _=this.matrix[E];_[this.rhsColumn]-=s*_[l]}var A=this.optionalObjectives.length;if(A>0)for(var S=0;S<A;S+=1){var u=this.optionalObjectives[S].reducedCosts;u[this.rhsColumn]-=s*u[l]}}else this.matrix[i][this.rhsColumn]-=s},a.prototype.updateConstraintCoefficient=function(e,s,n){if(e.index===s.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var i=this._putInBase(e.index),l=this.colByVarIndex[s.index];if(l===-1)for(var E=this.rowByVarIndex[s.index],_=0;_<this.width;_+=1)this.matrix[i][_]+=n*this.matrix[E][_];else this.matrix[i][l]-=n},a.prototype.updateCost=function(e,s){var n=e.index,i=this.width-1,l=this.colByVarIndex[n];if(l===-1){var E=this.matrix[this.rowByVarIndex[n]],_;if(e.priority===0){var A=this.matrix[0];for(_=0;_<=i;_+=1)A[_]+=s*E[_]}else{var S=this.objectivesByPriority[e.priority].reducedCosts;for(_=0;_<=i;_+=1)S[_]+=s*E[_]}}else this.matrix[0][l]-=s},a.prototype.addConstraint=function(e){var s=e.isUpperBound?1:-1,n=this.height,i=this.matrix[n];i===void 0&&(i=this.matrix[0].slice(),this.matrix[n]=i);for(var l=this.width-1,E=0;E<=l;E+=1)i[E]=0;i[this.rhsColumn]=s*e.rhs;for(var _=e.terms,A=_.length,S=0;S<A;S+=1){var u=_[S],h=u.coefficient,L=u.variable.index,N=this.rowByVarIndex[L];if(N===-1)i[this.colByVarIndex[L]]+=s*h;else{var f=this.matrix[N];for(f[this.rhsColumn],E=0;E<=l;E+=1)i[E]-=s*h*f[E]}}var M=e.index;this.varIndexByRow[n]=M,this.rowByVarIndex[M]=n,this.colByVarIndex[M]=-1,this.height+=1},a.prototype.removeConstraint=function(e){var s=e.index,n=this.height-1,i=this._putInBase(s),l=this.matrix[n];this.matrix[n]=this.matrix[i],this.matrix[i]=l,this.varIndexByRow[i]=this.varIndexByRow[n],this.varIndexByRow[n]=-1,this.rowByVarIndex[s]=-1,this.availableIndexes[this.availableIndexes.length]=s,e.slack.index=-1,this.height-=1},a.prototype.addVariable=function(e){var s=this.height-1,n=this.width,i=this.model.isMinimization===!0?-e.cost:e.cost,l=e.priority,E=this.optionalObjectives.length;if(E>0)for(var _=0;_<E;_+=1)this.optionalObjectives[_].reducedCosts[n]=0;l===0?this.matrix[0][n]=i:(this.setOptionalObjective(l,n,i),this.matrix[0][n]=0);for(var A=1;A<=s;A+=1)this.matrix[A][n]=0;var S=e.index;this.varIndexByCol[n]=S,this.rowByVarIndex[S]=-1,this.colByVarIndex[S]=n,this.width+=1},a.prototype.removeVariable=function(e){var s=e.index,n=this._takeOutOfBase(s),i=this.width-1;if(n!==i){for(var l=this.height-1,E=0;E<=l;E+=1){var _=this.matrix[E];_[n]=_[i]}var A=this.optionalObjectives.length;if(A>0)for(var S=0;S<A;S+=1){var u=this.optionalObjectives[S].reducedCosts;u[n]=u[i]}var h=this.varIndexByCol[i];this.varIndexByCol[n]=h,this.colByVarIndex[h]=n}this.varIndexByCol[i]=-1,this.colByVarIndex[s]=-1,this.availableIndexes[this.availableIndexes.length]=s,e.index=-1,this.width-=1}}}),nE=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/log.js"(){var a=tt();a.prototype.log=function(e,s){console.log("****",e,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var n=5,i="",l=[" "],E,_,A,S,u,h,L,N,f,M,p;for(_=1;_<this.width;_+=1)u=this.varIndexByCol[_],S=this.variablesPerIndex[u],S===void 0?h="c"+u:h=S.id,L=h.length,N=" ",f="	",L>5?N+=" ":f+="	",l[_]=N,i+=f+h;console.log(i);var C,G=this.matrix[this.costRowIndex],g="	";for(E=1;E<this.width;E+=1)C="	",g+=C,g+=l[E],g+=G[E].toFixed(n);for(C="	",g+=C+l[0]+G[0].toFixed(n),console.log(g+"	Z"),A=1;A<this.height;A+=1){for(M=this.matrix[A],p="	",_=1;_<this.width;_+=1)C="	",p+=C+l[_]+M[_].toFixed(n);C="	",p+=C+l[0]+M[0].toFixed(n),u=this.varIndexByRow[A],S=this.variablesPerIndex[u],S===void 0?h="c"+u:h=S.id,console.log(p+"	"+h)}console.log("");var O=this.optionalObjectives.length;if(O>0){console.log("    Optional objectives:");for(var D=0;D<O;D+=1){var H=this.optionalObjectives[D].reducedCosts,v="";for(E=1;E<this.width;E+=1)C=H[E]<0?"":" ",v+=C,v+=l[E],v+=H[E].toFixed(n);C=H[0]<0?"":" ",v+=C+l[0]+H[0].toFixed(n),console.log(v+" z"+D)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this}}}),iE=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/backup.js"(){var a=tt();a.prototype.copy=function(){var e=new a(this.precision);e.width=this.width,e.height=this.height,e.nVars=this.nVars,e.model=this.model,e.variables=this.variables,e.variablesPerIndex=this.variablesPerIndex,e.unrestrictedVars=this.unrestrictedVars,e.lastElementIndex=this.lastElementIndex,e.varIndexByRow=this.varIndexByRow.slice(),e.varIndexByCol=this.varIndexByCol.slice(),e.rowByVarIndex=this.rowByVarIndex.slice(),e.colByVarIndex=this.colByVarIndex.slice(),e.availableIndexes=this.availableIndexes.slice();for(var s=[],n=0;n<this.optionalObjectives.length;n++)s[n]=this.optionalObjectives[n].copy();e.optionalObjectives=s;for(var i=this.matrix,l=new Array(this.height),E=0;E<this.height;E++)l[E]=i[E].slice();return e.matrix=l,e},a.prototype.save=function(){this.savedState=this.copy()},a.prototype.restore=function(){if(this.savedState!==null){var e=this.savedState,s=e.matrix;this.nVars=e.nVars,this.model=e.model,this.variables=e.variables,this.variablesPerIndex=e.variablesPerIndex,this.unrestrictedVars=e.unrestrictedVars,this.lastElementIndex=e.lastElementIndex,this.width=e.width,this.height=e.height;var n,i;for(n=0;n<this.height;n+=1){var l=s[n],E=this.matrix[n];for(i=0;i<this.width;i+=1)E[i]=l[i]}var _=e.varIndexByRow;for(i=0;i<this.height;i+=1)this.varIndexByRow[i]=_[i];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var A=e.varIndexByCol;for(n=0;n<this.width;n+=1)this.varIndexByCol[n]=A[n];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var S=e.rowByVarIndex,u=e.colByVarIndex,h=0;h<this.nVars;h+=1)this.rowByVarIndex[h]=S[h],this.colByVarIndex[h]=u[h];if(e.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var L=0;L<e.optionalObjectives.length;L++){var N=e.optionalObjectives[L].copy();this.optionalObjectives[L]=N,this.optionalObjectivePerPriority[N.priority]=N}}}}}}),rE=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/branchingStrategies.js"(){var a=tt();function e(s,n){this.index=s,this.value=n}a.prototype.getMostFractionalVar=function(){for(var s=0,n=null,i=null,l=this.model.integerVariables,E=l.length,_=0;_<E;_++){var A=l[_].index,S=this.rowByVarIndex[A];if(S!==-1){var u=this.matrix[S][this.rhsColumn],h=Math.abs(u-Math.round(u));s<h&&(s=h,n=A,i=u)}}return new e(n,i)},a.prototype.getFractionalVarWithLowestCost=function(){for(var s=1/0,n=null,i=null,l=this.model.integerVariables,E=l.length,_=0;_<E;_++){var A=l[_],S=A.index,u=this.rowByVarIndex[S];if(u!==-1){var h=this.matrix[u][this.rhsColumn];if(Math.abs(h-Math.round(h))>this.precision){var L=A.cost;s>L&&(s=L,n=S,i=h)}}}return new e(n,i)}}}),lE=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/integerProperties.js"(){var a=tt();a.prototype.countIntegerValues=function(){for(var e=0,s=1;s<this.height;s+=1)if(this.variablesPerIndex[this.varIndexByRow[s]].isInteger){var n=this.matrix[s][this.rhsColumn];n=n-Math.floor(n),n<this.precision&&-n<this.precision&&(e+=1)}return e},a.prototype.isIntegral=function(){for(var e=this.model.integerVariables,s=e.length,n=0;n<s;n++){var i=this.rowByVarIndex[e[n].index];if(i!==-1){var l=this.matrix[i][this.rhsColumn];if(Math.abs(l-Math.round(l))>this.precision)return!1}}return!0},a.prototype.computeFractionalVolume=function(e){for(var s=-1,n=1;n<this.height;n+=1)if(this.variablesPerIndex[this.varIndexByRow[n]].isInteger){var i=this.matrix[n][this.rhsColumn];i=Math.abs(i);var l=Math.min(i-Math.floor(i),Math.floor(i+1));if(l<this.precision){if(!e)return 0}else s===-1?s=i:s*=i}return s===-1?0:s}}}),oE=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/index.js"(a,e){aE(),eE(),sE(),nE(),iE(),rE(),lE(),e.exports=tt()}}),Ne=P({"node_modules/@bygdle/javascript-lp-solver/src/Tableau/branchAndCut.js"(){var a=tt();function e(i,l,E){this.type=i,this.varIndex=l,this.value=E}function s(i,l){this.relaxedEvaluation=i,this.cuts=l}function n(i,l){return l.relaxedEvaluation-i.relaxedEvaluation}a.prototype.applyCuts=function(i){if(this.restore(),this.addCutConstraints(i),this.simplex(),this.model.useMIRCuts)for(var l=!0;l;){var E=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex();var _=this.computeFractionalVolume(!0);_>=.9*E&&(l=!1)}},a.prototype.branchAndCut=function(){var i=[],l=0,E=this.model.tolerance,_=!0,A=1e99;this.model.timeout&&(A=Date.now()+this.model.timeout);for(var S=1/0,u=null,h=[],L=0;L<this.optionalObjectives.length;L+=1)h.push(1/0);var N=new s(-1/0,[]),f;for(i.push(N);i.length>0&&_===!0&&Date.now()<A;)if(this.model.isMinimization?f=this.bestPossibleEval*(1+E):f=this.bestPossibleEval*(1-E),E>0&&S<f&&(_=!1),N=i.pop(),!(N.relaxedEvaluation>S)){var M=N.cuts;if(this.applyCuts(M),l++,this.feasible!==!1){var p=this.evaluation;if(!(p>S)){if(p===S){for(var C=!0,G=0;G<this.optionalObjectives.length&&!(this.optionalObjectives[G].reducedCosts[0]>h[G]);G+=1)if(this.optionalObjectives[G].reducedCosts[0]<h[G]){C=!1;break}if(C)continue}if(this.isIntegral()===!0){if(this.__isIntegral=!0,l===1){this.branchAndCutIterations=l;return}u=N,S=p;for(var g=0;g<this.optionalObjectives.length;g+=1)h[g]=this.optionalObjectives[g].reducedCosts[0];if(this.model.keep_solutions){var O=this.model.tableau.getSolution(),D=O.generateSolutionSet();D.result=O.evaluation,this.model.solutions||(this.model.solutions=[]),this.model.solutions.push(D)}}else{l===1&&this.save();for(var H=this.getMostFractionalVar(),v=H.index,V=[],j=[],Q=M.length,at=0;at<Q;at+=1){var q=M[at];q.varIndex===v?q.type==="min"?j.push(q):V.push(q):(V.push(q),j.push(q))}var ht=Math.ceil(H.value),Lt=Math.floor(H.value),Za=new e("min",v,ht);V.push(Za);var te=new e("max",v,Lt);j.push(te),i.push(new s(p,V)),i.push(new s(p,j)),i.sort(n)}}}}u!==null&&this.applyCuts(u.cuts),this.branchAndCutIterations=l}}}),cE=P({"node_modules/@bygdle/javascript-lp-solver/src/Model.js"(a,e){var s=tt();Ne();var n=na(),i=n.Constraint,l=n.Equality,E=n.Variable,_=n.IntegerVariable;n.Term;function A(S,u){this.tableau=new s(S),this.name=u,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}e.exports=A,A.prototype.minimize=function(){return this.isMinimization=!0,this},A.prototype.maximize=function(){return this.isMinimization=!1,this},A.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var S=this.lastElementIndex;return this.lastElementIndex+=1,S},A.prototype._addConstraint=function(S){var u=S.slack;this.tableau.variablesPerIndex[u.index]=u,this.constraints.push(S),this.nConstraints+=1,this.tableauInitialized===!0&&this.tableau.addConstraint(S)},A.prototype.smallerThan=function(S){var u=new i(S,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(u),u},A.prototype.greaterThan=function(S){var u=new i(S,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(u),u},A.prototype.equal=function(S){var u=new i(S,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(u);var h=new i(S,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(h),new l(u,h)},A.prototype.addVariable=function(S,u,h,L,N){if(typeof N=="string")switch(N){case"required":N=0;break;case"strong":N=1;break;case"medium":N=2;break;case"weak":N=3;break;default:N=0;break}var f=this.tableau.getNewElementIndex();u==null&&(u="v"+f),S==null&&(S=0),N==null&&(N=0);var M;return h?(M=new _(u,S,f,N),this.integerVariables.push(M)):M=new E(u,S,f,N),this.variables.push(M),this.tableau.variablesPerIndex[f]=M,L&&(this.unrestrictedVariables[f]=!0),this.nVariables+=1,this.tableauInitialized===!0&&this.tableau.addVariable(M),M},A.prototype._removeConstraint=function(S){var u=this.constraints.indexOf(S);if(u===-1){console.warn("[Model.removeConstraint] Constraint not present in model");return}this.constraints.splice(u,1),this.nConstraints-=1,this.tableauInitialized===!0&&this.tableau.removeConstraint(S),S.relaxation&&this.removeVariable(S.relaxation)},A.prototype.removeConstraint=function(S){return S.isEquality?(this._removeConstraint(S.upperBound),this._removeConstraint(S.lowerBound)):this._removeConstraint(S),this},A.prototype.removeVariable=function(S){var u=this.variables.indexOf(S);if(u===-1){console.warn("[Model.removeVariable] Variable not present in model");return}return this.variables.splice(u,1),this.tableauInitialized===!0&&this.tableau.removeVariable(S),this},A.prototype.updateRightHandSide=function(S,u){return this.tableauInitialized===!0&&this.tableau.updateRightHandSide(S,u),this},A.prototype.updateConstraintCoefficient=function(S,u,h){return this.tableauInitialized===!0&&this.tableau.updateConstraintCoefficient(S,u,h),this},A.prototype.setCost=function(S,u){var h=S-u.cost;return this.isMinimization===!1&&(h=-h),u.cost=S,this.tableau.updateCost(u,h),this},A.prototype.loadJson=function(S){this.isMinimization=S.opType!=="max";for(var u=S.variables,h=S.constraints,L={},N={},f=Object.keys(h),M=f.length,p=0;p<M;p+=1){var C=f[p],G=h[C],g=G.equal,O=G.weight,D=G.priority,H=O!==void 0||D!==void 0,v,V;if(g===void 0){var j=G.min;j!==void 0&&(v=this.greaterThan(j),L[C]=v,H&&v.relax(O,D));var Q=G.max;Q!==void 0&&(V=this.smallerThan(Q),N[C]=V,H&&V.relax(O,D))}else{v=this.greaterThan(g),L[C]=v,V=this.smallerThan(g),N[C]=V;var at=new l(v,V);H&&at.relax(O,D)}}var q=Object.keys(u),ht=q.length;this.tolerance=S.tolerance||0,S.timeout&&(this.timeout=S.timeout),S.options&&(S.options.timeout&&(this.timeout=S.options.timeout),this.tolerance===0&&(this.tolerance=S.options.tolerance||0),S.options.useMIRCuts&&(this.useMIRCuts=S.options.useMIRCuts),typeof S.options.exitOnCycles>"u"?this.checkForCycles=!0:this.checkForCycles=S.options.exitOnCycles,S.options.keep_solutions?this.keep_solutions=S.options.keep_solutions:this.keep_solutions=!1);for(var Lt=S.ints||{},Za=S.binaries||{},te=S.unrestricted||{},gc=S.optimize,ae=0;ae<ht;ae+=1){var yt=q[ae],ee=u[yt],ZN=ee[gc]||0,Rc=!!Za[yt],tf=!!Lt[yt]||Rc,af=!!te[yt],se=this.addVariable(ZN,yt,tf,af);Rc&&this.smallerThan(1).addTerm(1,se);var Ic=Object.keys(ee);for(p=0;p<Ic.length;p+=1){var aa=Ic[p];if(aa!==gc){var Dc=ee[aa],Oc=L[aa];Oc!==void 0&&Oc.addTerm(Dc,se);var yc=N[aa];yc!==void 0&&yc.addTerm(Dc,se)}}}return this},A.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},A.prototype.solve=function(){return this.tableauInitialized===!1&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},A.prototype.isFeasible=function(){return this.tableau.feasible},A.prototype.save=function(){return this.tableau.save()},A.prototype.restore=function(){return this.tableau.restore()},A.prototype.activateMIRCuts=function(S){this.useMIRCuts=S},A.prototype.debug=function(S){this.checkForCycles=S},A.prototype.log=function(S){return this.tableau.log(S)}}}),EE=P({"node_modules/@bygdle/javascript-lp-solver/src/Validation.js"(a){a.CleanObjectiveAttributes=function(e){var s,n,i;if(typeof e.optimize=="string")if(e.constraints[e.optimize]){s=Math.random();for(n in e.variables)e.variables[n][e.optimize]&&(e.variables[n][s]=e.variables[n][e.optimize]);return e.constraints[s]=e.constraints[e.optimize],delete e.constraints[e.optimize],e}else return e;else{for(i in e.optimize)if(e.constraints[i])if(e.constraints[i]==="equal")delete e.optimize[i];else{s=Math.random();for(n in e.variables)e.variables[n][i]&&(e.variables[n][s]=e.variables[n][i]);e.constraints[s]=e.constraints[i],delete e.constraints[i]}return e}}}}),ia=P({"node_modules/@bygdle/javascript-lp-solver/src/External/lpsolve/Reformat.js"(a,e){function s(i){var l={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},E={opType:"",optimize:"_obj",constraints:{},variables:{}},_={">=":"min","<=":"max","=":"equal"},A="",S=null,u="",h="",L="",N=0;typeof i=="string"&&(i=i.split(`
`));for(var f=0;f<i.length;f++)if(L="__"+f,A=i[f],S=null,l.is_objective.test(A))E.opType=A.match(/(max|min)/gi)[0],S=A.match(l.parse_lhs).map(function(C){return C.replace(/\s+/,"")}).slice(1),S.forEach(function(C){u=C.match(l.get_num),u===null?C.substr(0,1)==="-"?u=-1:u=1:u=u[0],u=parseFloat(u),h=C.match(l.get_word)[0].replace(/\;$/,""),E.variables[h]=E.variables[h]||{},E.variables[h]._obj=u});else if(l.is_int.test(A))S=A.match(l.parse_int).slice(1),E.ints=E.ints||{},S.forEach(function(C){C=C.replace(";",""),E.ints[C]=1});else if(l.is_bin.test(A))S=A.match(l.parse_bin).slice(1),E.binaries=E.binaries||{},S.forEach(function(C){C=C.replace(";",""),E.binaries[C]=1});else if(l.is_constraint.test(A)){var M=A.indexOf(":"),p=M===-1?A:A.slice(M+1);S=p.match(l.parse_lhs).map(function(C){return C.replace(/\s+/,"")}),S.forEach(function(C){u=C.match(l.get_num),u===null?C.substr(0,1)==="-"?u=-1:u=1:u=u[0],u=parseFloat(u),h=C.match(l.get_word)[0],E.variables[h]=E.variables[h]||{},E.variables[h][L]=u}),N=parseFloat(A.match(l.parse_rhs)[0]),A=_[A.match(l.parse_dir)[0]],E.constraints[L]=E.constraints[L]||{},E.constraints[L][A]=N}else l.is_unrestricted.test(A)&&(S=A.match(l.parse_int).slice(1),E.unrestricted=E.unrestricted||{},S.forEach(function(C){C=C.replace(";",""),E.unrestricted[C]=1}));return E}function n(i){if(!i)throw new Error("Solver requires a model to operate on");var l="",E={max:"<=",min:">=",equal:"="},_=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(i.opType){l+=i.opType+":";for(var A in i.variables)i.variables[A][A]=i.variables[A][A]?i.variables[A][A]:1,i.variables[A][i.optimize]&&(l+=" "+i.variables[A][i.optimize]+" "+A.replace(_,"_"))}else l+="max:";l+=`;

`;for(var S in i.constraints)for(var u in i.constraints[S])if(typeof E[u]<"u"){for(var h in i.variables)typeof i.variables[h][S]<"u"&&(l+=" "+i.variables[h][S]+" "+h.replace(_,"_"));l+=" "+E[u]+" "+i.constraints[S][u],l+=`;
`}if(i.ints){l+=`

`;for(var L in i.ints)l+="int "+L.replace(_,"_")+`;
`}if(i.unrestricted){l+=`

`;for(var N in i.unrestricted)l+="unrestricted "+N.replace(_,"_")+`;
`}return l}e.exports=function(i){return i.length?s(i):n(i)}}}),TE=P({"node_modules/@bygdle/javascript-lp-solver/src/External/lpsolve/main.js"(a){a.reformat=ia(),a.solve=function(e){return new Promise(function(s,n){typeof window<"u"&&n("Function Not Available in Browser"),ia()(e),e.external||n("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),e.external.binPath||n("No Executable | Binary path provided in arguments as 'binPath'"),e.external.args||n("No arguments array for cli | bash provided on 'args' attribute"),e.external.tempName||n("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on")})}}}),_E=P({"node_modules/@bygdle/javascript-lp-solver/src/External/main.js"(a,e){e.exports={lpsolve:TE()}}}),fe=P({"node_modules/@bygdle/javascript-lp-solver/src/Polyopt.js"(a,e){e.exports=function(s,n){var i=n.optimize,l=JSON.parse(JSON.stringify(n.optimize)),E=Object.keys(n.optimize),_,A=0,S={},u="",h={},L=[],N,f,M,p;for(delete n.optimize,N=0;N<E.length;N++)l[E[N]]=0;for(N=0;N<E.length;N++){n.optimize=E[N],n.opType=i[E[N]],_=s.Solve(n,void 0,void 0,!0);for(p in E)if(!n.variables[E[p]]){_[E[p]]=_[E[p]]?_[E[p]]:0;for(M in n.variables)n.variables[M][E[p]]&&_[M]&&(_[E[p]]+=_[M]*n.variables[M][E[p]])}for(u="base",f=0;f<E.length;f++)_[E[f]]?u+="-"+(_[E[f]]*1e3|0)/1e3:u+="-0";if(!S[u]){for(S[u]=1,A++,f=0;f<E.length;f++)_[E[f]]&&(l[E[f]]+=_[E[f]]);delete _.feasible,delete _.result,L.push(_)}}for(N=0;N<E.length;N++)n.constraints[E[N]]={equal:l[E[N]]/A};n.optimize="cheater-"+Math.random(),n.opType="max";for(N in n.variables)n.variables[N].cheater=1;for(N in L)for(M in L[N])h[M]=h[M]||{min:1e99,max:-1e99};for(N in h)for(M in L)L[M][N]?(L[M][N]>h[N].max&&(h[N].max=L[M][N]),L[M][N]<h[N].min&&(h[N].min=L[M][N])):(L[M][N]=0,h[N].min=0);return _=s.Solve(n,void 0,void 0,!0),{midpoint:_,vertices:L,ranges:h}}}}),AE=P({"node_modules/@bygdle/javascript-lp-solver/src/main.js"(a,e){var s=oE(),n=cE(),i=Ne(),l=na(),E=EE(),_=l.Constraint,A=l.Variable,S=l.Numeral,u=l.Term,h=_E(),L=function(){this.Model=n,this.branchAndCut=i,this.Constraint=_,this.Variable=A,this.Numeral=S,this.Term=u,this.Tableau=s,this.lastSolvedModel=null,this.External=h,this.ReformatLP=ia(),this.MultiObjective=function(N){return fe()(this,N)}};L.prototype.Solve=function(N,f,M,p){if(p)for(var C in E)N=E[C](N);if(!N)throw new Error("Solver requires a model to operate on");if(typeof N.optimize=="object"&&Object.keys(N.optimize>1))return fe()(this,N);if(N.external){var G=Object.keys(h);if(G=JSON.stringify(G),!N.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+G);if(!h[N.external.solver])throw new Error("No support (yet) for "+N.external.solver+". Please use one of these instead:"+G);return h[N.external.solver].solve(N)}else{N instanceof n||(N=new n(f).loadJson(N));var g=N.solve();if(g.solutionSet=g.generateSolutionSet(),M)return g;var O={};return O.feasible=g.feasible,O.result=g.evaluation,O.bounded=g.bounded,g._tableau.__isIntegral&&(O.isIntegral=!0),Object.keys(g.solutionSet).forEach(function(D){g.solutionSet[D]!==0&&(O[D]=g.solutionSet[D])}),O}},typeof define=="function"?define([],function(){return new L}):typeof window=="object"?window.solver=new L:typeof self=="object"&&(self.solver=new L),e.exports=new L}}),Pt={};R(Pt,{Runner:()=>Wa,api:()=>mc,artbox:()=>_t,artifact:()=>I,character:()=>me,characters:()=>At,charbox:()=>d,cmd2:()=>Ls,effect:()=>r,effects:()=>Xt,enemy:()=>Me,food:()=>Mt,foods:()=>It,formula:()=>Oe,instance:()=>_s,optimizer:()=>Sc,resonances:()=>us,rotation:()=>jt,scaling:()=>o,sets:()=>Z,stats:()=>t,store:()=>Ot,strings:()=>T,subject:()=>ge,utils:()=>dc,weapon:()=>m,weapons:()=>nt,worker:()=>Jo});var me={};R(me,{Character:()=>fa,Export:()=>Es,Import:()=>Ts});var Me={};R(Me,{Enemy:()=>Re,EnemyConnector:()=>Ie,EnemyEvent:()=>ot,Export:()=>Aa,Import:()=>Kt});var t={};R(t,{AuraToDmg:()=>Ta,DmgToAtkFlat:()=>oa,DmgToAtkPercent:()=>ra,DmgToAura:()=>hE,DmgToCritDmg:()=>Ea,DmgToCritRate:()=>ca,DmgToFlatDmg:()=>la,DmgToRes:()=>Bt,Elements:()=>Nt,FlatStats:()=>Ge,Mainstats:()=>SE,PieceToMainstats:()=>_a,Substats:()=>Gt,Swirlable:()=>uE,TrToDmg:()=>de,aura:()=>x,piece:()=>$,region:()=>pe,stat:()=>c,weapon:()=>Ce});function st(...a){const e={},s={};let n=0;for(const i of a)e[i]=n,s[n]=i,n++;return et(z({},e),{Get(i){const l=e[i];if(l===void 0)throw new Error(`Stat not found: ${i}`);return l},Name(i){const l=s[i];if(l===void 0)throw new Error(`Stat not found: ${i}`);return l},Has(i){return Object.keys(e).includes(i)},Values(){return Object.values(e)},Length(){return a.length}})}var c=st("NONE","SHIELDED","ATK","ATK_BASE","ATK_PERCENT","ATK_FLAT","HP_CURRENT","HP","HP_BASE","HP_PERCENT","HP_FLAT","DEF","DEF_BASE","DEF_PERCENT","DEF_FLAT","ENERGY_CURRENT","ELEMENTAL_MASTERY","ENERGY_RECHARGE","HEALING_BONUS","CRIT_RATE","EXTRA_CRIT_RATE","CRIT_DMG","ALL_DMG","DEFIGNORED","DEFREDUCTION","DMG_FLAT","PYRO_DMG","CRYO_DMG","HYDRO_DMG","ELECTRO_DMG","ANEMO_DMG","GEO_DMG","DENDRO_DMG","PHYSICAL_DMG","PYRO_DMG_FLAT","CRYO_DMG_FLAT","HYDRO_DMG_FLAT","ELECTRO_DMG_FLAT","ANEMO_DMG_FLAT","GEO_DMG_FLAT","DENDRO_DMG_FLAT","PHYSICAL_DMG_FLAT","MELT_DMG","VAPORIZE_DMG","SWIRL_DMG","OVERLOAD_DMG","ELECTROCHARGE_DMG","SUPERCONDUCT_DMG","SHATTER_DMG","AGGRAVATE_DMG","SPREAD_DMG","BLOOM_DMG","HYPERBLOOM_DMG","BURGEON_DMG","BURNING_DMG","NORMAL_ATTACK_DMG","CHARGED_ATTACK_DMG","AIMED_SHOT_DMG","CHARGED_AIMED_SHOT_DMG","PLUNGE_ATTACK_DMG","ELEMENTAL_SKILL_DMG","ELEMENTAL_BURST_DMG","NORMAL_ATTACK_DMG_FLAT","CHARGED_ATTACK_DMG_FLAT","AIMED_SHOT_DMG_FLAT","CHARGED_AIMED_SHOT_DMG_FLAT","PLUNGE_ATTACK_DMG_FLAT","ELEMENTAL_SKILL_DMG_FLAT","ELEMENTAL_BURST_DMG_FLAT","NORMAL_ATTACK_LEVEL","ELEMENTAL_SKILL_LEVEL","ELEMENTAL_BURST_LEVEL","NORMAL_ATTACK_LEVEL_UP","ELEMENTAL_SKILL_LEVEL_UP","ELEMENTAL_BURST_LEVEL_UP","NORMAL_ATTACK_ATK_PERCENT","CHARGED_ATTACK_ATK_PERCENT","PLUNGE_ATTACK_ATK_PERCENT","AIMED_SHOT_ATK_PERCENT","CHARGED_AIMED_SHOT_ATK_PERCENT","ELEMENTAL_SKILL_ATK_PERCENT","ELEMENTAL_BURST_ATK_PERCENT","PYRO_ATK_PERCENT","CRYO_ATK_PERCENT","ELECTRO_ATK_PERCENT","HYDRO_ATK_PERCENT","GEO_ATK_PERCENT","ANEMO_ATK_PERCENT","DENDRO_ATK_PERCENT","PHYSICAL_ATK_PERCENT","NORMAL_ATTACK_ATK_FLAT","CHARGED_ATTACK_ATK_FLAT","PLUNGE_ATTACK_ATK_FLAT","AIMED_SHOT_ATK_FLAT","CHARGED_AIMED_SHOT_ATK_FLAT","ELEMENTAL_SKILL_ATK_FLAT","ELEMENTAL_BURST_ATK_FLAT","PYRO_ATK_FLAT","CRYO_ATK_FLAT","ELECTRO_ATK_FLAT","HYDRO_ATK_FLAT","GEO_ATK_FLAT","ANEMO_ATK_FLAT","DENDRO_ATK_FLAT","PHYSICAL_ATK_FLAT","NORMAL_ATTACK_CRIT_RATE","CHARGED_ATTACK_CRIT_RATE","PLUNGE_ATTACK_CRIT_RATE","AIMED_SHOT_CRIT_RATE","CHARGED_AIMED_SHOT_CRIT_RATE","ELEMENTAL_SKILL_CRIT_RATE","ELEMENTAL_BURST_CRIT_RATE","PYRO_CRIT_RATE","CRYO_CRIT_RATE","ELECTRO_CRIT_RATE","HYDRO_CRIT_RATE","GEO_CRIT_RATE","ANEMO_CRIT_RATE","DENDRO_CRIT_RATE","PHYSICAL_CRIT_RATE","NORMAL_ATTACK_CRIT_DMG","CHARGED_ATTACK_CRIT_DMG","PLUNGE_ATTACK_CRIT_DMG","AIMED_SHOT_CRIT_DMG","CHARGED_AIMED_SHOT_CRIT_DMG","ELEMENTAL_SKILL_CRIT_DMG","ELEMENTAL_BURST_CRIT_DMG","PYRO_CRIT_DMG","CRYO_CRIT_DMG","ELECTRO_CRIT_DMG","HYDRO_CRIT_DMG","GEO_CRIT_DMG","ANEMO_CRIT_DMG","DENDRO_CRIT_DMG","PHYSICAL_CRIT_DMG","LEVEL","ASCENSION","PYRO_RES","CRYO_RES","ELECTRO_RES","HYDRO_RES","GEO_RES","ANEMO_RES","DENDRO_RES","PHYSICAL_RES"),x=st("NONE","PYRO","CRYO","HYDRO","ELECTRO","DENDRO","FROZEN","QUICKEN"),Ce=st("SWORD","CLAYMORE","POLEARM","CATALYST","BOW"),$=st("FLOWER","PLUME","SANDS","GOBLET","CIRCLET"),pe=st("NONE","MONDSTADT","LIYUE","INAZUMA","SUMERU","FONTAINE","NATLAN","SNEZHNAYA","KHAENRIAH"),Nt=[c.PYRO_DMG,c.CRYO_DMG,c.HYDRO_DMG,c.ELECTRO_DMG,c.ANEMO_DMG,c.GEO_DMG,c.DENDRO_DMG,c.PHYSICAL_DMG],SE=[c.HP_FLAT,c.ATK_FLAT,c.ATK_PERCENT,c.HP_PERCENT,c.DEF_PERCENT,c.ENERGY_RECHARGE,c.ELEMENTAL_MASTERY,c.PYRO_DMG,c.CRYO_DMG,c.HYDRO_DMG,c.ELECTRO_DMG,c.ANEMO_DMG,c.GEO_DMG,c.DENDRO_DMG,c.PHYSICAL_DMG,c.CRIT_RATE,c.CRIT_DMG,c.HEALING_BONUS],Gt=[c.DEF_FLAT,c.HP_FLAT,c.ATK_FLAT,c.ATK_PERCENT,c.HP_PERCENT,c.DEF_PERCENT,c.ENERGY_RECHARGE,c.ELEMENTAL_MASTERY,c.CRIT_RATE,c.CRIT_DMG],Ge=[c.SHIELDED,c.DEF,c.DEF_BASE,c.DEF_FLAT,c.HP,c.HP_BASE,c.HP_FLAT,c.ATK,c.ATK_BASE,c.ATK_FLAT,c.ELEMENTAL_MASTERY,c.DMG_FLAT,c.LEVEL,c.ASCENSION,c.NORMAL_ATTACK_LEVEL,c.ELEMENTAL_SKILL_LEVEL,c.ELEMENTAL_BURST_LEVEL,c.NORMAL_ATTACK_LEVEL_UP,c.ELEMENTAL_SKILL_LEVEL_UP,c.ELEMENTAL_BURST_LEVEL_UP,c.NORMAL_ATTACK_ATK_FLAT,c.CHARGED_ATTACK_ATK_FLAT,c.PLUNGE_ATTACK_ATK_FLAT,c.AIMED_SHOT_ATK_FLAT,c.CHARGED_AIMED_SHOT_ATK_FLAT,c.ELEMENTAL_SKILL_ATK_FLAT,c.ELEMENTAL_BURST_ATK_FLAT,c.PYRO_ATK_FLAT,c.CRYO_ATK_FLAT,c.ELECTRO_ATK_FLAT,c.HYDRO_ATK_FLAT,c.GEO_ATK_FLAT,c.ANEMO_ATK_FLAT,c.DENDRO_ATK_FLAT,c.PHYSICAL_DMG_FLAT,c.NORMAL_ATTACK_DMG_FLAT,c.CHARGED_ATTACK_DMG_FLAT,c.PLUNGE_ATTACK_DMG_FLAT,c.AIMED_SHOT_DMG_FLAT,c.CHARGED_AIMED_SHOT_DMG_FLAT,c.ELEMENTAL_SKILL_DMG_FLAT,c.ELEMENTAL_BURST_DMG_FLAT,c.PYRO_DMG_FLAT,c.CRYO_DMG_FLAT,c.ELECTRO_DMG_FLAT,c.HYDRO_DMG_FLAT,c.GEO_DMG_FLAT,c.ANEMO_DMG_FLAT,c.DENDRO_DMG_FLAT,c.PHYSICAL_DMG_FLAT],uE=[x.CRYO,x.PYRO,x.HYDRO,x.ELECTRO,x.FROZEN];function ra(a){switch(a){case c.PYRO_DMG:return c.PYRO_ATK_PERCENT;case c.HYDRO_DMG:return c.HYDRO_ATK_PERCENT;case c.CRYO_DMG:return c.CRYO_ATK_PERCENT;case c.ELECTRO_DMG:return c.ELECTRO_ATK_PERCENT;case c.ANEMO_DMG:return c.ANEMO_ATK_PERCENT;case c.GEO_DMG:return c.GEO_ATK_PERCENT;case c.DENDRO_DMG:return c.DENDRO_ATK_PERCENT;case c.PHYSICAL_DMG:return c.PHYSICAL_ATK_PERCENT;case c.NORMAL_ATTACK_DMG:return c.NORMAL_ATTACK_ATK_PERCENT;case c.CHARGED_ATTACK_DMG:return c.CHARGED_ATTACK_ATK_PERCENT;case c.AIMED_SHOT_DMG:return c.AIMED_SHOT_ATK_PERCENT;case c.CHARGED_AIMED_SHOT_DMG:return c.CHARGED_AIMED_SHOT_ATK_PERCENT;case c.PLUNGE_ATTACK_DMG:return c.PLUNGE_ATTACK_ATK_PERCENT;case c.ELEMENTAL_SKILL_DMG:return c.ELEMENTAL_SKILL_ATK_PERCENT;case c.ELEMENTAL_BURST_DMG:return c.ELEMENTAL_BURST_ATK_PERCENT}return c.NONE}function la(a){switch(a){case c.PYRO_DMG:return c.PYRO_DMG_FLAT;case c.HYDRO_DMG:return c.HYDRO_DMG_FLAT;case c.CRYO_DMG:return c.CRYO_DMG_FLAT;case c.ELECTRO_DMG:return c.ELECTRO_DMG_FLAT;case c.ANEMO_DMG:return c.ANEMO_DMG_FLAT;case c.GEO_DMG:return c.GEO_DMG_FLAT;case c.DENDRO_DMG:return c.DENDRO_DMG_FLAT;case c.PHYSICAL_DMG:return c.PHYSICAL_DMG_FLAT;case c.NORMAL_ATTACK_DMG:return c.NORMAL_ATTACK_DMG_FLAT;case c.CHARGED_ATTACK_DMG:return c.CHARGED_ATTACK_DMG_FLAT;case c.AIMED_SHOT_DMG:return c.AIMED_SHOT_DMG_FLAT;case c.CHARGED_AIMED_SHOT_DMG:return c.CHARGED_AIMED_SHOT_DMG_FLAT;case c.PLUNGE_ATTACK_DMG:return c.PLUNGE_ATTACK_DMG_FLAT;case c.ELEMENTAL_SKILL_DMG:return c.ELEMENTAL_SKILL_DMG_FLAT;case c.ELEMENTAL_BURST_DMG:return c.ELEMENTAL_BURST_DMG_FLAT}return c.NONE}function oa(a){switch(a){case c.PYRO_DMG:return c.PYRO_ATK_FLAT;case c.HYDRO_DMG:return c.HYDRO_ATK_FLAT;case c.CRYO_DMG:return c.CRYO_ATK_FLAT;case c.ELECTRO_DMG:return c.ELECTRO_ATK_FLAT;case c.ANEMO_DMG:return c.ANEMO_ATK_FLAT;case c.GEO_DMG:return c.GEO_ATK_FLAT;case c.DENDRO_DMG:return c.DENDRO_ATK_FLAT;case c.PHYSICAL_DMG:return c.PHYSICAL_ATK_FLAT;case c.NORMAL_ATTACK_DMG:return c.NORMAL_ATTACK_ATK_FLAT;case c.CHARGED_ATTACK_DMG:return c.CHARGED_ATTACK_ATK_FLAT;case c.AIMED_SHOT_DMG:return c.AIMED_SHOT_ATK_FLAT;case c.CHARGED_AIMED_SHOT_DMG:return c.CHARGED_AIMED_SHOT_ATK_FLAT;case c.PLUNGE_ATTACK_DMG:return c.PLUNGE_ATTACK_ATK_FLAT;case c.ELEMENTAL_SKILL_DMG:return c.ELEMENTAL_SKILL_ATK_FLAT;case c.ELEMENTAL_BURST_DMG:return c.ELEMENTAL_BURST_ATK_FLAT}return c.NONE}function ca(a){switch(a){case c.PYRO_DMG:return c.PYRO_CRIT_RATE;case c.HYDRO_DMG:return c.HYDRO_CRIT_RATE;case c.CRYO_DMG:return c.CRYO_CRIT_RATE;case c.ELECTRO_DMG:return c.ELECTRO_CRIT_RATE;case c.ANEMO_DMG:return c.ANEMO_CRIT_RATE;case c.GEO_DMG:return c.GEO_CRIT_RATE;case c.DENDRO_DMG:return c.DENDRO_CRIT_RATE;case c.PHYSICAL_DMG:return c.PHYSICAL_CRIT_RATE;case c.NORMAL_ATTACK_DMG:return c.NORMAL_ATTACK_CRIT_RATE;case c.CHARGED_ATTACK_DMG:return c.CHARGED_ATTACK_CRIT_RATE;case c.AIMED_SHOT_DMG:return c.AIMED_SHOT_CRIT_RATE;case c.CHARGED_AIMED_SHOT_DMG:return c.CHARGED_AIMED_SHOT_CRIT_RATE;case c.PLUNGE_ATTACK_DMG:return c.PLUNGE_ATTACK_CRIT_RATE;case c.ELEMENTAL_SKILL_DMG:return c.ELEMENTAL_SKILL_CRIT_RATE;case c.ELEMENTAL_BURST_DMG:return c.ELEMENTAL_BURST_CRIT_RATE}return c.NONE}function Ea(a){switch(a){case c.PYRO_DMG:return c.PYRO_CRIT_DMG;case c.HYDRO_DMG:return c.HYDRO_CRIT_DMG;case c.CRYO_DMG:return c.CRYO_CRIT_DMG;case c.ELECTRO_DMG:return c.ELECTRO_CRIT_DMG;case c.ANEMO_DMG:return c.ANEMO_CRIT_DMG;case c.GEO_DMG:return c.GEO_CRIT_DMG;case c.DENDRO_DMG:return c.DENDRO_CRIT_DMG;case c.PHYSICAL_DMG:return c.PHYSICAL_CRIT_DMG;case c.NORMAL_ATTACK_DMG:return c.NORMAL_ATTACK_CRIT_DMG;case c.CHARGED_ATTACK_DMG:return c.CHARGED_ATTACK_CRIT_DMG;case c.AIMED_SHOT_DMG:return c.AIMED_SHOT_CRIT_DMG;case c.CHARGED_AIMED_SHOT_DMG:return c.CHARGED_AIMED_SHOT_CRIT_DMG;case c.PLUNGE_ATTACK_DMG:return c.PLUNGE_ATTACK_CRIT_DMG;case c.ELEMENTAL_SKILL_DMG:return c.ELEMENTAL_SKILL_CRIT_DMG;case c.ELEMENTAL_BURST_DMG:return c.ELEMENTAL_BURST_CRIT_DMG}return c.NONE}function Bt(a){switch(a){case c.PYRO_DMG:return c.PYRO_RES;case c.HYDRO_DMG:return c.HYDRO_RES;case c.CRYO_DMG:return c.CRYO_RES;case c.ELECTRO_DMG:return c.ELECTRO_RES;case c.ANEMO_DMG:return c.ANEMO_RES;case c.GEO_DMG:return c.GEO_RES;case c.DENDRO_DMG:return c.DENDRO_RES;case c.PHYSICAL_DMG:return c.PHYSICAL_RES}return c.NONE}function Ta(a){switch(a){case x.PYRO:return c.PYRO_DMG;case x.HYDRO:return c.HYDRO_DMG;case x.CRYO:return c.CRYO_DMG;case x.FROZEN:return c.CRYO_DMG;case x.ELECTRO:return c.ELECTRO_DMG;case x.DENDRO:return c.DENDRO_DMG;case x.QUICKEN:return c.DENDRO_DMG}return c.NONE}function hE(a){switch(a){case c.PYRO_DMG:return x.PYRO;case c.HYDRO_DMG:return x.HYDRO;case c.CRYO_DMG:return x.CRYO;case c.ELECTRO_DMG:return x.ELECTRO;case c.DENDRO_DMG:return x.DENDRO}return c.NONE}function de(a){switch(a){case c.OVERLOAD_DMG:return c.PYRO_DMG;case c.ELECTROCHARGE_DMG:return c.ELECTRO_DMG;case c.SUPERCONDUCT_DMG:return c.CRYO_DMG;case c.SHATTER_DMG:return c.PHYSICAL_DMG;case c.BURNING_DMG:return c.PYRO_DMG;case c.BURGEON_DMG:return c.DENDRO_DMG;case c.BLOOM_DMG:return c.DENDRO_DMG;case c.HYPERBLOOM_DMG:return c.DENDRO_DMG}return c.NONE}function _a(a){switch(a){case $.FLOWER:return[c.HP_FLAT];case $.PLUME:return[c.ATK_FLAT];case $.SANDS:return[c.ATK_PERCENT,c.HP_PERCENT,c.DEF_PERCENT,c.ENERGY_RECHARGE,c.ELEMENTAL_MASTERY];case $.GOBLET:return[c.ATK_PERCENT,c.HP_PERCENT,c.DEF_PERCENT,c.ELEMENTAL_MASTERY,...Nt];case $.CIRCLET:return[c.ATK_PERCENT,c.HP_PERCENT,c.DEF_PERCENT,c.ELEMENTAL_MASTERY,c.CRIT_RATE,c.CRIT_DMG,c.HEALING_BONUS]}return[]}var ge={};R(ge,{Subject:()=>it});var it=class{constructor(a,e){this.Title=e,this.props=new Float64Array(a),this.observers=Array.from(Array(a)).fill(0).map(()=>[])}Length(){return this.props.length}Get(a){const e=this.props[a];if(e===void 0)throw new Error(`Subject property out of bounds: ${a}`);return e}Set(a,e,s){return this.props[a]=e,this.Notify(a,s)}Notify(a,e){for(const s of this.observers[a])s.Enabled()&&s.Notify(e);return this}CreateObserver(a,e){let s=!0;const n={prop:a,Enabled(){return s},Enable(){return s=!0,n},Disable(){return s=!1,n},Remove:()=>this.RemoveObserver(n),Notify(i){return e(i),n}};return this.observers[a].push(n),n}RemoveObserver(a){const e=this.observers[a.prop].indexOf(a);return e===-1?!1:(this.observers[a.prop].splice(e,1),!0)}CreateModifier(a,e){let s=!1;const n={Title:this.Title,Enabled(){return s},Enable:()=>(s||(this.Set(a,this.Get(a)+e,n),s=!0),n),Disable:()=>(s&&(this.Set(a,this.Get(a)-e,n),s=!1),n),GetProp(){return a},GetValue(){return e},SetProp(i){const l=s;return n.Disable(),a=i,l&&n.Enable(),n},SetValue(i){const l=s;return n.Disable(),e=i,l&&n.Enable(),n}};return n.Enable(),n}},ot=st("CHANGE_AURA","CHANGE_BASE_RES"),Re=class{constructor(a){this.name=a,this.Event=new it(ot.Length(),"ENEMY_EVENT"),this.Subject=new it(c.Length(),"ENEMY_STATS"),this.auras=[],this.baseMods=Nt.map(e=>this.Subject.CreateModifier(Bt(e),.1)),this.SetLevel(90)}GetLevel(){return this.Subject.Get(c.LEVEL)}SetLevel(a){return this.Subject.Set(c.LEVEL,a),this}Affected(a){for(const e of this.auras)if(Ta(e)===a)return!0;return!1}HasAura(a){return this.auras.includes(a)}SetAuras(...a){return this.auras=a,this.Event.Notify(ot.CHANGE_AURA),this}GetAuras(){return this.auras}GetBaseRes(a){const e=this.baseMods.find(s=>s.GetProp()===a);if(!e)throw new Error(`Cannot find the given RES: ${a}`);return e.GetValue()}SetBaseRes(a,e){const s=this.baseMods.find(n=>n.GetProp()===a);if(!s)throw new Error(`Cannot find the given RES: ${a}`);return s.SetValue(e),this.Event.Notify(ot.CHANGE_BASE_RES),this}};function Aa(a){const e={level:a.GetLevel(),auras:a.GetAuras(),modifiers:[]};for(const s of Nt){const n=Bt(s),i=a.GetBaseRes(n);e.modifiers.push({stat:n,value:i})}return e}function Kt(a,e){e.SetLevel(a.level),e.SetAuras(...a.auras);for(const{stat:s,value:n}of a.modifiers)e.SetBaseRes(s,n)}var Ie=class{constructor(...a){this.members=new Set,this.observers=new Map,this.updating=!1,a.forEach(e=>this.Add(e))}onChange(a){if(this.updating)return;const e=this.state=Aa(a);this.updating=!0;for(const s of this.members)s!==a&&Kt(e,s);this.updating=!1}Add(a){if(this.members.has(a))return!1;const e=this.members.size===0;this.members.add(a),!e&&this.state&&Kt(this.state,a);const s=()=>this.onChange(a);return this.observers.set(a,[a.Subject.CreateObserver(c.LEVEL,s),a.Event.CreateObserver(ot.CHANGE_AURA,s),a.Event.CreateObserver(ot.CHANGE_BASE_RES,s)]),!0}Remove(a){this.members.delete(a);const e=this.observers.get(a);!e||(e.forEach(s=>s.Remove()),this.observers.delete(a))}},bt=[20,40,50,60,70,80,90];function wt(a){a<0?a=0:a>90&&(a=90);for(let e=0;e<bt.length;e++){const s=bt[e];if(a<=s)return e}return 0}function ft(a){a<0?a=0:a>90&&(a=90);for(let e=0;e<bt.length;e++){const s=bt[e];if(a===s){let n=e+1;return n>6&&(n=6),n}else if(a<=s)return e}return 0}var De={[c.PYRO_DMG]:3,[c.CRYO_DMG]:2,[c.ELECTRO_DMG]:1};function LE(a){return[...a].sort((s,n)=>{const i=s.Max?1/0:De[s.Element]||0;return(n.Max?1/0:De[n.Element]||0)-i}).filter(s=>s.Enabled)[0]}var Oe={};R(Oe,{AmpBonus:()=>ts,AmpType:()=>ns,CritAvg:()=>Xe,CritType:()=>ss,Damage:()=>os,DamageOptions:()=>ls,DamageStats:()=>rs,Def:()=>Ze,QuickenBonus:()=>Na,QuickenType:()=>is,Res:()=>Je,Rotation:()=>cs,TotalStat:()=>Rt,TrBase:()=>Yt,TrBonus:()=>as,TrMultiplier:()=>es});var o={};R(o,{ASCENSION_MULTIPLIER:()=>Pe,AddCharacterScaling:()=>be,AddTalentScaling:()=>Ye,BONUS_ASCENSION_MULTIPLIER:()=>Sa,BONUS_STAT_4:()=>Be,BONUS_STAT_5:()=>Ke,CHARACTER_ATTRIBUTE_4:()=>He,CHARACTER_ATTRIBUTE_5:()=>ve,GetMainstatValue:()=>Qe,GetMaxRolls:()=>GE,GetSubstatMax:()=>La,GetSubstatMaxRolls:()=>ha,GetSubstatValue:()=>X,GetWeaponAtkBase:()=>ze,GetWeaponSubstat:()=>qe,SubstatTier:()=>$e,TRANSFORMATIVE:()=>ye,TalentScaling:()=>we,WEAPON_ATK_BASE:()=>Ve,WEAPON_ATK_BASE_ASCENSION_3:()=>xe,WEAPON_ATK_BASE_ASCENSION_4:()=>ke,WEAPON_ATK_BASE_ASCENSION_5:()=>Ue,WEAPON_SUBSTAT_INITIAL:()=>je,WEAPON_SUBSTAT_SCALING:()=>We,WeaponScaling:()=>Fe});function NE(a){return a}var ye=[8.5828025,9.267524,9.952427,10.6374515,11.3227,12.3248065,13.3203215,14.4342935,15.6838395,17.0716715,18.6005,20.33,22.223334,24.2817595,26.87424,29.5409485,32.2100235,34.8622275,37.5615685,40.2923875,43.056014,45.851871,48.622314,51.406322,54.2047815,56.600847,59.051453,61.489659,64.863665,68.146455,71.335425,74.5145145,77.7084935,80.9127475,84.5531565,88.2590385,92.0363705,95.854759,99.778454,103.691021,107.69945,112.0828335,116.75108,121.6752865,128.0315335,134.2717465,140.7630375,147.506824,154.533594,161.8007985,168.378771,175.265156,182.2413525,189.3095905,199.3002085,208.199127,217.193498,226.4755255,236.3031085,246.442445,256.7842715,269.551599,282.7552815,296.2693765,312.2217135,325.735074,339.748415,353.89703,368.335711,382.8201155,397.3867015,412.3386985,425.5788905,438.871045,457.1145615,473.373376,489.705693,505.611511,522.395873,538.721834,554.99877,571.4883075,588.1847415,605.0921965,626.9178295,644.4764005,662.742046,681.728464,702.5486885,723.426729,744.1077735,764.2222835,790.1839555,815.423764,855.5988925,890.2269705,923.6614045,955.7371545,986.432171,1015.035904],He=[1,1.083,1.165,1.248,1.33,1.413,1.495,1.578,1.661,1.743,1.826,1.908,1.991,2.073,2.156,2.239,2.321,2.404,2.486,2.569,2.651,2.734,2.817,2.899,2.982,3.064,3.147,3.229,3.312,3.394,3.477,3.56,3.642,3.725,3.807,3.89,3.972,4.055,4.138,4.22,4.303,4.385,4.468,4.55,4.633,4.716,4.798,4.881,4.963,5.046,5.128,5.211,5.294,5.376,5.459,5.541,5.624,5.706,5.789,5.872,5.954,6.037,6.119,6.202,6.284,6.367,6.45,6.532,6.615,6.697,6.78,6.862,6.945,7.028,7.11,7.193,7.275,7.358,7.44,7.523,7.606,7.688,7.771,7.853,7.936,8.018,8.101,8.183,8.266,8.349],ve=[1,1.083,1.166,1.25,1.333,1.417,1.5,1.584,1.668,1.751,1.835,1.919,2.003,2.088,2.172,2.256,2.341,2.425,2.51,2.594,2.679,2.764,2.849,2.934,3.019,3.105,3.19,3.275,3.361,3.446,3.532,3.618,3.704,3.789,3.875,3.962,4.048,4.134,4.22,4.307,4.393,4.48,4.567,4.653,4.74,4.827,4.914,5.001,5.089,5.176,5.263,5.351,5.438,5.526,5.614,5.702,5.79,5.878,5.966,6.054,6.142,6.23,6.319,6.407,6.496,6.585,6.673,6.762,6.851,6.94,7.029,7.119,7.208,7.297,7.387,7.476,7.566,7.656,7.746,7.836,7.926,8.016,8.106,8.196,8.286,8.377,8.467,8.558,8.649,8.739],Pe=[38/182,65/182,101/182,128/182,155/182,1],Sa=[0,1,2,2,3,4],Be={[c.ATK_PERCENT]:.06,[c.HP_PERCENT]:.06,[c.DEF_PERCENT]:.075,[c.PHYSICAL_DMG]:.075,[c.ENERGY_RECHARGE]:.067,[c.ELEMENTAL_MASTERY]:24,[c.PYRO_DMG]:.06,[c.CRYO_DMG]:.06,[c.HYDRO_DMG]:.06,[c.ELECTRO_DMG]:.06,[c.ANEMO_DMG]:.06,[c.GEO_DMG]:.06,[c.DENDRO_DMG]:.06,[c.PHYSICAL_DMG]:.06},Ke={[c.ATK_PERCENT]:.072,[c.HP_PERCENT]:.072,[c.PHYSICAL_DMG]:0,[c.ENERGY_RECHARGE]:.08,[c.ELEMENTAL_MASTERY]:28.8,[c.HEALING_BONUS]:.055,[c.CRIT_RATE]:.048,[c.CRIT_DMG]:.096,[c.PYRO_DMG]:.072,[c.CRYO_DMG]:.072,[c.HYDRO_DMG]:.072,[c.ELECTRO_DMG]:.072,[c.ANEMO_DMG]:.072,[c.GEO_DMG]:.072,[c.DENDRO_DMG]:.072,[c.PHYSICAL_DMG]:.072};function be(a,e){const s=a.CreateModifier(c.ATK_BASE,0),n=a.CreateModifier(c.DEF_BASE,0),i=a.CreateModifier(c.HP_BASE,0),l=a.CreateModifier(e.StatBonus,0);e.Scaling||(a.Options.Stars===4?e.Scaling=He:e.Scaling=ve);const E=e.Scaling,_=()=>{s.SetValue(ua(E,e.AtkBase[0],e.AtkBase[1],a.GetLevel(),a.GetAscension())),n.SetValue(ua(E,e.DefBase[0],e.DefBase[1],a.GetLevel(),a.GetAscension())),i.SetValue(ua(E,e.HpBase[0],e.HpBase[1],a.GetLevel(),a.GetAscension())),l.SetValue(ME(a.Options.Stars,e.StatBonus,a.GetAscension()))};return _(),a.CreateObserver(c.LEVEL,_),a.CreateObserver(c.ASCENSION,_),a}function fE(a,e){return a[e-1]}function mE(a){const e=a-1;return e<0?0:Pe[e]}function ua(a,e,s,n,i){return e*fE(a,n)+s*mE(i)}function ME(a,e,s){const n=s-1;return n<0?0:a===4?Be[e]*Sa[n]:Ke[e]*Sa[n]}var we={NONE:Array.from(Array(15)).fill(1),PHYSICAL_1:[1,1.081,1.163,1.279,1.36,1.453,1.581,1.709,1.837,1.977,2.116,2.256,2.395,2.535,2.674],PHYSICAL_1A:[1,1.081,1.163,1.279,1.36,1.453,1.581,1.709,1.837,1.977,2.137,2.325,2.513,2.701,2.906],PHYSICAL_2:[1,1.068,1.136,1.227,1.295,1.375,1.477,1.58,1.682,1.784,1.886,1.989,2.091,2.193,2.295],ELEMENTAL_1:[1,1.075,1.15,1.25,1.325,1.4,1.5,1.6,1.7,1.8,1.9,2,2.125,2.25,2.375],ELEMENTAL_1A:[1,1.075,1.15,1.25,1.325,1.4,1.5,1.6,1.7,1.8,1.904,2.04,2.176,2.312,2.448],ELEMENTAL_2:[1,1.06,1.12,1.198,1.257,1.317,1.395,1.473,1.551,1.629,1.707,1.784,1.862,1.94,2.018],FLAT_1:[1,1.1,1.208,1.325,1.45,1.583,1.725,1.875,2.033,2.2,2.375,2.559,2.75,2.95,3.159]};function Ye(a,e){const s=[],n=a.Base.CreateMv(e.Stat,0),i=()=>{let E=a.Get(e.Talent);E<1?E=1:E>15&&(E=15),n.Value=e.Initial*e.Scaling[E-1]};i();const l=a.Character;switch(s.push(l.CreateObserver(e.Talent,i)),e.Talent){case c.NORMAL_ATTACK_LEVEL:s.push(l.CreateObserver(c.NORMAL_ATTACK_LEVEL_UP,i));break;case c.ELEMENTAL_SKILL_LEVEL:s.push(l.CreateObserver(c.ELEMENTAL_SKILL_LEVEL_UP,i));break;case c.ELEMENTAL_BURST_LEVEL:s.push(l.CreateObserver(c.ELEMENTAL_BURST_LEVEL_UP,i));break}return s}var Fe=(a=>(a[a.TYPE_38=0]="TYPE_38",a[a.TYPE_39=1]="TYPE_39",a[a.TYPE_40=2]="TYPE_40",a[a.TYPE_39b=3]="TYPE_39b",a[a.TYPE_41=4]="TYPE_41",a[a.TYPE_42=5]="TYPE_42",a[a.TYPE_44=6]="TYPE_44",a[a.TYPE_45=7]="TYPE_45",a[a.TYPE_44b=8]="TYPE_44b",a[a.TYPE_46=9]="TYPE_46",a[a.TYPE_48=10]="TYPE_48",a[a.TYPE_49=11]="TYPE_49",a))(Fe||{}),Ve={[0]:[37.6075,40.13116315789474,42.65482631578948,45.17848947368421,47.70215263157895,50.225815789473685,52.749478947368424,55.27314210526316,57.79680526315789,60.32046842105264,62.84413157894737,65.36779473684211,67.89145789473685,70.41512105263158,72.93878421052631,75.46244736842105,77.9861105263158,80.50977368421053,83.03343684210526,85.5571,87.86808,90.17906,92.49004000000001,94.80102000000001,97.11200000000001,99.42298000000001,101.73396,104.04494,106.35592,108.6669,110.97788,113.28886,115.59984,117.91082,120.2218,122.53278,124.84376,127.15474,129.46572,131.7767,133.97050000000002,136.1643,138.3581,140.5519,142.7457,144.9395,147.1333,149.3271,151.52089999999998,153.7147,155.86208,158.00946,160.15684,162.30422,164.45159999999998,166.59898,168.74636,170.89374,173.04112,175.1885,177.28829000000002,179.38808,181.48787,183.58766,185.68745,187.78724,189.88702999999998,191.98682,194.08661,196.1864,198.26233,200.33826,202.41419,204.49012,206.56605,208.64198,210.71791,212.79384,214.86977,216.9457,218.98907,221.03243999999998,223.07581,225.11918,227.16255,229.20592,231.24929,233.29266,235.33603,237.3794],[1]:[38.7413,41.636700000000005,44.5321,47.4275,50.322900000000004,53.2183,56.1137,59.009100000000004,61.9045,64.79990000000001,67.6953,70.5907,73.4861,76.3815,79.27690000000001,82.1723,85.0677,87.9631,90.85849999999999,93.7539,96.5549,99.3559,102.15690000000001,104.9579,107.7589,110.5599,113.3609,116.1619,118.96289999999999,121.7639,124.5649,127.3659,130.1669,132.9679,135.7689,138.5699,141.3709,144.1719,146.97289999999998,149.7739,152.50678,155.23966,157.97254,160.70542,163.4383,166.17118,168.90406,171.63694,174.36982,177.1027,179.81459,182.52648,185.23837,187.95026,190.66215,193.37403999999998,196.08593,198.79782,201.50970999999998,204.2216,206.90025,209.5789,212.25755,214.9362,217.61485,220.2935,222.97215,225.6508,228.32945,231.0081,233.68512,236.36214,239.03916,241.71618,244.3932,247.07022,249.74724,252.42426,255.10128,257.7783,260.42983,263.08136,265.73289,268.38442000000003,271.03595,273.68748,276.33901000000003,278.99054,281.64207000000005,284.2936],[2]:[39.8751,43.142757894736846,46.41041578947369,49.67807368421053,52.945731578947374,56.21338947368422,59.48104736842105,62.748705263157895,66.01636315789474,69.28402105263157,72.55167894736843,75.81933684210526,79.0869947368421,82.35465263157894,85.62231052631579,88.88996842105263,92.15762631578947,95.42528421052631,98.69294210526316,101.9606,105.248305,108.53601,111.82371499999999,115.11142,118.399125,121.68683,124.974535,128.26224,131.549945,134.83765,138.125355,141.41306,144.700765,147.98847,151.276175,154.56387999999998,157.851585,161.13929,164.426995,167.7147,170.99041,174.26612,177.54183,180.81754,184.09325,187.36896000000002,190.64467,193.92038,197.19609,200.4718,203.74953,207.02726,210.30499,213.58272,216.86045000000001,220.13818,223.41591,226.69364,229.97137,233.2491,236.51284,239.77658,243.04032,246.30406,249.5678,252.83154000000002,256.09528,259.35902,262.62276,265.8865,269.15626000000003,272.42602,275.69578,278.96554,282.2353,285.50506,288.77482,292.04458,295.31433999999996,298.5841,301.84785,305.1116,308.37534999999997,311.6391,314.90285,318.1666,321.43035000000003,324.6941,327.95785,331.2216],[3]:[38.7413,41.636700000000005,44.5321,47.4275,50.322900000000004,53.2183,56.1137,59.009100000000004,61.9045,64.79990000000001,67.6953,70.5907,73.4861,76.3815,79.27690000000001,82.1723,85.0677,87.9631,90.85849999999999,93.7539,96.5549,99.3559,102.15690000000001,104.9579,107.7589,110.5599,113.3609,116.1619,118.96289999999999,121.7639,124.5649,127.3659,130.1669,132.9679,135.7689,138.5699,141.3709,144.1719,146.97289999999998,149.7739,152.52678,155.27966,158.03253999999998,160.78542,163.5383,166.29118,169.04406,171.79693999999998,174.54981999999998,177.3027,180.01459,182.72647999999998,185.43837,188.15026,190.86214999999999,193.57404,196.28593,198.99782000000002,201.70971,204.4216,207.11025,209.7989,212.48755,215.1762,217.86485,220.55349999999999,223.24215,225.9308,228.61945,231.3081,233.99512,236.68214,239.36916,242.05617999999998,244.7432,247.43022,250.11723999999998,252.80425999999997,255.49128,258.1783,260.83983,263.50136,266.16289,268.82442,271.48595,274.14748000000003,276.80901,279.47054,282.13207,284.7936],[4]:[41.0671,44.129842105263165,47.19258421052632,50.255326315789475,53.31806842105264,56.3808105263158,59.44355263157895,62.50629473684211,65.56903684210528,68.63177894736843,71.69452105263159,74.75726315789476,77.8200052631579,80.88274736842106,83.94548947368422,87.00823157894737,90.07097368421054,93.13371578947368,96.19645789473685,99.2592,102.18523,105.11126,108.03729000000001,110.96332000000001,113.88935000000001,116.81538,119.74141,122.66744,125.59347,128.5195,131.44553,134.37156,137.29759,140.22361999999998,143.14965,146.07568,149.00171,151.92774,154.85377,157.7798,160.65627999999998,163.53276,166.40924,169.28572,172.16219999999998,175.03868,177.91516000000001,180.79164,183.66812,186.5446,189.38234,192.22008,195.05782,197.89556,200.73329999999999,203.57103999999998,206.40878,209.24652,212.08426,214.922,217.7351,220.5482,223.3613,226.1744,228.9875,231.8006,234.6137,237.4268,240.2399,243.053,245.86377,248.67454,251.48531,254.29608000000002,257.10685,259.91762,262.72839,265.53916000000004,268.34993000000003,271.1607,273.94095000000004,276.7212,279.50145,282.2817,285.06195,287.8422,290.62244999999996,293.4027,296.18295,298.9632],[5]:[42.401,45.90243157894737,49.40386315789474,52.90529473684211,56.40672631578948,59.908157894736846,63.40958947368421,66.91102105263158,70.41245263157894,73.91388421052632,77.41531578947368,80.91674736842106,84.41817894736842,87.91961052631578,91.42104210526315,94.92247368421053,98.42390526315789,101.92533684210525,105.42676842105263,108.9282,112.42840000000001,115.9286,119.4288,122.929,126.42920000000001,129.9294,133.4296,136.9298,140.43,143.9302,147.4304,150.9306,154.4308,157.93099999999998,161.4312,164.9314,168.4316,171.9318,175.432,178.9322,182.44453,185.95686,189.46919,192.98152,196.49385,200.00618,203.51851,207.03083999999998,210.54317,214.0555,217.55782,221.06014,224.56246,228.06477999999998,231.56709999999998,235.06941999999998,238.57174,242.07406,245.57638,249.0787,252.57677999999999,256.07486,259.57294,263.07102,266.5691,270.06718,273.56526,277.06334000000004,280.56142,284.0595,287.57182,291.08414,294.59646000000004,298.10878,301.6211,305.13342,308.64574,312.15806000000003,315.67038,319.1827,322.68503,326.18736,329.68969000000004,333.19202,336.69435,340.19668,343.69901000000004,347.20134,350.70367,354.206],[6]:[43.7349,47.67334210526316,51.61178421052632,55.55022631578947,59.48866842105264,63.42711052631579,67.36555263157895,71.30399473684211,75.24243684210526,79.18087894736843,83.11932105263159,87.05776315789474,90.99620526315789,94.93464736842105,98.87308947368422,102.81153157894738,106.74997368421053,110.68841578947368,114.62685789473684,118.5653,122.64139499999999,126.71749,130.793585,134.86968,138.945775,143.02187,147.097965,151.17406,155.250155,159.32625000000002,163.402345,167.47844,171.554535,175.63063,179.706725,183.78282000000002,187.858915,191.93501,196.011105,200.0872,204.23452,208.38183999999998,212.52916,216.67648,220.8238,224.97111999999998,229.11844,233.26576,237.41307999999998,241.5604,245.72395999999998,249.88752,254.05108,258.21464000000003,262.3782,266.54176,270.70532000000003,274.86888,279.03244,283.196,287.38581000000005,291.57562,295.76543000000004,299.95524,304.14505,308.33486000000005,312.52467,316.71448000000004,320.90429,325.0941,329.30702,333.51994,337.73286,341.94578,346.1587,350.37162,354.58454,358.79746,363.01038,367.2233,371.43934,375.65538,379.87142,384.08745999999996,388.3035,392.51954,396.73557999999997,400.95162,405.16765999999996,409.3837],[7]:[45.0687,49.44510526315789,53.82151052631579,58.19791578947368,62.574321052631575,66.95072631578947,71.32713157894736,75.70353684210527,80.07994210526316,84.45634736842105,88.83275263157896,93.20915789473685,97.58556315789474,101.96196842105263,106.33837368421052,110.71477894736842,115.09118421052631,119.4675894736842,123.84399473684209,128.2204,132.87149000000002,137.52258,142.17367000000002,146.82476,151.47585,156.12694,160.77803,165.42912,170.08021,174.7313,179.38239,184.03348,188.68457,193.33566000000002,197.98675,202.63783999999998,207.28893,211.94002,216.59111000000001,221.2422,226.02498,230.80776,235.59054,240.37332,245.15609999999998,249.93887999999998,254.72165999999999,259.50444,264.28722,269.07,273.89686,278.72372,283.55057999999997,288.37744,293.2043,298.03116,302.85802,307.68487999999996,312.51174,317.3386,322.21052,327.08243999999996,331.95436,336.82628,341.6982,346.57012,351.44203999999996,356.31396,361.18588,366.0578,370.97578,375.89376,380.81174,385.72972,390.6477,395.56568,400.48366,405.40164,410.31962,415.2376,420.17714,425.11668,430.05622,434.99575999999996,439.9353,444.87484,449.81437999999997,454.75392,459.69345999999996,464.633],[8]:[44.3358,47.80099473684211,51.26618947368421,54.731384210526315,58.196578947368415,61.66177368421052,65.12696842105262,68.59216315789473,72.05735789473684,75.52255263157895,78.98774736842105,82.45294210526315,85.91813684210526,89.38333157894735,92.84852631578946,96.31372105263156,99.77891578947367,103.24411052631578,106.70930526315789,110.1745,113.601655,117.02881,120.45596499999999,123.88311999999999,127.31027499999999,130.73743,134.164585,137.59174,141.018895,144.44605,147.87320499999998,151.30036,154.72751499999998,158.15467,161.581825,165.00898,168.436135,171.86329,175.290445,178.7176,182.17136,185.62512,189.07888,192.53264000000001,195.9864,199.44016,202.89392,206.34768,209.80144,213.2552,216.74556,220.23592,223.72628,227.21664,230.707,234.19736,237.68772,241.17808000000002,244.66844,248.1588,251.6835,255.2082,258.73290000000003,262.2576,265.7823,269.307,272.8317,276.3564,279.8811,283.4058,286.97039,290.53498,294.09956999999997,297.66416,301.22875,304.79334,308.35793,311.92251999999996,315.48711,319.0517,322.66951,326.28731999999997,329.90513,333.52294,337.14075,340.75856,344.37637,347.99418000000003,351.61199,355.2298],[9]:[45.9364,49.92561578947368,53.914831578947364,57.90404736842105,61.89326315789474,65.88247894736841,69.8716947368421,73.86091052631579,77.85012631578947,81.83934210526316,85.82855789473683,89.81777368421052,93.80698947368421,97.79620526315789,101.78542105263158,105.77463684210525,109.76385263157894,113.75306842105263,117.74228421052632,121.7315,125.849695,129.96789,134.086085,138.20428,142.322475,146.44067,150.558865,154.67706,158.795255,162.91345,167.031645,171.14984,175.268035,179.38623,183.50442500000003,187.62262,191.740815,195.85901,199.97720500000003,204.0954,208.30777,212.52014,216.73251000000002,220.94488,225.15725,229.36962,233.58199,237.79435999999998,242.00673,246.2191,250.51037,254.80164,259.09291,263.38418,267.67545,271.96672,276.25799,280.54926,284.84053,289.1318,293.47739,297.82298,302.16857,306.51416,310.85974999999996,315.20534,319.55093,323.89652,328.24210999999997,332.5877,337.00219,341.41668,345.83117,350.24566,354.66015,359.07464,363.48913,367.90362,372.31811,376.7326,381.2068,385.681,390.1552,394.6294,399.10360000000003,403.5778,408.052,412.5262,417.0004,421.4746],[10]:[47.537,52.05051052631579,56.564021052631574,61.077531578947365,65.59104210526316,70.10455263157894,74.61806315789474,79.13157368421052,83.6450842105263,88.1585947368421,92.6721052631579,97.18561578947367,101.69912631578947,106.21263684210527,110.72614736842104,115.23965789473684,119.75316842105264,124.2666789473684,128.7801894736842,133.2937,138.10207,142.91044,147.71881,152.52718,157.33555,162.14391999999998,166.95229,171.76066,176.56903,181.3774,186.18577,190.99414,195.80250999999998,200.61088,205.41924999999998,210.22762,215.03598999999997,219.84436,224.65273,229.4611,234.43822,239.41534,244.39246,249.36957999999998,254.3467,259.32382,264.30094,269.27806,274.25518,279.2323,284.31925,289.4062,294.49315,299.5801,304.66705,309.754,314.84095,319.9279,325.01485,330.1018,335.27383000000003,340.44586000000004,345.61789,350.78992,355.96195,361.13398,366.30601,371.47803999999996,376.65006999999997,381.8221,387.07493999999997,392.32777999999996,397.58062,402.83346,408.0863,413.33914,418.59198,423.84482,429.09766,434.3505,439.6889,445.0273,450.3657,455.70410000000004,461.0425,466.3809,471.71930000000003,477.0577,482.39610000000005,487.7345],[11]:[49.1377,54.17819473684211,59.218689473684215,64.25918421052631,69.29967894736842,74.34017368421053,79.38066842105263,84.42116315789474,89.46165789473685,94.50215263157895,99.54264736842106,104.58314210526316,109.62363684210527,114.66413157894738,119.70462631578948,124.74512105263159,129.7856157894737,134.8261105263158,139.8666052631579,144.9071,150.40315,155.8992,161.39525,166.8913,172.38735000000003,177.8834,183.37945000000002,188.87550000000002,194.37155,199.8676,205.36365,210.8597,216.35575,221.85180000000003,227.34785,232.84390000000002,238.33995,243.836,249.33205,254.8281,260.56738,266.30666,272.04594,277.78522,283.5245,289.26378,295.00306,300.74233999999996,306.48161999999996,312.2209,318.10776999999996,323.99464,329.88151,335.76838,341.65525,347.54212,353.42899,359.31586,365.20273000000003,371.0896,377.07949,383.06938,389.05927,395.04916000000003,401.03905,407.02894000000003,413.01883,419.00872,424.99861,430.9885,437.09139999999996,443.1943,449.2972,455.4001,461.503,467.6059,473.7088,479.8117,485.9146,492.0175,498.21376999999995,504.41004,510.60631,516.80258,522.99885,529.19512,535.39139,541.5876599999999,547.7839299999999,553.9802]},xe=19.5,ke=25.9,Ue=31.1,We=[1,1.040341234845879,1.0806824696917579,1.1210237045376368,1.1613649393835157,1.2017061742293946,1.2420474090752736,1.2823886439211527,1.3227298787670316,1.3630711136129106,1.4034123484587895,1.4437535833046684,1.4840948181505473,1.5244360529964263,1.5647772878423054,1.6051185226881843,1.6454597575340633,1.6858009923799422,1.7261422272258211,1.7664834620717,1.806904148964199,1.847324835856698,1.887745522749197,1.928166209641696,1.968586896534195,2.009007583426694,2.049428270319193,2.089848957211692,2.130269644104191,2.17069033099669,2.211111017889189,2.251531704781688,2.291952391674187,2.332373078566686,2.372793765459185,2.413214452351684,2.453635139244183,2.494055826136682,2.534476513029181,2.57489719992168,2.615292358123214,2.655687516324748,2.696082674526282,2.7364778327278163,2.77687299092935,2.817268149130884,2.8576633073324182,2.898058465533952,2.9384536237354864,2.97884878193702,3.0192357768865152,3.0596227718360103,3.1000097667855053,3.1403967617350004,3.1807837566844954,3.22117075163399,3.261557746583485,3.30194474153298,3.342331736482475,3.38271873143197,3.423020746682514,3.463322761933058,3.503624777183602,3.543926792434146,3.58422880768469,3.624530822935234,3.664832838185778,3.705134853436322,3.745436868686866,3.78573888393741,3.82613895285716,3.86653902177691,3.90693909069666,3.94733915961641,3.98773922853616,4.02813929745591,4.06853936637566,4.10893943529541,4.14933950421516,4.18973957313491,4.230135108674366,4.270530644213822,4.310926179753277,4.351321715292734,4.3917172508321904,4.432112786371646,4.472508321911102,4.512903857450558,4.553299392990015,4.59369492852947],je={[0]:{[c.ATK_PERCENT]:.10213,[c.HP_PERCENT]:.10213,[c.DEF_PERCENT]:.12747,[c.ELEMENTAL_MASTERY]:40.8,[c.ENERGY_RECHARGE]:.11333,[c.CRIT_RATE]:.068,[c.CRIT_DMG]:.136,[c.PHYSICAL_DMG]:.12747},[1]:{[c.ATK_PERCENT]:.0766,[c.HP_PERCENT]:.0766,[c.DEF_PERCENT]:.0956,[c.ELEMENTAL_MASTERY]:30.6,[c.ENERGY_RECHARGE]:.085,[c.CRIT_RATE]:.051,[c.CRIT_DMG]:.102,[c.PHYSICAL_DMG]:.0956},[3]:{[c.ATK_PERCENT]:.0766,[c.HP_PERCENT]:.0766,[c.DEF_PERCENT]:.0956,[c.ELEMENTAL_MASTERY]:30.6,[c.ENERGY_RECHARGE]:.085,[c.CRIT_RATE]:.051,[c.CRIT_DMG]:.102,[c.PHYSICAL_DMG]:.0956},[2]:{[c.ATK_PERCENT]:.05107,[c.HP_PERCENT]:.05107,[c.DEF_PERCENT]:.06373,[c.ELEMENTAL_MASTERY]:20.4,[c.ENERGY_RECHARGE]:.05667,[c.CRIT_RATE]:.034,[c.CRIT_DMG]:.068,[c.PHYSICAL_DMG]:.06373},[4]:{[c.ATK_PERCENT]:.12,[c.HP_PERCENT]:.12,[c.DEF_PERCENT]:.15013,[c.ELEMENTAL_MASTERY]:48,[c.ENERGY_RECHARGE]:.13333,[c.CRIT_RATE]:.08,[c.CRIT_DMG]:.16,[c.PHYSICAL_DMG]:.15013},[5]:{[c.ATK_PERCENT]:.09,[c.HP_PERCENT]:.09,[c.DEF_PERCENT]:.1126,[c.ELEMENTAL_MASTERY]:36,[c.ENERGY_RECHARGE]:.1,[c.CRIT_RATE]:.06,[c.CRIT_DMG]:.12,[c.PHYSICAL_DMG]:.1126},[6]:{[c.ATK_PERCENT]:.06,[c.HP_PERCENT]:.06,[c.DEF_PERCENT]:.0751,[c.ELEMENTAL_MASTERY]:24,[c.ENERGY_RECHARGE]:.0667,[c.CRIT_RATE]:.04,[c.CRIT_DMG]:.08,[c.PHYSICAL_DMG]:.0751},[8]:{[c.ATK_PERCENT]:.144,[c.HP_PERCENT]:.144,[c.DEF_PERCENT]:.18,[c.ELEMENTAL_MASTERY]:57.6,[c.ENERGY_RECHARGE]:.16,[c.CRIT_RATE]:.096,[c.CRIT_DMG]:.192,[c.PHYSICAL_DMG]:.18},[7]:{[c.ATK_PERCENT]:.03,[c.HP_PERCENT]:.03,[c.DEF_PERCENT]:.03753,[c.ELEMENTAL_MASTERY]:12,[c.ENERGY_RECHARGE]:.03333,[c.CRIT_RATE]:.02,[c.CRIT_DMG]:.04,[c.PHYSICAL_DMG]:.03753},[9]:{[c.ATK_PERCENT]:.108,[c.HP_PERCENT]:.108,[c.DEF_PERCENT]:.135,[c.ELEMENTAL_MASTERY]:43.2,[c.ENERGY_RECHARGE]:.12,[c.CRIT_RATE]:.072,[c.CRIT_DMG]:.144,[c.PHYSICAL_DMG]:.135},[10]:{[c.ATK_PERCENT]:.072,[c.HP_PERCENT]:.072,[c.DEF_PERCENT]:.09,[c.ELEMENTAL_MASTERY]:28.8,[c.ENERGY_RECHARGE]:.08,[c.CRIT_RATE]:.048,[c.CRIT_DMG]:.096,[c.PHYSICAL_DMG]:.09},[11]:{[c.ATK_PERCENT]:.036,[c.HP_PERCENT]:.036,[c.DEF_PERCENT]:.045,[c.ELEMENTAL_MASTERY]:14.4,[c.ENERGY_RECHARGE]:.04,[c.CRIT_RATE]:.024,[c.CRIT_DMG]:.048,[c.PHYSICAL_DMG]:.045}};function ze(a,e,s,n){if(s<1||s>90)throw new Error("Weapon level must be between 1 and 90");if(n<0||n>6)throw new Error("Weapon ascension must be between 0 and 6");let i;if(a===5)i=Ue;else if(a===4)i=ke;else if(a===3)i=xe;else throw new Error("Weapon stars must be 3, 4 or 5.");return Ve[e][s-1]+i*n}function qe(a,e,s){const n=We[e-1];return(je[a][s]||0)*n}function Qe(a,e,s){return a===5?CE[e][s]:pE[e][s]}var CE={[c.HP_FLAT]:[717,920,1123,1326,1530,1733,1936,2139,2342,2545,2749,2952,3155,3358,3561,3764,3967,4171,4374,4577,4780],[c.HP_PERCENT]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.ATK_FLAT]:[47,60,73,86,100,113,126,139,152,166,179,192,205,219,232,245,258,272,285,298,311],[c.ATK_PERCENT]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.DEF_PERCENT]:[.087,.112,.137,.162,.186,.211,.236,.261,.286,.31,.335,.36,.385,.409,.434,.459,.484,.508,.533,.558,.583],[c.CRIT_RATE]:[.047,.06,.073,.086,.099,.113,.126,.139,.152,.166,.179,.192,.205,.218,.232,.245,.258,.271,.284,.298,.311],[c.CRIT_DMG]:[.093,.12,.146,.173,.199,.225,.252,.278,.305,.331,.357,.384,.41,.437,.463,.49,.516,.542,.569,.595,.622],[c.ENERGY_RECHARGE]:[.078,.1,.122,.144,.166,.188,.21,.232,.254,.276,.298,.32,.342,.364,.386,.408,.43,.452,.474,.496,.518],[c.HEALING_BONUS]:[.054,.069,.084,.1,.115,.13,.145,.161,.176,.191,.206,.221,.237,.252,.267,.282,.298,.313,.328,.343,.359],[c.ELEMENTAL_MASTERY]:[28,35.9,43.8,51.8,59.7,67.6,75.5,83.5,91.4,99.3,107.2,115.2,123.1,131,138.9,146.9,154.8,162.7,170.6,178.6,186.5],[c.ANEMO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.GEO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.CRYO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.PYRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.HYDRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.ELECTRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.DENDRO_DMG]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387,.407,.427,.446,.466],[c.PHYSICAL_DMG]:[.087,.112,.137,.162,.186,.211,.236,.261,.286,.31,.335,.36,.385,.409,.434,.459,.484,.508,.533,.558,.583]},pE={[c.HP_FLAT]:[645,828,1011,1194,1377,1559,1742,1925,2108,2291,2474,2657,2839,3022,3205,3388,3571],[c.HP_PERCENT]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.ATK_FLAT]:[42,54,66,78,90,102,113,125,137,149,161,173,185,197,209,221,232],[c.ATK_PERCENT]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.DEF_PERCENT]:[.079,.101,.123,.146,.168,.19,.212,.235,.257,.279,.302,.324,.346,.368,.391,.413,.435],[c.CRIT_RATE]:[.042,.054,.066,.078,.09,.101,.113,.125,.137,.149,.161,.173,.185,.197,.208,.22,.232],[c.CRIT_DMG]:[.084,.108,.131,.155,.179,.203,.227,.25,.274,.298,.322,.345,.369,.393,.417,.441,.464],[c.ENERGY_RECHARGE]:[.07,.09,.11,.129,.149,.169,.189,.209,.228,.248,.268,.288,.308,.328,.347,.367,.387],[c.HEALING_BONUS]:[.048,.062,.076,.09,.103,.117,.131,.144,.158,.172,.186,.199,.213,.227,.24,.254,.268],[c.ELEMENTAL_MASTERY]:[25.2,32.3,39.4,46.6,53.7,60.8,68,75.1,82.2,89.4,96.5,103.6,110.8,117.9,125,132.2,139.3],[c.ANEMO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.CRYO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.ELECTRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.GEO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.HYDRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.PYRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.DENDRO_DMG]:[.063,.081,.099,.116,.134,.152,.17,.188,.206,.223,.241,.259,.277,.295,.313,.33,.348],[c.PHYSICAL_DMG]:[.079,.101,.123,.146,.168,.19,.212,.235,.257,.279,.302,.324,.346,.368,.391,.413,.435]},$e=(a=>(a[a.ROLL_1=0]="ROLL_1",a[a.ROLL_2=1]="ROLL_2",a[a.ROLL_3=2]="ROLL_3",a[a.ROLL_4=3]="ROLL_4",a[a.ROLL_AVG=4]="ROLL_AVG",a[a.ROLL_MIN=0]="ROLL_MIN",a[a.ROLL_MAX=3]="ROLL_MAX",a))($e||{});function X(a,e,s){return a===4?s===4?(gt[e][0]+gt[e][1]+gt[e][2]+gt[e][3])/4:gt[e][s]:a===5?s===4?(dt[e][0]+dt[e][1]+dt[e][2]+dt[e][3])/4:dt[e][s]:0}function ha(a){return a===4?4:a===5?6:0}function GE(a){return a===4?7:a===5?9:0}function La(a,e){return ha(a)*X(a,e,3)}var dt={[c.HP_FLAT]:[209.13,239,268.88,298.75],[c.HP_PERCENT]:[.0408,.0466,.0525,.0583],[c.ATK_FLAT]:[13.62,15.56,17.51,19.45],[c.ATK_PERCENT]:[.0408,.0466,.0525,.0583],[c.PYRO_DMG]:[.0408,.0466,.0525,.0583],[c.CRYO_DMG]:[.0408,.0466,.0525,.0583],[c.HYDRO_DMG]:[.0408,.0466,.0525,.0583],[c.ELECTRO_DMG]:[.0408,.0466,.0525,.0583],[c.ANEMO_DMG]:[.0408,.0466,.0525,.0583],[c.GEO_DMG]:[.0408,.0466,.0525,.0583],[c.DENDRO_DMG]:[.0408,.0466,.0525,.0583],[c.PHYSICAL_DMG]:[.051,.0583,.0656,.0729],[c.HEALING_BONUS]:[.03143,.03589799019607843,.040443014705882345,.044911004901960774],[c.DEF_FLAT]:[16.2,18.52,20.83,23.15],[c.DEF_PERCENT]:[.051,.0583,.0656,.0729],[c.CRIT_RATE]:[.0272,.0311,.035,.0389],[c.CRIT_DMG]:[.0544,.0622,.0699,.0777],[c.ENERGY_RECHARGE]:[.0453,.0518,.0583,.0648],[c.ELEMENTAL_MASTERY]:[16.32,18.65,20.98,23.31]},gt={[c.HP_FLAT]:[167.3,191.2,215.1,239],[c.HP_PERCENT]:[.0326,.0373,.042,.0466],[c.ATK_FLAT]:[10.89,12.45,14,15.56],[c.ATK_PERCENT]:[.0326,.0373,.042,.0466],[c.PYRO_DMG]:[.0326,.0373,.042,.0466],[c.CRYO_DMG]:[.0326,.0373,.042,.0466],[c.HYDRO_DMG]:[.0326,.0373,.042,.0466],[c.ELECTRO_DMG]:[.0326,.0373,.042,.0466],[c.ANEMO_DMG]:[.0326,.0373,.042,.0466],[c.GEO_DMG]:[.0326,.0373,.042,.0466],[c.DENDRO_DMG]:[.0326,.0373,.042,.0466],[c.PHYSICAL_DMG]:[.0408,.0466,.0525,.0583],[c.HEALING_BONUS]:[.0251,.02866813725490196,.032297794117647056,.035865931372549016],[c.DEF_FLAT]:[12.96,14.82,16.67,18.52],[c.DEF_PERCENT]:[.0408,.0466,.0525,.0583],[c.CRIT_RATE]:[.0218,.0249,.028,.0311],[c.CRIT_DMG]:[.0435,.0497,.056,.0622],[c.ENERGY_RECHARGE]:[.0363,.0414,.0466,.0518],[c.ELEMENTAL_MASTERY]:[13.06,14.92,16.79,18.65]};function Rt(a,e,s){return a*(1+e)+s}function Xe(a,e){return a>1?a=1:a<0&&(a=0),1+a*e}function Je(a){return a<0?1-a/2:a<.75?1-a:1/(4*a+1)}function Ze(a,e,s,n){return(a+100)/((1-s)*(1-n)*(e+100)+a+100)}function ts(a){return 2.78*a/(a+1400)}function as(a){return 16*a/(a+2e3)}function Na(a){return 5*a/(a+1200)}function Yt(a){return ye[a-1]}function es(a){switch(a){case c.BURGEON_DMG:return 6;case c.HYPERBLOOM_DMG:return 6;case c.OVERLOAD_DMG:return 4;case c.BLOOM_DMG:return 4;case c.SHATTER_DMG:return 3;case c.ELECTROCHARGE_DMG:return 2.4;case c.SWIRL_DMG:return 1.2;case c.SUPERCONDUCT_DMG:return 1;case c.BURNING_DMG:return .5;case c.AGGRAVATE_DMG:return 2.3;case c.SPREAD_DMG:return 2.5}return 0}var ss=(a=>(a[a.NO_CRIT=0]="NO_CRIT",a[a.CRIT=1]="CRIT",a[a.CRIT_AVG=2]="CRIT_AVG",a))(ss||{}),ns=(a=>(a[a.AMP_STRONG=2]="AMP_STRONG",a[a.AMP_WEAK=1.5]="AMP_WEAK",a[a.AMP_NONE=0]="AMP_NONE",a))(ns||{}),is=(a=>(a[a.QUICKEN_STRONG=2.5]="QUICKEN_STRONG",a[a.QUICKEN_WEAK=2.3]="QUICKEN_WEAK",a[a.QUICKEN_NONE=0]="QUICKEN_NONE",a))(is||{});function rs(a){return z({Char:0,Enemy:0,Base:0,Dmg:0,Critrate:0,Critdmg:0,Em:0,Res:0,Ignored:0,Reduced:0,Quicken:0,Amp:0,Tr:0},a)}function ls(a){return z({Base:!1,Def:!1,Res:!1,Dmg:!1,Crit:0,Quicken:0,Tr:0,Amp:0},a)}function os(a,e){let s=0;e.Base&&(s=a.Base);const n=es(e.Tr);return s+=n*Yt(a.Char),n===0&&e.Quicken>0&&(s+=e.Quicken*Yt(a.Char)*(1+Na(a.Em)+a.Quicken)),e.Dmg&&(s*=1+a.Dmg),n>0&&(s*=1+as(a.Em)+a.Tr,e.Quicken>0&&(s+=e.Quicken*Yt(a.Char)*(1+Na(a.Em)+a.Quicken))),e.Crit===1?s*=1+a.Critdmg:e.Crit===2&&(s*=Xe(a.Critrate,a.Critdmg)),e.Def&&(s*=Ze(a.Char,a.Enemy,a.Ignored,a.Reduced)),e.Res&&(s*=Je(a.Res)),e.Amp>0&&(s*=e.Amp*(1+ts(a.Em)+a.Amp)),s}function cs(a,e,s,n,i,l){const E=i;let _=0;i>0&&(_=l/i);let A=a*(1-E)*(1-_);return A+=e*(1-E)*_,A+=s*E*(1-_),A+=n*E*_,A}function dE(a,e){switch(e){case c.ATK:return Rt(a.Get(c.ATK_BASE),a.Get(c.ATK_PERCENT),a.Get(c.ATK_FLAT));case c.HP:return Rt(a.Get(c.HP_BASE),a.Get(c.HP_PERCENT),a.Get(c.HP_FLAT));case c.DEF:return Rt(a.Get(c.DEF_BASE),a.Get(c.DEF_PERCENT),a.Get(c.DEF_FLAT));case c.NORMAL_ATTACK_LEVEL:return a.Get(c.NORMAL_ATTACK_LEVEL)+a.Get(c.NORMAL_ATTACK_LEVEL_UP);case c.ELEMENTAL_SKILL_LEVEL:return a.Get(c.ELEMENTAL_SKILL_LEVEL)+a.Get(c.ELEMENTAL_SKILL_LEVEL_UP);case c.ELEMENTAL_BURST_LEVEL:return a.Get(c.ELEMENTAL_BURST_LEVEL)+a.Get(c.ELEMENTAL_BURST_LEVEL_UP);case c.CHARGED_AIMED_SHOT_DMG:return a.Get(c.CHARGED_AIMED_SHOT_DMG)+a.Get(c.CHARGED_ATTACK_DMG)+a.Get(c.AIMED_SHOT_DMG);case c.CHARGED_AIMED_SHOT_ATK_FLAT:return a.Get(c.CHARGED_AIMED_SHOT_ATK_FLAT)+a.Get(c.CHARGED_ATTACK_ATK_FLAT)+a.Get(c.AIMED_SHOT_ATK_FLAT);case c.CHARGED_AIMED_SHOT_ATK_PERCENT:return a.Get(c.CHARGED_AIMED_SHOT_ATK_PERCENT)+a.Get(c.CHARGED_ATTACK_ATK_PERCENT)+a.Get(c.AIMED_SHOT_ATK_PERCENT);case c.CHARGED_AIMED_SHOT_CRIT_DMG:return a.Get(c.CHARGED_AIMED_SHOT_CRIT_DMG)+a.Get(c.CHARGED_ATTACK_CRIT_DMG)+a.Get(c.AIMED_SHOT_CRIT_DMG);case c.CHARGED_AIMED_SHOT_CRIT_RATE:return a.Get(c.CHARGED_AIMED_SHOT_CRIT_RATE)+a.Get(c.CHARGED_ATTACK_CRIT_RATE)+a.Get(c.AIMED_SHOT_CRIT_RATE);case c.CHARGED_AIMED_SHOT_DMG_FLAT:return a.Get(c.CHARGED_AIMED_SHOT_DMG_FLAT)+a.Get(c.CHARGED_ATTACK_DMG_FLAT)+a.Get(c.AIMED_SHOT_DMG_FLAT);default:return a.Get(e)}}function gE(a,e,s){let n,i,l,E;switch(e){case c.ATK:throw new Error("Cannot set Total ATK directly.");case c.HP:throw new Error("Cannot set Total HP directly.");case c.DEF:throw new Error("Cannot set Total DEF directly");case c.NORMAL_ATTACK_LEVEL:s=Math.max(1,Math.floor(s)),a.Set(c.NORMAL_ATTACK_LEVEL,s-a.Get(c.NORMAL_ATTACK_LEVEL_UP));break;case c.ELEMENTAL_SKILL_LEVEL:s=Math.max(1,Math.floor(s)),a.Set(c.ELEMENTAL_SKILL_LEVEL,s-a.Get(c.ELEMENTAL_SKILL_LEVEL_UP));break;case c.ELEMENTAL_BURST_LEVEL:s=Math.max(1,Math.floor(s)),a.Set(c.ELEMENTAL_BURST_LEVEL,s-a.Get(c.ELEMENTAL_BURST_LEVEL_UP));break;case c.LEVEL:s>90?s=90:s<1&&(s=1),s=Math.floor(s),i=wt(s),l=ft(s),E=a.Get(c.ASCENSION),E<i?E=i:E>l&&(E=l),a.Set(c.ASCENSION,E),a.Set(c.LEVEL,s);break;case c.ASCENSION:n=a.Get(c.LEVEL),i=wt(n),l=ft(n),E=Math.floor(s),E<i?E=i:E>l&&(E=l),a.Set(c.ASCENSION,E);break;default:a.Set(e,s);break}}var fa=class{constructor(a){if(this.Subject=new it(c.Length(),"CHARACTER_STATS"),this.infusions=[],this.MapCritRate=e=>e,a.Stars!==4&&a.Stars!==5)throw new Error("Character stars must be 4 or 5.");this.Options=a,this.Subject.Set(c.LEVEL,1),this.Subject.Set(c.ASCENSION,0),this.Subject.Set(c.ENERGY_RECHARGE,1),this.Subject.Set(c.CRIT_RATE,.05),this.Subject.Set(c.CRIT_DMG,.5),this.Subject.Set(c.NORMAL_ATTACK_LEVEL,1),this.Subject.Set(c.ELEMENTAL_SKILL_LEVEL,1),this.Subject.Set(c.ELEMENTAL_BURST_LEVEL,1),this.Subject.Set(c.HP_CURRENT,1),this.Subject.Set(c.ENERGY_CURRENT,1),this.enemy=new Re(a.Name)}GetEnemy(){return this.enemy}IsShielded(){return this.Subject.Get(c.SHIELDED)===1}SetShield(a){return this.Subject.Set(c.SHIELDED,a===!0?1:0),this}GetLevel(){return this.Subject.Get(c.LEVEL)}SetLevel(a){return this.Set(c.LEVEL,a)}GetAscension(){return this.Subject.Get(c.ASCENSION)}SetAscension(a){return this.Set(c.ASCENSION,a)}IsAscended(){return this.GetAscension()===ft(this.GetLevel())}Set(a,e){return gE(this.Subject,a,e),this}CreateModifier(a,e){return this.Subject.CreateModifier(a,e)}CreateObserver(a,e){return this.Subject.CreateObserver(a,e)}Get(a){return dE(this.Subject,a)}AddInfusion(a,e){const s={Enabled:!0,Element:a,Max:e,Remove:()=>this.RemoveInfusion(s)};return this.infusions.push(s),s}RemoveInfusion(a){const e=this.infusions.indexOf(a);return e===-1?!1:(this.infusions.splice(e,1),!0)}GetInfusion(){return LE(this.infusions)}};function Es(a){return{level:a.GetLevel(),ascension:a.GetAscension(),hp:a.Get(c.HP_CURRENT),energy:a.Get(c.ENERGY_CURRENT),shielded:a.Get(c.SHIELDED)===1,talents:[a.Get(c.NORMAL_ATTACK_LEVEL),a.Get(c.ELEMENTAL_SKILL_LEVEL),a.Get(c.ELEMENTAL_BURST_LEVEL)],enemy:Aa(a.GetEnemy())}}function Ts(a,e){e.SetLevel(a.level),e.SetAscension(a.ascension),e.Set(c.NORMAL_ATTACK_LEVEL,a.talents[0]),e.Set(c.ELEMENTAL_SKILL_LEVEL,a.talents[1]),e.Set(c.ELEMENTAL_BURST_LEVEL,a.talents[2]),e.Set(c.HP_CURRENT,a.hp),e.Set(c.ENERGY_CURRENT,a.energy),e.Set(c.SHIELDED,a.shielded?1:0),Kt(a.enemy,e.GetEnemy())}var d={};R(d,{Charbox:()=>Ft,CharboxEvent:()=>ct,Export:()=>mn,ExportParty:()=>rT,Factory:()=>DE,Import:()=>Mn,ImportParty:()=>lT,Party:()=>qE});var ct=st("CHANGE_PARTY"),W=class{constructor(a){this.getName=a,this.list=[],this.map=new Map}AddList(a){for(const e of a)this.Add(e)}Add(a){const e=this.getName(a).toLowerCase();return this.map.has(e)?!1:(this.list.push(a),this.map.set(e,a),!0)}Has(a){return this.map.has(this.getName(a).toLowerCase())}Remove(a){const e=this.getName(a).toLowerCase(),s=this.list.indexOf(a);return s>=0&&this.list.splice(s,1),this.map.delete(e)}Clear(){this.list.splice(0,this.list.length),this.map.clear()}Find(a){return this.map.get(a.toLowerCase())}Get(){return this.list}},Ft=class{constructor(a){this.character=a,this.normals=new W(e=>e.Options.Name),this.skills=new W(e=>e.Options.Name),this.bursts=new W(e=>e.Options.Name),this.tr=new W(e=>e.Options.Name),this.extra=new W(e=>e.Options.Name),this.effects=new W(e=>e.Options.Name),this.modifiers=[],this.Event=new it(ct.Length(),"CHARBOX_EVENT")}static create(a){const e=new Ft(a.character);return e.normals.AddList(a.normals),e.skills.AddList(a.skills),e.bursts.AddList(a.bursts),e.tr.AddList(a.tr),e.extra.AddList(a.extra),e.effects.AddList(a.effects),e}GetParty(){return this.party}SetParty(a){this.party=a}GetWeapon(){return this.weapon}SetWeapon(a){return this.weapon&&this.weapon.Unequip(),a?this.weapon=a(this):this.weapon=void 0,this}GetCharacter(){return this.character}GetNormals(){return this.normals.Get()}FindNormal(a){return this.normals.Find(a)}AddNormal(a){return this.normals.Add(a)}RemoveNormal(a){return this.normals.Remove(a)}GetSkills(){return this.skills.Get()}FindSkill(a){return this.skills.Find(a)}AddSkill(a){return this.skills.Add(a)}RemoveSkill(a){return this.skills.Remove(a)}GetBursts(){return this.bursts.Get()}FindBurst(a){return this.bursts.Find(a)}AddBurst(a){return this.bursts.Add(a)}RemoveBurst(a){return this.bursts.Remove(a)}GetTr(){return this.tr.Get()}FindTr(a){return this.tr.Find(a)}GetExtra(){return this.extra.Get()}FindExtra(a){return this.extra.Find(a)}AddExtra(a){return this.extra.Add(a)}RemoveExtra(a){return this.extra.Remove(a)}AddInstance(a,e){switch(a){case"Extra":return this.AddExtra(e);case"Normal":return this.AddNormal(e);case"Skill":return this.AddSkill(e);case"Burst":return this.AddBurst(e)}}RemoveInstance(a,e){switch(a){case"Extra":return this.RemoveExtra(e);case"Normal":return this.RemoveNormal(e);case"Skill":return this.RemoveSkill(e);case"Burst":return this.RemoveBurst(e)}}GetInstances(){return[...this.normals.Get(),...this.skills.Get(),...this.bursts.Get(),...this.tr.Get(),...this.extra.Get()]}FindInstance(a){for(const e of[this.normals,this.skills,this.bursts,this.tr,this.extra]){const s=e.Find(a);if(s)return s}}GetEffects(){var a,e;return[...((a=this.weapon)==null?void 0:a.GetEffects())||[],...((e=this.artifacts)==null?void 0:e.GetEffects())||[],...this.effects.Get()]}GetGroupedEffects(){const a=[],{weapon:e,artifacts:s,party:n}=this;e&&a.push(["WEAPON",e.GetEffects()]),s&&a.push(["ARTIFACTS",s.GetEffects()]);const i=[],l=[],E=new Set(this.effects.Get());for(const _ of E){const A=_.Options.Name;if(A.match(/C\d+$/))i.push(_);else if(A.match(/A\d+$/))l.push(_);else continue;E.delete(_)}return a.push(["TALENTS",Array.from(E)]),a.push(["PASSIVES",l]),a.push(["CONSTELLATIONS",i]),n&&a.push(["RESONANCES",n.GetResonances()]),a}FindEffect(a){let e=this.effects.Find(a);if(e||this.weapon&&(e=this.weapon.FindEffect(a),e)||this.artifacts&&(e=this.artifacts.FindEffect(a),e))return e}AddEffect(a){return this.effects.Add(a)}GetArtifacts(){return this.artifacts}SetArtifacts(a){return this.artifacts&&this.artifacts.Remove(),this.artifacts=a,this}AddModifier(a){return this.modifiers.unshift(a),this}RemoveModifier(a){const e=this.modifiers.indexOf(a);return e>=0&&(a.Disable(),this.modifiers.splice(e,1)),this}GetModifiers(){return this.modifiers}ClearModifiers(){return this.modifiers.forEach(a=>a.Disable()),this.modifiers.splice(0,this.modifiers.length),this}},_s={};R(_s,{BaseDamage:()=>As,Instance:()=>Ma,Normal:()=>Ca,NormalTalent:()=>mt,Transformative:()=>B});var As=class{constructor(a){this.instance=a,this.motions=[],this.multipliers=[]}CreateMv(a,e){const s={Enabled:!0,Stat:a,Value:e};return this.motions.push(s),s}AddMv(a){return this.motions.includes(a)?!1:(this.motions.push(a),!0)}RemoveMv(a){const e=this.motions.indexOf(a);return e===-1?!1:(this.motions.splice(e,1),!0)}GetMvs(){return this.motions}CreateMultiplier(a){const e={Enabled:!0,Value:a};return this.multipliers.push(e),e}AddMultiplier(a){return this.multipliers.includes(a)?!1:(this.multipliers.push(a),!0)}RemoveMultiplier(a){const e=this.multipliers.indexOf(a);return e===-1?!1:(this.multipliers.splice(e,1),!0)}GetMultipliers(){return this.multipliers}Compute(){let a=0;for(const e of this.motions)e.Enabled&&(a+=this.instance.Get(e.Stat)*e.Value);for(const e of this.multipliers)e.Enabled&&(a*=e.Value);return a}};function RE(a,e){return a===c.HYDRO_DMG&&e.Affected(c.PYRO_DMG)?[c.VAPORIZE_DMG,2]:a===c.PYRO_DMG&&e.Affected(c.CRYO_DMG)?[c.MELT_DMG,2]:a===c.PYRO_DMG&&e.Affected(c.HYDRO_DMG)?[c.VAPORIZE_DMG,1.5]:a===c.CRYO_DMG&&e.Affected(c.PYRO_DMG)?[c.MELT_DMG,1.5]:[c.NONE,0]}function IE(a,e){return e.HasAura(x.QUICKEN)?a===c.ELECTRO_DMG?[c.AGGRAVATE_DMG,2.3]:a===c.DENDRO_DMG?[c.SPREAD_DMG,2.5]:[c.NONE,0]:[c.NONE,0]}function Ss(a,e,s){const n=a.GetElement(),i=a.Options.Talent,l=a.Character.GetEnemy(),[E,_]=IE(n,l),[A,S]=RE(n,l),u=rs({Char:a.Character.Get(c.LEVEL),Enemy:l.Subject.Get(c.LEVEL),Base:a.Base.Compute()+a.Get(c.DMG_FLAT),Dmg:a.Get(n)+a.Get(i)+a.Get(c.ALL_DMG),Critrate:Math.max(0,Math.min(1,a.Get(c.CRIT_RATE))),Critdmg:a.Get(c.CRIT_DMG),Em:a.Get(c.ELEMENTAL_MASTERY),Res:l.Subject.Get(Bt(n)),Ignored:a.Get(c.DEFIGNORED)+l.Subject.Get(c.DEFIGNORED),Reduced:a.Get(c.DEFREDUCTION)+l.Subject.Get(c.DEFREDUCTION),Quicken:a.Get(E),Amp:a.Get(A),Tr:a.Get(a.Options.Tr)}),h=ls({Base:a.Options.Base,Def:a.Options.Def,Res:a.Options.Res,Dmg:a.Options.Dmg,Crit:s,Quicken:_,Tr:a.Options.Tr,Amp:S});return e||(u.Quicken=0,u.Amp=0,h.Quicken=0,h.Amp=0),a.Options.Amp||(h.Amp=0),a.Options.Quicken||(h.Quicken=0),a.Options.Crit||(h.Crit=0),{stats:u,options:h}}function ma(a,e,s){const{stats:n,options:i}=Ss(a,e,s);return os(n,i)}var K=c,Ma=class{constructor(a,e){this.Character=a,this.Options=e,this.Base=new As(this),this.fixed=new Uint8Array(c.Length()),this.Subject=new it(c.Length(),"INSTANCE_"+this.Options.Name)}GetElement(){if(this.Options.Override){if(this.Options.OverrideElement!==c.NONE)return this.Options.OverrideElement;if(this.Options.Infusion){const a=this.Character.GetInfusion();if(a)return a.Element}}return this.Options.Element}Fix(a){return this.fixed[a]=1,this}Unfix(a){return this.fixed[a]=0,this}Get(a){if(a===K.ATK){const e=this.GetElement(),s=ra(e),n=oa(e),i=this.Options.Talent,l=ra(i),E=oa(i),_=this.Get(K.ATK_BASE);let A=this.Get(K.ATK_PERCENT),S=this.Get(K.ATK_FLAT);return s!==K.NONE&&(A+=this.Get(s)),l!==K.NONE&&(A+=this.Get(l)),n!==K.NONE&&(S+=this.Get(n)),E!==K.NONE&&(S+=this.Get(E)),Rt(_,A,S)}else if(a===K.CRIT_RATE){const e=this.GetElement(),s=this.Options.Talent,n=ca(e),i=ca(s);let l=0;return l+=this.Subject.Get(K.CRIT_RATE),l+=this.Subject.Get(K.EXTRA_CRIT_RATE),this.fixed[K.CRIT_RATE]||(l+=this.Character.Get(K.CRIT_RATE)),this.fixed[K.EXTRA_CRIT_RATE]||(l+=this.Character.Get(K.EXTRA_CRIT_RATE)),l+=this.Get(n)+this.Get(i),this.Character.MapCritRate(l)}else if(a===K.CRIT_DMG){const e=this.GetElement(),s=this.Options.Talent,n=Ea(e),i=Ea(s);let l=this.Subject.Get(K.CRIT_DMG);return this.fixed[K.CRIT_DMG]||(l+=this.Character.Get(K.CRIT_DMG)),l+=this.Get(n)+this.Get(i),l}else if(a===K.DMG_FLAT){const e=this.GetElement(),s=this.Options.Talent,n=la(e),i=la(s);let l=this.Subject.Get(K.DMG_FLAT);return this.fixed[K.DMG_FLAT]||(l+=this.Character.Get(K.DMG_FLAT)),l+=this.Get(n)+this.Get(i),l}else return this.fixed[a]?this.Subject.Get(a):this.Character.Get(a)+this.Subject.Get(a)}DmgNoCrit(a){return ma(this,a,0)}DmgCrit(a){return ma(this,a,1)}DmgAvg(a){return ma(this,a,2)}Params(a,e){return Ss(this,a,e)}};function Ca(a,e){return new Ma(e,{Name:a,Element:c.PHYSICAL_DMG,Talent:c.NONE,Override:!0,OverrideElement:c.NONE,Infusion:!1,Base:!0,Def:!0,Res:!0,Dmg:!0,Crit:!0,Quicken:!0,Amp:!0,Tr:c.NONE})}function B(a,e,s){const n=new Ma(s,{Name:"HIT_"+c.Name(a).replace(/_DMG/g,""),Element:c.PHYSICAL_DMG,Talent:c.NONE,Override:!1,OverrideElement:c.NONE,Infusion:!1,Base:!1,Def:!1,Res:!0,Dmg:!1,Crit:!0,Quicken:!1,Amp:!1,Tr:a});if(n.Fix(c.CRIT_RATE),n.Fix(c.CRIT_DMG),a===c.SWIRL_DMG){if(!e)throw new Error("Swirl transformative damage must have an element");n.Options.Quicken=!0,n.Options.Amp=!0,n.Options.Name="HIT_"+(c.Name(a)+"_"+c.Name(e)).replace(/_DMG/g,""),n.Options.Element=e}else n.Options.Element=de(a);return n}function mt(a,e){const s=Ca(e.Name,a),n=[];if(s.Options.Talent=e.Talent,s.Options.Element=e.Element,e.Scaling)for(const i of e.Scaling)n.push(...Ye(s,i));return[s,n]}function DE(a){return Object.assign(function(){const s=new fa(a);be(s,a);const n=Ft.create({character:s,normals:a.Normals.map(i=>mt(s,pa(i,c.NORMAL_ATTACK_LEVEL))[0]),skills:a.Skills.map(i=>mt(s,pa(i,c.ELEMENTAL_SKILL_LEVEL))[0]),bursts:a.Bursts.map(i=>mt(s,pa(i,c.ELEMENTAL_BURST_LEVEL))[0]),tr:OE(s),extra:a.Extra.map(i=>mt(s,et(z({},i),{Scaling:void 0}))[0]),effects:[]});return n.GetNormals().forEach(i=>i.Options.Infusion=!0),a.Effects.forEach(i=>{const l=i(n);l.Apply(n),n.AddEffect(l)}),n},a)}function pa(a,e){var s;return et(z({},a),{Scaling:(s=a.Scaling)==null?void 0:s.map(n=>et(z({},n),{Talent:e}))})}function OE(a){const e=a.Options.Element,s=[];switch(e){case c.PYRO_DMG:s.push(B(c.OVERLOAD_DMG,void 0,a)),s.push(B(c.BURGEON_DMG,void 0,a)),s.push(B(c.BURNING_DMG,void 0,a));break;case c.HYDRO_DMG:s.push(B(c.ELECTROCHARGE_DMG,void 0,a)),s.push(B(c.BLOOM_DMG,void 0,a));break;case c.CRYO_DMG:s.push(B(c.SUPERCONDUCT_DMG,void 0,a));break;case c.ELECTRO_DMG:s.push(B(c.SUPERCONDUCT_DMG,void 0,a)),s.push(B(c.ELECTROCHARGE_DMG,void 0,a)),s.push(B(c.OVERLOAD_DMG,void 0,a)),s.push(B(c.HYPERBLOOM_DMG,void 0,a));break;case c.DENDRO_DMG:s.push(B(c.BLOOM_DMG,void 0,a));break;case c.GEO_DMG:s.push(B(c.SHATTER_DMG,void 0,a));break;case c.ANEMO_DMG:s.push(B(c.SWIRL_DMG,c.PYRO_DMG,a)),s.push(B(c.SWIRL_DMG,c.HYDRO_DMG,a)),s.push(B(c.SWIRL_DMG,c.CRYO_DMG,a)),s.push(B(c.SWIRL_DMG,c.ELECTRO_DMG,a)),s.push(B(c.SUPERCONDUCT_DMG,void 0,a)),s.push(B(c.ELECTROCHARGE_DMG,void 0,a)),s.push(B(c.OVERLOAD_DMG,void 0,a)),s.push(B(c.HYPERBLOOM_DMG,void 0,a)),s.push(B(c.BLOOM_DMG,void 0,a)),s.push(B(c.BURGEON_DMG,void 0,a));break}return e!==c.GEO_DMG&&a.Options.Weapon===Ce.CLAYMORE&&s.push(B(c.SHATTER_DMG,void 0,a)),s}var us={};R(us,{Cryo:()=>Fs,Dendro:()=>xs,FindByElement:()=>js,Geo:()=>Vs,GetList:()=>Ws,Hydro:()=>Ys,Pyro:()=>ws});var r={};R(r,{Builder:()=>Tt,Effect:()=>Ps,EffectEvent:()=>U,Export:()=>Oa,Factory:()=>Et,Import:()=>ya});function b(a,e){let s=a.toFixed(e);return s=s.replace(/\.([0-9]*)([1-9])0+$/,".$1$2"),s=s.replace(/\.0+$/,""),s}function hs(a){switch(a.type){case 0:return vE(a.object);case 1:return PE(a.object);case 2:return BE(a.object);case 3:return HE(a.object);case 4:return yE(a.object)}}function yE(a){return"Damage instance: "+a.Options.Name}function HE(a){return`Infusion (${a.Enabled?"Enabled":"Disabled"}): `+Ga(a.Element)}function vE(a){const e=a.Enabled()?"Enabled":"Disabled";return`Modifier (${a.Title}) (${e}): `+Ga(a.GetProp())+" += "+b(a.GetValue(),4)}function PE(a){let s=`Multiplier (${a.object.Enabled?"Enabled":"Disabled"}): `+b(a.object.Value,4)+`
`;s+=`	For instances:
`;for(const n of a.instances)s+="		"+n.Options.Name+`
`;return s}function BE(a){let s=`MV (${a.object.Enabled?"Enabled":"Disabled"}): `+b(a.object.Value,4)+"*"+Ga(a.object.Stat)+`
`;s+=`	For instances:
`;for(const n of a.instances)s+="		"+n.Options.Name+`
`;return s}function Ga(a){try{return c.Name(a)}catch{return"unknown stat"}}var KE=class{constructor(){this.modifiers=new Set,this.observers=new Set,this.infusions=new Set,this.multipliers=new Set,this.mtins=new Set,this.mvs=new Set,this.mvins=new Set,this.instances=new Set,this.queryPool=[],this.queryGroups=new Map,this.nextQuery={}}GetModifiers(){return Array.from(this.modifiers)}Modifier(a){return this.modifiers.add(a),this.queryPool.push({type:0,object:a}),a}Observer(a){return this.observers.add(a),a}Infusion(a){return this.infusions.add(a),this.queryPool.push({type:3,object:a}),a}Multiplier(a,...e){return this.multipliers.add(a),e.forEach(s=>{s.Base.AddMultiplier(a),this.mtins.add(s)}),this.queryPool.push({type:1,object:{instances:e,object:a}}),a}Mv(a,...e){return this.mvs.add(a),e.forEach(s=>{s.Base.AddMv(a),this.mvins.add(s)}),this.queryPool.push({type:2,object:{instances:e,object:a}}),a}Instance(a,e,s){const n=[a,e,s];return this.instances.add(n),this.queryPool.push({type:4,object:s}),n}Enable(){return this.observers.forEach(a=>a.Enable().Notify()),this.modifiers.forEach(a=>a.Enable()),this.infusions.forEach(a=>a.Enabled=!0),this.mvs.forEach(a=>a.Enabled=!0),this.multipliers.forEach(a=>a.Enabled=!0),this.instances.forEach(([a,e,s])=>a.AddInstance(e,s)),this}DisableObs(){return this.observers.forEach(a=>a.Notify().Disable()),this}Disable(){return this.modifiers.forEach(a=>a.Disable()),this.DisableObs(),this.infusions.forEach(a=>a.Enabled=!1),this.mvs.forEach(a=>a.Enabled=!1),this.multipliers.forEach(a=>a.Enabled=!1),this.instances.forEach(([a,e,s])=>a.RemoveInstance(e,s)),this}Remove(){return this.Disable(),this.observers.forEach(a=>a.Remove()),this.infusions.forEach(a=>a.Remove()),this.mvins.forEach(a=>this.mvs.forEach(e=>a.Base.RemoveMv(e))),this.mtins.forEach(a=>this.multipliers.forEach(e=>a.Base.RemoveMultiplier(e))),this.instances.forEach(([a,e,s])=>a.RemoveInstance(e,s)),this}StartQuery(a){this.nextQuery=a}EndQuery(){this.queryGroups.set(this.nextQuery,[...this.queryPool]),this.queryPool=[]}String(){let a="";for(const[e,s]of this.queryGroups){a+="QUERY: "+JSON.stringify(e)+`
`;for(const n of s)a+=hs(n)+`
`;a+="=".repeat(32)+`
`}this.queryGroups.size===0&&(a+="=".repeat(32)+`
`);for(const e of this.queryPool)a+=hs(e)+`
`;return a}},U=st("ENABLE","DISABLE","CHANGE_RANK","CHANGE_TARGET","CHANGE_STACKS","CHANGE_AURAS","CHANGE_CONDITIONS");function rt(...a){const e=[],s=[];let n=0;a.forEach((l,E)=>{e[E]=l.split(`
`),e[E].forEach(_=>{_.length>(s[E]||0)&&(s[E]=_.length)}),e[E].length>n&&(n=e[E].length)});const i=[];return e.forEach((l,E)=>{for(let _=0;_<n;_++){let A;for(_<l.length?A=l[_]:A="";A.length<s[E];)A+=" ";i[_]===void 0&&(i[_]=""),i[_]+=A}}),i.join(`
`)}var Ls={};R(Ls,{CRLF_EXP:()=>Gs,ColorizeArgs:()=>fs,CommandHelp:()=>Ia,CommandListHelp:()=>Da,DEFINE_CASE_EXP:()=>gs,DEFINE_CONST_EXP:()=>Cs,FindCommand:()=>da,FindConstants:()=>Rs,INLINE_COMMENT_EXP:()=>ga,LogString:()=>Ns,Logger:()=>w,MULT_COMMENT_EXP:()=>ds,ParseLine:()=>Ds,ParseLines:()=>Os,Program:()=>vs,REPLACE_CONST_EXP:()=>ps,RemoveComments:()=>Ra,ReplaceConstants:()=>Is,SplitCases:()=>Vt}),Ct.exports.enabled=!0;var bE={Log:"green",Warn:"yellow",Error:"red"};function Ns(a,e,s){let n=s.msg;if(a){let i=`[Line ${s.line}] [${s.type}]`;e&&(i=Ct.exports[bE[s.type]](i)),n=i+" "+n}return n}function fs(a,e){return e.replace(/%([.0-9]*[a-z]+)/g,s=>Ct.exports[a](s))}var ms=he(Zc()),Ms=class{constructor(){this.Line=1,this.SaveLogs=!0,this.Colorize=!0,this.Prefix=!0,this.logs=[],this.Out=a=>console.log(this.LogString(a))}send(a,e){const s={type:a,msg:e,line:this.Line};return this.SaveLogs&&this.logs.push(s),this.Out(s),s}format(a,e){return this.Colorize?(0,ms.printf)(fs("cyan",a),...e):(0,ms.printf)(a,...e)}GetLog(){return this.logs}Clear(){this.logs.splice(0,this.logs.length)}Log(a){return this.send("Log",a)}Logf(a,...e){return this.send("Log",this.format(a,e))}Warn(a){return this.send("Warn",a)}Warnf(a,...e){return this.send("Warn",this.format(a,e))}Error(a){return this.send("Error",a)}Errorf(a,...e){return this.send("Error",this.format(a,e))}Throw(a){const{msg:e}=this.send("Error",a);throw e}Throwf(a,...e){const{msg:s}=this.send("Error",this.format(a,e));throw s}String(){return this.logs.map(a=>this.LogString(a)).join(`
`)}toString(){return this.String()}LogString(a){return Ns(this.Prefix,this.Colorize,a)}},w=Ms;w.Global=new Ms;function da(a,e){for(let s=0;s<e.length;s++){const n=e[s],i=a[n];if(!i)throw new Error("Command not found: `"+e.slice(0,s+1).join(" ")+"`");if(!i.children||s===e.length-1)return[i,e.slice(s+1),e.slice(0,s+1)];a=i.children}throw new Error("Command not found: "+e.join(" "))}var Cs=/^ *const +\$([a-z_](?:\w|\.)*) *(.*)$/img,ps=/\$([a-z_](?:\w|\.)*)/ig,Gs=/(\r\n|\n\r)/g,ga=/(#|\/\/).*$/gm,ds=/\/\*((?:.|\n|\r)*?)\*\//gm,gs=/case([^:]*):/g;function Ra(a){return a.replace(Gs,`
`).replace(ds,e=>e.replace(/[^\n]/g," ")).replace(ga,"")}function Rs(a,e={}){return a=a.replace(Cs,(s,n,i)=>(i=i.replace(ga,""),e[String(n).valueOf().toLowerCase()]=i,"")),[a,e]}function Is(a,e={}){return a=a.replace(ps,(s,n)=>{const i=e[String(n).valueOf().toLowerCase()];if(!i)throw new Error("Cannot find constant: $"+n);return i}),a}function Ds(a){return a.trim().split(/\s+/).filter(e=>!e.match(/^\s*$/))}function Os(a){return a.split(`
`).map((e,s)=>({text:e,line:s})).filter(({text:e})=>e.trim()!=="")}function Vt(a){a=Ra(a);const e=new Map,s=Array.from(a.matchAll(gs));s.forEach((i,l)=>{var E;const _=i[0],A=i[1];if(!_||!A)return;const S=A.split(/\s|,|;/).map(N=>N.trim()).filter(N=>!!N),u=(i.index||0)+_.length,h=((E=s[l+1])==null?void 0:E.index)||a.length,L=a.slice(0,u).replace(/[^\n]/g,"")+a.slice(u,h).trim()+a.slice(h,a.length).replace(/[^\n]/g,"");for(let N of S){N=N.toLowerCase();let f=e.get(N);f||e.set(N,f=[]),f.push(L)}});const n=e.get("all");if(n)for(const i of e.values())i.unshift(...n);return e}function Ia(a,e){const s=new w;s.Out=()=>{},s.Colorize=!1,s.Prefix=!1;const n=(e.arguments||["args..."]).map(l=>"["+l+"]");let i=e.description.split(`
`).join(`
`);return e.example&&(i+=`

**Example:**
\`\`\`
`+e.example+"\n```\n"),e.children&&(i+=`

Type \`help ${a}\` to show more about this subcommand`),s.Logf("### Command `"+a+" %s".repeat(n.length)+`\`:

`+i+`

`,...n),s.String()}function Da(a,e){let s="";for(const[n,i]of Object.entries(e))s+=Ia(a+" "+n,i)+`

`;return s}function ys(a,e){return Object.assign(e,{String(){return a},toString(){return a}})}function Hs(a){return a.forEach((e,s)=>a[s]=e.toLowerCase()),a}function wE(a){let e=0,s=1/0;if(a){s=a.length;for(const n of a)n.includes("...")?s=1/0:e++}return[e,s]}function YE(a,e={},s=w.Global){const n=[];a=Ra(a);const[i,l]=Rs(a,e==null?void 0:e.constants),E=s.Line;return Os(i).forEach(({text:A,line:S})=>{s.Line=S+1;try{A=Is(A,l)}catch(h){throw s.Error(String(h).valueOf()),s.Line=E,h}const u=Ds(A);!u.length||n.push({cmd:u,line:s.Line})}),s.Line=E,n}var vs=class{constructor(a){this.Value=a,this.commands={},this.Log=w.Global,this.IgnoreCase=!0,this.Catch=!0}Set(a){return this.commands=a,this}Get(){return this.commands}Compile(a,e){const s=this.Log.Line,n=(e==null?void 0:e.line)||s;this.Log.Line=n;const i=l=>{if(this.Log.Line=n,typeof l=="string"?(this.Log.Line=s,l=new Error(l)):(this.Log.Error(String(l).valueOf()),this.Log.Line=s),!this.Catch)throw l;return l};try{this.IgnoreCase&&Hs(a);const[l,E,_]=da(this.commands,a),A=_.join(" ");if(!l.compile){const{msg:L}=this.Log.Errorf("Command `%s` is defined but has no `.compile()` method",A);throw L}const[S,u]=wE(l.arguments);if(E.length<S){const{msg:L}=this.Log.Errorf("Command `%s` requires at least %d arguments, but %d were provided.",A,S,E.length);throw L}if(E.length>u){const{msg:L}=this.Log.Errorf("Command `%s` requires at most %d arguments, but %d were provided.",A,u,E.length);throw L}const h=l.compile(this,E);return this.Log.Line=s,ys(a.join(" "),()=>{const L=this.Log.Line;this.Log.Line=n;try{h()}catch(N){i(N)}this.Log.Line=L})}catch(l){throw i(l)}}CompileString(a,e){const s=YE(a,e,this.Log),n=[];for(const{cmd:l,line:E}of s){const _=this.Compile(l,{line:E});n.push(_)}const i=n.map(l=>l.String()).join(`
`);return ys(i,()=>n.forEach(l=>l()))}Help(a){if(!a.length||a[0].trim()==="")return Da("",this.commands);this.IgnoreCase&&Hs(a);const[e,,s]=da(this.commands,a);let n=Ia(s.join(" "),e);return e.children&&(n+=`

`+Da(s.join(" "),e.children)),n}GetCommands(){const a=[];function e(s,n){for(const[i,l]of Object.entries(s)){const E=[...n,i];a.push(E.join(" ")),l.children&&e(l.children,E)}}return e(this.commands,[]),a}},Ps=class{constructor(a,e){this.Options=a,this.Owner=e,this.targets=new Set,this.register=new Map,this.onUnapply=new Map,this.enabled=!1,this.rank=1,this.stacks=0,this.conditions=new Set,this.auras=new Set,this.Event=new it(U.Length(),"EFFECT_EVENT")}CreateObserver(a,e){return this.Event.CreateObserver(a,e)}Enabled(){return this.enabled}Enable(){this.enabled=!0;for(const[,a]of this.register)a.Enable();return this.Event.Notify(U.ENABLE),this}Disable(){this.enabled=!1;for(const[,a]of this.register)a.Disable();return this.Event.Notify(U.DISABLE),this}GetTargets(){return Array.from(this.targets.values())}Lock(a){const e=this.register.get(a);return e?(e.DisableObs(),this):(w.Global.Warnf("Cannot lock effect %s for target %s because its not applied.",this.Options.Name,a.GetCharacter().Options.Name),this)}ApplyMultiple(a){const e=new Set(a);if(!this.Options.ApplyOther){const n=e.has(this.Owner),i=e.size;e.clear(),n&&(e.add(this.Owner),i>1&&w.Global.Warnf('Effect "%s" can only be applied to its owner: "%s"',this.Options.Name,this.Owner.GetCharacter().Options.Name))}if(this.Options.ApplySelf||(e.delete(this.Owner),w.Global.Warnf('Effect "%s" CANNOT be applied to its owner: "%s"',this.Options.Name,this.Owner.GetCharacter().Options.Name)),this.Options.MaxTargets>0){let n=0;for(let i=0;i<a.length&&e.size>this.Options.MaxTargets;i++)e.delete(a[i]),n++;n>0&&w.Global.Warnf('Effect "%s" maximum targets is %d.',this.Options.Name,this.Options.MaxTargets)}this.UnapplyAll();let s=0;for(const n of e)this.Apply(n)&&s++;return s}Apply(a){if(!this.Options.StackSelf){const n=a.GetParty();if(n&&n.GetAppliedEffects(a).find(l=>l.Options.Name===this.Options.Name))return w.Global.Warnf('Cannot apply effect "%s" to target "%s". Another instance of this effect is already applied to the target',this.Options.Name,a.GetCharacter().Options.Name),!1}if(!this.Options.ApplySelf&&a===this.Owner)return w.Global.Warnf('Cannot apply effect "%s" to target "%s". Effect CANNOT be applied to its owner: "%s"',this.Options.Name,a.GetCharacter().Options.Name,this.Owner.GetCharacter().Options.Name),!1;if(!this.Options.ApplyOther&&a!==this.Owner)return w.Global.Warnf('Cannot apply effect "%s" to target "%s". Effect can only be applied to its owner: "%s"',this.Options.Name,a.GetCharacter().Options.Name,this.Owner.GetCharacter().Options.Name),!1;if(this.Options.MaxTargets>0&&this.targets.size>=this.Options.MaxTargets)return w.Global.Warnf('Cannot apply effect "%s" to target "%s". Effect is applied to its maximum number of targets: %d',this.Options.Name,a.GetCharacter().Options.Name,this.Options.MaxTargets),!1;if(this.targets.has(a))return w.Global.Warnf('Cannot apply effect "%s" to target "%s". Effect is applied to this target',this.Options.Name,a.GetCharacter().Options.Name),!1;this.targets.add(a);const e=new KE;this.register.set(a,e);const s=this.Options.OnApply(a,this,e);return this.onUnapply.set(a,s),this.Enabled()?e.Enable():e.Disable(),this.Event.Notify(U.CHANGE_TARGET),!0}Unapply(a){var e,s;return this.targets.has(a)?(this.targets.delete(a),(e=this.register.get(a))==null||e.Remove(),this.register.delete(a),(s=this.onUnapply.get(a))==null||s(),this.onUnapply.delete(a),this.Event.Notify(U.CHANGE_TARGET),!0):!1}UnapplyAll(){return this.targets.forEach(a=>this.Unapply(a)),this}GetRank(){return this.rank}GetStacks(){return this.stacks}SetRank(a){return a=Math.floor(a),a>this.Options.MaxRank&&(a=this.Options.MaxRank),a<1&&(a=1),this.rank=a,this.Event.Notify(U.CHANGE_RANK),this}SetStacks(a){return a>this.Options.MaxStacks&&(a=this.Options.MaxStacks),a<0&&(a=0),this.stacks=a,this.Event.Notify(U.CHANGE_STACKS),this}HasCondition(a){return this.conditions.has(a.toUpperCase())}SetConditions(...a){this.conditions.clear();for(let e of a)e=e.toUpperCase(),this.Options.Conditions.includes(e)&&this.conditions.size<this.Options.MaxConditions&&this.conditions.add(e);return this.Event.Notify(U.CHANGE_CONDITIONS),this}GetConditions(){return Array.from(this.conditions)}HasAura(a){return this.auras.has(a)}SetAuras(...a){const e=this.Options.ValidAuras;this.auras.clear();for(const s of a)this.auras.size<this.Options.MaxAuras&&(e.length===0||e.length>0&&e.includes(s))&&this.auras.add(s);return this.Event.Notify(U.CHANGE_AURAS),this}GetAuras(){return Array.from(this.auras)}Affected(a){for(const e of this.auras)if(Ta(e)===a)return!0;return!1}TargetRegister(a){const e=this.register.get(a);if(!!e)return e.String()}Register(){const a=this.GetTargets().map(s=>s.GetCharacter().Options.Name+`
`+this.TargetRegister(s)||""),e=[];for(let s=0;s<a.length;s++)e[2*s]=a[s],e[2*s+1]=" ".repeat(4);return rt(...e)}};function Et(a){const e=z({ApplySelf:!0,ApplyOther:!1,StackSelf:!1,MaxTargets:0,Conditions:[],MaxConditions:0,MaxAuras:0,ValidAuras:[],MaxRank:1,MaxStacks:0},a);return e.Conditions=e.Conditions.map(s=>s.toUpperCase()),Object.assign(function(n){return new Ps(e,n)},et(z({},a),{Options:a}))}function Bs(a,e){return!(Number.isFinite(e.g)&&!(a>(e.g||0))||Number.isFinite(e.geq)&&!(a>=(e.geq||0))||Number.isFinite(e.l)&&!(a<(e.l||0))||Number.isFinite(e.leq)&&!(a<=(e.leq||0)))}function Ks(a,e,s){if(s.name){if(typeof s.name=="string"){if(a.Options.Name.toLowerCase()!==s.name.toLowerCase())return!1}else if(!a.Options.Name.match(s.name))return!1}if(a.GetAscension()<(s.ascension||0)||s.weapon&&s.weapon.length>0&&!s.weapon.some(E=>a.Options.Weapon===E))return!1;const n=a.Get(c.HP_CURRENT),i=a.Get(c.ENERGY_CURRENT);return!(s.hp&&!Bs(n,s.hp)||s.energy&&!Bs(i,s.energy)||s.shielded!==void 0&&a.IsShielded()!==s.shielded||s.isOwner!==void 0&&a===e!==s.isOwner)}function bs(a,e){return!(e.affected&&e.affected.length>0&&a.Affected&&!e.affected.some(n=>{var i;return(i=a.Affected)==null?void 0:i.call(a,n)})||e.aura&&e.aura.length>0&&!e.aura.some(n=>a.HasAura(n)))}function FE(a,e,s,n){return!(a.target&&!Ks(s,e,a.target)||a.owner&&!Ks(e,e,a.owner)||a.enemy&&!bs(s.GetEnemy(),a.enemy)||a.effect&&(!bs(n,a.effect)||a.effect.conditions&&a.effect.conditions.length>0&&!a.effect.conditions.some(l=>n.HasCondition(l))))}function VE(a,e,s,n){if(typeof a=="function")return a(s,e,n);{let i=FE(a,e.GetCharacter(),s.GetCharacter(),n);return a.not&&(i=!i),i}}var xE=class{constructor(a){this.builder=a,this.target=[],this.owner=[],this.party=!1}Target(...a){return this.target=a,this.builder}Owner(...a){return this.owner=a,this.builder}Party(a){return this.party=a,this.builder}getTarget(){return this.target}getOwner(){return this.owner}getParty(){return this.party}},xt=class{constructor(a){this.builder=a}Next(){return this.builder.Next()}Build(){return this.builder.Build()}Where(a){return this.builder.Where(a),this}};function kt(a,e){const s=[];for(const n of e)typeof n=="string"?a.filter(l=>l.Options.Name.toLowerCase()===n.toLowerCase()).forEach(l=>s.push(l)):typeof n=="function"?a.filter(l=>n(l)).forEach(l=>s.push(l)):a.filter(l=>l.Options.Name.match(n)).forEach(l=>s.push(l));return s}var kE=class extends xt{constructor(){super(...arguments),this.instances=[],this.mods=new Map,this.stat=[],this.target=0,this.usestacks=!1,this.values=[]}MapStat(a){return this.mapStatFn=a,this}Char(...a){return this.stat=a,this.target=0,this}Enemy(...a){return this.stat=a,this.target=1,this}Instance(...a){return this.instances=a,this.target=2,this}Values(...a){return this.usestacks=!1,this.values=a.map(e=>[e]),this}Stacks(...a){return this.usestacks=!0,a.length>0&&(this.values=a),this}Rank(a){return this.rankFn=a,this}Map(a){return this.mapFn=a,this}onBuild(a,e,s){const n=[];this.mapStatFn&&(this.stat=this.mapStatFn(a,e,s));const i=this.target===2?kt(a.GetInstances(),this.instances):[];switch(this.target){case 0:for(const l of this.stat)n.push(s.Modifier(a.GetCharacter().CreateModifier(l,0)));break;case 1:for(const l of this.stat)n.push(s.Modifier(a.GetCharacter().GetEnemy().Subject.CreateModifier(l,0)));break;case 2:for(const l of this.stat)for(const E of i)n.push(s.Modifier(E.Subject.CreateModifier(l,0)));break;default:throw new Error("Cannot create the modifier. Unknown target "+String(this.target).valueOf())}this.mods.set(a,n)}onEnable(a,e,s){const n=this.mods.get(a);if(!n)return;if(this.values.length===0){n.forEach(_=>_.SetValue(0));return}let i;this.rankFn?i=this.rankFn(a,e,s):i=e.GetRank(),i>this.values.length&&(i=this.values.length);const l=this.values[i-1];let E=UE(this.usestacks,l,e.GetStacks());this.mapFn&&(E=this.mapFn(E,a,e,s));for(const _ of n)_.GetValue()!==E&&_.SetValue(E)}onDisable(a){const e=this.mods.get(a);!e||e.forEach(s=>s.SetValue(0))}};function UE(a,e,s){if(a){const n=e.length;return n===1?e[0]*s:n>1?(s>n-1&&(s=n-1),e[s]):0}else return e[0]}var WE=class extends xt{constructor(){super(...arguments),this.infusions=new Map,this.element=c.NONE,this.max=!1}Set(a,e){return this.element=a,this.max=e,this}onBuild(a,e,s){if(this.element!==c.NONE){const n=s.Infusion(a.GetCharacter().AddInfusion(this.element,this.max));this.infusions.set(a,n)}}onEnable(a,e){const s=this.infusions.get(a);s&&(s.Enabled=e.Enabled())}onDisable(a){const e=this.infusions.get(a);e&&(e.Enabled=!1)}},jE=class extends xt{constructor(){super(...arguments),this.mvs=new Map,this.mults=new Map,this.type="mv",this.stat=c.NONE,this.value=0,this.instances=[]}Mv(a,e,...s){return this.stat=a,this.value=e,this.instances=s,this.type="mv",this}Multiplier(a,...e){return this.value=a,this.type="mult",this.instances=e,this}Map(a){return this.mapFn=a,this}onBuild(a,e,s){const n=kt(a.GetInstances(),this.instances);if(this.type==="mv"&&this.stat!==c.NONE&&this.value>0){const i=s.Mv({Enabled:!1,Stat:this.stat,Value:this.value},...n);this.mvs.set(a,i)}else if(this.type==="mult"&&this.value>0){const i=s.Multiplier({Enabled:!1,Value:this.value},...n);this.mults.set(a,i)}}onEnable(a,e,s){let n=this.mvs.get(a),i=this.mults.get(a);!n&&!i&&(this.onBuild(a,e,s),n=this.mvs.get(a),i=this.mults.get(a)),n&&(this.mapFn?n.Value=this.mapFn(this.value,a,e,s):n.Value=this.value),i&&(this.mapFn?i.Value=this.mapFn(this.value,a,e,s):i.Value=this.value)}onDisable(a){const e=this.mvs.get(a),s=this.mults.get(a);e&&(e.Value=0),s&&(s.Value=0)}},zE=class extends xt{constructor(){super(...arguments),this.store=new Map,this.location="Extra"}Location(a){return this.location=a,this}Options(a){return this.options=a,this}Basic(a){return this.builder.instance.Options({Name:a.Name,Element:a.Element,Talent:a.Talent||c.NONE,Scaling:[{Initial:0,Stat:c.NONE,Talent:c.NONE,Scaling:we.NONE}]}).Next().mv.Mv(a.Stat,a.Values[0],a.Name).Map((e,s,n)=>{const i=Math.max(1,Math.min(a.Values.length,n.GetRank()))-1;return a.Values[i]}),this}onBuild(a,e,s){if(!this.options)return;const n=mt(a.GetCharacter(),this.options);n[1].forEach(i=>s.Observer(i)),s.Instance(a,this.location,n[0]),this.store.set(a,n)}onEnable(a){const e=this.store.get(a);!e||(e[1].forEach(s=>s.Notify()),a.AddInstance(this.location,e[0]))}onDisable(a){const e=this.store.get(a);!e||a.RemoveInstance(this.location,e[0])}},Tt=class{constructor(){this.query={},this.container=[this],this.observe=new xE(this),this.stat=new kE(this),this.infusion=new WE(this),this.mv=new jE(this),this.instance=new zE(this),this.parts=[this.stat,this.infusion,this.mv,this.instance]}innerBuild(...[a,e,s]){s.StartQuery(this.query);const n=this.parts;n.forEach(_=>_.onBuild(a,e,s));const i=()=>n.forEach(_=>_.onEnable(a,e,s)),l=()=>n.forEach(_=>_.onDisable(a,e,s)),E=()=>{e.Enabled()&&VE(this.query,e.Owner,a,e)?i():l()};E();for(const _ of this.observe.getTarget())s.Observer(a.GetCharacter().CreateObserver(_,E));for(const _ of this.observe.getOwner())s.Observer(e.Owner.GetCharacter().CreateObserver(_,E));return this.observe.getParty()&&s.Observer(a.Event.CreateObserver(ct.CHANGE_PARTY,E)),s.EndQuery(),E}Build(){return(...[a,e,s])=>{const n=this.container.map(A=>A.innerBuild(a,e,s)),i=()=>n.forEach(A=>A());i();const l=a.GetCharacter(),E=e.Owner.GetCharacter(),_=l.GetEnemy();for(const A of[U.CHANGE_RANK,U.CHANGE_STACKS,U.CHANGE_CONDITIONS,U.CHANGE_AURAS,U.ENABLE,U.DISABLE])s.Observer(e.CreateObserver(A,i));for(const A of[c.LEVEL,c.ASCENSION,c.HP_CURRENT,c.ENERGY_CURRENT,c.SHIELDED])s.Observer(l.CreateObserver(A,i)),s.Observer(E.CreateObserver(A,i));return s.Observer(_.Event.CreateObserver(ot.CHANGE_AURA,i)),()=>0}}Next(){const a=new Tt;return a.container=this.container,this.container.push(a),a}Where(a){return this.query=a,this}};function Oa(a){return{enabled:a.Enabled(),rank:a.GetRank(),stacks:a.GetStacks(),auras:a.GetAuras(),conditions:a.GetConditions()}}function ya(a,e){a.enabled?e.Enable():e.Disable(),e.SetRank(a.rank),e.SetStacks(a.stacks),e.SetAuras(...a.auras),e.SetConditions(...a.conditions)}var ws=[Et({Name:"ResonancePyro",ApplyOther:!0,OnApply:new Tt().stat.Char(c.ATK_PERCENT).Values(.25).Build()})],Ys=[Et({Name:"ResonanceHydro",ApplyOther:!0,OnApply:new Tt().stat.Char(c.HP_PERCENT).Values(.25).Build()})],Fs=[Et({Name:"ResonanceCryo",ApplyOther:!0,OnApply:new Tt().stat.Char(c.EXTRA_CRIT_RATE).Where({enemy:{affected:[c.CRYO_DMG]}}).Values(.15).Build()})],Vs=[Et({Name:"ResonanceGeo",ApplyOther:!0,OnApply:new Tt().stat.Enemy(c.GEO_RES).Values(-.15).Next().Where({target:{shielded:!0}}).stat.Char(c.ALL_DMG).Values(.15).Build()})],xs=[Et({Name:"ResonanceDendro",ApplyOther:!0,Conditions:["BURNING","QUICKEN","BLOOM","AGGRAVATE","SPREAD","HYPERBLOOM","BURGEON"],MaxConditions:7,OnApply:new Tt().stat.Char(c.ELEMENTAL_MASTERY).Values(50).Next().stat.Char(c.ELEMENTAL_MASTERY).Values(30).Where({effect:{conditions:["BURNING","QUICKEN","BLOOM"]}}).Next().stat.Char(c.ELEMENTAL_MASTERY).Values(20).Where({effect:{conditions:["AGGRAVATE","SPREAD","HYPERBLOOM","BURGEON"]}}).Build()})],ks={[c.PYRO_DMG]:ws,[c.HYDRO_DMG]:Ys,[c.CRYO_DMG]:Fs,[c.GEO_DMG]:Vs,[c.DENDRO_DMG]:xs},Us=[];for(const a of Object.values(ks))a.forEach(e=>Us.push(e));function Ws(){return Us}function js(a){return ks[a]}var Mt={};R(Mt,{Factory:()=>Qs,Food:()=>qs,FoodType:()=>zs,Foodbox:()=>$s});var zs=(a=>(a[a.OFFENSIVE=0]="OFFENSIVE",a[a.DEFENSIVE=1]="DEFENSIVE",a[a.STAMINA=2]="STAMINA",a[a.ELEMENTAL=3]="ELEMENTAL",a))(zs||{}),qs=class{constructor(a,e){this.Options=a,this.Effect=e,this.Name=a.Name,this.Type=a.Type,this.Stars=a.Stars}GetRank(){return this.Effect.GetRank()}SetRank(a){a=Math.max(1,Math.min(3,a)),this.Effect.SetRank(a)}Unapply(){this.Effect.Disable(),this.Effect.UnapplyAll()}};function Qs(a){const e=a.Effects,s=Et({Name:a.Name,ApplyOther:!0,MaxRank:3,OnApply(n,i,l){const E=e.map(([A])=>l.Modifier(n.GetCharacter().CreateModifier(A,0))),_=()=>{const A=i.GetRank();for(let S=0;S<e.length;S++){const[,u,h]=e[S],L=u+(h-u)*(A-1)/2;E[S].SetValue(L)}};return _(),l.Observer(i.Event.CreateObserver(U.CHANGE_RANK,_)),l.Observer(n.Event.CreateObserver(ct.CHANGE_PARTY,()=>{const A=n.GetParty();if(!A)return;const S=i.GetTargets(),u=A.GetMembers();for(const h of u)S.includes(h)||i.Apply(h)})),()=>0}});return Object.assign(function(i){const l=s(i);l.Enable(),l.Apply(i);const E=i.GetParty();if(E)for(const _ of E.GetMembers())_!==i&&l.Apply(_);return new qs(a,l)},et(z({},a),{Options:a}))}var $s=class{constructor(a){this.target=a,this.byName=new W(e=>e.Name),this.byType=new Map}Add(a){const e=this.byType.get(a.Type);e&&(e.Unapply(),this.Remove(e.Name));const s=a(this.target);return this.byName.Add(s),this.byType.set(a.Type,s),s}Remove(a){const e=this.byName.Find(a);!e||(this.byName.Remove(e),this.byType.delete(e.Type),e.Unapply())}Clear(){for(const a of this.byName.Get())a.Unapply();this.byName.Clear(),this.byType.clear()}Get(a){return this.byName.Find(a)}GetByType(a){return this.byType.get(a)}GetAll(){return this.byName.Get()}},qE=class{constructor(...a){this.members=new W(e=>e.GetCharacter().Options.Name),this.resonances=[],this.enemies=new Ie,this.handler=new Ft(new fa({Name:"__party__",Region:pe.NONE,Stars:4,Element:0,Weapon:0,BurstCost:0})),this.handler.SetParty(this),this.foods=new $s(this.handler),a.forEach(e=>this.Add(e))}GetAppliedEffects(a){return this.GetAllEffects().filter(e=>e.GetTargets().includes(a))}GetResonances(){return this.resonances}GetAllEffects(){const a=[];return this.members.Get().forEach(e=>e.GetEffects().forEach(s=>a.push(s))),this.resonances.forEach(e=>a.push(e)),a}FindEffects(a){return a=a.toLowerCase(),this.GetAllEffects().filter(e=>e.Options.Name.toLowerCase()===a)}Add(a){if(this.members.Get().length>=4||this.members.Has(a))return!1;const e=a.GetParty();return e&&e.Remove(a),a.SetParty(this),this.members.Add(a),this.updateResonances(),this.members.Get().forEach(s=>s.Event.Notify(ct.CHANGE_PARTY)),this.enemies.Add(a.GetCharacter().GetEnemy()),!0}Remove(a){return this.members.Remove(a),a.SetParty(void 0),this.updateResonances(),this.members.Get().forEach(e=>e.Event.Notify(ct.CHANGE_PARTY)),a.Event.Notify(ct.CHANGE_PARTY),this.enemies.Remove(a.GetCharacter().GetEnemy()),!0}GetMembers(){return this.members.Get()}FindMember(a){return this.members.Find(a)}GetFoods(){return this.foods}updateResonances(){if(this.resonances.forEach(n=>n.Disable().UnapplyAll()),this.resonances=[],this.members.Get().length<4)return;const a={};Nt.forEach(n=>a[n]=0),this.members.Get().forEach(n=>a[n.GetCharacter().Options.Element]++);const e=[];Nt.forEach(n=>{a[n]>=2&&e.push(n)}),e.map(n=>js(n)).filter(n=>!!n).forEach(n=>n==null?void 0:n.forEach(i=>{const l=i(this.handler);l.Enable(),this.members.Get().forEach(E=>l.Apply(E)),this.resonances.push(l)}))}},m={};R(m,{Export:()=>Js,Factory:()=>QE,Import:()=>Zs,Weapon:()=>Xs});var Xs=class{constructor(a,e){this.Options=a,this.effects=new W(s=>s.Options.Name),this.level=1,this.ascension=0,this.rank=1,this.effects.AddList(e)}Equip(a){return this.target&&this.Unequip(),this.target=a,this.effects.Get().forEach(e=>e.Enable().Apply(a)),this.atkMod=a.GetCharacter().CreateModifier(c.ATK_BASE,0),this.subMod=a.GetCharacter().CreateModifier(this.Options.Substat,0),this.setMods(),this}Unequip(){var a,e;return this.effects.Get().forEach(s=>s.Disable().UnapplyAll()),(a=this.atkMod)==null||a.Disable(),(e=this.subMod)==null||e.Disable(),this.atkMod=void 0,this.subMod=void 0,this.target=void 0,this}GetLevel(){return this.level}GetAscension(){return this.ascension}IsAscended(){return this.GetAscension()===ft(this.level)}GetRank(){return this.rank}GetSubstat(){return this.Options.Substat}GetAtkBase(){return ze(this.Options.Stars,this.Options.Scaling,this.level,this.ascension)}GetSubstatValue(){return qe(this.Options.Scaling,this.level,this.Options.Substat)}GetEffects(){return this.effects.Get()}FindEffect(a){return this.effects.Find(a)}SetLevel(a){a=Math.max(1,Math.min(90,Math.floor(a)));const e=wt(a),s=ft(a);let n=this.ascension;return n<e?n=e:n>s&&(n=s),this.ascension=n,this.level=a,this.setMods(),this}SetAscension(a){const e=wt(this.level),s=ft(this.level);let n=a;return n<e?n=e:n>s&&(n=s),this.ascension=Math.floor(n),this.setMods(),this}SetRank(a){return a=Math.max(1,Math.min(5,Math.floor(a))),this.rank=a,this.effects.Get().forEach(e=>e.SetRank(a)),this}setMods(){var a,e;const s=this.GetAtkBase(),n=this.GetSubstatValue();(a=this.atkMod)==null||a.SetValue(s),(e=this.subMod)==null||e.SetValue(n)}};function QE(a){return Object.assign(function(s){const n=a.Effects.map(i=>i(s).Enable());return new Xs(a,n).Equip(s)},a)}function Js(a){return{level:a.GetLevel(),ascension:a.GetAscension(),rank:a.GetRank()}}function Zs(a,e){e.SetLevel(a.level),e.SetAscension(a.ascension),e.SetRank(a.rank)}var I={};R(I,{Artifact:()=>cn,Export:()=>En,Import:()=>Tn,Set:()=>$E,rolls:()=>Sn,transform:()=>_n});function $E(a){return a}var k=st("CHANGE_LEVEL","CHANGE_PIECE","CHANGE_STARS","CHANGE_SET","CHANGE_MAINSTAT","CHANGE_SUBSTAT"),tn={};R(tn,{CountRolls:()=>ln,FormatRolls:()=>on});function an(a,e,s,n){const i=e;function*l(E,_,A,S){let u=0;if(A===a-1)u=i-S;else if(A===a){S===i&&(yield E);return}s[A]>u&&(u=s[A]);let h=_;n[A]<h&&(h=n[A]);const L=_-u;for(let N=u;N<=h;N++){const f=[...E,N];yield*l(f,L,A+1,S+N)}}return l([],i,0,0)}var lt=class{constructor(a){this.queue=new Ee([],(e,s)=>s.priority-e.priority,!1),a?(this.mirror=new Ee([],(e,s)=>e.priority-s.priority,!1),this.maxSize=a):this.maxSize=1/0}Length(){return this.queue.length}Push(a,e){const s={item:a,priority:e};if(this.queue.push(s),this.mirror&&(this.mirror.push(s),this.queue.length>this.maxSize)){const n=this.mirror.pop();n&&this.queue.remove(n)}}Pop(){const a=this.queue.pop();if(!a)throw new Error("Priority queue is empty");return[a.item,a.priority]}Extract(){const a=[];for(;this.queue.length>0;)a.push(this.Pop()[0]);return a}};function en(a){const e=[];for(const[s,n]of a.substats){if(s===0)continue;const i=XE(a.stars,s,n);e.push([s,i])}return e}function XE(a,e,s){if(s===0)return[];const n=[];for(let E=0;E<4;E++)n.push(X(a,e,E));const i=new lt;sn.forEach(E=>{const _=E.map((S,u)=>S*n[u]).reduce((S,u)=>S+u,0),A=Math.floor(100*(Math.abs(_-s)/s));i.Push(E,-A)});const[l]=i.Pop();return l||[]}var JE=6,sn=[];for(let a=0;a<=JE;a++)for(const e of an(4,a,[0,0,0,0],[6,6,6,6]))sn.push(e);var ZE=he(AE()),nn=class{constructor(a){this.variables=a,this.ConstraintPrefix="_c_",this.ObjectivePrefix="_obj_",this._ints=[],this.objective={},this.constraints=[]}Ints(a){this._ints=a}Objective(a){return this.objective=a,a}Constraint(a,e){return this.constraints.push({left:a,right:e}),a}Format(){const a={},e={},s={};this.variables.forEach(n=>{const i=this.objective[n]||0;a[n]={[this.ObjectivePrefix]:i}}),this.constraints.forEach((n,i)=>{const l=this.ConstraintPrefix+i;e[l]={max:n.right},this.variables.forEach(E=>{const _=n.left[E];Number.isFinite(_)&&(a[E][l]=_)})});for(const n of this._ints)s[n]=!0;return{variables:a,constraints:e,ints:s}}Solve(a){const e=(0,ZE.Solve)(z({optimize:this.ObjectivePrefix,opType:a},this.Format()));for(const s of this.variables)e[s]||(e[s]=0);return e}toString(){return this.String()}String(){let a=this.variables.map(s=>"var "+s+(this._ints.includes(s)?" integer":"")+";").join(`
`);const e=this.Matrix();a+=`

maximize z: `+this.strExpr(e.c)+`;

`;for(let s=0;s<e.A.length;s++)a+="subject to c"+s+": "+this.strExpr(e.A[s])+" <= "+e.b[s]+`;
`;return a}Matrix(){const a={c:[],A:[],b:[]};this.putIndex(a.c,this.objective);for(const{left:e,right:s}of this.constraints){a.b.push(s);const n=Array.from(Array(this.variables.length)).fill(0);this.putIndex(n,e),a.A.push(n)}return a}putIndex(a,e){for(const s in e){const n=e[s],i=this.variables.indexOf(s);i!==-1&&(a[i]=n)}}strExpr(a){return this.variables.map((e,s)=>a[s]===0?"":a[s]+"*"+e).filter(e=>e!=="").join(" + ").replace(/\+\s*-/g,"-")}};function Ha(a,e,s){return a+"_"+e+"_"+s}function rn(a){const{level:e,stars:s}=a;if(e<0||e>20)throw new Error("Level must be between 0 and 20");if(s!==4&&s!==5)throw new Error("Stars must be 4 or 5");if(a.substats.length>4)throw new Error("Stats must be less or equal than 4");for(;a.substats.length<4;)a.substats.push([0,0]);const n=Math.floor(a.level/4),i=a.stars-2+n,l=i+1,E=a.substats.map(([C])=>C),_=a.substats.map(([,C])=>C),A=a.substats.map(([C])=>Ge.includes(C)?.5:.001),S=ha(a.stars),u=[];for(let C=0;C<4;C++)for(let G=0;G<4;G++)u.push(Ha("R",C,G));const h=new nn(u);h.Ints(u);const L=h.Objective({});for(const C of u)L[C]=1;const N=h.Constraint({},l),f=h.Constraint({},-i);for(let C=0;C<4;C++){const G=h.Constraint({},S),g=h.Constraint({},_[C]+A[C]),O=h.Constraint({},-_[C]+A[C]);for(let D=0;D<4;D++){const H=Ha("R",C,D);G[H]=1,N[H]=1,f[H]=-1,g[H]=X(s,E[C],D),O[H]=-g[H]}}const M=h.Solve("min");if(!M.feasible)throw new Error("[LP] Cannot find a feasible solution");const p=[];for(let C=0;C<4;C++){if(E[C]===0)continue;const G=[E[C],[]];for(let g=0;g<4;g++){const O=Ha("R",C,g),D=M[O]||0;G[1].push(D)}p.push(G)}return p}function ln(a,e="auto"){switch(e){case"auto":try{return rn(a)}catch{return en(a)}case"lp":return rn(a);case"brute":return en(a)}}function on(a,e){const s=[];for(const[n,i]of e){const l=[];for(let E=0;E<4;E++){const _=X(a,n,E);for(let A=0;A<i[E];A++)l.push(_)}s.push([n,l])}return s}var tT=0,cn=class{constructor(a){this.piece=a,this.Locked=!1,this.Id=tT++,this.Event=new it(k.Length(),"ARTIFACT_EVENT"),this.enabled=!0,this.stars=4,this.level=0,this.substats=[],this.modifiers=[],this.observers=[],this.mainstat=_a(a)[0]}GetPiece(){return this.piece}GetLevel(){return this.level}SetLevel(a){return this.stars===4?a=Math.min(16,a):this.stars===5&&(a=Math.min(20,a)),a<0&&(a=0),this.level=Math.floor(a),this.Event.Notify(k.CHANGE_LEVEL),this.Event.Notify(k.CHANGE_MAINSTAT),this}GetStars(){return this.stars}SetStars(a){if(a===4)this.GetLevel()>16&&this.SetLevel(16);else if(a===5)this.GetLevel()>20&&this.SetLevel(20);else throw new Error("Artifact stars must be 4 or 5");return this.stars=a,this.Event.Notify(k.CHANGE_STARS),this.Event.Notify(k.CHANGE_MAINSTAT),this}GetMainstat(){return this.mainstat}SetMainstat(a){if(_a(this.piece).includes(a)){const s=this.substats.findIndex(l=>l.Stat===a),n=Gt.filter(l=>!this.substats.find((E,_)=>_!==s&&E.Stat===l)),i=n.includes(this.mainstat)?this.mainstat:n[0];this.mainstat=a,s!==-1&&i&&this.SetSubstat(s,i),this.Event.Notify(k.CHANGE_MAINSTAT)}return this}GetMainstatValue(){return this.enabled?Qe(this.stars,this.mainstat,this.level):0}GetSet(){return this.set}SetSet(a){return this.set=a,this.Event.Notify(k.CHANGE_SET),this}SubstatsLength(){return this.substats.length}AddSubstat(a,e){if(this.substats.length===4||!Gt.includes(a)||[this.mainstat,...this.substats.map(i=>i.Stat)].includes(a))return!1;const n=La(this.stars,a);return e=Math.max(0,Math.min(n,e)),this.substats.push({Stat:a,Value:e}),this.Event.Notify(k.CHANGE_SUBSTAT),!0}GetSubstat(a){return this.substats[a].Stat}SetSubstat(a,e){if(this.mainstat===e||!Gt.includes(e))return!1;const s=this.substats.findIndex((l,E)=>E!==a&&l.Stat===e),n=X(this.stars,this.substats[a].Stat,1),i=X(this.stars,e,1);return s>-1&&(this.substats[s].Stat=this.substats[a].Stat,this.substats[s].Value*=n/i),this.substats[a].Stat=e,this.substats[a].Value*=i/n,this.Event.Notify(k.CHANGE_SUBSTAT),!0}GetSubstatValue(a){return this.enabled?this.substats[a].Value:0}SetSubstatValue(a,e){const s=La(this.stars,this.substats[a].Stat);return e=Math.max(0,Math.min(s,e)),this.substats[a].Value=e,this.Event.Notify(k.CHANGE_SUBSTAT),this}ClearSubstats(){return this.substats.forEach(a=>a.Value=0),this.Event.Notify(k.CHANGE_SUBSTAT),this}FillSubstats(){const a=Gt.filter(e=>e!==this.GetMainstat());for(let e=0;e<a.length;e++)this.AddSubstat(a[e],0);return this}FindSubstat(a){return this.substats.findIndex(e=>e.Stat===a)}Enable(){return this.enabled=!0,this.Event.Notify(k.CHANGE_MAINSTAT),this.Event.Notify(k.CHANGE_SUBSTAT),this}Disable(){return this.enabled=!1,this.Event.Notify(k.CHANGE_MAINSTAT),this.Event.Notify(k.CHANGE_SUBSTAT),this}Enabled(){return this.enabled}Unequip(){return this.character=void 0,this.modifiers.forEach(a=>a.Disable()),this.observers.forEach(a=>a.Remove()),this.modifiers=[],this.observers=[],this}Equip(a){this.character&&this.Unequip(),this.character=a;const e=a.CreateModifier(this.mainstat,this.GetMainstatValue()),s=this.Event.CreateObserver(k.CHANGE_MAINSTAT,()=>{e.SetProp(this.mainstat),e.SetValue(this.GetMainstatValue())}),n=[];for(let l=0;l<4;l++)n.push(a.CreateModifier(c.ATK_FLAT,0));const i=this.Event.CreateObserver(k.CHANGE_SUBSTAT,()=>{for(let l=0;l<4;l++)l<this.SubstatsLength()?(n[l].SetProp(this.GetSubstat(l)),n[l].SetValue(this.GetSubstatValue(l))):n[l].SetValue(0)});return i.Notify(),this.modifiers=[e,...n],this.observers=[s,i],this}Rolls(a="auto"){const e=this.substats.map(n=>[n.Stat,n.Value]);return ln({level:this.GetLevel(),stars:this.GetStars(),substats:e},a)}FormatRolls(){return on(this.GetStars(),this.Rolls())}};function En(a){const e={locked:a.Locked,piece:a.GetPiece(),stars:a.GetStars(),level:a.GetLevel(),set:a.GetSet(),mainstat:a.GetMainstat(),substats:[]};for(let s=0;s<a.SubstatsLength();s++)e.substats.push({stat:a.GetSubstat(s),value:a.GetSubstatValue(s)});return e}function Tn(a,e){if(a.piece!==e.GetPiece())throw new Error(`Cannot import artifacts with incompatible pieces ${$.Name(a.piece)} -> ${$.Name(e.GetPiece())}`);e.Locked=!!a.locked,e.SetStars(a.stars),e.SetLevel(a.level),e.SetSet(a.set),e.SetMainstat(a.mainstat),a.substats.forEach(({stat:s,value:n},i)=>{if(!Number.isFinite(n)||n<0)throw new Error(`Invalid substat ${i} value: ${n}`);i<e.SubstatsLength()?(e.SetSubstat(i,s),e.SetSubstatValue(i,n)):e.AddSubstat(s,n)})}var _n={};R(_n,{Downgrade:()=>aT,Scale:()=>An});function aT(a){a.GetStars()!==4&&(An(a,4),a.SetStars(4))}function An(a,e){const s=a.GetStars();for(let n=0;n<a.SubstatsLength();n++){const i=a.GetSubstat(n),l=a.GetSubstatValue(n),E=X(s,i,0),_=X(e,i,0),A=l*_/E;a.SetSubstatValue(n,A)}}var Sn={};R(Sn,{count:()=>tn,equip:()=>un});var un={};R(un,{EquipRolls:()=>hn});function J(a,e,s,n){return a+"_"+e+"_"+s+"_"+n}function eT(a){const e=a.substats.length;for(let L=0;L<5-e;L++)a.substats.push([c.NONE,0]);const s=[c.HP_FLAT,c.ATK_FLAT,...a.mainstats],n=a.substats.map(([L])=>L),i=a.substats.map(([,L])=>L),l=n.length;function E(L,N){return n[L]!==s[N]}const _=[],A=new nn(_),S=A.Objective({});for(let L=0;L<5;L++)for(let N=0;N<l;N++)for(let f=0;f<6;f++)_.push(J("S",N,L,f)),S[J("S",N,L,f)]=f+1,A.Constraint({[J("S",N,L,f)]:1},1);A.Ints(_);for(let L=0;L<5;L++){const N=A.Constraint({},9);for(let f=0;f<l;f++){const M=A.Constraint({},6),p=A.Constraint({[J("S",f,L,0)]:-5},0);for(let C=0;C<6;C++)M[J("S",f,L,C)]=1,N[J("S",f,L,C)]=1,E(f,L)||A.Constraint({[J("S",f,L,C)]:1},0);for(let C=1;C<6;C++)p[J("S",f,L,C)]=1}for(let f=0;f<6;f++){const M=A.Constraint({},4);for(let p=0;p<l;p++)M[J("S",p,L,f)]=1}}for(let L=0;L<l;L++){const N=A.Constraint({},-i[L]);for(let f=0;f<5;f++)for(let M=0;M<6;M++)N[J("S",L,f,M)]=-1}const u=A.Solve("min");if(!u.feasible)throw new Error("[LP] Cannot find a feasible solution");const h=[];for(let L=0;L<5;L++){const N=[];for(let f=0;f<l;f++){let M=0;for(let p=0;p<6;p++)M+=u[J("S",f,L,p)]||0;M>0&&N.push([n[f],M])}h.push(N)}return h}function hn(a){const e=eT(a);for(const s of e)for(const n of s){const i=X(a.stars,n[0],a.tier);n[1]*=i}return e}var It={};R(It,{FindByName:()=>fn,GetByType:()=>iT,GetList:()=>nT});var sT=[{Name:"SakuraShrimpCrackers",Type:1,Effects:[[c.HP_PERCENT,.2,.25]],Stars:3},{Name:"PileEmUp",Type:0,Effects:[[c.CRIT_RATE,.1,.2]],Stars:3},{Name:"AdeptusTemptation",Type:0,Effects:[[c.ATK_FLAT,260,372],[c.CRIT_RATE,.08,.12]],Stars:5},{Name:"AdventurersBreakfastSandwich",Type:0,Effects:[[c.ATK_FLAT,160,228]],Stars:3},{Name:"AlmondTofu",Type:0,Effects:[[c.ATK_FLAT,66,95]],Stars:2},{Name:"Baklava",Type:0,Effects:[[c.CRIT_RATE,.1,.2]],Stars:3},{Name:"BerryMintBurst",Type:0,Effects:[[c.CRIT_RATE,.16,.16]],Stars:2},{Name:"Biryani",Type:1,Effects:[[c.DEF_FLAT,215,308],[c.HEALING_BONUS,.06,.1]],Stars:4},{Name:"BountifulYear",Type:0,Effects:[[c.ATK_FLAT,224,320],[c.CRIT_RATE,.06,.1]],Stars:4},{Name:"BraisedMeat",Type:0,Effects:[[c.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"ButterChicken",Type:0,Effects:[[c.ATK_FLAT,160,228]],Stars:3},{Name:"ButterCrab",Type:1,Effects:[[c.DEF_FLAT,215,308],[c.HEALING_BONUS,.06,.1]],Stars:4},{Name:"CallaLilySeafoodSoup",Type:1,Effects:[[c.DEF_FLAT,165,235]],Stars:3},{Name:"CandiedAjilenakhNut",Type:1,Effects:[[c.DEF_FLAT,165,235]],Stars:3},{Name:"ChickenTofuPudding",Type:0,Effects:[[c.ATK_FLAT,224,320],[c.CRIT_RATE,.06,.1]],Stars:4},{Name:"ColdCutPlatter",Type:0,Effects:[[c.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"ComeandGetIt",Type:0,Effects:[[c.CRIT_RATE,.1,.2]],Stars:3},{Name:"CrabRoeKourayaki",Type:0,Effects:[[c.ATK_FLAT,66,95]],Stars:2},{Name:"CrocodileJerky",Type:0,Effects:[[c.ATK_FLAT,114,114]],Stars:2},{Name:"CuredPorkDryHotpot",Type:0,Effects:[[c.CRIT_RATE,.1,.2]],Stars:3},{Name:"DragonBeardNoodles",Type:0,Effects:[[c.ATK_FLAT,160,228]],Stars:3},{Name:"FishermansToast",Type:1,Effects:[[c.DEF_FLAT,88,126]],Stars:2},{Name:"FlamingEssentialOil",Type:3,Effects:[[c.PYRO_DMG,.25,.25]],Stars:3},{Name:"ForestEssentialOil",Type:3,Effects:[[c.DENDRO_DMG,.25,.25]],Stars:3},{Name:"FragrantMashedPotatoes",Type:0,Effects:[[c.ATK_FLAT,160,228]],Stars:3},{Name:"FriedRadishBalls",Type:0,Effects:[[c.ATK_FLAT,66,95]],Stars:2},{Name:"FrostingEssentialOil",Type:3,Effects:[[c.CRYO_DMG,.25,.25]],Stars:3},{Name:"FruitsoftheFestival",Type:1,Effects:[[c.HEALING_BONUS,.15,.2]],Stars:3},{Name:"GoldenCrab",Type:1,Effects:[[c.DEF_FLAT,215,308],[c.HEALING_BONUS,.06,.1]],Stars:4},{Name:"GoldenFriedChicken",Type:0,Effects:[[c.ATK_FLAT,224,320],[c.CRIT_RATE,.06,.1]],Stars:4},{Name:"GushingEssentialOil",Type:3,Effects:[[c.ANEMO_DMG,.25,.25]],Stars:3},{Name:"ImportedPoultry",Type:0,Effects:[[c.CRIT_RATE,.1,.2]],Stars:3},{Name:"JadeParcels",Type:0,Effects:[[c.ATK_FLAT,224,320],[c.CRIT_RATE,.06,.1]],Stars:4},{Name:"JewelrySoup",Type:1,Effects:[[c.DEF_FLAT,88,126]],Stars:2},{Name:"JueyunChiliChicken",Type:0,Effects:[[c.CRIT_RATE,.06,.12]],Stars:2},{Name:"JueyunGuoba",Type:0,Effects:[[c.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"KatsuSandwich",Type:0,Effects:[[c.ATK_FLAT,66,95]],Stars:2},{Name:"LanternRiteSpecialComeandGetIt",Type:0,Effects:[[c.CRIT_RATE,.2,.2]],Stars:3},{Name:"LanternRiteSpecialFriedRadishBalls",Type:0,Effects:[[c.ATK_FLAT,95,95]],Stars:2},{Name:"LanternRiteSpecialJewelrySoup",Type:1,Effects:[[c.DEF_FLAT,126,126]],Stars:2},{Name:"LotusFlowerCrisp",Type:1,Effects:[[c.DEF_FLAT,165,235]],Stars:3},{Name:"MasalaCheeseBalls",Type:0,Effects:[[c.CRIT_RATE,.06,.12]],Stars:2},{Name:"MeatLoversMushroomPizza",Type:0,Effects:[[c.ATK_FLAT,224,320],[c.CRIT_RATE,.06,.1]],Stars:4},{Name:"MintSalad",Type:0,Effects:[[c.ATK_FLAT,66,95]],Stars:2},{Name:"MoonPie",Type:1,Effects:[[c.DEF_FLAT,165,235]],Stars:4},{Name:"MoreandMore",Type:0,Effects:[[c.PHYSICAL_DMG,.2,.4]],Stars:3},{Name:"MushroomHodgepodge",Type:1,Effects:[[c.DEF_FLAT,88,126]],Stars:2},{Name:"QingceStirFry",Type:0,Effects:[[c.ATK_FLAT,160,228]],Stars:3},{Name:"RadishandFishStew",Type:0,Effects:[[c.CRIT_RATE,.06,.12]],Stars:2},{Name:"RiceCakeSoup",Type:1,Effects:[[c.DEF_FLAT,165,235]],Stars:3},{Name:"SashimiPlatter",Type:0,Effects:[[c.ATK_FLAT,224,320],[c.CRIT_RATE,.06,.1]],Stars:4},{Name:"SatisfyingSalad",Type:0,Effects:[[c.CRIT_RATE,.06,.12]],Stars:2},{Name:"SautedMatsutake",Type:0,Effects:[[c.ATK_FLAT,160,228]],Stars:3},{Name:"ShawarmaWrap",Type:0,Effects:[[c.ATK_FLAT,66,95]],Stars:2},{Name:"ShockingEssentialOil",Type:3,Effects:[[c.ELECTRO_DMG,.25,.25]],Stars:3},{Name:"StoneHarborDelicacies",Type:0,Effects:[[c.CRIT_RATE,.06,.12]],Stars:2},{Name:"StreamingEssentialOil",Type:3,Effects:[[c.HYDRO_DMG,.25,.25]],Stars:3},{Name:"SunsetBerryTea",Type:0,Effects:[[c.ATK_FLAT,160,228]],Stars:3},{Name:"TandooriRoastChicken",Type:0,Effects:[[c.ATK_FLAT,224,320],[c.CRIT_RATE,.06,.1]],Stars:4},{Name:"TianshuMeat",Type:0,Effects:[[c.PHYSICAL_DMG,.25,.45],[c.CRIT_RATE,.06,.1]],Stars:4},{Name:"TriFlavoredSkewer",Type:0,Effects:[[c.ATK_FLAT,160,228]],Stars:3},{Name:"UnagiChazuke",Type:1,Effects:[[c.HEALING_BONUS,.15,.2]],Stars:3},{Name:"UnmovingEssentialOil",Type:3,Effects:[[c.GEO_DMG,.25,.25]],Stars:3},{Name:"Wakatakeni",Type:1,Effects:[[c.DEF_FLAT,88,126]],Stars:2},{Name:"WolfhookJuice",Type:0,Effects:[[c.ATK_FLAT,114,114]],Stars:2},{Name:"OnceUponaTimeinMondstadt",Type:0,Effects:[[c.CRIT_RATE,.2,.2],[c.CRIT_DMG,.2,.2]],Stars:3},{Name:"SweetDream",Type:0,Effects:[[c.ATK_FLAT,114,114]],Stars:2},{Name:"APrizeCatch",Type:1,Effects:[[c.DEF_FLAT,282,282]],Stars:3},{Name:"DerWeisheitLetzterSchlussLife",Type:0,Effects:[[c.CRIT_RATE,.16,.16]],Stars:2},{Name:"DieHeiligeSinfonie",Type:0,Effects:[[c.PHYSICAL_DMG,.55,.55]],Stars:3},{Name:"FishFlavoredToast",Type:1,Effects:[[c.DEF_FLAT,151,151]],Stars:2},{Name:"ForestWatchersChoice",Type:1,Effects:[[c.DEF_FLAT,151,151]],Stars:2},{Name:"Halvamazd",Type:1,Effects:[[c.DEF_FLAT,282,282]],Stars:3},{Name:"HeartstringNoodles",Type:0,Effects:[[c.ATK_FLAT,274,274]],Stars:3},{Name:"NoTomorrow",Type:0,Effects:[[c.CRIT_RATE,.2,.2],[c.CRIT_DMG,.2,.2]],Stars:3},{Name:"QingceHouseholdDish",Type:0,Effects:[[c.ATK_FLAT,274,274]],Stars:3},{Name:"RockinRiffinChicken",Type:0,Effects:[[c.CRIT_RATE,.16,.16]],Stars:2},{Name:"ShimiChazuke",Type:1,Effects:[[c.HEALING_BONUS,.25,.25]],Stars:3},{Name:"ShowMetheMora",Type:0,Effects:[[c.ATK_FLAT,274,274]],Stars:3},{Name:"TheOnlyTruth",Type:0,Effects:[[c.ATK_FLAT,114,114]],Stars:2}],va=[...sT].sort((a,e)=>a.Stars===e.Stars?a.Name.localeCompare(e.Name):e.Stars-a.Stars).map(a=>Qs(a)),Ln=new W(a=>a.Name);Ln.AddList(va);var Ut=new Map,Nn;for(const a of va)Ut.has(a.Type)||Ut.set(a.Type,[]),(Nn=Ut.get(a.Type))==null||Nn.push(a);function nT(){return va}function fn(a){return Ln.Find(a)}function iT(a){return Ut.get(a)||[]}function mn(a){const e={},s={},n={};for(const _ of a.GetEffects())s[_.Options.Name]=Oa(_);const i=a.GetWeapon();i&&(e[i.Options.Name]=Js(i));const l=a.GetArtifacts();l&&$.Values().forEach(_=>n[_]=En(l.Get(_)));const E=a.GetModifiers().map(_=>({stat:_.GetProp(),value:_.GetValue()}));return{character:Es(a.GetCharacter()),weapon:e,effects:s,artifacts:n,modifiers:E}}function Mn(a,e){const s=e.GetWeapon();if(s){const i=a.weapon[s.Options.Name];i&&Zs(i,s)}const n=e.GetArtifacts();n&&$.Values().forEach(i=>{const l=a.artifacts[i];l&&Tn(l,n.Get(i))});for(const i of e.GetEffects()){const l=a.effects[i.Options.Name];!l||ya(l,i)}e.ClearModifiers();for(const{stat:i,value:l}of a.modifiers)e.AddModifier(e.GetCharacter().CreateModifier(i,l));Ts(a.character,e.GetCharacter())}function rT(a){const e={};for(const l of a.GetMembers())e[l.GetCharacter().Options.Name]=mn(l);const s={};for(const l of a.GetResonances())s[l.Options.Name]=Oa(l);const n={};for(const l of a.GetAllEffects()){const E=l.Owner.GetCharacter().Options.Name;n[E]||(n[E]={}),n[E][l.Options.Name]=l.GetTargets().map(_=>_.GetCharacter().Options.Name)}const i=a.GetFoods().GetAll().map(l=>[l.Name,l.GetRank()]);return{characters:e,resonances:s,targets:n,foods:i}}function lT(a,e){const s=e.GetMembers();for(const n of s){const i=a.characters[n.GetCharacter().Options.Name];i&&Mn(i,n)}for(const n of e.GetResonances()){const i=a.resonances[n.Options.Name];i&&ya(i,n)}for(const n of e.GetAllEffects()){const i=n.Owner.GetCharacter().Options.Name,l=n.Options.Name,E=a.targets[i];if(!E)continue;const _=E[l];if(!_)continue;const A=[];for(const S of s)_.includes(S.GetCharacter().Options.Name)&&A.push(S);n.ApplyMultiple(A)}if(e.GetFoods().Clear(),a.foods)for(const[n,i]of a.foods){const l=fn(n);if(!l)continue;e.GetFoods().Add(l).SetRank(i)}}var _t={};R(_t,{Artbox:()=>TT});var Z={};R(Z,{ArchaicPetra:()=>si,Berserker:()=>ni,BlizzardStrayer:()=>ii,BloodstainedChivalry:()=>Un,BraveHeart:()=>Wn,CrimsonWitchOfFlames:()=>Jn,DeepwoodMemories:()=>ei,DefenderWill:()=>jn,DesertPavilionChronicle:()=>gn,EchoesOfAnOffering:()=>zn,EmblemOfSeveredFate:()=>$n,FindByName:()=>Wt,FlowerOfParadiseLost:()=>dn,Gambler:()=>kn,GetList:()=>ri,GildedDreams:()=>xn,GladiatorsFinale:()=>Zn,HeartOfDepth:()=>Vn,HuskOfOpulentDreams:()=>Fn,Instructor:()=>Qn,Lavawalker:()=>Yn,MaidenBeloved:()=>wn,MartialArtist:()=>bn,NoblesseOblige:()=>qn,NymphsDream:()=>Gn,OceanHuedClam:()=>Kn,PaleFlame:()=>Bn,ResolutionOfSojourner:()=>Pn,RetracingBolide:()=>vn,Scholar:()=>Hn,ShimenawasReminiscence:()=>ti,TenacityOfTheMillelith:()=>yn,TheExile:()=>On,ThunderingFury:()=>Dn,Thundersoother:()=>In,VermillionHereafter:()=>Rn,ViridescentVenerer:()=>ai,VourukashasGlow:()=>pn,WanderersTroupe:()=>Xn});var Cn={};R(Cn,{ArchaicPetra:()=>si,Berserker:()=>ni,BlizzardStrayer:()=>ii,BloodstainedChivalry:()=>Un,BraveHeart:()=>Wn,CrimsonWitchOfFlames:()=>Jn,DeepwoodMemories:()=>ei,DefenderWill:()=>jn,DesertPavilionChronicle:()=>gn,EchoesOfAnOffering:()=>zn,EmblemOfSeveredFate:()=>$n,FlowerOfParadiseLost:()=>dn,Gambler:()=>kn,GildedDreams:()=>xn,GladiatorsFinale:()=>Zn,HeartOfDepth:()=>Vn,HuskOfOpulentDreams:()=>Fn,Instructor:()=>Qn,Lavawalker:()=>Yn,MaidenBeloved:()=>wn,MartialArtist:()=>bn,NoblesseOblige:()=>qn,NymphsDream:()=>Gn,OceanHuedClam:()=>Kn,PaleFlame:()=>Bn,ResolutionOfSojourner:()=>Pn,RetracingBolide:()=>vn,Scholar:()=>Hn,ShimenawasReminiscence:()=>ti,TenacityOfTheMillelith:()=>yn,TheExile:()=>On,ThunderingFury:()=>Dn,Thundersoother:()=>In,VermillionHereafter:()=>Rn,ViridescentVenerer:()=>ai,VourukashasGlow:()=>pn,WanderersTroupe:()=>Xn});var pn=I.Set({Name:"VourukashasGlow",Stars:5,Piece2:[r.Factory({Name:"VourukashasGlow2",OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2).Build()})],Piece4:[r.Factory({Name:"VourukashasGlow4",MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.1).Next().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.1).Next().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.08).Stacks().Next().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.08).Stacks().Next().Build()})]}),Gn=I.Set({Name:"NymphsDream",Stars:5,Piece2:[r.Factory({Name:"NymphsDream2",OnApply:new r.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"NymphsDream4",MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Stacks([0,.07,.16,.25]).Next().stat.Char(t.stat.HYDRO_DMG).Stacks([0,.04,.09,.15]).Build()})]}),dn=I.Set({Name:"FlowerOfParadiseLost",Stars:5,Piece2:[r.Factory({Name:"FlowerOfParadiseLost2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[r.Factory({Name:"FlowerOfParadiseLost4",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.BLOOM_DMG,t.stat.HYPERBLOOM_DMG,t.stat.BURGEON_DMG).Values(.4).Next().stat.Char(t.stat.BLOOM_DMG,t.stat.HYPERBLOOM_DMG,t.stat.BURGEON_DMG).Values(.4*.25).Stacks().Next().Build()})]}),gn=I.Set({Name:"DesertPavilionChronicle",Stars:5,Piece2:[r.Factory({Name:"DesertPavilionChronicle2",OnApply:new r.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"DesertPavilionChronicle4",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.4).Build()})]}),Rn=I.Set({Name:"VermillionHereafter",Stars:5,Piece2:[r.Factory({Name:"VermillionHereafter2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"VermillionHereafter4",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.08).Next().stat.Char(t.stat.ATK_PERCENT).Values(.1).Stacks().Build()})]}),In=I.Set({Name:"Thundersoother",Stars:5,Piece2:[],Piece4:[r.Factory({Name:"Thundersoother4",OnApply:new r.Builder().Where({enemy:{affected:[t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.35).Build()})]}),Dn=I.Set({Name:"ThunderingFury",Stars:5,Piece2:[r.Factory({Name:"ThunderingFury2",OnApply:new r.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"ThunderingFury4",OnApply:new r.Builder().stat.Char(t.stat.OVERLOAD_DMG,t.stat.ELECTROCHARGE_DMG,t.stat.SUPERCONDUCT_DMG,t.stat.HYPERBLOOM_DMG).Values(.4).Next().stat.Char(t.stat.AGGRAVATE_DMG).Values(.2).Build()})]}),On=I.Set({Name:"TheExile",Stars:4,Piece2:[r.Factory({Name:"TheExile2",OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[]}),yn=I.Set({Name:"TenacityOfTheMillelith",Stars:5,Piece2:[r.Factory({Name:"TenacityOfTheMillelith2",OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2).Build()})],Piece4:[r.Factory({Name:"TenacityOfTheMillelith4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()})]}),Hn=I.Set({Name:"Scholar",Stars:4,Piece2:[r.Factory({Name:"Scholar2",OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[]}),vn=I.Set({Name:"RetracingBolide",Stars:5,Piece2:[],Piece4:[r.Factory({Name:"RetracingBolide4",OnApply:new r.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.4).Build()})]}),Pn=I.Set({Name:"ResolutionOfSojourner",Stars:4,Piece2:[r.Factory({Name:"ResolutionOfSojourner2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"ResolutionOfSojourner4",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_RATE).Values(.3).Build()})]}),Bn=I.Set({Name:"PaleFlame",Stars:5,Piece2:[r.Factory({Name:"PaleFlame2",OnApply:new r.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.25).Build()})],Piece4:[r.Factory({Name:"PaleFlame4",MaxStacks:2,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.09).Stacks().Next().stat.Char(t.stat.PHYSICAL_DMG).Stacks([0,0,.25]).Build()})]}),Kn=I.Set({Name:"OceanHuedClam",Stars:5,Piece2:[r.Factory({Name:"OceanHuedClam2",OnApply:new r.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.15).Build()})],Piece4:[r.Factory({Name:"OceanHuedClam4",MaxStacks:3e4,OnApply(a,e,s){const[,,n]=s.Instance(a,"Extra",Ca("HIT_OceanHuedClam",a.GetCharacter()));n.Options.Def=!1,n.Options.Crit=!1,n.Options.Dmg=!1;const i=s.Modifier(n.Subject.CreateModifier(t.stat.DMG_FLAT,0));function l(){const E=e.GetStacks()*.9;i.SetValue(E)}return l(),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_STACKS,l)),()=>0}})]}),bn=I.Set({Name:"MartialArtist",Stars:4,Piece2:[r.Factory({Name:"MartialArtist2",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"MartialArtist4",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.25).Build()})]}),wn=I.Set({Name:"MaidenBeloved",Stars:5,Piece2:[r.Factory({Name:"MaidenBeloved2",OnApply:new r.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.15).Build()})],Piece4:[]}),Yn=I.Set({Name:"Lavawalker",Stars:5,Piece2:[],Piece4:[r.Factory({Name:"Lavawalker4",OnApply:new r.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.35).Build()})]}),Fn=I.Set({Name:"HuskOfOpulentDreams",Stars:5,Piece2:[r.Factory({Name:"HuskOfOpulentDreams2",OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Build()})],Piece4:[r.Factory({Name:"HuskOfOpulentDreams4",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT,t.stat.GEO_DMG).Values(.06).Stacks().Build()})]}),Vn=I.Set({Name:"HeartOfDepth",Stars:5,Piece2:[r.Factory({Name:"HeartOfDepth2",OnApply:new r.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"HeartOfDepth4",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.3).Build()})]}),xn=I.Set({Name:"GildedDreams",Stars:5,Piece2:[r.Factory({Name:"GildedDreams2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[r.Factory({Name:"GildedDreams4",OnApply(a,e,s){const n=a.GetCharacter(),i=n.Options.Element,l=s.Modifier(n.CreateModifier(t.stat.ELEMENTAL_MASTERY,0)),E=s.Modifier(n.CreateModifier(t.stat.ATK_PERCENT,0));function _(){const A=a.GetParty();if(!A){l.SetValue(0),E.SetValue(0);return}let S=0,u=0;for(const h of A.GetMembers())h!==a&&(h.GetCharacter().Options.Element===i?S++:u++);S=Math.min(3,S),u=Math.min(3,u),E.SetValue(.14*S),l.SetValue(50*u)}return _(),s.Observer(a.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,_)),()=>0}})]}),kn=I.Set({Name:"Gambler",Stars:4,Piece2:[r.Factory({Name:"Gambler2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.2).Build()})],Piece4:[]}),Un=I.Set({Name:"BloodstainedChivalry",Stars:5,Piece2:[r.Factory({Name:"BloodstainedChivalry2",OnApply:new r.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.25).Build()})],Piece4:[r.Factory({Name:"BloodstainedChivalry4",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.5).Build()})]}),Wn=I.Set({Name:"BraveHeart",Stars:4,Piece2:[r.Factory({Name:"BraveHeart2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"BraveHeart4",OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.3).Build()})]}),jn=I.Set({Name:"DefendersWill",Stars:4,Piece2:[r.Factory({Name:"DefendersWill2",OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Build()})],Piece4:[]}),zn=I.Set({Name:"EchoesOfAnOffering",Stars:5,Piece2:[r.Factory({Name:"EchoesOfAnOffering2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"EchoesOfAnOffering4",Conditions:["AVERAGE","MAXIMUM"],MaxConditions:1,OnApply:new r.Builder().Where({effect:{conditions:["MAXIMUM"]}}).mv.Mv(t.stat.ATK,.7,a=>a.Options.Talent===t.stat.NORMAL_ATTACK_DMG).Next().Where({effect:{conditions:["AVERAGE"]}}).mv.Mv(t.stat.ATK,.7*.502,a=>a.Options.Talent===t.stat.NORMAL_ATTACK_DMG).Build()})]}),qn=I.Set({Name:"NoblesseOblige",Stars:5,Piece2:[r.Factory({Name:"NoblesseOblige2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.2).Build()})],Piece4:[r.Factory({Name:"NoblesseOblige4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()})]}),Qn=I.Set({Name:"Instructor",Stars:4,Piece2:[r.Factory({Name:"Instructor2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[r.Factory({Name:"Instructor4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(120).Build()})]}),$n=I.Set({Name:"EmblemOfSeveredFate",Stars:5,Piece2:[r.Factory({Name:"EmblemOfSeveredFate2",OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()})],Piece4:[r.Factory({Name:"EmblemOfSeveredFate4",OnApply:new r.Builder().observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.25).Map((a,e)=>Math.max(0,Math.min(.75,a*e.GetCharacter().Get(t.stat.ENERGY_RECHARGE)))).Build()})]}),Xn=I.Set({Name:"WanderersTroupe",Stars:5,Piece2:[r.Factory({Name:"WanderersTroupe2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(80).Build()})],Piece4:[r.Factory({Name:"WanderersTroupe4",OnApply:new r.Builder().stat.Where({target:{weapon:[t.weapon.BOW,t.weapon.CATALYST]}}).Char(t.stat.CHARGED_ATTACK_DMG).Values(.35).Build()})]}),Jn=I.Set({Name:"CrimsonWitchOfFlames",Stars:5,Piece2:[r.Factory({Name:"CrimsonWitchOfFlames2",OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"CrimsonWitchOfFlames4",MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.VAPORIZE_DMG,t.stat.MELT_DMG).Values(.15).Next().stat.Char(t.stat.OVERLOAD_DMG,t.stat.BURGEON_DMG,t.stat.BURNING_DMG).Values(.4).Next().stat.Char(t.stat.PYRO_DMG).Values(.075).Stacks().Build()})]}),Zn=I.Set({Name:"GladiatorsFinale",Stars:5,Piece2:[r.Factory({Name:"GladiatorsFinale2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"GladiatorsFinale4",OnApply:new r.Builder().Where({target:{weapon:[t.weapon.CLAYMORE,t.weapon.SWORD,t.weapon.POLEARM]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.35).Build()})]}),ti=I.Set({Name:"ShimenawasReminiscence",Stars:5,Piece2:[r.Factory({Name:"ShimenawasReminiscence2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.18).Build()})],Piece4:[r.Factory({Name:"ShimenawasReminiscence4",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.5).Build()})]}),ai=I.Set({Name:"ViridescentVenerer",Stars:5,Piece2:[r.Factory({Name:"ViridescentVenerer2",OnApply:new r.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"ViridescentVenerer4_1",OnApply:new r.Builder().stat.Char(t.stat.SWIRL_DMG).Values(.6).Build()}),r.Factory({Name:"ViridescentVenerer4",ApplyOther:!0,ValidAuras:t.Swirlable,MaxAuras:5,OnApply(a,e,s){const n=a.GetCharacter().GetEnemy(),i=cT.map(E=>s.Modifier(n.Subject.CreateModifier(E,0)));function l(){if(e.Owner.GetCharacter().Options.Element!==t.stat.ANEMO_DMG)return;const E=e.GetAuras().map(_=>t.DmgToRes(t.AuraToDmg(_)));for(const _ of i)E.includes(_.GetProp())?_.SetValue(oT):_.SetValue(0)}return l(),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_AURAS,l)),()=>0}})]}),oT=-.4,cT=t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG).map(a=>t.DmgToRes(a)),ei=I.Set({Name:"DeepwoodMemories",Stars:5,Piece2:[r.Factory({Name:"DeepwoodMemories2",OnApply:new r.Builder().stat.Char(t.stat.DENDRO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"DeepwoodMemories4",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.DENDRO_RES).Values(-.3).Build()})]}),si=I.Set({Name:"ArchaicPetra",Stars:5,Piece2:[r.Factory({Name:"ArchaicPetra2",OnApply:new r.Builder().stat.Char(t.stat.GEO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"ArchaicPetra4",MaxAuras:1,ApplyOther:!0,ValidAuras:t.Swirlable,OnApply(a,e,s){const n=a.GetCharacter(),i=t.Elements.filter(E=>E!==t.stat.PHYSICAL_DMG).map(E=>s.Modifier(n.CreateModifier(E,0)));function l(){const E=e.GetAuras().map(_=>t.AuraToDmg(_));for(const _ of i)E.includes(_.GetProp())?_.SetValue(.4):_.SetValue(0)}return s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_AURAS,l)),()=>0}})]}),ni=I.Set({Name:"Berserker",Stars:4,Piece2:[r.Factory({Name:"Berserker2",OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.12).Build()})],Piece4:[r.Factory({Name:"Berserker4",OnApply:new r.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.CRIT_RATE).Values(.24).Build()})]}),ii=I.Set({Name:"BlizzardStrayer",Stars:5,Piece2:[r.Factory({Name:"BlizzardStrayer2",OnApply:new r.Builder().stat.Char(t.stat.CRYO_DMG).Values(.15).Build()})],Piece4:[r.Factory({Name:"BlizzardStrayer4",OnApply:new r.Builder().Where({enemy:{affected:[t.stat.CRYO_DMG]}}).stat.Char(t.stat.EXTRA_CRIT_RATE).Values(.2).Next().Where({enemy:{aura:[t.aura.FROZEN]}}).stat.Char(t.stat.EXTRA_CRIT_RATE).Values(.2).Next().Build()})]}),ET=Object.values(Cn).sort((a,e)=>a.Stars===e.Stars?a.Name.localeCompare(e.Name):a.Stars-e.Stars),Pa=new W(a=>a.Name);Pa.AddList(ET);function ri(){return Pa.Get()}function Wt(a){return Pa.Find(a)}function li(a){const e=[];for(const i of a){if(!i)continue;const l=e.find(E=>E[0].toLowerCase()===i.toLowerCase());l?l[1]++:e.push([i.toLowerCase(),1])}const s=[],n=[];for(const i of e)i[1]>=4?(s.push([i[0],4]),n.push(i[0]),n.push(i[0])):i[1]>=2&&(s.push([i[0],2]),n.push(i[0]));return[s,n]}var TT=class{constructor(a){this.target=a,this.effects=new W(e=>e.Options.Name),this.sets=[],this.artifacts=$.Values().map(e=>{const s=new cn(e).Equip(a.GetCharacter());return s.Event.CreateObserver(k.CHANGE_SET,()=>this.onChangeSet()),s})}GetArtifacts(){return this.artifacts}GetActiveSets(){return this.sets}onChangeSet(){const[a,e]=li(this.artifacts.map(s=>s.GetSet()||""));this.effects.Get().forEach(s=>s.Disable().UnapplyAll()),this.effects.Clear(),this.sets=e;for(const[s,n]of a){if(!s)continue;const i=Wt(s);!i||(n>=2&&i.Piece2.map(l=>{const E=l(this.target).Enable();return E.Apply(this.target),E}).forEach(l=>this.effects.Add(l)),n>=4&&i.Piece4.map(l=>{const E=l(this.target).Enable();return E.Apply(this.target),E}).forEach(l=>this.effects.Add(l)))}}UnequipAll(){return this.artifacts.forEach(a=>a.Unequip()),this}EquipAll(){return this.artifacts.forEach(a=>a.Equip(this.target.GetCharacter())),this}GetEffects(){return this.effects.Get()}FindEffect(a){return this.effects.Find(a)}Get(a){return this.artifacts[a]}Remove(){this.UnequipAll(),this.effects.Get().forEach(a=>a.Disable().UnapplyAll())}EquipRolls(a){try{const e=hn(z({stars:5,mainstats:[this.artifacts[2].GetMainstat(),this.artifacts[3].GetMainstat(),this.artifacts[4].GetMainstat()]},a));return this.artifacts.forEach((s,n)=>{const i=e[n];s.ClearSubstats(),i.forEach(([l,E],_)=>{s.SubstatsLength()<=_?s.AddSubstat(l,E):(s.SetSubstat(_,l),s.SetSubstatValue(_,E))})}),!0}catch(e){return console.error("[EQUIP SUBSTATS]",e),!1}}RollSummary(){const a=oi(),e=[],s={};for(const n of this.artifacts){const i=n.Rolls();for(const[l,E]of i){s[l]===void 0&&(s[l]=e.length,e.push([l,oi()]));const[,_]=e[s[l]];for(let A=0;A<4;A++)_[A]+=E[A]||0,a[A]+=E[A]||0,_[4]+=E[A]||0,a[4]+=E[A]||0}for(let l=0;l<n.SubstatsLength();l++){const E=n.GetSubstat(l),_=n.GetSubstatValue(l),A=Math.round(_/X(n.GetStars(),E,4));a[5]+=A,e[s[E]][1][5]+=A}}return{result:e,total:a}}},oi=()=>[0,0,0,0,0,0],jt={};R(jt,{Rotation:()=>_T});var _T=class{constructor(){this.characters=new W(a=>a.GetCharacter().Options.Name),this.actions=[],this.damage=0,this.Duration=NaN,this.details=[]}SetCharacters(...a){return this.characters.Clear(),this.characters.AddList(a),this}Run(){let a=-1;return this.Log&&(a=this.Log.Line),this.damage=0,this.details=[],this.actions.forEach(e=>this.runAction(e)),this.Log&&(this.Log.Line=a),this.damage}AddFn(a,e){return this.actions.push({fn:a,line:e}),this}AddHit(a,e,s,n,i,l){return i=Math.max(0,Math.min(1,i)),n=Math.max(0,Math.min(i,n)),this.actions.push({hit:{charname:a,hitname:e,multiplier:s,aura:i,reaction:n},line:l}),this}Clear(){return this.actions=[],this}GetDetails(){const a={};return this.details.forEach((e,s)=>{a[e.charname]||(a[e.charname]=[]),a[e.charname][s]=e}),a}GetSummary(){const a={damage:this.damage,dps:this.damage/this.Duration,duration:this.Duration,characters:{}};for(const e of this.characters.Get())a.characters[e.GetCharacter().Options.Name]={relative:0,damage:0,dps:0,elements:{},talents:{},instances:{}};for(const{charname:e,hitname:s,talent:n,element:i,damage:l}of this.details){const E=a.characters[e];E.damage+=l,E.elements[i]||(E.elements[i]={damage:0,relative:0}),E.elements[i].damage+=l,E.talents[n]||(E.talents[n]={damage:0,relative:0}),E.talents[n].damage+=l,E.instances[s]||(E.instances[s]={damage:0,relative:0}),E.instances[s].damage+=l}for(const e in a.characters){const s=a.characters[e];s.dps=s.damage/this.Duration,s.relative=s.damage/this.damage;for(const n in s.instances)s.instances[n].relative=s.instances[n].damage/s.damage;for(const n in s.talents)s.talents[n].relative=s.talents[n].damage/s.damage;for(const n in s.elements)s.elements[n].relative=s.elements[n].damage/s.damage}return a}getCharacter(a){const e=this.characters.Find(a);return e||this.Log&&this.Log.Errorf("Character not found: %s",a),e}getInstance(a,e){const s=this.getCharacter(a);if(!s)return;const n=s.FindInstance(e);return n||this.Log&&this.Log.Errorf("Instance %s not found in character %s",e,a),n}addDamage(a){this.damage+=a.damage,this.Log&&this.details.push(a)}runAction(a){if(a.line&&this.Log&&(this.Log.Line=a.line),a.fn){a.fn();return}if(!a.hit)return;const{hit:e}=a,s=this.getCharacter(e.charname);if(!s)return;const n=this.getInstance(e.charname,e.hitname);if(!n)return;const i=s.GetCharacter().Options.Name,l=n.Options.Name,E=s.GetCharacter().GetEnemy(),_=E.GetAuras(),A=n.DmgAvg(!0),S=n.DmgAvg(!1);E.SetAuras();const u=n.DmgAvg(!1),h=u;E.SetAuras(..._);const L=cs(u,h,S,A,e.aura,e.reaction),N=e.multiplier*L;this.addDamage({charname:i,hitname:l,talent:n.Options.Talent,element:n.GetElement(),damage:N,single_damage:L,multiplier:e.multiplier,auras:_,noaura_noreaction:u,noaura_yesreaction:h,yesaura_noreaction:S,yesaura_yesreaction:A,aura:e.aura,reaction:e.reaction}),this.Log&&this.Log.Logf("%s hit %s did (%.2f * %.2f) = %.2f damage",i,l,e.multiplier,L,N)}},At={};R(At,{Albedo:()=>zi,Alhaitham:()=>ji,Amber:()=>Wi,Ayaka:()=>Bi,Ayato:()=>Pi,Beidou:()=>qi,Bennett:()=>tr,Chongyun:()=>ki,Collei:()=>xi,Cyno:()=>Vi,Dehya:()=>_i,Diluc:()=>Fi,Eula:()=>Yi,Faruzan:()=>Ai,FindByName:()=>k1,Fischl:()=>ar,Ganyu:()=>wi,GetList:()=>ir,Gorou:()=>bi,HuTao:()=>$i,Itto:()=>Ui,Jean:()=>Ki,Kazuha:()=>er,Keqing:()=>vi,Klee:()=>Hi,Kokomi:()=>Ri,Mika:()=>Ti,Mona:()=>yi,Nahida:()=>nr,Nilou:()=>ui,Ningguang:()=>Oi,Noelle:()=>Di,Raiden:()=>Zi,Rosaria:()=>Ii,Sara:()=>sr,Shenhe:()=>gi,Sucrose:()=>di,Tartaglia:()=>Gi,Venti:()=>pi,Wanderer:()=>Ci,Xiangling:()=>Mi,Xiao:()=>mi,Xingqiu:()=>Qi,Yae:()=>fi,Yanfei:()=>Ni,Yelan:()=>Xi,Yoimiya:()=>Li,Yunjin:()=>hi,Zhongli:()=>Ji});var ci={};R(ci,{Albedo:()=>zi,Alhaitham:()=>ji,Amber:()=>Wi,Ayaka:()=>Bi,Ayato:()=>Pi,Beidou:()=>qi,Bennett:()=>tr,Chongyun:()=>ki,Collei:()=>xi,Cyno:()=>Vi,Dehya:()=>_i,Diluc:()=>Fi,Eula:()=>Yi,Faruzan:()=>Ai,Fischl:()=>ar,Ganyu:()=>wi,Gorou:()=>bi,HuTao:()=>$i,Itto:()=>Ui,Jean:()=>Ki,Kazuha:()=>er,Keqing:()=>vi,Klee:()=>Hi,Kokomi:()=>Ri,Mika:()=>Ti,Mona:()=>yi,Nahida:()=>nr,Nilou:()=>ui,Ningguang:()=>Oi,Noelle:()=>Di,Raiden:()=>Zi,Rosaria:()=>Ii,Sara:()=>sr,Shenhe:()=>gi,Sucrose:()=>di,Tartaglia:()=>Gi,Venti:()=>pi,Wanderer:()=>Ci,Xiangling:()=>Mi,Xiao:()=>mi,Xingqiu:()=>Qi,Yae:()=>fi,Yanfei:()=>Ni,Yelan:()=>Xi,Yoimiya:()=>Li,Yunjin:()=>hi,Zhongli:()=>Ji});var AT=r.Factory({Name:"MikaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),ST=r.Factory({Name:"MikaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),uT=r.Factory({Name:"MikaC6",ApplyOther:!0,MaxTargets:1,OnApply:new r.Builder().stat.Char(t.stat.PHYSICAL_CRIT_DMG).Values(.6).Build()}),T={};R(T,{ArrObjTable:()=>gT,Artifact:()=>CT,ArtifactRolls:()=>GT,Character:()=>NT,Effect:()=>mT,EffectDetail:()=>MT,Enemy:()=>RT,Food:()=>yT,Horizontal:()=>rt,Instance:()=>LT,ObjArrTable:()=>dT,Rotation:()=>DT,Table:()=>F,hits:()=>hT,labels:()=>y});var F=class{constructor(...a){this.DecimalPlaces=2,this.HeaderLine=!0,this.rows=[a],this.n_cols=a.length}AddRow(...a){for(;a.length<this.n_cols;)a.push("");return this.rows.push(a),this}GetHeaders(){return this.rows[0]}GetRows(){return this.rows.slice(1)}toString(){return this.String()}String(){const a=this.n_cols,e=this.rows.length,s=[],n=[];for(let l=0;l<a;l++){let E=0;for(let _=0;_<e;_++){const A=this.rows[_][l];let S;typeof A=="number"?S=A.toFixed(this.DecimalPlaces):S=(A==null?void 0:A.toString())||"",S.length>E&&(E=S.length),s[_*a+l]=S}n[l]=E}for(let l=0;l<a;l++)for(let E=0;E<e;E++){const _=n[l];for(;s[E*a+l].length<_;)s[E*a+l]+=" "}let i="";for(let l=0;l<e;l++){for(let E=0;E<a;E++)i+=s[l*a+E]+" | ";if(this.HeaderLine&&l===0){i+=`
`;const E=i.length;for(let _=0;_<E;_++)i+="-"}i+=`
`}return i}};function Ei(...a){const e={};return a.forEach(s=>{if(typeof s=="string")e[s]=s;else for(const n in s)e[n]=n}),e}var hT=Ei("HIT_N1","HIT_N1_1","HIT_N1_2","HIT_N1_3","HIT_N1_4","HIT_N2","HIT_N2_1","HIT_N2_2","HIT_N2_3","HIT_N2_4","HIT_N3","HIT_N3_1","HIT_N3_2","HIT_N3_3","HIT_N3_4","HIT_N4","HIT_N4_1","HIT_N4_2","HIT_N4_3","HIT_N4_4","HIT_N5","HIT_N5_1","HIT_N5_2","HIT_N5_3","HIT_N5_4","HIT_N6","HIT_N6_1","HIT_N6_2","HIT_N6_3","HIT_N6_4","HIT_CHARGED","HIT_CHARGED_1","HIT_CHARGED_2","HIT_CHARGED_3","HIT_CHARGED_4","HIT_CHARGED_SPIN","HIT_CHARGED_FINAL","HIT_PLUNGE","HIT_PLUNGE_LOW","HIT_PLUNGE_HIGH","HIT_AIMED_NORMAL","HIT_AIMED_CHARGED","HIT_E","HIT_E_PRESS","HIT_E_HOLD","HIT_E_DOT","HIT_E_1","HIT_E_1_1","HIT_E_1_2","HIT_E_2","HIT_E_2_1","HIT_E_2_2","HIT_E_3","HIT_E_3_1","HIT_E_3_2","HIT_E_4","HIT_E_EXPLOSION","HIT_Q","HIT_Q_EXPLOSION","HIT_Q_DOT","HIT_Q_1","HIT_Q_2","HIT_Q_3","HIT_WEAPON_HIT","HIT_WEAPON_HIT_N1","HIT_WEAPON_HIT_N2","HIT_WEAPON_HIT_N3","HIT_WEAPON_HIT_N4","HIT_WEAPON_HIT_N5","HIT_WEAPON_HIT_N6","HIT_OVERLOAD","HIT_SHATTER","HIT_SUPERCONDUCT","HIT_ELECTROCHARGE","HIT_SWIRL_PYRO","HIT_SWIRL_HYDRO","HIT_SWIRL_CRYO","HIT_SWIRL_ELECTRO","HIT_BLOOM","HIT_HYPERBLOOM","HIT_BURNING","HIT_BURGEON"),y=Ei("REGION","NONE","NAME","MV","STAT","HIT","ELEMENT","TALENT","VALUE","NO_CRIT","CRIT","AVG","STAT_BASE","STAT_FLAT","STAT_PERCENT","STAT_TOTAL","SET","PIECE","LEVEL","BONUS","STARS","CHARACTER","ASCENDED","CURRENT","WEAPON","ARTIFACT","EFFECT","ENABLED","STACKS","AURA","TARGET","CONDITION","DAMAGE","MIN","MAX","HIT","OWNER","RELATIVE","BENEFIT","ROTATION_DAMAGE","DPS");function LT(...a){const e=new F(y.HIT,y.ELEMENT,y.TALENT,y.NO_CRIT,y.CRIT,y.AVG);return a.forEach(s=>e.AddRow(s.Options.Name,t.stat.Name(s.GetElement()),t.stat.Name(s.Options.Talent),s.DmgNoCrit(!0),s.DmgCrit(!0),s.DmgAvg(!0))),e.String()}function NT(...a){const e=[];for(let s=0;s<a.length;s++)e[2*s]=fT(a[s]),e[2*s+1]=" ".repeat(4);return rt(...e)}function fT(a){var e;const s=a.GetCharacter();let n;s.IsAscended()?n="+":n="";let i=`(${s.Options.Stars}*) ${s.Options.Name} ${s.GetLevel()}${n}`;i+=` (${s.Get(t.stat.NORMAL_ATTACK_LEVEL)}/${s.Get(t.stat.ELEMENTAL_SKILL_LEVEL)}/${s.Get(t.stat.ELEMENTAL_BURST_LEVEL)})
`;const l=a.GetWeapon();l?(l.IsAscended()?n="+":n="",i+=`(${l.Options.Stars}*) ${l.Options.Name} ${l.GetLevel()}${n} (R${l.GetRank()})
`):i+=`(No weapon)
`;const E=(e=a.GetArtifacts())==null?void 0:e.GetActiveSets();if(E&&E.length>0){const S=E.map(u=>{var h;return(h=Wt(u))==null?void 0:h.Name});S[0]===S[1]?i+=S[0]+` (4)
`:S.forEach(u=>{u&&u!==""&&(i+=u+` (2)
`)})}const _=new F(y.STAT,y.VALUE);_.DecimalPlaces=4,_.AddRow(t.stat.Name(t.stat.ATK),s.Get(t.stat.ATK)),_.AddRow(t.stat.Name(t.stat.DEF),s.Get(t.stat.DEF)),_.AddRow(t.stat.Name(t.stat.HP),s.Get(t.stat.HP)),_.AddRow(t.stat.Name(t.stat.CRIT_RATE),s.Get(t.stat.CRIT_RATE)),_.AddRow(t.stat.Name(t.stat.CRIT_DMG),s.Get(t.stat.CRIT_DMG)),_.AddRow(t.stat.Name(t.stat.ENERGY_RECHARGE),s.Get(t.stat.ENERGY_RECHARGE)),_.AddRow(t.stat.Name(t.stat.ELEMENTAL_MASTERY),s.Get(t.stat.ELEMENTAL_MASTERY));const A=s.Options.Element;return _.AddRow(t.stat.Name(A),s.Get(A)),i+=_.String(),i}function mT(...a){const e=new F(y.NAME,y.ENABLED,y.STACKS,y.OWNER,y.TARGET);for(const s of a){const n=s.GetTargets().map(i=>i.GetCharacter().Options.Name);e.AddRow(s.Options.Name,s.Enabled(),s.GetStacks(),s.Owner.GetCharacter().Options.Name,n.join(", "))}return e.String()}function MT(a){let e=a.Options.Name+`
`;const s=new F(y.OWNER,y.ENABLED,y.STACKS);s.AddRow(a.Owner.GetCharacter().Options.Name,a.Enabled(),a.GetStacks()+"/"+a.Options.MaxStacks),e+=s.String()+`
`;const n=new F(y.TARGET);for(const E of a.GetTargets())n.AddRow(E.GetCharacter().Options.Name);const i=new F(y.CONDITION);for(const E of a.Options.Conditions)i.AddRow(E+" ("+a.HasCondition(E)+")");const l=new F(y.AURA);for(const E of t.aura.Values())a.HasAura(E)&&l.AddRow(t.aura.Name(E));return e+=rt(n.String(),i.String(),l.String()),e}function CT(...a){const e=[];for(let s=0;s<a.length;s++)e[2*s]=pT(a[s]),e[2*s+1]=" ".repeat(4);return rt(...e)}function pT(a){let e=`(${a.GetStars()}*) ${t.piece.Name(a.GetPiece())} (+${a.GetLevel()})
`;const s=a.GetSet();if(s){const i=Wt(s);i?e+=y.SET+": "+i.Name+`
`:e+=y.SET+": "+y.NONE+`
`}else e+=y.SET+": "+y.NONE+`
`;const n=new F(y.STAT,y.VALUE);n.DecimalPlaces=4,n.AddRow(t.stat.Name(a.GetMainstat()),a.GetMainstatValue());for(let i=0;i<a.SubstatsLength();i++)n.AddRow(t.stat.Name(a.GetSubstat(i)),a.GetSubstatValue(i));return e+=n.String(),e}function GT(a){const e=a.FormatRolls(),s=new F(y.STAT,"","","","","","");return e.forEach(([n,i])=>s.AddRow(t.stat.Name(n),...i)),s.DecimalPlaces=4,`${t.piece.Name(a.GetPiece())}
`+s}function dT(a){const e=Object.keys(a),s=new F(...e),n=Math.max(...e.map(i=>a[i].length));for(let i=0;i<n;i++){const l=[];for(const E of e)i<a[E].length?l.push(a[E][i]):l.push(void 0);s.AddRow(...l)}return s}function gT(a){const e=[];for(const n of a){const i=Object.keys(n);for(const l of i)e.includes(l)||e.push(l)}const s=new F(...e);for(const n of a)s.AddRow(...e.map(i=>n[i]));return s}function RT(...a){const e=[];for(let s=0;s<a.length;s++)e[2*s]=IT(a[s]),e[2*s+1]=" ".repeat(4);return rt(...e)}function IT(a){const e=new F(y.STAT,y.STAT_BASE,y.STAT_TOTAL);e.AddRow(y.LEVEL,"",a.GetLevel());for(const n of t.Elements){const i=t.DmgToRes(n);e.AddRow(t.stat.Name(i),a.GetBaseRes(i),a.Subject.Get(i))}const s=new F(y.AURA);for(const n of t.aura.Values())a.HasAura(n)&&s.AddRow(t.aura.Name(n));return e.DecimalPlaces=4,a.name+`
`+rt(e.String(),s.String())}function DT(a){const e=Object.keys(a.characters).map(n=>n+`
`+OT(n,a.characters[n])),s=[];for(let n=0;n<e.length;n++)s[2*n]=e[n],s[2*n+1]=" ".repeat(4);return`${y.ROTATION_DAMAGE}: ${a.damage.toFixed(2)}

${y.DPS}: ${a.dps.toFixed(2)}

`+rt(...s)}function OT(a,e){const s=new F(y.NAME,y.DAMAGE,y.RELATIVE);s.AddRow(a,e.damage,zt(e.relative));for(const n in e.elements){const i=parseInt(n);s.AddRow(t.stat.Name(i),e.elements[n].damage,zt(e.elements[n].relative))}for(const n in e.talents){const i=parseInt(n);s.AddRow(t.stat.Name(i),e.talents[n].damage,zt(e.talents[n].relative))}for(const n in e.instances)s.AddRow(n,e.instances[n].damage,zt(e.instances[n].relative));return s.toString()}var zt=a=>a*100;function yT(...a){const e=new F("NAME","STARS","TYPE","EFFECTS");for(const s of a){const n=(()=>{if(s instanceof Mt.Food){const i=s.GetRank();return s.Options.Effects.map(([l,E,_])=>{const A=E+(_-E)*(i-1)/2;return`${t.stat.Name(l)}: ${A}`}).join(", ")}else return s.Effects.map(([i,l,E])=>`${t.stat.Name(i)}: ${l}-${E}`).join(", ")})();e.AddRow(s.Name,s.Stars,s.Type,n)}return e.String()}var HT=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4326}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.415}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.545}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2761}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7087}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1275}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],vT=r.Factory({Name:"MikaA1",MaxStacks:4,ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.PHYSICAL_DMG).Values(.1).Stacks().Build()}),PT=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.252}]}],Ti=d.Factory({Name:"Mika",Element:t.stat.CRYO_DMG,Stars:4,Weapon:t.weapon.POLEARM,StatBonus:t.stat.HP_PERCENT,BurstCost:70,Region:t.region.MONDSTADT,HpBase:[1048.5597,3751.7275],AtkBase:[18.6984,66.90411],DefBase:[59.800125,213.96375],Normals:HT,Skills:PT,Bursts:[],Extra:[],Effects:[vT,AT,ST,uT]}),BT=[{Name:T.hits.HIT_N1+"_Q",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.987},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0169}]},{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.393},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.0239}]}],KT=r.Factory({Name:"DehyaC1",OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2).Next().mv.Mv(t.stat.HP,.036,a=>a.Options.Talent===t.stat.ELEMENTAL_SKILL_DMG).Next().mv.Mv(t.stat.HP,.06,a=>a.Options.Talent===t.stat.ELEMENTAL_BURST_DMG).Build()}),bT=r.Factory({Name:"DehyaC2",OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Instance("HIT_E_DOT").Values(.5).Build()}),wT=r.Factory({Name:"DehyaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),YT=r.Factory({Name:"DehyaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),FT=r.Factory({Name:"DehyaC6",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.1).Next().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_DMG).Values(.15).Stacks().Build()}),VT=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6212}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6171}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7663}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9529}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5633}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0182}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],xT=[{Name:T.hits.HIT_E_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1288}]},{Name:T.hits.HIT_E_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.328}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.602},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0103}]}],_i=d.Factory({Name:"Dehya",Stars:5,Element:t.stat.PYRO_DMG,Weapon:t.weapon.CLAYMORE,StatBonus:t.stat.HP_PERCENT,Region:t.region.SUMERU,BurstCost:70,HpBase:[1220.2496,5011.0044],AtkBase:[20.6682,84.8686],DefBase:[48.88111,200.7369],Normals:VT,Skills:xT,Bursts:BT,Extra:[],Effects:[KT,bT,wT,YT,FT]}),kT=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.776}]}],UT=r.Factory({Name:"FaruzanQ",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.ANEMO_RES).Values(-.3).Next().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ANEMO_DMG).Values(...o.TalentScaling.ELEMENTAL_1).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(a=>a*.18).Build()}),WT=r.Factory({Name:"FaruzanC3",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),jT=r.Factory({Name:"FaruzanC5",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),zT=r.Factory({Name:"FaruzanC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ANEMO_CRIT_DMG).Values(.4).Build()}),qT=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4473}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4219}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5316}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7062}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],QT=r.Factory({Name:"FaruzanA4",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:4}}).observe.Owner(t.stat.ATK_BASE).stat.Char(t.stat.ANEMO_DMG_FLAT).Values(.32).Map((a,e,s)=>s.Owner.GetCharacter().Get(t.stat.ATK_BASE)*a).Build()}),$T=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.488}]},{Name:T.hits.HIT_E_2,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.08}]}],Ai=d.Factory({Name:"Faruzan",Stars:4,Element:t.stat.ANEMO_DMG,Weapon:t.weapon.BOW,StatBonus:t.stat.ATK_PERCENT,BurstCost:80,Region:t.region.SUMERU,HpBase:[802.3761,2870.8872],AtkBase:[16.4724,58.939335],DefBase:[52.647,188.37],Normals:qT,Skills:$T,Bursts:kT,Extra:[],Effects:[UT,QT,WT,jT,zT]}),XT=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1843}]},{Name:T.hits.HIT_Q_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.2253}]}],JT=r.Factory({Name:"NilouC1",OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Instance("HIT_E_3_1").Values(.65).Build()}),ZT=r.Factory({Name:"NilouC2",ApplyOther:!0,Conditions:["BLOOM"],MaxConditions:1,OnApply:new r.Builder().Where({owner:{ascension:1}}).stat.Enemy(t.stat.HYDRO_RES).Values(-.35).Next().Where({owner:{ascension:1},effect:{conditions:["BLOOM"]}}).stat.Enemy(t.stat.DENDRO_RES).Values(-.35).Build()}),t_=r.Factory({Name:"NilouC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),a_=r.Factory({Name:"NilouC4",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.5).Build()}),e_=r.Factory({Name:"NilouC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),s_=r.Factory({Name:"NilouC6",OnApply:new r.Builder().observe.Target(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.Char(t.stat.CRIT_RATE).Values(.6/100).Map((a,e)=>Math.max(0,Math.min(.3,a*e.GetCharacter().Get(t.stat.HP)/1e3))).Next().observe.Target(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.Char(t.stat.CRIT_DMG).Values(1.2/100).Map((a,e)=>Math.max(0,Math.min(.6,a*e.GetCharacter().Get(t.stat.HP)/1e3))).Build()}),n_=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5031}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4544}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7035}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5022}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5444}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}];function Si(a){const e=a.GetParty();if(!e)return!1;let s=!1,n=!1;for(const i of e.GetMembers()){const l=i.GetCharacter().Options.Element;if(l===t.stat.DENDRO_DMG)s=!0;else if(l===t.stat.HYDRO_DMG)n=!0;else return!1}return s&&n}var i_=r.Factory({Name:"NilouA1",ApplyOther:!0,OnApply:new r.Builder().Where((a,e)=>e.GetCharacter().GetAscension()<1?!1:Si(a)).observe.Party(!0).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100).Build()}),r_=r.Factory({Name:"NilouA4",ApplyOther:!0,OnApply:new r.Builder().Where((a,e)=>e.GetCharacter().GetAscension()<4?!1:Si(a)).observe.Party(!0).observe.Owner(t.stat.HP_FLAT,t.stat.HP_BASE,t.stat.HP_PERCENT).stat.Char(t.stat.BLOOM_DMG).Values(.09).Map((a,e,s)=>Math.max(0,Math.min(4,(s.Owner.GetCharacter().Get(t.stat.HP)-3e4)*a/1e3))).Build()}),l_=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0334}]},{Name:T.hits.HIT_E_1+"_1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0455}]},{Name:T.hits.HIT_E_1+"_2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0326}]},{Name:T.hits.HIT_E_2+"_1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0514}]},{Name:T.hits.HIT_E_2+"_2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0396}]},{Name:T.hits.HIT_E_3+"_1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0717}]},{Name:T.hits.HIT_E_3+"_2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0506}]}],ui=d.Factory({Name:"Nilou",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.SWORD,StatBonus:t.stat.HP_PERCENT,Region:t.region.SUMERU,BurstCost:70,HpBase:[1182.1168,4854.4106],AtkBase:[17.8752,73.39987],DefBase:[56.71884,232.9236],Normals:n_,Skills:l_,Bursts:XT,Extra:[],Effects:[i_,r_,JT,ZT,t_,a_,e_,s_]}),Ba=new Set,Ka=[.025,.05,.075,.115];function o_(a){const e=a.FindEffect("YunjinA4");if(!e||!e.Enabled()||a.GetCharacter().GetAscension()<4)return 0;const s=a.GetParty();if(!s)return Ka[0];Ba.clear();for(const i of s.GetMembers()){const l=i.GetCharacter().Options.Element;Ba.add(l)}const n=Math.max(1,Math.min(Ka.length,Ba.size));return Ka[n-1]}var c_=r.Factory({Name:"YunjinA4",OnApply(a,e,s){const n=a.FindEffect("YunjinQ");if(!n)throw new Error("Yunjin Burst effect not found");const i=n;function l(){i.Enabled()&&(i.Disable(),i.Enable())}return l(),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,l)),s.Observer(e.CreateObserver(r.EffectEvent.DISABLE,l)),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_TARGET,l)),()=>0}}),E_=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.44}]}],T_=r.Factory({Name:"YunjinQ",ApplyOther:!0,OnApply:new r.Builder().observe.Party(!0).observe.Owner(t.stat.DEF_PERCENT,t.stat.DEF_BASE,t.stat.DEF_FLAT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((a,e,s)=>(.3216*a+o_(s.Owner))*s.Owner.GetCharacter().Get(t.stat.DEF)).Build()}),__=r.Factory({Name:"YunjinC2",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.15).Build()}),A_=r.Factory({Name:"YunjinC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),S_=r.Factory({Name:"YunjinC4",OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.2).Build()}),u_=r.Factory({Name:"YunjinC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),h_=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4051}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4025}]},{Name:T.hits.HIT_N3_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2296}]},{Name:T.hits.HIT_N3_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2752}]},{Name:T.hits.HIT_N4_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2399}]},{Name:T.hits.HIT_N4_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2881}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6734}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2169}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],L_=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.4912}]},{Name:T.hits.HIT_E_1,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.6096}]},{Name:T.hits.HIT_E_2,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.728}]}],hi=d.Factory({Name:"Yunjin",Stars:4,Weapon:t.weapon.POLEARM,Element:t.stat.GEO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Region:t.region.LIYUE,BurstCost:60,HpBase:[893.5552,3197.1245],AtkBase:[16.0272,57.34638],DefBase:[61.5741,220.311],Normals:h_,Skills:L_,Bursts:E_,Extra:[],Effects:[T_,c_,__,A_,S_,u_]}),N_=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.272}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.22}]}],f_=r.Factory({Name:"YoimiyaC1",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2).Build()}),m_=r.Factory({Name:"YoimiyaC2",OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Values(.25).Build()}),M_=r.Factory({Name:"YoimiyaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),C_=r.Factory({Name:"YoimiyaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),p_=r.Factory({Name:"YoimiyaC6",OnApply:new r.Builder().instance.Location("Normal").Options({Name:"HIT_C6",Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Talent:t.stat.NORMAL_ATTACK_LEVEL,Initial:.164*.6}]}).Build()}),G_=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3564}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6838}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8889}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4642}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0586}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_KindlingArrow",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.164}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],d_=r.Factory({Name:"YoimiyaA1",MaxStacks:10,OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.PYRO_DMG).Values(.02).Stacks().Build()}),g_=r.Factory({Name:"YoimiyaA4",ApplyOther:!0,ApplySelf:!1,OnApply(a,e,s){const n=a.GetCharacter(),i=e.Owner.GetCharacter(),l=e.Owner.FindEffect("YoimiyaA1");if(!l)throw new Error("Cannot find Yoimiya A1");const E=s.Modifier(n.CreateModifier(t.stat.ATK_PERCENT,0)),_=()=>{if(i.GetAscension()<4){E.SetValue(0);return}E.SetValue(.1+.01*l.GetStacks())};return _(),s.Observer(i.CreateObserver(t.stat.LEVEL,_)),s.Observer(i.CreateObserver(t.stat.ASCENSION,_)),s.Observer(l.CreateObserver(r.EffectEvent.CHANGE_STACKS,_)),()=>0}}),R_=r.Factory({Name:"YoimiyaE",OnApply:new r.Builder().infusion.Set(t.stat.PYRO_DMG,!0).Next().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.3791,/hit_n\d/i).Map((a,e)=>1+a*o.TalentScaling.ELEMENTAL_2[e.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),Li=d.Factory({Name:"Yoimiya",Stars:5,Weapon:t.weapon.BOW,Element:t.stat.PYRO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.INAZUMA,BurstCost:60,HpBase:[791.2556,3249.3232],AtkBase:[25.137,103.21857],DefBase:[47.864,196.56],Normals:G_,Skills:[],Bursts:N_,Extra:[],Effects:[R_,d_,g_,f_,m_,M_,C_,p_]}),I_=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.824}]}],D_=r.Factory({Name:"YanfeiQ",OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(...o.TalentScaling.ELEMENTAL_2).Rank(a=>a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(a=>.334*a).Build()}),O_=r.Factory({Name:"YanfeiC2",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_RATE).Values(.2).Build()}),y_=r.Factory({Name:"YanfeiC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),H_=r.Factory({Name:"YanfeiC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),v_=[{Name:T.hits.HIT_N1,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5834}]},{Name:T.hits.HIT_N2,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5213}]},{Name:T.hits.HIT_N3,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.7601}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_2,Initial:.9823}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],P_=r.Factory({Name:"YanfeiA1",OnApply(a,e,s){const n=a.GetCharacter(),i=a.FindEffect("YanfeiSeal");if(!i)throw new Error("Cannot find Yanfei Scarlet Seals");const l=s.Modifier(n.CreateModifier(t.stat.PYRO_DMG,0)),E=()=>{if(n.GetAscension()<1){l.SetValue(0);return}l.SetValue(i.GetStacks()*.05)};return E(),s.Observer(i.CreateObserver(r.EffectEvent.CHANGE_STACKS,E)),s.Observer(n.CreateObserver(t.stat.LEVEL,E)),s.Observer(n.CreateObserver(t.stat.ASCENSION,E)),()=>0}}),B_=r.Factory({Name:"YanfeiA4",OnApply:new r.Builder().Where({target:{ascension:4}}).instance.Location("Normal").Options({Name:"HIT_A4",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Initial:.8,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),K_=r.Factory({Name:"YanfeiSeal",MaxStacks:4,OnApply:new r.Builder().observe.Target(t.stat.NORMAL_ATTACK_LEVEL,t.stat.NORMAL_ATTACK_LEVEL_UP).mv.Mv(t.stat.ATK,.1733,"HIT_CHARGED").Map((a,e,s)=>a*s.GetStacks()*o.TalentScaling.ELEMENTAL_2[e.GetCharacter().Get(t.stat.NORMAL_ATTACK_LEVEL)-1]).Build()}),b_=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.696}]}],Ni=d.Factory({Name:"Yanfei",Stars:4,Element:t.stat.PYRO_DMG,StatBonus:t.stat.PYRO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.LIYUE,BurstCost:80,HpBase:[784.14026,2805.64],AtkBase:[20.12304,72.001564],DefBase:[49.2135,176.085],Normals:v_,Skills:b_,Bursts:I_,Extra:[],Effects:[K_,D_,P_,B_,O_,y_,H_]}),w_=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.6}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.3382}]}],Y_=r.Factory({Name:"YaeC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),F_=r.Factory({Name:"YaeC4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.2).Build()}),V_=r.Factory({Name:"YaeC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),x_=r.Factory({Name:"YaeC6",OnApply:new r.Builder().stat.Char(t.stat.DEFIGNORED).Instance(/HIT_E_\d/i).Values(.6).Build()}),k_=[{Name:T.hits.HIT_N1,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3966}]},{Name:T.hits.HIT_N2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3852}]},{Name:T.hits.HIT_N3,Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5689}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4289}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],U_=r.Factory({Name:"YaeA4",OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({target:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.15/100).Map((a,e)=>a*e.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()}),W_=[{Name:T.hits.HIT_E_1,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6067}]},{Name:T.hits.HIT_E_2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7584}]},{Name:T.hits.HIT_E_3,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.948}]},{Name:T.hits.HIT_E_4,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.185}]}],fi=d.Factory({Name:"Yae",Stars:5,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_RATE,Weapon:t.weapon.CATALYST,Region:t.region.INAZUMA,BurstCost:90,HpBase:[807.46204,3315.8757],AtkBase:[26.4404,108.57064],DefBase:[44.2742,181.818],Normals:k_,Skills:W_,Bursts:w_,Extra:[],Effects:[U_,Y_,F_,V_,x_]}),j_=r.Factory({Name:"XiaoQ",OnApply:new r.Builder().infusion.Set(t.stat.ANEMO_DMG,!0).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(...o.TalentScaling.ELEMENTAL_2).Rank(a=>a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map(a=>.5845*a).Build()}),z_=r.Factory({Name:"XiaoC2",OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.25).Build()}),q_=r.Factory({Name:"XiaoC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Q_=r.Factory({Name:"XiaoC4",OnApply:new r.Builder().Where({target:{hp:{leq:.5}}}).stat.Char(t.stat.DEF_PERCENT).Values(1).Build()}),$_=r.Factory({Name:"XiaoC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),X_=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.2754}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.5694}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6855}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.3766}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.7154}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.9583}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.2109}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],J_=r.Factory({Name:"XiaoA1",MaxStacks:5,OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.ALL_DMG).Values(.05).Stacks().Build()}),Z_=r.Factory({Name:"XiaoA4",MaxStacks:3,OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.15).Stacks().Build()}),tA=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.528}]}],mi=d.Factory({Name:"Xiao",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.CRIT_RATE,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,BurstCost:70,HpBase:[991.4528,4071.4412],AtkBase:[27.1852,111.628975],DefBase:[62.2232,255.528],Normals:X_,Skills:tA,Bursts:[],Extra:[],Effects:[j_,J_,Z_,z_,q_,Q_,$_]}),aA=[{Name:T.hits.HIT_Q_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]},{Name:T.hits.HIT_Q_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_Q_3,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.096}]},{Name:"HIT_PYRONADO",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.12}]}],eA=r.Factory({Name:"XianglingC1",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.PYRO_RES).Values(-.15).Build()}),sA=r.Factory({Name:"XianglingC2",OnApply:new r.Builder().instance.Options({Name:"HIT_C2",Element:t.stat.PYRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.75,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),nA=r.Factory({Name:"XianglingC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),iA=r.Factory({Name:"XianglingC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),rA=r.Factory({Name:"XianglingC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Build()}),lA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4205}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4214}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2606}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.141}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7104}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.2169}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],oA=r.Factory({Name:"XianglingA4",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.ATK_PERCENT).Values(.1).Build()}),cA=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1128}]}],Mi=d.Factory({Name:"Xiangling",Stars:4,Element:t.stat.PYRO_DMG,StatBonus:t.stat.ELEMENTAL_MASTERY,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,BurstCost:80,HpBase:[911.791,3262.3718],AtkBase:[18.87648,67.54129],DefBase:[56.0805,200.655],Normals:lA,Skills:cA,Bursts:aA,Extra:[],Effects:[oA,eA,sA,nA,iA,rA]}),EA=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.472}]}],TA=r.Factory({Name:"WandererC1",OnApply(a,e,s){if(!a.FindEffect("WandererA4"))throw new Error("Cannot find Wanderer A4");let i;const l=()=>{const E=a.FindInstance("HIT_A4");!E||i||(i=s.Mv({Stat:t.stat.ATK,Value:.25,Enabled:!0},E))};return l(),s.Observer(a.GetCharacter().CreateObserver(t.stat.LEVEL,l)),s.Observer(a.GetCharacter().CreateObserver(t.stat.ASCENSION,l)),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,l)),s.Observer(e.CreateObserver(r.EffectEvent.DISABLE,l)),()=>0}}),_A=r.Factory({Name:"WandererC2",MaxStacks:120,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.04).Stacks().Map(a=>Math.min(2,a)).Build()}),AA=r.Factory({Name:"WandererC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),SA=r.Factory({Name:"WandererC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),uA=[{Name:T.hits.HIT_N1,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6871}]},{Name:T.hits.HIT_N2,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6502}]},{Name:T.hits.HIT_N3,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4764}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.3208}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]},{Name:T.hits.HIT_N1+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6871*.4}]},{Name:T.hits.HIT_N2+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6502*.4}]},{Name:T.hits.HIT_N3+"_C6",Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4764*.4}]}],hA=r.Factory({Name:"WandererA1",MaxAuras:1,ValidAuras:t.Swirlable,OnApply:new r.Builder().Where({target:{ascension:1},effect:{affected:[t.stat.PYRO_DMG]}}).stat.Char(t.stat.ATK_PERCENT).Values(.3).Next().Where({target:{ascension:1},effect:{affected:[t.stat.CRYO_DMG]}}).stat.Char(t.stat.CRIT_RATE).Values(.2).Build()}),LA=r.Factory({Name:"WandererA4",OnApply:new r.Builder().Where({target:{ascension:4}}).instance.Options({Name:"HIT_A4",Element:t.stat.ANEMO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.35,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),NA=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.952}]}],fA=r.Factory({Name:"WandererE",OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.3298,/hit_n\d/i).Map((a,e)=>1+a*o.TalentScaling.ELEMENTAL_2[e.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Multiplier(.2639,/hit_charged/i).Map((a,e)=>1+a*o.TalentScaling.ELEMENTAL_2[e.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),Ci=d.Factory({Name:"Wanderer",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.SUMERU,BurstCost:60,HpBase:[791.2556,3249.3232],AtkBase:[25.5094,104.747734],DefBase:[47.2657,194.103],Normals:uA,Skills:NA,Bursts:EA,Extra:[],Effects:[fA,hA,LA,TA,_A,AA,SA]}),mA=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.376}]}],MA=r.Factory({Name:"VentiQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(a,e,s){CA(a,e,s);function n(){const i=a.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!i)return;const l=e.GetAuras()[0];!l||(i.Options.Element=t.AuraToDmg(l))}return n(),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_AURAS,n)),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,n)),()=>0}}),CA=new r.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.188,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),pA=r.Factory({Name:"VentiC1",OnApply:new r.Builder().instance.Location("Normal").Options({Name:"HIT_C1",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:.4386*.33}]}).Next().instance.Location("Normal").Options({Name:"HIT_CHARGED_C1",Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:1.24*.33}]}).Next().Build()}),GA=r.Factory({Name:"VentiC2",ApplyOther:!0,Conditions:["AIRBORNE","NO_AIRBORNE"],MaxConditions:1,OnApply:new r.Builder().stat.Enemy(t.stat.ANEMO_RES,t.stat.PHYSICAL_RES).Values(-.12).Next().Where({effect:{conditions:["AIRBORNE"]}}).stat.Enemy(t.stat.ANEMO_RES,t.stat.PHYSICAL_RES).Values(-.12).Build()}),dA=r.Factory({Name:"VentiC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),gA=r.Factory({Name:"VentiC4",OnApply:new r.Builder().stat.Char(t.stat.ANEMO_DMG).Values(.25).Build()}),RA=r.Factory({Name:"VentiC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),IA=r.Factory({Name:"VentiC6",ApplyOther:!0,OnApply(a,e,s){const n=a.GetCharacter().GetEnemy(),i=e.Owner.FindEffect("VentiQ");if(!i)throw new Error("Venti Q not found");s.Modifier(n.Subject.CreateModifier(t.stat.ANEMO_RES,-.2));const l=s.Modifier(n.Subject.CreateModifier(t.stat.ANEMO_RES,0)),E=()=>{const _=i.GetAuras();if(!_.length||_[0]===t.aura.NONE)l.SetValue(0);else{const A=t.DmgToRes(t.AuraToDmg(_[0]));l.SetValue(-.2),l.SetProp(A)}};return E(),s.Observer(i.CreateObserver(r.EffectEvent.CHANGE_AURAS,E)),()=>0}}),DA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2038}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4438}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5237}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2606}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5065}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7095}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],OA=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.76}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.8}]}],pi=d.Factory({Name:"Venti",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Weapon:t.weapon.BOW,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[819.8552,3366.7688],AtkBase:[20.482,84.10402],DefBase:[52.0521,213.759],Normals:DA,Skills:OA,Bursts:mA,Extra:[],Effects:[MA,pA,GA,dA,gA,RA,IA]}),yA=[{Name:T.hits.HIT_Q+"_MELEE",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.64}]},{Name:T.hits.HIT_Q+"_RANGED",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.784}]},{Name:"HIT_RiptideBlast",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2}]}],HA=r.Factory({Name:"TartagliaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),vA=r.Factory({Name:"TartagliaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),PA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4128}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4627}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5538}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5702}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6089}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7276}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_RiptideFlash",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.124}]},{Name:"HIT_RiptideBurst",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.62}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],BA=r.Factory({Name:"TartagliaA0",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_LEVEL_UP).Values(1).Build()}),KA=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]},{Name:T.hits.HIT_N1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3887}]},{Name:T.hits.HIT_N2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4162}]},{Name:T.hits.HIT_N3+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5633}]},{Name:T.hits.HIT_N4+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5994}]},{Name:T.hits.HIT_N5+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.553}]},{Name:T.hits.HIT_N6_1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3543}]},{Name:T.hits.HIT_N6_2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3767}]},{Name:T.hits.HIT_CHARGED_1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.602}]},{Name:T.hits.HIT_CHARGED_2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7198}]},{Name:"HIT_RiptideSlash",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.602}]}],Gi=d.Factory({Name:"Tartaglia",Stars:5,Weapon:t.weapon.BOW,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.HYDRO_DMG,Region:t.region.SNEZHNAYA,BurstCost:60,HpBase:[1020.0524,4188.8867],AtkBase:[23.4612,96.33733],DefBase:[63.4198,260.442],Normals:PA,Skills:KA,Bursts:yA,Extra:[],Effects:[BA,HA,vA]}),bA=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.48}]}],wA=r.Factory({Name:"SucroseQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(a,e,s){YA(a,e,s);function n(){const i=a.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!i)return;const l=e.GetAuras()[0];!l||(i.Options.Element=t.AuraToDmg(l))}return n(),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_AURAS,n)),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,n)),()=>0}}),YA=new r.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.44,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),FA=r.Factory({Name:"SucroseC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),VA=r.Factory({Name:"SucroseC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),xA=r.Factory({Name:"SucroseC6",ApplyOther:!0,OnApply(a,e,s){const n=e.Owner.FindEffect("SucroseQ"),i=a.GetCharacter();if(!n)throw new Error("Cannot find Sucrose Q");const l=s.Modifier(i.CreateModifier(t.stat.PYRO_DMG,0)),E=()=>{const _=n.GetAuras();(!_.length||_[0]===t.aura.NONE)&&l.SetValue(0);const A=t.AuraToDmg(_[0]);l.SetProp(A),l.SetValue(.2)};return E(),s.Observer(n.CreateObserver(r.EffectEvent.CHANGE_AURAS,E)),()=>0}}),kA=[{Name:T.hits.HIT_N1,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3346}]},{Name:T.hits.HIT_N2,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3062}]},{Name:T.hits.HIT_N3,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3845}]},{Name:T.hits.HIT_N4,Element:t.stat.ANEMO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4792}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.ANEMO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.2016}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],UA=r.Factory({Name:"SucroseA1",ApplySelf:!1,ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(50).Build()}),WA=r.Factory({Name:"SucroseA4",ApplySelf:!1,ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_MASTERY).Where({owner:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(.2).Map((a,e,s)=>a*s.Owner.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()}),jA=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.112}]}],di=d.Factory({Name:"Sucrose",Stars:4,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ANEMO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.MONDSTADT,BurstCost:80,HpBase:[775.02234,2773.016],AtkBase:[14.2464,50.97456],DefBase:[58.94175,210.8925],Normals:kA,Skills:jA,Bursts:bA,Extra:[],Effects:[wA,UA,WA,FA,VA,xA]}),zA=r.Factory({Name:"ShenheA1",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.CRYO_DMG).Values(.15).Build()}),qA=r.Factory({Name:"ShenheA4",ApplyOther:!0,Conditions:["PRESS","HOLD"],MaxConditions:1,OnApply:new r.Builder().Where({owner:{ascension:4},effect:{conditions:["PRESS"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.15).Next().Where({owner:{ascension:4},effect:{conditions:["HOLD"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.15).Build()}),QA=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.008}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3312}]}],$A=r.Factory({Name:"ShenheQ",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Enemy(t.stat.CRYO_RES,t.stat.PHYSICAL_RES).Values(-.06,-.07,-.08,-.09,-.1,-.11,-.12,-.13,-.14,-.15).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),XA=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4326}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4025}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5332}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2632}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6562}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1067}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],JA=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.392}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.888}]}],ZA=r.Factory({Name:"ShenheE",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP,t.stat.ATK_PERCENT,t.stat.ATK_BASE,t.stat.ATK_FLAT).stat.Char(t.stat.CRYO_DMG_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((a,e,s)=>.4566*a*s.Owner.GetCharacter().Get(t.stat.ATK)).Build()}),tS=r.Factory({Name:"ShenheC2",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.CRYO_CRIT_DMG).Values(.15).Build()}),aS=r.Factory({Name:"ShenheC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),eS=r.Factory({Name:"ShenheC4",MaxStacks:50,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.05).Stacks().Build()}),sS=r.Factory({Name:"ShenheC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),gi=d.Factory({Name:"Shenhe",Stars:5,Element:t.stat.CRYO_DMG,Weapon:t.weapon.POLEARM,StatBonus:t.stat.ATK_PERCENT,Region:t.region.LIYUE,BurstCost:80,HpBase:[1011.47253,4153.653],AtkBase:[23.6474,97.10191],DefBase:[64.6164,265.356],Normals:XA,Skills:JA,Bursts:QA,Extra:[],Effects:[ZA,$A,zA,qA,tS,aS,eS,sS]}),nS=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1042}]}],iS=r.Factory({Name:"KokomiQ",OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.0484,/HIT_N\d/i).Map((a,e)=>a*o.TalentScaling.ELEMENTAL_1[e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.0678,/charged/i).Map((a,e)=>a*o.TalentScaling.ELEMENTAL_1[e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.HP,.071,/HIT_E$/i).Map((a,e)=>a*o.TalentScaling.ELEMENTAL_1[e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1]).Build()}),rS=r.Factory({Name:"KokomiC1",OnApply:new r.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.HYDRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.HP,Initial:.3,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Build()}),lS=r.Factory({Name:"KokomiC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),oS=r.Factory({Name:"KokomiC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),cS=r.Factory({Name:"KokomiC6",OnApply:new r.Builder().stat.Char(t.stat.HYDRO_DMG).Values(.4).Build()}),ES=[{Name:T.hits.HIT_N1,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6838}]},{Name:T.hits.HIT_N2,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.6154}]},{Name:T.hits.HIT_N3,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.9431}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4832}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],TS=r.Factory({Name:"KokomiA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.HEALING_BONUS).Values(.25).Next().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Values(-1).Next().Build()}),_S=r.Factory({Name:"KokomiA4",OnApply(a,e,s){const n=a.GetCharacter(),i=a.FindEffect("KokomiQ");if(!i)throw new Error("Kokomi Q effect not found");const l=kt(a.GetNormals(),[/HIT_N\d/i]),E=kt(a.GetNormals(),[/charged/i]),_=s.Mv({Stat:t.stat.HP,Value:0,Enabled:!0},...l),A=s.Mv({Stat:t.stat.HP,Value:0,Enabled:!0},...E),S=()=>{(!i.Enabled()||n.GetAscension()<4)&&(_.Value=0,A.Value=0);const u=n.Get(t.stat.HEALING_BONUS);_.Value=A.Value=.15*u};return S(),s.Observer(n.CreateObserver(t.stat.HEALING_BONUS,S)),s.Observer(i.CreateObserver(r.EffectEvent.ENABLE,S)),s.Observer(i.CreateObserver(r.EffectEvent.DISABLE,S)),()=>0}}),AS=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.0919}]}],Ri=d.Factory({Name:"Kokomi",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.HYDRO_DMG,Region:t.region.INAZUMA,BurstCost:70,HpBase:[1048.652,4306.332],AtkBase:[18.2476,74.92904],DefBase:[51.15465,210.0735],Normals:ES,Skills:AS,Bursts:nS,Extra:[],Effects:[iS,TS,_S,rS,lS,oS,cS]}),SS=[{Name:T.hits.HIT_Q_1,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.04}]},{Name:T.hits.HIT_Q_2,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.52}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]}],uS=r.Factory({Name:"RosariaC1",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.1).Build()}),hS=r.Factory({Name:"RosariaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),LS=r.Factory({Name:"RosariaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),NS=r.Factory({Name:"RosariaC6",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.PHYSICAL_RES).Values(-.2).Build()}),fS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5246}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.516}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3182}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6966}]},{Name:T.hits.HIT_N5_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4162}]},{Name:T.hits.HIT_N5_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.43}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.3674}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],mS=r.Factory({Name:"RosariaA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Values(.12).Build()}),MS=r.Factory({Name:"RosariaA4",ApplySelf:!1,ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.CRIT_RATE).Where({owner:{ascension:4}}).stat.Char(t.stat.CRIT_RATE).Values(.15).Map((a,e,s)=>Math.max(0,Math.min(1,a*s.Owner.GetCharacter().Get(t.stat.CRIT_RATE)))).Build()}),CS=[{Name:T.hits.HIT_E_1,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.584}]},{Name:T.hits.HIT_E_2,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.36}]}],Ii=d.Factory({Name:"Rosaria",Stars:4,Weapon:t.weapon.POLEARM,Element:t.stat.CRYO_DMG,Region:t.region.MONDSTADT,StatBonus:t.stat.ATK_PERCENT,BurstCost:60,HpBase:[1030.3239,3686.4802],AtkBase:[20.12304,72.001564],DefBase:[59.514,212.94],Normals:fS,Skills:CS,Bursts:SS,Extra:[],Effects:[mS,MS,uS,hS,LS,NS]}),pS=[{Name:T.hits.HIT_Q_1,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672}]},{Name:T.hits.HIT_Q_2,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.928}]}],GS=r.Factory({Name:"NoelleQ",OnApply:new r.Builder().infusion.Set(t.stat.GEO_DMG,!0).Next().observe.Target(t.stat.DEF_FLAT,t.stat.DEF_PERCENT,t.stat.DEF_FLAT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(.4,.43,.46,.5,.53,.56,.6,.64,.68,.72,.76,.8,.85,.9,.95).Rank(a=>a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((a,e)=>a*e.GetCharacter().Get(t.stat.DEF)).Build()}),dS=r.Factory({Name:"NoelleC2",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()}),gS=r.Factory({Name:"NoelleC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),RS=r.Factory({Name:"NoelleC4",OnApply:new r.Builder().instance.Location("Skill").Options({Name:"HIT_C4",Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:4}]}).Build()}),IS=r.Factory({Name:"NoelleC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),DS=r.Factory({Name:"NoelleC6",OnApply(a,e,s){const n=a.GetCharacter(),i=a.FindEffect("NoelleQ");if(!i)throw new Error("Noelle Q effect not found");const l=s.Modifier(n.CreateModifier(t.stat.ATK_FLAT,0)),E=()=>{i.Enabled()?l.SetValue(.5*n.Get(t.stat.DEF)):l.SetValue(0)};return E(),s.Observer(n.CreateObserver(t.stat.DEF_FLAT,E)),s.Observer(n.CreateObserver(t.stat.DEF_PERCENT,E)),s.Observer(n.CreateObserver(t.stat.DEF_BASE,E)),s.Observer(i.CreateObserver(r.EffectEvent.ENABLE,E)),s.Observer(i.CreateObserver(r.EffectEvent.DISABLE,E)),()=>0}}),OS=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7912}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7336}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8626}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1343}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5074}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9047}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],yS=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:1.2}]}],Di=d.Factory({Name:"Noelle",Stars:4,Element:t.stat.GEO_DMG,StatBonus:t.stat.DEF_PERCENT,BurstCost:60,Region:t.region.MONDSTADT,Weapon:t.weapon.CLAYMORE,HpBase:[1012.088,3621.2327],AtkBase:[16.0272,57.34638],DefBase:[66.95325,239.5575],Normals:OS,Skills:yS,Bursts:pS,Extra:[],Effects:[GS,dS,gS,RS,IS,DS]}),HS=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.8696}]}],vS=r.Factory({Name:"NingguangC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),PS=r.Factory({Name:"NingguangC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),BS=[{Name:T.hits.HIT_N1,Element:t.stat.GEO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.28}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.7408}]},{Name:"HIT_Jade",Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.496}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.GEO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],KS=r.Factory({Name:"NingguangA4",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.GEO_DMG).Values(.12).Build()}),bS=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.304}]}],Oi=d.Factory({Name:"Ningguang",Stars:4,Element:t.stat.GEO_DMG,StatBonus:t.stat.GEO_DMG,Weapon:t.weapon.CATALYST,Region:t.region.LIYUE,BurstCost:40,HpBase:[820.6119,2936.1348],AtkBase:[17.808,63.7182],DefBase:[48.069,171.99],Normals:BS,Skills:bS,Bursts:HS,Extra:[],Effects:[KS,vS,PS]}),wS=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.424}]}],YS=r.Factory({Name:"MonaQ",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ALL_DMG).Values(.4,.42,.44,.46,.48,.5,.52,.54,.56,.58,.6).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),FS=r.Factory({Name:"MonaC1",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELECTROCHARGE_DMG,t.stat.VAPORIZE_DMG).Values(.15).Next().stat.Char(t.stat.ALL_DMG).Instance("HIT_SWIRL_HYDRO").Values(.15).Build()}),VS=r.Factory({Name:"MonaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),xS=r.Factory({Name:"MonaC4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.15).Build()}),kS=r.Factory({Name:"MonaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),US=r.Factory({Name:"MonaC6",MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.6).Stacks().Build()}),WS=[{Name:T.hits.HIT_N1,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.376}]},{Name:T.hits.HIT_N2,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.36}]},{Name:T.hits.HIT_N3,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.448}]},{Name:T.hits.HIT_N4,Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5616}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.4972}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.HYDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],jS=r.Factory({Name:"MonaA1",OnApply:new r.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_SKILL_LEVEL,Stat:t.stat.ATK,Initial:1.328*.5}]}).Build()}),zS=r.Factory({Name:"MonaA4",OnApply:new r.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.HYDRO_DMG).Values(.2).Map((a,e)=>a*e.GetCharacter().Get(t.stat.ENERGY_RECHARGE)).Build()}),qS=[{Name:T.hits.HIT_E_DOT,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.32}]},{Name:T.hits.HIT_E_EXPLOSION,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.328}]}],yi=d.Factory({Name:"Mona",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[810.322,3327.62],AtkBase:[22.344,91.74984],DefBase:[50.8555,208.845],Normals:WS,Skills:qS,Bursts:wS,Extra:[],Effects:[YS,jS,zS,FS,VS,xS,kS,US]}),QS=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4264}]}],$S=r.Factory({Name:"KleeC1",OnApply:new r.Builder().instance.Location("Burst").Options({Name:"HIT_C1",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:.4264*1.2}]}).Build()}),XS=r.Factory({Name:"KleeC2",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.DEFREDUCTION).Values(.23).Build()}),JS=r.Factory({Name:"KleeC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),ZS=r.Factory({Name:"KleeC4",OnApply:new r.Builder().instance.Location("Burst").Options({Name:"HIT_C4",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:5.55}]}).Build()}),tu=r.Factory({Name:"KleeC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),au=r.Factory({Name:"KleeC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Build()}),eu=[{Name:T.hits.HIT_N1,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.7216}]},{Name:T.hits.HIT_N2,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.624}]},{Name:T.hits.HIT_N3,Element:t.stat.PYRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:.8992}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.5736}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PYRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],su=r.Factory({Name:"KleeA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.5).Build()}),nu=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.952}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.328}]}],Hi=d.Factory({Name:"Klee",Stars:5,Weapon:t.weapon.CATALYST,Element:t.stat.PYRO_DMG,StatBonus:t.stat.PYRO_DMG,Region:t.region.MONDSTADT,BurstCost:60,HpBase:[800.7888,3288.4717],AtkBase:[24.206,99.39566],DefBase:[47.864,196.56],Normals:eu,Skills:nu,Bursts:QS,Extra:[],Effects:[su,$S,XS,JS,ZS,tu,au]}),iu=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.24}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.888}]}],ru=r.Factory({Name:"KeqingC1",OnApply:new r.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.5,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Build()}),lu=r.Factory({Name:"KeqingC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),ou=r.Factory({Name:"KeqingC4",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.25).Build()}),cu=r.Factory({Name:"KeqingC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Eu=r.Factory({Name:"KeqingC6",OnApply:new r.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.06).Build()}),Tu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4102}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4102}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5444}]},{Name:T.hits.HIT_N4_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3148}]},{Name:T.hits.HIT_N4_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.344}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6699}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.768}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.86}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],_u=r.Factory({Name:"KeqingA1",OnApply:new r.Builder().Where({target:{ascension:1}}).infusion.Set(t.stat.ELECTRO_DMG,!1).Build()}),Au=r.Factory({Name:"KeqingA4",OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.CRIT_RATE,t.stat.ENERGY_RECHARGE).Values(.15).Build()}),Su=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.504}]},{Name:T.hits.HIT_E+"_SLASH",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.68}]},{Name:T.hits.HIT_E+"_SLASH_2",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]}],vi=d.Factory({Name:"Keqing",Stars:5,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_DMG,Weapon:t.weapon.SWORD,Region:t.region.LIYUE,BurstCost:40,HpBase:[1020.0524,4188.8867],AtkBase:[25.137,103.21857],DefBase:[62.2232,255.528],Normals:Tu,Skills:Su,Bursts:iu,Extra:[],Effects:[_u,Au,ru,lu,ou,cu,Eu]}),uu=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6646}]}],hu=r.Factory({Name:"AyatoQ",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.11,.12,.13,.14,.15,.16,.17,.18,.19,.2).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Build()}),Lu=r.Factory({Name:"AyatoC1",OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Instance(/HIT_N\d_E/i).Values(.4).Build()}),Nu=r.Factory({Name:"AyatoC2",OnApply(a,e,s){const n=a.FindEffect("AyatoE");if(!n)throw new Error("Cannot find Ayato Skill");const i=s.Modifier(a.GetCharacter().CreateModifier(t.stat.HP_PERCENT,0)),l=function(){n.GetStacks()>=3?i.SetValue(.5):i.SetValue(0)};return l(),s.Observer(n.CreateObserver(r.EffectEvent.CHANGE_STACKS,l)),()=>0}}),fu=r.Factory({Name:"AyatoC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),mu=r.Factory({Name:"AyatoC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Mu=r.Factory({Name:"AyatoC6",OnApply:new r.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Stat:t.stat.ATK,Initial:4.5}]}).Build()}),Cu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4496}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4716}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5861}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2945}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.756}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2953}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],pu=[{Name:T.hits.HIT_N1+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5289}]},{Name:T.hits.HIT_N2+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5891}]},{Name:T.hits.HIT_N3+"_E",Element:t.stat.HYDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6493}]},{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0148}]}],Gu=r.Factory({Name:"AyatoE",MaxStacks:5,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Mv(t.stat.HP,.56/100,/HIT_N\d_E/i).Map((a,e,s)=>a*s.GetStacks()*o.TalentScaling.PHYSICAL_1[e.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1]).Build()}),Pi=d.Factory({Name:"Ayato",Stars:5,Weapon:t.weapon.SWORD,Element:t.stat.HYDRO_DMG,StatBonus:t.stat.CRIT_DMG,Region:t.region.INAZUMA,BurstCost:80,HpBase:[1067.7184,4384.629],AtkBase:[23.275,95.57275],DefBase:[59.83,245.7],Normals:Cu,Skills:pu,Bursts:uu,Extra:[],Effects:[Gu,hu,Lu,Nu,fu,mu,Mu]}),du=[{Name:T.hits.HIT_Q_DOT,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.123}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.6845}]}],gu=r.Factory({Name:"AyakaC2",OnApply:new r.Builder().instance.Location("Burst").Options({Name:"HIT_C2",Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:1.123}]}).Build()}),Ru=r.Factory({Name:"AyakaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Iu=r.Factory({Name:"AyakaC4",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.DEFREDUCTION).Values(.3).Build()}),Du=r.Factory({Name:"AyakaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Ou=r.Factory({Name:"AyakaC6",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(2.98).Build()}),yu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4573}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4868}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6262}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2265}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7818}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5513}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Hu=r.Factory({Name:"AyakaSprint",OnApply:new r.Builder().infusion.Set(t.stat.CRYO_DMG,!1).Build()}),vu=r.Factory({Name:"AyakaA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.3).Build()}),Pu=r.Factory({Name:"AyakaA4",OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.CRYO_DMG).Values(.18).Build()}),Bu=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.392}]}],Bi=d.Factory({Name:"Ayaka",Stars:5,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,Weapon:t.weapon.SWORD,Region:t.region.INAZUMA,BurstCost:80,HpBase:[1000.986,4110.59],AtkBase:[26.6266,109.33523],DefBase:[61.0266,250.614],Normals:yu,Skills:Bu,Bursts:du,Extra:[],Effects:[Hu,vu,Pu,gu,Ru,Iu,Du,Ou]}),Ku=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.248}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.784}]}],bu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4833}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4558}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6029}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6588}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7921}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.6202}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],wu=r.Factory({Name:"JeanC1",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.4).Build()}),Yu=r.Factory({Name:"JeanC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Fu=r.Factory({Name:"JeanC4",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.ANEMO_RES).Values(-.4).Build()}),Vu=r.Factory({Name:"JeanC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),xu=[{Name:T.hits.HIT_E,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.92}]}],Ki=d.Factory({Name:"Jean",Stars:5,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.HEALING_BONUS,Weapon:t.weapon.SWORD,Region:t.region.MONDSTADT,BurstCost:80,HpBase:[1143.984,4697.817],AtkBase:[18.62,76.4582],DefBase:[59.83,245.7],Normals:bu,Skills:xu,Bursts:Ku,Extra:[],Effects:[wu,Yu,Fu,Vu]}),ku=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:.9822}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:.613}]}];function ba(a){const e=a.GetParty();if(!e)return a.GetCharacter().Options.Element===t.stat.GEO_DMG?1:0;let s=0;for(const n of e.GetMembers())n.GetCharacter().Options.Element===t.stat.GEO_DMG&&s++;return s}var Uu=r.Factory({Name:"GorouC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Wu=r.Factory({Name:"GorouC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),ju=r.Factory({Name:"GorouC6",ApplyOther:!0,OnApply:new r.Builder().observe.Party(!0).stat.Char(t.stat.GEO_CRIT_DMG).Values(.1,.2,.4).Rank(a=>ba(a)).Build()}),zu=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3775}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3715}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4945}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.59}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.GEO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],qu=r.Factory({Name:"GorouA1",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:1}}).stat.Char(t.stat.DEF_PERCENT).Values(.25).Build()}),Qu=r.Factory({Name:"GorouA4",OnApply:new r.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,1.56,"HIT_E").Next().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,.156,"HIT_Q","HIT_Q_DOT").Next().Build()}),$u=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.072}]}],Xu=r.Factory({Name:"GorouE",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).observe.Party(!0).stat.Char(t.stat.DEF_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((a,e)=>206.16*a*(ba(e)>=1?1:0)).Next().observe.Party(!0).stat.Char(t.stat.GEO_DMG).Values(.15).Map((a,e)=>a*(ba(e)>=3?1:0)).Build()}),bi=d.Factory({Name:"Gorou",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.GEO_DMG,StatBonus:t.stat.GEO_DMG,BurstCost:80,Region:t.region.INAZUMA,HpBase:[802.3761,2870.8872],AtkBase:[15.31488,54.797653],DefBase:[54.36375,194.5125],Normals:zu,Skills:$u,Bursts:ku,Extra:[],Effects:[Xu,qu,Qu,Uu,Wu,ju]}),Ju=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7027}]}],Zu=r.Factory({Name:"GanyuC1",ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.CRYO_RES).Values(-.15).Build()}),t0=r.Factory({Name:"GanyuC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),a0=r.Factory({Name:"GanyuC4",ApplyOther:!0,MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.05).Stacks().Build()}),e0=r.Factory({Name:"GanyuC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),s0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3173}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.356}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4549}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4549}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4825}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5762}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_Frostflake",Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.28}]},{Name:"HIT_FrostflakeBloom",Element:t.stat.CRYO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.176}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],n0=r.Factory({Name:"GanyuA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.CRIT_RATE).Instance(/Frostflake/i).Values(.2).Build()}),i0=r.Factory({Name:"GanyuA4",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.CRYO_DMG).Values(.2).Build()}),r0=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]}],wi=d.Factory({Name:"Ganyu",Stars:5,Weapon:t.weapon.BOW,Region:t.region.LIYUE,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:60,HpBase:[762.656,3131.878],AtkBase:[26.068,107.04148],DefBase:[49.0606,201.474],Normals:s0,Skills:r0,Bursts:Ju,Extra:[],Effects:[n0,i0,Zu,t0,a0,e0]}),l0=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.456}]},{Name:"HIT_LightfallSword",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:3.6705}]}],o0=r.Factory({Name:"EulaQ",MaxStacks:30,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.7499,"HIT_LightfallSword").Map((a,e,s)=>{const n=Math.max(1,Math.min(15,e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)));return s.GetStacks()*a*o.TalentScaling.PHYSICAL_1A[n-1]}).Build()}),c0=r.Factory({Name:"EulaC1",OnApply:new r.Builder().stat.Char(t.stat.PHYSICAL_DMG).Values(.3).Build()}),E0=r.Factory({Name:"EulaC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),T0=r.Factory({Name:"EulaC4",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.25).Build()}),_0=r.Factory({Name:"EulaC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),A0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8973}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.9355}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.568}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1264}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7183}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.688}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.244}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.8629}]}],S0=r.Factory({Name:"EulaA1",OnApply:new r.Builder().Where({target:{ascension:1}}).instance.Location("Burst").Options({Name:"HIT_A1",Talent:t.stat.ELEMENTAL_BURST_DMG,Element:t.stat.PHYSICAL_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Talent:t.stat.ELEMENTAL_BURST_LEVEL,Stat:t.stat.ATK,Initial:3.6705*.5}]}).Build()}),u0=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.464}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.456}]},{Name:"HIT_Icewhirl",Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]}],h0=r.Factory({Name:"EulaE_1",MaxStacks:2,OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.3).Stacks().Build()}),L0=r.Factory({Name:"EulaE_2",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Enemy(t.stat.CRYO_RES,t.stat.PHYSICAL_RES).Values(-.16,-.17,-.18,-.19,-.2,-.21,-.22,-.23,-.24,-.25).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Build()}),Yi=d.Factory({Name:"Eula",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.CRYO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:80,Region:t.region.MONDSTADT,HpBase:[1029.5856,4228.035],AtkBase:[26.6266,109.33523],DefBase:[58.45391,240.0489],Normals:A0,Skills:u0,Bursts:l0,Extra:[],Effects:[h0,L0,o0,S0,c0,E0,T0,_0]}),N0=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.04}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6}]},{Name:T.hits.HIT_Q_EXPLOSION,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.04}]}],f0=r.Factory({Name:"DilucQ",OnApply:new r.Builder().infusion.Set(t.stat.PYRO_DMG,!1).Build()}),m0=r.Factory({Name:"DilucC1",OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.15).Build()}),M0=r.Factory({Name:"DilucC2",MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.1).Stacks().Build()}),C0=r.Factory({Name:"DilucC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),p0=r.Factory({Name:"DilucC4",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.4).Build()}),G0=r.Factory({Name:"DilucC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),d0=r.Factory({Name:"DilucC6",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.3).Build()}),g0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.897}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8763}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.9881}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.3399}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.688}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.247}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8951}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.7897}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.2355}]}],R0=r.Factory({Name:"DilucA4",OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.PYRO_DMG).Values(.2).Build()}),I0=[{Name:T.hits.HIT_E_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.944}]},{Name:T.hits.HIT_E_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.976}]},{Name:T.hits.HIT_E_3,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.288}]}],Fi=d.Factory({Name:"Diluc",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.PYRO_DMG,StatBonus:t.stat.CRIT_RATE,BurstCost:40,Region:t.region.MONDSTADT,HpBase:[1010.5192,4149.7383],AtkBase:[26.068,107.04148],DefBase:[61.0266,250.614],Normals:g0,Skills:I0,Bursts:N0,Extra:[],Effects:[f0,R0,m0,M0,C0,p0,G0,d0]}),D0=[{Name:T.hits.HIT_N1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7828}]},{Name:T.hits.HIT_N2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8247}]},{Name:T.hits.HIT_N3+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0463}]},{Name:T.hits.HIT_N4+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5169}]},{Name:T.hits.HIT_N5+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.3084}]},{Name:T.hits.HIT_CHARGED+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0105}]},{Name:T.hits.HIT_PLUNGE+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],O0=r.Factory({Name:"CynoQ",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100).Build()}),y0=r.Factory({Name:"CynoC2",MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ELECTRO_DMG).Values(.1).Stacks().Build()}),H0=r.Factory({Name:"CynoC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),v0=r.Factory({Name:"CynoC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),P0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4926}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4792}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2931}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7589}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2238}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],B0=r.Factory({Name:"CynoA1",OnApply:new r.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Initial:.35,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE}]}).Next().Where({target:{ascension:1}}).stat.Char(t.stat.ALL_DMG).Instance("HIT_E","HIT_E_2").Values(.35).Build()}),K0=new r.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.DMG_FLAT).Instance(/N\d_Q$/i).Values(1.5).Map((a,e)=>a*e.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build(),b0=r.Factory({Name:"CynoA4",OnApply(a,e,s){K0(a,e,s);const n=a.GetCharacter(),i=a.FindEffect("CynoA1");let l;if(!i)throw new Error("Cannot find Cyno A1");function E(){if(!l){const _=a.FindInstance("HIT_A1");if(!_)return;l=s.Modifier(_.Subject.CreateModifier(t.stat.DMG_FLAT,0))}!l||(n.GetAscension()>=4?l.SetValue(2.5*n.Get(t.stat.ELEMENTAL_MASTERY)):l.SetValue(0))}E();for(const _ of r.EffectEvent.Values())s.Observer(i.CreateObserver(_,E));return s.Observer(n.CreateObserver(t.stat.ELEMENTAL_MASTERY,E)),s.Observer(n.CreateObserver(t.stat.LEVEL,E)),s.Observer(n.CreateObserver(t.stat.ASCENSION,E)),()=>0}}),w0=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_2,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.568}]}],Vi=d.Factory({Name:"Cyno",Stars:5,Weapon:t.weapon.POLEARM,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.CRIT_DMG,BurstCost:80,Region:t.region.SUMERU,HpBase:[972.3864,3993.1443],AtkBase:[24.7646,101.68941],DefBase:[66.88994,274.6926],Normals:P0,Skills:w0,Bursts:D0,Extra:[],Effects:[O0,B0,b0,y0,H0,v0]}),Y0=[{Name:T.hits.HIT_Q,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.0182}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4325}]}],F0=r.Factory({Name:"ColleiC1",OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.2).Build()}),V0=r.Factory({Name:"ColleiC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),x0=r.Factory({Name:"ColleiC4",ApplyOther:!0,ApplySelf:!1,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60).Build()}),k0=r.Factory({Name:"ColleiC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),U0=r.Factory({Name:"ColleiC6",OnApply:new r.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Initial:2}]}).Build()}),W0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.436}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4266}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5409}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6803}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.DENDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],j0=r.Factory({Name:"ColleiA1",OnApply:new r.Builder().Where({target:{ascension:1}}).instance.Location("Skill").Options({Name:"HIT_A1",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.NONE,Talent:t.stat.NONE,Initial:.4}]}).Build()}),z0=[{Name:T.hits.HIT_E,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.512}]}],xi=d.Factory({Name:"Collei",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.DENDRO_DMG,StatBonus:t.stat.ATK_PERCENT,BurstCost:60,Region:t.region.SUMERU,HpBase:[820.6119,2936.1348],AtkBase:[16.73952,59.895107],DefBase:[50.358,180.18],Normals:W0,Skills:z0,Bursts:Y0,Extra:[],Effects:[j0,F0,V0,x0,k0,U0]}),q0=[{Name:T.hits.HIT_Q,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.424}]}],Q0=r.Factory({Name:"ChongyunC1",OnApply:new r.Builder().instance.Basic({Name:"HIT_C1",Element:t.stat.CRYO_DMG,Stat:t.stat.ATK,Values:[.5]}).Build()}),$0=r.Factory({Name:"ChongyunC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),X0=r.Factory({Name:"ChongyunC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),J0=r.Factory({Name:"ChongyunC6",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.15).Build()}),Z0=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6312}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8032}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0122}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5629}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.0178}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],th=r.Factory({Name:"ChongyunA4",ApplyOther:!0,OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Enemy(t.stat.CRYO_RES).Values(-.1).Build()}),ah=[{Name:T.hits.HIT_E,Element:t.stat.CRYO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.7204}]}],eh=r.Factory({Name:"ChongyunE",ApplyOther:!0,OnApply:new r.Builder().infusion.Set(t.stat.CRYO_DMG,!1).Build()}),ki=d.Factory({Name:"Chongyun",Stars:4,Element:t.stat.CRYO_DMG,Weapon:t.weapon.CLAYMORE,StatBonus:t.stat.ATK_PERCENT,BurstCost:40,Region:t.region.LIYUE,HpBase:[920.90894,3294.9956],AtkBase:[18.6984,66.90411],DefBase:[54.36375,194.5125],Normals:Z0,Skills:ah,Bursts:q0,Extra:[],Effects:[eh,th,Q0,$0,X0,J0]}),sh=r.Factory({Name:"IttoQ",OnApply:new r.Builder().observe.Target(t.stat.DEF_FLAT,t.stat.DEF_BASE,t.stat.DEF_PERCENT,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank(a=>a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((a,e)=>.576*a*e.GetCharacter().Get(t.stat.DEF)).Next().infusion.Set(t.stat.GEO_DMG,!0).Build()}),nh=r.Factory({Name:"IttoC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),ih=r.Factory({Name:"IttoC4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT,t.stat.ATK_PERCENT).Values(.2).Build()}),rh=r.Factory({Name:"IttoC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),lh=r.Factory({Name:"IttoC6",OnApply:new r.Builder().stat.Char(t.stat.CHARGED_ATTACK_CRIT_DMG).Values(.7).Build()}),oh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7923}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7637}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9164}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1722}]},{Name:"HIT_KesagiriSlash",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9116}]},{Name:"HIT_KesagiriFinal",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.9092}]},{Name:"HIT_SaichimonjiSlash",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9047}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],ch=r.Factory({Name:"IttoA4",OnApply:new r.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.DEF,.35,/Kesagiri/i).Build()}),Eh=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.072}]}],Ui=d.Factory({Name:"Itto",Stars:5,Weapon:t.weapon.CLAYMORE,Element:t.stat.GEO_DMG,StatBonus:t.stat.CRIT_RATE,Region:t.region.INAZUMA,BurstCost:70,HpBase:[1000.986,4110.59],AtkBase:[17.689,72.63529],DefBase:[74.66784,306.6336],Normals:oh,Skills:Eh,Bursts:[],Extra:[],Effects:[sh,ch,nh,ih,rh,lh]}),Th=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.2808}]}],_h=r.Factory({Name:"AmberC1",OnApply:new r.Builder().instance.Location("Normal").Options({Name:"HIT_C1",Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Talent:t.stat.NORMAL_ATTACK_LEVEL,Stat:t.stat.ATK,Initial:1.24*.2}]}).Build()}),Ah=r.Factory({Name:"AmberC2",OnApply:new r.Builder().mv.Mv(t.stat.ATK,2,/hit_e/i).Build()}),Sh=r.Factory({Name:"AmberC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),uh=r.Factory({Name:"AmberC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),hh=r.Factory({Name:"AmberC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()}),Lh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3612}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3612}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4644}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5934}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.PYRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],Nh=r.Factory({Name:"AmberA1",OnApply:new r.Builder().Where({target:{ascension:1}}).stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.1).Build()}),fh=r.Factory({Name:"AmberA4",OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()}),mh=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.232}]}],Wi=d.Factory({Name:"Amber",Stars:4,Weapon:t.weapon.BOW,Element:t.stat.PYRO_DMG,StatBonus:t.stat.ATK_PERCENT,BurstCost:40,Region:t.region.MONDSTADT,HpBase:[793.2582,2838.2634],AtkBase:[18.6984,66.90411],DefBase:[50.358,180.18],Normals:Lh,Skills:mh,Bursts:Th,Extra:[],Effects:[Nh,fh,_h,Ah,Sh,uh,hh]}),Mh=r.Factory({Name:"AlhaithamA4",OnApply:new r.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.1/100).Map((a,e)=>Math.min(1,a*e.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY))).Build()}),Ch=[{Name:T.hits.HIT_Q,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:.9728}]}],ph=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4953}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5075}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3418}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6677}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8385}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5526}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],Gh=[{Name:T.hits.HIT_E,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.936},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.5488}]},{Name:T.hits.HIT_E_DOT+"_1",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344}]},{Name:T.hits.HIT_E_DOT+"_2",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672*2},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344*2}]},{Name:T.hits.HIT_E_DOT+"_3",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.672*3},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:1.344*3}]}],dh=r.Factory({Name:"AlhaithamE",OnApply:new r.Builder().infusion.Set(t.stat.DENDRO_DMG,!0).Build()}),gh=r.Factory({Name:"AlhaithamC2",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(50).Stacks().Build()}),Rh=r.Factory({Name:"AlhaithamC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Ih=r.Factory({Name:"AlhaithamC4",MaxStacks:3,ApplyOther:!0,OnApply:new r.Builder().Where({target:{isOwner:!0}}).stat.Char(t.stat.DENDRO_DMG).Values(.1).Stacks().Next().Where({target:{isOwner:!1}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(30).Stacks().Build()}),Dh=r.Factory({Name:"AlhaithamC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Oh=r.Factory({Name:"AlhaithamC6",OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.1).Next().stat.Char(t.stat.CRIT_DMG).Values(.7).Build()}),ji=d.Factory({Name:"Alhaitham",Stars:5,Weapon:t.weapon.SWORD,Element:t.stat.DENDRO_DMG,StatBonus:t.stat.DENDRO_DMG,Region:t.region.SUMERU,BurstCost:70,AtkBase:[24.3922,100.16024],DefBase:[60.84711,249.8769],HpBase:[1039.1188,4267.1836],Normals:ph,Skills:Gh,Bursts:Ch,Extra:[],Effects:[dh,Mh,gh,Rh,Ih,Dh,Oh]}),yh=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:3.672}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.72}]}],Hh=r.Factory({Name:"AlbedoC2",MaxStacks:4,OnApply:new r.Builder().mv.Mv(t.stat.DEF,.3,/HIT_Q/i).Map((a,e,s)=>a*s.GetStacks()).Build()}),vh=r.Factory({Name:"AlbedoC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Ph=r.Factory({Name:"AlbedoC4",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.PLUNGE_ATTACK_DMG).Values(.3).Build()}),Bh=r.Factory({Name:"AlbedoC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Kh=r.Factory({Name:"AlbedoC6",ApplyOther:!0,OnApply:new r.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.ALL_DMG).Values(.17).Build()}),bh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3674}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3674}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4745}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4975}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6207}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.602}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],wh=r.Factory({Name:"AlbedoA1",OnApply(a,e,s){const n=a.GetCharacter(),i=a.FindSkill(T.hits.HIT_E_DOT);if(!i)throw new Error("Cannot find Albedo Skill");const l=s.Modifier(i.Subject.CreateModifier(t.stat.ALL_DMG,0));function E(){n.GetAscension()>=1?l.SetValue(.25):l.SetValue(0)}return E(),s.Observer(n.CreateObserver(t.stat.LEVEL,E)),s.Observer(n.CreateObserver(t.stat.ASCENSION,E)),()=>0}}),Yh=r.Factory({Name:"AlbedoA4",ApplyOther:!0,OnApply:new r.Builder().Where({owner:{ascension:4}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(125).Build()}),Fh=[{Name:T.hits.HIT_E,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.DEF,Initial:1.336}]}],zi=d.Factory({Name:"Albedo",Element:t.stat.GEO_DMG,Stars:5,Weapon:t.weapon.SWORD,StatBonus:t.stat.GEO_DMG,Region:t.region.MONDSTADT,AtkBase:[19.551,80.28111],DefBase:[68.2062,280.098],HpBase:[1029.5856,4228.035],BurstCost:40,Normals:bh,Skills:Fh,Bursts:yh,Extra:[],Effects:[wh,Yh,Hh,vh,Ph,Bh,Kh]}),Vh=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]}],xh=r.Factory({Name:"BeidouC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),kh=r.Factory({Name:"BeidouC4",ApplySelf:!0,OnApply:new r.Builder().instance.Options({Name:"HIT_C4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.NONE,Scaling:[{Stat:t.stat.ATK,Initial:.2,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Build()}),Uh=r.Factory({Name:"BeidouC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Wh=r.Factory({Name:"BeidouC6",ApplySelf:!0,ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.ELECTRO_RES).Values(-.15).Build()}),jh=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7112}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7086}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8832}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.8652}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1214}]},{Name:T.hits.HIT_CHARGED_SPIN,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5624}]},{Name:T.hits.HIT_CHARGED_FINAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.0182}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7459}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4914}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.8629}]}],zh=r.Factory({Name:"BeidouA4",OnApply:new r.Builder().Where({target:{ascension:4}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.15).Build()}),qh=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.216}]}],Qh=r.Factory({Name:"BeidouE",MaxStacks:2,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).mv.Mv(t.stat.ATK,.96,T.hits.HIT_E).Map((a,e,s)=>{const n=s.GetStacks(),i=e.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)-1,l=o.TalentScaling.ELEMENTAL_1[i];return a*l*n}).Build()}),qi=d.Factory({Name:"Beidou",Stars:4,Weapon:t.weapon.CLAYMORE,Element:t.stat.ELECTRO_DMG,Region:t.region.LIYUE,StatBonus:t.stat.ELECTRO_DMG,AtkBase:[18.87648,67.54129],DefBase:[54.36375,194.5125],HpBase:[1094.1492,3914.8462],BurstCost:80,Normals:jh,Skills:qh,Bursts:Vh,Extra:[],Effects:[Qh,zh,xh,kh,Uh,Wh]}),$h=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.5427}]}],Xh=r.Factory({Name:"XingqiuC2",ApplySelf:!0,ApplyOther:!0,OnApply:new r.Builder().stat.Enemy(t.stat.HYDRO_RES).Values(-.15).Build()}),Jh=r.Factory({Name:"XingqiuC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),Zh=r.Factory({Name:"XingqiuC4",ApplySelf:!0,OnApply:new r.Builder().mv.Multiplier(1.5,/^HIT_E_/i).Build()}),tL=r.Factory({Name:"XingqiuC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),aL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4661}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4764}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2855}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5599}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3586}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.473}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.5616}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],eL=r.Factory({Name:"XingqiuA4",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.HYDRO_DMG).Where({owner:{ascension:4}}).Values(.2).Build()}),sL=[{Name:T.hits.HIT_E_1,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.68}]},{Name:T.hits.HIT_E_2,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.912}]}],Qi=d.Factory({Name:"Xingqiu",Stars:4,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.SWORD,Region:t.region.LIYUE,HpBase:[857.08356,3066.6296],AtkBase:[16.9176,60.53229],DefBase:[63.51975,227.2725],StatBonus:t.stat.ATK_PERCENT,Normals:aL,Skills:sL,Bursts:$h,Extra:[],Effects:[eL,Xh,Jh,Zh,tL],BurstCost:80}),nL=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_2,Stat:t.stat.ATK,Initial:3.0327}]}],iL=r.Factory({Name:"HuTaoQ",OnApply:new r.Builder().mv.Where({target:{hp:{leq:.5}}}).Multiplier(3.7909/3.0327,"HIT_Q").Build()}),rL=r.Factory({Name:"HuTaoC2",ApplySelf:!0,OnApply:new r.Builder().mv.Mv(t.stat.HP,.1,"HIT_E").Build()}),lL=r.Factory({Name:"HuTaoC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),oL=r.Factory({Name:"HuTaoC4",ApplySelf:!1,ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.12).Build()}),cL=r.Factory({Name:"HuTaoC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),EL=r.Factory({Name:"HuTaoC6",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(1).Build()}),TL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.4689}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.4825}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6105}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6564}]},{Name:T.hits.HIT_N5_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.3327}]},{Name:T.hits.HIT_N5_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.352}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.8596}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.3596}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:.6542}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.3081}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_2,Stat:t.stat.ATK,Initial:1.6339}]}],_L=r.Factory({Name:"HuTaoA1",ApplySelf:!1,ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Where({owner:{ascension:1}}).Values(.12).Build()}),AL=r.Factory({Name:"HuTaoA4",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Where({owner:{ascension:4,hp:{leq:.5}}}).Values(.33).Build()}),SL=[{Name:T.hits.HIT_E,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.64}]}],uL=r.Factory({Name:"HuTaoE",ApplySelf:!0,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP,t.stat.ATK_BASE,t.stat.HP_BASE,t.stat.HP_FLAT,t.stat.HP_PERCENT).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_2).Rank(a=>a.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((a,e)=>{const s=e.GetCharacter(),n=.0384*a*s.Get(t.stat.HP),i=s.Get(t.stat.ATK_BASE)*4;return Math.max(0,Math.min(i,n))}).Next().infusion.Set(t.stat.PYRO_DMG,!0).Build()}),$i=d.Factory({Name:"HuTao",Element:t.stat.PYRO_DMG,Region:t.region.LIYUE,Stars:5,Weapon:t.weapon.POLEARM,HpBase:[1210.7164,4971.856],AtkBase:[8.2859,34.0239],DefBase:[68.2062,280.098],StatBonus:t.stat.CRIT_DMG,Normals:TL,Skills:SL,Bursts:nL,Extra:[],Effects:[uL,iL,_L,AL,rL,lL,oL,cL,EL],BurstCost:60}),hL=[{Name:T.hits.HIT_Q,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0731}]},{Name:T.hits.HIT_Q+"_THROW",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.0487}]}],LL=r.Factory({Name:"YelanC2",OnApply:new r.Builder().instance.Options({Name:"HIT_C2",Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.14,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build()}),NL=r.Factory({Name:"YelanC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),fL=r.Factory({Name:"YelanC4",MaxStacks:4,ApplySelf:!0,ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.1).Stacks().Build()}),mL=r.Factory({Name:"YelanC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),ML=r.Factory({Name:"YelanC6",OnApply:new r.Builder().instance.Options({Name:"HIT_C6",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:1.56*.1158,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),CL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4068}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3904}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.516}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3251}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:"HIT_BREAKTHROUGH_BARB",Element:t.stat.HYDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.1158}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],pL=r.Factory({Name:"YelanA1",ApplySelf:!0,OnApply:new r.Builder().observe.Party(!0).stat.Char(t.stat.HP_PERCENT).Where({owner:{ascension:1}}).Values(.06,.12,.18,.3).Rank(a=>{const e=a.GetParty();if(!e)return 1;const s=e.GetMembers(),n=new Map;for(const l of s)n.set(l.GetCharacter().Options.Element,!0);let i=0;for(const l of n.values())l&&i++;return i}).Build()}),GL=r.Factory({Name:"YelanA4",ApplySelf:!0,ApplyOther:!0,MaxTargets:1,MaxStacks:15,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Where({owner:{ascension:4}}).Values(.01).Next().stat.Char(t.stat.ALL_DMG).Where({owner:{ascension:4}}).Values(.035).Stacks().Map(a=>Math.min(.5,a)).Build()}),dL=[{Name:T.hits.HIT_E,Element:t.stat.HYDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.HP,Initial:.2261}]}],Xi=d.Factory({Name:"Yelan",Stars:5,Element:t.stat.HYDRO_DMG,Weapon:t.weapon.BOW,Region:t.region.LIYUE,BurstCost:70,HpBase:[1124.9176,4619.52],AtkBase:[18.9924,77.987366],DefBase:[42.65879,175.1841],StatBonus:t.stat.CRIT_RATE,Normals:CL,Skills:dL,Bursts:hL,Extra:[],Effects:[pL,GL,LL,NL,fL,mL,ML]}),gL=[{Name:T.hits.HIT_Q,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:[1,1.108,1.216,1.351,1.473,1.595,1.757,1.919,2.081,2.243,2.405,2.568,2.703,2.838,2.973],Stat:t.stat.ATK,Initial:4.0108}]}],RL=r.Factory({Name:"ZhongliC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),IL=r.Factory({Name:"ZhongliC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),DL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3077}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3115}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3858}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4294}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.1075}]},{Name:T.hits.HIT_N6,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.545}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:1.1103}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],OL=r.Factory({Name:"ZhongliA4",ApplySelf:!0,OnApply:new r.Builder().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.0139,/HIT_(N(\d)|CHARGED|PLUNGE)/).Next().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.019,/HIT_E/).Next().Where({target:{ascension:4}}).mv.Mv(t.stat.HP,.33,/HIT_Q/).Build()}),yL=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.16}]},{Name:T.hits.HIT_E+"_RESONANCE",Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.32}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.GEO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.8}]}],HL=r.Factory({Name:"ZhongliE",ApplySelf:!0,ApplyOther:!0,OnApply:(a,e,s)=>{const n=t.Elements;for(const i of n){const l=t.DmgToRes(i);s.Modifier(a.GetCharacter().GetEnemy().Subject.CreateModifier(l,-.2))}return()=>0}}),Ji=d.Factory({Name:"Zhongli",Stars:5,Element:t.stat.GEO_DMG,Weapon:t.weapon.POLEARM,Region:t.region.LIYUE,HpBase:[1143.984,4697.817],AtkBase:[19.551,80.2811],DefBase:[57.4368,235.872],StatBonus:t.stat.GEO_DMG,BurstCost:40,Normals:DL,Skills:yL,Bursts:gL,Extra:[],Effects:[HL,OL,RL,IL]}),vL=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.008}]},{Name:T.hits.HIT_N1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4447}]},{Name:T.hits.HIT_N2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.4396}]},{Name:T.hits.HIT_N3+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.5382}]},{Name:T.hits.HIT_N4+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3089}]},{Name:T.hits.HIT_N5+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7394}]},{Name:T.hits.HIT_CHARGED_1+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.616}]},{Name:T.hits.HIT_CHARGED_2+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.7436}]},{Name:T.hits.HIT_PLUNGE+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH+"_Q",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],PL=r.Factory({Name:"RaidenQ",MaxStacks:60,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.0389,T.hits.HIT_Q).Map((a,e,s)=>s.GetStacks()*a*o.TalentScaling.ELEMENTAL_1[Math.max(0,Math.min(o.TalentScaling.ELEMENTAL_1.length-1,e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1))]).Next().observe.Target(t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).mv.Mv(t.stat.ATK,.0073,/_.+_Q$/).Map((a,e,s)=>s.GetStacks()*a*o.TalentScaling.ELEMENTAL_1[Math.max(0,Math.min(o.TalentScaling.ELEMENTAL_1.length-1,e.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1))]).Build()}),BL=r.Factory({Name:"RaidenC2",OnApply:new r.Builder().stat.Char(t.stat.DEFIGNORED).Values(.6).Build()}),KL=r.Factory({Name:"RaidenC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),bL=r.Factory({Name:"RaidenC4",ApplyOther:!0,ApplySelf:!1,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.3).Build()}),wL=r.Factory({Name:"RaidenC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),YL=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3965}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3973}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4988}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.2898}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6545}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.9959}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],FL=r.Factory({Name:"RaidenA4",OnApply:new r.Builder().Where({target:{ascension:4}}).observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ELECTRO_DMG).Values(.4).Map((a,e)=>a*Math.max(0,e.GetCharacter().Get(t.stat.ENERGY_RECHARGE)-1)).Build()}),VL=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.172}]},{Name:T.hits.HIT_E+"_COORDINATED",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.42}]}],xL=r.Factory({Name:"RaidenE",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.0022,.0023,.0024,.0025,.0026,.0027,.0028,.0029,.003).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((a,e)=>a*e.GetCharacter().Options.BurstCost).Build()}),Zi=d.Factory({Name:"Raiden",Stars:5,Weapon:t.weapon.POLEARM,Region:t.region.INAZUMA,Element:t.stat.ELECTRO_DMG,StatBonus:t.stat.ENERGY_RECHARGE,BurstCost:90,AtkBase:[26.2542,107.80606],DefBase:[61.44541,252.3339],HpBase:[1004.79926,4126.249],Normals:YL,Skills:VL,Bursts:vL,Extra:[],Effects:[xL,PL,FL,BL,KL,bL,wL]}),kL=[{Name:T.hits.HIT_Q,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.328}]}],UL=r.Factory({Name:"BennettQ",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ATK_BASE,t.stat.ELEMENTAL_BURST_LEVEL,t.stat.ELEMENTAL_BURST_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)).Map((a,e,s)=>{const n=s.Owner.FindEffect("BennettC1");return(.56*a+(n&&n.Enabled()?.2:0))*s.Owner.GetCharacter().Get(t.stat.ATK_BASE)}).Build()}),WL=r.Factory({Name:"BennettC1",OnApply(a,e,s){const n=a.FindEffect("BennettQ");if(!n)throw new Error("Bennett Burst effect not found");const i=n;function l(){i.Enabled()&&(i.Disable(),i.Enable())}return l(),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,l)),s.Observer(e.CreateObserver(r.EffectEvent.DISABLE,l)),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_TARGET,l)),()=>0}}),jL=r.Factory({Name:"BennettC2",OnApply:new r.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.ENERGY_RECHARGE).Values(.3).Build()}),zL=r.Factory({Name:"BennettC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),qL=r.Factory({Name:"BennettC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),QL=r.Factory({Name:"BennettC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.PYRO_DMG).Values(.15).Next().Where({target:{weapon:[t.weapon.CLAYMORE,t.weapon.SWORD,t.weapon.POLEARM]}}).infusion.Set(t.stat.PYRO_DMG,!1).Build()}),$L=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4455}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4274}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5461}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5968}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.719}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.559}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6072}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.6393}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.2784}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.5968}]}],XL=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.376}]},{Name:T.hits.HIT_E_1_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.84}]},{Name:T.hits.HIT_E_1_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.92}]},{Name:T.hits.HIT_E_2_1,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.88}]},{Name:T.hits.HIT_E_2_2,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.96}]},{Name:T.hits.HIT_E_EXPLOSION,Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.32}]},{Name:"HIT_C4",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.92*1.35}]}],tr=d.Factory({Name:"Bennett",Stars:4,Weapon:t.weapon.SWORD,Element:t.stat.PYRO_DMG,Region:t.region.MONDSTADT,StatBonus:t.stat.ENERGY_RECHARGE,BurstCost:60,HpBase:[1039.4418,3719.104],AtkBase:[16.0272,57.34638],DefBase:[64.66425,231.3675],Normals:$L,Skills:XL,Bursts:kL,Effects:[UL,WL,jL,zL,qL,QL],Extra:[]}),JL=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.08}]}],ZL=r.Factory({Name:"FischlC1",OnApply:new r.Builder().instance.Options({Name:"HIT_C1",Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.22,Talent:t.stat.NONE}]}).Build()}),t1=r.Factory({Name:"FischlC2",OnApply:new r.Builder().mv.Mv(t.stat.ATK,2,/HIT_E$/).Build()}),a1=r.Factory({Name:"FischlC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),e1=r.Factory({Name:"FischlC4",OnApply:new r.Builder().instance.Options({Name:"HIT_C4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:2.22,Talent:t.stat.NONE}]}).Build()}),s1=r.Factory({Name:"FischlC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),n1=r.Factory({Name:"FischlC6",OnApply:new r.Builder().instance.Options({Name:"HIT_C6",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.3,Talent:t.stat.NONE}]}).Build()}),i1=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4412}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4678}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5814}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5771}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.7207}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],r1=r.Factory({Name:"FischlA1",OnApply:new r.Builder().Where({target:{ascension:1}}).instance.Options({Name:"HIT_A1",Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24*1.527,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),l1=r.Factory({Name:"FischlA4",OnApply:new r.Builder().Where({target:{ascension:4}}).instance.Options({Name:"HIT_A4",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:.8,Talent:t.stat.NONE}]}).Build()}),o1=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.1544}]},{Name:"HIT_OZ",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.888}]}],ar=d.Factory({Name:"Fischl",Stars:4,Element:t.stat.ELECTRO_DMG,Region:t.region.MONDSTADT,Weapon:t.weapon.BOW,StatBonus:t.stat.ATK_PERCENT,AtkBase:[20.4792,73.27593],HpBase:[770.4634,2756.704],DefBase:[49.78575,178.1325],BurstCost:60,Normals:i1,Skills:o1,Bursts:JL,Extra:[],Effects:[r1,l1,ZL,t1,a1,e1,s1,n1]}),c1=[{Name:T.hits.HIT_Q,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.624}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2}]}],E1=r.Factory({Name:"KazuhaQ",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(a,e,s){T1(a,e,s);function n(){const i=a.FindBurst(T.hits.HIT_Q+"_ADDITIONAL");if(!i)return;const l=e.GetAuras()[0];!l||(i.Options.Element=t.AuraToDmg(l))}return n(),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_AURAS,n)),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,n)),()=>0}}),T1=new r.Builder().instance.Location("Burst").Options({Name:T.hits.HIT_Q+"_ADDITIONAL",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.36,Talent:t.stat.ELEMENTAL_BURST_LEVEL}]}).Build(),_1=r.Factory({Name:"KazuhaC2",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(200).Build()}),A1=r.Factory({Name:"KazuhaC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),S1=r.Factory({Name:"KazuhaC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),u1=r.Factory({Name:"KazuhaC6",OnApply:new r.Builder().infusion.Set(t.stat.ANEMO_DMG,!1).Build()}),h1=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4498}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.4524}]},{Name:T.hits.HIT_N3_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.258}]},{Name:T.hits.HIT_N3_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.3096}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.6072}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.2537}]},{Name:T.hits.HIT_CHARGED_1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.43}]},{Name:T.hits.HIT_CHARGED_2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1A,Stat:t.stat.ATK,Initial:.7465}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439}]}],L1=r.Factory({Name:"KazuhaA1",MaxAuras:1,ValidAuras:t.Swirlable,OnApply(a,e,s){N1(a,e,s);function n(){const i=a.FindNormal("HIT_A1");if(!i)return;const l=e.GetAuras()[0];!l||(i.Options.Element=t.AuraToDmg(l))}return n(),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_AURAS,n)),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,n)),()=>0}}),N1=new r.Builder().Where({target:{ascension:1}}).instance.Location("Normal").Options({Name:"HIT_A1",Element:t.stat.PYRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Initial:2,Talent:t.stat.NONE}]}).Build(),f1=r.Factory({Name:"KazuhaA4",ApplyOther:!0,MaxAuras:1/0,ValidAuras:t.Swirlable,OnApply(a,e,s){const n=e.Owner.GetCharacter(),i=a.GetCharacter(),l=t.Elements.filter(_=>_!==t.stat.PHYSICAL_DMG).map(_=>s.Modifier(i.CreateModifier(_,0)));function E(){const _=e.GetAuras().map(A=>t.AuraToDmg(A));for(const A of l)_.includes(A.GetProp())&&n.GetAscension()>=4?A.SetValue(.04/100*n.Get(t.stat.ELEMENTAL_MASTERY)):A.SetValue(0)}return E(),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_AURAS,E)),s.Observer(n.CreateObserver(t.stat.ELEMENTAL_MASTERY,E)),s.Observer(n.CreateObserver(t.stat.LEVEL,E)),s.Observer(n.CreateObserver(t.stat.ASCENSION,E)),()=>0}}),m1=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.92}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.ANEMO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:2.608}]}],M1=r.Factory({Name:"KazuhaE",OnApply:new r.Builder().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.8183,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Next().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE_LOW+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.6363,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Next().instance.Location("Normal").Options({Name:T.hits.HIT_PLUNGE_HIGH+"_E",Element:t.stat.ANEMO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:2.0439,Talent:t.stat.NORMAL_ATTACK_LEVEL}]}).Build()}),er=d.Factory({Name:"Kazuha",Stars:5,Weapon:t.weapon.SWORD,Region:t.region.INAZUMA,Element:t.stat.ANEMO_DMG,StatBonus:t.stat.ELEMENTAL_MASTERY,BurstCost:60,HpBase:[1039.1188,4267.1836],AtkBase:[23.0888,94.80817],DefBase:[62.8215,257.985],Normals:h1,Skills:m1,Bursts:c1,Extra:[],Effects:[M1,E1,L1,f1,_1,A1,S1,u1]}),C1=[{Name:T.hits.HIT_Q,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:4.096}]},{Name:T.hits.HIT_Q_DOT,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_BURST_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.3412}]}],p1=r.Factory({Name:"SaraC2",OnApply:new r.Builder().instance.Location("Skill").Options({Name:"HIT_C2",Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2576*.3,Talent:t.stat.ELEMENTAL_SKILL_LEVEL}]}).Build()}),G1=r.Factory({Name:"SaraC3",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),d1=r.Factory({Name:"SaraC5",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),g1=r.Factory({Name:"SaraC6",ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ELECTRO_CRIT_DMG).Values(.6).Build()}),R1=[{Name:T.hits.HIT_N1,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.3689}]},{Name:T.hits.HIT_N2,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.387}]},{Name:T.hits.HIT_N3,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.485}]},{Name:T.hits.HIT_N4,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.504}]},{Name:T.hits.HIT_N5,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.585}]},{Name:T.hits.HIT_AIMED_NORMAL,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.4386}]},{Name:T.hits.HIT_AIMED_CHARGED,Element:t.stat.ELECTRO_DMG,Talent:t.stat.CHARGED_AIMED_SHOT_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.24}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Scaling:o.TalentScaling.PHYSICAL_1,Stat:t.stat.ATK,Initial:1.4193}]}],I1=[{Name:T.hits.HIT_E,Element:t.stat.ELECTRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.2576}]}],D1=r.Factory({Name:"SaraE",ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.ATK_BASE,t.stat.ELEMENTAL_SKILL_LEVEL,t.stat.ELEMENTAL_SKILL_LEVEL_UP).stat.Char(t.stat.ATK_FLAT).Values(...o.TalentScaling.ELEMENTAL_1).Rank((a,e)=>e.Owner.GetCharacter().Get(t.stat.ELEMENTAL_SKILL_LEVEL)).Map((a,e,s)=>.4296*a*s.Owner.GetCharacter().Get(t.stat.ATK_BASE)).Build()}),sr=d.Factory({Name:"Sara",Stars:4,Weapon:t.weapon.BOW,Region:t.region.INAZUMA,Element:t.stat.ELECTRO_DMG,BurstCost:80,HpBase:[802.3761,2870.8872],AtkBase:[16.38336,58.620743],DefBase:[52.647,188.37],StatBonus:t.stat.ATK_PERCENT,Normals:R1,Skills:I1,Bursts:C1,Extra:[],Effects:[D1,p1,G1,d1,g1]}),O1=[{Name:T.hits.HIT_N1,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.403}]},{Name:T.hits.HIT_N2,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.3697}]},{Name:T.hits.HIT_N3,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.4587}]},{Name:T.hits.HIT_N4,Element:t.stat.DENDRO_DMG,Talent:t.stat.NORMAL_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5841}]},{Name:T.hits.HIT_CHARGED,Element:t.stat.DENDRO_DMG,Talent:t.stat.CHARGED_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1A,Initial:1.32}]},{Name:T.hits.HIT_PLUNGE,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:.5683}]},{Name:T.hits.HIT_PLUNGE_LOW,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.1363}]},{Name:T.hits.HIT_PLUNGE_HIGH,Element:t.stat.DENDRO_DMG,Talent:t.stat.PLUNGE_ATTACK_DMG,Scaling:[{Stat:t.stat.ATK,Scaling:o.TalentScaling.ELEMENTAL_1,Initial:1.4193}]}],y1=r.Factory({Name:"NahidaA1",ApplyOther:!0,MaxTargets:1,OnApply(a,e,s){const n=a.GetCharacter(),i=e.Owner.GetCharacter(),l=s.Modifier(n.CreateModifier(t.stat.ELEMENTAL_MASTERY,0));let E=[];const _=[];function A(u){if(u===l)return;if(i.Get(t.stat.ASCENSION)<1){l.SetValue(0);return}let h=0,L=n;for(const f of E){const M=f.Get(t.stat.ELEMENTAL_MASTERY);M>h&&(h=M,L=f)}L===n&&(h-=l.GetValue());const N=Math.min(250,Math.max(0,.25*h));l.SetValue(N)}function S(){_.forEach(h=>h.Remove());const u=a.GetParty();if(!u)E=[n];else{E=[];for(const h of u.GetMembers())E.push(h.GetCharacter())}for(const h of E)_.push(s.Observer(h.CreateObserver(t.stat.ELEMENTAL_MASTERY,A)));A()}return S(),s.Observer(a.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,S)),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,S)),s.Observer(e.CreateObserver(r.EffectEvent.DISABLE,S)),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_CONDITIONS,S)),s.Observer(i.CreateObserver(t.stat.LEVEL,A)),s.Observer(i.CreateObserver(t.stat.ASCENSION,A)),()=>0}}),H1=[{Name:T.hits.HIT_E_PRESS,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:.984}]},{Name:T.hits.HIT_E_HOLD,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.304}]},{Name:T.hits.HIT_E_DOT,Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ATK,Initial:1.032},{Scaling:o.TalentScaling.ELEMENTAL_1,Stat:t.stat.ELEMENTAL_MASTERY,Initial:2.064}]}],v1=r.Factory({Name:"NahidaA4",OnApply(a,e,s){const n=a.GetCharacter(),i=a.FindSkill(T.hits.HIT_E_DOT);if(!i)throw new Error("Cannot find Nahida Skill");const l=s.Modifier(i.Subject.CreateModifier(t.stat.ALL_DMG,0)),E=s.Modifier(i.Subject.CreateModifier(t.stat.CRIT_RATE,0));let _,A;function S(){if(n.GetAscension()<4){l.SetValue(0),E.SetValue(0),_&&_.SetValue(0),A&&A.SetValue(0);return}const u=a.FindSkill("HIT_C6");u&&(_||(_=s.Modifier(u.Subject.CreateModifier(t.stat.ALL_DMG,0))),A||(A=s.Modifier(u.Subject.CreateModifier(t.stat.CRIT_RATE,0))));const h=Math.max(0,n.Get(t.stat.ELEMENTAL_MASTERY)-200),L=Math.min(.24,h*.03/100),N=Math.min(.8,h*.1/100);l.SetValue(N),E.SetValue(L),_&&_.SetValue(N),A&&A.SetValue(L)}return S(),s.Observer(n.CreateObserver(t.stat.ELEMENTAL_MASTERY,S)),s.Observer(n.CreateObserver(t.stat.LEVEL,S)),s.Observer(n.CreateObserver(t.stat.ASCENSION,S)),()=>0}}),P1=r.Factory({Name:"NahidaQ",OnApply(a,e,s){const n=a.FindSkill(T.hits.HIT_E_DOT);if(!n)throw new Error("Cannot find Nahida Skill");const i=s.Modifier(n.Subject.CreateModifier(t.stat.ALL_DMG,0));let l;function E(){const _=a.GetParty();if(!_){i.SetValue(0),l&&l.SetValue(0);return}const A=a.FindSkill("HIT_C6");A&&!l&&(l=s.Modifier(A.Subject.CreateModifier(t.stat.ALL_DMG,0)));const S=a.FindEffect("NahidaC1");let h=S&&S.Enabled()&&S.GetTargets().includes(a)?1:0;for(const f of _.GetMembers())f.GetCharacter().Options.Element===t.stat.PYRO_DMG&&h++;let L=0;h>=1&&(L=.1488),h>=2&&(L=.2232);const N=L*o.TalentScaling.ELEMENTAL_1[a.GetCharacter().Get(t.stat.ELEMENTAL_BURST_LEVEL)-1];i.SetValue(N),l&&l.SetValue(N)}return E(),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,E)),s.Observer(e.CreateObserver(r.EffectEvent.DISABLE,E)),s.Observer(a.GetCharacter().CreateObserver(t.stat.ELEMENTAL_BURST_LEVEL,E)),s.Observer(a.GetCharacter().CreateObserver(t.stat.ELEMENTAL_BURST_LEVEL_UP,E)),s.Observer(a.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,E)),()=>0}}),B1=r.Factory({Name:"NahidaC1",OnApply(a,e,s){const n=a.FindEffect("NahidaQ");if(!n)throw new Error("Nahida Burst effect not found");const i=n;function l(){i.Enabled()&&(i.Disable(),i.Enable())}return l(),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,l)),s.Observer(e.CreateObserver(r.EffectEvent.DISABLE,l)),s.Observer(e.CreateObserver(r.EffectEvent.CHANGE_TARGET,l)),()=>0}}),K1=r.Factory({Name:"NahidaC2",ApplyOther:!0,MaxAuras:1,ValidAuras:[t.aura.QUICKEN],OnApply(a,e,s){b1(a,e,s);const i=["BURGEON","BLOOM","HYPERBLOOM","BURNING"].map(l=>a.FindTr("HIT_"+l));for(const l of i)!l||(s.Modifier(l.Subject.CreateModifier(t.stat.CRIT_RATE,.2)),s.Modifier(l.Subject.CreateModifier(t.stat.CRIT_DMG,1)));return()=>0}}),b1=new r.Builder().Where({effect:{aura:[t.aura.QUICKEN]}}).stat.Enemy(t.stat.DEFREDUCTION).Values(.3).Build(),w1=r.Factory({Name:"NahidaC3",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_LEVEL_UP).Values(3).Build()}),Y1=r.Factory({Name:"NahidaC4",MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Stacks([0,100,120,140,160]).Build()}),F1=r.Factory({Name:"NahidaC5",ApplySelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_LEVEL_UP).Values(3).Build()}),V1=r.Factory({Name:"NahidaC6",OnApply(a,e,s){x1(a,e,s);function n(){const i=a.FindEffect("NahidaQ"),l=a.FindEffect("NahidaA4");i&&i.Enabled()&&(i.Disable(),i.Enable()),l&&l.Enabled()&&(l.Disable(),l.Enable())}return n(),s.Observer(e.CreateObserver(r.EffectEvent.ENABLE,n)),s.Observer(e.CreateObserver(r.EffectEvent.DISABLE,n)),()=>0}}),x1=new r.Builder().instance.Location("Skill").Options({Name:"HIT_C6",Element:t.stat.DENDRO_DMG,Talent:t.stat.ELEMENTAL_SKILL_DMG,Scaling:[{Scaling:o.TalentScaling.NONE,Stat:t.stat.ATK,Talent:t.stat.NONE,Initial:2},{Scaling:o.TalentScaling.NONE,Stat:t.stat.ELEMENTAL_MASTERY,Talent:t.stat.NONE,Initial:4}]}).Build(),nr=d.Factory({Name:"Nahida",Stars:5,Element:t.stat.DENDRO_DMG,Region:t.region.SUMERU,Weapon:t.weapon.CATALYST,StatBonus:t.stat.ELEMENTAL_MASTERY,BurstCost:50,HpBase:[806.5087,3311.961],AtkBase:[23.275,95.57275],DefBase:[49.0606,201.474],Normals:O1,Skills:H1,Bursts:[],Extra:[],Effects:[P1,y1,v1,B1,K1,w1,Y1,F1,V1]}),wa=new W(a=>a.Name);wa.AddList(Object.values(ci).sort((a,e)=>a.Name.localeCompare(e.Name)));function ir(){return wa.Get()}function k1(a){return wa.Find(a)}var nt={};R(nt,{Akuoumaru:()=>Tr,AlleyHunter:()=>yl,AmberBead:()=>co,AmenomaKageuchi:()=>Zr,AmosBow:()=>Cl,AquaSimulacra:()=>ml,AquilaFavonia:()=>zr,BeaconOfTheReedSea:()=>or,BlackTassel:()=>Ko,BlackcliffAgate:()=>so,BlackcliffLongsword:()=>sl,BlackcliffPole:()=>wo,BlackcliffSlasher:()=>Sr,BloodtaintedGreatsword:()=>ur,CalamityQueller:()=>ho,CinnabarSpindle:()=>Jr,CompoundBow:()=>vl,CoolSteel:()=>Ll,CrescentPike:()=>Io,DarkIronSword:()=>Al,Deathmatch:()=>Yo,DebateClub:()=>hr,DodocoTales:()=>to,DragonsBane:()=>Oo,DragonspineSpear:()=>go,ElegyForTheEnd:()=>Ho,EmeraldOrb:()=>To,EndOfTheLine:()=>pl,EngulfingLightning:()=>Co,EverlastingMoonglow:()=>zl,EyeOfPerception:()=>eo,FadingTwilight:()=>Ol,FavoniusCodex:()=>oo,FavoniusGreatsword:()=>Lr,FavoniusLance:()=>Po,FavoniusSword:()=>xo,FavoniusWarbow:()=>ko,FerrousShadow:()=>Nr,FesteringDesire:()=>tl,FilletBlade:()=>Sl,FindByName:()=>aN,ForestRegalia:()=>Mr,FreedomSworn:()=>Fr,Frostbearer:()=>ao,FruitOfFulfillment:()=>Xl,GetByType:()=>eN,GetList:()=>jo,HakushinRing:()=>Zl,Halberd:()=>Do,Hamayumi:()=>Rl,HaranGeppakuFutsu:()=>kr,HarbingerOfDawn:()=>hl,HuntersPath:()=>Nl,IronSting:()=>nl,JadeCutter:()=>Wr,JadeSpear:()=>Lo,KagotsurubeIsshin:()=>Xr,KagurasVerity:()=>jl,KatsuragikiriNagamasa:()=>Cr,KeyOfKhajNisut:()=>xr,KingsSquire:()=>Gl,KitainCrossSpear:()=>Go,LightOfFoliarIncision:()=>Vr,LionsRoar:()=>rl,LithicBlade:()=>Gr,LithicSpear:()=>Ro,LostPrayer:()=>Ql,LuxuriousSeaLord:()=>fr,MagicGuide:()=>So,MailedFlower:()=>lr,MakhairaAquamarine:()=>Ar,MappaMare:()=>no,MemoryOfDust:()=>ql,Messenger:()=>wl,MissiveWindspear:()=>mo,MistsplitterReforged:()=>Ur,MitternachtsWaltz:()=>Dl,Moonpiercer:()=>Mo,MouunsMoon:()=>dl,OathswornEye:()=>Jl,OtherworldlyStory:()=>_o,PolarStar:()=>Ml,Predator:()=>gl,PrototypeAmber:()=>io,PrototypeArchaic:()=>gr,PrototypeCrescent:()=>Pl,PrototypeRancour:()=>il,PrototypeStarglitter:()=>bo,Rainslasher:()=>Rr,RavenBow:()=>xl,RecurveBow:()=>Fl,RedhornStonethresher:()=>Ir,RoyalBow:()=>El,RoyalGreatsword:()=>Dr,RoyalGrimoire:()=>ol,RoyalLongsword:()=>Tl,RoyalSpear:()=>cl,Rust:()=>Bl,SacrificialBow:()=>Kl,SacrificialFragments:()=>lo,SacrificialGreatsword:()=>Or,SacrificialSword:()=>yo,SapwoodBlade:()=>$r,SerpentSpine:()=>Yr,SharpshootersOath:()=>Vl,SkyriderGreatsword:()=>yr,SkyriderSword:()=>_l,SkywardAtlas:()=>$l,SkywardBlade:()=>Fo,SkywardHarp:()=>Vo,SkywardPride:()=>Hr,SkywardSpine:()=>fo,Slingshot:()=>Yl,SnowTombedStarsilver:()=>vr,SolarPearl:()=>ro,SongOfBrokenPines:()=>dr,StaffOfHoma:()=>vo,StaffOfTheScarletSands:()=>uo,SummitShaper:()=>jr,SwordOfDescension:()=>al,TheAlleyFlash:()=>el,TheBell:()=>Pr,TheBlackSword:()=>cr,TheCatch:()=>Er,TheFlute:()=>ll,TheStringless:()=>bl,TheUnforged:()=>Br,TheViridescentHunt:()=>Hl,TheWidsith:()=>Uo,ThousandFloatingDreams:()=>Ul,ThrillingTalesOfDragonSlayers:()=>Ao,ThunderingPulse:()=>fl,ToukabouShigure:()=>qr,TravelersHandySword:()=>ul,TulaytullahsRemembrance:()=>kl,TwinNephrite:()=>Eo,VortexVanquisher:()=>No,WanderingEvenstar:()=>Wl,WavebreakerFin:()=>po,WhiteIronGreatsword:()=>br,WhiteTassel:()=>Bo,Whiteblind:()=>Kr,WindblumeOde:()=>Il,WolfsGravestone:()=>wr,XiphosMoonlight:()=>Qr});var rr={};R(rr,{Akuoumaru:()=>Tr,AlleyHunter:()=>yl,AmberBead:()=>co,AmenomaKageuchi:()=>Zr,AmosBow:()=>Cl,AquaSimulacra:()=>ml,AquilaFavonia:()=>zr,BeaconOfTheReedSea:()=>or,BlackTassel:()=>Ko,BlackcliffAgate:()=>so,BlackcliffLongsword:()=>sl,BlackcliffPole:()=>wo,BlackcliffSlasher:()=>Sr,BloodtaintedGreatsword:()=>ur,CalamityQueller:()=>ho,CinnabarSpindle:()=>Jr,CompoundBow:()=>vl,CoolSteel:()=>Ll,CrescentPike:()=>Io,DarkIronSword:()=>Al,Deathmatch:()=>Yo,DebateClub:()=>hr,DodocoTales:()=>to,DragonsBane:()=>Oo,DragonspineSpear:()=>go,ElegyForTheEnd:()=>Ho,EmeraldOrb:()=>To,EndOfTheLine:()=>pl,EngulfingLightning:()=>Co,EverlastingMoonglow:()=>zl,EyeOfPerception:()=>eo,FadingTwilight:()=>Ol,FavoniusCodex:()=>oo,FavoniusGreatsword:()=>Lr,FavoniusLance:()=>Po,FavoniusSword:()=>xo,FavoniusWarbow:()=>ko,FerrousShadow:()=>Nr,FesteringDesire:()=>tl,FilletBlade:()=>Sl,ForestRegalia:()=>Mr,FreedomSworn:()=>Fr,Frostbearer:()=>ao,FruitOfFulfillment:()=>Xl,HakushinRing:()=>Zl,Halberd:()=>Do,Hamayumi:()=>Rl,HaranGeppakuFutsu:()=>kr,HarbingerOfDawn:()=>hl,HuntersPath:()=>Nl,IronSting:()=>nl,JadeCutter:()=>Wr,JadeSpear:()=>Lo,KagotsurubeIsshin:()=>Xr,KagurasVerity:()=>jl,KatsuragikiriNagamasa:()=>Cr,KeyOfKhajNisut:()=>xr,KingsSquire:()=>Gl,KitainCrossSpear:()=>Go,LightOfFoliarIncision:()=>Vr,LionsRoar:()=>rl,LithicBlade:()=>Gr,LithicSpear:()=>Ro,LostPrayer:()=>Ql,LuxuriousSeaLord:()=>fr,MagicGuide:()=>So,MailedFlower:()=>lr,MakhairaAquamarine:()=>Ar,MappaMare:()=>no,MemoryOfDust:()=>ql,Messenger:()=>wl,MissiveWindspear:()=>mo,MistsplitterReforged:()=>Ur,MitternachtsWaltz:()=>Dl,Moonpiercer:()=>Mo,MouunsMoon:()=>dl,OathswornEye:()=>Jl,OtherworldlyStory:()=>_o,PolarStar:()=>Ml,Predator:()=>gl,PrototypeAmber:()=>io,PrototypeArchaic:()=>gr,PrototypeCrescent:()=>Pl,PrototypeRancour:()=>il,PrototypeStarglitter:()=>bo,Rainslasher:()=>Rr,RavenBow:()=>xl,RecurveBow:()=>Fl,RedhornStonethresher:()=>Ir,RoyalBow:()=>El,RoyalGreatsword:()=>Dr,RoyalGrimoire:()=>ol,RoyalLongsword:()=>Tl,RoyalSpear:()=>cl,Rust:()=>Bl,SacrificialBow:()=>Kl,SacrificialFragments:()=>lo,SacrificialGreatsword:()=>Or,SacrificialSword:()=>yo,SapwoodBlade:()=>$r,SerpentSpine:()=>Yr,SharpshootersOath:()=>Vl,SkyriderGreatsword:()=>yr,SkyriderSword:()=>_l,SkywardAtlas:()=>$l,SkywardBlade:()=>Fo,SkywardHarp:()=>Vo,SkywardPride:()=>Hr,SkywardSpine:()=>fo,Slingshot:()=>Yl,SnowTombedStarsilver:()=>vr,SolarPearl:()=>ro,SongOfBrokenPines:()=>dr,StaffOfHoma:()=>vo,StaffOfTheScarletSands:()=>uo,SummitShaper:()=>jr,SwordOfDescension:()=>al,TheAlleyFlash:()=>el,TheBell:()=>Pr,TheBlackSword:()=>cr,TheCatch:()=>Er,TheFlute:()=>ll,TheStringless:()=>bl,TheUnforged:()=>Br,TheViridescentHunt:()=>Hl,TheWidsith:()=>Uo,ThousandFloatingDreams:()=>Ul,ThrillingTalesOfDragonSlayers:()=>Ao,ThunderingPulse:()=>fl,ToukabouShigure:()=>qr,TravelersHandySword:()=>ul,TulaytullahsRemembrance:()=>kl,TwinNephrite:()=>Eo,VortexVanquisher:()=>No,WanderingEvenstar:()=>Wl,WavebreakerFin:()=>po,WhiteIronGreatsword:()=>br,WhiteTassel:()=>Bo,Whiteblind:()=>Kr,WindblumeOde:()=>Il,WolfsGravestone:()=>wr,XiphosMoonlight:()=>Qr});var lr=m.Factory({Name:"MailedFlower",Stars:4,Type:t.weapon.CLAYMORE,Substat:t.stat.ELEMENTAL_MASTERY,Scaling:o.WeaponScaling.TYPE_44,Effects:[r.Factory({Name:"MailedFlower1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(48,60,72,84,96).Build()})]}),or=m.Factory({Name:"BeaconOfTheReedSea",Stars:5,Type:t.weapon.CLAYMORE,Substat:t.stat.CRIT_RATE,Scaling:o.WeaponScaling.TYPE_46,Effects:[r.Factory({Name:"BeaconOfTheReedSea1",MaxRank:5,Conditions:["HIT_SKILL","DMG_TAKEN"],MaxConditions:2,OnApply:new r.Builder().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["DMG_TAKEN"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().Where({target:{shielded:!1}}).stat.Char(t.stat.HP_PERCENT).Values(.32,.4,.48,.56,.64).Build()})]}),cr=m.Factory({Name:"TheBlackSword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"TheBlackSword1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),Er=m.Factory({Name:"TheCatch",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"TheCatch1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ELEMENTAL_BURST_CRIT_RATE).Values(.06,.075,.09,.105,.12).Build()})]}),Ya=a=>r.Factory({Name:a,MaxRank:5,OnApply(e,s,n){const i=e.GetCharacter(),l=n.Modifier(i.CreateModifier(t.stat.ELEMENTAL_BURST_DMG,0));function E(){let _=[i];const A=e.GetParty();A&&(_=A.GetMembers().map(h=>h.GetCharacter()));let S=0;for(const h of _)S+=h.Options.BurstCost;const u=Math.min(W1[s.GetRank()-1],U1[s.GetRank()-1]*S);l.SetValue(u)}return n.Observer(s.Event.CreateObserver(r.EffectEvent.CHANGE_RANK,E)),n.Observer(e.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,E)),()=>0}}),U1=[.12/100,.15/100,.18/100,.21/100,.24/100],W1=[.4,.5,.6,.7,.8],Tr=m.Factory({Name:"Akuoumaru",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Ya("Akuoumaru1")]}),_r=(a,e,s)=>r.Factory({Name:a,ApplyOther:!0,StackSelf:!0,MaxRank:5,OnApply(n,i,l){const E=i.Owner.GetCharacter(),_=n.GetCharacter(),A=l.Modifier(_.CreateModifier(e,0));function S(){const u=E.Get(t.stat.ELEMENTAL_MASTERY);let h=s[i.GetRank()-1]*u;E!==_&&(h*=.3),A.SetValue(h)}return S(),l.Observer(E.CreateObserver(t.stat.ELEMENTAL_MASTERY,S)),()=>0}}),Ar=m.Factory({Name:"MakhairaAquamarine",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[_r("MakhairaAquamarine1",t.stat.ATK_FLAT,[.24,.3,.36,.42,.48])]}),qt=a=>r.Factory({Name:a,MaxRank:5,MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Stacks().Build()}),Sr=m.Factory({Name:"BlackcliffSlasher",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[qt("BlackcliffSlasher1")]}),ur=m.Factory({Name:"BloodtaintedGreatsword",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"BloodtaintedGreatsword1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),hr=m.Factory({Name:"DebateClub",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"DebateClub1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_DebateClub",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.6,.75,.9,1.05,1.2]}).Build()})]}),Lr=m.Factory({Name:"FavoniusGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Nr=m.Factory({Name:"FerrousShadow",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"FerrousShadow1",MaxRank:5,OnApply:new r.Builder().Where({target:{hp:{leq:.7}}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.3,.35,.4,.45,.5).Build()})]}),fr=m.Factory({Name:"LuxuriousSeaLord",Type:t.weapon.CLAYMORE,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"LuxuriousSeaLord1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_BURST_DMG).Values(.12,.15,.18,.21,.24).Next().instance.Basic({Name:"HIT_LuxuriousSeaLord",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),mr=a=>r.Factory({Name:a,MaxRank:5,ApplyOther:!0,MaxTargets:1,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,75,90,105,120).Build()}),Mr=m.Factory({Name:"ForestRegalia",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[mr("ForestRegalia1")]}),Cr=m.Factory({Name:"KatsuragikiriNagamasa",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"KatsuragikiriNagamasa1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.06,.075,.09,.105,.12).Build()})]}),pr=a=>r.Factory({Name:a,MaxRank:5,OnApply(e,s,n){const i=e.GetCharacter(),l=n.Modifier(i.CreateModifier(t.stat.CRIT_RATE,0)),E=n.Modifier(i.CreateModifier(t.stat.ATK_PERCENT,0));function _(){let A=[i];const S=e.GetParty();S&&(A=S.GetMembers().map(N=>N.GetCharacter()));const u=Math.min(4,A.filter(N=>N.Options.Region===t.region.LIYUE).length),h=j1[s.GetRank()-1]*u,L=z1[s.GetRank()-1]*u;l.SetValue(h),E.SetValue(L)}return _(),n.Observer(s.CreateObserver(r.EffectEvent.CHANGE_RANK,_)),n.Observer(e.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,_)),()=>0}}),j1=[.03,.04,.05,.06,.07],z1=[.07,.08,.09,.1,.11],Gr=m.Factory({Name:"LithicBlade",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[pr("LithicBlade1")]}),Fa=new Map;function q1(a){const e=Fa.get(a);if(!e){const s=new Set;return Fa.set(a,s),s}return e}var Va=({Name:a,OnApply:e})=>r.Factory({Name:a,MaxRank:5,ApplyOther:!0,OnApply(s,n,i){e(s,n,i);const l=i.GetModifiers(),E=q1(s);l.forEach(A=>E.add(A));function _(){for(const A of l)Array.from(E).some(u=>u!==A&&u.GetProp()===A.GetProp()&&u.Enabled()&&u.GetValue()!==0)&&(A.SetValue(0),A.Disable())}_();for(const A of r.EffectEvent.Values())i.Observer(n.CreateObserver(A,_));return()=>{l.forEach(A=>E.delete(A)),E.size===0&&Fa.delete(s)}}}),dr=m.Factory({Name:"SongOfBrokenPines",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_49,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"SongOfBrokenPines1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()}),Va({Name:"SongOfBrokenPines2",OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),gr=m.Factory({Name:"PrototypeArchaic",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"PrototypeArchaic1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_PrototypeArchaic",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,3,3.6,4.2,4.8]}).Build()})]}),Rr=m.Factory({Name:"Rainslasher",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"Rainslasher1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),Ir=m.Factory({Name:"RedhornStonethresher",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"RedhornStonethresher1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.DEF_PERCENT).Values(.28,.35,.42,.49,.56).Next().observe.Target(t.stat.DEF,t.stat.DEF_PERCENT,t.stat.DEF_FLAT).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(.4,.5,.6,.7,.8).Map((a,e)=>a*e.GetCharacter().Get(t.stat.DEF)).Build()})]}),Dt=a=>r.Factory({Name:a,MaxRank:5,OnApply(e,s,n){const i=e.GetCharacter();function l(E=!0){if(!E)i.MapCritRate=_=>_;else{const _=s.GetRank();i.MapCritRate=A=>A+Q1(_,A)}}return l(!0),n.Observer(s.CreateObserver(r.EffectEvent.ENABLE,()=>l(!0))),n.Observer(s.CreateObserver(r.EffectEvent.CHANGE_RANK,()=>l(!0))),n.Observer(s.CreateObserver(r.EffectEvent.DISABLE,()=>l(!1))),()=>l(!1)}});function Q1(a,e){if(e<-1||e>1)return 0;const s=e,n=.08+.02*(a-1),i=s<0?0:s<1-n?1:2,l=$1[a-1][i],E=l.map((_,A)=>s<-5*n?0:_*jc(s,l.length-A-1)).reduce((_,A)=>_+A,0);return Math.max(0,E)}var $1=[[[-128.4499,-138.4761,-59.75334,-11.00387,-.4655975,.4539864,.189614],[-.10036,.30971,-.39967,.18932],[.86583,-1.7362,.87032]],[[-51.0823,-67.9198,-35.7478,-8.08299,-.414222,.417227,.211754],[-.097754,.31144,-.42638,.21147],[.85002,-1.7068,.85672]],[[-23.0139,-36.3491,-22.6081,-6.08691,-.374257,.388127,.230281],[-.092576,.30589,-.44477,.23006],[.81059,-1.6312,.82054]],[[-12.3361,-22.796,-16.482,-5.21919,-.421051,.360611,.246312],[-.087477,.29824,-.45863,.24612],[.80621,-1.623,.81666]],[[-6.99091,-14.7677,-12.1447,-4.39816,-.424118,.340408,.260555],[-.077554,.28287,-.46728,.2603],[.79212,-1.5973,.805]]],Dr=m.Factory({Name:"RoyalGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Dt("RoyalGreatsword1")]}),Or=m.Factory({Name:"SacrificialGreatsword",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),yr=m.Factory({Name:"SkyriderGreatsword",Type:t.weapon.CLAYMORE,Stars:3,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"SkyriderGreatsword1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.06,.07,.08,.09,.1).Build()})]}),Hr=m.Factory({Name:"SkywardPride",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"SkywardPride1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.08,.1,.12,.14,.16).Next().instance.Basic({Name:"HIT_SkywardPride",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.8,1,1.2,1.4,1.6]}).Build()})]}),xa=(a,e)=>r.Factory({Name:a,MaxRank:5,OnApply:new r.Builder().instance.Options({Name:e,Element:t.stat.PHYSICAL_DMG,Talent:t.stat.NONE,Scaling:[{Initial:0,Stat:t.stat.NONE,Talent:t.stat.NONE,Scaling:o.TalentScaling.NONE}]}).Next().Where({not:!0,enemy:{affected:[t.stat.CRYO_DMG]}}).mv.Mv(t.stat.ATK,.8,e).Map((s,n,i)=>[.8,.95,1.1,1.25,1.4][i.GetRank()-1]).Next().Where({enemy:{affected:[t.stat.CRYO_DMG]}}).mv.Mv(t.stat.ATK,2,e).Map((s,n,i)=>[2,2.4,2.8,3.2,3.6][i.GetRank()-1]).Build()}),vr=m.Factory({Name:"SnowTombedStarsilver",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[xa("SnowTombedStarsilver1","HIT_SnowTombedStarsilver")]}),Pr=m.Factory({Name:"TheBell",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"TheBell1",MaxRank:5,OnApply:new r.Builder().Where({target:{shielded:!0}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),Qt=a=>r.Factory({Name:a,MaxRank:5,MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Next().Where({target:{shielded:!0}}).stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()}),Br=m.Factory({Name:"TheUnforged",Type:t.weapon.CLAYMORE,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[Qt("TheUnforged1")]}),Kr=m.Factory({Name:"Whiteblind",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.DEF_PERCENT,Effects:[r.Factory({Name:"Whiteblind1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),br=m.Factory({Name:"WhiteIronGreatsword",Stars:3,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.DEF_PERCENT,Effects:[]}),wr=m.Factory({Name:"WolfsGravestone",Stars:5,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"WolfsGravestone1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()}),r.Factory({Name:"WolfsGravestone2",MaxRank:5,ApplyOther:!0,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.4,.5,.6,.7,.8).Build()})]}),Yr=m.Factory({Name:"SerpentSpine",Stars:4,Type:t.weapon.CLAYMORE,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"SerpentSpine1",MaxRank:5,MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.06,.07,.08,.09,.1).Stacks().Build()})]}),Fr=m.Factory({Name:"FreedomSworn",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"FreedomSworn1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.1,.125,.15,.175,.2).Build()}),Va({Name:"FreedomSworn2",OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG,t.stat.PLUNGE_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),Vr=m.Factory({Name:"LightOfFoliarIncision",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"LightOfFoliarIncision1",MaxRank:5,Conditions:["HIT_NORMAL"],MaxConditions:1,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.04,.05,.06,.07,.08).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT,t.stat.ELEMENTAL_SKILL_DMG_FLAT).Values(1.2,1.5,1.8,2.1,2.4).Map((a,e)=>a*e.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()})]}),xr=m.Factory({Name:"KeyOfKhajNisut",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"KeyOfKhajNisut1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Build()}),r.Factory({Name:"KeyOfKhajNisut2",MaxRank:5,MaxStacks:3,ApplyOther:!0,OnApply:new r.Builder().observe.Owner(t.stat.HP,t.stat.HP_PERCENT,t.stat.HP_FLAT).Where({target:{isOwner:!0}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(.12,.15,.18,.21,.24).Stacks().Map((a,e)=>a*e.GetCharacter().Get(t.stat.HP)/100).Next().observe.Owner(t.stat.HP,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ELEMENTAL_MASTERY).Stacks([0,0,0,.2],[0,0,0,.25],[0,0,0,.3],[0,0,0,.35],[0,0,0,.4]).Map((a,e,{Owner:s})=>a*s.GetCharacter().Get(t.stat.HP)/100).Build()})]}),kr=m.Factory({Name:"HaranGeppakuFutsu",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"HaranGeppakuFutsu1",MaxRank:5,MaxStacks:2,OnApply:new r.Builder().stat.Char(...t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Stacks().Build()})]}),Ur=m.Factory({Name:"MistsplitterReforged",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"MistsplitterReforged1",MaxRank:5,MaxStacks:3,OnApply:new r.Builder().stat.Char(...t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char().MapStat(a=>[a.GetCharacter().Options.Element]).Stacks([0,.08,.16,.28],[0,.1,.2,.35],[0,.12,.24,.42],[0,.14,.28,.49],[0,.16,.32,.56]).Build()})]}),Wr=m.Factory({Name:"JadeCutter",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"JadeCutter1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Next().stat.Char(t.stat.ATK_FLAT).Values(.012,.015,.018,.021,.024).Map((a,e)=>a*e.GetCharacter().Get(t.stat.HP)).Build()})]}),jr=m.Factory({Name:"SummitShaper",Stars:5,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[Qt("SummitShaper1")]}),zr=m.Factory({Name:"AquilaFavonia",Type:t.weapon.SWORD,Stars:5,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"AquilaFavonia1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().instance.Basic({Name:"HIT_AquilaFavonia",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2,2.3,2.6,2.9,3.2]}).Build()})]}),qr=m.Factory({Name:"ToukabouShigure",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"ToukabouShigure1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.16,.2,.24,.28,.32).Build()})]}),Qr=m.Factory({Name:"XiphosMoonlight",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[_r("XiphosMoonlight1",t.stat.ENERGY_RECHARGE,[.036/100,.045/100,.054/100,.063/100,.072/100])]}),$r=m.Factory({Name:"SapwoodBlade",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[mr("SapwoodBlade1")]}),Xr=m.Factory({Name:"KagotsurubeIsshin",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"KagotsurubeIsshin1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_KagotsurubeIsshin",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.8]}).Next().stat.Char(t.stat.ATK_PERCENT).Values(.15).Build()})]}),Jr=m.Factory({Name:"CinnabarSpindle",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.DEF_PERCENT,Effects:[r.Factory({Name:"CinnabarSpindle1",MaxRank:5,OnApply:new r.Builder().mv.Mv(t.stat.DEF,.4,a=>a.Options.Talent===t.stat.ELEMENTAL_SKILL_DMG).Map((a,e,s)=>[.4,.5,.6,.7,.8][s.GetRank()-1]).Build()})]}),Zr=m.Factory({Name:"AmenomaKageuchi",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[]}),tl=m.Factory({Name:"FesteringDesire",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"FesteringDesire1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.ELEMENTAL_SKILL_CRIT_RATE).Values(.06,.075,.09,.105,.12).Build()})]}),al=m.Factory({Name:"SwordOfDescension",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39b,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"SwordOfDescension1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_SwordOfDescension",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2]}).Next().Where({target:{name:/traveler/i}}).stat.Char(t.stat.ATK_FLAT).Values(66).Build()})]}),el=m.Factory({Name:"TheAlleyFlash",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"TheAlleyFlash1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),sl=m.Factory({Name:"BlackcliffLongsword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.CRIT_DMG,Effects:[qt("BlackcliffLongsword1")]}),nl=m.Factory({Name:"IronSting",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"IronSting1",MaxRank:5,MaxStacks:2,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),il=m.Factory({Name:"PrototypeRancour",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"PrototypeRancour1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()})]}),rl=m.Factory({Name:"LionsRoar",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"LionsRoar1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),ll=m.Factory({Name:"TheFlute",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"TheFlute1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_TheFlute",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),ol=m.Factory({Name:"RoyalGrimoire",Type:t.weapon.CATALYST,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Dt("RoyalGrimoire1")]}),cl=m.Factory({Name:"RoyalSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Dt("RoyalSpear1")]}),El=m.Factory({Name:"RoyalBow",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Dt("RoyalBow1")]}),Tl=m.Factory({Name:"RoyalLongsword",Stars:4,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[Dt("RoyalLongsword1")]}),_l=m.Factory({Name:"SkyriderSword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"SkyriderSword1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Build()})]}),Al=m.Factory({Name:"DarkIronSword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"DarkIronSword1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),Sl=m.Factory({Name:"FilletBlade",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"FilletBlade1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_FilletBlade",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,2.8,3.2,3.6,4]}).Build()})]}),ul=m.Factory({Name:"TravelersHandySword",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.DEF_PERCENT,Effects:[]}),hl=m.Factory({Name:"HarbingerOfDawn",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"HarbingerOfDawn1",MaxRank:5,OnApply:new r.Builder().Where({target:{hp:{geq:.9}}}).stat.Char(t.stat.CRIT_RATE).Values(.14,.175,.21,.245,.28).Build()})]}),Ll=m.Factory({Name:"CoolSteel",Stars:3,Type:t.weapon.SWORD,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"CoolSteel1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.CRYO_DMG,t.stat.HYDRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),Nl=m.Factory({Name:"HuntersPath",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"HuntersPath1",MaxRank:5,Conditions:["HIT_CHARGED"],MaxConditions:1,OnApply:new r.Builder().stat.Char(...t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).Where({effect:{conditions:["HIT_CHARGED"]}}).stat.Char(t.stat.CHARGED_ATTACK_DMG_FLAT).Values(1.6,2,2.4,2.8,3.2).Map((a,e)=>a*e.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Build()})]}),fl=m.Factory({Name:"ThunderingPulse",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"ThunderingPulse1",MaxRank:5,MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG).Stacks([0,.12,.24,.4],[0,.15,.3,.5],[0,.18,.36,.6],[0,.21,.42,.7],[0,.24,.48,.8]).Build()})]}),ml=m.Factory({Name:"AquaSimulacra",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"AquaSimulacra1",MaxRank:5,Conditions:["FAR","NEAR"],MaxConditions:1,OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["NEAR"]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),Ml=m.Factory({Name:"PolarStar",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"PolarStar1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Stacks([0,.1,.2,.3,.48],[0,.125,.25,.375,.6],[0,.15,.3,.45,.72],[0,.175,.35,.525,.84],[0,.2,.4,.6,.96]).Build()})]}),Cl=m.Factory({Name:"AmosBow",Stars:5,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"AmosBow1",MaxRank:5,MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),pl=m.Factory({Name:"EndOfTheLine",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"EndOfTheLine1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_EndOfTheLine",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.8,1,1.2,1.4,1.6]}).Build()})]}),Gl=m.Factory({Name:"KingsSquire",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"KingsSquire1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,80,100,120,140).Next().instance.Basic({Name:"HIT_KingsSquire",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.2,1.4,1.6,1.8]}).Build()})]}),dl=m.Factory({Name:"MouunsMoon",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[Ya("MouunsMoon1")]}),gl=m.Factory({Name:"Predator",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"Predator1",MaxRank:5,MaxStacks:2,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.1).Stacks().Next().Where({target:{name:"Aloy"}}).stat.Char(t.stat.ATK_FLAT).Values(66).Build()})]}),Rl=m.Factory({Name:"Hamayumi",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"Hamayumi1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().Where({target:{energy:{geq:1}}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().Where({target:{energy:{geq:1}}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.12,.15,.18,.21,.24).Next().Build()})]}),Il=m.Factory({Name:"WindblumeOde",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"WindblumeOde1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()})]}),Dl=m.Factory({Name:"MitternachtsWaltz",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"MitternachtsWaltz1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_SKILL"],MaxConditions:2,OnApply:new r.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Build()})]}),Ol=m.Factory({Name:"FadingTwilight",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"FadingTwilight1",MaxRank:5,MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Stacks([0,.06,.1,.14],[0,.075,.125,.175],[0,.09,.15,.21],[0,.105,.175,.245],[0,.12,.2,.28]).Build()})]}),yl=m.Factory({Name:"AlleyHunter",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"AlleyHunter1",MaxRank:5,MaxStacks:10,OnApply:new r.Builder().stat.Char(t.stat.ALL_DMG).Values(.02,.025,.03,.035,.04).Stacks().Build()})]}),Hl=m.Factory({Name:"TheViridescentHunt",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"TheViridescentHunt1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_TheViridescentHunt",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.4,.5,.6,.7,.8]}).Build()})]}),vl=m.Factory({Name:"CompoundBow",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"CompoundBow1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.04,.05,.06,.07,.08).Stacks().Build()})]}),Pl=m.Factory({Name:"PrototypeCrescent",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"PrototypeCrescent1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.36,.45,.54,.63,.72).Build()})]}),Bl=m.Factory({Name:"Rust",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"Rust1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.4,.5,.6,.7,.8).Next().stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(-.1).Build()})]}),Kl=m.Factory({Name:"SacrificialBow",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),bl=m.Factory({Name:"TheStringless",Stars:4,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"TheStringless1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),wl=m.Factory({Name:"Messenger",Type:t.weapon.BOW,Stars:3,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"Messenger1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_Messenger",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1,1.25,1.5,1.75,2]}).Build()})]}),Yl=m.Factory({Name:"Slingshot",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"Slingshot1",MaxRank:5,Conditions:["FAR","NEAR"],MaxConditions:1,OnApply:new r.Builder().Where({effect:{conditions:["FAR"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.36,.42,.48,.54,.6).Next().Where({effect:{conditions:["NEAR"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(-.1).Build()})]}),Fl=m.Factory({Name:"RecurveBow",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.HP_PERCENT,Effects:[]}),Vl=m.Factory({Name:"SharpshootersOath",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"SharpshootersOath1",Conditions:["WEAK_SPOT"],MaxConditions:1,MaxRank:5,OnApply:new r.Builder().Where({effect:{conditions:["WEAK_SPOT"]}}).stat.Char(t.stat.AIMED_SHOT_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),xl=m.Factory({Name:"RavenBow",Stars:3,Type:t.weapon.BOW,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"RavenBow1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.PYRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),kl=m.Factory({Name:"TulaytullahsRemembrance",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"TulaytullahsRemembrance1",MaxRank:5,MaxStacks:10,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.048,.06,.072,.084,.096).Stacks().Build()})]}),Ul=m.Factory({Name:"ThousandFloatingDreams",Type:t.weapon.CATALYST,Stars:5,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"ThousandFloatingDreams1",MaxRank:5,OnApply(a,e,s){const n=a.GetCharacter(),i=s.Modifier(n.CreateModifier(t.stat.ELEMENTAL_MASTERY,0)),l=[s.Modifier(n.CreateModifier(n.Options.Element,0)),s.Modifier(n.CreateModifier(n.Options.Element,0)),s.Modifier(n.CreateModifier(n.Options.Element,0))];function E(){l.forEach(h=>h.SetValue(0));let _=[n];const A=a.GetParty();A&&(_=A.GetMembers().map(h=>h.GetCharacter()));let S=0,u=0;for(const h of _)if(h!==n)if(h.Options.Element===n.Options.Element)S++;else{const L=l[u++];if(!L)continue;L.SetProp(h.Options.Element),L.SetValue(J1[e.GetRank()-1])}S=Math.min(3,S),i.SetValue(X1[e.GetRank()-1]*S)}return E(),s.Observer(a.Event.CreateObserver(d.CharboxEvent.CHANGE_PARTY,E)),s.Observer(e.Event.CreateObserver(r.EffectEvent.CHANGE_RANK,E)),()=>0}}),r.Factory({Name:"ThousandFloatingDreams2",MaxRank:5,ApplyOther:!0,ApplySelf:!1,StackSelf:!0,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(40,42,44,46,48).Build()})]}),X1=[32,40,48,56,64],J1=[.1,.14,.18,.22,.26],Wl=m.Factory({Name:"WanderingEvenstar",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"WanderingEvenstar1",StackSelf:!0,ApplyOther:!0,MaxRank:5,OnApply:new r.Builder().observe.Owner(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.24,.3,.36,.42,.48).Map((a,e,s)=>a*s.Owner.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)*(e===s.Owner?1:.3)).Build()})]}),jl=m.Factory({Name:"KagurasVerity",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"KagurasVerity1",MaxRank:5,MaxStacks:3,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.12,.15,.18,.21,.24).Stacks().Next().stat.Char(...t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG)).Stacks([0,0,0,.12],[0,0,0,.15],[0,0,0,.18],[0,0,0,.21],[0,0,0,.24]).Build()})]}),zl=m.Factory({Name:"EverlastingMoonglow",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"EverlastingMoonglow1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.HEALING_BONUS).Values(.1,.125,.15,.175,.2).Next().observe.Target(t.stat.HP_PERCENT,t.stat.HP_BASE,t.stat.HP_FLAT).stat.Char(t.stat.NORMAL_ATTACK_DMG_FLAT).Values(.01,.015,.02,.025,.03).Map((a,e)=>a*e.GetCharacter().Get(t.stat.HP)).Build()})]}),ql=m.Factory({Name:"MemoryOfDust",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[Qt("MemoryOfDust1")]}),Ql=m.Factory({Name:"LostPrayer",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"LostPrayer1",MaxRank:5,MaxStacks:4,OnApply:new r.Builder().stat.Char(...t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG)).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),$l=m.Factory({Name:"SkywardAtlas",Stars:5,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"SkywardAtlas1",MaxRank:5,OnApply:new r.Builder().stat.Char(...t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().instance.Basic({Name:"HIT_SkywardAtlas",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.6,2,2.4,4.8,3.2]}).Build()})]}),Xl=m.Factory({Name:"FruitOfFulfillment",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"FruitOfFulfillment1",MaxRank:5,MaxStacks:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(24,27,30,33,36).Stacks().Next().stat.Char(t.stat.ATK_PERCENT).Values(-.05).Stacks().Build()})]}),Jl=m.Factory({Name:"OathswornEye",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"OathswornEye1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ENERGY_RECHARGE).Values(.24,.3,.36,.42,.48).Build()})]}),Zl=m.Factory({Name:"HakushinRing",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"HakushinRing1",ApplyOther:!0,MaxRank:5,OnApply:new r.Builder().stat.Char().MapStat(a=>[a.GetCharacter().Options.Element]).Values(.1,.125,.15,.175,.2).Build()})]}),to=m.Factory({Name:"DodocoTales",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"DodocoTales1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_CHARGED"],MaxConditions:2,OnApply:new r.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.CHARGED_ATTACK_DMG).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["HIT_CHARGED"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.08,.1,.12,.14,.16).Next().Build()})]}),ao=m.Factory({Name:"Frostbearer",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[xa("Frostbearer1","HIT_Frostbearer")]}),eo=m.Factory({Name:"EyeOfPerception",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"EyeOfPerception1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_EyeOfPerception",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[2.4,2.7,3,3.3,3.6]}).Build()})]}),so=m.Factory({Name:"BlackcliffAgate",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[qt("BlackcliffAgate1")]}),no=m.Factory({Name:"MappaMare",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"MappaMare1",MaxRank:5,MaxStacks:2,OnApply:new r.Builder().stat.Char(...t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG)).Values(.08,.1,.12,.14,.16).Stacks().Build()})]}),io=m.Factory({Name:"PrototypeAmber",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.HP_PERCENT,Effects:[]}),ro=m.Factory({Name:"SolarPearl",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"SolarPearl1",MaxRank:5,Conditions:["HIT_NORMAL","HIT_SKILL"],MaxConditions:2,OnApply:new r.Builder().Where({effect:{conditions:["HIT_NORMAL"]}}).stat.Char(t.stat.ELEMENTAL_SKILL_DMG,t.stat.ELEMENTAL_BURST_DMG).Values(.2,.25,.3,.35,.4).Next().Where({effect:{conditions:["HIT_SKILL"]}}).stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.2,.25,.3,.35,.4).Next().Build()})]}),lo=m.Factory({Name:"SacrificialFragments",Type:t.weapon.CATALYST,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[]}),oo=m.Factory({Name:"FavoniusCodex",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),co=m.Factory({Name:"AmberBead",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"AmberBead1",MaxRank:5,MaxStacks:2,OnApply:new r.Builder().stat.Char(...t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG)).Values(.06,.075,.09,.105,.12).Stacks().Build()})]}),Eo=m.Factory({Name:"TwinNephrite",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"TwinNephrite1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.14,.16,.18,.2).Build()})]}),To=m.Factory({Name:"EmeraldOrb",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"EmeraldOrb1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),_o=m.Factory({Name:"OtherworldlyStory",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Ao=m.Factory({Name:"ThrillingTalesOfDragonSlayers",Stars:3,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"ThrillingTalesOfDragonSlayers1",MaxRank:5,ApplySelf:!1,ApplyOther:!0,MaxTargets:1,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.24,.3,.36,.42,.48).Build()})]}),So=m.Factory({Name:"MagicGuide",Type:t.weapon.CATALYST,Stars:3,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"MagicGuide1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.ELECTRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.12,.15,.18,.21,.24).Build()})]}),uo=m.Factory({Name:"StaffOfTheScarletSands",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44b,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"StaffOfTheScarletSands1",MaxRank:5,MaxStacks:3,OnApply:new r.Builder().observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.52,.65,.78,.91,1.04).Map((a,e)=>a*e.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Next().observe.Target(t.stat.ELEMENTAL_MASTERY).stat.Char(t.stat.ATK_FLAT).Values(.28,.35,.42,.49,.56).Stacks().Map((a,e)=>a*e.GetCharacter().Get(t.stat.ELEMENTAL_MASTERY)).Next().Build()})]}),ho=m.Factory({Name:"CalamityQueller",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_49,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"CalamityQueller1",MaxRank:5,MaxStacks:6,Conditions:["ON_FIELD","OFF_FIELD"],MaxConditions:1,OnApply:new r.Builder().stat.Char(...t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG)).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ATK_PERCENT).Values(.032,.04,.048,.056,.064).Stacks().Next().Where({effect:{conditions:["OFF_FIELD"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.032,.04,.048,.056,.064).Stacks().Next().Build()})]}),Lo=m.Factory({Name:"JadeSpear",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"JadeSpear1",MaxRank:5,MaxStacks:7,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.032,.039,.046,.053,.06).Stacks().Next().stat.Char(t.stat.ALL_DMG).Stacks([0,0,0,0,0,0,0,.12],[0,0,0,0,0,0,0,.15],[0,0,0,0,0,0,0,.18],[0,0,0,0,0,0,0,.21],[0,0,0,0,0,0,0,.24]).Build()})]}),No=m.Factory({Name:"VortexVanquisher",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ATK_PERCENT,Effects:[Qt("VortexVanquisher1")]}),fo=m.Factory({Name:"SkywardSpine",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"SkywardSpine1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.08,.1,.12,.14,.16).Next().instance.Basic({Name:"HIT_SkywardSpine",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.4,.55,.7,.85,1]}).Build()})]}),mo=m.Factory({Name:"MissiveWindspear",Type:t.weapon.POLEARM,Stars:4,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"MissiveWindspear1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.12,.15,.18,.21,.24).Next().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(48,60,72,84,96).Build()})]}),Mo=m.Factory({Name:"Moonpiercer",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"Moonpiercer1",ApplyOther:!0,MaxTargets:1,MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ATK_PERCENT).Values(.16,.2,.24,.28,.32).Build()})]}),Co=m.Factory({Name:"EngulfingLightning",Stars:5,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"EngulfingLightning1",MaxRank:5,Conditions:["CAST_BURST","NO_BURST"],MaxConditions:1,OnApply:new r.Builder().observe.Target(t.stat.ENERGY_RECHARGE).stat.Char(t.stat.ATK_PERCENT).Values(.28,.35,.42,.49,.56).Map((a,e,s)=>Z1(a,e.GetCharacter().Get(t.stat.ENERGY_RECHARGE),s.GetRank())).Next().Where({effect:{conditions:["CAST_BURST"]}}).stat.Char(t.stat.ENERGY_RECHARGE).Values(.3,.35,.4,.45,.5).Build()})]});function Z1(a,e,s){return Math.min(a*Math.max(0,e-1),tN[s-1])}var tN=[.8,.9,1,1.1,1.2],po=m.Factory({Name:"WavebreakerFin",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_45,Substat:t.stat.ATK_PERCENT,Effects:[Ya("WavebreakerFin1")]}),Go=m.Factory({Name:"KitainCrossSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"KitainCrossSpear1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_SKILL_DMG).Values(.06,.075,.09,.105,.12).Build()})]}),go=m.Factory({Name:"DragonspineSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.PHYSICAL_DMG,Effects:[xa("DragonspineSpear1","HIT_DragonspineSpear")]}),Ro=m.Factory({Name:"LithicSpear",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ATK_PERCENT,Effects:[pr("LithicSpear1")]}),Io=m.Factory({Name:"CrescentPike",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.PHYSICAL_DMG,Effects:[r.Factory({Name:"CrescentPike1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_CrescentPike",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.2,.25,.3,.35,.4]}).Build()})]}),Do=m.Factory({Name:"Halberd",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_40,Substat:t.stat.ATK_PERCENT,Effects:[r.Factory({Name:"Halberd1",MaxRank:5,OnApply:new r.Builder().instance.Basic({Name:"HIT_Halberd",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.6,2,2.4,2.8,3.2]}).Build()})]}),Oo=m.Factory({Name:"DragonsBane",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ELEMENTAL_MASTERY,Effects:[r.Factory({Name:"DragonsBane1",MaxRank:5,OnApply:new r.Builder().Where({enemy:{affected:[t.stat.HYDRO_DMG,t.stat.PYRO_DMG]}}).stat.Char(t.stat.ALL_DMG).Values(.2,.24,.28,.32,.36).Build()})]}),yo=m.Factory({Name:"SacrificialSword",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Ho=m.Factory({Name:"ElegyForTheEnd",Type:t.weapon.BOW,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"ElegyForTheEnd1",ApplySelf:!0,MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(60,75,90,105,120).Build()}),Va({Name:"ElegyForTheEnd2",OnApply:new r.Builder().stat.Char(t.stat.ELEMENTAL_MASTERY).Values(100,125,150,175,200).Next().stat.Char(t.stat.ATK_PERCENT).Values(.2,.25,.3,.35,.4).Build()})]}),vo=m.Factory({Name:"StaffOfHoma",Type:t.weapon.POLEARM,Stars:5,Scaling:o.WeaponScaling.TYPE_46,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"StaffOfHoma1",ApplySelf:!0,MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.HP_PERCENT).Values(.2,.25,.3,.35,.4).Next().observe.Target(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ATK_FLAT).Values(.008,.01,.012,.014,.016).Map((a,e)=>e.GetCharacter().Get(t.stat.HP)*a).Next().observe.Target(t.stat.HP_BASE,t.stat.HP_PERCENT,t.stat.HP_FLAT).stat.Char(t.stat.ATK_FLAT).Where({target:{hp:{leq:.5}}}).Values(.01,.012,.014,.016,.018).Map((a,e)=>e.GetCharacter().Get(t.stat.HP)*a).Build()})]}),Po=m.Factory({Name:"FavoniusLance",Type:t.weapon.POLEARM,Stars:4,Scaling:o.WeaponScaling.TYPE_44,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Bo=m.Factory({Name:"WhiteTassel",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_39,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"WhiteTassel1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG).Values(.24,.3,.36,.42,.48).Build()})]}),Ko=m.Factory({Name:"BlackTassel",Stars:3,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_38,Substat:t.stat.HP_PERCENT,Effects:[r.Factory({Name:"BlackTassel1",MaxRank:5,Conditions:["NO_SLIMES","SLIMES"],MaxConditions:1,OnApply:new r.Builder().Where({effect:{conditions:["SLIMES"]}}).stat.Char(t.stat.ALL_DMG).Values(.4,.5,.6,.7,.8).Build()})]}),bo=m.Factory({Name:"PrototypeStarglitter",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.ENERGY_RECHARGE,Effects:[r.Factory({Name:"PrototypeStarglitter1",MaxStacks:2,MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.NORMAL_ATTACK_DMG,t.stat.CHARGED_ATTACK_DMG).Values(.08,.1,.12,.14,.16).Stacks().Next().Build()})]}),wo=m.Factory({Name:"BlackcliffPole",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[qt("BlackcliffPole1")]}),Yo=m.Factory({Name:"Deathmatch",Stars:4,Type:t.weapon.POLEARM,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"Deathmatch1",MaxRank:5,MaxConditions:1,Conditions:["ENEMY_1","ENEMY_2"],OnApply:new r.Builder().Where({effect:{conditions:["ENEMY_2"]}}).stat.Char(t.stat.ATK_PERCENT,t.stat.DEF_PERCENT).Values(.16,.2,.24,.28,.32).Next().Where({effect:{conditions:["ENEMY_1"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.24,.3,.36,.42,.48).Build()})]}),Fo=m.Factory({Name:"SkywardBlade",Stars:5,Type:t.weapon.SWORD,Substat:t.stat.ENERGY_RECHARGE,Scaling:o.WeaponScaling.TYPE_46,Effects:[r.Factory({Name:"SkywardBlade1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.CRIT_RATE).Values(.04,.05,.06,.07,.08).Next().instance.Basic({Name:"HIT_SkywardBlade",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[.2,.25,.3,.35,.4]}).Build()})]}),Vo=m.Factory({Name:"SkywardHarp",Type:t.weapon.BOW,Stars:5,Scaling:o.WeaponScaling.TYPE_48,Substat:t.stat.CRIT_RATE,Effects:[r.Factory({Name:"SkywardHarp1",MaxRank:5,OnApply:new r.Builder().stat.Char(t.stat.CRIT_DMG).Values(.2,.25,.3,.35,.4).Next().instance.Basic({Name:"HIT_SkywardHarp",Element:t.stat.PHYSICAL_DMG,Stat:t.stat.ATK,Values:[1.25]}).Build()})]}),xo=m.Factory({Name:"FavoniusSword",Type:t.weapon.SWORD,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),ko=m.Factory({Name:"FavoniusWarbow",Type:t.weapon.BOW,Stars:4,Scaling:o.WeaponScaling.TYPE_41,Substat:t.stat.ENERGY_RECHARGE,Effects:[]}),Uo=m.Factory({Name:"TheWidsith",Stars:4,Type:t.weapon.CATALYST,Scaling:o.WeaponScaling.TYPE_42,Substat:t.stat.CRIT_DMG,Effects:[r.Factory({Name:"TheWidsith1",MaxRank:5,Conditions:["RECITATIVE","ARIA","INTERLUDE"],MaxConditions:1,OnApply:new r.Builder().Where({effect:{conditions:["RECITATIVE"]}}).stat.Char(t.stat.ATK_PERCENT).Values(.6,.75,.9,1.05,1.2).Next().Where({effect:{conditions:["ARIA"]}}).stat.Char(...t.Elements.filter(a=>a!==t.stat.PHYSICAL_DMG)).Values(.48,.6,.72,.84,.96).Next().Where({effect:{conditions:["INTERLUDE"]}}).stat.Char(t.stat.ELEMENTAL_MASTERY).Values(240,300,360,420,480).Build()})]}),Wo=Object.values(rr).sort((a,e)=>a.Type===e.Type?a.Stars===e.Stars?a.Name.localeCompare(e.Name):a.Stars-e.Stars:a.Type-e.Type),$t={};for(const a of Wo)$t[a.Type]||($t[a.Type]=[]),$t[a.Type].push(a);var ka=new W(a=>a.Name);ka.AddList(Wo);function jo(){return ka.Get()}function aN(a){return ka.Find(a)}function eN(a){return $t[a]||[]}var Xt={};R(Xt,{FindByName:()=>nN,GetList:()=>sN});var St=new W(a=>a.Name);for(const a of ir())a.Effects.forEach(e=>St.Add(e));for(const a of jo())a.Effects.forEach(e=>St.Add(e));for(const a of ri())a.Piece2.forEach(e=>St.Add(e)),a.Piece4.forEach(e=>St.Add(e));for(const a of Ws())St.Add(a);function sN(){return St.Get()}function nN(a){return St.Find(a)}var Ot={};R(Ot,{ArtifactStore:()=>lN,FilterArtifacts:()=>Ua,PartyFrom:()=>iN});function iN(a){const e=new d.Party;for(const s in a.characters){const n=At.FindByName(s);if(!n)throw new Error(`Character not found: ${s}`);const i=n();e.Add(i);const l=a.characters[s],E=Object.keys(l.weapon)[0];if(E){const _=nt.FindByName(E);if(!_)throw new Error(`Weapon not found: ${s}`);i.SetWeapon(_)}l.artifacts&&Object.keys(l.artifacts).length>0&&i.SetArtifacts(new _t.Artbox(i))}return d.ImportParty(a,e),e}function Ua(a,e,s){const n=e.map(i=>rN(i));return s&&n.push({filter(i){return!(s.pieces&&!s.pieces.includes(i.piece)||s.only&&s.only==="locked"!==!!i.locked)}}),Te.Filter({values:a,mode:"every",filters:n})}function rN(a){const e=a.pieces||t.piece.Values(),s=a.subsMode||"some";return{for(n){return e.includes(n.piece)},filter(n){if(a.main&&!a.main.includes(n.mainstat))return!1;if(a.subs){const i=n.substats.map(E=>E.stat);if(!a.subs[s](E=>i.includes(E)))return!1}return!(Number.isFinite(a.stars)&&n.stars<(a.stars||0)||Number.isFinite(a.level)&&n.level<(a.level||0))}}}var lN=class{constructor(a){this.onChange=a,this.list=[],this.filtered=[]}Update(){this.onChange()}All(){return this.list}Clear(){this.list.splice(0,this.list.length),this.filtered.splice(0,this.filtered.length),this.onChange()}Add(a,e="push"){const s=I.Export(a);this.list[e](s),this.filtered=[...this.list],this.onChange()}AddExported(a,e="push"){this.list[e](a),this.filtered=[...this.list],this.onChange()}Filter(a,e){const{values:s}=Ua(this.list,a,e);return this.filtered=s,s}Get(){return this.filtered}Replace(a,e){const s=this.list.indexOf(a);return s===-1?!1:(this.list.splice(s,1,e),this.onChange(),!0)}RemoveMultiple(a,e){const{indexes:s}=Ua(this.list,a,e),n=[];return this.list.forEach((i,l)=>{s.includes(l)||n.push(i)}),this.list=n,this.onChange(),n.length}Remove(a){const e=this.list.indexOf(a);return e===-1?!1:(this.list.splice(e,1),this.onChange(),!0)}};function Y(a){const e=a.endsWith("%");e&&(a=a.slice(0,a.length-1));let s=parseFloat(a);if(!Number.isFinite(s))throw new Error(`Invalid number format: "${a}"`);return e&&(s/=100),s}function ef(a){return a}var oN=()=>({show:{description:"Shows the rolls of the character artifacts",arguments:[],compile({Value:a,Log:e}){return function(){const i=a.GetChar().GetArtifacts();if(!i){e.Error("Current character has no artifacts");return}e.Log(`
`+i.GetArtifacts().map(l=>T.ArtifactRolls(l)).join(`
`))}}},tier:{description:"Sets the rolls tier to equip.`",example:"artifact rolls tier avg",arguments:["0 | 1 | 2 | 3 | avg = 4"],compile({Value:a,Log:e},[s]){let n,i;return s==="avg"?(n=4,i="AVERAGE"):(n=Math.max(0,Math.min(4,Math.floor(Y(s)))),i=n+""),function(){a.Config.substats.tier=n,e.Logf("Rolls tier set to %s",i)}}},equip:{description:"Equips the given rolls to the artifacts.Arguments in the form `[stat] [rolls] [stat] [rolls] ...`.",example:"artifact rolls equip crit_rate 10 crit_dmg 12 elemental_mastery 3",compile({Value:a,Log:e},s){const n=[];for(let i=0;i<s.length;i+=2){const l=s[i].toUpperCase(),E=t.stat.Get(l),_=t.stat.Name(E),A=s[i+1];if(!A)throw e.Throwf("Missing # of rolls for stat %s",_);const S=Math.max(0,Math.floor(Y(A)));n.push([E,S])}return function(){const l=a.GetChar().GetArtifacts();if(!l)throw e.Throw("Current character has no artifacts");l.EquipRolls({substats:n,tier:a.Config.substats.tier})?a.Config.substats.tier===4?e.Logf("Equipped rolls of tier %s","AVERAGE"):e.Logf("Equipped rolls of tier %d",a.Config.substats.tier):e.Error("Rolls could not be equipped")}}}}),cN=()=>({list:{description:"Lists the registered artifact sets",arguments:[],compile({Log:a}){const e=new T.Table(T.labels.SET,T.labels.STARS),s=Z.GetList();return s.forEach(n=>e.AddRow(n.Name,n.Stars)),function(){a.Logf("Total artifact sets: %d",s.length),a.Log(`
`+e.String())}}},add:{description:"Adds a build of 5 artifacts to the current character",arguments:[],compile({Value:a,Log:e}){return function(){const n=a.GetChar();n.GetArtifacts()?e.Warn("Artifacts not created. Character already has artifacts"):(n.SetArtifacts(new _t.Artbox(n)),e.Log("Artifacts created"))}}},fill:{description:"Adds 4 empty substats to all artifacts in the current character",arguments:[],compile({Value:a,Log:e}){return function(){const i=a.GetChar().GetArtifacts();i?(i.GetArtifacts().forEach(l=>l.FillSubstats()),e.Log("All artifacts filled")):e.Error("Character has no artifacts")}}},main:{description:"Sets the mainstats of the character artifacts.",example:"artifact main atk_percent pyro_dmg crit_rate",arguments:["sands","goblet","circlet"],compile({Value:a,Log:e},[s,n,i]){const l=t.stat.Get(s.toUpperCase()),E=t.stat.Get(n.toUpperCase()),_=t.stat.Get(i.toUpperCase());return function(){const u=a.GetChar().GetArtifacts();if(!u){e.Error("Current character has no artifacts");return}u.Get(2).SetMainstat(l),u.Get(3).SetMainstat(E),u.Get(4).SetMainstat(_);const h=u.GetArtifacts().map(L=>t.stat.Name(L.GetMainstat()));e.Logf("Artifact mainstats set to %s",h.join(", "))}}},level:{description:"Sets the level of all the artifacts of the current character.",example:"artifact level 20",arguments:["level"],compile({Value:a,Log:e},[s]){const n=Y(s);return function(){const E=a.GetChar().GetArtifacts();if(!E){e.Error("Current character has no artifacts");return}E.GetArtifacts().forEach(A=>A.SetLevel(n));const _=E.GetArtifacts().map(A=>A.GetLevel());e.Logf("Artifact levels set to %s",_.join(", "))}}},stars:{description:"Sets the stars of all the artifacts of the current character.",example:"artifact stars 5",arguments:["stars"],compile({Value:a,Log:e},[s]){const n=Y(s);return function(){const E=a.GetChar().GetArtifacts();if(!E){e.Error("Current character has no artifacts");return}E.GetArtifacts().forEach(A=>A.SetStars(n));const _=E.GetArtifacts().map(A=>A.GetStars());e.Logf("Artifact stars set to %s",_.join(", "))}}},remove:{description:"Removes all artifacts from the current character",arguments:[],compile({Value:a,Log:e}){return function(){a.GetChar().SetArtifacts(void 0),e.Log("Artifacts removed")}}},show:{description:"Shows the artifacts of the current character",arguments:[],compile({Value:a,Log:e}){return function(){const i=a.GetChar().GetArtifacts();if(!i){e.Error("Current character has no artifacts");return}e.Log(`
`+T.Artifact(...i.GetArtifacts()))}}},rolls:{description:"Control the artifact rolls in the current character",children:oN()},sets:{description:"Changes the artifact sets. Arguments in one of the following forms:\n- `artifact sets [name]`: 2-piece effect of the given set\n- `artifact sets [nameA] [nameB]`: 2-piece effect of the given sets, or the 4-piece effect if they're both the same.\n- `artifact sets [name] [# of pieces]`: the given set with 2-piece or 4-piece effects.\n\nrun without arguments to remove all the sets.",example:`artifact sets CrimsonWitchOfFlames 4 // 4-piece set
artifact sets CrimsonWitchOfFlames WanderersTroupe // 2 + 2 piece set`,compile({Value:a,Log:e},s){if(s.length===0)return function(){const A=a.GetChar().GetArtifacts();if(!A)throw e.Throw("Current character has no artifacts");A.GetArtifacts().forEach(S=>S.SetSet(void 0)),e.Log("Removed all artifact sets")};s.length===1&&s.push("2");let n,i;const l=Z.FindByName(s[0]);if(!l)throw e.Throwf("Set %s not found",s[0]);if(n=l.Name,s[1]==="2")i=void 0;else if(s[1]==="4")i=n;else{const E=Z.FindByName(s[1]);if(!E)throw e.Throwf("Set %s not found",s[1]);i=E.Name}return function(){const A=a.GetChar().GetArtifacts();if(!A)throw e.Throw("Current character has no artifacts");A.Get(0).SetSet(n),A.Get(1).SetSet(n),A.Get(2).SetSet(i),A.Get(3).SetSet(i),e.Logf("Artifact sets set to %s",A.GetActiveSets().join(", "))}}}}),EN=()=>{const a={};return t.piece.Values().forEach(e=>a[t.piece.Name(e).toLowerCase()]={description:"Controls the artifact "+t.piece.Name(e),children:TN(e)()}),a},TN=a=>()=>({main:{description:"Sets the mainstat of the "+t.piece.Name(a),example:t.piece.Name(a).toLowerCase()+" main "+t.stat.Name(t.PieceToMainstats(a)[0]),arguments:["mainstat"],compile({Value:e,Log:s},[n]){const i=t.stat.Get(n.toUpperCase());return function(){const _=e.GetChar().GetArtifacts();if(!_){s.Error("Current character has no artifacts");return}_.Get(a).SetMainstat(i),s.Logf("%s mainstat set to %s",t.piece.Name(a),_.Get(a).GetMainstat())}}},set:{description:"Sets the set name of the "+t.piece.Name(a),example:t.piece.Name(a).toLowerCase()+" set WanderersTroupe",arguments:["set"],compile({Value:e,Log:s},[n]){return function(){const E=e.GetChar().GetArtifacts();if(!E){s.Error("Current character has no artifacts");return}E.Get(a).SetSet(n),s.Logf("%s set changed to %s",t.piece.Name(a),E.Get(a).GetSet())}}},level:{description:"Sets the level of the "+t.piece.Name(a),example:t.piece.Name(a).toLowerCase()+" level 16",arguments:["level"],compile({Value:e,Log:s},[n]){const i=Y(n);return function(){const _=e.GetChar().GetArtifacts();if(!_){s.Error("Current character has no artifacts");return}_.Get(a).SetLevel(i),s.Logf("%s level set to %d",t.piece.Name(a),_.Get(a).GetLevel())}}},stars:{description:"Sets the stars of the "+t.piece.Name(a),example:t.piece.Name(a).toLowerCase()+" stars 4",arguments:["stars"],compile({Value:e,Log:s},[n]){const i=Y(n);return function(){const _=e.GetChar().GetArtifacts();if(!_){s.Error("Current character has no artifacts");return}_.Get(a).SetStars(i),s.Logf("%s stars set to %d",t.piece.Name(a),_.Get(a).GetStars())}}},show:{description:"Shows the "+t.piece.Name(a),arguments:[],compile({Value:e,Log:s}){return function(){const l=e.GetChar().GetArtifacts();if(!l){s.Error("Current character has no artifacts");return}s.Log(`
`+T.Artifact(l.Get(a)))}}},rolls:{description:"Shows the rolls of the "+t.piece.Name(a),arguments:[],compile({Value:e,Log:s}){return function(){const l=e.GetChar().GetArtifacts();if(!l){s.Error("Current character has no artifacts");return}const E=l.Get(a);s.Log(T.ArtifactRolls(E))}}},sub:{description:"Control the substats of the "+t.piece.Name(a),children:{clear:{description:"Set all substats to 0",arguments:[],compile({Value:e,Log:s}){return function(){const l=e.GetChar().GetArtifacts();if(!l){s.Error("Current character has no artifacts");return}l.Get(a).ClearSubstats(),s.Log("Substats cleared")}}},add:{description:"Adds a new substat to the artifact.",example:t.piece.Name(a).toLowerCase()+" sub add crit_rate 7.8%",arguments:["stat","value"],compile({Value:e,Log:s},[n,i]){const l=t.stat.Get(n.toUpperCase()),E=Y(i);return function(){const S=e.GetChar().GetArtifacts();if(!S){s.Error("Current character has no artifacts");return}S.Get(a).AddSubstat(l,E)?s.Log("Substat added"):s.Warn("Substat not added")}}},set:{description:"Changes a substat. Substat index starts from zero.",example:t.piece.Name(a).toLowerCase()+" sub set 2 crit_rate 7.8%",arguments:["index","stat","value"],compile({Value:e,Log:s},[n,i,l]){const E=Y(n),_=t.stat.Get(i.toUpperCase()),A=Y(l);return function(){const h=e.GetChar().GetArtifacts();if(!h){s.Error("Current character has no artifacts");return}const L=h.Get(a);if(E>=L.SubstatsLength()){s.Errorf("Substat index out of range [0-%d]",L.SubstatsLength()-1);return}L.SetSubstat(E,_),L.SetSubstatValue(E,A),s.Logf("Substat %d changed",E)}}}}},downgrade:{description:"Converts a 5-star artifact to a 4-star artifact, reducing the value of substats.",arguments:[],compile({Value:e,Log:s}){return function(){const l=e.GetChar().GetArtifacts();if(!l){s.Error("Current character has no artifacts");return}const E=l.Get(a);I.transform.Downgrade(E),s.Log("Artifact downgraded")}}}}),_N=()=>({list:{description:"Lists the stats of the current character",arguments:[],compile({Value:a,Log:e}){return function(){const n=a.GetChar().GetCharacter(),i=new T.Table(T.labels.STAT,T.labels.VALUE);i.DecimalPlaces=4;for(const l of t.stat.Values())i.AddRow(t.stat.Name(l),n.Get(l));e.Log(`
`+i.String())}}},get:{description:"Gets the value of stats in the current character",example:"character stat get crit_rate crit_dmg",compile({Value:a,Log:e},s){const n=s.map(i=>t.stat.Get(i.toUpperCase()));return function(){const l=a.GetChar().GetCharacter(),E=new T.Table(T.labels.STAT,T.labels.VALUE);E.DecimalPlaces=4;for(const _ of n)E.AddRow(t.stat.Name(_),l.Get(_));e.Log(`
`+E.String())}}},set:{description:"Sets the value of a stat in the current character",example:"character stat set atk_percent 45%",arguments:["stat","value"],compile({Value:a,Log:e},[s,n]){const i=t.stat.Get(s.toUpperCase()),l=Y(n);return function(){const _=a.GetChar(),A=_.GetCharacter();if(i===t.stat.HP_CURRENT||i===t.stat.ENERGY_CURRENT)A.Set(i,l);else{const S=A.Get(i);_.AddModifier(A.CreateModifier(i,l-S))}e.Logf("Character stat %s set to %.4f",t.stat.Name(i),l)}}},add:{description:"Adds to the value of a stat in the current character",example:"character stat add atk_percent 10%",arguments:["stat","value"],compile({Value:a,Log:e},[s,n]){const i=t.stat.Get(s.toUpperCase()),l=Y(n);return function(){const _=a.GetChar(),A=_.GetCharacter();_.AddModifier(A.CreateModifier(i,l)),e.Logf("Modified %s + %.4f = %.4f",t.stat.Name(i),l,A.Get(i))}}},mods:{description:"Lists the stats added to the character with `stat add [...]`",arguments:[],compile({Value:a,Log:e}){return function(){const n=a.GetChar(),i=new T.Table(T.labels.STAT,T.labels.VALUE);i.DecimalPlaces=4,n.GetModifiers().forEach(l=>i.AddRow(t.stat.Name(l.GetProp()),l.GetValue())),e.Log(`
`+i.String())}}},clear:{description:"Removes the stat modifiers created by `stat add [...]`",arguments:[],compile({Value:a,Log:e}){return function(){a.GetChar().ClearModifiers(),e.Log("Cleared modifiers")}}}}),AN=()=>({add:{description:"Adds a new character.",example:"character add hutao",arguments:["name"],compile(a,[e]){const{Value:s,Log:n}=a,i=At.FindByName(e);if(!i)throw n.Throwf("Character not found: %s",e);return function(){if(s.Party.FindMember(e)){n.Errorf("Cannot add character %s because it is already added",i.Name);return}const _=i();s.Party.Add(_),n.Logf("Character %s added to the party",_.GetCharacter().Options.Name),a.Compile(["character","set",i.Name],{line:n.Line})()}}},remove:{description:"Removes a character from the party",example:"character remove Hutao",arguments:["name"],compile(a,[e]){const{Value:s,Log:n}=a;return function(){const l=s.Party.FindMember(e);if(!l){n.Errorf("Cannot remove character %s because it is not added",e);return}s.Party.Remove(l)?(l.GetEffects().forEach(E=>E.Disable().UnapplyAll()),s.GetChar()===l&&a.Compile(["character","unset"],{line:n.Line})(),n.Logf("Character %s removed",l.GetCharacter().Options.Name)):n.Logf("Cannot remove character %s",l.GetCharacter().Options.Name)}}},set:{description:"Sets the current character",example:"character set Hutao",arguments:["name"],compile({Value:a,Log:e},[s]){return function(){const i=a.Party.FindMember(s);if(!i){e.Errorf("Cannot set character %s because it is not added",s);return}a.SetChar(i),e.Logf("Character %s set as current",i.GetCharacter().Options.Name)}}},unset:{description:"Unsets the current character",arguments:[],compile({Value:a,Log:e}){return function(){a.SetChar(void 0),e.Log("Character unset. There is no current character selected")}}},level:{description:"Sets the level of the current character",example:`character level 70
character level 80+ // level 80 ascended`,arguments:["level"],compile({Value:a,Log:e},[s]){let n=s;const i=s.endsWith("+");i&&(n=s.slice(0,n.length-1));const l=Y(n),E=i?6:0;return function(){const A=a.GetChar().GetCharacter();A.SetLevel(l),A.SetAscension(E),e.Logf("Character level set to %d%s",A.GetLevel(),A.IsAscended()?"+":"")}}},talent:{description:"Sets the talent levels of the current character",example:"character talent 9 5 7",arguments:["normal","skill","burst"],compile({Value:a,Log:e},s){const[n,i,l]=s.map(E=>Y(E));return function(){const _=a.GetChar().GetCharacter();_.Set(t.stat.NORMAL_ATTACK_LEVEL,n),_.Set(t.stat.ELEMENTAL_SKILL_LEVEL,i),_.Set(t.stat.ELEMENTAL_BURST_LEVEL,l),e.Logf("Character Normal Attack level set to %d",n),e.Logf("Character Elemental Skill level set to %d",i),e.Logf("Character Elemental Burst level set to %d",l)}}},list:{description:"Lists all the registered characters",arguments:[],compile({Log:a}){const e=new T.Table(T.labels.CHARACTER,T.labels.ELEMENT,T.labels.WEAPON,T.labels.STARS,T.labels.REGION),s=At.GetList();s.forEach(i=>e.AddRow(i.Name,t.stat.Name(i.Element),t.weapon.Name(i.Weapon),i.Stars,t.region.Name(i.Region)));const n=e.String();return function(){a.Logf("Total characters: %d",s.length),a.Log(`
`+n)}}},show:{description:"Shows the characters in the party",arguments:[],compile({Value:a,Log:e}){return function(){e.Log(`
`+T.Character(...a.Party.GetMembers()))}}},damage:{description:"Shows the current character's damage instances",arguments:[],compile({Value:a,Log:e}){return function(){const n=a.GetChar();e.Log(`
`+T.Instance(...n.GetInstances()))}}},stat:{description:"Controls character stats directly",children:_N()}}),SN=()=>({all:{description:"List all effects in the party",arguments:[],compile({Value:a,Log:e}){return function(){e.Log(`
`+T.Effect(...a.Party.GetAllEffects()))}}},list:{description:"Lists the effects of the current character",arguments:[],compile({Value:a,Log:e}){return function(){const i=[...a.GetChar().GetEffects(),...a.Party.GetResonances()];e.Log(`
`+T.Effect(...i))}}},applied:{description:"Lists all the effects in the party that are applied to the current character.",arguments:[],compile({Value:a,Log:e}){return function(){const n=a.GetChar(),i=a.Party.GetAppliedEffects(n);e.Log(`
`+T.Effect(...i))}}},set:{description:"Sets the current effect",example:"effect set RaidenE",arguments:["name"],compile({Value:a,Log:e},[s]){return function(){let l=a.GetChar().FindEffect(s);if(l||(l=a.Party.GetResonances().find(E=>E.Options.Name.toLowerCase()===s.toLowerCase())),!l){e.Errorf("Cannot find effect %s",s);return}a.SetEffect(l),e.Logf("Effect set to %s",l.Options.Name)}}},unset:{description:"Unsets the current effect",arguments:[],compile({Value:a,Log:e}){return function(){a.SetEffect(void 0),e.Log("Current effect unset")}}},show:{description:"Shows details about the current effect",arguments:[],compile({Value:a,Log:e}){return function(){const n=a.GetEffect();e.Log(`
`+T.EffectDetail(n))}}},enable:{description:"Enables the current effect",arguments:[],compile({Value:a,Log:e}){return function(){const n=a.GetEffect();n.Enable(),e.Logf("Effect %s enabled",n.Options.Name)}}},disable:{description:"Disables the current effect",arguments:[],compile({Value:a,Log:e}){return function(){const n=a.GetEffect();n.Disable(),e.Logf("Effect %s disabled",n.Options.Name)}}},apply:{description:"Applies the current effect to the given characters, or all",example:`effect apply HuTao
effect apply HuTao Xingqiu
effect apply all`,compile({Value:a,Log:e},s){return function(){const i=a.GetEffect();if(s[0]==="all"){for(const l of a.Party.GetMembers())i.Apply(l);e.Logf("Effect %s applied to all members",i.Options.Name);return}for(const l of s){const E=a.Party.FindMember(l);if(!E){e.Errorf("Cannot find target %s",l);return}i.Apply(E)?e.Logf("Effect %s applied to target %s",i.Options.Name,E.GetCharacter().Options.Name):e.Warnf("Effect %s NOT applied to target %s",i.Options.Name,E.GetCharacter().Options.Name)}}}},unapply:{description:"Unapplies the current effect from the given characters, or all",example:`effect apply HuTao
effect unapply HuTao Xingqiu
effect unapply all`,compile({Value:a,Log:e},s){return function(){const i=a.GetEffect();if(s[0]==="all"){for(const l of a.Party.GetMembers())i.Unapply(l);e.Logf("Effect %s unapplied from all members",i.Options.Name);return}for(const l of s){const E=a.Party.FindMember(l);if(!E){e.Errorf("Cannot find target %s",l);return}i.Unapply(E)?e.Logf("Effect %s unapplied from target %s",i.Options.Name,E.GetCharacter().Options.Name):e.Warnf("Effect %s NOT unapplied from target %s",i.Options.Name,E.GetCharacter().Options.Name)}}}},lock:{description:`Locks the effect to prevent being modified by character stat changes.

This will disable all the effect observers for the provided character.

Note that enabling the effect again will re-activate all the observers again.`,example:`effect set HuTaoE
effect enable
effect lock HuTao
character level 1
// this code will lock the HP to ATK conversion of Hu Tao to prevent it from changing`,arguments:["character"],compile({Value:a,Log:e},[s]){return function(){const i=a.GetEffect(),l=a.Party.FindMember(s);if(!l){e.Errorf("Cannot find character %s in the party",s);return}i.Lock(l),e.Logf("Effect %s locked for character %s. Note that enabling the effect again will re-activate all the observers again.",i.Options.Name,l.GetCharacter().Options.Name)}}},stacks:{description:"Sets the current effect's stacks",example:"effect stacks 9",arguments:["stacks"],compile({Value:a,Log:e},[s]){const n=Y(s);return function(){const l=a.GetEffect();l.SetStacks(n),e.Logf("Effect stacks set to %f",l.GetStacks())}}},condition:{description:"Sets the current effect's condition (s)",example:`effect condition near
effect condition far
effect condition // this removes all conditions`,compile({Value:a,Log:e},s){return function(){const i=a.GetEffect();i.SetConditions(...s);const l=i.GetConditions();e.Logf("Effect conditions set to ["+"%s".repeat(l.length)+"]",...l)}}},aura:{description:"Sets the current effect's applied aura (s), or all",example:`effect aura frozen
effect aura hydro electro
effect aura // this removes all auras
effect aura all // this applies all auras`,compile({Value:a,Log:e},s){return function(){const i=a.GetEffect(),l=s.length>0&&s[0].match(/all/i)?t.aura.Values().filter(_=>_!==t.aura.NONE):s.map(_=>t.aura.Get(_.toUpperCase()));i.SetAuras(...l);const E=i.GetAuras().map(_=>t.aura.Name(_));e.Logf("Effect auras set to ["+"%s".repeat(E.length)+"]",...E)}}},details:{description:"Shows the registered modifiers of the current effect",arguments:[],compile({Value:a,Log:e}){return function(){const n=a.GetEffect();e.Log(`
`+n.Register())}}}}),uN=()=>({show:{description:"Shows all the enemies",arguments:[],compile({Value:a,Log:e}){return function(){const i=a.Party.GetMembers().map(l=>l.GetCharacter().GetEnemy());e.Logf(`
`+T.Enemy(...i))}}},level:{description:"Sets the level of all enemies",example:"enemy level 100",arguments:["level"],compile({Value:a,Log:e},[s]){const n=Y(s);return function(){a.Party.GetMembers().forEach(l=>l.GetCharacter().GetEnemy().SetLevel(n)),e.Logf("All enemy levels changed to %d",n)}}},aura:{description:"Sets enemies applied aura (s), or all",example:`enemy aura frozen
enemy aura hydro electro
enemy aura // this removes all auras
enemy aura all // this applies all auras`,compile({Value:a,Log:e},s){const n=s.length>0&&s[0].match(/all/i)?t.aura.Values().filter(i=>i!==t.aura.NONE):s.map(i=>t.aura.Get(i.toUpperCase()));return function(){a.Party.GetMembers().forEach(l=>l.GetCharacter().GetEnemy().SetAuras(...n)),e.Logf("All enemy auras changed to %s",n.map(l=>t.aura.Name(l)).join(", "))}}}}),hN="https://enka.network";function zo(a){return pt(this,null,function*(){try{return yield(yield fetch(hN+"/api/uid/"+a)).json()}catch(e){console.error("[ENKA ERROR]",e)}})}var LN={EQUIP_BRACER:t.piece.FLOWER,EQUIP_NECKLACE:t.piece.PLUME,EQUIP_SHOES:t.piece.SANDS,EQUIP_RING:t.piece.GOBLET,EQUIP_DRESS:t.piece.CIRCLET},NN={20848859:"BlackcliffSlasher",37147251:"SolarPearl",160493219:"DarkIronSword",197755235:"VortexVanquisher",231836963:"PrimordialJadeCutter",310247243:"KagurasVerity",313300315:"SapwoodBlade",342097547:"CinnabarSpindle",346510395:"LuxuriousSeaLord",411685275:"CompoundBow",452357939:"Moonpiercer",479076483:"CoolSteel",481755219:"BlackcliffPole",540938627:"Predator",578575283:"CrescentPike",618786571:"Halberd",623534363:"FavoniusCodex",650049651:"WindblumeOde",656120259:"SharpshootersOath",680510411:"Whiteblind",688991243:"CalamityQueller",693354267:"MemoryOfDust",716252627:"LithicSpear",735056795:"FavoniusGreatsword",807607555:"SkywardAtlas",828711395:"AmosBow",850802171:"WhiteIronGreatsword",877751435:"RoyalGreatsword",902184579:"ForestRegalia",902264035:"AquilaFavonia",930640955:"TheBell",944332883:"SummitShaper",1012170803:"KagotsurubeIsshin",1021898539:"Slingshot",1072884907:"MappaMare",1075647299:"SongOfBrokenPines",1089950259:"SkywardPride",1154009435:"PrototypeStarglitter",1163263227:"TheWidsith",1148024603:"TheCatch",1240067179:"FavoniusWarbow",1321135667:"LionsRoar",1348687251:"HuntersPath",1388004931:"SkyriderSword",1390797107:"WhiteTassel",1406746947:"OtherworldlyStory",1437658243:"SerpentSpine",1455107995:"LostPrayer",1470442731:"MissiveWindspear",1479961579:"FerrousShadow",1600275315:"HaranGeppakuFutsu",1608953539:"HarbingerOfDawn",1675686363:"SacrificialGreatsword",1773425155:"SwordOfDescension",1860795787:"MouunsMoon",1890163363:"EverlastingMoonglow",1901973075:"PolarStar",1990641987:"SacrificialSword",1990820123:"AmenomaKageuchi",1991707099:"PrototypeRancour",1997709467:"JadeSpear",2006422931:"LithicBlade",2195665683:"SacrificialFragments",2267978875:"FruitofFulfillment",2279290283:"MagicGuide",2324146259:"HakushinRing",2359799475:"Akuoumaru",2375993851:"RoyalLongsword",2400012995:"SacrificalBow",2417717595:"AlleyHunter",2425414923:"FadingTwilight",2474354867:"FavoniusSword",2491797315:"KitainCrossSpear",2521338131:"PrototypeAmber",2539208459:"OathswornEye",2556914683:"TheStringless",2587614459:"Frostbearer",2614170427:"SkyriderGreatsword",2664629131:"DragonsBane",2749853923:"FesteringDesire",2753539619:"SnowTombedStarsilver",2792766467:"TheUnforged",2832648187:"RoyalBow",2918525947:"ThunderingPulse",2935286715:"RoyalSpear",2947140987:"TheAlleyFlash",2949448555:"FreedomSworn",2963220587:"EmeraldOrb",3063191787:"EndOfTheLine",3073454867:"MakhairaAquamarine",3090373787:"WineAndSong",3097441915:"DebateClub",3112679155:"ElegyForTheEnd",3156385731:"EyeOfPerception",3169209451:"Rust",3176599083:"KingsSquire",3235324891:"StaffOfHoma",3273999011:"BlackcliffAgate",3378007475:"BlackcliffLongsword",3421967235:"FilletBlade",3439749859:"TheViridescentHunt",3443142923:"DragonspineSpear",3447737235:"BlackcliffWarbow",3456986819:"DodocoTales",3500935003:"ThrillingTalesOfDragonSlayers",3587621259:"TheFlute",3625393819:"PrototypeCrescent",3673792067:"TravelersHandySword",3684723963:"Rainslasher",3717849275:"EngulfingLightning",3719372715:"TwinNephrite",3722933411:"PrototypeArchaic",3755004051:"FavoniusLance",3796905611:"TheBlackSword",3827789435:"RoyalGrimoire",3914951691:"RedhornStonethresher",3933622347:"SkywardHarp",3949653579:"MitternachtsWaltz",3975746731:"RavenBow",3995710363:"WolfsGravestone",4049410651:"Deathmatch",4055003299:"SkywardBlade",4090429643:"BloodtaintedGreatsword",4103022435:"IronSting",4103766499:"BlackTassel",4122509083:"WavebreakersFin",4124851547:"MistsplitterReforged",4158505619:"SkywardSpine",4186179883:"Hamayumi",4193089947:"KatsuragikiriNagamasa",4230231107:"AquaSimulacra",4238339131:"StaffOfTheScarletSands",4267718859:"RecurveBow"},fN={83115355:"MaidenBeloved",147298547:"WanderersTroupe",156294403:"HeartOfDepth",855894507:"Berserker",862591315:"PaleFlame",933076627:"BlizzardStrayer",1186209435:"Gambler",1212345779:"GladiatorsFinale",1337666507:"TenacityOfTheMillelith",1438974835:"RetracingBolide",1524173875:"CrimsonWitchOfFlames",1541919827:"BloodstainedChivalry",1558036915:"VermillionHereafter",1562601179:"ViridescentVenerer",1632377563:"Lavawalker",1675079283:"DeepwoodMemories",1751039235:"NoblesseOblige",1756609915:"OceanHuedClam",1873342283:"Thundersoother",2040573235:"ArchaicPetra",2276480763:"EmblemOfSeveredFate",2364208851:"ResolutionOfSojourner",2512309395:"ThunderingFury",2546254811:"HuskOfOpulentDreams",2764598579:"TheExile",2890909531:"MartialArtist",3535784755:"BraveHeart",3618167299:"Scholar",3626268211:"EchoesOfAnOffering",3890292467:"Instructor",4082302819:"DefendersWill",4144069251:"ShimenawasReminiscence",4145306051:"GildedDreams",3094139291:"FlowerOfParadiseLost",2538235187:"DesertPavilionChronicle"},qo={FIGHT_PROP_BASE_ATTACK:t.stat.ATK_BASE,FIGHT_PROP_HP:t.stat.HP_FLAT,FIGHT_PROP_ATTACK:t.stat.ATK_FLAT,FIGHT_PROP_DEFENSE:t.stat.DEF_FLAT,FIGHT_PROP_HP_PERCENT:t.stat.HP_PERCENT,FIGHT_PROP_ATTACK_PERCENT:t.stat.ATK_PERCENT,FIGHT_PROP_DEFENSE_PERCENT:t.stat.DEF_PERCENT,FIGHT_PROP_CRITICAL:t.stat.CRIT_RATE,FIGHT_PROP_CRITICAL_HURT:t.stat.CRIT_DMG,FIGHT_PROP_CHARGE_EFFICIENCY:t.stat.ENERGY_RECHARGE,FIGHT_PROP_HEAL_ADD:t.stat.HEALING_BONUS,FIGHT_PROP_ELEMENT_MASTERY:t.stat.ELEMENTAL_MASTERY,FIGHT_PROP_PHYSICAL_ADD_HURT:t.stat.PHYSICAL_DMG,FIGHT_PROP_FIRE_ADD_HURT:t.stat.PYRO_DMG,FIGHT_PROP_ELEC_ADD_HURT:t.stat.ELECTRO_DMG,FIGHT_PROP_WATER_ADD_HURT:t.stat.HYDRO_DMG,FIGHT_PROP_WIND_ADD_HURT:t.stat.ANEMO_DMG,FIGHT_PROP_ICE_ADD_HURT:t.stat.CRYO_DMG,FIGHT_PROP_ROCK_ADD_HURT:t.stat.GEO_DMG,FIGHT_PROP_GRASS_ADD_HURT:t.stat.DENDRO_DMG},mN={10000002:"Ayaka",10000003:"Jean",10000006:"Lisa",10000014:"Barbara",10000015:"Kaeya",10000016:"Diluc",10000020:"Razor",10000021:"Amber",10000022:"Venti",10000023:"Xiangling",10000024:"Beidou",10000025:"Xingqiu",10000026:"Xiao",10000027:"Ningguang",10000029:"Klee",10000030:"Zhongli",10000031:"Fischl",10000032:"Bennett",10000033:"Tartaglia",10000034:"Noelle",10000035:"Qiqi",10000036:"Chongyun",10000037:"Ganyu",10000038:"Albedo",10000039:"Diona",10000041:"Mona",10000042:"Keqing",10000043:"Sucrose",10000044:"Xinyan",10000045:"Rosaria",10000046:"HuTao",10000047:"Kazuha",10000048:"Yanfei",10000049:"Yoimiya",10000050:"Thoma",10000051:"Eula",10000052:"Raiden",10000053:"Sayu",10000054:"Kokomi",10000055:"Gorou",10000056:"Sara",10000057:"Itto",10000058:"Yae",10000059:"Heizou",10000060:"Yelan",10000062:"Aloy",10000063:"Shenhe",10000064:"YunJin",10000065:"Kuki",10000066:"Ayato",10000067:"Collei",10000068:"Dori",10000069:"Tighnari",10000070:"Nilou",10000071:"Cyno",10000079:"Dehya",10000072:"Candace",10000073:"Nahida",10000074:"Layla",10000075:"Wanderer",10000076:"Faruzan",10000078:"Alhaitham",10000080:"Mika"};function Qo(a){const e=[];for(const s of a.avatarInfoList){const n=mN[s.avatarId];if(!n){console.error(`[ENKA ERROR] Cannot find character by avatarId ${s.avatarId}`);continue}const i=At.FindByName(n);if(!i){console.error(`[ENKA ERROR] Cannot find character by name ${n}`);continue}const l=parseInt(s.propMap[4001].val)||1,E=parseInt(s.propMap[1002].val)||1,_=Object.values(s.skillLevelMap),A=i(),S=new _t.Artbox(A);A.SetArtifacts(S);const u=A.GetCharacter();u.SetLevel(l),u.SetAscension(E),u.Set(t.stat.NORMAL_ATTACK_LEVEL,_[0]),u.Set(t.stat.ELEMENTAL_SKILL_LEVEL,_[1]),u.Set(t.stat.ELEMENTAL_BURST_LEVEL,_[2]);const h=s.equipList.filter(N=>N.flat.itemType==="ITEM_RELIQUARY"),L=s.equipList.filter(N=>N.flat.itemType==="ITEM_WEAPON");for(const N of h){const{reliquary:f,flat:M}=N;if(!f)continue;const{level:p}=f;if(!M.equipType){console.error("Cannot get artifact piece");continue}const C=LN[M.equipType];if(M.rankLevel<4){console.error("[ENKA ERROR] Cannot set 3-star artifacts");continue}const G=S.Get(C);if(G.SetStars(M.rankLevel),G.SetLevel(p-1),!M.reliquaryMainstat){console.error("[ENKA ERROR] Cannot get artifact mainstat");continue}G.SetMainstat(qo[M.reliquaryMainstat.mainPropId]);const g=M.reliquarySubstats;if(!g){console.error("[ENKA ERROR] Cannot get artifact substats");continue}for(const D of g){const H=qo[D.appendPropId];let v=D.statValue;t.FlatStats.includes(H)||(v/=100),G.AddSubstat(H,v)}const O=N.flat.setNameTextMapHash;if(O){const D=fN[O];G.SetSet(D)}}S.GetArtifacts().forEach(N=>N.FillSubstats());for(const N of L){const f=NN[N.flat.nameTextMapHash];if(!f){console.error("[ENKA ERROR] Cannot find weapon by key "+N.flat.nameTextMapHash);continue}const M=nt.FindByName(f);if(!M){console.error("[ENKA ERROR] Cannot find weapon by name "+f);continue}A.SetWeapon(M);const p=A.GetWeapon();if(!p){console.error("[ENKA ERROR] Cannot equip weapon by name "+M.Name);continue}if(!N.weapon)continue;const{level:C,promoteLevel:G,affixMap:g}=N.weapon;p.SetLevel(C),p.SetAscension(G);const O=Object.values(g).reduce((D,H)=>Math.max(D,H),0)+1;p.SetRank(O)}e.push(A)}return e}function $o(a){return pt(this,null,function*(){const e=yield zo(a);if(!e)throw new Error("[ENKA ERROR] Cannot fetch data from Enka.Network");return Qo(e)})}var MN=()=>{let a=[];return{uid:{description:"Imports characters from a player UID using Enka.Network service",example:"enka uid 609609619",arguments:["UID"],compile({Log:e},[s]){return function(){e.Log("Importing from Enka.Network service. Please wait..."),$o(s).then(i=>{a=i;const l=new T.Table(T.labels.CHARACTER,T.labels.LEVEL);for(const E of a){const _=E.GetCharacter();l.AddRow(_.Options.Name,_.GetLevel())}e.Log(`
Imported characters:
`+l.String()),e.Logf("Imported %d characters from Enka.Network",i.length),e.Log("Run `enka load <characters...>` to load an imported character to the current party")}).catch(i=>e.Error(String(i).valueOf()))}}},load:{description:"Loads characters imported from Enka.Network to the current party",example:"enka load hutao xingqiu yelan zhongli",compile(e,s){const{Value:n,Log:i}=e;return function(){const E=[];for(const _ of s){const A=a.find(S=>S.GetCharacter().Options.Name.toLowerCase()===_);if(!A){i.Errorf('Character "%s" not found in Enka',_);continue}n.Party.Add(A),E.push(A)}i.Logf("Added %d characters to the party",E.length),E.length>0&&e.Compile(["character","set",E[0].GetCharacter().Options.Name],{line:i.Line})()}}}}},CN=()=>({list:{description:"Lists all the registered foods",arguments:[],compile({Log:a}){const e=It.GetList(),s=T.Food(...e);return function(){a.Log(`
`+s)}}},add:{description:"Adds a food to the party. Rank is the food quality (1 = suspicious, 2 = normal, 3 = delicious)",arguments:["name","rank"],example:"food add adeptustemptation 3",compile({Value:a,Log:e},[s,n]){const i=It.FindByName(s),l=Math.floor(Y(n));if(!i)throw e.Throwf("Cannot find food %s",s);return function(){a.Party.GetFoods().Add(i).SetRank(l),e.Logf("Food %s added",i.Name)}}},remove:{description:"Removes a food from the party",arguments:["name"],example:"food remove adeptustemptation",compile({Value:a,Log:e},[s]){return function(){a.Party.GetFoods().Remove(s),e.Logf("Food %s removed",s)}}},show:{description:"Shows the currently added foods",arguments:[],compile({Value:a,Log:e}){return function(){const n=a.Party.GetFoods().GetAll();e.Log(`
`+T.Food(...n))}}},clear:{description:"Clears all the foods from the party",arguments:[],compile({Value:a,Log:e}){return function(){a.Party.GetFoods().Clear(),e.Log("Cleared all foods")}}}}),pN=()=>({clear:{description:"Clears all the rotation actions",arguments:[],compile({Value:a,Log:e}){return function(){a.Rotation.Clear(),e.Log("Rotation cleared")}}},run:{description:"Runs the rotation",arguments:[],compile({Value:a,Log:e}){return function(){e.Warn("Running rotation..."),a.Rotation.SetCharacters(...a.Party.GetMembers());const n=a.Rotation.Run();e.Logf("Rotation damage: %d",n)}}},log:{description:"Controls rotation logs",children:{enable:{description:"Enables the rotation logs",arguments:[],compile({Value:a,Log:e}){return function(){a.Rotation.Log=e,e.Log("Rotation log enabled")}}},disable:{description:"Disables the rotation logs",arguments:[],compile({Value:a,Log:e}){return function(){a.Rotation.Log=void 0,e.Log("Rotation log disabled")}}}}},summary:{description:"Prints a summary of the last rotation run",arguments:[],compile({Value:a,Log:e}){return function(){e.Log(`
`+T.Rotation(a.Rotation.GetSummary()))}}},hit:{description:'Adds a hit to the rotation. Arguments in the form:\n	`rotation hit [character_name] [hit_name] [extra...]`.\n\nWhere `[extra...]` can be one or more of the following:\n	- a multiplier in the form `*3`, `*0.5`, etc.\n	- `aura=x` to set the aura uptime, where `0 <= x <= 1`.\n	- `reaction=x` to set the reaction uptime, where `0 <= x <= aura`.\n\nIf no values provided for `aura` or `reaction`, they will be set to 1 by default.\n\nIf `reaction` is greater than `aura`, it will be set to the value of `aura`.\n\nDO NOT include the prefix "hit_" for the hit name, it will be automatically added.',example:`rotation hit Hutao Charged *9 // 9 charged attacks from Hu Tao
rotation hit Hutao N1 aura=90% reaction=40% // hutao normal attack 1 with 90% aura and 40% reaction uptime`,arguments:["charname","hitname","extra..."],compile({Value:a,Log:e},[s,n,...i]){n="HIT_"+n;let l=1,E=1,_=1;return i.forEach(A=>{const S=A.match(GN);if(S){const h=Y(S[1]);l*=h;return}const u=A.match(dN);if(u){const h=u[1].toLowerCase(),L=Y(u[2]);h==="aura"?E=L:h==="reaction"&&(_=L)}}),function(){a.Rotation.AddHit(s,n,l,_,E,e.Line),e.Logf("Added hit %s (%s) to rotation with multiplier=%.2f, aura=%.2f, reaction=%.2f",n,s,l,_,E)}}},do:{description:"Saves a command to be executed as a rotation action.",example:"rotation do effect stacks 9",compile(a,e){const{Value:s,Log:n}=a,i=a.Compile(e,{line:n.Line});return function(){s.Rotation.AddFn(i,n.Line),n.Logf("Added action to rotation: `%s`",e.join(" "))}}},duration:{description:"Sets the rotation duration, in seconds.",example:"rotation duration 22 // 22 seconds",compile({Value:a,Log:e},[s]){const n=Y(s);return function(){a.Rotation.Duration=n,e.Logf("Rotation duration set to %.2f seconds.",n)}}}}),GN=/^\*([0-9]+(?:\.[0-9]+)?%?)$/i,dN=/^(reaction|aura)=([0-9]+(?:\.[0-9]+)?%?)$/i,Xo=()=>({substats:{tier:4}}),gN=class{constructor(){this.Party=new d.Party,this.Rotation=new jt.Rotation,this.Config=Xo()}Reset(){this.Party=new d.Party,this.Rotation=new jt.Rotation,this.Character=void 0,this.Effect=void 0,this.Config=Xo(),this.State=void 0}GetEffect(){if(!this.Effect)throw new Error("Effect not set");return this.Effect}SetEffect(a){this.Effect=a}GetChar(){if(!this.Character)throw new Error("Character not set");return this.Character}SetChar(a){if(a&&!this.Party.GetMembers().includes(a))throw new Error("Cannot set scenario character: character not in party");this.Character=a}},RN=()=>({save:{description:"Saves the current party state.",arguments:[],compile({Value:a,Log:e}){return function(){a.State=d.ExportParty(a.Party),e.Log("State saved")}}},load:{description:"Loads a previously saved party state.",arguments:[],compile(a){const{Value:e,Log:s}=a;return function(){if(!e.State){s.Error("No state saved");return}e.Party=Ot.PartyFrom(e.State);const i=e.Party.GetMembers()[0],l=i?i.GetCharacter().Options.Name:void 0;a.Compile(["character","unset"],{line:s.Line})(),a.Compile(["effect","unset"],{line:s.Line})(),l&&a.Compile(["character","set",l],{line:s.Line})(),s.Log("Party loaded from saved state")}}},clear:{description:"Removes the saved state",arguments:[],compile({Value:a,Log:e}){return function(){a.State=void 0,e.Log("State cleared")}}},b64:{description:"Exports/imports party state as base64 strings",children:{export:{description:"Exports party state as a base64 string.",arguments:[],compile({Value:a,Log:e}){return function(){if(!a.State){e.Error("No state saved");return}const n=btoa(JSON.stringify(a.State));e.Log(n)}}},import:{description:"Imports party state from a base64 string.",arguments:["base64-string"],compile(a,[e]){const{Value:s,Log:n}=a,i=JSON.parse(atob(e));return function(){s.State=i,a.Compile(["state","load"],{line:n.Line})()}}}}}}),IN=()=>({list:{description:"List all registered weapons",arguments:[],compile({Log:a}){const e=At.Bennett(),s=nt.GetList(),n=new T.Table(T.labels.NAME,T.labels.WEAPON,t.stat.Name(t.stat.ATK_BASE),T.labels.STAT,T.labels.VALUE,T.labels.STARS);for(const l of s){const E=l(e);E.SetLevel(90),n.AddRow(l.Name,t.weapon.Name(l.Type),E.GetAtkBase(),t.stat.Name(E.GetSubstat()),E.GetSubstatValue(),l.Stars)}n.DecimalPlaces=4;const i=n.String();return function(){a.Logf("Total weapons: %d",s.length),a.Log(`
`+i)}}},set:{description:"Sets the weapon of the current character",example:"weapon set StaffOfHoma",arguments:["name"],compile({Value:a,Log:e},[s]){const n=nt.FindByName(s);if(!n)throw e.Throwf("Cannot find weapon %s",s);return function(){a.GetChar().SetWeapon(n),e.Logf("Weapon set to %s",n.Name)}}},level:{description:"Sets the level of the current character's weapon",example:`weapon level 70
weapon level 80+ //level 80 ascended`,arguments:["level"],compile({Value:a,Log:e},[s]){let n=s;const i=s.endsWith("+");i&&(n=s.slice(0,n.length-1));const l=Y(n),E=i?6:0;return function(){const A=a.GetChar().GetWeapon();if(!A){e.Error("Character weapon is not set");return}A.SetLevel(l),A.SetAscension(E),A.SetAscension(0),e.Logf("Weapon level set to %d%s",A.GetLevel(),A.IsAscended()?"+":"")}}},rank:{description:"Sets the rank of the current character's weapon",example:"weapon rank 5",arguments:["rank"],compile({Value:a,Log:e},[s]){const n=Y(s);return function(){const l=a.GetChar().GetWeapon();if(!l){e.Error("Character weapon is not set");return}l.SetRank(n),e.Logf("Weapon rank set to %d",l.GetRank())}}},remove:{description:"Removes the character weapon",arguments:[],compile({Value:a,Log:e}){return function(){a.GetChar().SetWeapon(void 0),e.Log("Weapon removed")}}}}),Wa=class{constructor(){this.Scenario=new gN,this.Program=new vs(this.Scenario),this.Program.Set(et(z({character:{description:"Controls characters in the party",children:AN()},weapon:{description:"Controls weapons in the party",children:IN()},effect:{description:"Controls effects in the party",children:SN()},artifact:{description:"Controls all the artifacts",children:cN()}},EN()),{enemy:{description:"Controls all enemies in the party.",children:uN()},food:{description:"Controls food buffs",children:CN()},rotation:{description:"Controls the rotation",children:pN()},reset:{description:"Resets the scenario to its initial state",arguments:[],compile({Value:a,Log:e}){return function(){a.Reset(),e.Warnf("Command `reset` executed.")}}},state:{description:"Functions to save/load the party state",children:RN()},enka:{description:"Imports characters from Enka.Network service",children:MN()}}))}},Jo={};R(Jo,{BackendWorker:()=>xN,Generate:()=>tc,Optimizer:()=>UN,RotationDamage:()=>kN,SetGenerator:()=>yN,VirtualWorker:()=>Zo});var DN=0,Zo=class{constructor(a){this.poster=a,this.listenersByPath=new Map,this.pathsByListener=new Map,this.errorListeners=[]}SetPoster(a){this.poster=a}SetKiller(a){this.killer=a}Kill(){if(!this.killer)throw new Error("No killer function is defined for this worker");this.killer()}Post(a,e){const s=(++DN).toString(36);return this.poster(a,s,e),s}Recieve(a,e,s){return pt(this,null,function*(){const n=this.listenersByPath.get(a);if(!n){console.error("WORKER PATH NOT FOUND: ",a);return}for(const i of[...n])yield i(e,s)})}Error(a){return pt(this,null,function*(){for(const e of[...this.errorListeners])yield e(a)})}AddErrorListener(a){if(this.errorListeners.includes(a))throw new Error("Cannot add the same listener twice");return this.errorListeners.push(a),a}RemoveErrorListener(a){const e=this.errorListeners.indexOf(a);return e===-1?!1:(this.errorListeners.splice(e,1),!0)}AddListener(a,e){if(this.pathsByListener.has(e))throw new Error("Cannot add the same listener twice");this.pathsByListener.set(e,a);let s=this.listenersByPath.get(a);return s||(s=[],this.listenersByPath.set(a,s)),s.push(e),e}RemoveListener(a){const e=this.pathsByListener.get(a);if(!e)return!1;const s=this.listenersByPath.get(e);if(!s)return!1;const n=s.indexOf(a);return n===-1?!1:(s.splice(n,1),!0)}};function*ON(a,e){let s=[];for(const n of e)s.push(n),s.length>=a&&(yield s,s=[]);s.length>0&&(yield s)}var ja=void 0;function yN(a){ja=a}function tc(){if(!ja)throw new Error("No backend worker generator is defined");return ja()}var za=class{constructor(a){this.actions=a,this.listeners=[]}Post(a,e){const s=this.worker;if(!s)throw new Error("Worker not set for this action");s.Post(a,e)}SetWorker(a){this.worker&&this.RemoveWorker();for(const e in this.actions){const s=this.actions[e];a.AddListener(e,s),this.listeners.push(s)}this.worker=a}RemoveWorker(){if(!!this.worker)for(const a of this.listeners)this.worker.RemoveListener(a)}},qa=class{constructor(){this.worker=tc()}Kill(){this.worker.Kill()}},ac={};R(ac,{Filter:()=>Qa});function Qa(a,...e){return e.every(s=>HN(a,s))}function HN(a,e){const s=a.Get(e.stat);return e.operator==="<="?s<=e.value:s>=e.value}var ut=class{constructor(){this.total=0}SetConfig(a){this.config=a}SetTarget(a){this.target=a}SetParty(a){this.party=a}SetRotation(a){this.rotation=a}Init(a){this.config=a,this.runner=new Wa;const e=this.runner.Scenario;a.Party&&(e.Party=Ot.PartyFrom(a.Party),this.party=e.Party),a.Cmd&&(this.runner.Program.CompileString(a.Cmd)(),this.rotation=e.Rotation,this.rotation.Log=void 0),a.Target&&(this.runner.Program.Compile(["character","set",a.Target])(),this.target=e.Character),this.init(a)}setTotal(a){this.total=a}GetTotal(){return this.total}GetConfig(){if(!this.config)throw new Error("Configuration not set for this optimizer. Try to run `.Init()` first");return this.config}GetParty(){if(!this.party)throw new Error("Party not set for this optimizer. Try to run `.Init()` first");return this.party}GetTarget(){if(!this.target)throw new Error("Target character not set for this optimizer. Try to run `.Init()` first");return this.target}GetRotation(){if(!this.rotation)throw new Error("Rotation not set for this optimizer. Try to run `.Init()` first");return this.rotation}GetRunner(){if(!this.runner)throw new Error("Runner not set for this optimizer. Try to run `.Init()` first");return this.runner}Run(){if(!this.rotation)throw new Error("Rotation not set for this optimizer. Try to run `.Init()` first");const a=d.ExportParty(this.GetParty());this.rotation.SetCharacters(...this.GetParty().GetMembers());const e=this.rotation.Run();return d.ImportParty(a,this.GetParty()),e}Optimize(){for(const a of this.Generate())this.Insert(this.Evaluate(a));return this.Get()}getConstants(){const a={};return this.target&&(a.target_name=this.target.GetCharacter().Options.Name,a.target_element=t.stat.Name(this.target.GetCharacter().Options.Element),a.target_element_aura=t.aura.Name(t.DmgToAura(this.target.GetCharacter().Options.Element))),this.party&&this.party.GetMembers().forEach((s,n)=>{const i=s.GetCharacter(),l="member_"+n;a[l+"_name"]=i.Options.Name,a[l+"_element"]=t.stat.Name(i.Options.Element),a[l+"_element_aura"]=t.aura.Name(t.DmgToAura(i.Options.Element))}),a}},ec=5,Jt=class extends ut{constructor(){super(...arguments),this.queue=new lt,this.initDamage=0}init(a){if(a.substats.length>ec)throw new Error(`Cannot optimize more than ${ec} substats at once. Requested ${a.substats.length} substats instead`);const e=this.GetTarget(),s=(()=>{const E=e.GetArtifacts();if(!E){const _=new _t.Artbox(e);return e.SetArtifacts(_),_}return E})();this.initDamage=this.Run();for(const E of s.GetArtifacts())E.SetStars(5),E.ClearSubstats();const n=a.substats.map(({stat:E})=>E),i=a.substats.map(({min:E})=>E),l=a.substats.map(({max:E})=>E);this.modifiers=n.map(E=>e.GetCharacter().CreateModifier(E,0)),this.generator=an(n.length,a.total,i,l)}*Generate(){if(!this.generator)throw new Error("No generator has been initialized");yield*this.generator}Evaluate(a){const{tier:e,filter:s}=this.GetConfig(),n=this.GetTarget();if(!this.modifiers)throw new Error("Optimizer initialized incorrectly (no modifiers created)");const i=this.modifiers;a.forEach((A,S)=>i[S].SetValue(A*o.GetSubstatValue(5,i[S].GetProp(),e)));const l=[];i.forEach(A=>{const S=A.GetProp();l.push(n.GetCharacter().Get(S))});const E=[n.GetCharacter().Get(t.stat.ATK),n.GetCharacter().Get(t.stat.DEF),n.GetCharacter().Get(t.stat.HP)];if(s&&!Qa(n.GetCharacter(),...s))return{rolls:a,stats:l,damage:-1,relative:0,basic:E};const _=this.Run();return{rolls:a,stats:l,damage:_,relative:_/this.initDamage,basic:E}}Insert(a){a.damage>=0&&this.queue.Push(a,a.damage)}Get(){return this.queue.Extract()}Format(a){const e=this.GetConfig(),s=e.substats.map(({stat:i})=>t.stat.Name(i)),n=new F(t.stat.Name(t.stat.ATK),t.stat.Name(t.stat.DEF),t.stat.Name(t.stat.HP),...s,T.labels.DAMAGE,T.labels.RELATIVE);for(const i of a){const l=[];i.stats.forEach((_,A)=>{const u=t.FlatStats.includes(e.substats[A].stat)?b(_,0):b(_*100,2)+"%";l.push(u+` (${i.rolls[A]})`)});const E=i.basic.map(_=>b(_,0));n.AddRow(...E,...l,b(i.damage,0),b(i.relative*100,2)+"%")}return n}EquipCmd(a){const e=this.GetConfig();let s=`artifact add
artifact fill
artifact stars 5
artifact rolls tier `+e.tier+`
`;return s+="artifact rolls equip "+a.rolls.map((n,i)=>({rolls:n,stat:e.substats[i].stat})).reduce((n,i)=>n+t.stat.Name(i.stat)+" "+i.rolls+" ",""),s}},sc={};R(sc,{SubstatsOptimizer:()=>Jt,defaultConfig:()=>vN});var vN=()=>({total:25,tier:o.SubstatTier.ROLL_AVG,substats:[{stat:t.stat.CRIT_RATE,min:0,max:10},{stat:t.stat.CRIT_DMG,min:0,max:12},{stat:t.stat.ATK_PERCENT,min:0,max:12},{stat:t.stat.ELEMENTAL_MASTERY,min:0,max:12}]}),nc={[t.piece.FLOWER]:t.PieceToMainstats(t.piece.FLOWER),[t.piece.PLUME]:t.PieceToMainstats(t.piece.PLUME),[t.piece.SANDS]:t.PieceToMainstats(t.piece.SANDS),[t.piece.GOBLET]:t.PieceToMainstats(t.piece.GOBLET),[t.piece.CIRCLET]:t.PieceToMainstats(t.piece.CIRCLET)},ic=class extends ut{constructor(){super(...arguments),this.results=new lt,this.initDamage=0,this.allStats=nc}init(a){if(a.mainstats)for(const n of t.piece.Values()){let i=a.mainstats[n];!i||(i=i.filter(l=>nc[n].includes(l)),i.length!==0&&(this.allStats[n]=i))}const e=Object.values(this.allStats).map(n=>n.length).reduce((n,i)=>n*i,1);this.setTotal(e);const s=this.GetTarget();this.state=d.Export(s),this.initDamage=this.Run(),a.substats&&(this.subsOptimizer=new Jt,this.subsOptimizer.SetParty(this.GetParty()),this.subsOptimizer.SetTarget(this.GetTarget()),this.subsOptimizer.SetRotation(this.GetRotation()),this.subsOptimizer.Init(z({},a.substats)),this.subsCombinations=Array.from(this.subsOptimizer.Generate()),this.state=d.Export(s))}*Generate(){for(const a of this.allStats[t.piece.FLOWER])for(const e of this.allStats[t.piece.PLUME])for(const s of this.allStats[t.piece.SANDS])for(const n of this.allStats[t.piece.GOBLET])for(const i of this.allStats[t.piece.CIRCLET])yield[a,e,s,n,i]}Evaluate(a){const e=this.GetTarget(),s=e.GetArtifacts();if(!s)throw new Error("Target character has no artifacts to be optimized");for(let i=0;i<a.length;i++)s.Get(i).SetMainstat(a[i]);const n={damage:-1,mainstats:a,relative:0};if(this.subsOptimizer&&this.subsCombinations){const i=this.subsOptimizer;this.subsCombinations.forEach(_=>i.Insert(i.Evaluate(_)));const E=i.Get()[0];E&&(n.damage=E.damage,n.substats=E)}else n.damage=this.Run();return n.relative=n.damage/this.initDamage,this.state&&d.Import(this.state,e),n}Insert(a){a.damage>=0&&this.results.Push(a,a.damage)}Get(){return this.results.Extract()}Format(a){const e=this.GetConfig(),s=[t.piece.Name(t.piece.SANDS),t.piece.Name(t.piece.GOBLET),t.piece.Name(t.piece.CIRCLET)];if(e.substats){s.push(t.stat.Name(t.stat.ATK),t.stat.Name(t.stat.DEF),t.stat.Name(t.stat.HP));const i=e.substats.substats.map(l=>t.stat.Name(l.stat));s.push(...i)}s.push(T.labels.DAMAGE,T.labels.RELATIVE);const n=new F(...s);for(const i of a){const l=i.mainstats.slice(2).map(E=>t.stat.Name(E));if(e.substats&&i.substats){const E=e.substats,_=i.substats,A=[];_.stats.forEach((u,h)=>{const N=t.FlatStats.includes(E.substats[h].stat)?b(u,0):b(u*100,2)+"%";A.push(N+` (${_.rolls[h]})`)});const S=_.basic.map(u=>b(u,0));l.push(...S,...A)}l.push(b(i.damage,0),b(i.relative*100,2)+"%"),n.AddRow(...l)}return n}EquipCmd(a){const e=this.GetConfig();let s=`artifact add
artifact fill
`;for(const n of[t.piece.SANDS,t.piece.GOBLET,t.piece.CIRCLET]){const i=t.piece.Name(n).toLowerCase(),l=t.stat.Name(a.mainstats[n]);s+=i+" main "+l+`
`}if(a.substats&&e.substats){const n=new Jt;n.SetConfig(e.substats),s+=n.EquipCmd(a.substats)}return s}},$a=Array.from(new Set([...t.Substats,...t.Elements,t.stat.HEALING_BONUS]).values()),rc=class extends ut{constructor(){super(...arguments),this.modifiers={},this.queue=new lt}init(){const a=this.GetTarget();$a.forEach(e=>this.modifiers[e]=a.GetCharacter().CreateModifier(e,0)),this.setTotal($a.length)}*Generate(){for(const a of $a)yield a}Evaluate(a){const e=this.GetConfig(),s=o.GetSubstatValue(5,a,e.tier);if(!this.modifiers)throw new Error("No modifiers has been initialized. Try to run `.Init()` first.");const n=this.modifiers[a];n.SetValue(0);const i=this.Run();n.SetValue(s);const l=this.Run();return n.SetValue(0),{stat:a,damage:l,benefit:l/i-1}}Insert(a){this.queue.Push(a,a.benefit)}Get(){return this.queue.Extract()}Format(a){const e=this.GetConfig(),s=new T.Table(T.labels.STAT,T.labels.VALUE,T.labels.DAMAGE,T.labels.BENEFIT);for(const{stat:n,damage:i,benefit:l}of a){const E=t.FlatStats.includes(n)?b(o.GetSubstatValue(5,n,e.tier),0):b(o.GetSubstatValue(5,n,e.tier)*100,2);s.AddRow(t.stat.Name(n),E,b(i,2),b(l*100,4)+"%")}return s}};function*Xa(...a){a.length===0&&(yield[]);function*e(s,n){for(const i of a[s]){const l=[...n,i];s===a.length-1?yield l:yield*e(s+1,l)}}yield*e(0,[])}function lc(a,e){const s=a.map(l=>{const E=e==null?void 0:e.get(l.Name.toLowerCase());if(E)return[E];{const _=[...l.Conditions||[""]],A=new Set([0]);return A.add(l.MaxStacks||0),A.add(Math.floor((l.MaxStacks||0)/2)),Array.from(Xa(_,Array.from(A))).map(([u,h])=>["effect condition "+u+`
effect stacks `+h])}});s.length===0&&s.push([]);const n=Array.from(Xa(...s)),i=[];for(const l of n){const E={};l.forEach((_,A)=>{E[a[A].Name]=_}),i.push(E)}return i}var Zt=Z.GetList(),oc=class extends ut{constructor(){super(...arguments),this.cases=new Map,this.combinations=[],this.constants={},this.initDamage=0,this.queue=new lt}init(a){this.Combinate(a),this.setTotal(this.combinations.length),this.constants=this.getConstants(),this.initDamage=this.Run();const s=this.GetTarget().GetArtifacts();if(!s)throw new Error("Target character has no artifacts to be optimized");this.initState=s.GetArtifacts().map(n=>I.Export(n))}Combinate(a){a.ConfigCmd&&(this.cases=Vt(a.ConfigCmd)),this.combinations=[];for(let e=0;e<Zt.length;e++)for(let s=e;s<Zt.length;s++){const n=[Zt[e],Zt[s]].sort((i,l)=>i.Stars-l.Stars);this.combinations.push(...this.createRows(n[0],n[1]))}}createRows(a,e){const s=(()=>a===e?[...a.Piece2,...a.Piece4]:[...a.Piece2,...e.Piece2])(),n=lc(s,this.cases),i=[];for(const l of n){const E={sets:[a.Name,e.Name],cmds:l};i.push(E)}return i}*Generate(){for(const a of this.combinations)yield a}Evaluate(a){const e=this.GetRunner(),n=this.GetTarget().GetArtifacts();if(!n)throw new Error("Target character has no artifacts to be optimized");const[i,l]=a.sets,E=Z.FindByName(i),_=Z.FindByName(l);n.Get(0).SetSet(i),n.Get(1).SetSet(i),n.Get(2).SetSet(l),n.Get(3).SetSet(l);const A=new Set;E&&E.Stars===4&&(A.add(0),A.add(1)),_&&_.Stars===4&&(A.add(2),A.add(3));for(const h of A)I.transform.Downgrade(n.Get(h));const S={sets:[i,l],states:[],damage:0,relative:0};for(const h of n.GetEffects()){const L=h.Options.Name;e.Scenario.Effect=h;const N=a.cmds[L];if(!N)continue;let f="";for(const M of N){const p=e.Program.CompileString(M,{constants:this.constants});p(),f+=p.String()+`
`}S.states.push({state:r.Export(h),cmd:"effect set "+L+`
`+f,effect:L})}const u=this.Run();if(S.damage=u,S.relative=u/this.initDamage,this.initState&&A.size>0){const h=this.initState;n.GetArtifacts().forEach((L,N)=>I.Import(h[N],L))}return S}Insert(a){this.queue.Push(a,a.damage)}Get(){return this.queue.Extract()}Format(a){const e=new T.Table(T.labels.SET,T.labels.SET,T.labels.STACKS,T.labels.CONDITION,T.labels.DAMAGE,T.labels.RELATIVE);for(const s of a){let[n,i]=s.sets;n===i?(n+=" (2)",i+=" (4)"):(n+=" (2)",i+=" (2)");const l=s.states.map(({state:_,effect:A})=>{const S=Xt.FindByName(A);return S&&(S.MaxStacks||0)>0?_.stacks+"":""}).filter(_=>!!_).join(", "),E=s.states.map(({state:_})=>[..._.conditions]).reduce((_,A)=>(A.forEach(S=>_.push(S)),_),[]).filter(_=>!!_).join(", ");e.AddRow(n,i,l,E,s.damage,b(s.relative*100,2)+"%")}return e}EquipCmd(a){let e=`artifact add
artifact sets `+a.sets.join(" ")+`
`;const[s,n]=a.sets,i=Z.FindByName(s),l=Z.FindByName(n),E=new Set;i&&i.Stars===4&&(E.add("flower"),E.add("plume")),l&&l.Stars===4&&(E.add("sands"),E.add("goblet"));for(const _ of E)e+=_+` downgrade
`;for(const{cmd:_}of a.states)e+=_+`

`;return e+="effect unset",e}},cc=class extends ut{constructor(){super(...arguments),this.cases=new Map,this.combinations=[],this.constants={},this.initDamage=0,this.queue=new lt}init(a){this.Combinate(a),this.setTotal(this.combinations.length),this.constants=this.getConstants(),this.initDamage=this.Run()}Combinate(a){var e;a.ConfigCmd&&(this.cases=Vt(a.ConfigCmd));const s=(()=>a.All?nt.GetList():nt.GetByType(this.GetTarget().GetCharacter().Options.Weapon||0))();this.combinations=[];for(const n of s){const i=((e=a.Ranks)==null?void 0:e[n.Stars])||[1];if(n.Effects.length===0){for(const E of i)this.combinations.push({weapon:n.Name,cmds:{},cmd:`weapon level 90
weapon rank `+E});continue}const l=lc(n.Effects,this.cases);for(const E of l)for(const _ of i){const A={weapon:n.Name,cmds:E,cmd:`weapon level 90
weapon rank `+_};this.combinations.push(A)}}}*Generate(){for(const a of this.combinations)yield a}Evaluate(a){var e;const s=this.GetRunner(),n=this.GetTarget();s.Scenario.Character=n,(e=n.GetWeapon())==null||e.Unequip();const i=nt.FindByName(a.weapon);if(!i)throw new Error("Cannot find weapon: "+a.weapon);n.SetWeapon(i);const l=n.GetWeapon();if(!l)throw new Error("Cannot equip the weapon: "+a.weapon);const E=s.Program.CompileString(a.cmd,{constants:this.constants});E();const _={weapon:l.Options.Name,states:[],damage:0,relative:0,cmd:E.String(),rank:l.GetRank()};for(const S of l.GetEffects()){const u=S.Options.Name;s.Scenario.Effect=S;const h=a.cmds[u];if(!h)continue;let L="";for(const N of h){const f=s.Program.CompileString(N,{constants:this.constants});f(),L+=f.String()+`
`}_.states.push({state:r.Export(S),cmd:"effect set "+u+`
`+L,effect:u})}const A=this.Run();return _.damage=A,_.relative=A/this.initDamage,_}Insert(a){this.queue.Push(a,a.damage)}Get(){return this.queue.Extract()}Format(a){const e=new F(T.labels.WEAPON,T.labels.STACKS,T.labels.CONDITION,T.labels.DAMAGE,T.labels.RELATIVE);for(const s of a){const n=s.states.map(({state:l,effect:E})=>{const _=Xt.FindByName(E);return _&&(_.MaxStacks||0)>0?l.stacks+"":""}).filter(l=>!!l).join(", "),i=s.states.map(({state:l})=>[...l.conditions]).reduce((l,E)=>(E.forEach(_=>l.push(_)),l),[]).filter(l=>!!l).join(", ");e.AddRow(s.weapon+` (R${s.rank})`,n,i,s.damage,b(s.relative*100,2)+"%")}return e}EquipCmd(a){let e="weapon set "+a.weapon+`
`+a.cmd+`
`;for(const{cmd:s}of a.states)e+=s+`

`;return e+="effect unset",e}};function PN(a,e){if(a.allowSetNumber){const s=a.allowSetNumber;if(e.length===0&&!s.includes(0)||!e.map(([,i])=>i).some(i=>s.includes(i)))return!1}if(a.allowOnly){const s=a.allowOnly.map(i=>i.toLowerCase());if(!e.map(i=>i[0].toLowerCase()).every(i=>s.includes(i)))return!1}return!0}var BN=[...t.Mainstats,...t.Substats],Ec=class extends ut{constructor(){super(...arguments),this.compiled=new Map,this.groups=[],this.mods=new Map,this.initDamage=0,this.initSets=[],this.queue=new lt(5),this.prevSets="",this.equipCmd=""}init(a){var e,s;a.artifacts=[...a.artifacts];const n=this.GetRunner().Program,i=Vt(a.ConfigCmd||"");for(const[E,_]of i){const A="effect set "+E+`
`+_.join(`
`)+`
effect unset`,S=n.CompileString(A,{constants:this.getConstants()});this.compiled.set(E,S)}for(const E of t.piece.Values())this.groups[E]=[];if(a.artifacts.forEach((E,_)=>this.groups[E.piece].push([_,E])),this.target){this.initDamage=this.Run();let E=(e=this.target.GetArtifacts())==null?void 0:e.GetArtifacts();E||(this.target.SetArtifacts(new _t.Artbox(this.target)),E=(s=this.target.GetArtifacts())==null?void 0:s.GetArtifacts());const _=[];E&&E.forEach(A=>{this.groups[A.GetPiece()].length>0&&A.Disable(),_[A.GetPiece()]=A.GetSet()}),this.initSets=_;for(const A of BN)this.mods.set(A,this.target.GetCharacter().CreateModifier(A,0))}for(const E of t.piece.Values())this.groups[E].length||this.groups[E].push([-1,void 0]);let l=1;for(const E of Object.values(this.groups))E.sort((_,A)=>{var S,u;return(((S=_[1])==null?void 0:S.set)||"").localeCompare(((u=A[1])==null?void 0:u.set)||"")}),l*=E.length;this.setTotal(l)}*Generate(){for(let a=0;a<this.groups[t.piece.FLOWER].length;a++)for(let e=0;e<this.groups[t.piece.PLUME].length;e++)for(let s=0;s<this.groups[t.piece.SANDS].length;s++)for(let n=0;n<this.groups[t.piece.GOBLET].length;n++)for(let i=0;i<this.groups[t.piece.CIRCLET].length;i++)yield this.Combinate([a,e,s,n,i])}Combinate(a){const e=this.GetConfig(),s=t.piece.Values().map(S=>this.groups[S][a[S]]),n=s.map(([,S])=>S),i=s.map(([S])=>S),l=[...this.initSets];for(const S of n)!S||(l[S.piece]=S.set);const[E,_]=li(l);if(!PN(e,E))return;const A=[];for(const S of n){if(!S)continue;const u=S,h=o.GetMainstatValue(u.stars,u.mainstat,u.level),L=A.find(N=>N.stat===u.mainstat);L?L.value+=h:A.push({stat:u.mainstat,value:h});for(const{stat:N,value:f}of u.substats){const M=A.find(p=>p.stat===N);M?M.value+=f:A.push({stat:N,value:f})}}return{indexes:i,sets:_,stats:A}}configSets(a,e){const s=e.join(";");if(s!==this.prevSets){this.equipCmd="",a.Get(0).SetSet(e[0]),a.Get(1).SetSet(e[0]),a.Get(2).SetSet(e[1]),a.Get(3).SetSet(e[1]),a.Get(4).SetSet(void 0);for(const n of a.GetEffects()){const i=this.compiled.get(n.Options.Name.toLowerCase());i&&(i(),this.equipCmd+=i.toString()+`
`)}this.prevSets=s}}Evaluate(a){if(!a)return;const e=this.GetTarget(),s=e.GetArtifacts(),{filter:n}=this.GetConfig();if(!s)throw new Error("Target has no artifacts to be optimized. Try to run `.Init()` first");for(const{stat:E,value:_}of a.stats){const A=this.mods.get(E);if(!A)throw new Error("Modifier not initialized for stat "+E+". Try to run `.Init()` first");A.SetValue(_)}if(this.configSets(s,a.sets),n&&!Qa(e.GetCharacter(),...n))return;const i=this.Run(),l=i/this.initDamage;for(const{stat:E}of a.stats){const _=this.mods.get(E);if(!_)throw new Error("Modifier not initialized for stat "+E+". Try to run `.Init()` first");_.SetValue(0)}return{indexes:a.indexes,sets:a.sets,cmd:this.equipCmd,damage:i,relative:l}}Insert(a){a&&a.damage>0&&this.queue.Push(a,a.damage)}Get(){return this.queue.Extract()}Format(){throw new Error("Method not implemented.")}GetArtifacts({indexes:a}){const{artifacts:e}=this.GetConfig();return a.filter(s=>s>=0).map(s=>e[s])}},Tc={};R(Tc,{FoodOptimizer:()=>_c});var _c=class extends ut{constructor(){super(...arguments),this.initDamage=0,this.queue=new lt,this.groups=[]}init(){this.initDamage=this.Run();for(const a of[Mt.FoodType.OFFENSIVE,Mt.FoodType.ELEMENTAL,Mt.FoodType.DEFENSIVE]){const e=It.GetByType(a);this.groups.push(e.map(s=>s.Name))}this.setTotal(this.groups.reduce((a,e)=>a*e.length,1))}Generate(){return Xa(...this.groups)}Evaluate(a){const e=this.GetRunner(),s=a.map(i=>"food add "+i+" 3").join(`
`);e.Program.CompileString(s)();const n=this.Run();return{foods:a,cmd:s,damage:n,relative:n/this.initDamage}}Insert(a){this.queue.Push(a,a.damage)}Get(){return this.queue.Extract()}Format(a){const e=new F("FOOD_TYPE_0","FOOD_TYPE_3","FOOD_TYPE_1","DAMAGE","RELATIVE");for(const s of a)e.AddRow(...s.foods,b(s.damage,0),b(s.relative*100,2)+"%");return e}},Ac={SubstatsOptimizer:Jt,MainstatOptimizer:ic,NextRollOptimizer:rc,SetOptimizer:oc,WeaponOptimizer:cc,ArtifactsOptimizer:Ec,FoodOptimizer:_c};function sf(a){return a}var KN=class extends qa{Init(a){return new Promise((e,s)=>{const n=this.worker.Post("backend:optimizer/run/child/init",a),i=this.worker.AddListener("frontend:optimizer/run/child/init",(E,{id:_})=>{_===n&&(e(),this.worker.RemoveListener(i))}),l=this.worker.AddErrorListener(E=>{this.worker.RemoveErrorListener(l),s(E)})})}Send(a){return new Promise((e,s)=>{const n=this.worker.Post("backend:optimizer/run/child/run",a),i=this.worker.AddListener("frontend:optimizer/run/child/run",(E,{id:_,result:A})=>{_===n&&(e(A),this.worker.RemoveListener(i))}),l=this.worker.AddErrorListener(E=>{this.worker.RemoveErrorListener(l),s(E)})})}},bN=class extends za{constructor(){super({["backend:optimizer/run"]:(a,e)=>this.Run(a,e)})}Run(a,e){return pt(this,null,function*(){w.Global.SaveLogs=!1,w.Global.Out=()=>{};const s=new Ac[e.tool];s.Init(e.config);const n=s.GetTotal();this.Post("frontend:optimizer/run",{id:"progress:"+a,result:[],progress:0,total:n});const i=e.chunk;console.log(`[WORKER] Spawning ${e.children} child workers`);const l=wN(e.children);yield Promise.all(l.map(S=>S.Init(et(z({},e),{rows:[]}))));const E=ON(i*l.length,s.Generate());let _=0;for(const S of E){const h=(yield Promise.all(l.map((L,N)=>{const f=S.slice(N*i,(N+1)*i);return L.Send(et(z({},e),{rows:f}))}))).reduce((L,N)=>(N.forEach(f=>L.push(f)),L),[]);for(const L of h)s.Insert(L);_+=S.length,this.Post("frontend:optimizer/run",{id:"progress:"+a,result:[],progress:_,total:n})}const A=s.Get();l.forEach(S=>S.Kill()),this.Post("frontend:optimizer/run",{id:a,result:A})})}};function wN(a){return Array.from(Array(a)).fill(0).map(()=>new KN)}var YN=class extends za{constructor(){super({["backend:optimizer/run/child/init"]:(a,e)=>this.Init(a,e),["backend:optimizer/run/child/run"]:(a,e)=>this.Run(a,e)})}Init(a,e){w.Global.SaveLogs=!1,w.Global.Out=()=>{},(this.optimizer=new Ac[e.tool]).Init(e.config),console.log("[CHILD WORKER] Child worker initialized"),this.Post("frontend:optimizer/run/child/init",{id:a})}Run(a,e){if(!this.optimizer)throw new Error("[CHILD WORKER] Optimizer not set in the child worker");for(const n of e.rows)this.optimizer.Insert(this.optimizer.Evaluate(n));const s=this.optimizer.Get();this.Post("frontend:optimizer/run/child/run",{id:a,result:s})}},FN=class extends za{constructor(){super({["backend:rotation-damage/run"]:(a,e)=>this.Run(a,e)})}Run(a,e){const s=new Wa;w.Global.Out=()=>{};const n=Ot.PartyFrom(e.party);s.Scenario.Party=n;try{s.Program.CompileString(e.command)();const i=s.Scenario.Rotation;s.Program.Compile(["rotation","log","enable"])(),s.Program.Compile(["rotation","run"])();const l=i.GetSummary(),E=i.GetDetails();this.Post("frontend:rotation-damage/run",{result:{summary:l,details:E,log:w.Global.String()},id:a})}catch{this.Post("frontend:rotation-damage/run",{result:{log:w.Global.String()},id:a})}}},VN=[FN,bN,YN];function xN(a){const e=new Zo(a);for(const s of VN)new s().SetWorker(e);return e}var kN=class extends qa{Run(a,e){const s=d.ExportParty(a);return new Promise((n,i)=>{const l=this.worker.Post("backend:rotation-damage/run",{party:s,command:e}),E=this.worker.AddListener("frontend:rotation-damage/run",(A,{result:S,id:u})=>{u===l&&(n(S),this.worker.RemoveListener(E))}),_=this.worker.AddErrorListener(A=>{this.worker.RemoveErrorListener(_),i(A)})})}},UN=class extends qa{constructor(){super(...arguments),this.Children=1,this.Chunk=100,this.OnProgress=()=>{}}Run(a,e){return console.log("[CLIENT] Running optimizer worker for tool: "+a),new Promise((s,n)=>{const i=this.worker.Post("backend:optimizer/run",{tool:a,config:e,children:this.Children,chunk:this.Chunk}),l=this.worker.AddListener("frontend:optimizer/run",(_,{id:A,result:S,progress:u,total:h})=>{if(A!==i){A==="progress:"+i&&Number.isFinite(u)&&Number.isFinite(h)&&this.OnProgress(u||0,h||0);return}s(S),this.worker.RemoveListener(l)}),E=this.worker.AddErrorListener(_=>{this.worker.RemoveErrorListener(E),n(_)})})}},Sc={};R(Sc,{artifacts:()=>fc,filter:()=>ac,food:()=>Tc,mainstat:()=>uc,nextroll:()=>hc,set:()=>Lc,substats:()=>sc,weapon:()=>Nc});var uc={};R(uc,{MainstatOptimizer:()=>ic,defaultConfig:()=>WN});var WN=()=>({}),hc={};R(hc,{NextRollOptimizer:()=>rc,defaultConfig:()=>jN});var jN=()=>({tier:o.SubstatTier.ROLL_AVG}),Lc={};R(Lc,{SetOptimizer:()=>oc,defaultConfig:()=>zN});var zN=()=>({ConfigCmd:`
/*
IMPORTANT: Remember to mark the "Shielded" checkbox in the character attributes
if you want to optimize Retracing Bolide with its 4-piece set effect enabled.

Note that the effect configurations in this section will override the configurations you do
in the application, but will be overrided by configurations done in the rotation code.
*/

case 
NoblesseOblige4
TenacityOfTheMillelith4
DeepwoodMemories4
ArchaicPetra4
ViridescentVenerer4
Instructor4:
  // by default, these party effects will be applied to the entire party.
  effect apply all
  /* 
  you can apply the effect to the member you want, for example:

  effect apply Xiangling

  If you don't want the effect to be applied to the target, then unapply
  from it:

  effect unapply $target_name
  */
  
case 
ArchaicPetra4 
ViridescentVenerer4:
  // by default, Petra and VV effects will have applied the aura corresponding to the target's element,
  // you can change it to the aura (s) you want, or all.
  effect aura $target_element_aura
  // the constant $target_element_aura is predefined by the optimizer, 
  // you can read more about it in the documentation.
  
case OceanHuedClam4:
  // stacks refer to accumulated healing so by default will be 0.
  // set this to the corresponding value if you're optimizing a character
  // with healing capabilities.
  effect stacks 0  
  
/* 
you can add more custom configurations here. Something like, for example:

case CrimsonWitchOfFlames4:
  effect stacks 1

to optimize Crimson with 1 stacks.
*/  
`.trim()}),Nc={};R(Nc,{WeaponOptimizer:()=>cc,defaultConfig:()=>qN});var qN=()=>({Ranks:{3:[5],4:[1,5],5:[1]},ConfigCmd:`
/*
IMPORTANT: Remember to mark the "Shielded" checkbox in the 
character attributes if you want to optimize weapons from
Golden Majesty series (Memory of Dust, Summit Shaper, etc.).
*/
case
WolfsGravestone2
ElegyForTheEnd2
FreedomSworn2
SongOfBrokenPines2
ThousandFloatingDreams2
KeyOfKhajNisut2
HakushinRing1
MakhairaAquamarine1
WanderingEvenstar1
XiphosMoonlight1:
  /*
  These weapon effects will be applied to the entire party
  by default. You can write your own configurations to apply
  to specific characters.
  */
  effect apply all

case KeyOfKhajNisut2:
  effect stacks 3

case
ThrillingTalesOfDragonSlayers1
ForestRegalia1
SapwoodBlade1:
  /*
  By default, these weapon effects will be applied ONLY to the
  first character in the party.
  */
  effect unapply all
  effect apply $member_0_name
`.trim()}),fc={};R(fc,{ArtifactsOptimizer:()=>Ec,defaultConfig:()=>QN});var QN=()=>({artifacts:[],allowSetNumber:[2,4],ConfigCmd:`
/*
You will have to configure all set effects here. This optimizer won't 
automatically set any stacks or conditions to the effects.

Also remember to mark the "Shielded" checkbox in the character attributes
if you want to optimize Retracing Bolide with its 4-piece set effect enabled.

Note that the effect configurations in this section will override the configurations 
you do in the application, but will be overrided by configurations done in the 
rotation code.
*/

case 
NoblesseOblige4
TenacityOfTheMillelith4
DeepwoodMemories4
ArchaicPetra4
ViridescentVenerer4
Instructor4:
  // by default, these party effects will be applied to the entire party.
  effect apply all
  /* 
  you can apply the effect to the member you want, for example:

  effect apply Xiangling

  If you don't want the effect to be applied to the target, then unapply
  from it:

  effect unapply $target_name
  */
  
case 
ArchaicPetra4 
ViridescentVenerer4:
  // by default, Petra and VV effects will have applied the aura corresponding to 
  // the target's element, you can change it to the aura (s) you want, or all.
  effect aura $target_element_aura
  // the constant $target_element_aura is predefined by the optimizer, 
  // you can read more about it in the documentation.
  
case OceanHuedClam4:
  // stacks refer to accumulated healing so by default will be 0.
  // set this to the corresponding value if you're optimizing a character
  // with healing capabilities.
  effect stacks 0

case CrimsonWitchOfFlames4:
  effect stacks 1 // optimize CW4 with 1 stacks

case PaleFlame4:
  effect stacks 2

case
HuskOfOpulentDreams4
FlowerOfParadiseLost4
VermillionHereafter4:
  effect stacks 4
    `.trim()}),mc={};R(mc,{enka:()=>Mc,good:()=>Cc});var Mc={};R(Mc,{FetchEnka:()=>zo,GetEnka:()=>$o,ParseEnka:()=>Qo});var Cc={};R(Cc,{Parse:()=>XN,ParseArtifact:()=>Gc});var $N={flower:t.piece.FLOWER,plume:t.piece.PLUME,sands:t.piece.SANDS,goblet:t.piece.GOBLET,circlet:t.piece.CIRCLET},pc={hp:t.stat.HP_FLAT,hp_:t.stat.HP_PERCENT,atk:t.stat.ATK_FLAT,atk_:t.stat.ATK_PERCENT,def:t.stat.DEF_FLAT,def_:t.stat.DEF_PERCENT,eleMas:t.stat.ELEMENTAL_MASTERY,enerRech_:t.stat.ENERGY_RECHARGE,heal_:t.stat.HEALING_BONUS,critRate_:t.stat.CRIT_RATE,critDMG_:t.stat.CRIT_DMG,physical_dmg_:t.stat.PHYSICAL_DMG,anemo_dmg_:t.stat.ANEMO_DMG,geo_dmg_:t.stat.GEO_DMG,electro_dmg_:t.stat.ELECTRO_DMG,hydro_dmg_:t.stat.HYDRO_DMG,pyro_dmg_:t.stat.PYRO_DMG,cryo_dmg_:t.stat.CRYO_DMG,dendro_dmg_:t.stat.DENDRO_DMG};function Gc(a){const e=$N[a.slotKey];t.piece.Name(e);const s=new I.Artifact(e),n=Z.FindByName(a.setKey);n?s.SetSet(n.Name):(console.warn(`Could not find artifacts set "${a.setKey}"`),s.SetSet(a.setKey)),s.SetStars(a.rarity),s.SetLevel(a.level);const i=pc[a.mainStatKey];t.stat.Name(i),s.SetMainstat(i);for(const{key:l,value:E}of a.substats){const _=pc[l];t.stat.Name(_);let A=E;if(t.FlatStats.includes(_)||(A/=100),!Number.isFinite(A)||A<0)throw new Error(`Invalid substat value: ${A}`);s.AddSubstat(_,A)}return s}function XN(a){return(a.artifacts||[]).map(s=>Gc(s))}var dc={};R(dc,{ReadOnly:()=>NE});function JN(){return new Worker("/genshin-damage-calc/v4/assets/worker_child.292f2e20.js")}Pt.worker.SetGenerator(()=>{const a=new JN,e=new Pt.worker.VirtualWorker((s,n,i)=>a.postMessage({path:s,id:n,data:i}));return e.SetKiller(()=>a.terminate()),a.addEventListener("message",async({data:s})=>{if(s.error){await e.Error(s.error);return}e.Recieve(s.path,s.id,s.data)}),e});const ta=self,Ja=Pt.worker.BackendWorker((a,e,s)=>ta.postMessage({path:a,id:e,data:s}));Ja.SetKiller(()=>ta.terminate()),ta.addEventListener("message",async({data:a})=>{try{await Ja.Recieve(a.path,a.id,a.data)}catch(e){console.error("[WORKER ERROR]",e),Ja.Error(e),ta.postMessage({error:e})}})})();
